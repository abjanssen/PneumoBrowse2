"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[1777],{61777(e,n,i){i.d(n,{doAfterAttach:()=>d});var a=i(77251),t=i(8201),s=i(70203),r=i(52901),o=i(99226),c=i(42456),l=i(38567);function d(e){(async()=>{try{const{rpcManager:n}=(0,a.getSession)(e),i=(0,s.getRpcSessionId)(e),{norms:t}=await n.call(i,"CoreGetInfo",{adapterConfig:e.adapterConfig});(0,o.isAlive)(e)&&t&&e.setAvailableNormalizations(t)}catch(n){console.error(n),(0,o.isAlive)(e)&&(0,a.getSession)(e).notifyError(`${n}`,n)}})(),(0,o.addDisposer)(e,(0,l.autorun)(()=>{if(e.isMinimized)return;const n=(0,a.getContainingView)(e);if(!n.initialized)return;const{dynamicBlocks:i}=n,c=i.contentBlocks;e.resolution,e.useLogScale,e.colorScheme,e.activeNormalization,e.mode,e.height,!(0,l.untracked)(()=>e.error)&&c.length&&(async()=>{if(e.isMinimized)return;const n=(0,a.getContainingView)(e),{bpPerPx:i,dynamicBlocks:c}=n,d=c.contentBlocks;if(!d.length)return;const{adapterConfig:g}=e,p=e.renderProps();try{const t=(0,a.getSession)(e),{rpcManager:c}=t,u=(0,s.getRpcSessionId)(e),f=(0,l.untracked)(()=>e.renderingStopToken);f&&(0,r.CF)(f);const m=(0,r.y5)();e.setRenderingStopToken(m),e.setLoading(!0),e.setCanvasDrawn(!1);const C=await c.call(u,"CoreRender",{sessionId:u,rendererType:"HicRenderer",regions:[...d],adapterConfig:g,bpPerPx:i,stopToken:m,...p},{statusCallback:n=>{(0,o.isAlive)(e)&&e.setStatusMessage(n)}});C.imageData&&(e.setRenderingImageData(C.imageData),e.setLastDrawnOffsetPx(n.offsetPx),e.setLastDrawnBpPerPx(n.bpPerPx)),e.setFlatbushData(C.flatbush,C.items??[],C.maxScore??0,C.yScalar??1)}catch(n){(0,t.Kp)(n)||(console.error(n),(0,o.isAlive)(e)&&e.setError(n))}finally{(0,o.isAlive)(e)&&(e.setRenderingStopToken(void 0),e.setLoading(!1))}})()},{delay:1e3,name:"LinearHicDisplayRender"})),(0,o.addDisposer)(e,(0,l.autorun)(()=>{if(e.isMinimized)return;if(!(0,a.getContainingView)(e).initialized)return;const n=(0,c.y6)(e.ref,e.renderingImageData);(0,o.isAlive)(e)&&e.setCanvasDrawn(n)},{name:"LinearHicDisplayCanvas"}))}}}]);
//# sourceMappingURL=1777.cc49843d.chunk.js.map