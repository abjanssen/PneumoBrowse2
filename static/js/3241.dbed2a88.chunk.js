"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3241],{36917:(o,e,t)=>{t.d(e,{DW:()=>_,J8:()=>r,L9:()=>f,PJ:()=>u,Pq:()=>h,en:()=>c,pf:()=>a,sY:()=>d,w7:()=>i});var n=t(86576);const r={PROPER_PAIR:0,LONG_INSERT:1,SHORT_INSERT:2,INTER_CHROM:3,ABNORMAL_ORIENTATION:4,UNMAPPED_MATE:5},a={color_fwd_strand_not_proper:"#ECC8C8",color_rev_strand_not_proper:"#BEBED8",color_fwd_strand:"#EC8B8B",color_rev_strand:"#8F8FD8",color_fwd_missing_mate:"#D11919",color_rev_missing_mate:"#1919D1",color_fwd_diff_chr:"#000",color_rev_diff_chr:"#969696",color_pair_lr:"#c8c8c8",color_pair_rr:"#3a3a9d",color_pair_rl:"teal",color_pair_ll:"green",color_nostrand:"#c8c8c8",color_interchrom:"purple",color_longinsert:"red",color_shortinsert:"pink",color_unmapped_mate:"#8B008B",color_unknown:"grey"},i={color_fwd_strand_not_proper:"#CA6767",color_rev_strand_not_proper:"#7272AA",color_fwd_strand:"#DC2A2A",color_rev_strand:"#4141BA",color_fwd_missing_mate:"#921111",color_rev_missing_mate:"#111192",color_fwd_diff_chr:"#000000",color_rev_diff_chr:"#696969",color_pair_lr:"#8C8C8C",color_pair_rr:"#00002A",color_pair_rl:"#005A5A",color_pair_ll:"#005A00",color_nostrand:"#8C8C8C",color_interchrom:"#5A005A",color_longinsert:"#B30000",color_shortinsert:"#FF3A5C",color_unmapped_mate:"#5A005A",color_unknown:"#444"},s=[a.color_pair_lr,i.color_pair_lr];function c({type:o,f1:e,f2:t,stats:a}){if(void 0!==e.flags&&8&e.flags)return r.UNMAPPED_MATE;if("insertSizeAndOrientation"===o||"orientation"===o){const o=n.il.fr[e.pair_orientation||""];if(o&&"LR"!==o)return r.ABNORMAL_ORIENTATION}if("insertSizeAndOrientation"===o||"insertSize"===o){const o=e.refName===t.refName,n=Math.abs(e.tlen||0);if(!o)return r.INTER_CHROM;if(a){if(n>a.upper)return r.LONG_INSERT;if(n<a.lower)return r.SHORT_INSERT}}return r.PROPER_PAIR}function f(o,e,t){switch(c({type:"insertSize",f1:o,f2:e,stats:t})){case r.UNMAPPED_MATE:return[a.color_unmapped_mate,i.color_unmapped_mate];case r.LONG_INSERT:return[a.color_longinsert,i.color_longinsert];case r.SHORT_INSERT:return[a.color_shortinsert,i.color_shortinsert];case r.INTER_CHROM:return[a.color_interchrom,i.color_interchrom];case r.PROPER_PAIR:default:return}}function l(o){if(void 0!==o.flags&&8&o.flags)return[a.color_unmapped_mate,i.color_unmapped_mate];const e=n.il.fr[o.pair_orientation||""],t=n.rr[e];return"LR"===e?void 0:[a[t],i[t]]}function _(o){return l(o)||s}function d(o,e,t){return l(o)||f(o,e,t)||s}function h(o,e){const t=Math.abs(o.tlen||0);return e&&t>e.upper?[a.color_fwd_missing_mate,i.color_fwd_missing_mate]:s}function u({type:o,v0:e,v1:t,stats:n}){return"insertSizeAndOrientation"===o?d(e,t,n):"orientation"===o?_(e):"insertSize"===o?f(e,t,n):void 0}},93241:(o,e,t)=>{t.d(e,{dG:()=>d});var n=t(68584),r=t(99546),a=t(65944),i=t(36917);function s(o,e,t,n,r,a){t<0&&(o+=t,t=-t),n<0&&(e+=n,n=-n),a&&(r.fillStyle=a),r.fillRect(o,e,t,n)}function c(o,e,t,n,r,a){t<0&&(o+=t,t=-t),n<0&&(e+=n,n=-n),a&&(r.strokeStyle=a),r.strokeRect(o,e,t,n)}function f(o,e,t,n,r,a,i,s,c){o.fillStyle=i,o.beginPath(),-1===a?(o.moveTo(e-s,t+r/2),o.lineTo(e,t+r),o.lineTo(e+n,t+r),o.lineTo(e+n,t),o.lineTo(e,t)):(o.moveTo(e,t),o.lineTo(e,t+r),o.lineTo(e+n,t+r),o.lineTo(e+n+s,t+r/2),o.lineTo(e+n,t)),o.closePath(),o.fill(),c&&(o.strokeStyle=c,o.stroke())}function l(o){if(2048&o.flags){const e=o.SA?.split(";")[0]?.split(",")[2];return"-"===e?-1:1}return 16&o.flags?-1:1}var _=t(91476);function d(o,e,t){const{chainData:d}=o;if(!d)return;const{assemblyManager:h}=(0,r.getSession)(o),u=(0,r.getContainingView)(o),m=u.assemblyNames[0],p=h.get(m);if(!p)return;const g=o.featureHeight??(0,n.getConf)(o,"featureHeight"),P=o.colorBy?.type||"insertSizeAndOrientation",N=o.drawSingletons,x=o.drawProperPairs,{chains:R}=d,T=function(o,e,t,n,r){const a=[];for(const s of o){const o=s;if(!e&&1===o.length)continue;let c=!1;for(const e of o)if(1&e.flags){c=!0;break}if(!t&&c){const e=[];for(const t of o)2048&t.flags||e.push(t);if(2===e.length){const o=e[0],t=e[1];if((0,i.en)({type:n,f1:o,f2:t,stats:r.stats})===i.J8.PROPER_PAIR)continue}}a.push(o)}return a}(R,N,x,P,d),v=function(o,e,t){const n=[];for(const r of o){const o=r;let a=Number.MAX_VALUE,i=Number.MIN_VALUE,s="",c=0;const f=o.length;for(let n=0;n<f;n++){const r=o[n],l=t.getCanonicalRefName(r.refName)||r.refName,_=e.bpToPx({refName:l,coord:r.start})?.offsetPx,d=e.bpToPx({refName:l,coord:r.end})?.offsetPx;void 0!==_&&void 0!==d&&(a=Math.min(a,_),i=Math.max(i,d)),s||(s=r.id),f>1&&0===c&&r.tlen&&(c=Math.abs(r.tlen))}const l=c>0?c:Math.abs(i-a);n.push({distance:l,minX:a,maxX:i,chain:o,id:s})}return n}(T,u,p);!function(o){o.sort((o,e)=>{const t=1===o.chain.length?1:0,n=1===e.chain.length?1:0;return n!==t?n-t:o.distance-e.distance})}(v);const{chainYOffsets:A,layoutHeight:C}=t(v,o,u,g),b=[],w=(0,_.SP)(u.bpPerPx,g);!function({ctx:o,type:e,chainData:t,view:n,asm:r,chainYOffsets:a,renderChevrons:l,featureHeight:d,featuresForFlatbush:h,computedChains:u}){for(const m of u){const{id:u,chain:p,minX:g,maxX:P}=m;let N=!1;for(const o of p)if(1&o.flags){N=!0;break}if(!N)continue;const x=a.get(u);if(void 0===x)continue;const R=[];for(const o of p)2048&o.flags||R.push(o);const T=2===R.length,[v,A]=T?(0,i.PJ)({type:e,v0:R[0],v1:R[1],stats:t.stats})||["#888","#888"]:(0,i.Pq)(R[0]||p[0],t.stats);if(T){const e=R[0],t=R[1],a=n.bpToPx({refName:r.getCanonicalRefName2(e.refName),coord:e.start})?.offsetPx,i=n.bpToPx({refName:r.getCanonicalRefName2(t.refName),coord:t.start})?.offsetPx;void 0!==a&&void 0!==i&&s(a-n.offsetPx,x+d/2-.5,i-a,1,o,"#666")}const C=n.offsetPx,b=g-C,w=P-C;for(let e=0,t=p.length;e<t;e++){const t=p[e],a=n.bpToPx({refName:r.getCanonicalRefName2(t.refName),coord:t.start}),i=n.bpToPx({refName:r.getCanonicalRefName2(t.refName),coord:t.end});if(!a||!i)continue;const m=a.offsetPx-C,g=Math.max(i.offsetPx-a.offsetPx,3);l?f(o,m,x,g,d,t.strand,v,_.Fz,A):(s(m,x,g,d,o,v),c(m,x,g,d,o,A)),h.push({x1:m,y1:x,x2:m+g,y2:x+d,data:t,chainId:u,chainMinX:b,chainMaxX:w,chain:p})}}}({ctx:e,type:P,chainData:d,view:u,asm:p,chainYOffsets:A,renderChevrons:w,featureHeight:g,featuresForFlatbush:b,computedChains:v}),function({ctx:o,chainData:e,view:t,asm:n,chainYOffsets:r,renderChevrons:a,featureHeight:d,featuresForFlatbush:h,computedChains:u,flipStrandLongReadChains:m}){const p=o=>-1===o?"color_rev_strand":"color_fwd_strand";for(const g of u){const{id:u,chain:P,minX:N,maxX:x}=g;let R=!1;for(const o of P)if(1&o.flags){R=!0;break}if(R)continue;const T=r.get(u);if(void 0===T)continue;const v=[];for(const o of P)2048&o.flags||v.push(o);const A=1===P.length,C=l(v[0]||P[0]);if(!A){const e=P[0],r=P[P.length-1],a=t.bpToPx({refName:n.getCanonicalRefName2(e.refName),coord:e.start})?.offsetPx,i=t.bpToPx({refName:n.getCanonicalRefName2(r.refName),coord:r.end})?.offsetPx;if(void 0!==a&&void 0!==i){const e=T+d/2-.5;o.beginPath(),o.strokeStyle="#666",o.moveTo(a-t.offsetPx,e),o.lineTo(i-t.offsetPx,e),o.stroke()}}const b=t.offsetPx,w=N-b,M=x-b;for(let r=0,l=P.length;r<l;r++){const l=P[r],g=t.bpToPx({refName:n.getCanonicalRefName2(l.refName),coord:l.start}),N=t.bpToPx({refName:n.getCanonicalRefName2(l.refName),coord:l.end});if(!g||!N)continue;const x=A||!m?l.strand:l.strand*C,[R,v]=A?(0,i.Pq)(l,e.stats):[i.pf[p(x)],i.w7[p(x)]],y=g.offsetPx-b,O=Math.max(N.offsetPx-g.offsetPx,3);a?f(o,y,T,O,d,x,R,_.Fz,v):(s(y,T,O,d,o,R),c(y,T,O,d,o,v)),h.push({x1:y,y1:T,x2:y+O,y2:T+d,data:l,chainId:u,chainMinX:w,chainMaxX:M,chain:P})}}}({ctx:e,chainData:d,view:u,asm:p,chainYOffsets:A,renderChevrons:w,featureHeight:g,featuresForFlatbush:b,computedChains:v,flipStrandLongReadChains:o.flipStrandLongReadChains}),function(o,e,t,n,r){for(const a of o){const{id:o,chain:i,minX:s,maxX:c}=a,f=e.get(o);if(void 0===f)continue;const l=s-n.offsetPx,_=c-n.offsetPx;i.length>0&&r.push({x1:l,y1:f,x2:_,y2:f+t,data:i[0],chainId:o,chainMinX:l,chainMaxX:_,chain:i})}}(v,A,g,u,b),function(o,e){const t=new a.A(Math.max(o.length,1)),n=o.length;if(n)for(let e=0;e<n;e++){const{x1:n,y1:r,x2:a,y2:i}=o[e];t.add(n,r,a,i)}else t.add(0,0);t.finish(),e.setFeatureLayout(t),e.setFeaturesForFlatbush(o)}(b,o),void 0!==C&&o.setLayoutHeight(C)}}}]);
//# sourceMappingURL=3241.dbed2a88.chunk.js.map