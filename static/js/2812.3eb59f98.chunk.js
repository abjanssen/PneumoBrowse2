"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2812],{10420:(t,e,r)=>{r.d(e,{Z:()=>i});var o=r(99546),n=r(94026);function i(t,e,r){const i=-1===r?(0,o.revcom)(e):e,s=i.length,a=t.split(";"),c=[];for(const t of a){if(""===t)continue;const e=t.split(","),o=e[0],a=n.k.exec(o);if(!a)throw new Error(`bad format for MM tag: "${t}"`);const[,l,f,p]=a,h=p.split(/(\d+|.)/);for(const t of h){if(""===t)continue;const o=e.length;let n=0;const a=-1===r?new Array(o-1):[];let p=-1===r?o-2:0;for(let t=1;t<o;t++){let o=+e[t];do{"N"!==l&&l!==i[n]||o--,n++}while(o>=0&&n<s);if(-1===r){const t=s-n;t>=0&&(a[p--]=t)}else a[p++]=n-1}const h=-1===r?a.slice(p+1):a;c.push({type:t,base:l,strand:f,positions:h})}}return c}},36917:(t,e,r)=>{r.d(e,{DW:()=>p,J8:()=>n,L9:()=>l,PJ:()=>g,Pq:()=>d,en:()=>c,pf:()=>i,sY:()=>h,w7:()=>s});var o=r(86576);const n={PROPER_PAIR:0,LONG_INSERT:1,SHORT_INSERT:2,INTER_CHROM:3,ABNORMAL_ORIENTATION:4,UNMAPPED_MATE:5},i={color_fwd_strand_not_proper:"#ECC8C8",color_rev_strand_not_proper:"#BEBED8",color_fwd_strand:"#EC8B8B",color_rev_strand:"#8F8FD8",color_fwd_missing_mate:"#D11919",color_rev_missing_mate:"#1919D1",color_fwd_diff_chr:"#000",color_rev_diff_chr:"#969696",color_pair_lr:"#c8c8c8",color_pair_rr:"#3a3a9d",color_pair_rl:"teal",color_pair_ll:"green",color_nostrand:"#c8c8c8",color_interchrom:"purple",color_longinsert:"red",color_shortinsert:"pink",color_unmapped_mate:"#8B008B",color_unknown:"grey"},s={color_fwd_strand_not_proper:"#CA6767",color_rev_strand_not_proper:"#7272AA",color_fwd_strand:"#DC2A2A",color_rev_strand:"#4141BA",color_fwd_missing_mate:"#921111",color_rev_missing_mate:"#111192",color_fwd_diff_chr:"#000000",color_rev_diff_chr:"#696969",color_pair_lr:"#8C8C8C",color_pair_rr:"#00002A",color_pair_rl:"#005A5A",color_pair_ll:"#005A00",color_nostrand:"#8C8C8C",color_interchrom:"#5A005A",color_longinsert:"#B30000",color_shortinsert:"#FF3A5C",color_unmapped_mate:"#5A005A",color_unknown:"#444"},a=[i.color_pair_lr,s.color_pair_lr];function c({type:t,f1:e,f2:r,stats:i}){if(void 0!==e.flags&&8&e.flags)return n.UNMAPPED_MATE;if("insertSizeAndOrientation"===t||"orientation"===t){const t=o.il.fr[e.pair_orientation||""];if(t&&"LR"!==t)return n.ABNORMAL_ORIENTATION}if("insertSizeAndOrientation"===t||"insertSize"===t){const t=e.refName===r.refName,o=Math.abs(e.tlen||0);if(!t)return n.INTER_CHROM;if(i){if(o>i.upper)return n.LONG_INSERT;if(o<i.lower)return n.SHORT_INSERT}}return n.PROPER_PAIR}function l(t,e,r){switch(c({type:"insertSize",f1:t,f2:e,stats:r})){case n.UNMAPPED_MATE:return[i.color_unmapped_mate,s.color_unmapped_mate];case n.LONG_INSERT:return[i.color_longinsert,s.color_longinsert];case n.SHORT_INSERT:return[i.color_shortinsert,s.color_shortinsert];case n.INTER_CHROM:return[i.color_interchrom,s.color_interchrom];case n.PROPER_PAIR:default:return}}function f(t){if(void 0!==t.flags&&8&t.flags)return[i.color_unmapped_mate,s.color_unmapped_mate];const e=o.il.fr[t.pair_orientation||""],r=o.rr[e];return"LR"===e?void 0:[i[r],s[r]]}function p(t){return f(t)||a}function h(t,e,r){return f(t)||l(t,e,r)||a}function d(t,e){const r=Math.abs(t.tlen||0);return e&&r>e.upper?[i.color_fwd_missing_mate,s.color_fwd_missing_mate]:a}function g({type:t,v0:e,v1:r,stats:o}){return"insertSizeAndOrientation"===t?h(e,r,o):"orientation"===t?p(e):"insertSize"===t?l(e,r,o):void 0}},59509:(t,e,r)=>{r.d(e,{r:()=>c});var o=r(95805),n=r(49256),i=r(10420),s=r(60515),a=r(86576);function c(t,e){const r=t.get("strand"),c=t.get("seq"),l=(0,a.c$)(t,"MM","Mm")||"",f=e||(0,o.parseCigar)(t.get("CIGAR"));if(c){const e=(0,i.Z)(l,c,r),o=(0,s.Y)(t),a=[];let p=0;for(const{type:t,positions:i}of e){for(const{ref:e,idx:s}of(0,n.h)(f,i)){const n=o?.[p+(-1===r?i.length-1-s:s)]||0;if(a[e]){const r=a[e];a[e]={allProbs:[...r.allProbs,n],prob:Math.max(r.prob,n),type:r.prob>n?r.type:t}}else a[e]={type:t,prob:n,allProbs:[n]}}p+=i.length}return a}}},60515:(t,e,r)=>{r.d(e,{Y:()=>n});var o=r(86576);function n(t){const e=(0,o.c$)(t,"ML","Ml")||[];if(e){const t=[];if("string"==typeof e){const r=e.split(",");for(let e=0,o=r.length;e<o;e++)t.push(+r[e]/255)}else for(let r=0,o=e.length;r<o;r++)t.push(e[r]/255);return t}{const e=(0,o.c$)(t,"MP","Mp");if(e){const t=[];for(let r=0,o=e.length;r<o;r++){const o=e.charCodeAt(r)-33;t.push(Math.min(1,o/50))}return t}return}}},69276:(t,e,r)=>{r.d(e,{P:()=>a});var o=r(49256),n=r(10420),i=r(60515),s=r(86576);function a(t,e){const r=t.get("start"),a=t.get("end"),c=t.get("strand"),l=a-r,f=(0,s.c$)(t,"MM","Mm")||"",p=[],h=[],d=[],g=[],u=t.get("seq");if(u){const r=(0,i.Y)(t),s=(0,n.Z)(f,u,c);let a=0;for(const{type:t,positions:n}of s){for(const{ref:i,idx:s}of(0,o.h)(e,n)){if(i<0||i>=l)continue;const e=a+(-1===c?n.length-1-s:s),o=r?.[e]||0;"m"===t?(p[i]=1,d[i]=o):"h"===t&&(h[i]=1,g[i]=o)}a+=n.length}}return{methBins:p,hydroxyMethBins:h,methProbs:d,hydroxyMethProbs:g}}},72812:(t,e,r)=>{r.d(e,{makeImageData:()=>y});var o=r(68584),n=r(67112),i=r(99546),s=r(65944),a=r(36917),c=r(86576);function l({colorType:t,tag:e,feature:r,config:n,defaultColor:i,colorTagMap:s}){switch(t){case"insertSize":return function(t){return t.get("is_paired")&&t.get("refName")!==t.get("next_ref")?"#555":`hsl(${Math.abs(t.get("template_length"))/10},50%,50%)`}(r);case"strand":return function(t){return-1===t.get("strand")?"#8F8FD8":"#EC8B8B"}(r);case"mappingQuality":return function(t){return`hsl(${t.get("score")},50%,50%)`}(r);case"pairOrientation":return function(t,e){return a.pf[function(t,e){const r=(0,o.readConfObject)(e,"orientationType");return{LR:"color_pair_lr",RR:"color_pair_rr",RL:"color_pair_rl",LL:"color_pair_ll"}[c.il[r][t.get("pair_orientation")]]}(t,e)||"color_nostrand"]}(r,n);case"stranded":return function(t){return a.pf[function(t){const e=t.get("flags"),r=t.get("strand");if(1&e){const o=64&e?-1:1;return 2&e?r*o===1?"color_rev_strand":"color_fwd_strand":8&e?r*o===1?"color_rev_missing_mate":"color_fwd_missing_mate":t.get("refName")===t.get("next_ref")?r*o===1?"color_rev_strand_not_proper":"color_fwd_strand_not_proper":1===r?"color_fwd_diff_chr":"color_rev_diff_chr"}return"color_unknown"}(t)]}(r);case"xs":case"tag":{const t=r.get("tags"),o=t?t[e]:r.get(e);return"XS"===e||"TS"===e?"-"===o?a.pf.color_rev_strand:"+"===o?a.pf.color_fwd_strand:a.pf.color_nostrand:"ts"===e?"-"===o?-1===r.get("strand")?a.pf.color_fwd_strand:a.pf.color_rev_strand:"+"===o?-1===r.get("strand")?a.pf.color_rev_strand:a.pf.color_fwd_strand:a.pf.color_nostrand:s[o]||a.pf.color_nostrand}case"insertSizeAndPairOrientation":break;case"modifications":case"methylation":return 16&r.get("flags")?"#c8dcc8":"#c8c8c8";default:return i?"lightgrey":(0,o.readConfObject)(n,"color",{feature:r})}}var f=r(95805),p=r(87485),h=r(69276);function d(t,e,r,o,n,i,s){e+o<0||e>i||(s&&(t.fillStyle=s),t.fillRect(e,r,o,n))}function g(t){const{skip:e,deletion:r,insertion:o,hardclip:n,softclip:i,bases:s}=t.palette;return{A:s.A.main,C:s.C.main,G:s.G.main,T:s.T.main,deletion:r,insertion:o,hardclip:n,softclip:i,skip:e}}function u(){return{charWidth:(0,i.measureText)("A"),charHeight:(0,i.measureText)("M")-2}}var _=r(49256),m=r(10420),b=r(60515),x=r(59509),P=r(57240),M=r(91476);function y({ctx:t,layoutRecords:e,canvasWidth:r,renderArgs:a}){const{stopToken:y,config:T,showSoftClip:A,colorBy:S,theme:C}=a,v=(0,o.readConfObject)(T,"mismatchAlpha"),w=(0,o.readConfObject)(T,"minSubfeatureWidth"),R=(0,o.readConfObject)(T,"largeInsertionIndicatorScale"),O=(0,o.readConfObject)(T,"hideSmallIndels"),I="#f0f"===(0,o.readConfObject)(T,"color"),N=(0,n.createJBrowseTheme)(C),E=g(N),W=function(t){return Object.fromEntries(Object.entries(g(t)).map(([e,r])=>[e,t.palette.getContrastText(r)]))}(N);t.font="bold 10px Courier New,monospace";const{charWidth:k,charHeight:B}=u(),q=($=S?.type,["methylation","modifications"].includes($||""));var $;const H=[],D=[];(0,i.forEachWithStopTokenCheck)(e,y,e=>{const n=function({ctx:t,feat:e,renderArgs:r,colorMap:o,colorContrastMap:n,charWidth:s,charHeight:a,defaultColor:g,canvasWidth:u}){const y=[],T=[],{config:A,bpPerPx:S,regions:C,colorBy:v,colorTagMap:w={}}=r,{tag:R="",type:O=""}=v||{},{feature:I}=e,N=C[0];switch(t.fillStyle=l({feature:I,config:A,tag:R,defaultColor:g,colorType:O,colorTagMap:w}),function({ctx:t,feat:e,renderArgs:r}){const{regions:o,bpPerPx:n}=r,{heightPx:s,topPx:a,feature:c}=e,l=o[0],p=c.get("start"),h=c.get("end"),d=c.get("CIGAR"),g=l.reversed?-1:1,u=c.get("strand")*g,_=n<10&&s>5;if(d?.includes("N")){const e=(0,f.parseCigar)(d);if(1===u){let r=0,o=p;for(let c=0;c<e.length;c+=2){const f=+e[c],p=e[c+1];if("M"===p||"X"===p||"="===p||"D"===p)r+=f;else if("N"===p){if(o!==r){const[e,c]=(0,i.bpSpanPx)(o,o+r,l,n),f=c-e;t.fillRect(e,a,f,s)}o+=r+f,r=0}}if(o!==r){const[e,c]=(0,i.bpSpanPx)(o,o+r,l,n),f=c-e;_?(t.beginPath(),t.moveTo(e,a),t.lineTo(e,a+s),t.lineTo(c,a+s),t.lineTo(c+5,a+s/2),t.lineTo(c,a),t.closePath(),t.fill()):t.fillRect(e,a,f,s)}}else if(-1===u){let r=0,o=h;for(let c=e.length-2;c>=0;c-=2){const f=+e[c],p=e[c+1];if("M"===p||"X"===p||"="===p||"D"===p)r+=f;else if("N"===p){if(0!==r){const[e,c]=(0,i.bpSpanPx)(o-r,o,l,n);t.fillRect(e,a,c-e,s)}o-=r+f,r=0}}if(0!==r){const[e,c]=(0,i.bpSpanPx)(o-r,o,l,n),f=c-e;_?(t.beginPath(),t.moveTo(e-5,a+s/2),t.lineTo(e,a+s),t.lineTo(c,a+s),t.lineTo(c,a),t.lineTo(e,a),t.closePath(),t.fill()):t.fillRect(e,a,f,s)}}}else{const[e,r]=(0,i.bpSpanPx)(p,h,l,n);n<10&&s>5?-1===u?(t.beginPath(),t.moveTo(e-5,a+s/2),t.lineTo(e,a+s),t.lineTo(r,a+s),t.lineTo(r,a),t.lineTo(e,a),t.closePath(),t.fill()):(t.beginPath(),t.moveTo(e,a),t.lineTo(e,a+s),t.lineTo(r,a+s),t.lineTo(r+5,a+s/2),t.lineTo(r,a),t.closePath(),t.fill()):t.fillRect(e,a,r-e,s)}}({ctx:t,feat:e,renderArgs:r}),O){case"perBaseQuality":!function({ctx:t,feat:e,region:r,bpPerPx:o,canvasWidth:n,cigarOps:s}){const{feature:a,topPx:c,heightPx:l}=e,f=(a.get("qual")||"").split(" ").map(t=>+t),p=1/o,h=a.get("start");let g=0,u=0;for(let e=0;e<s.length;e+=2){const a=+s[e],_=s[e+1];if("S"===_||"I"===_)g+=a;else if("D"===_||"N"===_)u+=a;else if("M"===_||"X"===_||"="===_){for(let e=0;e<a;e++){const s=f[g+e],a=h+u+e;d(t,(0,i.bpSpanPx)(a,a+1,r,o)[0],c,p+.5,l,n,`hsl(${255===s?150:1.5*s},55%,50%)`)}g+=a,u+=a}}}({ctx:t,feat:e,region:N,bpPerPx:S,canvasWidth:u,cigarOps:(0,f.parseCigar)(I.get("CIGAR"))});break;case"perBaseLettering":!function({ctx:t,feat:e,region:r,bpPerPx:o,colorMap:n,colorContrastMap:s,charWidth:a,charHeight:c,canvasWidth:l,cigarOps:f}){const p=c-2,{feature:h,topPx:g,heightPx:u}=e,_=h.get("seq"),m=1/o,b=h.get("start");let x=0,P=0;if(_)for(let e=0;e<f.length;e+=2){const c=+f[e],h=f[e+1];if("S"===h||"I"===h)x+=c;else if("D"===h||"N"===h)P+=c;else if("M"===h||"X"===h||"="===h){for(let e=0;e<c;e++){const c=_[x+e],f=b+P+e,[h]=(0,i.bpSpanPx)(f,f+1,r,o);d(t,h,g,m+.5,u,l,n[c]),m>=a&&u>=p&&(t.fillStyle=s[c],t.fillText(c,h+(m-a)/2+1,g+u))}x+=c,P+=c}}}({ctx:t,feat:e,region:N,bpPerPx:S,colorMap:o,colorContrastMap:n,charWidth:s,charHeight:a,canvasWidth:u,cigarOps:(0,f.parseCigar)(I.get("CIGAR"))});break;case"modifications":{const o=function({ctx:t,feat:e,region:r,bpPerPx:o,renderArgs:n,canvasWidth:s,cigarOps:a}){const l=[],f=[],{feature:p,topPx:h,heightPx:g}=e,{colorBy:u,visibleModifications:y={}}=n,T=p.get("seq");if(!T)return{coords:f,items:l};const A=p.get("start"),S=u?.modifications?.isolatedModification,C=u?.modifications?.twoColor,v=(u?.modifications?.threshold??10)/100,w=p.get("strand"),R=(0,c.c$)(p,"MM","Mm")||"",O=(0,m.Z)(R,T,w),I=(0,b.Y)(p),N=new Map;let E=0;for(const{type:t,base:e,strand:r,positions:o}of O){for(const{ref:n,idx:i}of(0,_.h)(a,o)){const s=I?.[E+(-1===w?o.length-1-i:i)]||0;N.has(n)||N.set(n,[]),N.get(n).push({type:t,base:e,strand:r,prob:s})}E+=o.length}return(0,x.r)(p,a)?.forEach(({allProbs:e,prob:n,type:a},c)=>{const p=A+c,[u,_]=(0,i.bpSpanPx)(p,p+1,r,o),m=y[a];if(!m)return void console.warn(`${a} not known yet`);if(S&&m.type!==S)return;if(n<v)return;const b=m.color||"black",x=1-(0,i.sum)(e);if(C&&x>(0,i.max)(e)){const e=(0,M.yr)("blue",x);d(t,u,h,_-u+.5,g,s,e)}else{const e=(0,M.yr)(b,n);d(t,u,h,_-u+.5,g,s,e)}const T=(N.get(c)||[]).map(t=>`${t.base}${t.strand}${t.type} ${(0,P.y)(t.type)} (${(100*t.prob).toFixed(1)}%)`).join("<br/>");l.push({type:"modification",seq:T||m.base,modType:a,probability:n}),f.push(u,h,_,h+g),c++}),{coords:f,items:l}}({ctx:t,feat:e,region:N,bpPerPx:S,renderArgs:r,canvasWidth:u,cigarOps:(0,f.parseCigar)(I.get("CIGAR"))});for(let t=0,e=o.coords.length;t<e;t++)T.push(o.coords[t]);for(let t=0,e=o.items.length;t<e;t++)y.push(o.items[t]);break}case"methylation":!function({ctx:t,feat:e,region:r,bpPerPx:o,renderArgs:n,canvasWidth:s,cigarOps:a}){const{regionSequence:c}=n,{feature:l,topPx:f,heightPx:g}=e;if(!c)throw new Error("region sequence required for methylation");if(!l.get("seq"))return;const u=l.get("start"),_=l.get("end"),{methBins:m,methProbs:b,hydroxyMethBins:x,hydroxyMethProbs:P}=(0,h.P)(l,a);function M(t){if(m[t]){const e=b[t]||0;return(e>.5?(0,p.M)("red").alpha(2*(e-.5)):(0,p.M)("blue").alpha(1-2*e)).toHslString()}if(x[t]){const e=P[t]||0;return(e>.5?(0,p.M)("pink").alpha(2*(e-.5)):(0,p.M)("purple").alpha(1-2*e)).toHslString()}}const y=c.toLowerCase();for(let e=0;e<_-u;e++){const n=e+u,a=y[n-r.start+1],c=y[n-r.start+2];if("c"===a&&"g"===c)if(o>2){const[a,c]=(0,i.bpSpanPx)(n,n+2,r,o);d(t,a,f,c-a+.5,g,s,M(e)||M(e+1)||"blue")}else{const[a,c]=(0,i.bpSpanPx)(n,n+1,r,o);d(t,a,f,c-a+.5,g,s,M(e)||"blue");const[l,p]=(0,i.bpSpanPx)(n+1,n+2,r,o);d(t,l,f,p-l+.5,g,s,M(e+1)||"blue")}}}({ctx:t,feat:e,region:N,bpPerPx:S,renderArgs:r,canvasWidth:u,cigarOps:(0,f.parseCigar)(I.get("CIGAR"))})}return{coords:T,items:y}}({ctx:t,feat:e,renderArgs:a,defaultColor:I,colorMap:E,colorContrastMap:W,charWidth:k,charHeight:B,canvasWidth:r});for(let t=0,e=n.coords.length;t<e;t++)H.push(n.coords[t]);for(let t=0,e=n.items.length;t<e;t++)D.push(n.items[t]);const s=function({ctx:t,feat:e,renderArgs:r,minSubfeatureWidth:o,largeInsertionIndicatorScale:n,mismatchAlpha:s,charWidth:a,charHeight:c,colorMap:l,colorContrastMap:f,hideSmallIndels:h,canvasWidth:g,drawSNPsMuted:u,drawIndels:_=!0}){const m=[],b=[],{bpPerPx:x,regions:P}=r,{heightPx:M,topPx:y,feature:T}=e,A=P[0],S=T.get("start"),C=Math.min(1/x,2),v=T.get("mismatches")??[],w=c-2,R=A.reversed?1/x+1:-1;for(const e of v){const r=S+e.start,n=e.length,c=e.base,[P,T]=(0,i.bpSpanPx)(r,r+n,A,x),v=Math.max(o,T-P);if("mismatch"===e.type){if(m.push({type:"mismatch",seq:e.base}),b.push(P,y,T,y+M),!u){const r=l[e.base]||"#888",o=s&&void 0!==e.qual?(0,p.M)(r).alpha(Math.min(1,e.qual/50)).toHslString():r;d(t,Math.round(P),y,v,M,g,o)}if(v>=a&&M>=w){const r=u?"black":f[e.base]||"black";t.fillStyle=s&&void 0!==e.qual?(0,p.M)(r).alpha(Math.min(1,e.qual/50)).toHslString():r,t.fillText(c,P+(v-a)/2+1,y+M)}}else if("deletion"===e.type&&_){const r=e.length;if(!h||r>=10){d(t,P,y,Math.abs(P-T),M,g,l.deletion),m.push({type:"deletion",seq:`${e.length}`}),b.push(P,y,T,y+M);const r=`${e.length}`,o=(0,i.measureText)(r,10);v>=o&&M>=w&&(t.fillStyle=f.deletion,t.fillText(r,(P+T)/2-o/2,y+M))}}else if("insertion"===e.type&&_){const r=P+R,o=+e.base||e.length,n=Math.max(0,Math.min(1.2,1/x));if(o<10&&!h&&(d(t,r,y,n,M,g,l.insertion),1/x>=a&&M>=w)){m.push({type:"insertion",seq:e.insertedBases||"unknown"}),b.push(P-2,y,P+n+2,y+M);const o=Math.round(r-n);d(t,o,y,3*n,1,g),d(t,o,y+M-1,3*n,1,g),t.fillText(`(${e.base})`,r+3,y+M)}}else if("hardclip"===e.type||"softclip"===e.type){const r=P+R,n=l[e.type],i=Math.max(o,C);if(d(t,r,y,i,M,g,n),1/x>=a&&M>=w){const o=r-i;d(t,o,y,3*i,1,g),d(t,o,y+M-1,3*i,1,g),t.fillText(`(${e.base})`,r+3,y+M)}}else if("skip"===e.type&&P+v>0){const e=v-(x>10?1.5:0);d(t,Math.max(0,P),y+M/2-1,e+Math.min(P,0),1,g,l.skip)}}if(_)for(const e of v){const r=S+e.start,o=e.length,s=+e.base||e.length;if("insertion"===e.type&&s>=10){const[a]=(0,i.bpSpanPx)(r,r+o,A,x),p=`${s}`;if(m.push({type:"insertion",seq:e.insertedBases||"unknown"}),b.push(a-3,y,a+4,y+M),x>n)d(t,a-1,y,2,M,g,l.insertion);else if(M>c){const e=(0,i.measureText)(p),r=5;d(t,a-e/2-r,y,e+2*r,M,g,"purple"),t.fillStyle=f.insertion,t.fillText(p,a-e/2,y+M)}else{const e=2;d(t,a-e,y,2*e,M,g,l.insertion)}}}return{coords:b,items:m}}({ctx:t,feat:e,renderArgs:a,hideSmallIndels:O,mismatchAlpha:v,drawSNPsMuted:q,drawIndels:!0,largeInsertionIndicatorScale:R,minSubfeatureWidth:w,charWidth:k,charHeight:B,colorMap:E,colorContrastMap:W,canvasWidth:r});for(let t=0,e=s.coords.length;t<e;t++)H.push(s.coords[t]);for(let t=0,e=s.items.length;t<e;t++)D.push(s.items[t]);A&&function({ctx:t,feat:e,renderArgs:r,config:n,theme:s,colorMap:a,canvasWidth:c}){const{feature:l,topPx:p,heightPx:h}=e,{regions:g,bpPerPx:_}=r,m=g[0],b=(0,o.readConfObject)(n,"minSubfeatureWidth"),x=l.get("mismatches"),P=l.get("seq"),{charWidth:M,charHeight:y}=u();if(!P||!x)return;const T=y-2;let A=0,S=0;const C=l.get("CIGAR"),v=(0,f.parseCigar)(C);for(let e=0;e<v.length;e+=2){const r=v[e+1],o=+v[e];if("S"===r){for(let r=0;r<o;r++){const n=P[A+r],f=l.get("start")-(0===e?o:0)+S+r,[g,u]=(0,i.bpSpanPx)(f,f+1,m,_),x=Math.max(b,u-g),y=a[n]||"#000000";t.fillStyle=y,d(t,g,p,x,h,c),x>=M&&h>=T&&(t.fillStyle=s.palette.getContrastText(y),t.fillText(n,g+(x-M)/2+1,p+h))}A+=o}"N"===r&&(S+=o),"M"!==r&&"="!==r&&"X"!==r||(S+=o,A+=o),"D"===r&&(S+=o),"I"===r&&(A+=o)}}({ctx:t,feat:e,renderArgs:a,colorMap:E,config:T,theme:N,canvasWidth:r})});const L=new s.A(Math.max(D.length,1));if(H.length)for(let t=0;t<H.length;t+=4)L.add(H[t],H[t+1],H[t+2],H[t+3]);else L.add(0,0);return L.finish(),{flatbush:L.data,items:D}}}}]);
//# sourceMappingURL=2812.3eb59f98.chunk.js.map