"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8704],{58704:(e,t,a)=>{a.r(t),a.d(t,{default:()=>ee});var n=a(7552),r=a(99546),l=a(48171),s=a(98360),c=a(29629),o=a(25467),i=a(68446),d=a(68584),m=a(36715),p=a(85059),u=a(27897),g=a(96403),f=a(22133),k=a(5401),E=a(9937),h=a(36422),b=a(75785),y=a(49823),A=a(91468),v=a(87731),N=a(1343),T=a(33371),w=a(32808),S=a(374),x=a(25762),C=a(943),D=a(17125),I=a(1773),M=a(25355),P=a(58181),W=a(13197),O=a(93117),j=a(61723);const B=(0,b.n9)()((e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}}))),U=(0,i.observer)((function({model:e}){const{classes:t}=B(),[a,r]=(0,n.useState)(""),[l,s]=(0,n.useState)(""),[c,o]=(0,n.useState)(["Name","ID"]),[i,d]=(0,n.useState)(["CDS","exon"]),m=[{label:"Indexing attributes",values:c},{label:"Feature types to exclude",values:i}];return(0,n.useEffect)((()=>{e.setTextIndexingConf({attributes:c,exclude:i})}),[e,c,i]),n.createElement(C.A,{className:t.paper},n.createElement(D.A,null,"Indexing configuration"),m.map(((e,m)=>n.createElement(I.A,{raised:!0,key:e.label,className:t.card},n.createElement(M.A,null,n.createElement(D.A,null,e.label),n.createElement(P.A,{disablePadding:!0},e.values.map(((t,a)=>n.createElement(W.Ay,{key:`${t}-${a}`,disableGutters:!0},n.createElement(N.A,{value:t,slotProps:{input:{endAdornment:n.createElement(O.A,{position:"end"},n.createElement(j.A,{onClick:()=>{const t=e.values.filter(((e,t)=>t!==a));0===m?o(t):d(t)}},n.createElement(x.A,null)))}}})))),n.createElement(W.Ay,{disableGutters:!0},n.createElement(N.A,{value:0===m?a:l,placeholder:"add new",onChange:e=>{0===m?r(e.target.value):s(e.target.value)},slotProps:{input:{endAdornment:n.createElement(O.A,{position:"end"},n.createElement(j.A,{onClick:()=>{0===m?(o([...c,a]),r("")):(d([...i,l]),s(""))},disabled:0===m?""===a:""===l,"data-testid":"stringArrayAdd-Feat"},n.createElement(S.A,null)))}}}))))))))}));var F=a(55851);const J=(0,b.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),_=(0,i.observer)((({model:e})=>{const{classes:t}=J(),{trackAdapter:a}=e,{pluginManager:l}=(0,r.getEnv)(e);return n.createElement(N.A,{className:t.spacing,value:"UNKNOWN"!==a?.type?a?.type:"",label:"Adapter type",variant:"outlined",helperText:"Select an adapter type",select:!0,fullWidth:!0,onChange:t=>{e.setAdapterHint(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}}},Object.entries(function(e){const t={};return e.forEach((e=>{const a=e.adapterMetadata?.category||"Default";t[a]||(t[a]=[]),t[a].push(e)})),t}(l.getAdapterElements().filter((e=>!e.adapterMetadata?.hiddenFromGUI)))).map((([e,t])=>[n.createElement(F.A,{key:e},e),t.map((e=>n.createElement(c.A,{key:e.name,value:e.name},e.displayName)))])))})),G=(0,b.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),$=(0,i.observer)((({model:e})=>{const{classes:t}=G(),{pluginManager:a}=(0,r.getEnv)(e),{trackType:l}=e,s=a.getTrackElements();return n.createElement(N.A,{className:t.spacing,value:l,variant:"outlined",label:"Track type",helperText:"Select track type",select:!0,fullWidth:!0,onChange:t=>{e.setTrackType(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}}},s.map((({name:e,displayName:t})=>n.createElement(c.A,{key:e,value:e},t))))})),R=(0,b.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function q({trackAdapter:e,trackType:t}){const{classes:a}=R(),{type:r,subadapter:l}=e;return"SNPCoverageAdapter"===r?n.createElement(m.A,{className:a.spacing},"Selected ",n.createElement("code",null,t),". Using adapter ",n.createElement("code",null,r)," with subadapter ",n.createElement("code",null,l?.type),". Please enter a track name and, if necessary, update the track type."):n.createElement(m.A,{className:a.spacing},"Using adapter ",n.createElement("code",null,r)," and guessing track type"," ",n.createElement("code",null,t),". Please enter a track name and, if necessary, update the track type.")}function L({model:e}){const{classes:t}=R();return n.createElement(n.Fragment,null,n.createElement(m.A,{className:t.spacing},"JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse to see if they support this data type or"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type."),n.createElement(_,{model:e}))}const H=(0,i.observer)((function({model:e}){const{classes:t}=R(),[a,s]=(0,n.useState)(!0),c=(0,r.getSession)(e),{trackName:o,unsupported:i,trackAdapter:d,trackType:p,warningMessage:u,adapterHint:g}=e;if((0,n.useEffect)((()=>{""===g&&d&&e.setAdapterHint(d.type)}),[g,d,d?.type,e]),i)return n.createElement(m.A,{className:t.spacing},"This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer"},"check for new releases")," ","of JBrowse or"," ",n.createElement(v.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer"},"file an issue")," ","and add a feature request for this data type.");if(d?.type===A.UNKNOWN)return n.createElement(L,{model:e});if(!d?.type)return n.createElement(m.A,null,"Could not recognize this data type.");const f=(0,r.isSupportedIndexingAdapter)(d.type);return n.createElement("div",null,n.createElement(q,{trackAdapter:d,trackType:p}),u?n.createElement(m.A,{style:{color:"orange"}},u):null,n.createElement(N.A,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:o,onChange:t=>{e.setTrackName(t.target.value)},slotProps:{htmlInput:{"data-testid":"trackNameInput"}}}),n.createElement(_,{model:e}),n.createElement($,{model:e}),n.createElement(y.AssemblySelector,{session:c,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>{e.setAssembly(t)},TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}}),r.isElectron&&f&&n.createElement(l.A,null,n.createElement(T.A,{label:"Index track for text searching?",control:n.createElement(w.A,{checked:a,onChange:t=>{s(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})),r.isElectron&&a&&f?n.createElement(U,{model:e}):null)})),K=(0,b.n9)()((e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}}))),z=(0,i.observer)((function({model:e}){const{classes:t}=K(),a=(0,h.getRoot)(e);return n.createElement(C.A,{className:t.paper},n.createElement(y.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),n.createElement("div",{className:t.spacer}),n.createElement(y.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a}))})),Y=(0,b.n9)()((e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}}))),Q=["Enter track data","Confirm track type"],V=(0,i.observer)((function({model:e}){const[t,a]=(0,n.useState)(0),{classes:l}=Y(),{jobsManager:s}=(0,h.getRoot)(e),c=(0,r.getSession)(e),{assembly:o,trackAdapter:i,trackData:b,trackName:y,trackType:A,textIndexTrack:v,textIndexingConf:N}=e,[T,w]=(0,n.useState)();async function S(){if(t!==Q.length-1)return void a(t+1);const n=[`${y.toLowerCase().replaceAll(" ","_")}-${Date.now()}`,c.adminMode?"":"-sessionTrack"].join(""),l=c.assemblyManager.get(o);if((0,r.isSessionWithAddTracks)(c))if(l&&i&&"UNKNOWN"!==i.type){if(c.addTrackConf({trackId:n,type:A,name:y,assemblyNames:[o],adapter:{...i,sequenceAdapter:(0,d.getConf)(l,["sequence","adapter"])}}),e.view.showTrack?.(n),r.isElectron&&v&&(0,r.isSupportedIndexingAdapter)(i.type)){const e=`${y}-index`,t={indexingParams:{...N||{attributes:["Name","ID"],exclude:["CDS","exon"]},assemblies:[o],tracks:[n],indexType:"perTrack",name:e,timestamp:(new Date).toISOString()},name:e,cancelCallback:()=>s.abortJob()};s.queueJob(t)}e.clearData(),(0,r.isSessionModelWithWidgets)(c)&&c.hideWidget(e)}else w("Failed to add track.\nThe configuration of this file is not currently supported.");else w("Unable to add tracks to this model")}function x(){switch(t){case 0:return!b;case 1:return!(y&&A&&i?.type&&o);default:return!0}}return n.createElement("div",{className:l.root},n.createElement(p.A,{className:l.stepper,activeStep:t,orientation:"vertical"},Q.map(((r,s)=>n.createElement(u.A,{key:r},n.createElement(g.A,null,r),n.createElement(f.A,null,function(t){switch(t){case 0:return n.createElement(z,{model:e});case 1:return n.createElement(H,{model:e});default:return n.createElement(m.A,null,"Unknown step")}}(s),n.createElement("div",{className:l.actionsContainer},n.createElement(k.A,{disabled:0===t,onClick:()=>{w(void 0),a(t-1)},className:l.button},"Back"),n.createElement(k.A,{disabled:x(),variant:"contained",color:"primary",onClick:S,className:l.button,"data-testid":"addTrackNextButton"},t===Q.length-1?"Add":"Next")),T?n.createElement("div",{className:l.alertContainer},n.createElement(E.A,{severity:"error"},T)):null))))))})),X=(0,b.n9)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),Z=(0,i.observer)((function({model:e}){const{classes:t}=X(),[a,l]=(0,n.useState)(""),[s,c]=(0,n.useState)();return n.createElement("div",null,s?n.createElement(y.ErrorMessage,{error:s}):null,n.createElement(N.A,{multiline:!0,rows:10,value:a,onChange:e=>{l(e.target.value)},placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox}),n.createElement(k.A,{variant:"contained",className:t.submit,onClick:()=>{try{c(void 0);const t=(0,r.getSession)(e),n=JSON.parse(a),l=Array.isArray(n)?n:[n];(0,r.isSessionWithAddTracks)(t)&&(0,r.isSessionModelWithWidgets)(t)&&(l.forEach((e=>{t.addTrackConf(e)})),l.forEach((t=>e.view.showTrack(t.trackId))),e.clearData(),t.hideWidget(e))}catch(e){console.error(e),c(e)}}},"Submit"))})),ee=(0,i.observer)((function({model:e}){const[t,a]=(0,n.useState)("Default add track workflow"),i={"Default add track workflow":V,"Add track JSON":Z,...Object.fromEntries((0,r.getEnv)(e).pluginManager.getAddTrackWorkflowElements().map((e=>[e.name,e.ReactComponent])))},d=i[t]?t:"Default add track workflow",m=i[d];return n.createElement(n.Fragment,null,n.createElement(l.A,null,n.createElement(s.A,{value:d,onChange:e=>{a(e.target.value)}},Object.keys(i).map((e=>n.createElement(c.A,{key:e,value:e},e)))),n.createElement(o.A,null,"Type of add track workflow")),n.createElement(n.Suspense,{fallback:null},n.createElement(m,{model:e})))}))}}]);
//# sourceMappingURL=8704.d8bc2088.chunk.js.map