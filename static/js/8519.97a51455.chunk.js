"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8519],{88519(e,t,n){n.r(t),n.d(t,{default:()=>V});var s=n(55614),i=n(30128),o=n(62456),l=n(23886),r=n(61425),d=n(69566),a=n(62088),c=n(51049),h=n(46625),x=n(44460);const g=(0,h.n)()({loading:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.15)",backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.05) 8px, rgba(0, 0, 0, 0.05) 16px)",pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},loadingMessage:{zIndex:2,pointerEvents:"none"}}),u=(0,d.observer)(function({model:e,children:t}){const{error:n,regionTooLarge:s}=e;return n?(0,x.jsx)(a.A,{error:n}):s?e.regionCannotBeRendered():(0,x.jsx)(m,{model:e,children:t})}),m=(0,d.observer)(function({model:e,children:t}){const{drawn:n,loading:s}=e;return(0,x.jsxs)("div",{"data-testid":`drawn-${n}`,children:[t,s?(0,x.jsx)(v,{model:e}):null]})}),v=(0,d.observer)(function({model:e}){const{classes:t}=g(),{statusMessage:n}=e;return(0,x.jsx)("div",{className:t.loading,children:(0,x.jsx)("div",{className:t.loadingMessage,children:(0,x.jsx)(c.A,{message:n})})})}),f=u;var p=n(64337),j=n(43565),b=n(23409),y=n(1346),w=n(99703),P=n(94938);const k=Math.sqrt(2);function M(e){const t=(0,s.c)(17),{item:n,x:i,y:l,ldMetric:r,signedLD:d}=e;let a;a="dprime"===r?"D'":d?"R":"RÂ²";const c=i+15;let h,g,u;t[0]!==c||t[1]!==l?(h={x:c,y:l},t[0]=c,t[1]=l,t[2]=h):h=t[2],t[3]!==n.snp1.id?(g=(0,x.jsx)("div",{children:n.snp1.id}),t[3]=n.snp1.id,t[4]=g):g=t[4],t[5]!==n.snp2.id?(u=(0,x.jsx)("div",{children:n.snp2.id}),t[5]=n.snp2.id,t[6]=u):u=t[6];const m=a;let v,f,p;return t[7]!==n.ldValue?(v=n.ldValue.toFixed(3),t[7]=n.ldValue,t[8]=v):v=t[8],t[9]!==a||t[10]!==v?(f=(0,x.jsxs)("div",{children:[m,": ",v]}),t[9]=a,t[10]=v,t[11]=f):f=t[11],t[12]!==h||t[13]!==g||t[14]!==u||t[15]!==f?(p=(0,x.jsxs)(o.A,{clientPoint:h,children:[g,u,f]}),t[12]=h,t[13]=g,t[14]=u,t[15]=f,t[16]=p):p=t[16],p}function $(e){const t=(0,s.c)(60),{hoveredItem:n,cellWidth:i,genomicX1:o,genomicX2:l,yScalar:r,lineZoneHeight:d,tickHeight:a,width:c,height:h,useGenomicPositions:g,snps:u,regionStart:m,bpPerPx:v,canvasOffset:f}=e,{i:p,j}=n;let b;t[0]!==d||t[1]!==r?(b=(e,t)=>({x:(e+t)/k,y:(t-e)/k*r+d}),t[0]=d,t[1]=r,t[2]=b):b=t[2];const y=b;let w,P,M,$;if(g&&u.length>0){let e;t[3]!==v||t[4]!==m||t[5]!==u?(e=e=>{const t=u[e].start;return(((e>0?u[e-1].start:m)+t)/2-m)/v/k},t[3]=v,t[4]=m,t[5]=u,t[6]=e):e=t[6];const n=e;let s;t[7]!==v||t[8]!==m||t[9]!==u?(s=e=>e+1<u.length?((u[e].start+u[e+1].start)/2-m)/v/k:(u[u.length-1].start+50*v-m)/v/k,t[7]=v,t[8]=m,t[9]=u,t[10]=s):s=t[10];const i=s,r=n(j),a=n(p),c=(r+i(j))/2,h=(a+i(p))/2;let x,g,f;t[11]!==c||t[12]!==h||t[13]!==y?(x=y(c,h),t[11]=c,t[12]=h,t[13]=y,t[14]=x):x=t[14],w=x,t[15]!==o||t[16]!==d?(g={x:o,y:d},t[15]=o,t[16]=d,t[17]=g):g=t[17],P=g,t[18]!==l||t[19]!==d?(f={x:l,y:d},t[18]=l,t[19]=d,t[20]=f):f=t[20],M=f}else{const e=i,n=(j+.5)*e,s=(p+.5)*e;let o;t[21]!==n||t[22]!==s||t[23]!==y?(o=y(n,s),t[21]=n,t[22]=s,t[23]=y,t[24]=o):o=t[24],w=o;const l=(j+.5)*e,r=(j+.5)*e;let d;t[25]!==l||t[26]!==r||t[27]!==y?(d=y(l,r),t[25]=l,t[26]=r,t[27]=y,t[28]=d):d=t[28],P=d;const a=(p+.5)*e,c=(p+.5)*e;let h;t[29]!==a||t[30]!==c||t[31]!==y?(h=y(a,c),t[29]=a,t[30]=c,t[31]=y,t[32]=h):h=t[32],M=h}t[33]!==f||t[34]!==h||t[35]!==c?($={position:"absolute",left:f,top:0,width:c,height:h,pointerEvents:"none"},t[33]=f,t[34]=h,t[35]=c,t[36]=$):$=t[36];const L=`M ${P.x} ${P.y} L ${w.x} ${w.y} L ${M.x} ${M.y}`;let C,V;t[37]!==L?(C=(0,x.jsx)("path",{stroke:"rgba(0, 0, 0, 0.6)",strokeWidth:1,fill:"none",d:L}),t[37]=L,t[38]=C):C=t[38],t[39]!==o||t[40]!==l||t[41]!==M.x||t[42]!==M.y||t[43]!==P.x||t[44]!==P.y||t[45]!==a||t[46]!==g?(V=g?null:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("path",{d:`M ${P.x} ${P.y} L ${o} ${a}`}),(0,x.jsx)("path",{d:`M ${M.x} ${M.y} L ${l} ${a}`})]}),t[39]=o,t[40]=l,t[41]=M.x,t[42]=M.y,t[43]=P.x,t[44]=P.y,t[45]=a,t[46]=g,t[47]=V):V=t[47];const A=`M ${o} 0 L ${o} ${a}`;let D;t[48]!==A?(D=(0,x.jsx)("path",{d:A}),t[48]=A,t[49]=D):D=t[49];const G=`M ${l} 0 L ${l} ${a}`;let I,H,R;return t[50]!==G?(I=(0,x.jsx)("path",{d:G}),t[50]=G,t[51]=I):I=t[51],t[52]!==V||t[53]!==D||t[54]!==I?(H=(0,x.jsxs)("g",{stroke:"#e00",strokeWidth:"1.5",fill:"none",children:[V,D,I]}),t[52]=V,t[53]=D,t[54]=I,t[55]=H):H=t[55],t[56]!==H||t[57]!==$||t[58]!==C?(R=(0,x.jsxs)("svg",{style:$,children:[C,H]}),t[56]=H,t[57]=$,t[58]=C,t[59]=R):R=t[59],R}const L=(0,d.observer)(function({model:e}){const t=(0,l.getContainingView)(e),n=Math.round(t.dynamicBlocks.totalWidthPx),{fullyDrawn:s,flatbush:o,flatbushItems:d,yScalar:a,cellWidth:c,showLegend:h,ldMetric:g,lineZoneHeight:u,fitToHeight:m,ldCanvasHeight:v,useGenomicPositions:f,snps:L,lastDrawnOffsetPx:C,signedLD:V}=e,A=m?v:n/2,D=A+u,[G,I]=(0,i.useState)(),[H,R]=(0,i.useState)(),S=(0,i.useRef)(null),W=t.dynamicBlocks.contentBlocks[0],B=t.bpPerPx,E=G&&W?(G.snp2.start-W.start)/B:void 0,X=G&&W?(G.snp1.start-W.start)/B:void 0,_=t.offsetPx>=0?(C??0)-t.offsetPx:Math.max(0,-t.offsetPx),T=_;(0,i.useEffect)(()=>(void 0!==E&&void 0!==X&&e.showVerticalGuides?t.setVolatileGuides([{xPos:E+T},{xPos:X+T}]):t.setVolatileGuides([]),()=>{t.setVolatileGuides([])}),[E,X,e.showVerticalGuides,t,T]);const Z=(0,i.useMemo)(()=>o?r.A.from(o):null,[o]),O=(0,i.useCallback)(t=>{e.setRef(t)},[e,n,A]),z=(0,i.useCallback)(e=>{const t=S.current;if(!t||!Z||!d.length)return I(void 0),void R(void 0);const n=t.getBoundingClientRect(),s=_,i=e.clientX-n.left-s,o=e.clientY-n.top;if(R({x:e.clientX,y:e.clientY}),o<u)return void I(void 0);const{x:l,y:r}=function(e,t,n,s){const i=(t-s)/n;return{x:(e-i)/k,y:(e+i)/k}}(i,o,a,u),c=Z.search(l-1,r-1,l+1,r+1);if(c.length>0){const e=d[c[0]];I(e)}else I(void 0)},[Z,d,a,u,_]),F=(0,i.useCallback)(()=>{I(void 0),R(void 0)},[]);return(0,x.jsxs)("div",{ref:S,style:{cursor:G&&H?"crosshair":void 0,position:"relative",width:n,height:D,overflow:"hidden"},onMouseMove:z,onMouseLeave:F,children:[(0,x.jsx)("canvas",{"data-testid":"ld_canvas"+(s?"_done":""),ref:O,style:{width:n,height:A,position:"absolute",left:_,top:u},width:2*n,height:2*A}),G&&void 0!==E&&void 0!==X?(0,x.jsx)($,{hoveredItem:G,cellWidth:c,genomicX1:E,genomicX2:X,yScalar:a,lineZoneHeight:u,tickHeight:e.tickHeight,width:n,height:D,useGenomicPositions:f,snps:L,regionStart:W?.start??0,bpPerPx:B,canvasOffset:_}):null,G&&H?(0,x.jsx)(M,{item:G,x:H.x,y:H.y,ldMetric:g,signedLD:V}):null,h?(0,x.jsx)(p.Ay,{ldMetric:g,signedLD:V}):null,f?(0,x.jsx)(y.A,{model:e,children:(0,x.jsx)(b.A,{model:e})}):(0,x.jsx)(j.A,{model:e}),e.showRecombination&&e.recombination?(0,x.jsxs)("div",{style:{position:"absolute",left:_,top:u/2,width:n,height:u/2,pointerEvents:"none"},children:[(0,x.jsx)(w.A,{model:e,width:n,height:u/2,useGenomicPositions:f,regionStart:W?.start,bpPerPx:B}),(0,x.jsx)(P.A,{height:u/2,maxValue:Math.max(...e.recombination.values,.1)})]}):null]})}),C=(0,d.observer)(function({model:e}){const t=(0,l.getContainingView)(e),n=Math.round(t.dynamicBlocks.totalWidthPx),{height:s,showLDTriangle:i,showRecombination:o}=e;return t.bpPerPx>1e3?(0,x.jsx)("div",{style:{width:n,height:s,display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Zoom in to see LD data"}):i||o?(0,x.jsx)("div",{style:{position:"relative",width:n,height:s},children:i?(0,x.jsx)(L,{model:e}):null}):(0,x.jsx)("div",{style:{width:n,height:s,display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Enable LD triangle or recombination track in display settings"})}),V=(0,d.observer)(function({model:e}){return(0,x.jsx)(f,{model:e,children:(0,x.jsx)(C,{model:e})})})}}]);
//# sourceMappingURL=8519.97a51455.chunk.js.map