"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5054,9326],{1832(t,e,n){n.d(e,{P:()=>a});var s=n(23886);function a(t,e,n=()=>{}){const a=new TextDecoder("utf8");let r=0,o=0;for(;r<t.length;){const c=t.indexOf(10,r),i=-1===c?t.length:c,l=t.subarray(r,i),u=a.decode(l).trim();if(u&&!1===e(u,o))break;o++%1e4==0&&n(`Loading ${(0,s.getProgressDisplayStr)(r,t.length)}`),r=i+1}}},5054(t,e,n){n.d(e,{default:()=>i});var s=n(23886),a=n(11931),r=n(1832),o=n(79326),c=n(75780);class i extends o.default{async setupPre(t){const e=[];return(0,r.P)(await(0,s.fetchAndMaybeUnzip)((0,a.openLocation)(this.getConf("outLocation"),this.pluginManager),t),t=>(e.push(function(t){const e=t.split(" ");if(e.length<9)throw new Error(`improperly formatted line: ${t}`);const[n,,s,a,r,o,,c,i,l]=e;return{tname:o,tstart:+c,tend:+i,qname:n,qstart:+s,qend:+a,strand:"-"===r?-1:1,extra:{mappingQual:+l}}}(t)),!0),t?.statusCallback),(0,c.W)(e)}}},79326(t,e,n){n.d(e,{default:()=>p});var s=n(90946),a=n(23886),r=n(11931),o=n(1832),c=n(49303),i=n(25529),l=n(153),u=n(64738),m=n(5843),f=n(75780);const{eL:h}=l;class p extends s.L{static capabilities=["getFeatures","getRefNames"];async setup(t){return this.setupP||(this.setupP=this.setupPre(t).catch(t=>{throw this.setupP=void 0,t})),this.setupP}async setupPre(t){const e=[];return(0,o.P)(await(0,a.fetchAndMaybeUnzip)((0,r.openLocation)(this.getConf("pafLocation"),this.pluginManager),t),t=>(e.push((0,m.xI)(t)),!0),t?.statusCallback),(0,f.W)(e)}async hasDataForRefName(){return!0}getAssemblyNames(){const t=this.getConf("assemblyNames");return 0===t.length?[this.getConf("queryAssembly"),this.getConf("targetAssembly")]:t}async getRefNames(t={}){const e=t.regions?.[0].assemblyName,n=await this.setup(t),s=this.getAssemblyNames().indexOf(e);if(-1!==s){const t=new Set;for(const e of n)t.add(0===s?e.qname:e.tname);return[...t]}return console.warn("Unable to do ref renaming on adapter"),[]}getFeatures(t,e={}){return(0,i.ObservableCreate)(async n=>{const s=await this.setup(e),a=this.getAssemblyNames(),{start:r,end:o,refName:i,assemblyName:l}=t,f=a.indexOf(l),p=0===f;-1===f&&(console.warn(`${l} not found in this adapter`),n.complete());for(let t=0;t<s.length;t++){const e=s[t];let f=0,d=0,g="",b="",y=0,w=0;p?(f=e.qstart,d=e.qend,g=e.qname,b=e.tname,y=e.tstart,w=e.tend):(f=e.tstart,d=e.tend,g=e.tname,b=e.qname,y=e.qstart,w=e.qend);const{extra:q,strand:x}=e;if(g===i&&(0,c.R6)(r,o,f,d)){const{numMatches:e=0,blockLen:s=1,cg:r,...o}=q;let c=q.cg;q.cg&&(p&&-1===x?c=(0,m.qm)(h(q.cg)).join(""):p&&(c=(0,m.gJ)(q.cg))),n.next(new u.A({uniqueId:t+l,assemblyName:l,start:f,end:d,type:"match",refName:g,strand:x,...o,CIGAR:c,syntenyId:t,identity:e/s,numMatches:e,blockLen:s,mate:{start:y,end:w,refName:b,assemblyName:a[+p]}}))}}n.complete()})}}},75780(t,e,n){function s(t){const e={};for(const n of t){const t=`${n.qname}-${n.tname}`,s=n.extra.mappingQual||1,a=n.extra.blockLen||1,r=e[t];r?(r.valueSum+=s*a,r.weightSum+=a):e[t]={valueSum:s*a,weightSum:a}}const n={};let s=1/0,a=-1/0;for(const[t,{valueSum:r,weightSum:o}]of Object.entries(e)){const e=r/o;n[t]=e,s=Math.min(e,s),a=Math.max(e,a)}const r=a-s;for(const e of t){const t=n[`${e.qname}-${e.tname}`];e.extra.meanScore=r>0?(t-s)/r:1}return t}n.d(e,{W:()=>s})},64738(t,e,n){n.d(e,{A:()=>o});var s=n(43102),a=n(153);const{DQ:r}=a;class o extends s.A{get(t){return"mismatches"===t?r(this.get("CIGAR")):super.get(t)}}},5843(t,e,n){n.d(e,{TA:()=>r,fY:()=>a,gJ:()=>i,qm:()=>c,xI:()=>o});var s=n(23886);function a(t){return new Map(t.split(/\n|\r\n|\r/).filter(t=>!!t&&!t.startsWith("#")).map(t=>{const[e,n,s,a,r,o]=t.split("\t");return[a,{refName:e,start:+n,end:+s,score:+r,name:a,strand:"-"===o?-1:1}]}))}async function r(t,e){return(0,s.fetchAndMaybeUnzipText)(t,e)}function o(t){const e=t.split("\t"),n=e.slice(12),s={numMatches:+e[9],blockLen:+e[10],mappingQual:+e[11]};if(n.length)for(const t of n){const e=t.indexOf(":");s[t.slice(0,e)]=t.slice(e+3)}return{tname:e[5],tstart:+e[7],tend:+e[8],qname:e[0],qstart:+e[2],qend:+e[3],strand:"-"===e[4]?-1:1,extra:s}}function c(t){const e=[];for(let n=t.length-2;n>=0;n-=2){e.push(t[n]);const s=t[n+1];"D"===s?e.push("I"):"I"===s?e.push("D"):e.push(s)}return e}function i(t){return t.replaceAll("D","K").replaceAll("I","D").replaceAll("K","I")}}}]);
//# sourceMappingURL=5054.b37e4784.chunk.js.map