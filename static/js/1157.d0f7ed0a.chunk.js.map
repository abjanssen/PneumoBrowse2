{"version":3,"file":"static/js/1157.d0f7ed0a.chunk.js","mappings":"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","sources":["../../../node_modules/.pnpm/@mui+icons-material@7.3.7_@mui+material@7.3.7_@emotion+react@11.14.0_@types+react@19.2._30e1b55107c86a25823f59a01e2da619/node_modules/@mui/icons-material/esm/BookmarkAdd.js","components/ShareDialogLinkField.tsx","components/ShareDialog.tsx"],"sourcesContent":["\"use client\";\n\nimport createSvgIcon from \"./utils/createSvgIcon.js\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon(/*#__PURE__*/_jsx(\"path\", {\n  d: \"M21 7h-2v2h-2V7h-2V5h2V3h2v2h2zm-2 14-7-3-7 3V5c0-1.1.9-2 2-2h7c-.63.84-1 1.87-1 3 0 2.76 2.24 5 5 5 .34 0 .68-.03 1-.1z\"\n}), 'BookmarkAdd');","import { TextField } from '@mui/material'\n\nexport default function ShareDialogLinkField({ url }: { url: string }) {\n  return (\n    <TextField\n      label=\"URL\"\n      value={url}\n      variant=\"filled\"\n      fullWidth\n      onClick={event => {\n        const target = event.target as HTMLTextAreaElement\n        target.select()\n      }}\n      slotProps={{\n        input: {\n          readOnly: true,\n        },\n      }}\n    />\n  )\n}\n","import { lazy, useEffect, useState } from 'react'\n\nimport { Dialog, ErrorMessage } from '@jbrowse/core/ui'\nimport {\n  type AbstractSessionModel,\n  localStorageGetItem,\n} from '@jbrowse/core/util'\nimport { getSnapshot } from '@jbrowse/mobx-state-tree'\nimport BookmarkAddIcon from '@mui/icons-material/BookmarkAdd'\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy'\nimport SettingsIcon from '@mui/icons-material/Settings'\nimport {\n  Button,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n  IconButton,\n  Typography,\n} from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { shareSessionToDynamo } from '../sessionSharing.ts'\nimport { setQueryParams } from '../useQueryParam.ts'\nimport { toUrlSafeB64 } from '../util.ts'\nimport ShareDialogLinkField from './ShareDialogLinkField.tsx'\n\nconst SettingsDialog = lazy(() => import('./ShareSettingsDialog.tsx'))\n\nconst SHARE_URL_LOCALSTORAGE_KEY = 'jbrowse-shareURL'\n\nconst ShareDialog = observer(function ShareDialog({\n  handleClose,\n  session,\n}: {\n  handleClose: () => void\n  session: AbstractSessionModel & { shareURL: string }\n}) {\n  const [sessionParam, setSessionParam] = useState('')\n  const [passwordParam, setPasswordParam] = useState('')\n  const [shortUrl, setShortUrl] = useState('')\n  const [longUrl, setLongUrl] = useState('')\n  const [loading, setLoading] = useState(true)\n  const [error, setError] = useState<unknown>()\n  const [settingsDialogOpen, setSettingsDialogOpen] = useState(false)\n\n  const url = session.shareURL\n  const currentSetting =\n    localStorageGetItem(SHARE_URL_LOCALSTORAGE_KEY) || 'short'\n  const snap = getSnapshot(session)\n\n  useEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    ;(async () => {\n      // checking !error allows retry when error state is cleared\n      if (error) {\n        return\n      }\n      try {\n        if (currentSetting === 'short') {\n          setLoading(true)\n          const locationUrl = new URL(window.location.href)\n          const result = await shareSessionToDynamo(snap, url, locationUrl.href)\n          const params = new URLSearchParams(locationUrl.search)\n          params.set('session', `share-${result.json.sessionId}`)\n          params.set('password', result.password)\n          locationUrl.search = params.toString()\n          setShortUrl(locationUrl.href)\n\n          setSessionParam(`share-${result.json.sessionId}`)\n          setPasswordParam(result.password)\n        } else {\n          const sess = await toUrlSafeB64(JSON.stringify(getSnapshot(session)))\n          const longUrl = new URL(window.location.href)\n          const longParams = new URLSearchParams(longUrl.search)\n          longParams.set('session', `encoded-${sess}`)\n          setSessionParam(`encoded-${sess}`)\n          longUrl.search = longParams.toString()\n          setLongUrl(longUrl.toString())\n        }\n      } catch (e) {\n        console.error(e)\n        setError(e)\n      } finally {\n        setLoading(false)\n      }\n    })()\n  }, [currentSetting, error, session, url, snap])\n\n  const disabled = (currentSetting === 'short' && loading) || !!error\n  return (\n    <>\n      <Dialog\n        maxWidth=\"xl\"\n        open\n        onClose={handleClose}\n        title=\"JBrowse Shareable Link\"\n      >\n        <DialogContent>\n          <DialogContentText>\n            Copy the URL below to share your current JBrowse session.\n            <IconButton\n              onClick={() => {\n                setSettingsDialogOpen(true)\n              }}\n            >\n              <SettingsIcon />\n            </IconButton>\n          </DialogContentText>\n\n          {currentSetting === 'short' ? (\n            error ? (\n              <ErrorMessage\n                error={error}\n                onReset={() => {\n                  setError(undefined)\n                }}\n              />\n            ) : loading ? (\n              <Typography>Generating short URL...</Typography>\n            ) : (\n              <ShareDialogLinkField url={shortUrl} />\n            )\n          ) : (\n            <ShareDialogLinkField url={longUrl} />\n          )}\n        </DialogContent>\n        <DialogActions>\n          <Button\n            startIcon={<BookmarkAddIcon />}\n            disabled={disabled}\n            onClick={event => {\n              event.preventDefault()\n              setQueryParams({\n                password: passwordParam,\n                session: sessionParam,\n              })\n              alert('Now press Ctrl+D (PC) or Cmd+D (Mac)')\n            }}\n          >\n            Create browser Bookmark\n          </Button>\n\n          <Button\n            startIcon={<ContentCopyIcon />}\n            disabled={disabled}\n            onClick={async () => {\n              const { default: copy } = await import('copy-to-clipboard')\n              copy(shortUrl || longUrl)\n              session.notify('Copied to clipboard', 'success')\n            }}\n          >\n            Copy to Clipboard\n          </Button>\n\n          <Button onClick={handleClose} autoFocus>\n            Close\n          </Button>\n        </DialogActions>\n      </Dialog>\n\n      <SettingsDialog\n        open={settingsDialogOpen}\n        currentSetting={currentSetting}\n        onClose={() => {\n          setSettingsDialogOpen(false)\n        }}\n      />\n    </>\n  )\n})\n\nexport default ShareDialog\n"],"names":["createSvgIcon","_jsx","d","ShareDialogLinkField","t0","$","_c","url","t1","t2","Symbol","for","input","readOnly","TextField","label","variant","fullWidth","onClick","_temp","slotProps","event","target","select","SettingsDialog","lazy","observer","handleClose","session","sessionParam","setSessionParam","useState","passwordParam","setPasswordParam","shortUrl","setShortUrl","longUrl","setLongUrl","loading","setLoading","error","setError","settingsDialogOpen","setSettingsDialogOpen","shareURL","currentSetting","localStorageGetItem","snap","getSnapshot","useEffect","locationUrl","URL","window","location","href","result","shareSessionToDynamo","params","URLSearchParams","search","set","json","sessionId","password","toString","sess","toUrlSafeB64","JSON","stringify","longParams","e","console","disabled","_jsxs","_Fragment","children","Dialog","maxWidth","open","onClose","title","DialogContent","DialogContentText","IconButton","SettingsIcon","ErrorMessage","onReset","undefined","Typography","DialogActions","Button","startIcon","BookmarkAddIcon","preventDefault","setQueryParams","alert","ContentCopyIcon","async","default","copy","notify","autoFocus"],"ignoreList":[],"sourceRoot":""}