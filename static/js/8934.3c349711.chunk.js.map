{"version":3,"file":"static/js/8934.3c349711.chunk.js","mappings":"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","sources":["webpack://@jbrowse/web/../../plugins/lollipop/src/LollipopRenderer/Layout.ts","webpack://@jbrowse/web/../../plugins/lollipop/src/LollipopRenderer/components/ScoreText.tsx","webpack://@jbrowse/web/../../plugins/lollipop/src/LollipopRenderer/components/Lollipop.tsx","webpack://@jbrowse/web/../../plugins/lollipop/src/LollipopRenderer/components/Stick.tsx","webpack://@jbrowse/web/../../plugins/lollipop/src/LollipopRenderer/components/LollipopRendering.tsx"],"sourcesContent":["import { readConfObject } from '@jbrowse/core/configuration'\nimport { doesIntersect2 } from '@jbrowse/core/util/range'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\n\ninterface LayoutItem {\n  uniqueId: string\n  anchorLocation: number\n  width: number\n  height: number\n  data: { score: number; featureId: string; anchorX: number; radiusPx: number }\n}\n\nexport type LayoutEntry = LayoutItem & { x: number; y: number }\n\nexport class FloatingLayout {\n  width: number\n  totalHeight = 0\n  items: LayoutItem[] = []\n  layout = new Map<string, LayoutEntry>()\n\n  constructor({ width }: { width: number }) {\n    if (!width) {\n      throw new Error('width required to make a new FloatingLayout')\n    }\n    this.width = width\n  }\n\n  add(\n    uniqueId: string,\n    anchorLocation: number,\n    width: number,\n    height: number,\n    data: LayoutItem['data'],\n  ) {\n    this.items.push({\n      uniqueId,\n      anchorLocation,\n      width,\n      height,\n      data,\n    })\n  }\n\n  getLayout(configuration?: AnyConfigurationModel) {\n    if (!configuration) {\n      return this.layout\n    }\n\n    const minY = readConfObject(configuration, 'minStickLength')\n\n    // sort them by score ascending, so higher scores will always end up\n    // stacked last (toward the bottom)\n    const sorted = this.items.sort((a, b) => a.data.score - b.data.score)\n\n    // bump them\n    let maxBottom = 0\n    const layoutEntries: [string, LayoutEntry][] = new Array(sorted.length)\n    for (const [i, element] of sorted.entries()) {\n      const currentItem = element\n      const { anchorLocation, width, height } = currentItem\n      const start = anchorLocation - width / 2\n      const end = start + width\n      let top = minY\n      let bottom = top + height\n\n      // figure out how far down to put it\n      for (let j = 0; j < i; j += 1) {\n        const [, previouslyLaidOutItem] = layoutEntries[j]!\n        const {\n          x: prevStart,\n          y: prevTop,\n          width: prevWidth,\n          height: prevHeight,\n        } = previouslyLaidOutItem\n        const prevEnd = prevStart + prevWidth\n        const prevBottom = prevTop + prevHeight\n        if (\n          doesIntersect2(prevStart, prevEnd, start, end) &&\n          doesIntersect2(prevTop, prevBottom, top, bottom)\n        ) {\n          // bump this one to the bottom of the previous one\n          top = prevBottom\n          bottom = top + height\n          j = -1 // we need to check all of them again after bumping\n        }\n      }\n\n      // record the entry and update the maxBottom\n      layoutEntries[i] = [\n        currentItem.uniqueId,\n        {\n          ...currentItem,\n          x: start,\n          y: top,\n        },\n      ]\n      if (bottom > maxBottom) {\n        maxBottom = bottom\n      }\n    }\n\n    this.totalHeight = maxBottom\n    this.layout = new Map(layoutEntries)\n    return this.layout\n  }\n\n  getTotalHeight() {\n    return this.totalHeight\n  }\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { contrastingTextColor } from '@jbrowse/core/util/color'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport default function ScoreText({\n  feature,\n  config,\n  layoutRecord: {\n    y,\n    data: { anchorX, radiusPx, score },\n  },\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  layoutRecord: {\n    y: number\n    data: { anchorX: number; radiusPx: number; score: number }\n  }\n}) {\n  const innerColor = readConfObject(config, 'innerColor', { feature })\n\n  const scoreString = String(score)\n  const fontWidth = (radiusPx * 2) / scoreString.length\n  const fontHeight = fontWidth * 1.1\n  if (fontHeight < 12) {\n    return null\n  }\n  return (\n    <text\n      style={{\n        pointerEvents: 'none',\n        fontSize: fontHeight,\n        fill: contrastingTextColor(innerColor),\n      }}\n      x={anchorX}\n      y={y + radiusPx - fontHeight / 2.4}\n      textAnchor=\"middle\"\n      dominantBaseline=\"hanging\"\n    >\n      {scoreString}\n    </text>\n  )\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { observer } from 'mobx-react'\n\nimport ScoreText from './ScoreText.tsx'\n\nimport type { LayoutEntry } from '../Layout.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\n\nfunction Circle({\n  cx,\n  cy,\n  r,\n  style,\n  featureId,\n  onFeatureMouseDown,\n  onFeatureMouseEnter,\n  onFeatureMouseOut,\n  onFeatureMouseOver,\n  onFeatureMouseUp,\n  onFeatureMouseLeave,\n  onFeatureMouseMove,\n  onFeatureClick,\n}: {\n  cx: number\n  cy: number\n  r: number\n  style: { fill: string }\n  featureId: string\n  onFeatureMouseDown?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseEnter?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseOut?: (\n    event: React.MouseEvent | React.FocusEvent,\n    id: string,\n  ) => void\n  onFeatureMouseOver?: (\n    event: React.MouseEvent | React.FocusEvent,\n    id: string,\n  ) => void\n  onFeatureMouseUp?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseLeave?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseMove?: (event: React.MouseEvent, id: string) => void\n  onFeatureClick?: (event: React.MouseEvent, id: string) => void\n}) {\n  return (\n    <circle\n      cx={cx}\n      cy={cy}\n      r={r}\n      style={style}\n      onMouseDown={e => onFeatureMouseDown?.(e, featureId)}\n      onMouseEnter={e => onFeatureMouseEnter?.(e, featureId)}\n      onMouseOut={e => onFeatureMouseOut?.(e, featureId)}\n      onMouseOver={e => onFeatureMouseOver?.(e, featureId)}\n      onMouseUp={e => onFeatureMouseUp?.(e, featureId)}\n      onMouseLeave={e => onFeatureMouseLeave?.(e, featureId)}\n      onMouseMove={e => onFeatureMouseMove?.(e, featureId)}\n      onClick={e => {\n        e.stopPropagation()\n        onFeatureClick?.(e, featureId)\n      }}\n      onFocus={e => onFeatureMouseOver?.(e, featureId)}\n      onBlur={e => onFeatureMouseOut?.(e, featureId)}\n    />\n  )\n}\n\nconst Lollipop = observer(function Lollipop({\n  feature,\n  config,\n  layoutRecord,\n  selectedFeatureId,\n  onFeatureMouseDown,\n  onFeatureMouseEnter,\n  onFeatureMouseOut,\n  onFeatureMouseOver,\n  onFeatureMouseUp,\n  onFeatureMouseLeave,\n  onFeatureMouseMove,\n  onFeatureClick,\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  layoutRecord: LayoutEntry\n  selectedFeatureId?: string\n  onFeatureMouseDown?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseEnter?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseOut?: (\n    event: React.MouseEvent | React.FocusEvent,\n    id: string,\n  ) => void\n  onFeatureMouseOver?: (\n    event: React.MouseEvent | React.FocusEvent,\n    id: string,\n  ) => void\n  onFeatureMouseUp?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseLeave?: (event: React.MouseEvent, id: string) => void\n  onFeatureMouseMove?: (event: React.MouseEvent, id: string) => void\n  onFeatureClick?: (event: React.MouseEvent, id: string) => void\n}) {\n  const {\n    anchorLocation,\n    y,\n    data: { radiusPx },\n  } = layoutRecord\n\n  const featureId = feature.id()\n  const strokeWidth = readConfObject(config, 'strokeWidth', { feature })\n  const cx = anchorLocation\n  const cy = y + radiusPx\n\n  const handlers = {\n    featureId,\n    onFeatureMouseDown,\n    onFeatureMouseEnter,\n    onFeatureMouseOut,\n    onFeatureMouseOver,\n    onFeatureMouseUp,\n    onFeatureMouseLeave,\n    onFeatureMouseMove,\n    onFeatureClick,\n  }\n\n  return (\n    <g data-testid={featureId}>\n      <title>{readConfObject(config, 'caption', { feature })}</title>\n      <Circle\n        cx={cx}\n        cy={cy}\n        r={radiusPx}\n        style={{\n          fill:\n            String(selectedFeatureId) === String(featureId)\n              ? 'red'\n              : readConfObject(config, 'strokeColor', { feature }),\n        }}\n        {...handlers}\n      />\n      {radiusPx - strokeWidth > 2 ? (\n        <Circle\n          cx={cx}\n          cy={cy}\n          r={radiusPx - strokeWidth}\n          style={{ fill: readConfObject(config, 'innerColor', { feature }) }}\n          {...handlers}\n        />\n      ) : null}\n      <ScoreText\n        feature={feature}\n        config={config}\n        layoutRecord={layoutRecord}\n      />\n    </g>\n  )\n})\n\nexport default Lollipop\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { observer } from 'mobx-react'\n\nimport type { LayoutEntry } from '../Layout.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\n\nconst Stick = observer(function Stick({\n  feature,\n  config,\n  layoutRecord: {\n    anchorLocation,\n    y,\n    data: { radiusPx },\n  },\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  layoutRecord: LayoutEntry\n}) {\n  return (\n    <line\n      x1={anchorLocation}\n      y1={0}\n      x2={anchorLocation}\n      y2={y + 2 * radiusPx}\n      stroke={readConfObject(config, 'stickColor', { feature })}\n      strokeWidth={readConfObject(config, 'stickWidth', { feature })}\n    />\n  )\n})\n\nexport default Stick\n","import type { FocusEvent, MouseEvent } from 'react'\nimport { Fragment, useMemo } from 'react'\n\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { bpToPx } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport { FloatingLayout } from '../Layout.ts'\nimport Lollipop from './Lollipop.tsx'\nimport Stick from './Stick.tsx'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature, Region } from '@jbrowse/core/util'\n\nfunction layoutFeat(args: {\n  feature: Feature\n  bpPerPx: number\n  region: Region\n  layout: FloatingLayout\n  config: AnyConfigurationModel\n}) {\n  const { feature, bpPerPx, config, region, layout } = args\n\n  const centerBp = Math.abs(feature.get('end') + feature.get('start')) / 2\n  const centerPx = bpToPx(centerBp, region, bpPerPx)\n  const radiusPx = readConfObject(config, 'radius', { feature })\n\n  if (!radiusPx) {\n    console.error(\n      new Error(\n        `lollipop radius ${radiusPx} configured for feature ${feature.id()}`,\n      ),\n    )\n  }\n  layout.add(feature.id(), centerPx, radiusPx * 2, radiusPx * 2, {\n    featureId: feature.id(),\n    anchorX: centerPx,\n    radiusPx,\n    score: readConfObject(config, 'score', { feature }),\n  })\n}\n\nconst LollipopRendering = observer(function LollipopRendering(\n  props: Record<string, any>,\n) {\n  const onMouseDown = (event: MouseEvent) => {\n    const { onMouseDown: handler } = props\n    return handler?.(event)\n  }\n\n  const onMouseUp = (event: MouseEvent) => {\n    const { onMouseUp: handler } = props\n    return handler?.(event)\n  }\n\n  const onMouseEnter = (event: MouseEvent | FocusEvent) => {\n    const { onMouseEnter: handler } = props\n    return handler?.(event)\n  }\n\n  const onMouseLeave = (event: MouseEvent | FocusEvent) => {\n    const { onMouseLeave: handler } = props\n    return handler?.(event)\n  }\n\n  const onMouseOver = (event: MouseEvent) => {\n    const { onMouseOver: handler } = props\n    return handler?.(event)\n  }\n\n  const onMouseOut = (event: MouseEvent) => {\n    const { onMouseOut: handler } = props\n    return handler?.(event)\n  }\n\n  const onClick = (event: MouseEvent) => {\n    const { onClick: handler } = props\n    return handler?.(event)\n  }\n  const {\n    regions,\n    bpPerPx,\n    config,\n    features = new Map(),\n    displayModel = {},\n  } = props\n  const { selectedFeatureId } = displayModel\n  const region = regions[0]!\n  const width = (region.end - region.start) / bpPerPx\n\n  const { records, height } = useMemo(() => {\n    const layout = new FloatingLayout({ width })\n    for (const feature of features.values()) {\n      layoutFeat({ feature, bpPerPx, region, config, layout })\n    }\n    return {\n      records: [...layout.getLayout(config).values()],\n      height: layout.getTotalHeight(),\n    }\n  }, [features, bpPerPx, region, config, width])\n\n  return (\n    <svg\n      width={width}\n      height={height}\n      style={{ position: 'relative' }}\n      onMouseDown={onMouseDown}\n      onMouseUp={onMouseUp}\n      onMouseEnter={onMouseEnter}\n      onMouseLeave={onMouseLeave}\n      onMouseOver={onMouseOver}\n      onMouseOut={onMouseOut}\n      onFocus={onMouseEnter}\n      onBlur={onMouseLeave}\n      onClick={onClick}\n    >\n      {records.map(layoutRecord => {\n        const feature = features.get(layoutRecord.data.featureId)\n        return (\n          <Fragment key={feature.id()}>\n            <Stick\n              config={config}\n              layoutRecord={layoutRecord}\n              feature={feature}\n            />\n            <Lollipop\n              config={config}\n              layoutRecord={layoutRecord}\n              feature={feature}\n              selectedFeatureId={selectedFeatureId}\n              onFeatureMouseDown={props.onFeatureMouseDown}\n              onFeatureMouseEnter={props.onFeatureMouseEnter}\n              onFeatureMouseOut={props.onFeatureMouseOut}\n              onFeatureMouseOver={props.onFeatureMouseOver}\n              onFeatureMouseUp={props.onFeatureMouseUp}\n              onFeatureMouseLeave={props.onFeatureMouseLeave}\n              onFeatureMouseMove={props.onFeatureMouseMove}\n              onFeatureClick={props.onFeatureClick}\n            />\n          </Fragment>\n        )\n      })}\n    </svg>\n  )\n})\n\nexport default LollipopRendering\n"],"names":["FloatingLayout","totalHeight","items","layout","Map","constructor","width","Error","this","add","uniqueId","anchorLocation","height","data","push","getLayout","configuration","minY","readConfObject","sorted","sort","a","b","score","maxBottom","layoutEntries","Array","length","i","element","entries","currentItem","start","end","top","bottom","j","previouslyLaidOutItem","x","prevStart","y","prevTop","prevWidth","prevHeight","prevEnd","prevBottom","doesIntersect2","getTotalHeight","ScoreText","t0","$","_c","feature","config","layoutRecord","t1","t2","anchorX","radiusPx","fontHeight","scoreString","t3","t4","t5","t6","t7","Symbol","for","innerColor","String","contrastingTextColor","pointerEvents","fontSize","fill","t8","t9","_jsx","style","textAnchor","dominantBaseline","children","Circle","cx","cy","r","featureId","onFeatureMouseDown","onFeatureMouseEnter","onFeatureMouseOut","onFeatureMouseOver","onFeatureMouseUp","onFeatureMouseLeave","onFeatureMouseMove","onFeatureClick","t10","t11","e","e_0","e_1","e_2","e_3","e_4","e_5","e_6","stopPropagation","e_7","e_8","onMouseDown","onMouseEnter","onMouseOut","onMouseOver","onMouseUp","onMouseLeave","onMouseMove","onClick","onFocus","onBlur","observer","selectedFeatureId","id","strokeWidth","handlers","_jsxs","x1","y1","x2","y2","stroke","layoutFeat","args","bpPerPx","region","centerBp","Math","abs","get","centerPx","bpToPx","console","error","props","event","handler","regions","features","displayModel","records","useMemo","values","position","map","Fragment","Stick","Lollipop"],"sourceRoot":""}