"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7513],{17513:(e,n,t)=>{t.r(n),t.d(n,{default:()=>J});var o=t(67758),l=t(7552),r=t(67112),s=t(66395),c=t(99546),i=t(5986),a=t(85179),d=t(85161),u=t(11496),m=t(69092),h=t(53435),f=t(75785),p=t(58474),x=t(69500);const g=(0,f.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function j(e){return e.name}function b(e){return e.name}const C=function(e){const n=(0,o.c)(92),{rows:t,onChange:f,showTips:C}=e,{classes:w}=g(),[S,v]=(0,l.useState)(null);let y;n[0]===Symbol.for("react.memo_cache_sentinel")?(y=[],n[0]=y):y=n[0];const[A,k]=(0,l.useState)(y);let _,M;if(n[1]!==t[0]||n[2]!==t.length?(_=t.length>0?t[0]:{},n[1]=t[0],n[2]=t.length,n[3]=_):_=n[3],n[4]!==_){const{name:e,color:t,source:o,baseUri:l,...r}=_;M=r,n[4]=_,n[5]=M}else M=n[5];const[O,T]=(0,l.useState)("blue");let E;n[6]===Symbol.for("react.memo_cache_sentinel")?(E={idx:0,field:null},n[6]=E):E=n[6];const[R,F]=(0,l.useState)(E),H=!A.length;let L,N;n[7]===Symbol.for("react.memo_cache_sentinel")?(L=e=>{v(e.currentTarget)},n[7]=L):L=n[7],n[8]!==H?(N=(0,x.jsx)(m.A,{disabled:H,onClick:L,children:"Change color of selected items"}),n[8]=H,n[9]=N):N=n[9];const B=!A.length;let G,I;n[10]!==f||n[11]!==t||n[12]!==A?(G=()=>{f((0,p.BO)([...t],A))},n[10]=f,n[11]=t,n[12]=A,n[13]=G):G=n[13],n[14]===Symbol.for("react.memo_cache_sentinel")?(I=(0,x.jsx)(a.A,{}),n[14]=I):I=n[14];const P=C?"Move selected items up":null;let W;n[15]!==P||n[16]!==B||n[17]!==G?(W=(0,x.jsxs)(m.A,{disabled:B,onClick:G,children:[I,P]}),n[15]=P,n[16]=B,n[17]=G,n[18]=W):W=n[18];const z=!A.length;let D,J;n[19]!==f||n[20]!==t||n[21]!==A?(D=()=>{f((0,p.oJ)([...t],A))},n[19]=f,n[20]=t,n[21]=A,n[22]=D):D=n[22],n[23]===Symbol.for("react.memo_cache_sentinel")?(J=(0,x.jsx)(i.A,{}),n[23]=J):J=n[23];const V=C?"Move selected items down":null;let K;n[24]!==z||n[25]!==D||n[26]!==V?(K=(0,x.jsxs)(m.A,{disabled:z,onClick:D,children:[J,V]}),n[24]=z,n[25]=D,n[26]=V,n[27]=K):K=n[27];const U=!A.length;let Y,$;n[28]!==f||n[29]!==t||n[30]!==A?(Y=()=>{f((0,p.BO)([...t],A,t.length))},n[28]=f,n[29]=t,n[30]=A,n[31]=Y):Y=n[31],n[32]===Symbol.for("react.memo_cache_sentinel")?($=(0,x.jsx)(u.A,{}),n[32]=$):$=n[32];const q=C?"Move selected items to top":null;let Q;n[33]!==U||n[34]!==Y||n[35]!==q?(Q=(0,x.jsxs)(m.A,{disabled:U,onClick:Y,children:[$,q]}),n[33]=U,n[34]=Y,n[35]=q,n[36]=Q):Q=n[36];const X=!A.length;let Z,ee;n[37]!==f||n[38]!==t||n[39]!==A?(Z=()=>{f((0,p.oJ)([...t],A,t.length))},n[37]=f,n[38]=t,n[39]=A,n[40]=Z):Z=n[40],n[41]===Symbol.for("react.memo_cache_sentinel")?(ee=(0,x.jsx)(d.A,{}),n[41]=ee):ee=n[41];const ne=C?"Move selected items to bottom":null;let te,oe,le,re,se,ce,ie,ae,de,ue,me,he,fe,pe,xe,ge;return n[42]!==X||n[43]!==Z||n[44]!==ne?(te=(0,x.jsxs)(m.A,{disabled:X,onClick:Z,children:[ee,ne]}),n[42]=X,n[43]=Z,n[44]=ne,n[45]=te):te=n[45],n[46]!==f||n[47]!==t||n[48]!==A?(oe=e=>{T(e);for(const n of A){const o=t.find(e=>e.name===n);o&&(o.color=e)}f([...t])},n[46]=f,n[47]=t,n[48]=A,n[49]=oe):oe=n[49],n[50]===Symbol.for("react.memo_cache_sentinel")?(le=()=>{v(null)},n[50]=le):le=n[50],n[51]!==S||n[52]!==oe||n[53]!==O?(re=(0,x.jsx)(s.FO,{anchorEl:S,color:O,onChange:oe,onClose:le}),n[51]=S,n[52]=oe,n[53]=O,n[54]=re):re=n[54],n[55]===Symbol.for("react.memo_cache_sentinel")?(se={height:400,width:"100%"},n[55]=se):se=n[55],n[56]===Symbol.for("react.memo_cache_sentinel")?(ce=e=>{k([...e.ids])},n[56]=ce):ce=n[56],n[57]!==f||n[58]!==t?(ie={field:"color",headerName:"Color",renderCell:e=>{const{value:n,id:o}=e;return(0,x.jsx)(s.Ay,{color:n||"blue",onChange:e=>{const n=t.find(e=>e.name===o);n&&(n.color=e),f([...t])}})}},n[57]=f,n[58]=t,n[59]=ie):ie=n[59],n[60]!==t?(ae=(0,c.measureGridWidth)(t.map(j)),n[60]=t,n[61]=ae):ae=n[61],n[62]!==ae?(de={field:"name",headerName:"Name",width:ae},n[62]=ae,n[63]=de):de=n[63],n[64]!==M?(ue=Object.keys(M),n[64]=M,n[65]=ue):ue=n[65],n[66]!==w||n[67]!==t||n[68]!==ue?(me=ue.map(e=>({field:e,renderCell:e=>{const{value:n}=e;return(0,x.jsx)("div",{className:w.cell,children:(0,x.jsx)(r.SanitizedHTML,{html:(0,c.getStr)(n)})})},width:(0,c.measureGridWidth)(t.map(n=>`${n[e]}`))})),n[66]=w,n[67]=t,n[68]=ue,n[69]=me):me=n[69],n[70]!==ie||n[71]!==de||n[72]!==me?(he=[ie,de,...me],n[70]=ie,n[71]=de,n[72]=me,n[73]=he):he=n[73],n[74]===Symbol.for("react.memo_cache_sentinel")?(fe=[],n[74]=fe):fe=n[74],n[75]!==R.field||n[76]!==R.idx||n[77]!==f||n[78]!==t?(pe=e=>{const n=e[0],o=(R.idx+1)%2,l=n.field||R.field;F({idx:o,field:l}),f(l?[...t].sort((e,n)=>{const t=(0,c.getStr)(e[l]),r=(0,c.getStr)(n[l]);return 1===o?t.localeCompare(r):r.localeCompare(t)}):t)},n[75]=R.field,n[76]=R.idx,n[77]=f,n[78]=t,n[79]=pe):pe=n[79],n[80]!==t||n[81]!==he||n[82]!==pe?(xe=(0,x.jsx)("div",{style:se,children:(0,x.jsx)(h.z,{disableRowSelectionOnClick:!0,getRowId:b,checkboxSelection:!0,onRowSelectionModelChange:ce,rows:t,rowHeight:25,columnHeaderHeight:33,columns:he,sortModel:fe,onSortModelChange:pe})}),n[80]=t,n[81]=he,n[82]=pe,n[83]=xe):xe=n[83],n[84]!==W||n[85]!==K||n[86]!==Q||n[87]!==te||n[88]!==re||n[89]!==xe||n[90]!==N?(ge=(0,x.jsxs)("div",{children:[N,W,K,Q,te,re,xe]}),n[84]=W,n[85]=K,n[86]=Q,n[87]=te,n[88]=re,n[89]=xe,n[90]=N,n[91]=ge):ge=n[91],ge};var w=t(36157),S=t(76218),v=t(30698),y=t(61282),A=t(93062);const k=(0,f.n9)()({textAreaFont:{fontFamily:"Courier New"}});function _(e){const n=(0,o.c)(29),{onClose:t,currLayout:s}=e,{classes:c}=k(),[i,a]=(0,l.useState)(""),[d,u]=(0,l.useState)();let h,f,p,g,j,b,C,w,_,H,L;return n[0]===Symbol.for("react.memo_cache_sentinel")?(h=(0,x.jsx)(y.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),n[0]=h):h=n[0],n[1]!==d?(f=d?(0,x.jsx)(r.ErrorMessage,{error:d}):null,n[1]=d,n[2]=f):f=n[2],n[3]===Symbol.for("react.memo_cache_sentinel")?(p=e=>{a(e.target.value)},n[3]=p):p=n[3],n[4]!==c.textAreaFont?(g={input:{classes:{input:c.textAreaFont}}},n[4]=c.textAreaFont,n[5]=g):g=n[5],n[6]!==g||n[7]!==i?(j=(0,x.jsx)(A.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:i,onChange:p,slotProps:g}),n[6]=g,n[7]=i,n[8]=j):j=n[8],n[9]!==f||n[10]!==j?(b=(0,x.jsxs)(S.A,{children:[h,f,j]}),n[9]=f,n[10]=j,n[11]=b):b=n[11],n[12]!==s||n[13]!==t||n[14]!==i?(C=(0,x.jsx)(m.A,{variant:"contained",color:"secondary",onClick:()=>{const e=i.split("\n").map(F).filter(R),n=e[0].split(/[,\t]/gm);if(n.includes("name")){u("");const o=Object.fromEntries(s.map(E)),l=Object.fromEntries(e.slice(1).map(e=>{const t=e.split(/[,\t]/gm),l=Object.fromEntries(t.map((e,t)=>[n[t],e]));return[l.name,{...l,...o[l.name]}]}));t(s.map(e=>({...e,...l[e.name]})))}else u(new Error('No "name" column found on line 1'))},children:"Update rows"}),n[12]=s,n[13]=t,n[14]=i,n[15]=C):C=n[15],n[16]!==s||n[17]!==t||n[18]!==i?(w=(0,x.jsx)(m.A,{variant:"contained",color:"primary",onClick:()=>{const e=i.split("\n").map(T).filter(O),n=e[0].split(/[,\t]/gm);if(n.includes("name")){u("");const o=Object.fromEntries(s.map(M)),l=Object.fromEntries(e.slice(1).map(e=>{const t=e.split(/[,\t]/gm),l=Object.fromEntries(t.map((e,t)=>[n[t],e]));return[l.name,{...l,...o[l.name]}]}));t(s.map(e=>({...l[e.name]})))}else u(new Error('No "name" column found on line 1'))},children:"Replace rows"}),n[16]=s,n[17]=t,n[18]=i,n[19]=w):w=n[19],n[20]!==t?(_=(0,x.jsx)(m.A,{variant:"contained",color:"inherit",onClick:()=>{t()},children:"Cancel"}),n[20]=t,n[21]=_):_=n[21],n[22]!==C||n[23]!==w||n[24]!==_?(H=(0,x.jsxs)(v.A,{children:[C,w,_]}),n[22]=C,n[23]=w,n[24]=_,n[25]=H):H=n[25],n[26]!==H||n[27]!==b?(L=(0,x.jsxs)(x.Fragment,{children:[b,H]}),n[26]=H,n[27]=b,n[28]=L):L=n[28],L}function M(e){return[e.name,e]}function O(e){return!!e}function T(e){return e.trim()}function E(e){return[e.name,e]}function R(e){return!!e}function F(e){return e.trim()}function H(){const e=(0,o.c)(1);let n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,x.jsxs)(x.Fragment,{children:["Helpful tips",(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,x.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,x.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,x.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,x.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,x.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,x.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]}),e[0]=n):n=e[0],n}var L=t(40898),N=t(80208);function B(e){const n=(0,o.c)(12),{setCurrLayout:t,currLayout:l}=e;if(!l.length||!l[0])return null;let r;n[0]!==l[0]?(r=Object.keys(l[0]).filter(W),n[0]=l[0],n[1]=r):r=n[1];const s=r;let c,i,a;return n[2]!==l||n[3]!==s||n[4]!==t?(c=s.map(e=>(0,x.jsx)(m.A,{variant:"contained",color:"inherit",onClick:()=>{const n=new Map;for(const t of l){const o=n.get(t[e]);o?n.set(t[e],o+1):n.set(t[e],1)}const o=Object.fromEntries([...n.entries()].sort(P).map(I));t(l.map(n=>({...n,color:o[n[e]]})))},children:e},e)),n[2]=l,n[3]=s,n[4]=t,n[5]=c):c=n[5],n[6]!==l||n[7]!==t?(i=(0,x.jsx)(m.A,{onClick:()=>{t(l.map(G))},children:"Clear colors"}),n[6]=l,n[7]=t,n[8]=i):i=n[8],n[9]!==c||n[10]!==i?(a=(0,x.jsxs)("div",{children:["Create color palette based on...",c,i]}),n[9]=c,n[10]=i,n[11]=a):a=n[11],a}function G(e){return{...e,color:void 0}}function I(e,n){return[e[0],L.set1[n]||(0,N.randomColor)(e[0])]}function P(e,n){return e[1]-n[1]}function W(e){return"name"!==e&&"color"!==e&&"source"!==e&&"label"!==e&&"id"!==e&&"HP"!==e}const z=(0,f.n9)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8}});function D(e){const n=(0,o.c)(19),{model:t,handleClose:r,title:s,enableBulkEdit:i,enableRowPalettizer:a,showTipsStorageKey:d,SourcesGridComponent:u}=e,h=void 0===s?"Color/arrangement editor":s,f=void 0!==i&&i,p=void 0!==a&&a,g=void 0===d?"setColorDialog-showTips":d,{classes:j}=z(),{sources:b}=t,[C,y]=(0,l.useState)(!1);let A,k;n[0]!==b?(A=b||[],n[0]=b,n[1]=A):A=n[1],n[2]!==A?(k=structuredClone(A),n[2]=A,n[3]=k):k=n[3];const[M,O]=(0,l.useState)(k),[T,E]=(0,c.useLocalStorage)(g,!1);let R,F;return n[4]!==u||n[5]!==j||n[6]!==M||n[7]!==f||n[8]!==p||n[9]!==r||n[10]!==t||n[11]!==E||n[12]!==C||n[13]!==T?(R=C&&f?(0,x.jsx)(_,{currLayout:M,onClose:e=>{e&&O(e),y(!1)}}):(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(S.A,{className:j.content,children:[(0,x.jsxs)("div",{className:j.fr,children:[(0,x.jsx)(m.A,{variant:"contained",onClick:()=>{E(!T)},children:T?"Hide tips":"Show tips"}),f?(0,x.jsx)(m.A,{color:"secondary",variant:"contained",onClick:()=>{y(!C)},children:"Show Bulk row editor"}):null]}),T?(0,x.jsx)(H,{}):null,p?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("br",{}),(0,x.jsx)(B,{currLayout:M,setCurrLayout:O})]}):null,(0,x.jsx)(u,{rows:M,onChange:O,showTips:T})]}),(0,x.jsxs)(v.A,{children:[(0,x.jsx)(m.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),O(t.sources||[])},children:"Clear custom settings"}),(0,x.jsx)(m.A,{variant:"contained",color:"secondary",onClick:()=>{r(),O([...t.sources||[]])},children:"Cancel"}),(0,x.jsx)(m.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{t.setLayout(M),r()},children:"Submit"})]})]}),n[4]=u,n[5]=j,n[6]=M,n[7]=f,n[8]=p,n[9]=r,n[10]=t,n[11]=E,n[12]=C,n[13]=T,n[14]=R):R=n[14],n[15]!==r||n[16]!==R||n[17]!==h?(F=(0,x.jsx)(w.A,{open:!0,onClose:r,maxWidth:"xl",title:h,children:R}),n[15]=r,n[16]=R,n[17]=h,n[18]=F):F=n[18],F}function J(e){const n=(0,o.c)(3),{model:t,handleClose:l}=e,r=t;let s;return n[0]!==l||n[1]!==r?(s=(0,x.jsx)(D,{model:r,handleClose:l,title:"Multi-wiggle color/arrangement editor",enableBulkEdit:!0,enableRowPalettizer:!0,showTipsStorageKey:"multiwiggle-showTips",SourcesGridComponent:C}),n[0]=l,n[1]=r,n[2]=s):s=n[2],s}},36157:(e,n,t)=>{t.d(n,{A:()=>C});var o=t(67758),l=t(7552),r=t(84340),s=t(95054),c=t(48768),i=t(87626),a=t(59130),d=t(89870),u=t(41450),m=t(68446),h=t(21254),f=t.n(h),p=t(75785),x=t(69500);const g=(0,p.n9)()(e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}));function j(e){const n=(0,o.c)(2),t=(0,l.useRef)(null);let r;return n[0]!==e?(r=(0,x.jsx)(f(),{nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',onStart:b,children:(0,x.jsx)(s.A,{ref:t,...e})}),n[0]=e,n[1]=r):r=n[1],r}function b(e){return`${e.target?.className}`.includes("MuiDialogTitle")}const C=(0,m.observer)(function(e){const{classes:n}=g(),{title:t,children:o,onClose:l}=e;return(0,x.jsx)(c.A,{...e,PaperComponent:j,children:(0,x.jsxs)(i.A,{children:[(0,x.jsxs)(a.A,{style:{cursor:"move"},children:[t,l?(0,x.jsx)(d.A,{className:n.closeButton,onClick:()=>{l()},children:(0,x.jsx)(r.A,{})}):null]}),(0,x.jsx)(u.A,{}),o]})})})},58474:(e,n,t)=>{t.d(n,{A3:()=>i,BO:()=>r,oJ:()=>s});var o=t(68584),l=t(99546);function r(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>e-n);let l=0;for(const n of o){const o=Math.max(l,n-t);o>=l&&e.splice(o,0,e.splice(n,1)[0]),l+=1}return e}function s(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>n-e);let l=e.length-1;for(const n of o){const o=Math.min(l,n+t);o<=l&&e.splice(o,0,e.splice(n,1)[0]),l-=1}return e}const c=12.8;function i(e){const{prefersOffset:n}=e,{trackLabels:t}=(0,l.getContainingView)(e),r=(0,l.getContainingTrack)(e),s=(0,o.getConf)(r,"name");return"overlapping"!==t||n?10:(0,l.measureText)(s,c)+100}}}]);
//# sourceMappingURL=7513.8b7ec63e.chunk.js.map