"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[4006,4144],{62568:(e,t,n)=>{n.d(t,{A:()=>a});var s=n(67758),r=n(99546),l=n(69500);function o(e){const t=(0,s.c)(5),{feature:n}=e,o=n.strand;let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={"-1":"-",0:"",1:"+"},t[0]=i):i=t[0];const a=i,c=a[o]?`(${a[o]})`:"";let d;t[1]!==n?(d=(0,r.assembleLocString)(n),t[1]=n,t[2]=d):d=t[2];const u=`${d} ${c}`;let f;return t[3]!==u?(f=(0,l.jsx)(l.Fragment,{children:u}),t[3]=u,t[4]=f):f=t[4],f}var i=n(32106);function a(e){const t=(0,s.c)(3),{feature:n}=e,a=n;let u;if(t[0]!==a||t[1]!==e){const n={...a,...a.__jbrowsefmt},{start:s,end:f}=n,h={...n,length:(0,r.toLocale)(f-s)},m={description:"Description",name:"Name",length:"Length",type:"Type"};u=(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.A,{name:"Position",value:(0,l.jsx)(o,{...e,feature:n})}),Object.entries(m).map(e=>{const[t,n]=e;return[n,h[t]]}).filter(d).map(c)]}),t[0]=a,t[1]=e,t[2]=u}else u=t[2];return u}function c(e){const[t,n]=e;return(0,l.jsx)(i.A,{name:t,value:Array.isArray(n)?n.join(", "):n},t)}function d(e){const[,t]=e;return null!=t}},74006:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var s=n(67758),r=n(7552),l=n(350),o=n(84144),i=n(95054),a=n(68446),c=n(69566),d=n(69500);function u(e){const t=(0,s.c)(7),{value:n,refString:l}=e,[o,i]=(0,r.useState)(!1);let a;t[0]!==l||t[1]!==n?(a=(0,c.bC)(l,n),t[0]=l,t[1]=n,t[2]=a):a=t[2];const u=a;let f;return t[3]!==u||t[4]!==o||t[5]!==n?(f=u!==n?(0,d.jsxs)("div",{children:[(0,d.jsx)("button",{onClick:()=>{i(!o)},children:o?"Show simplified ALT":"Show raw ALT"})," ",o?n:u]}):n,t[3]=u,t[4]=o,t[5]=n,t[6]=f):f=t[6],f}var f=n(31409),h=n.n(f);function m(e){const t=(0,s.c)(4),{value:n}=e,[l,o]=(0,r.useState)(!1),[i,a]=(0,r.useState)(!1),c=String(n);let u;return t[0]!==i||t[1]!==c||t[2]!==l?(u=c.length>100?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{type:"button",onClick:()=>{h()(c),a(!0),setTimeout(()=>{a(!1)},700)},children:i?"Copied to clipboard":"Copy"}),(0,d.jsx)("button",{type:"button",onClick:()=>{o(p)},children:l?"Show less":"Show more"}),(0,d.jsx)("div",{children:l?c:`${c.slice(0,100)}...`})]}):(0,d.jsx)("div",{children:c}),t[0]=i,t[1]=c,t[2]=l,t[3]=u):u=t[3],u}function p(e){return!e}var x=n(87083),j=n(67112),g=n(62162),b=n(57468),y=n(99546),v=n(61282),A=n(56634),S=n(20224),N=n(53435),w=n(22762),C=n(7946);function F(e){const t=(0,s.c)(9),{checked:n,disabled:r,label:l,onChange:o}=e;let i,a,c;return t[0]!==n||t[1]!==o?(i=(0,d.jsx)(w.A,{checked:n,onChange:o}),t[0]=n,t[1]=o,t[2]=i):i=t[2],t[3]!==l?(a=(0,d.jsx)(v.A,{variant:"body2",children:l}),t[3]=l,t[4]=a):a=t[4],t[5]!==r||t[6]!==i||t[7]!==a?(c=(0,d.jsx)(C.A,{disabled:r,control:i,label:a}),t[5]=r,t[6]=i,t[7]=a,t[8]=c):c=t[8],c}function T(e){const t=(0,s.c)(36),{rows:n}=e,[l,o]=(0,r.useState)(!1);let i,a;if(t[0]!==n||t[1]!==l){const e={};if(l)for(const t of n){const n={},s=t.GT.split(/[/|]/);for(const e of s)n[e]=(n[e]||0)+1;const r=Object.entries(n).map(O).join(";");e[r]||(e[r]={count:0,GT:r,genotype:t.genotype}),e[r].count=e[r].count+1}else for(const t of n){const n=t.GT;e[n]||(e[n]={count:0,GT:t.GT,genotype:t.genotype}),e[n].count=e[n].count+1}i=Object.entries(e),t[0]=n,t[1]=l,t[2]=i}else i=t[2];t[3]!==n||t[4]!==i?(a=i.map(e=>{const[t,s]=e;return{id:t,...s,count:`${s.count} / ${n.length}`,frequency:`${r=s.count/n.length*100,r.toPrecision(3)}%`};var r}),t[3]=n,t[4]=i,t[5]=a):a=t[5];const c=a;let u;t[6]!==c[0]?(u=c[0]?Object.keys(c[0]):[],t[6]=c[0],t[7]=u):u=t[7];const f=u;let h;t[8]!==c||t[9]!==f?(h=f.map(e=>(0,y.measureGridWidth)(c.map(t=>`${t[e]}`))),t[8]=c,t[9]=f,t[10]=h):h=t[10];const m=h;let p,x,j,b,A,S,F,T,$,_,k;return t[11]!==l?(p=(0,d.jsx)(w.A,{checked:l}),t[11]=l,t[12]=p):p=t[12],t[13]===Symbol.for("react.memo_cache_sentinel")?(x=(0,d.jsx)(v.A,{variant:"body2",children:"Use allele counts instead of exact GT"}),j=(e,t)=>{o(t)},t[13]=x,t[14]=j):(x=t[13],j=t[14]),t[15]!==p?(b=(0,d.jsx)(C.A,{control:p,label:x,onChange:j}),t[15]=p,t[16]=b):b=t[16],t[17]!==m[0]?(A={field:"GT",width:m[0]},t[17]=m[0],t[18]=A):A=t[18],t[19]!==m[1]?(S={field:"count",width:m[1]},t[19]=m[1],t[20]=S):S=t[20],t[21]!==m[2]?(F={field:"frequency",width:m[2]},t[21]=m[2],t[22]=F):F=t[22],t[23]!==m[3]?(T={field:"genotype",width:m[3]},t[23]=m[3],t[24]=T):T=t[24],t[25]!==S||t[26]!==F||t[27]!==T||t[28]!==A?($=[A,S,F,T],t[25]=S,t[26]=F,t[27]=T,t[28]=A,t[29]=$):$=t[29],t[30]!==c||t[31]!==$?(_=(0,d.jsx)(g.A,{children:(0,d.jsx)(N.z,{rows:c,hideFooter:!0,rowHeight:25,columnHeaderHeight:35,columns:$})}),t[30]=c,t[31]=$,t[32]=_):_=t[32],t[33]!==_||t[34]!==b?(k=(0,d.jsxs)("div",{children:[b,_]}),t[33]=_,t[34]=b,t[35]=k):k=t[35],k}function O(e){const[t,n]=e;return`${t}:${n}`}var $=n(93062);function _(e){const t=(0,s.c)(10),{columns:n,filter:r,setFilter:l}=e;let o,i,a;if(t[0]===Symbol.for("react.memo_cache_sentinel")?(o=(0,d.jsx)(v.A,{children:"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"}),t[0]=o):o=t[0],t[1]!==n||t[2]!==r||t[3]!==l){let e;t[5]!==r||t[6]!==l?(e=e=>{const{field:t}=e;return(0,d.jsx)($.A,{placeholder:`Filter ${t}`,value:r[t]||"",onChange:e=>{l({...r,[t]:e.target.value})}},`filter-${t}`)},t[5]=r,t[6]=l,t[7]=e):e=t[7],i=n.map(e),t[1]=n,t[2]=r,t[3]=l,t[4]=i}else i=t[4];return t[8]!==i?(a=(0,d.jsxs)(d.Fragment,{children:[o,i]}),t[8]=i,t[9]=a):a=t[9],a}function k(e){const t=(0,s.c)(14),{feature:n,descriptions:l}=e,o=void 0===l?{}:l;let i;t[0]===Symbol.for("react.memo_cache_sentinel")?(i={},t[0]=i):i=t[0];const[a,u]=(0,r.useState)(i),[f,h]=(0,r.useState)("all"),[m,p]=(0,r.useState)(!1),w=n.samples||{},C=n.ALT,O=n.REF,{rows:$,error:k}=function(e,t,n,s){const r=Object.entries(e).map(([e,s])=>{const r=s.GT?.[0];return[e,{...s,...r?{GT:`${r}`,genotype:(0,c.Fm)(`${r}`,t,n)}:{}}]});let l,o=[];const i=Object.keys(s);try{o=r.map(([e,t])=>({...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,t])),sample:e,id:e})).filter(e=>!i.length||i.every(t=>{const n=s[t];return!n||new RegExp(n,"i").exec(e[t])}))}catch(e){console.error(e),l=e}return{rows:o,error:l}}(w,O,C,a),I=new Set(["sample",...Object.keys($[0]||{})]);I.delete("id");const G=[...I],q=G.map(e=>(0,y.measureGridWidth)($.map(t=>t[e]))),E=G.map((e,t)=>({field:e,description:o?.FORMAT?.[e]?.Description,width:q[t]}));let D;t[1]===Symbol.for("react.memo_cache_sentinel")?(D=new Set(["sample","GT"]),t[1]=D):D=t[1];const L=D;let P;t[2]===Symbol.for("react.memo_cache_sentinel")?(P=new Set(["sample","GT","genotype"]),t[2]=P):P=t[2];const H=P;let z;return t[3]!==f||t[4]!==E||t[5]!==k||t[6]!==a||t[7]!==e||t[8]!==$||t[9]!==h||t[10]!==u||t[11]!==p||t[12]!==m?(z=$.length?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(x.default,{...e,title:"Genotype frequencies",children:(0,d.jsx)(b.t,{FallbackComponent:j.ErrorMessage,children:(0,d.jsx)(T,{rows:$})})}),(0,d.jsxs)(x.default,{...e,title:"Samples",children:[k?(0,d.jsx)(v.A,{color:"error",children:`${k}`}):null,(0,d.jsxs)("div",{children:[(0,d.jsx)(F,{label:"Show filters",checked:m,onChange:e=>{p(e.target.checked)}}),(0,d.jsxs)(A.A,{value:f,exclusive:!0,size:"small",onChange:(e,t)=>{null!==t&&h(t)},children:[(0,d.jsx)(S.A,{value:"all",children:"All"}),(0,d.jsx)(S.A,{value:"gtOnly",children:"GT only"}),(0,d.jsx)(S.A,{value:"genotypeOnly",children:"GT+resolved genotype"})]})]}),m?(0,d.jsx)(_,{setFilter:u,columns:E,filter:a}):null,(0,d.jsx)(g.A,{children:(0,d.jsx)(N.z,{rows:$,hideFooter:$.length<100,columns:"gtOnly"===f?E.filter(e=>L.has(e.field)):"genotypeOnly"===f?E.filter(e=>H.has(e.field)):E,rowHeight:25,columnHeaderHeight:35,showToolbar:!0})})]})]}):null,t[3]=f,t[4]=E,t[5]=k,t[6]=a,t[7]=e,t[8]=$,t[9]=h,t[10]=u,t[11]=p,t[12]=m,t[13]=z):z=t[13],z}const I={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"},G=(0,r.lazy)(()=>n.e(5535).then(n.bind(n,45535))),q=(0,r.lazy)(()=>n.e(8976).then(n.bind(n,58976)));function E(e){const t=(0,s.c)(7),{descriptions:n,feature:r}=e,l=n?.INFO?.ANN?.Description;let o;t[0]!==l?(o=l?.match(/.*Functional annotations:'(.*)'$/)?.[1]?.split("|")||[],t[0]=l,t[1]=o):o=t[1];const i=o;let a;t[2]!==r.INFO?.ANN?(a=r.INFO?.ANN||[],t[2]=r.INFO?.ANN,t[3]=a):a=t[3];const c=a;let u;return t[4]!==c||t[5]!==i?(u=(0,d.jsx)(q,{fields:i,data:c,title:"Variant ANN field"}),t[4]=c,t[5]=i,t[6]=u):u=t[6],u}function D(e){const t=(0,s.c)(7),{descriptions:n,feature:r}=e,l=n?.INFO?.CSQ?.Description;let o;t[0]!==l?(o=l?.match(/.*Format: (.*)/)?.[1]?.split("|")||[],t[0]=l,t[1]=o):o=t[1];const i=o;let a;t[2]!==r.INFO?.CSQ?(a=r.INFO?.CSQ||[],t[2]=r.INFO?.CSQ,t[3]=a):a=t[3];const c=a;let u;return t[4]!==c||t[5]!==i?(u=(0,d.jsx)(q,{fields:i,data:c,title:"Variant CSQ field"}),t[4]=c,t[5]=i,t[6]=u):u=t[6],u}function L(e){const t=(0,s.c)(3),{model:n}=e,{featureData:r}=n;let l;if(t[0]!==r||t[1]!==n){const e=JSON.parse(JSON.stringify(r)),{type:s}=e,o=void 0===s?"":s;l="breakend"===o?(0,d.jsx)(G,{feature:e,locStrings:e.ALT.map(P),model:n}):"translocation"===o?(0,d.jsx)(G,{feature:e,model:n,locStrings:[`${e.INFO.CHR2[0]}:${e.INFO.END}`]}):"paired_feature"===o?(0,d.jsx)(G,{feature:e,model:n,locStrings:[`${e.mate.refName}:${e.mate.start}`]}):o.includes("inversion")||o.includes("deletion")||o.includes("duplication")||o.includes("cnv")||o.includes("sv")?(0,d.jsx)(G,{feature:{uniqueId:"random",refName:e.refName,start:e.start,end:e.start+1,mate:{refName:e.refName,start:e.end,end:e.end+1}},model:n,locStrings:[`${e.refName}:${e.end}`]}):null,t[0]=r,t[1]=n,t[2]=l}else l=t[2];return l}function P(e){return(0,l.h)(e)?.MatePosition||""}const H=(0,a.observer)(function(e){const{feat:t,model:n}=e,{descriptions:s}=n,{samples:l,...a}=t,{REF:c}=a;return(0,d.jsxs)(i.A,{"data-testid":"variant-side-drawer",children:[(0,d.jsx)(o.default,{feature:a,descriptions:{...I,...s},formatter:(e,t)=>"ALT"===t?(0,d.jsx)(u,{value:`${e}`,refString:c}):(0,d.jsx)(m,{value:e}),...e}),(0,d.jsxs)(r.Suspense,{fallback:null,children:[(0,d.jsx)(D,{feature:a,descriptions:s}),(0,d.jsx)(E,{feature:a,descriptions:s}),(0,d.jsx)(L,{model:n})]}),(0,d.jsx)(k,{feature:t,...e,descriptions:s})]})}),z=(0,a.observer)(function(e){const{model:t}=e,{featureData:n}=t,s=structuredClone(n);return s?(0,d.jsx)(H,{feat:s,...e}):(0,d.jsx)("div",{children:"No feature loaded, may not be available after page refresh because it was too large for localStorage"})})},84144:(e,t,n)=>{n.r(t),n.d(t,{default:()=>C});var s=n(67758),r=n(57468),l=n(61282),o=n(41450),i=n(1178),a=n(7552),c=n(15897),d=n(91818),u=n(69092),f=n(89870),h=n(68446),m=n(75785),p=n(67112),x=n(99546),j=n(69500);const g=(0,a.lazy)(()=>n.e(7428).then(n.bind(n,27428))),b=(0,a.lazy)(()=>n.e(8624).then(n.bind(n,38624))),y=(0,m.n9)()(e=>({formControl:{margin:0},container:{marginTop:e.spacing(4),marginBottom:e.spacing(4)}})),v=(0,h.observer)(function({model:e,feature:t}){const{classes:n}=y(),[s,r]=(0,a.useState)(!1);return(0,j.jsxs)("div",{className:n.container,children:[(0,j.jsx)(d.A,{className:n.formControl,children:(0,j.jsx)(u.A,{variant:"contained",onClick:()=>{r(!s)},children:s?"Hide feature sequence":"Show feature sequence"})}),(0,j.jsx)(f.A,{onClick:()=>{(0,x.getSession)(e).queueDialog(e=>[b,{handleClose:e}])},children:(0,j.jsx)(c.A,{})}),s?(0,j.jsx)(a.Suspense,{fallback:(0,j.jsx)(p.LoadingEllipses,{}),children:(0,j.jsx)(g,{model:e,feature:t},t.uniqueId)}):null]})});var A=n(35300),S=n(87083),N=n(62568);const w=["name","start","end","strand","refName","description","type"];function C(e){const t=(0,s.c)(41),{omit:n,model:a,feature:c,depth:d}=e;let u;t[0]!==n?(u=void 0===n?[]:n,t[0]=n,t[1]=u):u=t[1];const f=u,h=void 0===d?0:d,{maxDepth:m}=a,{mate:p,name:g,id:b,type:y,subfeatures:T,uniqueId:O}=c,$=void 0===g?"":g,_=void 0===b?"":b,k=void 0===y?"":y;let I;if(t[2]!==c||t[3]!==a){const e=(0,x.getEnv)(a).pluginManager,n=(0,x.getSession)(a);I=e.evaluateExtensionPoint("Core-extraFeaturePanel",null,{session:n,feature:c,model:a}),t[2]=c,t[3]=a,t[4]=I}else I=t[4];const G=I,q=p;let E,D,L,P,H,z,R,M,Q,J,U;return t[5]!==_||t[6]!==$||t[7]!==k?(E=(0,i.KS)($,_,k),t[5]=_,t[6]=$,t[7]=k,t[8]=E):E=t[8],t[9]===Symbol.for("react.memo_cache_sentinel")?(D=(0,j.jsx)(l.A,{children:"Core details"}),t[9]=D):D=t[9],t[10]!==e?(L=(0,j.jsx)(N.A,{...e}),t[10]=e,t[11]=L):L=t[11],t[12]!==q||t[13]!==e||t[14]!==O?(P=q?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.A,{}),(0,j.jsx)(l.A,{children:"Mate details"}),(0,j.jsx)(N.A,{...e,feature:{...q,start:q.start,end:q.end,refName:q.refName,uniqueId:`${O}-mate`}})]}):null,t[12]=q,t[13]=e,t[14]=O,t[15]=P):P=t[15],t[16]===Symbol.for("react.memo_cache_sentinel")?(H=(0,j.jsx)(o.A,{}),z=(0,j.jsx)(l.A,{children:"Attributes"}),t[16]=H,t[17]=z):(H=t[16],z=t[17]),t[18]!==c||t[19]!==f||t[20]!==e?(R=(0,j.jsx)(A.default,{attributes:c,...e,omit:f,omitSingleLevel:w}),t[18]=c,t[19]=f,t[20]=e,t[21]=R):R=t[21],t[22]!==e?(M=(0,j.jsx)(r.t,{FallbackComponent:F,children:(0,j.jsx)(v,{...e})}),t[22]=e,t[23]=M):M=t[23],t[24]!==G||t[25]!==e?(Q=G?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(o.A,{}),(0,j.jsx)(S.default,{title:G.name,children:(0,j.jsx)(G.Component,{...e})})]}):null,t[24]=G,t[25]=e,t[26]=Q):Q=t[26],t[27]!==h||t[28]!==m||t[29]!==a||t[30]!==T||t[31]!==O?(J=h<m&&T?.length?(0,j.jsx)(S.default,{title:"Subfeatures",defaultExpanded:h<1,children:T.map((e,t)=>(0,j.jsx)(C,{feature:{...e,uniqueId:`${O}_${t}`},model:a,depth:h+1},JSON.stringify(e)))}):null,t[27]=h,t[28]=m,t[29]=a,t[30]=T,t[31]=O,t[32]=J):J=t[32],t[33]!==P||t[34]!==R||t[35]!==M||t[36]!==Q||t[37]!==J||t[38]!==E||t[39]!==L?(U=(0,j.jsxs)(S.default,{title:E,children:[D,L,P,H,z,R,M,Q,J]}),t[33]=P,t[34]=R,t[35]=M,t[36]=Q,t[37]=J,t[38]=E,t[39]=L,t[40]=U):U=t[40],U}function F(e){return(0,j.jsx)(p.ErrorMessage,{error:e.error})}},87083:(e,t,n)=>{n.r(t),n.d(t,{default:()=>f});var s=n(67758),r=n(48759),l=n(61282),o=n(75068),i=n(3032),a=n(76386),c=n(75785),d=n(69500);const u=(0,c.n9)()(e=>({expansionPanelDetails:{display:"block",padding:e.spacing(1)},icon:{color:e.palette.tertiary.contrastText||"#fff"}}));function f(e){const t=(0,s.c)(14),{children:n,title:c,defaultExpanded:f}=e,h=void 0===f||f,{classes:m}=u();let p,x,j,g,b;return t[0]!==m.icon?(p=(0,d.jsx)(r.A,{className:m.icon}),t[0]=m.icon,t[1]=p):p=t[1],t[2]!==c?(x=(0,d.jsx)(l.A,{variant:"button",children:c}),t[2]=c,t[3]=x):x=t[3],t[4]!==p||t[5]!==x?(j=(0,d.jsx)(o.A,{expandIcon:p,children:x}),t[4]=p,t[5]=x,t[6]=j):j=t[6],t[7]!==n||t[8]!==m.expansionPanelDetails?(g=(0,d.jsx)(i.A,{className:m.expansionPanelDetails,children:n}),t[7]=n,t[8]=m.expansionPanelDetails,t[9]=g):g=t[9],t[10]!==h||t[11]!==j||t[12]!==g?(b=(0,d.jsxs)(a.A,{defaultExpanded:h,children:[j,g]}),t[10]=h,t[11]=j,t[12]=g,t[13]=b):b=t[13],b}}}]);
//# sourceMappingURL=4006.df4c949d.chunk.js.map