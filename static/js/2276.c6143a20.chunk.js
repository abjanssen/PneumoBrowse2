"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2276],{69250(e,a,i){i.d(a,{X:()=>n});var s=i(77251),t=i(70203);async function n({self:e,tag:a,blocks:i,opts:n}){const{rpcManager:l}=(0,s.getSession)(e),{adapterConfig:r,effectiveRpcDriverName:o}=e,c=(0,t.getRpcSessionId)(e);return await l.call((0,t.getRpcSessionId)(e),"PileupGetGlobalValueForTag",{adapterConfig:r,tag:a,sessionId:c,rpcDriverName:o,regions:i.contentBlocks,...n})}},92276(e,a,i){i.r(a),i.d(a,{default:()=>k});var s=i(42918),t=i(85787),n=i(27351),l=i(87574),r=i(77251),o=i(99226),c=i(24215),p=i(1591),d=i(15675),u=i(9625),g=i(11543),y=i(65525),h=i(64074),f=i(69250),m=i(47354),D=i(32118);const k=(0,h.observer)(function(e){const{model:a,handleClose:i}=e,[h,k]=(0,s.useState)(""),[v,A]=(0,s.useState)(),[C,$]=(0,s.useState)(!1),[x,L]=(0,s.useState)(),b=/^[A-Za-z][A-Za-z0-9]$/.exec(h),j=2===h.length&&!b,w=(0,r.useDebounce)(h,1e3),[I,S]=(0,s.useState)("");return(0,s.useEffect)(()=>{(async()=>{try{if(!j){L(void 0),$(!0);const e=await(0,f.X)({self:a,tag:w,blocks:(0,r.getContainingView)(a).staticBlocks});A(e)}}catch(e){console.error(e),L(e)}finally{$(!1)}})()},[a,j,w]),(0,D.jsxs)(t.A,{open:!0,onClose:i,title:"Group by",children:[(0,D.jsxs)(c.A,{children:[(0,D.jsx)(p.A,{children:'NOTE: this will create new session tracks with the "filter by" set to the values chosen here rather than affecting the current track state'}),(0,D.jsxs)(d.A,{fullWidth:!0,value:I,onChange:e=>{S(e.target.value)},label:"Group by...",select:!0,children:[(0,D.jsx)(u.A,{value:"strand",children:"Strand"}),(0,D.jsx)(u.A,{value:"tag",children:"Tag"})]}),"tag"===I?(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(p.A,{color:"textSecondary",children:"Examples: HP for haplotype, RG for read group, etc."}),(0,D.jsx)(d.A,{value:h,onChange:e=>{k(e.target.value)},placeholder:"Enter tag name",error:j,helperText:j?"Not a valid tag":"",autoComplete:"off","data-testid":"group-tag-name",slotProps:{htmlInput:{maxLength:2,"data-testid":"group-tag-name-input"}}}),x?(0,D.jsx)(n.A,{error:x}):C?(0,D.jsx)(l.A,{message:"Loading unique tags"}):v?(0,D.jsxs)("div",{children:[(0,D.jsxs)("div",{children:["Found unique ",h," values:"]}),(0,D.jsx)("div",{children:v.join(", ")})]}):null]}):null]}),(0,D.jsxs)(g.A,{children:[(0,D.jsx)(y.A,{variant:"contained",color:"primary",type:"submit",disabled:!v,autoFocus:!0,onClick:()=>{const e=(0,r.getContainingTrack)(a),s=structuredClone((0,o.getSnapshot)(e.configuration)),t=(0,r.getSession)(a),n=(0,r.getContainingView)(a);if("tag"===I){if(v){const e=[...v,void 0];for(const a of e){const e=`${s.trackId}-${h}:${a}-${Date.now()}-sessionTrack`;t.addTrackConf({...s,trackId:e,name:`${s.name} (${h}:${a})`,displays:[{displayId:`${e}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${e}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:{...m.JD,tagFilter:{tag:h,value:a}}}}]}),n.showTrack(e)}}}else if("strand"===I){const e=`${s.trackId}-${h}:(-)-${Date.now()}-sessionTrack`,a=`${s.trackId}-${h}:(+)-${Date.now()}-sessionTrack`;t.addTrackConf({...s,trackId:e,name:`${s.name} (-)`,displays:[{displayId:`${e}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${e}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:m.CQ}},{displayId:`${e}-LinearSNPCoverageDisplay`,type:"LinearSNPCoverageDisplay",filterBy:m.CQ}]}),t.addTrackConf({...s,trackId:a,name:`${s.name} (+)`,displays:[{displayId:`${a}-LinearAlignmentsDisplay`,type:"LinearAlignmentsDisplay",pileupDisplay:{displayId:`${a}-LinearAlignmentsDisplay-LinearPileupDisplay`,type:"LinearPileupDisplay",filterBy:m.Ar}},{displayId:`${a}-LinearSNPCoverageDisplay`,type:"LinearSNPCoverageDisplay",filterBy:m.Ar}]}),n.showTrack(e),n.showTrack(a)}i()},children:"Submit"}),(0,D.jsx)(y.A,{variant:"contained",color:"secondary",onClick:()=>{i()},children:"Cancel"})]})]})})}}]);
//# sourceMappingURL=2276.c6143a20.chunk.js.map