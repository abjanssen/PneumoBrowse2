"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[6261],{86261:(e,s,t)=>{t.r(s),t.d(s,{default:()=>M});var n=t(7552),a=t(49823),i=t(99546),o=t(67750),r=t(30157),l=t(63896),c=t(61723),d=t(5401),m=t(68446),p=t(75785),y=t(48171),h=t(56089),u=t(33371),f=t(33248),x=t(25914),b=t(943),j=t(36715),g=t(66311),v=t(89003);function A({radioOption:e,assembly1:s,assembly2:t,fileLocation:n,indexFileLocation:a,bed1Location:i,bed2Location:o}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:n,queryAssembly:s,targetAssembly:t};if(".out"===e)return{type:"MashMapAdapter",outLocation:n,queryAssembly:s,targetAssembly:t};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:n,queryAssembly:s,targetAssembly:t};if(".chain"===e)return{type:"ChainAdapter",chainLocation:n,queryAssembly:s,targetAssembly:t};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:n,bed1Location:i,bed2Location:o,assemblyNames:[s,t]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:n,bed1Location:i,bed2Location:o,assemblyNames:[s,t]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:n,index:{location:a},assemblyNames:[s,t]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}var w=t(69500);const k=(0,m.observer)((function({model:e,assembly1:s,assembly2:t,selectedRow:i}){const[o,r]=(0,n.useState)(!1),[l,c]=(0,n.useState)(),[m,p]=(0,n.useState)(),[y,k]=(0,n.useState)(),[S,C]=(0,n.useState)(),[L,T]=(0,n.useState)(""),[F,N]=(0,n.useState)(),I=(P=y)?P.uri||P.localPath||P.name:void 0;var P;const M=L||(I?function(e){const s=e.split(".").pop();return s?`.${s}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(I)):"");return(0,n.useEffect)((()=>{try{if(y){const n=I?I.split("#")[0].split("?")[0].split("/").pop():"MyTrack",a=`${n}-${Date.now()}-sessionTrack`;N(void 0),e.setImportFormSyntenyTrack(i,{type:"userOpened",value:{trackId:a,name:n,assemblyNames:[t,s],type:"SyntenyTrack",adapter:A({radioOption:M,assembly1:o?t:s,assembly2:o?s:t,fileLocation:y,indexFileLocation:S,bed1Location:m,bed2Location:l})}})}}catch(e){console.error(e),N(e)}}),[o,e,i,I,s,t,m,l,y,S,M]),(0,w.jsxs)(b.A,{style:{padding:12},children:[F?(0,w.jsx)(a.ErrorMessage,{error:F}):null,(0,w.jsx)(j.A,{style:{textAlign:"center"},children:"Add a .paf (minimap2), .delta (Mummer), .chain (UCSC liftover), .anchors or .anchors.simple (MCScan), or .pif.gz (jbrowse CLI make-pif) file to view. These file types can also be gzipped."}),(0,w.jsx)(h.A,{value:M,onChange:e=>{T(e.target.value)},children:(0,w.jsx)(g.A,{container:!0,justifyContent:"center",children:[".paf",".delta",".out",".chain",".anchors",".anchors.simple",".pif.gz"].map((e=>(0,w.jsx)(u.A,{value:e,control:(0,w.jsx)(f.A,{}),label:e},e)))})}),(0,w.jsx)(g.A,{container:!0,justifyContent:"center",children:".paf"===M||".out"===M||".delta"===M||".chain"===M||".pif.gz"===M?(0,w.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,w.jsx)(a.FileSelector,{name:`${M} location`,inline:!0,description:"",location:y,setLocation:e=>{k(e)}}),(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{children:["Verify or click swap",(0,w.jsx)(v.A,{title:(0,w.jsx)("code",{children:{".paf":"minimap2 target.fa query.fa",".pif.gz":"minimap2 target.fa query.fa",".out":"mashmap target.fa query.fa",".delta":"mummer target.fa query.fa",".chain":"e.g. queryToTarget.chain"}[M]}),children:(0,w.jsx)(x.A,{})})]}),(0,w.jsxs)("div",{style:{display:"flex",gap:20},children:[(0,w.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{children:o?t:s})}),(0,w.jsx)("div",{children:"query assembly"}),(0,w.jsx)("div",{children:(0,w.jsx)("i",{children:o?s:t})}),(0,w.jsx)("div",{children:"target assembly"})]}),(0,w.jsx)(d.A,{variant:"contained",onClick:()=>{r(!o)},children:"Swap?"})]})]})]}):".anchors"===L||".anchors.simple"===L?(0,w.jsxs)("div",{children:[(0,w.jsxs)("div",{style:{margin:20},children:["Open the ",L," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,w.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)(a.FileSelector,{inline:!0,name:L,location:y,setLocation:e=>{k(e)}}),(0,w.jsx)(a.FileSelector,{inline:!0,name:"genome 1 .bed (left column of anchors file)",description:"",location:m,setLocation:e=>{p(e)}}),(0,w.jsx)(a.FileSelector,{inline:!0,name:"genome 2 .bed (right column of anchors file)",description:"",location:l,setLocation:e=>{c(e)}})]}),(0,w.jsxs)("div",{style:{margin:"auto",display:"flex",justifyContent:"center",gap:20},children:[(0,w.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"},children:[(0,w.jsx)("div",{children:(0,w.jsx)("i",{children:o?t:s})}),(0,w.jsx)("div",{children:"bed1 assembly"}),(0,w.jsx)("div",{children:(0,w.jsx)("i",{children:o?s:t})}),(0,w.jsx)("div",{children:"bed2 assembly"})]}),(0,w.jsx)(d.A,{variant:"contained",onClick:()=>{r(!o)},children:"Swap?"})]})]}):".pif.gz"===L?(0,w.jsxs)("div",{style:{display:"flex"},children:[(0,w.jsx)("div",{children:(0,w.jsx)(a.FileSelector,{name:`${L} location`,description:"",location:y,setLocation:e=>{k(e)}})}),(0,w.jsx)("div",{children:(0,w.jsx)(a.FileSelector,{name:`${L} index location`,description:"",location:S,setLocation:e=>{C(e)}})})]}):(0,w.jsx)(a.FileSelector,{name:L?`${L} location`:"",description:"",location:y,setLocation:e=>{k(e)}})})]})}));var S=t(68584),C=t(91468),L=t(98360),T=t(29629);const F=(0,m.observer)((function({model:e,selectedRow:s,assembly1:t,assembly2:o}){const r=(0,i.getSession)(e),{importFormSyntenyTrackSelections:l}=e,{tracks:c=[],sessionTracks:d=[]}=r,m=[...c,...d].filter((e=>{const s=(0,S.readConfObject)(e,"assemblyNames");return s.includes(t)&&s.includes(o)&&e.type.includes("Synteny")})),p=m[0]?.trackId||"",y=l[s],h="preConfigured"===y?.type?y.value:void 0;return(0,n.useEffect)((()=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:p})}),[o,t,p,s,e]),(0,w.jsxs)(b.A,{style:{padding:12},children:[(0,w.jsx)(j.A,{children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),h&&m.map((e=>e.trackId)).includes(h)?(0,w.jsx)(L.A,{value:h,onChange:t=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:t.target.value})},children:m.map((e=>(0,w.jsx)(T.A,{value:e.trackId,children:(0,C.getTrackName)(e,r)},e.trackId)))}):(0,w.jsx)(a.ErrorMessage,{error:`No synteny tracks found for ${t},${o}`})]})}));function N({model:e,assembly1:s,assembly2:t,selectedRow:a}){const[i,o]=(0,n.useState)("tracklist");return(0,n.useEffect)((()=>{"none"===i&&e.setImportFormSyntenyTrack(a,{type:"none"})}),[i,e,a]),(0,w.jsxs)("div",{children:[(0,w.jsx)(y.A,{children:(0,w.jsxs)(h.A,{row:!0,value:i,"aria-labelledby":"group-label",onChange:e=>{o(e.target.value)},children:[(0,w.jsx)(u.A,{value:"none",control:(0,w.jsx)(f.A,{}),label:"None"}),(0,w.jsx)(u.A,{value:"tracklist",control:(0,w.jsx)(f.A,{}),label:"Existing track"}),(0,w.jsx)(u.A,{value:"custom",control:(0,w.jsx)(f.A,{}),label:"New track"})]})}),"custom"===i?(0,w.jsx)(k,{model:e,selectedRow:a,assembly2:t,assembly1:s}):null,"tracklist"===i?(0,w.jsx)(F,{model:e,selectedRow:a,assembly1:s,assembly2:t}):null]})}var I=t(42489);const P=(0,p.n9)()((e=>({importFormContainer:{padding:e.spacing(4)},button:{margin:e.spacing(2)},rel:{position:"relative"},synbutton:{position:"absolute",top:30},flex:{display:"flex",gap:90},mb:{marginBottom:10},bg:{background:e.palette.divider},rightPanel:{flexGrow:11},leftPanel:{flexGrow:4,flexShrink:0}}))),M=(0,m.observer)((function({model:e}){const{classes:s,cx:t}=P(),m=(0,i.getSession)(e),{assemblyNames:p}=m,y=p[0]||"",[h,u]=(0,n.useState)(0),[f,x]=(0,n.useState)([y,y]),[b,j]=(0,n.useState)();return(0,w.jsxs)(l.A,{className:s.importFormContainer,children:[b?(0,w.jsx)(a.ErrorMessage,{error:b}):null,(0,w.jsxs)("div",{className:s.flex,children:[(0,w.jsxs)("div",{className:s.leftPanel,children:[(0,w.jsx)("div",{className:s.mb,children:"Select assemblies for linear synteny view"}),f.map(((n,l)=>(0,w.jsxs)("div",{className:s.rel,children:[(0,w.jsxs)("span",{children:["Row ",l+1,": "]}),(0,w.jsx)(c.A,{disabled:f.length<=2,onClick:()=>{e.importFormRemoveRow(l),x(f.map(((e,s)=>s===l?void 0:e)).filter(i.notEmpty)),h>=f.length-2&&u(0)},children:(0,w.jsx)(r.A,{})}),(0,w.jsx)(a.AssemblySelector,{helperText:"",selected:n,onChange:e=>{x(f.map(((s,t)=>t===l?e:s)))},session:m}),l!==f.length-1?(0,w.jsx)(c.A,{"data-testid":"synbutton",className:t(s.synbutton,l===h?s.bg:void 0),onClick:()=>{u(l)},children:(0,w.jsx)(o.A,{})}):null]},`${n}-${l}`))),(0,w.jsxs)("div",{children:[(0,w.jsx)(d.A,{className:s.button,variant:"contained",color:"secondary",onClick:()=>{x([...f,y])},children:"Add row"}),(0,w.jsx)(d.A,{className:s.button,onClick:()=>{(async()=>{try{j(void 0),await async function({selectedAssemblyNames:e,model:s}){const t=(0,i.getSession)(s),{assemblyManager:n}=t,{importFormSyntenyTrackSelections:a}=s;s.setViews(await Promise.all(e.map((async e=>{const s=await n.waitForAssembly(e);if(!s)throw new Error(`Assembly "${e}" failed to load`);return{type:"LinearGenomeView",bpPerPx:1,offsetPx:0,hideHeader:!0,displayedRegions:s.regions}}))));for(const e of s.views)e.setWidth(s.width),e.showAllRegions();(0,i.isSessionWithAddTracks)(t)?(0,I.toJS)(a).map(((e,n)=>{"userOpened"===e.type?(t.addTrackConf(e.value),s.toggleTrack(e.value?.trackId,n)):"preConfigured"===e.type&&s.showTrack(e.value,n)})):t.notify("Can't add tracks","warning"),s.clearImportFormSyntenyTracks()}({selectedAssemblyNames:f,model:e})}catch(e){console.error(e),j(e)}})()},variant:"contained",color:"primary",children:"Launch"})]})]}),(0,w.jsxs)("div",{className:s.rightPanel,children:[(0,w.jsxs)("div",{children:["Synteny dataset to display between row ",h+1," and"," ",h+2]}),(0,w.jsx)(N,{model:e,selectedRow:h,assembly1:f[h],assembly2:f[h+1]})]})]})]})}))}}]);
//# sourceMappingURL=6261.0bd3cec0.chunk.js.map