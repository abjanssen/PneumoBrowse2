{"version":3,"file":"static/js/2380.195b02c2.chunk.js","mappings":"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","sources":["webpack://@jbrowse/web/../../packages/sv-core/src/util.ts","webpack://@jbrowse/web/../../plugins/variants/src/VariantFeatureWidget/LaunchBreakendPanel/LaunchBreakendPanel.tsx"],"sourcesContent":["import { parseBreakend } from '@gmod/vcf'\n\nimport type { Track } from './types.ts'\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport function getBreakendCoveringRegions({\n  feature,\n  assembly,\n}: {\n  feature: Feature\n  assembly: Assembly\n}) {\n  const alt = feature.get('ALT')?.[0]\n  const bnd = alt ? parseBreakend(alt) : undefined\n  const startPos = feature.get('start')\n  const refName = feature.get('refName')\n  const f = (ref: string) => assembly.getCanonicalRefName(ref) || ref\n\n  if (alt === '<TRA>') {\n    const INFO = feature.get('INFO')\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(INFO.CHR2[0]),\n      matePos: INFO.END[0] - 1,\n    }\n  } else if (bnd?.MatePosition) {\n    const matePosition = bnd.MatePosition.split(':')\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(matePosition[0]!),\n      matePos: +matePosition[1]! - 1,\n    }\n  } else if (feature.get('mate')) {\n    const mate = feature.get('mate')\n    const strand = feature.get('strand')\n    const mateStrand = mate.strand\n    // Use the correct \"side\" of the feature based on strand:\n    // Forward strand (1): use end position (right side)\n    // Reverse strand (-1): use start position (left side)\n    const pos = strand === 1 ? feature.get('end') : startPos\n    const matePos = mateStrand === 1 ? mate.start : (mate.end ?? mate.start)\n    return {\n      pos,\n      refName: f(refName),\n      mateRefName: f(mate.refName),\n      matePos,\n    }\n  } else {\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(refName),\n      matePos: feature.get('end'),\n    }\n  }\n}\n\nexport function stripIds(arr: Track[]) {\n  return arr.map(({ id, displays, ...rest }) => ({\n    ...rest,\n    displays: displays.map(({ id, ...rest }) => rest),\n  }))\n}\n\nexport function makeTitle(f: Feature) {\n  return `${f.get('name') || f.get('id') || 'breakend'} split detail`\n}\n\nexport interface Region {\n  refName: string\n  start: number\n  end: number\n  assemblyName?: string\n}\n\nexport interface ViewWithAssemblyNames {\n  assemblyNames: string[]\n}\n\n/**\n * Safely extracts the first assemblyName from a view's assemblyNames getter.\n * Returns undefined if the view or assemblyNames are not available.\n */\nexport function getAssemblyName(view?: ViewWithAssemblyNames) {\n  return view?.assemblyNames[0]\n}\n\n/**\n * Splits a region at a breakend position into two overlapping regions.\n *\n * JBrowse uses 0-based, half-open coordinates where `end` is exclusive.\n * To ensure the breakend position is visible in both regions:\n * - Left region: ends at pos + 1 (includes position pos)\n * - Right region: starts at pos (includes position pos)\n *\n * This intentional overlap ensures features at the breakend are displayed.\n */\nexport function splitRegionAtPosition<\n  T extends { refName: string; start: number; end: number },\n>(\n  region: T,\n  pos: number,\n  assemblyName?: string,\n): [T & { assemblyName?: string }, T & { assemblyName?: string }] {\n  return [\n    {\n      ...region,\n      end: pos + 1,\n      ...(assemblyName !== undefined && { assemblyName }),\n    },\n    {\n      ...region,\n      start: pos,\n      ...(assemblyName !== undefined && { assemblyName }),\n    },\n  ]\n}\n","import { lazy } from 'react'\n\nimport BaseCard from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail/BaseCard'\nimport { SimpleFeature, getEnv, getSession } from '@jbrowse/core/util'\nimport { getAssemblyName } from '@jbrowse/sv-core'\nimport { Link, Typography } from '@mui/material'\n\nimport type { VariantFeatureWidgetModel } from '../stateModelFactory.ts'\nimport type { SimpleFeatureSerialized } from '@jbrowse/core/util'\n\nconst BreakpointSplitViewChoiceDialog = lazy(\n  () => import('./BreakpointSplitViewChoiceDialog.tsx'),\n)\n\nfunction LocStringList({\n  locStrings,\n  model,\n}: {\n  locStrings: string[]\n  model: VariantFeatureWidgetModel\n}) {\n  const session = getSession(model)\n  return (\n    <div>\n      <Typography>Navigate to breakend endpoint in linear view:</Typography>\n      <ul>\n        {locStrings.map((locString, index) => (\n          /* biome-ignore lint/suspicious/noArrayIndexKey: */\n          <li key={`${locString}-${index}`}>\n            {locString}{' '}\n            <Link\n              href=\"#\"\n              onClick={event => {\n                event.preventDefault()\n                const { view } = model\n                try {\n                  if (view) {\n                    view.navToLocString?.(locString)\n                  } else {\n                    throw new Error(\n                      'No view associated with this feature detail panel anymore',\n                    )\n                  }\n                } catch (e) {\n                  console.error(e)\n                  session.notify(`${e}`)\n                }\n              }}\n            >\n              (LGV)\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  )\n}\n\nfunction LaunchBreakpointSplitViewPanel({\n  locStrings,\n  model,\n  feature,\n}: {\n  locStrings: string[]\n  model: VariantFeatureWidgetModel\n  feature: SimpleFeatureSerialized\n}) {\n  const session = getSession(model)\n  const simpleFeature = new SimpleFeature(feature)\n  const assemblyName = getAssemblyName(model.view)\n\n  return assemblyName ? (\n    <div>\n      <Typography>Launch split view</Typography>\n      <ul>\n        {locStrings.map(locString => (\n          <li key={locString}>\n            {`${feature.refName}:${feature.start} // ${locString}`}{' '}\n            <Link\n              href=\"#\"\n              onClick={event => {\n                event.preventDefault()\n                session.queueDialog(handleClose => [\n                  BreakpointSplitViewChoiceDialog,\n                  {\n                    handleClose,\n                    session,\n                    feature: simpleFeature,\n                    stableViewId: `${model.id}_${assemblyName}_breakpointsplitview`,\n                    view: model.view,\n                    assemblyName,\n                  },\n                ])\n              }}\n            >\n              (breakpoint split view)\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  ) : null\n}\n\nexport default function LaunchBreakendPanel(props: {\n  locStrings: string[]\n  model: VariantFeatureWidgetModel\n  feature: SimpleFeatureSerialized\n}) {\n  const { model, locStrings, feature } = props\n  const session = getSession(model)\n  const { pluginManager } = getEnv(session)\n  let hasBreakpointSplitView = false\n\n  try {\n    hasBreakpointSplitView = !!pluginManager.getViewType('BreakpointSplitView')\n  } catch (e) {\n    // ignore\n  }\n\n  return (\n    <BaseCard {...props} title=\"Breakends\">\n      <LocStringList model={model} locStrings={locStrings} />\n      {hasBreakpointSplitView ? (\n        <LaunchBreakpointSplitViewPanel\n          model={model}\n          locStrings={locStrings}\n          feature={feature}\n        />\n      ) : null}\n    </BaseCard>\n  )\n}\n"],"names":["getBreakendCoveringRegions","feature","assembly","alt","get","bnd","parseBreakend","undefined","startPos","refName","f","ref","getCanonicalRefName","INFO","pos","mateRefName","CHR2","matePos","END","MatePosition","matePosition","split","mate","strand","mateStrand","start","end","stripIds","arr","map","id","displays","rest","makeTitle","getAssemblyName","view","assemblyNames","splitRegionAtPosition","region","assemblyName","BreakpointSplitViewChoiceDialog","lazy","LocStringList","locStrings","model","session","getSession","_jsxs","children","_jsx","Typography","locString","index","Link","href","onClick","event","preventDefault","Error","navToLocString","e","console","error","notify","LaunchBreakpointSplitViewPanel","t0","$","_c","t1","simpleFeature","SimpleFeature","queueDialog","handleClose","stableViewId","LaunchBreakendPanel","props","hasBreakpointSplitView","t2","pluginManager","getEnv","getViewType","BaseCard","title"],"sourceRoot":""}