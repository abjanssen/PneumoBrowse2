{"version":3,"file":"static/js/1333.c9b20278.chunk.js","mappings":"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","sources":["../../../plugins/dotplot-view/src/DotplotView/svgcomponents/SVGBackground.tsx","../../../plugins/dotplot-view/src/DotplotView/svgcomponents/SVGDotplotView.tsx","../../../plugins/dotplot-view/src/DotplotView/components/Axes.tsx","../../../plugins/dotplot-view/src/DotplotView/components/DotplotGrid.tsx"],"sourcesContent":["import { stripAlpha } from '@jbrowse/core/util'\nimport { useTheme } from '@mui/material'\n\nexport default function SVGBackground({\n  width,\n  height,\n}: {\n  width: number\n  height: number\n}) {\n  const theme = useTheme()\n  return (\n    <rect\n      x={0}\n      y={0}\n      width={width}\n      height={height}\n      fill={stripAlpha(theme.palette.background.default)}\n    />\n  )\n}\n","import { createJBrowseTheme } from '@jbrowse/core/ui'\nimport { getSession, renderToStaticMarkup } from '@jbrowse/core/util'\nimport { ThemeProvider } from '@mui/material'\nimport { when } from 'mobx'\n\nimport SVGBackground from './SVGBackground.tsx'\nimport { HorizontalAxisRaw, VerticalAxisRaw } from '../components/Axes.tsx'\nimport DotplotGrid from '../components/DotplotGrid.tsx'\n\nimport type { DotplotViewModel, ExportSvgOptions } from '../model.ts'\n\n// render LGV to SVG\nexport async function renderToSvg(\n  model: DotplotViewModel,\n  opts: ExportSvgOptions,\n) {\n  await when(() => model.initialized)\n  const { themeName = 'default', Wrapper = ({ children }) => children } = opts\n\n  const session = getSession(model)\n  const theme = session.allThemes?.()[themeName]\n  const { width, borderX, viewWidth, viewHeight, tracks, height } = model\n  const shift = 50\n  const displayResults = await Promise.all(\n    tracks.map(async track => {\n      const display = track.displays[0]\n      await when(() => (display.ready !== undefined ? display.ready : true))\n      return { track, result: await display.renderSvg({ ...opts, theme }) }\n    }),\n  )\n  const w = width + shift * 2\n\n  // the xlink namespace is used for rendering <image> tag\n  return renderToStaticMarkup(\n    <ThemeProvider theme={createJBrowseTheme(theme)}>\n      <Wrapper>\n        <svg\n          width={width}\n          height={height}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n          viewBox={[0, 0, w, height].toString()}\n        >\n          <SVGBackground width={w} height={height} />\n          <VerticalAxisRaw model={model} />\n          <g transform={`translate(${borderX} 0)`}>\n            <DotplotGrid model={model} />\n            <defs>\n              <clipPath id=\"clip-ruler\">\n                <rect x={0} y={0} width={viewWidth} height={viewHeight} />\n              </clipPath>\n            </defs>\n            <g clipPath=\"url(#clip-ruler)\">\n              {displayResults.map(({ result }, i) => (\n                /* biome-ignore lint/suspicious/noArrayIndexKey: */\n                <g key={i}>{result}</g>\n              ))}\n            </g>\n          </g>\n          <g transform={`translate(${borderX} ${viewHeight})`}>\n            <HorizontalAxisRaw model={model} />\n          </g>\n        </svg>\n      </Wrapper>\n    </ThemeProvider>,\n  )\n}\n","import {\n  getFillProps,\n  getStrokeProps,\n  getTickDisplayStr,\n} from '@jbrowse/core/util'\nimport { bpToPx } from '@jbrowse/core/util/Base1DUtils'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { getSnapshot } from '@jbrowse/mobx-state-tree'\nimport { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { getBlockLabelKeysToHide } from './util.ts'\n\nimport type { DotplotViewModel } from '../model.ts'\n\nconst useStyles = makeStyles()(() => ({\n  vtext: {\n    gridColumn: '1/2',\n    gridRow: '1/2',\n    pointerEvents: 'none',\n    userSelect: 'none',\n  },\n  htext: {\n    gridColumn: '2/2',\n    gridRow: '2/2',\n    pointerEvents: 'none',\n    userSelect: 'none',\n  },\n}))\nexport const HorizontalAxis = observer(function HorizontalAxis({\n  model,\n}: {\n  model: DotplotViewModel\n}) {\n  const { viewWidth, borderY } = model\n  const { classes } = useStyles()\n  return (\n    <svg width={viewWidth} height={borderY} className={classes.htext}>\n      <HorizontalAxisRaw model={model} />\n    </svg>\n  )\n})\n\nexport const HorizontalAxisRaw = observer(function HorizontalAxisRaw({\n  model,\n}: {\n  model: DotplotViewModel\n}) {\n  const { viewWidth, borderX, borderY, hview, htextRotation, hticks } = model\n  const { offsetPx, width, dynamicBlocks, bpPerPx } = hview\n  const dblocks = dynamicBlocks.contentBlocks\n  const hide = getBlockLabelKeysToHide(dblocks, viewWidth, offsetPx)\n  const theme = useTheme()\n  const hviewSnap = {\n    ...getSnapshot(hview),\n    width,\n    staticBlocks: hview.staticBlocks,\n  }\n\n  const ticks = hticks\n    .map(\n      tick =>\n        [\n          tick,\n          bpToPx({\n            refName: tick.refName,\n            coord: tick.base,\n            self: hviewSnap,\n          })?.offsetPx,\n        ] as const,\n    )\n    .filter(f => f[1] !== undefined)\n    .map(f => [f[0], f[1]! - offsetPx] as const)\n\n  return (\n    <>\n      {dblocks\n        .filter(region => !hide.has(region.key))\n        .map(region => {\n          const xoff = Math.floor(region.offsetPx - hview.offsetPx)\n          return (\n            <text\n              transform={`rotate(${htextRotation},${xoff},0)`}\n              key={region.key}\n              x={xoff}\n              y={1}\n              fontSize={11}\n              dominantBaseline=\"hanging\"\n              textAnchor=\"end\"\n              {...getFillProps(theme.palette.text.primary)}\n            >\n              {region.refName}\n            </text>\n          )\n        })}\n      {ticks.map(([tick, x], idx) =>\n        x > 0 && x < width ? (\n          <line\n            key={`line-${tick.refName}-${tick.base}-${idx}`}\n            x1={x}\n            x2={x}\n            y1={0}\n            y2={tick.type === 'major' ? 6 : 4}\n            strokeWidth={1}\n            {...getStrokeProps(theme.palette.text.primary)}\n          />\n        ) : null,\n      )}\n      {ticks\n        .filter(t => t[0].type === 'major')\n        .map(([tick, x], idx) =>\n          x > 10 && x < width ? (\n            <text\n              x={x - 7}\n              y={0}\n              transform={`rotate(${htextRotation},${x},0)`}\n              key={`text-${tick.refName}-${tick.base}-${idx}`}\n              fontSize={11}\n              dominantBaseline=\"middle\"\n              textAnchor=\"end\"\n              {...getFillProps(theme.palette.text.primary)}\n            >\n              {getTickDisplayStr(tick.base + 1, bpPerPx)}\n            </text>\n          ) : null,\n        )}\n      <text\n        y={borderY - 12}\n        x={(viewWidth - borderX) / 2}\n        textAnchor=\"middle\"\n        fontSize={11}\n        dominantBaseline=\"hanging\"\n        {...getFillProps(theme.palette.text.primary)}\n      >\n        {hview.assemblyNames.join(',')}\n      </text>\n    </>\n  )\n})\nexport const VerticalAxis = observer(function VerticalAxis({\n  model,\n}: {\n  model: DotplotViewModel\n}) {\n  const { borderX, viewHeight } = model\n  const { classes } = useStyles()\n  return (\n    <svg className={classes.vtext} width={borderX} height={viewHeight}>\n      <VerticalAxisRaw model={model} />\n    </svg>\n  )\n})\n\nexport const VerticalAxisRaw = observer(function VerticalAxisRaw({\n  model,\n}: {\n  model: DotplotViewModel\n}) {\n  const { viewHeight, borderX, borderY, vview, vtextRotation, vticks } = model\n  const { offsetPx, width, dynamicBlocks, bpPerPx } = vview\n  const dblocks = dynamicBlocks.contentBlocks\n  const hide = getBlockLabelKeysToHide(dblocks, viewHeight, offsetPx)\n  const theme = useTheme()\n  const vviewSnap = {\n    ...getSnapshot(vview),\n    width,\n    staticBlocks: vview.staticBlocks,\n  }\n  const ticks = vticks\n    .map(\n      tick =>\n        [\n          tick,\n          bpToPx({\n            refName: tick.refName,\n            coord: tick.base,\n            self: vviewSnap,\n          })?.offsetPx,\n        ] as const,\n    )\n    .filter(f => f[1] !== undefined)\n    .map(f => [f[0], f[1]! - offsetPx] as const)\n\n  return (\n    <>\n      {dblocks\n        .filter(region => !hide.has(region.key))\n        .map(region => {\n          const yoff = Math.floor(viewHeight - region.offsetPx + offsetPx)\n          return (\n            <text\n              transform={`rotate(${vtextRotation},${borderX},${region.offsetPx})`}\n              key={region.key}\n              x={borderX}\n              y={yoff}\n              fontSize={11}\n              textAnchor=\"end\"\n              {...getFillProps(theme.palette.text.primary)}\n            >\n              {region.refName}\n            </text>\n          )\n        })}\n      {ticks.map(([tick, y], idx) =>\n        y > 0 && y < viewHeight ? (\n          <line\n            key={`line-${tick.refName}-${tick.base}-${idx}`}\n            y1={viewHeight - y}\n            y2={viewHeight - y}\n            x1={borderX}\n            x2={borderX - (tick.type === 'major' ? 6 : 4)}\n            strokeWidth={1}\n            {...getStrokeProps(theme.palette.text.primary)}\n          />\n        ) : null,\n      )}\n      {ticks\n        .filter(t => t[0].type === 'major')\n        .map(([tick, y], idx) =>\n          y > 10 && y < viewHeight ? (\n            <text\n              y={viewHeight - y - 3}\n              x={borderX - 7}\n              key={`text-${tick.refName}-${tick.base}-${idx}`}\n              textAnchor=\"end\"\n              dominantBaseline=\"hanging\"\n              fontSize={11}\n              {...getFillProps(theme.palette.text.primary)}\n            >\n              {getTickDisplayStr(tick.base + 1, bpPerPx)}\n            </text>\n          ) : null,\n        )}\n      <text\n        y={(viewHeight - borderY) / 2}\n        x={12}\n        transform={`rotate(-90,12,${(viewHeight - borderY) / 2})`}\n        textAnchor=\"middle\"\n        fontSize={11}\n        {...getFillProps(theme.palette.text.primary)}\n      >\n        {vview.assemblyNames.join(',')}\n      </text>\n    </>\n  )\n})\n","import { getFillProps, getStrokeProps } from '@jbrowse/core/util'\nimport { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { DotplotViewModel } from '../model.ts'\n\nconst DotplotGrid = observer(function DotplotGrid({\n  model,\n  children,\n}: {\n  model: DotplotViewModel\n  children?: React.ReactNode\n}) {\n  const { viewWidth, viewHeight, hview, vview } = model\n  const hblocks = hview.dynamicBlocks.contentBlocks\n  const vblocks = vview.dynamicBlocks.contentBlocks\n  const theme = useTheme()\n  if (!hblocks.length || !vblocks.length) {\n    return null\n  }\n  const htop = hview.displayedRegionsTotalPx - hview.offsetPx\n  const vtop = vview.displayedRegionsTotalPx - vview.offsetPx\n  const hbottom = hblocks[0]!.offsetPx - hview.offsetPx\n  const vbottom = vblocks[0]!.offsetPx - vview.offsetPx\n  const stroke = theme.palette.divider\n\n  // Uses math.max/min avoid making very large SVG rect offscreen element,\n  // which can sometimes fail to draw\n  const rx = Math.max(hbottom, 0)\n  const ry = Math.max(viewHeight - vtop, 0)\n  const w = Math.min(htop - hbottom, viewWidth)\n  const h = Math.min(viewHeight - vbottom - ry, viewHeight)\n\n  // Filter blocks to avoid rendering duplicate lines at the same pixel position\n  const hlines = hblocks.filter((region, idx) => {\n    const x = Math.floor(region.offsetPx - hview.offsetPx)\n    const prevX =\n      idx > 0 ? Math.floor(hblocks[idx - 1]!.offsetPx - hview.offsetPx) : null\n    return x !== prevX\n  })\n  const vlines = vblocks.filter((region, idx) => {\n    const y = Math.floor(viewHeight - (region.offsetPx - vview.offsetPx))\n    const prevY =\n      idx > 0\n        ? Math.floor(viewHeight - (vblocks[idx - 1]!.offsetPx - vview.offsetPx))\n        : null\n    return y !== prevY\n  })\n\n  return (\n    <>\n      <rect\n        x={rx}\n        y={ry}\n        width={w}\n        height={h}\n        {...getFillProps(theme.palette.background.default)}\n      />\n      <g>\n        {hlines.map(region => {\n          const x = region.offsetPx - hview.offsetPx\n          return (\n            <line\n              key={region.key}\n              x1={x}\n              y1={0}\n              x2={x}\n              y2={viewHeight}\n              {...getStrokeProps(stroke)}\n            />\n          )\n        })}\n        {vlines.map(region => {\n          const y = viewHeight - (region.offsetPx - vview.offsetPx)\n          return (\n            <line\n              key={region.key}\n              x1={0}\n              y1={y}\n              x2={viewWidth}\n              y2={y}\n              {...getStrokeProps(stroke)}\n            />\n          )\n        })}\n        <line\n          x1={htop}\n          y1={0}\n          x2={htop}\n          y2={viewHeight}\n          {...getStrokeProps(stroke)}\n        />\n        <line\n          x1={0}\n          y1={viewHeight - vtop}\n          x2={viewWidth}\n          y2={viewHeight - vtop}\n          {...getStrokeProps(stroke)}\n        />\n      </g>\n      {children}\n    </>\n  )\n})\n\nexport default DotplotGrid\n"],"names":["SVGBackground","t0","$","_c","width","height","theme","useTheme","t1","t2","palette","background","default","stripAlpha","_jsx","x","y","fill","async","renderToSvg","model","opts","when","initialized","themeName","Wrapper","children","session","getSession","allThemes","borderX","viewWidth","viewHeight","tracks","displayResults","Promise","all","map","display","track","displays","undefined","ready","result","renderSvg","w","shift","renderToStaticMarkup","ThemeProvider","createJBrowseTheme","_jsxs","xmlns","xmlnsXlink","viewBox","toString","VerticalAxisRaw","transform","DotplotGrid","id","clipPath","i","HorizontalAxisRaw","useStyles","makeStyles","vtext","gridColumn","gridRow","pointerEvents","userSelect","htext","HorizontalAxis","observer","borderY","classes","className","hview","htextRotation","hticks","offsetPx","dynamicBlocks","bpPerPx","dblocks","contentBlocks","hide","getBlockLabelKeysToHide","hviewSnap","getSnapshot","staticBlocks","ticks","tick","bpToPx","refName","coord","base","self","filter","f","_Fragment","region","has","key","xoff","Math","floor","fontSize","dominantBaseline","textAnchor","getFillProps","text","primary","idx","x1","x2","y1","y2","type","strokeWidth","getStrokeProps","t","getTickDisplayStr","assemblyNames","join","VerticalAxis","vview","vtextRotation","vticks","vviewSnap","yoff","hblocks","vblocks","length","htop","displayedRegionsTotalPx","vtop","hbottom","vbottom","stroke","divider","rx","max","ry","min","h","hlines","vlines"],"ignoreList":[],"sourceRoot":""}