"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3199],{53199:(e,l,s)=>{s.r(l),s.d(l,{default:()=>M});var t=s(7552),a=s(23758),n=s(99546),o=s(74281),i=s(59985),r=s(41785),c=s(48747),d=s(2323),m=s(72851),b=s(45443),h=s(28194),u=s(68446),f=s(75785),k=s(91818),w=s(52348),x=s(21049),g=s(97605),p=s(10240),y=s(22762),A=s(95408),v=s(69500);const j=(0,u.observer)(function({model:e}){const{validAssemblies:l,selectedAssemblies:s}=e,t=0===l.size,a="Select assemblies",n="select-assemblies-label",o=new Set(s),i=[...l].every(e=>o.has(e));return(0,v.jsxs)(k.A,{disabled:t,fullWidth:!0,children:[(0,v.jsx)(w.A,{id:n,children:a}),(0,v.jsxs)(x.A,{labelId:n,multiple:!0,value:s,onChange:l=>{e.setSelectedAssemblies("string"==typeof l.target.value?[l.target.value]:l.target.value)},input:(0,v.jsx)(g.A,{label:a}),renderValue:e=>e.join(", "),children:[(0,v.jsxs)(p.A,{onClickCapture:l=>{e.setSelectedAssemblies(i?[]:void 0),l.preventDefault()},children:[(0,v.jsx)(y.A,{checked:i,indeterminate:!i&&s.length>0}),(0,v.jsx)(A.A,{primary:"Select all"})]}),[...l].map(e=>(0,v.jsxs)(p.A,{value:e,children:[(0,v.jsx)(y.A,{checked:s.includes(e)}),(0,v.jsx)(A.A,{primary:e})]},e))]})]})});var S=s(66395),C=s(62162),N=s(65895),$=s(84132),_=s(38902),D=s(84495);const B=(0,f.n9)()(()=>({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),L=(0,u.observer)(function({model:e}){const{classes:l}=B(),{bookmarks:s,bookmarksWithValidAssemblies:t,selectedAssemblies:a,selectedBookmarks:o}=e,i=(0,n.getSession)(e),r=new Set(a),c=s.filter(e=>r.has(e.assemblyName)).map((e,l)=>{const{assemblyName:s,...t}=e;return{...e,id:l,assemblyName:s,locString:(0,n.assembleLocString)(t),correspondingObj:e}}),d=[50,Math.max((0,n.measureText)("Bookmark link",12)+30,(0,n.measureGridWidth)(c.map(e=>e.locString))),Math.max((0,n.measureText)("Label",12)+30,(0,n.measureGridWidth)(c.map(e=>e.label))),Math.max((0,n.measureText)("Assembly",12)+30,(0,n.measureGridWidth)(c.map(e=>e.assemblyName))),100];return(0,v.jsx)(C.A,{children:(0,v.jsx)($.z,{density:"compact",disableRowSelectionOnClick:!0,rows:c,columns:[{..._.f,width:d[0]},{field:"locString",headerName:"Bookmark link",width:d[1],renderCell:({value:s,row:t})=>(0,v.jsx)(N.A,{className:l.cell,href:"#",onClick:async l=>{l.preventDefault();const{views:a}=i;await(0,D.Jn)(s,t.assemblyName,a,e)},children:s})},{field:"label",headerName:"Label",width:d[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:d[3]},{field:"highlight",headerName:"Highlight",width:d[4],renderCell:({value:l,row:s})=>(0,v.jsx)(S.Ay,{color:l||"black",onChange:l=>{e.updateBookmarkHighlight(s,l)}})}],processRowUpdate:l=>{const s=c[l.id];return e.updateBookmarkLabel(s,l.label),l},onProcessRowUpdateError:e=>{i.notifyError(`${e}`,e)},checkboxSelection:!0,onRowSelectionModelChange:l=>{t.length>0&&e.setSelectedBookmarks([...l.ids].map(e=>({...c[e]})))},rowSelectionModel:{type:"include",ids:new Set(o.map(e=>e.id))}})})}),z=(0,t.lazy)(()=>s.e(5746).then(s.bind(s,5746))),E=(0,t.lazy)(()=>Promise.all([s.e(6386),s.e(3425)]).then(s.bind(s,23425))),T=(0,t.lazy)(()=>s.e(419).then(s.bind(s,20419))),V=(0,t.lazy)(()=>s.e(772).then(s.bind(s,70772))),W=(0,t.lazy)(()=>s.e(1326).then(s.bind(s,11326))),q=(0,t.lazy)(()=>s.e(1811).then(s.bind(s,71811))),G=(0,f.n9)()({flex:{display:"flex"}}),M=(0,u.observer)(function({model:e}){const{classes:l}=G();return(0,v.jsxs)("div",{children:[(0,v.jsxs)(h.A,{severity:"info",children:["Click and type within the ",(0,v.jsx)("strong",{children:"label"})," field to annotate your bookmark. Double click the ",(0,v.jsx)("strong",{children:"label"})," field to do so within a dialog."]}),(0,v.jsxs)("div",{className:l.flex,children:[(0,v.jsx)(a.A,{"data-testid":"grid_bookmark_menu",menuItems:[{label:"Export",icon:i.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[z,{onClose:l,model:e}])}},{label:"Import",icon:d.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[E,{model:e,onClose:l}])}},{label:"Delete",icon:o.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[q,{model:e,onClose:l}])}},{label:"Share",icon:b.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[T,{model:e,onClose:l}])}},{label:"Edit colors",icon:c.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[W,{model:e,onClose:l}])}},{label:"Settings",icon:m.A,onClick:()=>{(0,n.getSession)(e).queueDialog(l=>[V,{model:e,onClose:l}])}}],children:(0,v.jsx)(r.A,{})}),(0,v.jsx)(j,{model:e})]}),(0,v.jsx)(L,{model:e})]})})},62162:(e,l,s)=>{s.d(l,{A:()=>i});var t=s(67758),a=s(75785),n=s(69500);const o=(0,a.n9)()({flexContainer:{display:"flex",flexDirection:"column"}});function i(e){const l=(0,t.c)(3),{children:s}=e,{classes:a}=o();let i;return l[0]!==s||l[1]!==a.flexContainer?(i=(0,n.jsx)("div",{className:a.flexContainer,children:s}),l[0]=s,l[1]=a.flexContainer,l[2]=i):i=l[2],i}},84495:(e,l,s)=>{s.d(l,{Jn:()=>n,LP:()=>i,eW:()=>r,fU:()=>o});var t=s(99546),a=s(45465);async function n(e,l,s,a){const n=(0,t.getSession)(a);try{let t=s.find(e=>e.id===n.focusedViewId);if(t?.assemblyNames[0]!==l&&(t=s.find(e=>"LinearGenomeView"===e.type&&e.assemblyNames[0]===l)),!t){const e=`${a.id}_${l}`;t=n.addView("LinearGenomeView",{id:e})}await t.navToLocString(e,l)}catch(e){console.error(e),n.notifyError(`${e}`,e)}}function o(e,l){const{selectedBookmarks:s,bookmarksWithValidAssemblies:n}=l,o=0===s.length?n:s;if("BED"===e){const e="",l={};for(const e of o){const{label:s}=e,t=""===s?".":s,a=`${e.refName}\t${e.start}\t${e.end}\t${t}\n`;l[e.assemblyName]?l[e.assemblyName].push(a):l[e.assemblyName]=[a]}for(const s in l){const t=l[s].reduce((e,l)=>e+l,e),n=new Blob([t||""],{type:"text/x-bed;charset=utf-8"}),o=`jbrowse_bookmarks_${s}.bed`;(0,a.saveAs)(n,o)}}else{const e="chrom\tstart\tend\tlabel\tassembly_name\tcoord_range\n",l=o.map(e=>{const{label:l}=e,s=""===l?".":l,a=(0,t.assembleLocString)(e);return`${e.refName}\t${e.start+1}\t${e.end}\t${s}\t${e.assemblyName}\t${a}\n`}).reduce((e,l)=>e+l,e),s=new Blob([l||""],{type:"text/tab-separated-values;charset=utf-8"}),n="jbrowse_bookmarks.tsv";(0,a.saveAs)(s,n)}}async function i(e){const l=function(e){let l=0;switch(e.length%4){case 3:l=1;break;case 2:l=2;break;case 0:l=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(l)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:t}=await s.e(7130).then(s.t.bind(s,47130,19)),{inflate:a}=await Promise.resolve().then(s.t.bind(s,57864,23)),n=a(t(l));return(new TextDecoder).decode(n)}async function r(e){const l=(new TextEncoder).encode(e),{deflate:t}=await Promise.resolve().then(s.t.bind(s,57864,23)),{fromByteArray:a}=await s.e(7130).then(s.t.bind(s,47130,19)),n=a(t(l)),o=n.indexOf("=");return o>0?n.slice(0,o).replaceAll("+","-").replaceAll("/","_"):n.replaceAll("+","-").replaceAll("/","_")}}}]);
//# sourceMappingURL=3199.7a89840f.chunk.js.map