"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3199],{53199:(e,l,t)=>{t.r(l),t.d(l,{default:()=>j});var a=t(7552),s=t(23758),n=t(99546),o=t(25762),r=t(91194),i=t(922),c=t(53794),m=t(550),d=t(22168),b=t(37702),u=t(9937),h=t(68446),k=t(75785),f=t(48171),w=t(17125),y=t(98360),p=t(28172),g=t(29629),A=t(32808),v=t(81453);const E=(0,h.observer)((function({model:e}){const{validAssemblies:l,selectedAssemblies:t}=e,s=0===l.size,n="Select assemblies",o="select-assemblies-label",r=new Set(t),i=[...l].every((e=>r.has(e)));return a.createElement(f.A,{disabled:s,fullWidth:!0},a.createElement(w.A,{id:o},n),a.createElement(y.A,{labelId:o,multiple:!0,value:t,onChange:l=>{e.setSelectedAssemblies([...l.target.value])},input:a.createElement(p.A,{label:n}),renderValue:e=>e.join(", ")},a.createElement(g.A,{onClickCapture:l=>{i?e.setSelectedAssemblies([]):e.setSelectedAssemblies(void 0),l.preventDefault()}},a.createElement(A.A,{checked:i,indeterminate:!i&&t.length>0}),a.createElement(v.A,{primary:"Select all"})),[...l].map((e=>a.createElement(g.A,{key:e,value:e},a.createElement(A.A,{checked:t.includes(e)}),a.createElement(v.A,{primary:e}))))))}));var S=t(66395),C=t(87731),x=t(28237),N=t(92179),$=t(84495);const _=(0,k.n9)()((()=>({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}))),D=(0,h.observer)((function({model:e}){const{classes:l}=_(),{bookmarks:t,bookmarksWithValidAssemblies:s,selectedAssemblies:o,selectedBookmarks:r}=e,i=(0,n.getSession)(e),c=new Set(o),m=t.filter((e=>c.has(e.assemblyName))).map(((e,l)=>{const{assemblyName:t,...a}=e;return{...e,id:l,assemblyName:t,locString:(0,n.assembleLocString)(a),correspondingObj:e}})),d=[50,Math.max((0,n.measureText)("Bookmark link",12)+30,(0,n.measureGridWidth)(m.map((e=>e.locString)))),Math.max((0,n.measureText)("Label",12)+30,(0,n.measureGridWidth)(m.map((e=>e.label)))),Math.max((0,n.measureText)("Assembly",12)+30,(0,n.measureGridWidth)(m.map((e=>e.assemblyName)))),100];return a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.createElement(x.z,{density:"compact",rows:m,columns:[{...N.f,width:d[0]},{field:"locString",headerName:"Bookmark link",width:d[1],renderCell:({value:t,row:s})=>a.createElement(C.A,{className:l.cell,href:"#",onClick:async l=>{l.preventDefault();const{views:a}=i;await(0,$.Jn)(t,s.assemblyName,a,e)}},t)},{field:"label",headerName:"Label",width:d[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:d[3]},{field:"highlight",headerName:"Highlight",width:d[4],renderCell:({value:l,row:t})=>a.createElement(S.Ay,{color:l||"black",onChange:l=>{e.updateBookmarkHighlight(t,l)}})}],processRowUpdate:l=>{const t=m[l.id];return e.updateBookmarkLabel(t,l.label),l},onProcessRowUpdateError:e=>{i.notifyError(`${e}`,e)},checkboxSelection:!0,onRowSelectionModelChange:l=>{s.length>0&&e.setSelectedBookmarks(l.map((e=>({...m[e]}))))},rowSelectionModel:r.map((e=>e.id)),disableRowSelectionOnClick:!0}))})),B=(0,a.lazy)((()=>t.e(5746).then(t.bind(t,5746)))),L=(0,a.lazy)((()=>Promise.all([t.e(3011),t.e(3425)]).then(t.bind(t,23425)))),z=(0,a.lazy)((()=>t.e(419).then(t.bind(t,20419)))),T=(0,a.lazy)((()=>t.e(772).then(t.bind(t,70772)))),P=(0,a.lazy)((()=>t.e(1326).then(t.bind(t,11326)))),V=(0,a.lazy)((()=>t.e(1811).then(t.bind(t,71811)))),W=(0,k.n9)()({flex:{display:"flex"}}),j=(0,h.observer)((function({model:e}){const{classes:l}=W();return a.createElement("div",null,a.createElement(u.A,{severity:"info"},"Click and type within the ",a.createElement("strong",null,"label")," field to annotate your bookmark. Double click the ",a.createElement("strong",null,"label")," field to do so within a dialog."),a.createElement("div",{className:l.flex},a.createElement(s.A,{"data-testid":"grid_bookmark_menu",menuItems:[{label:"Export",icon:r.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[B,{onClose:l,model:e}]))}},{label:"Import",icon:m.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[L,{model:e,onClose:l}]))}},{label:"Delete",icon:o.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[V,{model:e,onClose:l}]))}},{label:"Share",icon:b.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[z,{model:e,onClose:l}]))}},{label:"Edit colors",icon:c.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[P,{model:e,onClose:l}]))}},{label:"Settings",icon:d.A,onClick:()=>{(0,n.getSession)(e).queueDialog((l=>[T,{model:e,onClose:l}]))}}]},a.createElement(i.A,null)),a.createElement(E,{model:e})),a.createElement(D,{model:e}))}))},84495:(e,l,t)=>{t.d(l,{Jn:()=>n,LP:()=>r,eW:()=>i,fU:()=>o});var a=t(99546),s=t(45465);async function n(e,l,t,s){const n=(0,a.getSession)(s);try{let a=t.find((e=>e.id===n.focusedViewId));if(a?.assemblyNames[0]!==l&&(a=t.find((e=>"LinearGenomeView"===e.type&&e.assemblyNames[0]===l))),!a){const e=`${s.id}_${l}`;a=n.addView("LinearGenomeView",{id:e})}await a.navToLocString(e,l)}catch(e){console.error(e),n.notifyError(`${e}`,e)}}function o(e,l){const{selectedBookmarks:t,bookmarksWithValidAssemblies:n}=l,o=0===t.length?n:t;if("BED"===e){const e="",l={};o.forEach((e=>{const{label:t}=e,a=""===t?".":t,s=`${e.refName}\t${e.start}\t${e.end}\t${a}\n`;l[e.assemblyName]?l[e.assemblyName].push(s):l[e.assemblyName]=[s]}));for(const t in l){const a=l[t].reduce(((e,l)=>e+l),e),n=new Blob([a||""],{type:"text/x-bed;charset=utf-8"}),o=`jbrowse_bookmarks_${t}.bed`;(0,s.saveAs)(n,o)}}else{const e="chrom\tstart\tend\tlabel\tassembly_name\tcoord_range\n",l=o.map((e=>{const{label:l}=e,t=""===l?".":l,s=(0,a.assembleLocString)(e);return`${e.refName}\t${e.start+1}\t${e.end}\t${t}\t${e.assemblyName}\t${s}\n`})).reduce(((e,l)=>e+l),e),t=new Blob([l||""],{type:"text/tab-separated-values;charset=utf-8"}),n="jbrowse_bookmarks.tsv";(0,s.saveAs)(t,n)}}async function r(e){const l=function(e){let l=0;switch(e.length%4){case 3:l=1;break;case 2:l=2;break;case 0:l=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(l)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:a}=await Promise.resolve().then(t.t.bind(t,47130,19)),{inflate:s}=await Promise.resolve().then(t.t.bind(t,57864,23)),n=s(a(l));return(new TextDecoder).decode(n)}async function i(e){const l=(new TextEncoder).encode(e),{deflate:a}=await Promise.resolve().then(t.t.bind(t,57864,23)),{fromByteArray:s}=await Promise.resolve().then(t.t.bind(t,47130,19)),n=s(a(l)),o=n.indexOf("=");return o>0?n.slice(0,o).replaceAll("+","-").replaceAll("/","_"):n.replaceAll("+","-").replaceAll("/","_")}}}]);
//# sourceMappingURL=3199.59191e75.chunk.js.map