"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2361],{52361(e,t,o){o.d(t,{renderMultiDensity:()=>u});var r=o(77251),s=o(83640),l=o(16876),a=o(26931),c=o(52901),n=o(93925),i=o(27535);async function u(e,t){const{sources:o,height:u,regions:g,bpPerPx:f,stopToken:d,statusCallback:h=()=>{}}=e,p=g[0],b=(p.end-p.start)/f,v=u/o.length,k=(0,c.jL)(d),{reducedFeatures:C,...w}=await(0,r.updateStatus)("Rendering plot",h,()=>(0,s.u)(b,u,e,s=>{const l=(0,r.groupBy)(t,e=>e.get("source"));let a=[];s.save();for(const t of o){const{reducedFeatures:o}=(0,n.t)(s,{...e,features:l[t.name]||[],height:v,lastCheck:k});s.translate(0,v),a=a.concat(o)}return s.restore(),{reducedFeatures:a}})),y={...w,features:C.map(i.serializeWiggleFeature),height:u,width:b};return(0,l.lk)(y,(0,a.X)(w))}},93925(e,t,o){o.d(t,{t:()=>a});var r=o(11259),s=o(52901),l=o(27535);function a(e,t){const{features:o,regions:a,bpPerPx:c,scaleOpts:n,height:i,config:u,stopToken:g,lastCheck:f=(0,s.jL)(g)}=t,d=a[0],h=d.start,p=d.end,b=d.reversed,v=1/c,k=(0,r.QZ)(u,"bicolorPivot"),C=(0,r.QZ)(u,"bicolorPivotValue"),w=(0,r.QZ)(u,"negColor"),y=(0,r.QZ)(u,"posColor"),T=(0,r.QZ)(u,"color"),Q=(0,r.QZ)(u,"clipColor"),Z="none"!==k&&"log"!==n.scaleType,F=(0,l.getScale)({...n,pivotValue:Z?C:void 0,range:Z?[w,"#eee",y]:["#eee",y]}),P="#f0f"===T?(e,t)=>F(t):(e,t)=>(0,r.QZ)(u,"color",{feature:e,score:t}),S=(0,l.getScale)({...n,range:[0,i]}).domain(),m=S[0],_=S[1];let j=Number.NEGATIVE_INFINITY,I=!1;const N=[];for(const t of o.values()){(0,s.As)(f);const o=t.get("start"),r=t.get("end"),l=b?(p-r)*v:(o-h)*v,a=b?(p-o)*v:(r-h)*v;(Math.floor(l)!==Math.floor(j)||a-l>1)&&(N.push(t),j=l);const c=t.get("score");I=I||c>_||c<m;const u=a-l+.3;c>=n.domain[0]?(e.fillStyle=P(t,c),e.fillRect(l,0,u,i)):(e.fillStyle="#eee",e.fillRect(l,0,u,i))}if(e.save(),I){e.fillStyle=Q;for(const t of o.values()){(0,s.As)(f);const o=t.get("start"),r=t.get("end"),a=b?(p-r)*v:(o-h)*v,c=(b?(p-o)*v:(r-h)*v)-a+.3,i=t.get("score");(i>_||i<m&&"log"!==n.scaleType)&&(0,l.fillRectCtx)(a,0,c,2,e)}}return e.restore(),{reducedFeatures:N}}}}]);
//# sourceMappingURL=2361.6a9db473.chunk.js.map