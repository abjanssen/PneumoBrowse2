"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8751],{36157:(e,n,t)=>{t.d(n,{A:()=>g});var s=t(7552),o=t(84340),l=t(95054),r=t(48768),i=t(87626),c=t(59130),a=t(89870),d=t(41450),h=t(68446),u=t(21254),m=t.n(u),x=t(75785),p=t(69500);const j=(0,x.n9)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function f(e){const n=(0,s.useRef)(null);return(0,p.jsx)(m(),{nodeRef:n,cancel:'[class*="MuiDialogContent-root"]',onStart:e=>`${e.target?.className}`.includes("MuiDialogTitle"),children:(0,p.jsx)(l.A,{ref:n,...e})})}const g=(0,h.observer)((function(e){const{classes:n}=j(),{title:t,children:s,onClose:l}=e;return(0,p.jsx)(r.A,{...e,PaperComponent:f,children:(0,p.jsxs)(i.A,{children:[(0,p.jsxs)(c.A,{style:{cursor:"move"},children:[t,l?(0,p.jsx)(a.A,{className:n.closeButton,onClick:()=>{l()},children:(0,p.jsx)(o.A,{})}):null]}),(0,p.jsx)(d.A,{}),s]})})}))},38751:(e,n,t)=>{t.r(n),t.d(n,{default:()=>F});var s=t(7552),o=t(36157),l=t(99546),r=t(76218),i=t(69092),c=t(30698),a=t(75785),d=t(67112),h=t(61282),u=t(93062),m=t(69500);const x=(0,a.n9)()({textAreaFont:{fontFamily:"Courier New"}});function p({onClose:e,currLayout:n}){const{classes:t}=x(),[o,l]=(0,s.useState)(""),[a,p]=(0,s.useState)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.A,{children:[(0,m.jsx)(h.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),a?(0,m.jsx)(d.ErrorMessage,{error:a}):null,(0,m.jsx)(u.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:o,onChange:e=>{l(e.target.value)},slotProps:{input:{classes:{input:t.textAreaFont}}}})]}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(i.A,{variant:"contained",color:"secondary",onClick:()=>{const t=o.split("\n").map((e=>e.trim())).filter((e=>!!e)),s=t[0].split(/[,\t]/gm);if(s.includes("name")){p("");const o=Object.fromEntries(n.map((e=>[e.name,e]))),l=Object.fromEntries(t.slice(1).map((e=>{const n=e.split(/[,\t]/gm),t=Object.fromEntries(n.map(((e,n)=>[s[n],e])));return[t.name,{...t,...o[t.name]}]})));e(n.map((e=>({...e,...l[e.name]}))))}else p(new Error('No "name" column found on line 1'))},children:"Update rows"}),(0,m.jsx)(i.A,{variant:"contained",color:"primary",onClick:()=>{const t=o.split("\n").map((e=>e.trim())).filter((e=>!!e)),s=t[0].split(/[,\t]/gm);if(s.includes("name")){p("");const o=Object.fromEntries(n.map((e=>[e.name,e]))),l=Object.fromEntries(t.slice(1).map((e=>{const n=e.split(/[,\t]/gm),t=Object.fromEntries(n.map(((e,n)=>[s[n],e])));return[t.name,{...t,...o[t.name]}]})));e(n.map((e=>({...l[e.name]}))))}else p(new Error('No "name" column found on line 1'))},children:"Replace rows"}),(0,m.jsx)(i.A,{variant:"contained",color:"inherit",onClick:()=>{e()},children:"Cancel"})]})]})}function j(){return(0,m.jsxs)(m.Fragment,{children:["Helpful tips",(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,m.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,m.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,m.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,m.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,m.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,m.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}var f=t(40898),g=t(42268);function C({setCurrLayout:e,currLayout:n}){return(0,m.jsxs)("div",{children:["Create color palette based on...",Object.keys(n[0]??[]).filter((e=>"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e)).map((t=>(0,m.jsx)(i.A,{variant:"contained",color:"inherit",onClick:()=>{const s=new Map;for(const e of n){const n=s.get(e[t]);n?s.set(e[t],n+1):s.set(e[t],1)}const o=Object.fromEntries([...s.entries()].sort(((e,n)=>e[1]-n[1])).map(((e,n)=>[e[0],f.set1[n]||(0,g.XL)(e[0])])));e(n.map((e=>({...e,color:o[e[t]]}))))},children:t},t))),(0,m.jsx)(i.A,{onClick:()=>{e(n.map((e=>({...e,color:void 0}))))},children:"Clear colors"})]})}var b=t(66395),w=t(46275);const v=(0,a.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function A({rows:e,onChange:n,setSelected:t}){const{classes:o}=v(),{id:r,name:i,label:c,color:a,baseUri:h,HP:u,...x}=e[0],[p,j]=(0,s.useState)({idx:0,field:null});return(0,m.jsx)("div",{style:{height:400,width:"100%"},children:(0,m.jsx)(w.z,{checkboxSelection:!0,onRowSelectionModelChange:e=>{t([...e.ids])},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:t=>{const{value:s,id:o}=t;return(0,m.jsx)(b.Ay,{color:s||"blue",onChange:t=>{const s=e.find((e=>e.name===o));s&&(s.color=t),n([...e])}})}},{field:"label",headerName:"Name",width:(0,l.measureGridWidth)(e.map((e=>e.label)))},...Object.keys(x).map((n=>({field:n,renderCell:({value:e})=>(0,m.jsx)("div",{className:o.cell,children:(0,m.jsx)(d.SanitizedHTML,{html:(0,l.getStr)(e)})}),width:(0,l.measureGridWidth)(e.map((e=>`${e[n]}`)))})))],sortModel:[],onSortModelChange:t=>{const s=t[0],o=(p.idx+1)%2,r=s.field||p.field;j({idx:o,field:r}),n(r?[...e].sort(((e,n)=>{const t=(0,l.getStr)(e[r]),s=(0,l.getStr)(n[r]);return 1===o?t.localeCompare(s):s.localeCompare(t)})):e)}})})}var k=t(5986),S=t(85179),y=t(85161),M=t(11496);function H(e,n,t=1){const s=n.map((n=>e.findIndex((e=>e.name===n)))).sort(((e,n)=>e-n));let o=0;for(const n of s){const s=Math.max(o,n-t);s>=o&&e.splice(s,0,e.splice(n,1)[0]),o+=1}return e}function N(e,n,t=1){const s=n.map((n=>e.findIndex((e=>e.name===n)))).sort(((e,n)=>n-e));let o=e.length-1;for(const n of s){const s=Math.min(o,n+t);s<=o&&e.splice(s,0,e.splice(n,1)[0]),o-=1}return e}function L({selected:e,onChange:n,rows:t,showTips:o}){const[l,r]=(0,s.useState)(null),[c,a]=(0,s.useState)("blue");return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i.A,{disabled:!e.length,onClick:e=>{r(e.currentTarget)},children:"Change color of selected items"}),(0,m.jsxs)(i.A,{onClick:()=>{n(H([...t],e))},disabled:!e.length,children:[(0,m.jsx)(S.A,{}),o?"Move selected items up":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(N([...t],e))},disabled:!e.length,children:[(0,m.jsx)(k.A,{}),o?"Move selected items down":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(H([...t],e,t.length))},disabled:!e.length,children:[(0,m.jsx)(M.A,{}),o?"Move selected items to top":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(N([...t],e,t.length))},disabled:!e.length,children:[(0,m.jsx)(y.A,{}),o?"Move selected items to bottom":null]}),(0,m.jsx)(b.FO,{anchorEl:l,color:c,onChange:s=>{a(s);for(const n of e){const e=t.find((e=>e.name===n));e&&(e.color=s)}n([...t])},onClose:()=>{r(null)}})]})}const T=function({rows:e,onChange:n,showTips:t}){const[o,l]=(0,s.useState)([]);return(0,m.jsxs)("div",{children:[(0,m.jsx)(L,{selected:o,rows:e,showTips:t,onChange:n}),e.length?(0,m.jsx)(A,{rows:e,onChange:n,setSelected:l}):(0,m.jsx)("div",{children:"No rows"})]})},E=(0,a.n9)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8},textAreaFont:{fontFamily:"Courier New"}});function F({model:e,handleClose:n}){const{classes:t}=E(),{sources:a}=e,[d,h]=(0,s.useState)(!1),[u,x]=(0,s.useState)(a||[]),[f,g]=(0,l.useLocalStorage)("multivariant-showTips",!1);return(0,m.jsx)(o.A,{open:!0,onClose:n,maxWidth:"xl",title:"Multi-sample variant display - Color/arrangement editor",children:d?(0,m.jsx)(p,{currLayout:u,onClose:e=>{e&&x(e),h(!1)}}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.A,{className:t.content,children:[(0,m.jsxs)("div",{className:t.fr,children:[(0,m.jsx)(i.A,{variant:"contained",onClick:()=>{g(!f)},children:f?"Hide tips":"Show tips"}),(0,m.jsx)(i.A,{color:"secondary",variant:"contained",onClick:()=>{h(!d)},children:"Show Bulk row editor"})]}),f?(0,m.jsx)(j,{}):null,(0,m.jsx)("br",{}),(0,m.jsx)(C,{currLayout:u,setCurrLayout:x}),(0,m.jsx)(T,{rows:u,onChange:x,showTips:f})]}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(i.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),x(e.sources||[])},children:"Clear custom settings"}),(0,m.jsx)(i.A,{variant:"contained",color:"secondary",onClick:()=>{n(),x([...e.sources||[]])},children:"Cancel"}),(0,m.jsx)(i.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(u),n()},children:"Submit"})]})]})})}},42268:(e,n,t)=>{function s(e){let n=0;for(let t=0;t<e.length;t++)n+=e.charCodeAt(t);return o(10*n)}function o(e){return`hsl(${e%255}, 50%, 50%)`}t.d(n,{XL:()=>s,qH:()=>o})}}]);
//# sourceMappingURL=8751.1ec8e131.chunk.js.map