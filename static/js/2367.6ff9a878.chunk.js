"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2367],{21016:(t,e,l)=>{l.d(e,{K:()=>i,W:()=>o});var n=l(87485),s=l(46879);function o(t,e,l,s,o,i=!0){if(t===o)return i?"#ccc":"";{let t;if(e&&(t=(0,n.M)(`hsl(200,50%,${80-e/o*50}%)`)),l){const e=`hsla(0,100%,20%,${l/o})`;t=t?t.mix(e):(0,n.M)(e)}if(s){const e=`hsl(50,50%,50%,${s/o})`;t=t?t.mix(e):(0,n.M)(e)}return t?.toHex()||"black"}}function i(t,e,l,o,i,f,c="",a,r=1){e.fillStyle=1!==r?(0,n.M)(t).alpha(r).toHex():t,"inversion"===c?1===a?(e.beginPath(),e.moveTo(l-s.f2,o-s.f2),e.lineTo(l-s.f2,o+f+s.f2),e.lineTo(l+i+s.f2,o+f/2),e.closePath(),e.fill()):(e.beginPath(),e.moveTo(l+i+s.f2,o-s.f2),e.lineTo(l+i+s.f2,o+f+s.f2),e.lineTo(l-s.f2,o+f/2),e.closePath(),e.fill()):e.fillRect(l-s.f2,o-s.f2,i+s.f2,f+s.f2)}},22367:(t,e,l)=>{l.d(e,{makeImageData:()=>a});var n=l(99546),s=l(37347),o=l(46879),i=l(21016),f=l(66540),c=l(85497);async function a({ctx:t,canvasWidth:e,canvasHeight:l,renderArgs:a}){const{renderingMode:r,minorAlleleFrequencyFilter:u,sources:h,features:g,stopToken:p,lengthCutoffFilter:d}=a,{statusCallback:b=()=>{}}=a,k=l/h.length;(0,s.SW)(p);const v=await(0,n.updateStatus)("Calculating stats",b,()=>(0,c.Cg)({stopToken:p,features:g.values(),minorAlleleFrequencyFilter:u,lengthCutoffFilter:d}));(0,s.SW)(p);const m=[],T=v.length,S=e/T;return await(0,n.updateStatus)("Drawing variant matrix",b,()=>{const s={};(0,n.forEachWithStopTokenCheck)(v,p,({feature:n,mostFrequentAlt:c},a)=>{const u=[],g=n.get("FORMAT")?.includes("PS");if(g){const g=n.get("samples"),p=a/v.length*e,d=h.length;for(let e=0;e<d;e++){const n=e/d*l,{name:a,HP:b}=h[e],v=g[a];if(v){const e=v.GT?.[0];if(e){u.push(e);const l=e.includes("|");if("phased"===r)if(l){const l=v.PS?.[0],s=e.split("|");(0,f.E)(s,t,p,n,S,k,b,l)}else t.fillStyle="black",t.fillRect(p-o.f2,n-o.f2,S+o.f2,k+o.f2);else{const l=`${e}:${c}`;let o=s[l];if(void 0===o){let t=0,n=0,f=0,a=0;const r=e.split(/[/|]/),u=r.length;for(let e=0;e<u;e++){const l=r[e];l===c?t++:"0"===l?a++:"."===l?n++:f++}o=(0,i.W)(a,t,f,n,u,!0),s[l]=o}o&&(0,i.K)(o,t,p,n,S,k)}}}}}else{const g=n.get("genotypes"),p=a/v.length*e,d=h.length;for(let e=0;e<d;e++){const n=e/d*l,{name:a,HP:b}=h[e],v=g[a];if(v){u.push(v);const e=v.includes("|");if("phased"===r)if(e){const e=v.split("|");(0,f.E)(e,t,p,n,S,k,b)}else t.fillStyle="black",t.fillRect(p-o.f2,n-o.f2,S+o.f2,k+o.f2);else{const e=`${v}:${c}`;let l=s[e];if(void 0===l){let t=0,n=0,o=0,f=0;const a=v.split(/[/|]/),r=a.length;for(let e=0;e<r;e++){const l=a[e];l===c?t++:"0"===l?f++:"."===l?n++:o++}l=(0,i.W)(f,t,o,n,r,!0),s[e]=l}l&&(0,i.K)(l,t,p,n,S,k)}}}}m.push(u)})}),{mafs:v,arr:m}}},46879:(t,e,l)=>{l.d(e,{f2:()=>n});const n=.3},66540:(t,e,l)=>{l.d(e,{E:()=>i});var n=l(40898),s=l(87485),o=l(46879);function i(t,e,l,i,f,c,a,r,u=!0,h=1){const g=void 0!==r?function(t,e,l,n=!0){return+t[e]?`hsl(${+l%255}, 50%, 50%)`||"black":n?"#ccc":void 0}(t,a,r,u):function(t,e,l=!0){const s=+t[e];return s?n.set1[s-1]||"black":l?"#ccc":void 0}(t,a,u);return g&&(e.fillStyle=1!==h?(0,s.M)(g).alpha(h).toHex():g,e.fillRect(l-o.f2,i-o.f2,f+o.f2,c+o.f2)),g}}}]);
//# sourceMappingURL=2367.6ff9a878.chunk.js.map