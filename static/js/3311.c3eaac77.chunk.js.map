{"version":3,"file":"static/js/3311.c3eaac77.chunk.js","mappings":"6NAgBOA,eAAeC,EACpBC,EACAC,GAKA,MAAM,OAAEC,EAAM,GAAEC,GAAOH,GACjB,eAAEI,GAAmBH,EACrBI,GAAOC,EAAAA,EAAAA,mBAAkBN,IACvBO,SAAUC,EAAY,qBAAEC,EAAoB,MAAEC,GAAUL,EAC1DM,QAAmBC,QAAQC,IAC/BJ,EAAqBK,IAAIhB,UACvB,MAAMiB,EAAaC,EAAAA,EAAWC,OAAO,CACnCC,IAAKC,EAAMD,IACXE,OAAQD,IAKJE,EACJrB,EAAKsB,2BAA2BH,IAChCnB,EAAKuB,uBAAuBJ,GAE9B,GAAIE,EACF,MAAO,CACLF,EACA,CACEK,cACEC,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAC,SAAA,EACEC,EAAAA,EAAAA,KAAA,QAAMC,EAAG,EAAGC,EAAG,EAAGpB,MAAOA,EAAOR,OAAQ,GAAI6B,KAAK,UACjDH,EAAAA,EAAAA,KAAA,QAAMC,EAAG,EAAGC,EAAG,GAAGH,SACfN,SAQb,MAAM,WAAEW,EAAU,WAAEC,EAAU,YAAEC,EAAW,aAAEC,IAC3CC,EAAAA,EAAAA,GAAgBrB,EAAYf,GAE9B,MAAO,CACLmB,QACMgB,EAAaE,eAAeL,EAAY,IACzCC,KACAC,EACHI,YAAYC,EAAAA,EAAAA,eAAcvC,GAAM,GAChCwC,UAAWvC,EACXwC,MAAOxC,EAAKwC,OAASP,EAAYO,YAMzC,OACEb,EAAAA,EAAAA,KAAAF,EAAAA,SAAA,CAAAC,SACGhB,EAAWG,IAAI,EAAEK,EAAOuB,GAAYC,KACnC,MAAM,SAAEpC,EAAQ,QAAEqC,GAAYzB,EACxB0B,EAAStC,EAAWC,EACpBsC,GAASC,EAAAA,EAAAA,IAAM5C,EAAIwC,GAEzB,OAEElB,EAAAA,EAAAA,MAACuB,EAAAA,SAAQ,CAAArB,SAAA,EACPC,EAAAA,EAAAA,KAAA,QAAAD,UACEC,EAAAA,EAAAA,KAAA,YAAUzB,GAAI2C,EAAOnB,UACnBC,EAAAA,EAAAA,KAAA,QACEC,EAAG,EACHC,EAAG,EACHpB,MAAOkC,EACP1C,OAAQE,GAAkBF,SAIhC0B,EAAAA,EAAAA,KAAA,KAAGqB,UAAW,aAAaJ,OAAYlB,UACrCC,EAAAA,EAAAA,KAAA,KAAGsB,SAAU,QAAQJ,KAAUnB,UAC7BC,EAAAA,EAAAA,KAACuB,EAAAA,eAAc,CAACT,UAAWA,UAblB,QAAQC,QAqBjC,C","sources":["../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/renderSvg.tsx"],"sourcesContent":["import { Fragment } from 'react'\n\nimport {\n  ReactRendering,\n  getContainingView,\n  getViewParams,\n} from '@jbrowse/core/util'\n\nimport BlockState, { renderBlockData } from './serverSideRenderedBlock'\nimport { getId } from './util'\n\nimport type { BaseLinearDisplayModel } from './BaseLinearDisplayModel'\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView'\nimport type { ExportSvgOptions } from '../../LinearGenomeView/types'\nimport type { ThemeOptions } from '@mui/material'\n\nexport async function renderBaseLinearDisplaySvg(\n  self: BaseLinearDisplayModel,\n  opts: ExportSvgOptions & {\n    overrideHeight: number\n    theme?: ThemeOptions\n  },\n) {\n  const { height, id } = self\n  const { overrideHeight } = opts\n  const view = getContainingView(self) as LinearGenomeViewModel\n  const { offsetPx: viewOffsetPx, roundedDynamicBlocks, width } = view\n  const renderings = await Promise.all(\n    roundedDynamicBlocks.map(async block => {\n      const blockState = BlockState.create({\n        key: block.key,\n        region: block,\n      })\n\n      // regionCannotBeRendered can return jsx so look for plaintext\n      // version, or just get the default if none available\n      const cannotBeRenderedReason =\n        self.regionCannotBeRenderedText(block) ||\n        self.regionCannotBeRendered(block)\n\n      if (cannotBeRenderedReason) {\n        return [\n          block,\n          {\n            reactElement: (\n              <>\n                <rect x={0} y={0} width={width} height={20} fill=\"#aaa\" />\n                <text x={0} y={15}>\n                  {cannotBeRenderedReason}\n                </text>\n              </>\n            ),\n          },\n        ] as const\n      }\n\n      const { rpcManager, renderArgs, renderProps, rendererType } =\n        renderBlockData(blockState, self)\n\n      return [\n        block,\n        await rendererType.renderInClient(rpcManager, {\n          ...renderArgs,\n          ...renderProps,\n          viewParams: getViewParams(self, true),\n          exportSVG: opts,\n          theme: opts.theme || renderProps.theme,\n        }),\n      ] as const\n    }),\n  )\n\n  return (\n    <>\n      {renderings.map(([block, rendering], index) => {\n        const { offsetPx, widthPx } = block\n        const offset = offsetPx - viewOffsetPx\n        const clipid = getId(id, index)\n\n        return (\n          /* biome-ignore lint/suspicious/noArrayIndexKey: */\n          <Fragment key={`frag-${index}`}>\n            <defs>\n              <clipPath id={clipid}>\n                <rect\n                  x={0}\n                  y={0}\n                  width={widthPx}\n                  height={overrideHeight || height}\n                />\n              </clipPath>\n            </defs>\n            <g transform={`translate(${offset} 0)`}>\n              <g clipPath={`url(#${clipid})`}>\n                <ReactRendering rendering={rendering} />\n              </g>\n            </g>\n          </Fragment>\n        )\n      })}\n    </>\n  )\n}\n"],"names":["async","renderBaseLinearDisplaySvg","self","opts","height","id","overrideHeight","view","getContainingView","offsetPx","viewOffsetPx","roundedDynamicBlocks","width","renderings","Promise","all","map","blockState","BlockState","create","key","block","region","cannotBeRenderedReason","regionCannotBeRenderedText","regionCannotBeRendered","reactElement","_jsxs","_Fragment","children","_jsx","x","y","fill","rpcManager","renderArgs","renderProps","rendererType","renderBlockData","renderInClient","viewParams","getViewParams","exportSVG","theme","rendering","index","widthPx","offset","clipid","getId","Fragment","transform","clipPath","ReactRendering"],"sourceRoot":""}