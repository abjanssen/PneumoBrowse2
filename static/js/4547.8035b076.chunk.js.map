{"version":3,"file":"static/js/4547.8035b076.chunk.js","mappings":"mQAgBA,MAAMA,GAAYC,EAAAA,EAAAA,IAAAA,CAAaC,IAAS,CACtCC,aAAc,CACZC,OAAQ,EACRC,UAAW,aACXC,WAAY,cACZ,UAAW,CACTA,WAAYJ,EAAMK,QAAQC,aAY1BC,GAAUC,EAAAA,EAAAA,UAAS,UAAiB,SACxCC,EAAQ,MACRC,EAAK,UACLC,IAMA,MAAM,OAAET,GAAWQ,GACb,MAAEE,EAAK,SAAEC,IAAaC,EAAAA,EAAAA,mBAAkBJ,GACxCK,EAAOC,KAAKC,IAAI,GAAIJ,GAC1B,OAAOF,GACLO,EAAAA,EAAAA,KAAA,KAAGC,UAAW,aAAaJ,KAAQN,SAAEA,KAErCS,EAAAA,EAAAA,KAAA,OACEE,MAAO,CACLC,SAAU,WACVC,IAAK,EACLP,OACAb,SACAU,SACAH,SAEDA,GAGP,GAQMc,GAAyCf,EAAAA,EAAAA,UAC7C,UAAgD,MAC9CE,EAAK,UACLC,IAKA,MAAM,QAAEa,GAAY1B,KACd,gBAAE2B,IAAoBC,EAAAA,EAAAA,YAAWhB,GACjCiB,GAAOb,EAAAA,EAAAA,mBAAkBJ,IACxBkB,EAAeC,IAAoBC,EAAAA,EAAAA,aACpC,eAAEC,EAAc,iBAAEC,GAAqBtB,GACvC,cAAEuB,EAAa,cAAEC,GAAkBP,EACnCQ,EAAWV,EAAgBW,IAAIH,EAAc,IAE7CI,GADKH,EAAcI,cAAc,IAAIC,SAAW,IACtCP,GAAkBQ,QAAU,GAC5C,OAAOL,GAAYH,GACjBS,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAjC,SAAA,EACEgC,EAAAA,EAAAA,MAAClC,EAAO,CAACI,UAAWA,EAAWD,MAAOA,EAAMD,SAAA,EAC1CS,EAAAA,EAAAA,KAACyB,EAAQ,CAACjC,MAAOA,EAAOmB,iBAAkBA,IACzCD,GACCa,EAAAA,EAAAA,MAAAC,EAAAA,SAAA,CAAAjC,SAAA,EACES,EAAAA,EAAAA,KAAA,QACE0B,OAAO,QACPC,YAAa,EACbzB,MAAO,CACL0B,cAAe,QAEjBC,GAAInB,EAAcoB,IAAMX,EAAIA,EAAI,EAChCY,GAAIrB,EAAcsB,EAClBC,GAAIpB,EACJqB,GAAI,EACJC,aAAcA,KACZxB,OAAiByB,OAGrBpC,EAAAA,EAAAA,KAACqC,EAAW,CAACC,SAAU5B,EAAc6B,EAAErB,IAAI,aAE3C,QAEJzB,EASE,MARFO,EAAAA,EAAAA,KAACwC,EAAAA,EAAY,CACXtC,MAAO,CACLC,SAAU,WACVC,IAAKS,EAAiB,GAExB4B,OAAQC,GAAKlD,EAAMmD,kBAAkB9B,EAAiB6B,GACtDE,UAAWtC,EAAQvB,kBAIvB,IACN,GAKI8D,GAAkBC,EAAAA,EAAAA,YACtB,SAAAC,EAAAC,GAAA,MAAAC,GAAAC,EAAAA,EAAAA,GAAA,IAA0B,QAAAC,GAAAJ,EAAW,IAAAK,EAOvBC,EACJ,OAR2BJ,EAAA,KAAAE,GAG9BC,GAAAE,EAAAA,EAAAA,gBAAeH,GAAfA,EAEGA,GAAAnD,EAAAA,EAAAA,KACDuD,EAAAA,EAAa,CAAOC,KAAAC,OAAON,KAD1B,KAEIF,EAAA,GAAAE,EAAAF,EAAA,GAAAG,GAAAA,EAAAH,EAAA,GAAAA,EAAA,KAAAD,GAAAC,EAAA,KAAAG,GALVC,GAAArD,EAAAA,EAAAA,KAAA,OAAUgD,IAAAA,EAAGzD,SACV6D,IAKGH,EAAA,GAAAD,EAAAC,EAAA,GAAAG,EAAAH,EAAA,GAAAI,GAAAA,EAAAJ,EAAA,GANNI,CAMM,GAINhB,GAAc/C,EAAAA,EAAAA,UAAS,UAAqB,SAChDgD,IAIA,OAAOA,GACLtC,EAAAA,EAAAA,KAAC0D,EAAAA,EAAW,CAAAnE,UACVS,EAAAA,EAAAA,KAAC6C,EAAe,CAACM,QAASb,MAE1B,IACN,GAEMb,GAAWnC,EAAAA,EAAAA,UAAS,UAAkB,MAC1CE,EAAK,iBACLmB,IAKA,MAAM7B,GAAQ6E,EAAAA,EAAAA,MACR,gBAAEpD,IAAoBC,EAAAA,EAAAA,YAAWhB,GACjCiB,GAAOb,EAAAA,EAAAA,mBAAkBJ,IACzB,eAAEqB,EAAc,iBAAEC,GAAqBtB,GACvC,SAAEG,EAAQ,cAAEoB,EAAa,cAAEC,GAAkBP,EAC7CQ,EAAWV,EAAgBW,IAAIH,EAAc,IAE7CI,GADKH,EAAcI,cAAc,IAAIC,SAAW,IACtCP,GAAkBQ,QAAU,GACtCsC,EAAI9D,KAAKC,IAAIJ,EAAU,GACvBkE,GAAIC,EAAAA,EAAAA,iBAAeC,EAAAA,EAAAA,IAAMjF,EAAMK,QAAQ6E,KAAKC,QAAS,KAC3D,OAAOhD,GAAYH,GACjBd,EAAAA,EAAAA,KAAAwB,EAAAA,SAAA,CAAAjC,SACGuB,EAAiBoD,IAAI,CAAC3B,EAAG4B,KACxB,MAAMnB,EAAMT,EAAErB,IAAI,WACZc,GACHvB,EAAK2D,OAAO,CACXC,QAASpD,EAASqD,qBAAqBtB,GACvCuB,MAAOhC,EAAErB,IAAI,YACXvB,UAAY,GAAKiE,EACvB,OACEY,EAAAA,EAAAA,eAAA,WACMX,EACJlC,YAAa,EACb8C,IAAKlC,EAAEmC,KACP7C,GAAIsC,EAAIhD,EAAIA,EAAI,EAChBY,GAAIC,EACJC,GAAIpB,EACJqB,GAAI,EACJyC,aAAcA,KACZhE,EAAiB,CAAE4B,IAAGT,IAAKqC,EAAGnC,OAEhCG,aAAcA,KACZxB,OAAiByB,UAMzB,IACN,GAEA,G,8HC7LA,MAyCA,GAzCiD9C,EAAAA,EAAAA,UAC/C,SAAkDsF,GAGhD,MAAM,MAAEpF,GAAUoF,GACZ,eAAE/D,EAAc,OAAE7B,GAAWQ,EAC7BwD,GAAM6B,EAAAA,EAAAA,QAAuB,OAC7B,WAAEC,EAAU,gBAAEC,EAAe,iBAAEC,IACnCC,EAAAA,EAAAA,GAAiBjC,GAEnB,OACEzB,EAAAA,EAAAA,MAAA,OACEyB,IAAKA,EACL9C,MAAO,CAAEC,SAAU,WAAYnB,UAC/BkG,YAAaH,EACb5C,aAAc6C,EAAiBzF,SAAA,EAG/BS,EAAAA,EAAAA,KAAA,OAAK,cAAY,mBAAkBT,UACjCS,EAAAA,EAAAA,KAACK,EAAAA,EAAsC,CAACb,MAAOA,OAGjDQ,EAAAA,EAAAA,KAACmF,EAAAA,EAA0B,CACzB3F,MAAOA,EACP4F,UAAWvE,EACXwE,OAAO,mBAGRP,GAAcA,EAAWQ,EAAIzE,GAC5Bb,EAAAA,EAAAA,KAACuF,EAAAA,EAAS,CACRC,OAAQV,EAAWW,EACnBC,OAAQZ,EAAWQ,EACnBK,QAASb,EAAWa,QACpBC,QAASd,EAAWc,QACpBpG,MAAOA,IAEP,OAGV,E","sources":["webpack://@jbrowse/web/../../plugins/variants/src/MultiLinearVariantMatrixDisplay/components/LinesConnectingMatrixToGenomicPosition.tsx","webpack://@jbrowse/web/../../plugins/variants/src/MultiLinearVariantMatrixDisplay/components/VariantDisplayComponent.tsx"],"sourcesContent":["import { forwardRef, isValidElement, useState } from 'react'\n\nimport { ResizeHandle, SanitizedHTML } from '@jbrowse/core/ui'\nimport BaseTooltip from '@jbrowse/core/ui/BaseTooltip'\nimport {\n  getContainingView,\n  getSession,\n  getStrokeProps,\n} from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { alpha, useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { Feature } from '@jbrowse/core/util'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nconst useStyles = makeStyles()(theme => ({\n  resizeHandle: {\n    height: 5,\n    boxSizing: 'border-box',\n    background: 'transparent',\n    '&:hover': {\n      background: theme.palette.divider,\n    },\n  },\n}))\n\ninterface MinimalModel {\n  setLineZoneHeight: (arg: number) => number\n  height: number\n  lineZoneHeight: number\n  featuresVolatile: Feature[] | undefined\n}\n\nconst Wrapper = observer(function Wrapper({\n  children,\n  model,\n  exportSVG,\n}: {\n  model: MinimalModel\n  children: React.ReactNode\n  exportSVG?: boolean\n}) {\n  const { height } = model\n  const { width, offsetPx } = getContainingView(model) as LinearGenomeViewModel\n  const left = Math.max(0, -offsetPx)\n  return exportSVG ? (\n    <g transform={`translate(${left})`}>{children}</g>\n  ) : (\n    <svg\n      style={{\n        position: 'absolute',\n        top: 0,\n        left,\n        height,\n        width,\n      }}\n    >\n      {children}\n    </svg>\n  )\n})\n\ninterface MouseOverLine {\n  f: Feature\n  idx: number\n  c: number\n}\n\nconst LinesConnectingMatrixToGenomicPosition = observer(\n  function LinesConnectingMatrixToGenomicPosition({\n    model,\n    exportSVG,\n  }: {\n    model: MinimalModel\n    exportSVG?: boolean\n  }) {\n    const { classes } = useStyles()\n    const { assemblyManager } = getSession(model)\n    const view = getContainingView(model) as LinearGenomeViewModel\n    const [mouseOverLine, setMouseOverLine] = useState<MouseOverLine>()\n    const { lineZoneHeight, featuresVolatile } = model\n    const { assemblyNames, dynamicBlocks } = view\n    const assembly = assemblyManager.get(assemblyNames[0]!)\n    const b0 = dynamicBlocks.contentBlocks[0]?.widthPx || 0\n    const w = b0 / (featuresVolatile?.length || 1)\n    return assembly && featuresVolatile ? (\n      <>\n        <Wrapper exportSVG={exportSVG} model={model}>\n          <AllLines model={model} setMouseOverLine={setMouseOverLine} />\n          {mouseOverLine ? (\n            <>\n              <line\n                stroke=\"#f00c\"\n                strokeWidth={2}\n                style={{\n                  pointerEvents: 'none',\n                }}\n                x1={mouseOverLine.idx * w + w / 2}\n                x2={mouseOverLine.c}\n                y1={lineZoneHeight}\n                y2={0}\n                onMouseLeave={() => {\n                  setMouseOverLine(undefined)\n                }}\n              />\n              <LineTooltip contents={mouseOverLine.f.get('name')} />\n            </>\n          ) : null}\n        </Wrapper>\n        {!exportSVG ? (\n          <ResizeHandle\n            style={{\n              position: 'absolute',\n              top: lineZoneHeight - 4,\n            }}\n            onDrag={n => model.setLineZoneHeight(lineZoneHeight + n)}\n            className={classes.resizeHandle}\n          />\n        ) : null}\n      </>\n    ) : null\n  },\n)\ninterface Props {\n  message: React.ReactNode | string\n}\nconst TooltipContents = forwardRef<HTMLDivElement, Props>(\n  function TooltipContents2({ message }, ref) {\n    return (\n      <div ref={ref}>\n        {isValidElement(message) ? (\n          message\n        ) : message ? (\n          <SanitizedHTML html={String(message)} />\n        ) : null}\n      </div>\n    )\n  },\n)\nconst LineTooltip = observer(function LineTooltip({\n  contents,\n}: {\n  contents?: string\n}) {\n  return contents ? (\n    <BaseTooltip>\n      <TooltipContents message={contents} />\n    </BaseTooltip>\n  ) : null\n})\n\nconst AllLines = observer(function AllLines({\n  model,\n  setMouseOverLine,\n}: {\n  model: MinimalModel\n  setMouseOverLine: (arg: any) => void\n}) {\n  const theme = useTheme()\n  const { assemblyManager } = getSession(model)\n  const view = getContainingView(model) as LinearGenomeViewModel\n  const { lineZoneHeight, featuresVolatile } = model\n  const { offsetPx, assemblyNames, dynamicBlocks } = view\n  const assembly = assemblyManager.get(assemblyNames[0]!)\n  const b0 = dynamicBlocks.contentBlocks[0]?.widthPx || 0\n  const w = b0 / (featuresVolatile?.length || 1)\n  const l = Math.max(offsetPx, 0)\n  const p = getStrokeProps(alpha(theme.palette.text.primary, 0.4))\n  return assembly && featuresVolatile ? (\n    <>\n      {featuresVolatile.map((f, i) => {\n        const ref = f.get('refName')\n        const c =\n          (view.bpToPx({\n            refName: assembly.getCanonicalRefName2(ref),\n            coord: f.get('start'),\n          })?.offsetPx || 0) - l\n        return (\n          <line\n            {...p}\n            strokeWidth={1}\n            key={f.id()}\n            x1={i * w + w / 2}\n            x2={c}\n            y1={lineZoneHeight}\n            y2={0}\n            onMouseEnter={() => {\n              setMouseOverLine({ f, idx: i, c })\n            }}\n            onMouseLeave={() => {\n              setMouseOverLine(undefined)\n            }}\n          />\n        )\n      })}\n    </>\n  ) : null\n})\n\nexport default LinesConnectingMatrixToGenomicPosition\n","import { useRef } from 'react'\n\nimport { observer } from 'mobx-react'\n\nimport LinesConnectingMatrixToGenomicPosition from './LinesConnectingMatrixToGenomicPosition.tsx'\nimport Crosshair from '../../shared/components/MultiVariantCrosshairs.tsx'\nimport ScrollableVariantContainer from '../../shared/components/ScrollableVariantContainer.tsx'\nimport { useMouseTracking } from '../../shared/hooks/useMouseTracking.ts'\n\nimport type { MultiLinearVariantMatrixDisplayModel } from '../model.ts'\n\nconst MultiLinearVariantMatrixDisplayComponent = observer(\n  function MultiLinearVariantMatrixDisplayComponent(props: {\n    model: MultiLinearVariantMatrixDisplayModel\n  }) {\n    const { model } = props\n    const { lineZoneHeight, height } = model\n    const ref = useRef<HTMLDivElement>(null)\n    const { mouseState, handleMouseMove, handleMouseLeave } =\n      useMouseTracking(ref)\n\n    return (\n      <div\n        ref={ref}\n        style={{ position: 'relative', height }}\n        onMouseMove={handleMouseMove}\n        onMouseLeave={handleMouseLeave}\n      >\n        {/* Connecting lines - fixed at top */}\n        <div data-testid=\"connecting-lines\">\n          <LinesConnectingMatrixToGenomicPosition model={model} />\n        </div>\n\n        <ScrollableVariantContainer\n          model={model}\n          topOffset={lineZoneHeight}\n          testId=\"matrix-display\"\n        />\n\n        {mouseState && mouseState.y > lineZoneHeight ? (\n          <Crosshair\n            mouseX={mouseState.x}\n            mouseY={mouseState.y}\n            offsetX={mouseState.offsetX}\n            offsetY={mouseState.offsetY}\n            model={model}\n          />\n        ) : null}\n      </div>\n    )\n  },\n)\nexport default MultiLinearVariantMatrixDisplayComponent\n"],"names":["useStyles","makeStyles","theme","resizeHandle","height","boxSizing","background","palette","divider","Wrapper","observer","children","model","exportSVG","width","offsetPx","getContainingView","left","Math","max","_jsx","transform","style","position","top","LinesConnectingMatrixToGenomicPosition","classes","assemblyManager","getSession","view","mouseOverLine","setMouseOverLine","useState","lineZoneHeight","featuresVolatile","assemblyNames","dynamicBlocks","assembly","get","w","contentBlocks","widthPx","length","_jsxs","_Fragment","AllLines","stroke","strokeWidth","pointerEvents","x1","idx","x2","c","y1","y2","onMouseLeave","undefined","LineTooltip","contents","f","ResizeHandle","onDrag","n","setLineZoneHeight","className","TooltipContents","forwardRef","t0","ref","$","_c","message","t1","t2","isValidElement","SanitizedHTML","html","String","BaseTooltip","useTheme","l","p","getStrokeProps","alpha","text","primary","map","i","bpToPx","refName","getCanonicalRefName2","coord","_createElement","key","id","onMouseEnter","props","useRef","mouseState","handleMouseMove","handleMouseLeave","useMouseTracking","onMouseMove","ScrollableVariantContainer","topOffset","testId","y","Crosshair","mouseX","x","mouseY","offsetX","offsetY"],"sourceRoot":""}