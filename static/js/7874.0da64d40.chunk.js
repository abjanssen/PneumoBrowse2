"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7874],{57874:(e,n,t)=>{t.r(n),t.d(n,{default:()=>be});var s=t(68584),a=t(13476),r=t(48759),l=t(76386),o=t(75068),i=t(61282),c=t(3032),d=t(36866),u=t(68446),p=t(36422),x=t(93091),h=t(75785),m=t(7552),j=t(67112),v=t(99546),g=t(23550),b=t(54063),A=t(93062),f=t(94874),C=t(10240),y=t(95054),N=t(89870),k=t(91818),S=t(7946),T=t(22762),w=t(29654),M=t(69500);const L=(0,u.observer)((function({slot:e}){return(0,M.jsxs)(k.A,{children:[(0,M.jsx)(S.A,{label:e.name,control:(0,M.jsx)(T.A,{checked:e.value,onChange:n=>{e.set(n.target.checked)}})}),(0,M.jsx)(w.A,{children:e.description})]})}));var F=t(43283),E=t(15897),$=t(37962);const P='Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace',I=(0,h.n9)()((e=>({callbackEditor:{marginTop:"16px",borderBottom:`1px solid ${e.palette.divider}`,width:"100%",fontFamily:P},textAreaFont:{fontFamily:P},callbackContainer:{width:"100%",overflowX:"auto"},error:{color:"red",fontSize:"0.8em"}}))),O=(0,u.observer)((function({slot:e}){const{classes:n}=I(),[t,s]=(0,m.useState)(e.value),[a,r]=(0,m.useState)(),l=(0,v.useDebounce)(t,400);return(0,m.useEffect)((()=>{try{const n=l.startsWith("jexl:")?l:`jexl:${l}`;if("jexl:"===n)throw new Error("Empty jexl expression is not valid");(0,F.A)(n,(0,p.getEnv)(e).pluginManager?.jexl),e.set(n),r(void 0)}catch(e){console.error({e}),r(e)}}),[l,e]),(0,M.jsxs)(M.Fragment,{children:[a?(0,M.jsx)("p",{className:n.error,children:`${a}`}):null,(0,M.jsxs)("div",{className:n.callbackContainer,children:[(0,M.jsx)(A.A,{multiline:!0,className:n.callbackEditor,value:t.startsWith("jexl:")?t.split("jexl:")[1]:t,onChange:e=>{s(e.target.value)},style:{background:a?"#fdd":void 0},slotProps:{input:{classes:{input:n.textAreaFont}}}}),(0,M.jsx)("p",{children:e.description}),(0,M.jsx)($.A,{title:(0,M.jsxs)("div",{children:["Callbacks are written in Jexl format. Click to learn more.",(0,M.jsx)("br",{})," Names of available context items: ",e.contextVariable]}),arrow:!0,children:(0,M.jsx)(N.A,{color:"primary",onClick:()=>{const e=window.open("https://github.com/TomFrost/Jexl","_blank","noopener,noreferrer");e&&(e.opener=null)},children:(0,M.jsx)(E.A,{})})})]})]})}));var W=t(66395);const V=e=>{const{value:n="#000",label:t="",TextFieldProps:s={},onChange:a}=e,[r,l]=(0,m.useState)(!1);return(0,M.jsxs)("div",{style:{display:"flex"},children:[(0,M.jsx)(A.A,{value:n,label:t,onClick:()=>{l(!r)},onChange:e=>{a(e.target.value)},...s}),(0,M.jsx)("div",{style:{marginTop:10},children:(0,M.jsx)(m.Suspense,{fallback:null,children:(0,M.jsx)(W.Ay,{color:n,onChange:e=>{a(e)}})})})]})},D=(0,u.observer)((function(e){const{slot:n}=e;return(0,M.jsx)(V,{label:n.name,value:n.value,onChange:e=>{n.set(e)},TextFieldProps:{helperText:n.description,fullWidth:!0}})}));function H(e){const{helperText:n}=e;return(0,M.jsx)(A.A,{...e,helperText:(0,M.jsx)(j.SanitizedHTML,{html:n||""}),fullWidth:!0,slotProps:{formHelperText:{component:"div"}}})}var z=t(52348);const J='Consolas, "Andale Mono WT", "Andale Mono", "Lucida Console", "Lucida Sans Typewriter", "DejaVu Sans Mono", "Bitstream Vera Sans Mono", "Liberation Mono", "Nimbus Mono L", Monaco, "Courier New", Courier, monospace',_=(0,h.n9)()((e=>({error:{color:"red",fontSize:"0.8em"},callbackEditor:{fontFamily:J,fontSize:"12px",background:e.palette.background.default,width:800,marginTop:"16px",border:"1px solid rgba(0,0,0,0.42)"},callbackContainer:{width:"100%",overflowX:"auto"},textAreaFont:{fontFamily:J}}))),B=(0,u.observer)((function({slot:e}){const{classes:n}=_(),[t,s]=(0,m.useState)(JSON.stringify(e.value,null,2)),[a,r]=(0,m.useState)();return(0,m.useEffect)((()=>{try{r(void 0),e.set(JSON.parse(t))}catch(e){console.error({e}),r(e)}}),[t,e]),(0,M.jsxs)(M.Fragment,{children:[a?(0,M.jsx)("p",{className:n.error,children:`${a}`}):null,(0,M.jsxs)("div",{className:n.callbackContainer,children:[(0,M.jsx)(z.A,{shrink:!0,htmlFor:"json-editor",children:e.name}),(0,M.jsx)(A.A,{id:"json-editor",className:n.callbackEditor,value:t,helperText:e.description,multiline:!0,onChange:e=>{s(e.target.value)},style:{background:a?"#fdd":void 0},slotProps:{input:{classes:{input:n.textAreaFont}}}})]})]})})),K=(0,u.observer)((function({slot:e}){const[n,t]=(0,m.useState)(e.value);return(0,m.useEffect)((()=>{const t=Number.parseFloat(n);Number.isNaN(t)?e.reset?.():e.set(t)}),[e,n]),(0,M.jsx)(H,{label:e.name,helperText:e.description,value:n,type:"number",onChange:e=>{t(e.target.value)}})}));var U=t(18423),X=t(74281),G=t(74900),R=t(31106),Z=t(5026),q=t(33896);const Q=(0,h.n9)()((e=>({card:{marginTop:e.spacing(1)}}))),Y=(0,u.observer)((function({slot:e}){const{classes:n}=Q(),[t,s]=(0,m.useState)("");return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(z.A,{children:e.name}),[...e.value].map((([t,s])=>(0,M.jsxs)(G.A,{raised:!0,className:n.card,children:[(0,M.jsx)(R.A,{title:t,action:(0,M.jsx)(N.A,{onClick:()=>{e.remove(t)},children:(0,M.jsx)(X.A,{})})}),(0,M.jsx)(Z.A,{children:(0,M.jsx)(K,{slot:{value:s,set:n=>{e.add(t,n)}}})})]},t))),(0,M.jsx)(G.A,{raised:!0,className:n.card,children:(0,M.jsx)(R.A,{disableTypography:!0,title:(0,M.jsx)(A.A,{fullWidth:!0,value:t,placeholder:"add new",onChange:e=>{s(e.target.value)},slotProps:{input:{endAdornment:(0,M.jsx)(q.A,{position:"end",children:(0,M.jsx)(N.A,{disabled:""===t,onClick:()=>{e.add(t,0),s("")},children:(0,M.jsx)(U.A,{})})})}}})})}),(0,M.jsx)(w.A,{children:e.description})]})}));var ee=t(91464),ne=t(36144),te=t(69092);const se=(0,u.observer)((function({slot:e}){const[n,t]=(0,m.useState)(""),[s,a]=(0,m.useState)(!1);return(0,M.jsxs)(M.Fragment,{children:[e.name?(0,M.jsx)(z.A,{children:e.name}):null,(0,M.jsxs)(ee.A,{disablePadding:!0,children:[e.value.map(((n,t)=>(0,M.jsx)(ne.Ay,{disableGutters:!0,children:(0,M.jsx)(A.A,{value:n,onChange:n=>{e.setAtIndex(t,n.target.value)},slotProps:{input:{endAdornment:(0,M.jsx)(q.A,{position:"end",children:(0,M.jsx)(N.A,{onClick:()=>{e.removeAtIndex(t)},children:(0,M.jsx)(X.A,{})})})}}})},`${JSON.stringify(n)}-${t}`))),s?(0,M.jsx)(ne.Ay,{disableGutters:!0,children:(0,M.jsx)(A.A,{value:n,placeholder:"add new",onChange:e=>{t(e.target.value)},slotProps:{input:{endAdornment:(0,M.jsx)(q.A,{position:"end",children:(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(te.A,{color:"primary",variant:"contained",style:{margin:2},"data-testid":`stringArrayAdd-${e.name}`,onClick:()=>{a(!1),e.add(n),t("")},children:"OK"}),(0,M.jsx)(te.A,{color:"primary",variant:"contained",style:{margin:2},onClick:()=>{a(!1),t("")},children:"Cancel"})]})})}}})}):null,(0,M.jsx)(te.A,{color:"primary",variant:"contained",style:{margin:4},disabled:s,onClick:()=>{a(!0)},children:"Add item"})]}),(0,M.jsx)(w.A,{children:e.description})]})})),ae=(0,h.n9)()((e=>({card:{marginTop:e.spacing(1)}}))),re=(0,u.observer)((function({slot:e}){const{classes:n}=ae(),[t,s]=(0,m.useState)("");return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(z.A,{children:e.name}),[...e.value].map((([t,s])=>(0,M.jsxs)(G.A,{raised:!0,className:n.card,children:[(0,M.jsx)(R.A,{title:t,action:(0,M.jsx)(N.A,{onClick:()=>{e.remove(t)},children:(0,M.jsx)(X.A,{})})}),(0,M.jsx)(Z.A,{children:(0,M.jsx)(se,{slot:{name:e.name,value:s,description:`Values associated with entry ${t}`,setAtIndex:(n,s)=>{e.setAtKeyIndex(t,n,s)},removeAtIndex:n=>{e.removeAtKeyIndex(t,n)},add:n=>{e.addToKey(t,n)}}})})]},t))),(0,M.jsx)(G.A,{raised:!0,className:n.card,children:(0,M.jsx)(R.A,{disableTypography:!0,title:(0,M.jsx)(A.A,{fullWidth:!0,value:t,placeholder:"add new",onChange:e=>{s(e.target.value)},slotProps:{input:{endAdornment:(0,M.jsx)(q.A,{position:"end",children:(0,M.jsx)(N.A,{disabled:""===t,onClick:()=>{e.add(t,[]),s("")},children:(0,M.jsx)(U.A,{})})})}}})})}),(0,M.jsx)(w.A,{children:e.description})]})})),le=(0,h.n9)()((e=>({paper:{display:"flex",marginBottom:e.spacing(2),position:"relative"},paperContent:{width:"100%"},slotModeSwitch:{width:24,background:e.palette.secondary.light,display:"flex",justifyContent:"center",alignItems:"center"}}))),oe=(0,u.observer)((function({slot:e}){return(0,M.jsx)(H,{label:e.name,helperText:e.description,value:e.value,onChange:n=>{e.set(n.target.value)}})})),ie=(0,u.observer)((function({slot:e}){return(0,M.jsx)(A.A,{label:e.name,helperText:e.description,multiline:!0,value:e.value,onChange:n=>{e.set(n.target.value)}})})),ce=()=>(0,M.jsx)(f.A,{children:(0,M.jsx)("path",{d:"M20.41,3C21.8,5.71 22.35,8.84 22,12C21.8,15.16 20.7,18.29 18.83,21L17.3,20C18.91,17.57 19.85,14.8 20,12C20.34,9.2 19.89,6.43 18.7,4L20.41,3M5.17,3L6.7,4C5.09,6.43 4.15,9.2 4,12C3.66,14.8 4.12,17.57 5.3,20L3.61,21C2.21,18.29 1.65,15.17 2,12C2.2,8.84 3.3,5.71 5.17,3M12.08,10.68L14.4,7.45H16.93L13.15,12.45L15.35,17.37H13.09L11.71,14L9.28,17.33H6.76L10.66,12.21L8.53,7.45H10.8L12.08,10.68Z"})}),de=(0,u.observer)((function({slot:e}){const[n,t]=(0,m.useState)(e.value);return(0,m.useEffect)((()=>{const t=Number.parseInt(n,10);Number.isNaN(t)||e.set(t)}),[e,n]),(0,M.jsx)(H,{label:e.name,helperText:e.description,value:n,type:"number",onChange:e=>{t(e.target.value)}})})),ue=(0,u.observer)((function({slot:e,slotSchema:n}){const t=(0,p.getPropertyMembers)((0,g.getSubType)(n)),s=(0,g.getUnionSubTypes)((0,g.getUnionSubTypes)((0,g.getSubType)(t.properties.value))[1]).map((e=>e.value));return(0,M.jsx)(H,{value:e.value,label:e.name,select:!0,helperText:e.description,onChange:n=>{e.set(n.target.value)},children:s.map((e=>(0,M.jsx)(C.A,{value:e,children:e},e)))})})),pe=(0,u.observer)((function({slot:e}){return(0,M.jsx)(j.FileSelector,{location:e.value,setLocation:n=>{e.set(n)},name:e.name,description:e.description,rootModel:(0,v.getEnv)(e).pluginManager?.rootModel})})),xe={string:oe,text:ie,fileLocation:pe,stringArray:se,stringArrayMap:re,numberMap:Y,number:K,integer:de,color:D,stringEnum:ue,boolean:L,frozen:B,configRelationships:B},he=(0,u.observer)((function({slot:e,slotSchema:n}){const{classes:t}=le(),{type:s}=e;let a=e.isCallback?O:xe[s];return a||(console.warn(`no slot editor defined for ${s}, editing as string`),a=oe),s in xe||console.warn(`SlotEditor needs to implement ${s}`),(0,M.jsxs)(y.A,{className:t.paper,children:[(0,M.jsx)("div",{className:t.paperContent,children:(0,M.jsx)(a,{slot:e,slotSchema:n})}),(0,M.jsx)("div",{className:t.slotModeSwitch,children:e.contextVariable.length?(0,M.jsx)(N.A,{onClick:()=>e.isCallback?e.convertToValue():e.convertToCallback(),title:"convert to "+(e.isCallback?"regular value":"callback"),children:e.isCallback?(0,M.jsx)(ce,{}):(0,M.jsx)(b.A,{})}):null})]})})),me=(0,u.observer)((function({typeNameChoices:e,slot:n,slotName:t,onChange:s}){const{classes:a}=le();return(0,M.jsx)(y.A,{className:a.paper,children:(0,M.jsx)("div",{className:a.paperContent,children:(0,M.jsx)(A.A,{value:n.type,label:"Type",select:!0,helperText:`Type of ${t} to use`,fullWidth:!0,onChange:s,children:e.map((e=>(0,M.jsx)(C.A,{value:e,children:e},e)))})})})})),je=(0,h.n9)()((e=>({icon:{color:e.palette.tertiary.contrastText||"#fff"},expansionPanelDetails:{display:"block",padding:e.spacing(1)},accordion:{border:`1px solid ${e.palette.text.primary}`},noOverflow:{width:"100%",overflowX:"auto"}}))),ve=(0,u.observer)((function(e){const{classes:n}=je(),{slotName:t,slotSchema:a,schema:u,slot:p=u[t],path:h=[]}=e;if((0,s.isConfigurationSchemaType)(a)){if(p.length)return p.map(((n,s)=>{const a=n.type?`${(0,x.singular)(t)} ${n.type}`:`${(0,x.singular)(t)} ${s+1}`;return(0,M.jsx)(ve,{...e,slot:n,slotName:a},a)}));const m=(0,s.getTypeNamesFromExplicitlyTypedUnion)(a);return(0,M.jsxs)(l.A,{defaultExpanded:!0,className:n.accordion,children:[(0,M.jsx)(o.A,{expandIcon:(0,M.jsx)(r.A,{className:n.icon}),children:(0,M.jsx)(i.A,{children:[...h,t].join("➔")})}),(0,M.jsxs)(c.A,{className:n.expansionPanelDetails,children:[m.length?(0,M.jsx)(me,{typeNameChoices:m,slotName:t,slot:p,onChange:e=>{e.target.value!==p.type&&u.setSubschema(t,{type:e.target.value})}}):null,(0,M.jsx)(d.A,{className:n.noOverflow,children:(0,M.jsx)(ge,{schema:p,path:[...h,t]})})]})]})}return(0,s.isConfigurationSlotType)(a)?(0,M.jsx)(he,{slot:p,slotSchema:a},t):null})),ge=(0,u.observer)((function({schema:e,path:n=[]}){const t=(0,p.getMembers)(e).properties;return(0,M.jsx)(M.Fragment,{children:Object.entries(t).map((([t,s])=>(0,M.jsx)(ve,{slotName:t,slotSchema:s,path:n,schema:e},t)))})})),be=(0,u.observer)((function({model:e}){const{classes:n}=je(),{target:t}=e,d=(0,s.readConfObject)(t,"trackId"),u=(0,s.readConfObject)(t,"name");return(0,M.jsxs)(l.A,{defaultExpanded:!0,className:n.accordion,children:[(0,M.jsx)(o.A,{expandIcon:(0,M.jsx)(r.A,{className:n.icon}),children:(0,M.jsx)(i.A,{children:(0,M.jsx)(a.A,{html:u??"Configuration"})})}),(0,M.jsx)(c.A,{className:n.expansionPanelDetails,"data-testid":"configEditor",children:(0,M.jsx)(ge,{schema:t})})]},d)}))}}]);
//# sourceMappingURL=7874.0da64d40.chunk.js.map