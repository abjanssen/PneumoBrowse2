"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5864],{9040(e,t,n){n.r(t),n.d(t,{Loader:()=>Et,default:()=>Wt});var s=n(30936),o=n(42918),r=n(64171),i=n(90975),a=n(99226),c=n(64074),l=(n(35922),n(32118));const u=(0,o.lazy)(()=>Promise.all([n.e(2830),n.e(9356)]).then(n.bind(n,19356))),d=(0,c.observer)(function({session:e}){const{snackbarMessages:t}=e,n=t.at(-1);return n?(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(u,{onClose:(t,n)=>{"clickaway"!==n&&e.popSnackbarMessage()},contents:n})}):null});var f=n(65045),p=n(35466),m=n(96322),g=n(27607),h=n(68903);const y=(0,f.n)()(e=>({left:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},right:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}})),w=(0,c.observer)(function({session:e}){const{minimized:t,activeWidgets:n,drawerPosition:s}=e,{classes:o}=y();return n.size>0&&t?(0,l.jsx)(g.A,{title:"Open drawer widget",children:(0,l.jsx)(h.A,{className:"right"===s?o.right:o.left,color:"primary","data-testid":"drawer-maximize",onClick:()=>{e.showWidgetDrawer()},children:(0,l.jsx)(m.A,{})})}):null});var b=n(68674),S=n(11259);const v=(0,c.observer)(function({session:e}){const{configuration:t}=e,n=(0,S.QZ)(t,"logoPath");return n?.uri?(0,l.jsx)("img",{src:n.uri,alt:"Custom logo"}):(0,l.jsx)(b.P,{variant:"white"})});var k=n(36533),C=n(15943),A=n(65525),T=n(35913);const M=(0,f.n)()(e=>({buttonRoot:{"&:hover":{backgroundColor:(0,C.X4)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}));function N(e){const t=(0,s.c)(3),{classes:n}=M();let o;return t[0]!==n.buttonRoot||t[1]!==e?(o=(0,l.jsx)(A.A,{...e,className:n.buttonRoot,children:e.children}),t[0]=n.buttonRoot,t[1]=e,t[2]=o):o=t[2],o}const P=(0,c.observer)(function({menuTitle:e,menuItems:t}){return(0,l.jsxs)(T.A,{menuItems:t,color:"inherit",ButtonComponent:N,children:[e,(0,l.jsx)(k.A,{})]})});var I=n(86520),x=n(19335);const E=(0,f.n)()(e=>({grow:{flexGrow:1},inputBase:{color:e.palette.primary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.primary.light}},inputFocused:{borderColor:e.palette.secondary.main,backgroundColor:e.palette.primary.light}}));function R(e,t){return e.map(e=>({...e,..."onClick"in e?{onClick:()=>{e.onClick(t)}}:{},..."subMenu"in e?{subMenu:R(e.subMenu,t)}:{}}))}const j=(0,c.observer)(function({session:e,HeaderButtons:t=(0,l.jsx)("div",{})}){const{classes:n}=E(),{name:s,menus:o}=e;return(0,l.jsxs)(x.A,{children:[o().map(t=>(0,l.jsx)(P,{menuTitle:t.label,menuItems:()=>R("function"==typeof t.menuItems?t.menuItems():t.menuItems,e)},t.label)),(0,l.jsx)("div",{className:n.grow}),(0,l.jsx)(g.A,{title:"Rename session",arrow:!0,children:(0,l.jsx)(I.A,{value:s,variant:"body1",classes:{inputBase:n.inputBase,inputRoot:n.inputRoot,inputFocused:n.inputFocused},setValue:t=>{e.renameCurrentSession(t)}})}),t,(0,l.jsx)("div",{className:n.grow}),(0,l.jsx)("div",{style:{width:150,maxHeight:48},children:(0,l.jsx)(v,{session:e})})]})}),D=(0,c.observer)(function({session:e}){const{DialogComponent:t,DialogProps:n}=e;return t?(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(t,{...n})}):null}),W=(0,o.lazy)(()=>n.e(6242).then(n.bind(n,96242))),L=(0,o.lazy)(()=>Promise.all([n.e(5043),n.e(701)]).then(n.bind(n,50701))),U=(0,o.lazy)(()=>n.e(7354).then(n.bind(n,24973))),$=(0,f.n)()({viewsContainer:{gridRow:"components",overflow:"hidden"}}),V=(0,c.observer)(function(e){const{session:t}=e,{views:n}=t,{classes:s}=$(),r=!("useWorkspaces"in t)||t.useWorkspaces;return(0,l.jsx)("div",{className:s.viewsContainer,children:n.length>0?(0,l.jsx)(o.Suspense,{fallback:null,children:r?(0,l.jsx)(L,{session:t}):(0,l.jsx)(W,{session:t})}):(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(U,{...e})})})}),B=(0,o.lazy)(()=>n.e(4613).then(n.bind(n,44613))),O=(0,f.n)()(e=>({root:{display:"grid",height:"100vh",width:"100%",colorScheme:e.palette.mode},appContainer:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},appBar:{flexGrow:1,gridRow:"menubar"}})),G=(0,c.observer)(function(e){const{session:t}=e;return(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(B,{session:t})})}),z=(0,c.observer)(function(e){const{session:t}=e,{classes:n}=O(),{minimized:s,visibleWidget:o,drawerWidth:r,drawerPosition:i}=t,a=o&&!s,c=a?`[drawer] ${r}px`:void 0,u="right"===i?["[main] 1fr",c]:[c,"[main] 1fr"];return(0,l.jsxs)("div",{className:n.root,style:{gridTemplateColumns:u.filter(e=>!!e).join(" ")},children:[a&&"left"===i?(0,l.jsx)(G,{session:t}):null,(0,l.jsx)(D,{session:t}),(0,l.jsxs)("div",{className:n.appContainer,children:[(0,l.jsx)(p.A,{className:n.appBar,position:"static",children:(0,l.jsx)(j,{...e})}),(0,l.jsx)(V,{...e})]}),(0,l.jsx)(w,{session:t}),a&&"right"===i?(0,l.jsx)(G,{session:t}):null,(0,l.jsx)(d,{session:t})]})});var F=n(34202),H=n(10943),q=n(8414);const J=(0,f.n)()(e=>({shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{backgroundColor:(0,C.X4)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}})),K=(0,o.lazy)(()=>n.e(1157).then(n.bind(n,21157))),Q=(0,c.observer)(function(e){const[t,n]=(0,o.useState)(!1),{session:s}=e,{classes:r}=J();return(0,l.jsxs)("div",{className:r.shareDiv,children:[(0,l.jsx)(A.A,{size:"small",color:"inherit",startIcon:(0,l.jsx)(q.A,{}),classes:{root:r.shareButton},onClick:async()=>{n(!0)},children:"Share"}),t?(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(K,{session:s,handleClose:()=>{n(!1)}})}):null]})});var _=n(37777);const Z=(0,c.observer)(function({pluginManager:e}){const{adminKey:t,adminServer:n,config:s}=(0,_.BW)(["adminKey","adminServer","config"]),{rootModel:r}=e,{error:i,jbrowse:c,session:u}=r,d=u,{id:f,theme:p}=d;if((0,o.useEffect)(()=>{(0,_.dR)({session:`local-${f}`}),window.JBrowseRootModel=r,window.JBrowseSession=d},[f,r,d]),(0,o.useEffect)(()=>t?(0,a.onSnapshot)(c,async e=>{try{const o=await fetch(n||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:t,configPath:s,config:e})});if(!o.ok){const e=await o.text();throw new Error(`HTTP ${o.status} (${e})`)}}catch(e){d.notify(`Admin server error: ${e}`)}}):void 0,[c,d,t,n,s]),i)throw i;return(0,l.jsxs)(F.A,{theme:p,children:[(0,l.jsx)(H.Ay,{}),(0,l.jsx)(z,{session:d,HeaderButtons:(0,l.jsx)(Q,{session:d})},f)]})}),X=Z;var Y=n(29460),ee=n(20616),te=n(33624),ne=n(27868),se=n(4778),oe=n(38567),re=n(50271);const ie=["https://jbrowse.org/plugins/"];async function ae(e){if(0===e.length)return!0;const t=await async function(){const e=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!e.ok)throw new Error(`HTTP ${e.status} ${e.statusText} fetching plugins`);return e.json()}();return e.every(e=>{return n=(0,ee.Hm)(e),ie.some(e=>n.startsWith(e))||function(e,t){const n=(0,ee.Hm)(e);return(0,ee.rE)(e)?t.plugins.some(e=>(0,ee.rE)(e)&&(0,ee.Hm)(e)===n):(0,ee.Cx)(e)?t.plugins.some(e=>(0,ee.Cx)(e)&&(0,ee.Hm)(e)===n):!!(0,ee.Nz)(e)&&t.plugins.some(e=>(0,ee.Nz)(e)&&(0,ee.Hm)(e)===n)}(e,t);var n})}var ce=n(48991);const le=a.types.model({configPath:a.types.maybe(a.types.string),sessionQuery:a.types.maybe(a.types.string),password:a.types.maybe(a.types.string),adminKey:a.types.maybe(a.types.string),loc:a.types.maybe(a.types.string),sessionTracks:a.types.maybe(a.types.string),assembly:a.types.maybe(a.types.string),tracks:a.types.maybe(a.types.string),tracklist:a.types.maybe(a.types.boolean),highlight:a.types.maybe(a.types.string),nav:a.types.maybe(a.types.boolean),initialTimestamp:a.types.number,hubURL:a.types.maybe(a.types.array(a.types.string)),configSnapshot:a.types.frozen(void 0),sessionSnapshot:a.types.frozen(void 0)}).volatile(()=>({sessionTriaged:void 0,sessionSpec:void 0,hubSpec:void 0,blankSession:!1,runtimePlugins:void 0,sessionPlugins:void 0,sessionError:void 0,configError:void 0})).views(e=>({get isSharedSession(){return!!e.sessionQuery?.startsWith("share-")},get isSpecSession(){return!!e.sessionQuery?.startsWith("spec-")},get isHubSession(){return!!e.hubURL},get isJb1StyleSession(){return!(!e.loc&&!e.assembly)},get isEncodedSession(){return!!e.sessionQuery?.startsWith("encoded-")},get isJsonSession(){return!!e.sessionQuery?.startsWith("json-")},get isLocalSession(){return!!e.sessionQuery?.startsWith("local-")},get ready(){return this.isSessionLoaded&&!e.configError&&this.pluginsLoaded},get error(){return e.configError||e.sessionError},get pluginsLoaded(){return e.sessionError||e.blankSession||e.sessionSpec?Boolean(e.runtimePlugins):Boolean(e.runtimePlugins&&e.sessionPlugins)},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]},get resolvedConfigPath(){const t=window.__jbrowseConfigPath;return e.configPath||t||"config.json"}})).actions(e=>({setConfigError(t){e.configError=t},setSessionError(t){e.sessionError=t},setRuntimePlugins(t){e.runtimePlugins=t},setSessionPlugins(t){e.sessionPlugins=t},setConfigSnapshot(t){e.configSnapshot=t},setBlankSession(t){e.blankSession=t},setSessionTriaged(t){e.sessionTriaged=t},setSessionSnapshot(t){e.sessionSnapshot=t}})).actions(e=>({async fetchPlugins(t){try{const n=new ee.Ay(t.plugins||[],{fetchESM:e=>import(e)});n.installGlobalReExports(window);const s=await n.load(window.location.href);e.setRuntimePlugins([...s])}catch(t){console.error(t),e.setConfigError(t)}},async fetchSessionPlugins(t){try{const n=new ee.Ay(t.sessionPlugins||[],{fetchESM:e=>import(e)}).installGlobalReExports(window),s=await n.load(window.location.href);e.setSessionPlugins([...s])}catch(t){console.error(t),e.setConfigError(t)}},async loadSession(t,n){try{const{sessionPlugins:s=[]}=t;await ae(s)||n?(await this.fetchSessionPlugins(t),e.setSessionSnapshot(t)):e.setSessionTriaged({snap:t,origin:"session",reason:s})}catch(t){console.error(t),e.setConfigError(t)}},async fetchConfig(){const t=e.resolvedConfigPath;if("none"!==t){const n=await(0,te.openLocation)({uri:t+(window.__jbrowseCacheBuster?`?rand=${Math.random()}`:""),locationType:"UriLocation"}).readFile("utf8"),s=JSON.parse(n),o=new URL(t,window.location.href);if((0,ce.XE)(s,o),o.hostname!==window.location.hostname){const t=s.plugins||[];if(!await ae(t))return void e.setSessionTriaged({snap:s,origin:"config",reason:t})}await this.fetchPlugins(s),e.setConfigSnapshot(s)}else e.setConfigSnapshot({})},async setUpConfig(){const t=e.resolvedConfigPath,n=new URL(t,window.location.href),s=structuredClone(e.configSnapshot);(0,ce.XE)(s,n),e.setConfigSnapshot(s),await this.fetchPlugins(s)},async fetchSessionFromSessionStorage(e){const t=sessionStorage.getItem("current");if(t){const n=JSON.parse(t).session||{};if(e===n.id)return await this.loadDecodedSession(n),!0}return!1},async fetchSessionFromIndexedDB(e){try{const t=await(0,se.P2)("sessionsDB",2,{upgrade(e){e.createObjectStore("metadata"),e.createObjectStore("sessions")}}),n=await t.get("sessions",e);if(n)return await this.loadDecodedSession(n),!0}catch(e){console.error(e)}return!1},async fetchLocalSession(){const t=e.sessionQuery.replace("local-","");if(!await this.fetchSessionFromSessionStorage(t)&&!await this.fetchSessionFromIndexedDB(t))throw new Error("Local session not found")},async loadSessionPluginsIfNeeded(t){e.sessionPlugins||await this.loadSession(t)},async loadDecodedSession(e){await this.loadSession({...e,id:(0,ne.w)()})},async fetchSharedSession(){const t=await(0,re.Z)(`${(0,ce.Vr)(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/")}load`,e.sessionQuery||"",e.password||""),n=JSON.parse(await(0,ce.LP)(t));await this.loadDecodedSession(n)},async decodeEncodedUrlSession(){const t=JSON.parse(await(0,ce.LP)(e.sessionQuery.replace("encoded-","")));await this.loadDecodedSession(t)},decodeSessionSpec(){e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-",""))},decodeJb1StyleSession(){const{loc:t,tracks:n,assembly:s,tracklist:o,nav:r,highlight:i,sessionTracksParsed:a}=e;e.sessionSpec={sessionTracks:a,views:[{type:"LinearGenomeView",tracks:n?.split(","),sessionTracks:a,loc:t,assembly:s,tracklist:o,nav:r,highlight:i?.split(" ")}]}},decodeHubSpec(){const{hubURL:t,sessionTracksParsed:n}=e;e.hubSpec={sessionTracks:n,hubURL:t}},async decodeJsonUrlSession(){const{session:t}=JSON.parse(e.sessionQuery.replace(/^json-/,""));await this.loadDecodedSession(t)},afterCreate(){(async()=>{try{await(e.configSnapshot?this.setUpConfig():this.fetchConfig()),(0,a.addDisposer)(e,(0,oe.autorun)(async()=>{try{const{isLocalSession:t,isEncodedSession:n,isSpecSession:s,isSharedSession:o,isJsonSession:r,isJb1StyleSession:i,isHubSession:a,sessionSnapshot:c,configSnapshot:l}=e;if(!l)return;if(c)await this.loadSessionPluginsIfNeeded(c);else if(o)await this.fetchSharedSession();else if(s)this.decodeSessionSpec();else if(i)this.decodeJb1StyleSession();else if(n)await this.decodeEncodedUrlSession();else if(r)await this.decodeJsonUrlSession();else if(t)await this.fetchLocalSession();else if(a)this.decodeHubSpec(),e.setBlankSession(!0);else{if(e.sessionQuery)throw new Error(`Unrecognized URL session format: "${e.sessionQuery}"`);e.setBlankSession(!0)}}catch(t){console.error(t),e.setSessionError(t)}}))}catch(t){console.error(t),e.setConfigError(t)}})()}}));var ue=n(20067),de=n(77251);var fe=n(96669);function pe(e,t){return void 0!==e.views?{viewIds:e.views.map(e=>t[e]?.id).filter(e=>void 0!==e),size:e.size}:e.children?{direction:e.direction,children:e.children.map(e=>pe(e,t)),size:e.size}:{}}async function me({views:e,sessionTracks:t=[],layout:n},s){const o=s.rootModel;try{o.setSession({name:`New session ${(new Date).toLocaleString()}`});for(const e of t)o.session.addTrackConf(e);if(await Promise.all(e.map(e=>s.evaluateAsyncExtensionPoint(`LaunchView-${e.type}`,{...e,session:o.session}))),n){const e=o.session;e.setUseWorkspaces(!0),e.setInit(pe(n,e.views))}}catch(e){console.error(e),o.session?.notifyError(`${e}`,e)}}const ge=a.types.model("TimeTraveller",{undoIdx:-1,targetPath:""}).volatile(()=>({history:[],notTrackingUndo:!1})).views(e=>({get canUndo(){return e.undoIdx>0&&!e.notTrackingUndo},get canRedo(){return e.undoIdx<e.history.length-1&&!e.notTrackingUndo}})).actions(e=>{let t,n,s,o,r=!1;return{stopTrackingUndo(){e.notTrackingUndo=!0},resumeTrackingUndo(){e.notTrackingUndo=!1},addUndoState(t){e.notTrackingUndo||(r?r=!1:(e.history.splice(e.undoIdx+1),e.history.push(t),e.history.length>20&&e.history.shift(),e.undoIdx=e.history.length-1))},beforeDestroy(){n(),s&&clearTimeout(s)},initialize(){if(t=e.targetPath?(0,a.resolvePath)(e,e.targetPath):(0,a.getEnv)(e).targetStore,!t)throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath` property, or a `targetStore` in the environment");n=(0,a.onSnapshot)(t,t=>{e.notTrackingUndo||r||(o=t,s&&clearTimeout(s),s=setTimeout(()=>{s=void 0,this.addUndoState(o)},300))}),0===e.history.length&&this.addUndoState((0,a.getSnapshot)(t))},undo(){e.undoIdx--,r=!0,t&&(0,a.applySnapshot)(t,e.history[e.undoIdx])},redo(){e.undoIdx++,r=!0,t&&(0,a.applySnapshot)(t,e.history[e.undoIdx])}}});function he({menus:e,menuName:t}){return e.push({label:t,menuItems:[]})}function ye({menus:e,menuName:t,position:n}){return e.splice((n<0?e.length:0)+n,0,{label:t,menuItems:[]}),e.length}function we({menus:e,menuName:t,menuItem:n}){const s=e.find(e=>e.label===t);return s?s.menuItems.push(n):(e.push({label:t,menuItems:[n]}),1)}function be({menus:e,menuName:t,menuItem:n,position:s}){const o=e.find(e=>e.label===t);if(!o)return e.push({label:t,menuItems:[n]}),1;const r=s<0?o.menuItems.length+s:s;return o.menuItems.splice(r,0,n),o.menuItems.length}function Se({menus:e,menuPath:t,menuItem:n}){let s=e.find(e=>e.label===t[0]);s||(s=e[he({menus:e,menuName:t[0]})-1]);let{menuItems:o}=s;const r=[t[0]];for(const e of t.slice(1)){r.push(e);let t=o.find(t=>"label"in t&&t.label===e);if(!t){const n=o.push({label:e,subMenu:[]});t=o[n-1]}if(!("subMenu"in t))throw new Error(`"${e}" in path "${r}" is not a subMenu`);o=t.subMenu}return o.push(n)}function ve({menus:e,menuPath:t,menuItem:n,position:s}){let o=e.find(e=>e.label===t[0]);o||(o=e[he({menus:e,menuName:t[0]})-1]);let{menuItems:r}=o;const i=[t[0]];for(const e of t.slice(1)){i.push(e);let t=r.find(t=>"label"in t&&t.label===e);if(!t){const n=r.push({label:e,subMenu:[]});t=r[n-1]}if(!("subMenu"in t))throw new Error(`"${e}" in path "${i}" is not a subMenu`);r=t.subMenu}return r.splice(s,0,n),r.length}var ke=n(25986),Ce=n(87877);function Ae(e){return!("function"==typeof e||e instanceof Error)}class Te{constructor(e){this.driver=e}async getWorker(){return this.workerP||(this.workerP=this.driver.makeWorker().catch(e=>{throw this.workerP=void 0,e})),this.workerP}}class Me{lastWorkerAssignment=-1;workerAssignments=new Map;constructor(e){this.config=e.config}filterArgs(e,t){if(null==e)return e;const n=typeof e;if("string"===n||"number"===n||"boolean"===n)return e;if("object"===n){if(Array.isArray(e))return e.filter(e=>Ae(e)).map(e=>this.filterArgs(e,t));if((0,a.isStateTreeNode)(e)&&!(0,a.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:Object.fromEntries(Object.entries(e).filter(e=>Ae(e[1])).map(([e,n])=>[e,this.filterArgs(n,t)]))}}async remoteAbort(e,t,n){const s=await this.getWorker(e);await s.call(t,{stopTokenId:n},{rpcDriverClassName:this.name})}createWorkerPool(){const e=function(){const e="undefined"!=typeof window,t=e&&"hardwareConcurrency"in window.navigator;return e&&t?window.navigator.hardwareConcurrency:1}(),t=(0,S.QZ)(this.config,"workerCount")||(0,de.clamp)(1,Math.max(1,e-1),5),n=[];for(let e=0;e<t;e++)n.push(new Te(this));return n}getWorkerPool(){if(!this.workerPool){const e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}async getWorker(e){const t=this.getWorkerPool();let n=this.workerAssignments.get(e);if(void 0===n){const s=(this.lastWorkerAssignment+1)%t.length;this.workerAssignments.set(e,s),this.lastWorkerAssignment=s,n=s}return t[n].getWorker()}async call(e,t,n,s,o={}){if(!t)throw new TypeError("sessionId is required");const r=await this.getWorker(t),i=e.evaluateExtensionPoint("Core-extendWorker",r),a=e.getRpcMethodType(n);if(!a)throw new Error(`unknown RPC method ${n}`);const c=await a.serializeArguments(s,this.name),l=this.filterArgs(c,t),u=await i.call(n,l,{statusCallback:s.statusCallback,rpcDriverClassName:this.name,...o});return a.deserializeReturn(u,s,this.name)}}class Ne{destroy(){}async call(e,t,n={}){}}class Pe extends Me{name="MainThreadRpcDriver";constructor(e){super(e),this.makeWorker=async()=>new Ne}async call(e,t,n,s){if(!t)throw new TypeError("sessionId is required");const o=e.getRpcMethodType(n);if(!o)throw new Error(`unknown RPC method ${n}`);if(o.supportsDirectExecution()){const e=await o.executeDirect(s);if(void 0!==e)return e}const r=await o.serializeArguments(s,this.name),i=await o.execute(r,this.name);return o.deserializeReturn(i,s,this.name)}}var Ie=n(16876),xe=n(44068);class Ee{constructor(e){this.worker=e,this.client=new Ie.XK(e),this.client.on("error",e=>{console.error("[WebWorker RPC Error]",e)})}destroy(){this.worker.terminate()}async call(e,t,n){const{statusCallback:s,rpcDriverClassName:o}=n,r=`message-${(0,xe.Ak)()}`,i=e=>{s?.(e)};this.client.on(r,i);try{return await this.client.call(e,{...t,channel:r,rpcDriverClassName:o})}finally{this.client.off(r,i)}}}class Re extends Me{name="WebWorkerRpcDriver";constructor(e,t){super(e),this.workerBootConfiguration=t,this.makeWorkerInstance=e.makeWorkerInstance}async makeWorker(){const e=this.makeWorkerInstance(),t=new Ee(e);return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&console.log("console logging the webworker handle avoids the track going into an infinite loading state, this is a hacky workaround for safari",e),new Promise((n,s)=>{const o=r=>{switch(r.data.message){case"ready":n(t),e.removeEventListener("message",o);break;case"readyForConfig":e.postMessage({message:"config",config:this.workerBootConfiguration});break;case"error":s((0,Ie.cy)(r.data.error))}};e.addEventListener("message",o)})}}const je=(0,Ce.S7)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0}),De=(0,Ce.S7)("MainThreadRpcDriver",{},{baseConfiguration:je,explicitlyTyped:!0}),We=(0,Ce.S7)("WebWorkerRpcDriver",{},{baseConfiguration:je,explicitlyTyped:!0}),Le=(0,Ce.S7)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:a.types.optional(a.types.map(a.types.union(De,We)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"},WebWorkerRpcDriver:{type:"WebWorkerRpcDriver"}})},{actions:e=>({addDriverConfig(t,n){e.drivers.set(t,n)}})});class Ue{static configSchema=Le;constructor(e,t,n){this.pluginManager=e,this.mainConfiguration=t,this.backendConfigurations=n,this.driverObjects=new Map,this.driverFactories=new Map,this.registerDriverFactory("MainThreadRpcDriver",(e,t)=>new Pe({...t,config:e})),this.registerDriverFactory("WebWorkerRpcDriver",(e,t,n)=>new Re({...t,config:e},{plugins:n.runtimePluginDefinitions,windowHref:"undefined"!=typeof window?window.location.href:""}))}registerDriverFactory(e,t){this.driverFactories.set(e,t)}getDriver(e){const t=this.driverObjects.get(e);if(t)return t;const n=this.driverFactories.get(e);if(!n)throw new Error(`RPC driver "${e}" is not registered`);const s=this.backendConfigurations[e];if(!s)throw new Error(`RPC driver "${e}" is missing configuration`);const o=n(this.mainConfiguration.drivers.get("WebWorkerRpcDriver"),s,this.pluginManager);return this.driverObjects.set(e,o),o}async getDriverForCall(e,t,n){const s=n.rpcDriverName||(0,S.QZ)(this.mainConfiguration,"defaultDriver");return this.getDriver(s)}async call(e,t,n,s={}){if(!e)throw new Error("sessionId is required");return(await this.getDriverForCall(e,t,n)).call(this.pluginManager,e,t,n,s)}}var $e=n(58693),Ve=n(50172),Be=n(63637),Oe=n(23950),Ge=n(37759);const ze=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),Fe=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function He(e){if(!ze.test(e))throw new Error(`Encountered invalid refName: "${e}"`)}function qe(e,t){const n=new Be.A({cache:new Ge.A({maxSize:1e3}),async fill(e,t,n){const{adapterConf:s,self:o,options:r}=e;let i;try{const e=o.configuration?.sequence?.adapter;i=e?(0,a.getSnapshot)(e):void 0}catch(e){}return async function(e,t,n){const{sessionId:s,sequenceAdapter:o}=n;await(0,oe.when)(()=>!(!e.regions||!e.refNameAliases),{name:"when assembly ready"});const r=await e.rpcManager.call(s||"assemblyRpc","CoreGetRefNames",{adapterConfig:t,sequenceAdapter:o,stopToken:void 0,...n},{timeout:1e6}),{refNameAliases:i}=e;if(!i)throw new Error(`error loading assembly ${e.name}'s refNameAliases`);const a=Object.fromEntries(r.map(t=>(He(t),[e.getCanonicalRefName(t),t])));return{forwardMap:a,reverseMap:Object.fromEntries(Object.entries(a).map(([e,t])=>[t,e]))}}(o,s,{...r,statusCallback:n,sequenceAdapter:i})}});return a.types.model({configuration:a.types.safeReference(e)}).volatile(()=>({error:void 0,loadingP:void 0,volatileRegions:void 0,refNameAliases:void 0,canonicalToSeqAdapterRefNames:void 0,cytobands:void 0})).views(e=>({getConf:t=>e.configuration?(0,S.FI)(e,t):void 0,get lowerCaseRefNameAliases(){return e.refNameAliases?Object.fromEntries(Object.entries(e.refNameAliases).map(([e,t])=>[e.toLowerCase(),t])):void 0}})).views(e=>({get initialized(){return e.load(),!!e.refNameAliases},get name(){return e.getConf("name")||""},get regions(){return e.load(),e.volatileRegions},get aliases(){return e.getConf("aliases")||[]},get displayName(){return e.getConf("displayName")||e.getConf("name")||""},hasName(e){return this.allAliases.includes(e)},get allAliases(){return[this.name,...this.aliases]},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get lowerCaseRefNames(){return e.lowerCaseRefNameAliases?Object.keys(e.lowerCaseRefNameAliases):void 0},get allRefNamesWithLowerCase(){return this.allRefNames&&this.lowerCaseRefNames?[...new Set([...this.allRefNames,...this.lowerCaseRefNames])]:void 0},get rpcManager(){return(0,a.getParent)(e,2).rpcManager},get refNameColors(){const t=e.getConf("refNameColors")||[];return 0===t.length?Fe:t}})).views(e=>({get refNames(){return e.regions?.map(e=>e.refName)}})).views(e=>({getCanonicalRefName(t){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[t]||e.lowerCaseRefNameAliases[t]},getCanonicalRefName2(e){return this.getCanonicalRefName(e)||e},getRefNameColor(t){if(!e.refNames)return;const n=e.refNames.indexOf(t);return-1===n?void 0:e.refNameColors[n%e.refNameColors.length]},isValidRefName(t){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(t)},getSeqAdapterRefName:t=>e.canonicalToSeqAdapterRefNames?.[t]??t})).actions(e=>({setLoaded({regions:e,refNameAliases:t,cytobands:n}){this.setRegions(e),this.setRefNameAliases(t),this.setCytobands(n)},setError(t){e.error=t},setRegions(t){e.volatileRegions=t},setRefNameAliases(t){e.refNameAliases=t},setCytobands(t){e.cytobands=t},setCanonicalToSeqAdapterRefNames(t){e.canonicalToSeqAdapterRefNames=t},setLoadingP(t){e.loadingP=t},load(){return e.loadingP||(e.loadingP=this.loadPre().catch(e=>{this.setLoadingP(void 0),this.setError(e)})),e.loadingP},async loadPre(){const n=e.configuration,s=n?.refNameAliases?.adapter,o=n?.cytobands?.adapter,r=n?.sequence.adapter,i=e.name,a=await async function({config:e,pluginManager:t,stopToken:n}){const s=t.getAdapterType(e.type);return new(await s.getAdapterClass())(e,void 0,t).getRegions({stopToken:n})}({config:r,pluginManager:t});for(const e of a)He(e.refName);const c={},l=await async function({config:e,pluginManager:t,stopToken:n}){const s=t.getAdapterType(e.type);return new(await s.getAdapterClass())(e,void 0,t).getRefNameAliases({stopToken:n})}({config:s,pluginManager:t});for(const{refName:e,aliases:t,override:n}of l){for(const n of t)He(n),c[n]=e;n&&(c[e]=e)}for(const e of a)c[e.refName]||=e.refName;const u={};for(const e of a){const t=c[e.refName]||e.refName;t!==e.refName&&(u[t]=e.refName)}this.setCanonicalToSeqAdapterRefNames(u),this.setLoaded({refNameAliases:c,regions:a.map(e=>({...e,refName:c[e.refName]||e.refName,assemblyName:i})),cytobands:await Je({config:o,pluginManager:t})})}})).views(e=>({getAdapterMapEntry(t,s){const{stopToken:o,statusCallback:r,...i}=s;if(!s.sessionId)throw new Error("sessionId is required");return n.get((0,Oe.L)(t),{adapterConf:t,self:e,options:i},void 0,r)},async getRefNameMapForAdapter(e,t){if(!t.sessionId)throw new Error("sessionId is required");return(await this.getAdapterMapEntry(e,t)).forwardMap},async getReverseRefNameMapForAdapter(e,t){return(await this.getAdapterMapEntry(e,t)).reverseMap},afterCreate(){(0,a.addDisposer)(e,(0,oe.autorun)(function(){e.allRefNamesWithLowerCase},{name:"AssemblyRefNames"}))}}))}async function Je({config:e,pluginManager:t}){const n=t.getAdapterType(e.type);return new(await n.getAdapterClass())(e,void 0,t).getData()}var Ke=n(87134),Qe=n(85396),_e=n(42126),Ze=n(25729),Xe=n(80402),Ye=n(70942),et=n(41673),tt=n(98448),nt=n(64683),st=n(34105),ot=n(22416),rt=n(30155),it=n(32911);function at({pluginManager:e}){return(0,Ce.S7)("Root",{rpc:Ue.configSchema,highResolutionScaling:{type:"number",defaultValue:2},formatDetails:(0,Ce.S7)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth to iterate the formatDetails->subfeatures callback on subfeatures (used for example to only apply the callback to the first layer of subfeatures)"},maxDepth:{type:"number",defaultValue:1e4,description:"hide subfeatures greater than a certain depth"}}),formatAbout:(0,Ce.S7)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}}),shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},disableAnalytics:{type:"boolean",defaultValue:!1},hierarchical:(0,Ce.S7)("hierarchical",{sort:(0,Ce.S7)("hierarchicalSort",{trackNames:{type:"boolean",defaultValue:!1},categories:{type:"boolean",defaultValue:!1}}),defaultCollapsed:(0,Ce.S7)("defaultCollapsed",{categoryNames:{type:"stringArray",defaultValue:[]},topLevelCategories:{type:"boolean",defaultValue:!1},subCategories:{type:"boolean",defaultValue:!1}})}),theme:{type:"frozen",defaultValue:{}},extraThemes:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}},...e.pluginConfigurationNamespacedSchemas(),...e.pluginConfigurationUnnamespacedSchemas()})}function ct(){return new Worker(new URL(n.p+n.u(6319),n.b))}window.getSnapshot=a.getSnapshot,window.resolveIdentifier=a.resolveIdentifier;const lt=(0,o.lazy)(()=>n.e(5437).then(n.bind(n,95437))),ut=(0,o.lazy)(()=>n.e(2054).then(n.bind(n,82054)));function dt({pluginManager:e,sessionModelFactory:t,adminMode:s=!1}){const o=function(e){return(0,Ce.S7)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,Ce.S7)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}),cytobands:(0,Ce.S7)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"CytobandAdapter"}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})}(e),r=function({pluginManager:e,assemblyConfigSchema:t,adminMode:n}){return a.types.snapshotProcessor(function({pluginManager:e,assemblyConfigSchema:t}){return function({pluginManager:e,assemblyConfigSchema:t}){return a.types.model("JBrowseConfig",{configuration:at({pluginManager:e}),plugins:a.types.array(a.types.frozen()),assemblies:a.types.array(t),tracks:a.types.frozen([]),internetAccounts:a.types.array(e.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:a.types.array(e.pluggableConfigSchemaType("text search adapter")),connections:a.types.array(e.pluggableConfigSchemaType("connection")),defaultSession:a.types.optional(a.types.frozen(),{name:"New Session"}),preConfiguredSessions:a.types.array(a.types.frozen()),...e.pluginConfigurationRootSchemas()})}({pluginManager:e,assemblyConfigSchema:t}).views(e=>({get assemblyNames(){return e.assemblies.map(e=>(0,S.QZ)(e,"name"))},get rpcManager(){return(0,a.getParent)(e).rpcManager}})).actions(e=>({addAssemblyConf(t){const{name:n}=t;if(!n)throw new Error('Can\'t add assembly with no "name"');if(e.assemblyNames.includes(n))throw new Error(`Can't add assembly with name "${n}", an assembly with that name already exists`);const s=e.assemblies.push({...t,sequence:{type:"ReferenceSequenceTrack",trackId:`${n}-${Date.now()}`,...t.sequence}});return e.assemblies[s-1]},removeAssemblyConf(t){const n=e.assemblies.find(e=>e.name===t);n&&e.assemblies.remove(n)},addTrackConf(t){const{type:n}=t;if(!n)throw new Error(`unknown track type ${n}`);return e.tracks=[...e.tracks,t],e.tracks.at(-1)},addConnectionConf(t){const{type:n}=t;if(!n)throw new Error(`unknown connection type ${n}`);const s=e.connections.push(t);return e.connections[s-1]},deleteConnectionConf(t){const n=e.connections.find(e=>e.id===t.id);return e.connections.remove(n)},deleteTrackConf(t){const n=t.trackId;e.tracks=e.tracks.filter(e=>e.trackId!==n)},updateTrackConf(t){const{trackId:n}=t,s=e.tracks.findIndex(e=>e.trackId===n);if(-1!==s){const n=[...e.tracks];n[s]=t,e.tracks=n}},addPlugin(t){e.plugins.push(t),(0,a.getParent)(e).setPluginsUpdated(!0)},removePlugin(t){e.plugins=(0,a.cast)(e.plugins.filter(e=>e.url!==t.url||e.umdUrl!==t.umdUrl||e.cjsUrl!==t.cjsUrl||e.esmUrl!==t.esmUrl)),(0,a.getParent)(e).setPluginsUpdated(!0)},setDefaultSessionConf(t){const n=(0,a.getParent)(e).session.name===t.name?(0,a.getSnapshot)(t):(0,oe.toJS)(t);if(!n.name)throw new Error(`unable to set default session to ${n.name}`);e.defaultSession=(0,a.cast)(n)},addInternetAccountConf(t){const{type:n}=t;if(!n)throw new Error(`unknown internetAccount type ${n}`);const s=e.internetAccounts.push(t);return e.internetAccounts[s-1]},deleteInternetAccountConf(t){const n=e.internetAccounts.find(e=>e.id===t.id);return e.internetAccounts.remove(n)}}))}({pluginManager:e,assemblyConfigSchema:t,adminMode:n}),{postProcessor:e=>(0,ce.K$)(structuredClone(e),"baseUri")})}({adminMode:s,pluginManager:e,assemblyConfigSchema:o}),i=t({pluginManager:e,assemblyConfigSchema:o});return a.types.compose(function({pluginManager:e,jbrowseModelType:t,sessionModelType:n,assemblyConfigSchema:s}){return a.types.model("BaseRootModel",{jbrowse:t,session:a.types.maybe(n),sessionPath:a.types.optional(a.types.string,""),assemblyManager:a.types.optional((o=s,r=e,a.types.model({assemblies:a.types.array(qe(o,r))}).views(e=>({get assemblyNameMap(){const t={};for(const n of e.assemblies)for(const e of n.allAliases)t[e]=n;return t}})).views(e=>({getCanonicalAssemblyName:t=>e.assemblyNameMap[t]?.name,getCanonicalAssemblyName2:t=>e.assemblyNameMap[t]?.name||t,get(t){if(t){const n=e.assemblyNameMap[t];if(n)return n;this.assemblyNamesList.includes(t)||r.evaluateExtensionPoint("Core-handleUnrecognizedAssembly",void 0,{assemblyName:t,session:(0,a.getParent)(e).session})}},get assemblyNamesList(){return this.assemblyList.map(e=>e.name)},get assemblyList(){const{jbrowse:{assemblies:t},session:{sessionAssemblies:n=[],temporaryAssemblies:s=[]}={}}=(0,a.getParent)(e);return[...t,...n,...s]},get rpcManager(){return(0,a.getParent)(e).rpcManager}})).views(e=>({async waitForAssembly(t){if(!t)throw new Error("no assembly name supplied to waitForAssembly");let n=e.get(t);if(!n)try{await(0,oe.when)(()=>Boolean(e.get(t)),{timeout:1e4}),n=e.get(t)}catch(e){}if(n){if(await n.load(),await(0,oe.when)(()=>!(!n.regions||!n.refNameAliases)||!!n.error),n.error)throw n.error;return n}},async getRefNameMapForAdapter(e,t,n){if(t){const s=await this.waitForAssembly(t);return s?.getRefNameMapForAdapter(e,n)}return{}},async getReverseRefNameMapForAdapter(e,t,n){if(t){const s=await this.waitForAssembly(t);return s?.getReverseRefNameMapForAdapter(e,n)}return{}},isValidRefName(t,n){const s=e.get(n);if(s)return s.isValidRefName(t);throw new Error(`Failed to look up refName:${t} on assemblyName:${n} (assembly does not exist)`)}})).actions(e=>({afterAttach(){(0,a.addDisposer)(e,(0,oe.reaction)(()=>e.assemblyList,t=>{for(const t of e.assemblies)t.configuration||this.removeAssembly(t);for(const n of t){const t=(0,S.QZ)(n,"name");e.assemblies.some(e=>e.name===t)||this.addAssembly(n)}},{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},removeAssembly(t){e.assemblies.remove(t)},addAssembly(t){e.assemblies.push({configuration:t})}}))),{})}).volatile(t=>({rpcManager:new Ue(e,t.jbrowse.configuration.rpc,{MainThreadRpcDriver:{}}),adminMode:!1,error:void 0,textSearchManager:new ke.A(e),pluginManager:e})).actions(e=>({setError(t){e.error=t},setSession(t){e.session=(0,a.cast)(t)},setDefaultSession(){this.setSession(e.jbrowse.defaultSession)},setSessionPath(t){e.sessionPath=t},renameCurrentSession(t){e.session&&this.setSession({...(0,a.getSnapshot)(e.session),name:t})}}));var o,r}({pluginManager:e,jbrowseModelType:r,sessionModelType:i,assemblyConfigSchema:o}),function(e){return a.types.model({internetAccounts:a.types.array(e.pluggableMstType("internet account","stateModel"))}).actions(t=>({initializeInternetAccount(n,s={}){if(!e.getInternetAccountType(n.type))throw new Error(`unknown internet account type ${n.type}`);const o=t.internetAccounts.push({...s,type:n.type,configuration:n});return t.internetAccounts[o-1]},createEphemeralInternetAccount(n,s,o){let r;try{r=new URL(o).origin}catch(e){}const i=n.split("-"),a={type:i[0],internetAccountId:n,name:i.slice(1).join("-"),description:"",domains:r?[r]:[]},c=e.getInternetAccountType(a.type).stateModel.create({...s,type:a.type,configuration:a});return t.internetAccounts.push(c),c},findAppropriateInternetAccount(e){const n=e.internetAccountId;if(n){const e=t.internetAccounts.find(e=>e.internetAccountId===n);if(e)return e}for(const n of t.internetAccounts)if(n.handlesLocation(e))return n;return n?this.createEphemeralInternetAccount(n,{},e.uri):null}})).actions(e=>({afterCreate(){(0,a.addDisposer)(e,(0,oe.autorun)(function(){const{jbrowse:t}=e;for(const n of t.internetAccounts)e.initializeInternetAccount(n)},{name:"InternetAccounts"}))}}))}(e),a.types.model({history:a.types.optional(ge,{targetPath:"../session"})}).actions(e=>{const t=t=>{e.history.canRedo&&((t.ctrlKey||t.metaKey)&&t.shiftKey&&"KeyZ"===t.code||t.ctrlKey&&!t.shiftKey&&"KeyY"===t.code)&&"INPUT"!==document.activeElement?.tagName.toUpperCase()&&e.history.redo(),e.history.canUndo&&(t.ctrlKey||t.metaKey)&&!t.shiftKey&&"KeyZ"===t.code&&"INPUT"!==document.activeElement?.tagName.toUpperCase()&&e.history.undo()};return{afterCreate(){document.addEventListener("keydown",t),(0,a.addDisposer)(e,(0,oe.autorun)(function(){const{session:t}=e;t&&e.history.initialize()},{name:"HistoryInit"}))},beforeDestroy(){document.removeEventListener("keydown",t)}}}),a.types.model({}).volatile(()=>({mutableMenuActions:[]})).actions(e=>({setMenus(t){e.mutableMenuActions=[...e.mutableMenuActions,{type:"setMenus",newMenus:t}]},appendMenu(t){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendMenu",menuName:t}]},insertMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"insertMenu",menuName:t,position:n}]},appendToMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendToMenu",menuName:t,menuItem:n}]},insertInMenu(t,n,s){e.mutableMenuActions.push({type:"insertInMenu",menuName:t,menuItem:n,position:s})},appendToSubMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendToSubMenu",menuPath:t,menuItem:n}]},insertInSubMenu(t,n,s){e.mutableMenuActions=[...e.mutableMenuActions,{type:"insertInSubMenu",menuPath:t,menuItem:n,position:s}]}}))).props({configPath:a.types.maybe(a.types.string)}).volatile(t=>({adminMode:s,sessionDB:void 0,version:"4.0.4",pluginsUpdated:!1,rpcManager:new Ue(e,t.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:ct},MainThreadRpcDriver:{}}),savedSessionMetadata:void 0,textSearchManager:new ke.A(e),error:void 0,reloadPluginManagerCallback:(e,t)=>{console.error("reloadPluginManagerCallback unimplemented")}})).actions(e=>({setSavedSessionMetadata(t){e.savedSessionMetadata=t},async fetchSessionMetadata(){if(e.sessionDB){const t=await e.sessionDB.getAll("metadata");this.setSavedSessionMetadata(t.filter(t=>t.configPath===(e.configPath||"")).sort((e,t)=>+t.createdAt-+e.createdAt))}},setSessionDB(t){e.sessionDB=t}})).actions(e=>({afterCreate(){(async()=>{if("undefined"!=typeof indexedDB)try{const t=await(0,se.P2)("sessionsDB",2,{upgrade(e){e.createObjectStore("metadata"),e.createObjectStore("sessions")}});e.setSessionDB(t),(0,a.addDisposer)(e,(0,oe.autorun)(async()=>{if(e.session)try{const n=e.session;if(e.sessionDB){if(await t.put("sessions",(0,a.getSnapshot)(n),n.id),!(0,a.isAlive)(e))return;const s=await e.sessionDB.get("metadata",n.id);await t.put("metadata",{...s,favorite:s?.favorite||!1,name:n.name,id:n.id,createdAt:new Date,configPath:e.configPath||""},n.id)}await e.fetchSessionMetadata()}catch(t){console.error(t),e.session?.notifyError(`${t}`,t)}},{delay:400}))}catch(t){console.error(t),e.session?.notifyError(`${t}`,t)}let t=!1;(0,a.addDisposer)(e,(0,oe.autorun)(()=>{if(e.session){const n=e.session,s=(0,a.getSnapshot)(n);try{sessionStorage.setItem("current",JSON.stringify({session:s,createdAt:new Date})),t&&(t=!1,n.notify("Auto-saving restored","info")),e.pluginsUpdated&&e.reloadPluginManagerCallback(structuredClone((0,a.getSnapshot)(e.jbrowse)),structuredClone(s))}catch(e){console.error(e);const s=`${e}`;t||(t=!0,s.includes("quota")?n.notifyError("Unable to auto-save session, exceeded sessionStorage quota. This may be because a very large feature was stored in session",e):n.notifyError(s,e))}}},{delay:400}))})()},setSession(t){const n=e.session;if(e.session=(0,a.cast)(t),e.session)try{(0,ce.pK)(e.session,(0,a.getType)(e.session))}catch(t){throw e.session=n,t}},setPluginsUpdated(t){e.pluginsUpdated=t},setReloadPluginManagerCallback(t){e.reloadPluginManagerCallback=t},setDefaultSession(){const{defaultSession:t}=e.jbrowse;this.setSession({...t,name:`${t.name||"New session"} ${(new Date).toLocaleString()}`})},async activateSession(t){const n=await(e.sessionDB?.get("sessions",t));n?this.setSession(n):e.session?.notifyError("Session not found")},async favoriteSavedSession(t){if(e.sessionDB){const n=e.savedSessionMetadata.find(e=>e.id===t);n&&(await e.sessionDB.put("metadata",{...n,favorite:!0},n.id),await e.fetchSessionMetadata())}},async unfavoriteSavedSession(t){if(e.sessionDB){const n=e.savedSessionMetadata.find(e=>e.id===t);n&&await e.sessionDB.put("metadata",{...n,favorite:!1},n.id),await e.fetchSessionMetadata()}},async deleteSavedSession(t){e.sessionDB&&(await e.sessionDB.delete("metadata",t),await e.sessionDB.delete("sessions",t),await e.fetchSessionMetadata())},renameCurrentSession(t){this.setSession({...(0,a.getSnapshot)(e.session),name:t})},setError(t){e.error=t}})).views(e=>({menus(){const t=(0,S.QZ)(e.jbrowse,"preConfiguredSessions");return function(e,t){for(const n of t)"setMenus"===n.type?e=n.newMenus:"appendMenu"===n.type?he({menus:e,...n}):"insertMenu"===n.type?ye({menus:e,...n}):"insertInSubMenu"===n.type?ve({menus:e,...n}):"appendToSubMenu"===n.type?Se({menus:e,...n}):"appendToMenu"===n.type?we({menus:e,...n}):"insertInMenu"===n.type&&be({menus:e,...n});return e}([{label:"File",menuItems:()=>{const s=e.savedSessionMetadata?.filter(e=>e.favorite).slice(0,5),o=e.savedSessionMetadata?.filter(e=>!e.favorite).slice(0,5);return[{label:"New session",icon:Ke.A,onClick:()=>{e.setDefaultSession()}},{label:"Import session...",icon:Ye.A,onClick:()=>{const t=e.session?.addWidget("ImportSessionWidget","importSessionWidget");t&&e.session?.showWidget(t)}},{label:"Export session",icon:Xe.A,onClick:async()=>{if(e.session){const{saveAs:t}=await n.e(9044).then(n.bind(n,99044));t(new Blob([JSON.stringify({session:(0,a.getSnapshot)(e.session)},null,2)],{type:"text/plain;charset=utf-8"}),"session.json",{autoBom:!1})}}},{label:"Duplicate session",icon:_e.A,onClick:()=>{if(e.session){const{id:t,...n}=(0,a.getSnapshot)(e.session);e.setSession(n)}}},...t?.length?[{label:"Pre-configured sessions...",subMenu:t.map(t=>({label:t.name,onClick:()=>{e.setSession(t)}}))}]:[],...s?.length?[{label:"Favorite sessions...",subMenu:[...s.slice(0,5).map(t=>({label:`${t.name} (${t.id===e.session?.id?"current":(0,it.m)(t.createdAt,{addSuffix:!0})})`,disabled:t.id===e.session?.id,icon:st.A,onClick:()=>{(async()=>{try{await e.activateSession(t.id)}catch(t){e.session?.notifyError(`${t}`,t)}})()}})),{label:"More...",icon:Ze.A,onClick:()=>{const t=e.session?.addWidget("SessionManager","sessionManager");t&&e.session?.showWidget(t)}}]}]:[],{label:"Recent sessions...",type:"subMenu",subMenu:o?.length?[...o.map(t=>({label:`${t.name} (${t.id===e.session?.id?"current":(0,it.m)(t.createdAt,{addSuffix:!0})})`,disabled:t.id===e.session?.id,onClick:()=>{(async()=>{try{await e.activateSession(t.id)}catch(t){e.session?.notifyError(`${t}`,t)}})()}})),{label:"More...",icon:Ze.A,onClick:()=>{const t=e.session?.addWidget("SessionManager","sessionManager");t&&e.session?.showWidget(t)}}]:[{label:"No autosaves found",onClick:()=>{}}]},{type:"divider"},{label:"Open track...",icon:ot.A,onClick:()=>{if(e.session)if(0===e.session.views.length)e.session.notify("Please open a view to add a track first");else{const t=e.session.addWidget("AddTrackWidget","addTrackWidget",{view:e.session.views[0].id});e.session.showWidget(t),e.session.views.length>1&&e.session.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:$e.A8,onClick:()=>{const t=e.session?.addWidget("AddConnectionWidget","addConnectionWidget");t&&e.session?.showWidget(t)}}]}},...s?[{label:"Admin",menuItems:[{label:"Set default session",onClick:()=>{e.session?.queueDialog(t=>[lt,{rootModel:e,onClose:t}])}}]}]:[],{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Undo",icon:rt.A,onClick:()=>{e.history.canUndo&&e.history.undo()}},{label:"Redo",icon:et.A,onClick:()=>{e.history.canRedo&&e.history.redo()}},{type:"divider"},{label:"Plugin store",icon:Qe.A,onClick:()=>{e.session&&e.session.showWidget(e.session.addWidget("PluginStoreWidget","pluginStoreWidget"))}},{label:"Assembly manager",icon:$e.uB,onClick:()=>{e.session?.queueDialog(t=>[Ve.m,{onClose:t,session:e.session,rootModel:e}])}},{label:"Preferences",icon:tt.A,onClick:()=>{e.session&&e.session.queueDialog(t=>[ut,{session:e.session,handleClose:t}])}},{label:"Use workspaces",icon:nt.A,type:"checkbox",checked:e.session?.useWorkspaces??!1,helpText:"Workspaces allow you to organize views into tabs and tiles. There are a variety of unique features, for instance, you can drag views between tabs or split them side-by-side. Try clicking and dragging the tab header to create a new split",onClick:()=>{e.session?.setUseWorkspaces(!e.session.useWorkspaces)}}]}],e.mutableMenuActions)}}))}var ft=n(11969);const pt=(0,o.lazy)(()=>Promise.all([n.e(9011),n.e(7258)]).then(n.bind(n,87258)));var mt=n(10525);function gt(e){return a.types.model("ReferenceManagementSessionMixin",{}).views(e=>({getReferring(t){const n=[],s=t.trackId;return(0,a.walk)((0,a.getParent)(e),e=>{if((0,a.isModelType)((0,a.getType)(e))){const o=(0,a.getMembers)(e);for(const[r,i]of Object.entries(o.properties))if((0,a.isReferenceType)(i)){const o=e[r],i=o?.trackId;(o===t||s&&i&&i===s)&&n.push({node:e,key:r})}}}),n}})).actions(e=>({removeReferring(t,n,s,o){for(const{node:r}of t){let t=!1;try{const e="open track(s)",i=(0,de.getContainingView)(r);s.push(()=>{i.hideTrack(n.trackId)}),t=!0,o[e]||(o[e]=0),o[e]+=1}catch(e){}if((0,mt.lO)(e)&&e.widgets.has(r.id)){const n="configuration editor widget(s)";(0,mt.lO)(e)&&s.push(()=>{e.hideWidget(r)}),t=!0,o[n]||(o[n]=0),o[n]+=1}if(!t)throw new Error(`Error when closing this connection, the following node is still referring to a track configuration: ${JSON.stringify((0,a.getSnapshot)(r))}`)}}}))}var ht=n(73713),yt=n(17868),wt=n(58765),bt=n(15416);var St=n(22762),vt=n(76361),kt=n(40446);const Ct=(0,o.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(9806)]).then(n.bind(n,79806)));function At({pluginManager:e,assemblyConfigSchema:t}){const n=a.types.compose("WebCoreSessionModel",a.types.compose("WebCoreSessionModelGroupA",gt(),(0,ht.X)(e),a.types.model("DialogQueueSessionMixin",{}).volatile(()=>({queueOfDialogs:[]})).views(e=>({get DialogComponent(){return e.queueOfDialogs[0]?.[0]},get DialogProps(){return e.queueOfDialogs[0]?.[1]}})).actions(e=>({removeActiveDialog(){e.queueOfDialogs=e.queueOfDialogs.slice(1)},queueDialog(t){const[n,s]=t(()=>{this.removeActiveDialog()});e.queueOfDialogs=[...e.queueOfDialogs,[n,s]]}})),a.types.model({}).volatile(()=>({sessionThemeName:(0,de.localStorageGetItem)("themeName")||"default"})).views(e=>({allThemes(){const t=e,n=(0,S.FI)(t.jbrowse,"extraThemes");return{...yt.defaultThemes,...n}},get themeName(){const{sessionThemeName:t}=e;return this.allThemes()[t]?t:"default"},get theme(){const t=e,n=(0,S.FI)(t.jbrowse,"theme"),s=this.allThemes();return(0,yt.createJBrowseTheme)(n,s,this.themeName)}})).actions(e=>({setThemeName(t){e.sessionThemeName=t},afterAttach(){(0,a.addDisposer)(e,(0,oe.autorun)(function(){(0,de.localStorageSetItem)("themeName",e.themeName)},{name:"ThemeName"}))}})),(0,wt.S)(e)),a.types.compose("WebCoreSessionModelGroupB",function(e){return function(e){return a.types.compose("TracksManagerSessionMixin",(0,bt.DH)(e),gt()).views(e=>({get tracks(){return e.jbrowse.tracks},get assemblies(){return e.jbrowse.assemblies},getTracksById(){const t="temporaryAssemblies"in e?e.temporaryAssemblies:[],n="connectionInstances"in e?e.connectionInstances:[];return Object.fromEntries([...this.tracks.map(e=>[e.trackId,e]),...this.assemblies.map(e=>[e.sequence.trackId,e.sequence]),...t.map(e=>[e.sequence.trackId,e.sequence]),...n.flatMap(e=>e.tracks.map(e=>[e.trackId,e]))])}})).actions(e=>({addTrackConf:t=>e.jbrowse.addTrackConf(t),deleteTrackConf(t){const n=[],s=e.getReferring(t);e.removeReferring(s,t,n,{});for(const e of n)e();if(e.adminMode)return e.jbrowse.deleteTrackConf(t)}}))}(e).named("SessionTracksManagerSessionMixin").props({sessionTracks:a.types.array(e.pluggableConfigSchemaType("track"))}).views(e=>({get tracks(){return[...e.sessionTracks,...e.jbrowse.tracks]}})).actions(e=>{const{addTrackConf:t,deleteTrackConf:n}=e;return{addTrackConf(n){if(e.adminMode)return t(n);const{trackId:s,type:o}=n;if(!o)throw new Error(`unknown track type ${o}`);const r=e.sessionTracks.find(e=>e.trackId===s);if(r)return r;const i=e.sessionTracks.push(n);return e.sessionTracks[i-1]},deleteTrackConf(t){const s=n(t);if(s)return s;const{trackId:o}=t,r=e.sessionTracks.findIndex(e=>e.trackId===o);return-1!==r?e.sessionTracks.splice(r,1):void 0}}}).postProcessSnapshot(e=>{if(!e)return e;const{sessionTracks:t,...n}=e;return{...n,...t?.length?{sessionTracks:t}:{}}})}(e),(s=t,a.types.model({sessionAssemblies:a.types.array(s)}).actions(e=>{const t=e;return{addSessionAssembly(e){const n=t.sessionAssemblies.find(t=>t.name===e.name);if(n)return console.warn(`Assembly ${e.name} already exists`),n;const s=t.sessionAssemblies.push(e);return t.sessionAssemblies[s-1]},addAssembly(e){t.adminMode?t.jbrowse.addAssemblyConf(e):this.addSessionAssembly(e)},removeAssembly(e){t.adminMode?t.jbrowse.removeAssemblyConf(e):this.removeSessionAssembly(e)},removeSessionAssembly(e){const n=t.sessionAssemblies.find(t=>t.name===e);n&&t.sessionAssemblies.remove(n)}}}).postProcessSnapshot(e=>{if(!e)return e;const{sessionAssemblies:t,...n}=e;return{...n,...t.length?{sessionAssemblies:t}:{}}})),function(e,t=a.types.frozen()){return a.types.model({temporaryAssemblies:a.types.array(t)}).actions(e=>{const t=e;return{addTemporaryAssembly(e){const n=t.temporaryAssemblies.find(t=>t.name===e.name);if(n)return console.warn(`Assembly ${e.name} was already existing`),n;const s=t.temporaryAssemblies.push(e);return t.temporaryAssemblies[s-1]},removeTemporaryAssembly(e){const n=t.temporaryAssemblies.find(t=>t.name===e);n&&t.temporaryAssemblies.remove(n)}}}).postProcessSnapshot(e=>{if(!e)return e;const{temporaryAssemblies:t,...n}=e;return{...n,...t.length?{temporaryAssemblies:t}:{}}})}(0,t),function(e){return a.types.compose("SessionConnectionsManagement",(0,kt.F)(e),a.types.model({sessionConnections:a.types.array(e.pluggableConfigSchemaType("connection"))})).actions(e=>{const t=e,n=t.deleteConnection,s=t.addConnectionConf;return{addConnectionConf(e){if(t.adminMode)return s(e);{const{connectionId:n,type:s}=e;if(!s)throw new Error(`unknown connection type "${s}"`);const o=t.sessionConnections.find(e=>e.connectionId===n);if(o)return o;{const n=t.sessionConnections.push(e);return t.sessionConnections[n-1]}}},deleteConnection(e){if(t.adminMode)return n(e);{const{connectionId:n}=e,s=t.sessionConnections.findIndex(e=>e.connectionId===n);return-1===s?void 0:t.sessionConnections.splice(s,1)}}}}).postProcessSnapshot(e=>{if(!e)return e;const{sessionConnections:t,...n}=e;return{...n,...t.length?{sessionConnections:t}:{}}})}(e),(0,ft.u)(),a.types.model({focusedViewId:a.types.maybe(a.types.string)}).actions(e=>({setFocusedViewId(t){e.focusedViewId=t}})),a.types.model({}).volatile(()=>({snackbarMessages:oe.observable.array()})).views(e=>({get snackbarMessageSet(){return new Map(e.snackbarMessages.map(e=>[e.message,e]))}})).actions(e=>({notify(e,t,n){this.pushSnackbarMessage(e,t,n),"info"!==t&&"success"!==t||setTimeout(()=>{this.removeSnackbarMessage(e)},5e3)},notifyError(t,n,s){this.notify(t,"error",{name:"report",onClick:()=>{e.queueDialog(e=>[pt,{onClose:e,error:n,extra:s}])}})},pushSnackbarMessage(t,n,s){!s&&e.snackbarMessageSet.has(t)||e.snackbarMessages.push({message:t,level:n,action:s})},popSnackbarMessage:()=>e.snackbarMessages.pop(),removeSnackbarMessage(t){const n=e.snackbarMessageSet.get(t);void 0!==n&&e.snackbarMessages.remove(n)}})))).props({margin:0,sessionPlugins:a.types.array(a.types.frozen())}).volatile(()=>({sessionThemeName:(0,de.localStorageGetItem)("themeName")||"default",task:void 0})).views(e=>({get tracks(){return[...e.sessionTracks,...e.jbrowse.tracks]},get root(){return(0,a.getParent)(e)},get assemblies(){return[...e.jbrowse.assemblies,...e.sessionAssemblies]},get connections(){return[...e.jbrowse.connections,...e.sessionConnections]}})).actions(e=>({setName(t){e.name=t}})).views(e=>({get assemblyNames(){return e.assemblies.map(e=>(0,S.QZ)(e,"name"))},get version(){return e.root.version},get shareURL(){return(0,S.FI)(e.jbrowse,"shareURL")},get textSearchManager(){return e.root.textSearchManager},get assemblyManager(){return e.root.assemblyManager},get savedSessionMetadata(){return e.root.savedSessionMetadata},get previousAutosaveId(){return e.root.previousAutosaveId},get history(){return e.root.history},renderProps:()=>({theme:e.theme,highResolutionScaling:(0,S.FI)(e,"highResolutionScaling")})})).actions(e=>({addAssemblyConf(t){e.jbrowse.addAssemblyConf(t)},addSessionPlugin(t){if(e.sessionPlugins.some(e=>e.name===t.name))throw new Error("session plugin cannot be installed twice");e.sessionPlugins.push(t),e.root.setPluginsUpdated(!0)},removeSessionPlugin(t){const n=t;e.sessionPlugins=(0,a.cast)(e.sessionPlugins.filter(e=>{const t=e;return t.url!==n.url||t.umdUrl!==n.umdUrl||t.cjsUrl!==n.cjsUrl||t.esmUrl!==n.esmUrl})),(0,a.getParent)(e).setPluginsUpdated(!0)},addSavedSession:t=>e.root.addSavedSession(t),deleteSavedSession:t=>e.root.deleteSavedSession(t),favoriteSavedSession:t=>e.root.favoriteSavedSession(t),unfavoriteSavedSession:t=>e.root.unfavoriteSavedSession(t),renameCurrentSession:t=>e.root.renameCurrentSession(t),duplicateCurrentSession:()=>e.root.duplicateCurrentSession(),activateSession:t=>e.root.activateSession(t),setDefaultSession:()=>e.root.setDefaultSession(),saveSessionToLocalStorage:()=>e.root.saveSessionToLocalStorage(),loadAutosaveSession:()=>e.root.loadAutosaveSession(),setSession:t=>e.root.setSession(t)})).actions(e=>({editTrackConfiguration(t){const{adminMode:n,sessionTracks:s}=e,o=t.trackId,r=s.some(e=>e.trackId===o);if(!n&&!r)throw new Error("Can't edit the configuration of a non-session track");e.editConfiguration(t)}})).views(e=>({getTrackActions(t){const{adminMode:n,sessionTracks:s}=e,o=n||s.find(e=>e.trackId===t.trackId),r="ReferenceSequenceTrack"===t.type;return[{label:"Settings",disabled:!o,icon:tt.A,onClick:()=>{e.editTrackConfiguration(t)}},{label:"Copy track",disabled:r,onClick:()=>{const n=structuredClone((0,a.isStateTreeNode)(t)?(0,a.getSnapshot)(t):t),s=Date.now();if(n.trackId+=`-${s}`,n.displays)for(const e of n.displays)e.displayId+=`-${s}`;e.adminMode||(n.trackId+="-sessionTrack",n.category=void 0),n.name+=" (copy)",e.addTrackConf(n)},icon:_e.A},{label:"Delete track",disabled:!o||r,icon:St.A,onClick:()=>{e.deleteTrackConf(t)}}]}})).views(e=>({getTrackListMenuItems:t=>[{label:"About track",onClick:()=>{e.queueDialog(n=>[Ct,{config:t,handleClose:n,session:e}])},icon:vt.A},...e.getTrackActions(t)],getTrackActionMenuItems:(t,n)=>[{label:"About track",priority:1002,onClick:()=>{e.queueDialog(n=>[Ct,{config:t,handleClose:n,session:e}])},icon:vt.A},{type:"subMenu",label:"Track actions",priority:1001,subMenu:[...e.getTrackActions(t),...n||[]]},{type:"divider"}],menus:()=>e.root.menus()})).actions(e=>({afterAttach(){(0,a.addDisposer)(e,(0,oe.autorun)(function(){(0,de.localStorageSetItem)("drawerPosition",e.drawerPosition),(0,de.localStorageSetItem)("themeName",e.themeName)},{name:"SessionLocalStorage"}))}}));var s;const o=e.evaluateExtensionPoint("Core-extendSession",n);return a.types.snapshotProcessor(o,{preProcessor(e){const{connectionInstances:t,...n}=e||{};return Array.isArray(t)?e:n}})}function Tt({pluginManager:e,assemblyConfigSchema:t}){return At({pluginManager:e,assemblyConfigSchema:t})}function Mt(e,t){const n=new ue.A([...fe.A.map(e=>({plugin:new e,metadata:{isCore:!0}})),...(e.runtimePlugins??[]).map(({plugin:e,definition:t})=>({plugin:new e,definition:t,metadata:{url:t.url}})),...(e.sessionPlugins??[]).map(({plugin:e,definition:t})=>({plugin:new e,definition:t,metadata:{url:t.url}}))]).createPluggableElements(),s=dt({pluginManager:n,sessionModelFactory:Tt,adminMode:!!e.adminKey});if(e.configSnapshot){const o=s.create({jbrowse:e.configSnapshot,configPath:e.configPath},{pluginManager:n});o.setReloadPluginManagerCallback(t),e.configSnapshot.configuration?.rpc?.defaultDriver||o.jbrowse.configuration.rpc.defaultDriver.set("WebWorkerRpcDriver");let r=()=>{};try{const{sessionError:t,sessionSpec:s,sessionSnapshot:i,hubSpec:a}=e;if(t)throw t;i?o.setSession(i):a?r=()=>async function({hubURL:e},t){const n=t.rootModel;try{const t=await fetch(e[0]);if(!t.ok)throw new Error(`HTTP ${t.status} fetching ${e[0]}`);const s=await t.text(),o=s.split("\n").find(e=>e.startsWith("shortLabel"))?.replace("shortLabel","").trim();n.setSession({name:o||e[0],sessionConnections:e.map(e=>({type:"UCSCTrackHubConnection",connectionId:e,name:e,hubTxtLocation:{uri:e,locationType:"UriLocation"}}))});const{session:r}=n;r.makeConnection(r.sessionConnections[0])}catch(e){console.error(e),n.session?.notifyError(`${e}`,e)}}(a,n):s?r=()=>me(s,n):o.setDefaultSession()}catch(t){o.setDefaultSession();const n=`${t}`.replace("[@jbrowse/mobx-state-tree] ","").replace(/\(.+/,""),s=n.length>1e3?`${n.slice(0,1e3)}...see more in console`:n,r=s.startsWith("Error:")?s:`Error: ${s}`;o.session?.notifyError(`${r}. If you received this URL from another user, request that they send you a session generated with the "Share" button instead of copying and pasting their URL`,e.sessionError,e.sessionSnapshot),console.error(t)}return function(e,t,n){e&&!(0,S.QZ)(e.jbrowse.configuration,"disableAnalytics")&&(async function(e,t,n){try{const s="https://analytics.jbrowse.org/api/v1",o=e.jbrowse.tracks.filter(e=>((0,S.QZ)(e,"assemblyNames")||[]).length>1).length,r=Object.keys(localStorage).filter(e=>e.includes("localSaved-")).length,{jbrowse:i,session:a,version:c}=e,{tracks:l,assemblies:u,plugins:d}=i,f={ver:c,"plugins-count":d?.length||0,"plugin-names":d?.map(e=>e.name).join(","),"assemblies-count":u.length,"tracks-count":l.length,"session-tracks-count":a?.sessionTracks.length||0,"open-views":a?.views.length||0,"synteny-tracks-count":o,"saved-sessions-count":r,"existing-session-param-type":n?.split("-")[0]||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:de.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0};l.forEach(e=>{const t=`track-types-${e.type}`;f[t]=f[t]+1||1}),a?.sessionTracks.forEach(e=>{const t=`sessionTrack-types-${e.type}`;f[t]=f[t]+1||1});const p=Object.keys(f).map(e=>`${e}=${f[e]}`).join("&");await fetch(`${s}?${p}`)}catch(e){console.error("Failed to write analytics to AWS.",e)}}(e,t,n),async function(e,t){const n={"tracks-count":e.jbrowse.tracks.length,ver:e.version,electron:de.isElectron,loadTime:Date.now()-t,pluginNames:e.jbrowse.plugins?.map(e=>e.name)||""};let s="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){";s+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",s+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",s+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",s+="ga('create', 'UA-7115575-5', 'auto', 'jbrowseTracker');";const o={};for(const[e,t]of"tracks-count ver electron loadTime pluginNames".split(/\s+/).entries())o[`dimension${e+1}`]=n[t];o.metric1=Math.round(n.loadTime),s+=`ga('jbrowseTracker.send', 'pageview',${JSON.stringify(o)});`;const r=document.createElement("script");r.innerHTML=s,document.getElementsByTagName("head")[0].append(r)}(e,t))}(o,e.initialTimestamp,e.sessionQuery),n.setRootModel(o),n.configure(),r(),n}}var Nt=n(84250);const Pt=(0,o.lazy)(()=>n.e(5874).then(n.bind(n,5874))),It=(0,o.lazy)(()=>n.e(9366).then(n.bind(n,49366))),xt=["loc","tracks","assembly","password","sessionTracks","hubURL","tracklist","nav","highlight"];function Et(e){const t=(0,s.c)(7),{initialTimestamp:n}=e;let r;t[0]!==n?(r=()=>n??Date.now(),t[0]=n,t[1]=r):r=t[1];const[i]=(0,o.useState)(r);let a;t[2]!==i?(a=()=>{const{config:e,session:t,adminKey:n,password:s,loc:o,assembly:r,tracks:a,sessionTracks:c,tracklist:l,highlight:u,nav:d,hubURL:f}=(0,_.BW)(["config","session","adminKey","password","loc","assembly","tracks","sessionTracks","tracklist","highlight","nav","hubURL"]);return le.create({configPath:e,sessionQuery:t,password:s,adminKey:n,loc:o,assembly:r,tracks:a,sessionTracks:c,tracklist:JSON.parse(l||"false"),highlight:u,nav:JSON.parse(d||"true"),hubURL:f?.split(","),initialTimestamp:i})},t[2]=i,t[3]=a):a=t[3];const[c]=(0,o.useState)(a);let u,d;return t[4]===Symbol.for("react.memo_cache_sentinel")?(u=[],t[4]=u):u=t[4],(0,o.useEffect)(Rt,u),t[5]!==c?(d=(0,l.jsx)(jt,{loader:c}),t[5]=c,t[6]=d):d=t[6],d}function Rt(){(0,_.oP)([...xt])}const jt=(0,c.observer)(function({loader:e}){const[t,n]=(0,o.useState)(e),s=(0,o.useRef)(void 0),[r,i]=(0,o.useState)(!1),c=(0,o.useCallback)((e,s)=>{const o=le.create({configPath:t.configPath,sessionQuery:t.sessionQuery,password:t.password,adminKey:t.adminKey,loc:t.loc,assembly:t.assembly,tracks:t.tracks,sessionTracks:t.sessionTracks,tracklist:t.tracklist,highlight:t.highlight,nav:t.nav,hubURL:t.hubURL,initialTimestamp:Date.now(),configSnapshot:e,sessionSnapshot:s});n(o),i(!1)},[t]),{configError:u,ready:d,sessionTriaged:f}=t,[p,m]=(0,o.useState)();(0,o.useEffect)(()=>{const e="undefined"!=typeof jest;if(d)try{s.current?.rootModel&&!e&&(0,a.destroy)(s.current.rootModel),s.current=Mt(t,c),i(!0)}catch(e){console.error(e),m(e)}return()=>{if(s.current?.rootModel&&!e){const e=s.current.rootModel.session;e&&(0,a.isAlive)(e)&&t.setSessionSnapshot((0,a.getSnapshot)(e)),(0,a.destroy)(s.current.rootModel)}}},[d,t,c]);const g=u||p;return g?(0,l.jsx)(o.Suspense,{fallback:null,children:(0,l.jsx)(It,{error:g})}):f?(0,l.jsx)(Pt,{loader:t,sessionTriaged:f}):r&&s.current?(0,l.jsx)(X,{pluginManager:s.current}):(0,l.jsx)(Y.A,{})});function Dt(e){return(0,l.jsx)(r.A,{...e,resetButtonText:"Reset Session",onFactoryReset:Nt.A})}const Wt=function(e){const t=(0,s.c)(2),{initialTimestamp:n}=e;let o;return t[0]!==n?(o=(0,l.jsx)(i.t,{FallbackComponent:Dt,children:(0,l.jsx)(Et,{initialTimestamp:n})}),t[0]=n,t[1]=o):o=t[1],o}},11969(e,t,n){n.d(t,{N:()=>r,u:()=>o});var s=n(99226);function o(){return s.types.model({dockviewLayout:s.types.maybe(s.types.frozen()),panelViewAssignments:s.types.optional(s.types.map(s.types.array(s.types.string)),{}),init:s.types.frozen(),activePanelId:s.types.maybe(s.types.string)}).views(e=>({getViewIdsForPanel:t=>e.panelViewAssignments.get(t)??[]})).actions(e=>({setDockviewLayout(t){e.dockviewLayout=t},setActivePanelId(t){e.activePanelId=t},setInit(t){e.init=t},assignViewToPanel(t,n){const s=e.panelViewAssignments.get(t);s?s.includes(n)||s.push(n):e.panelViewAssignments.set(t,[n])},removeViewFromPanel(t){for(const[n,s]of e.panelViewAssignments.entries()){const o=s.indexOf(t);if(-1!==o){s.splice(o,1),0===s.length&&e.panelViewAssignments.delete(n);break}}},removePanel(t){e.panelViewAssignments.delete(t)},moveViewUpInPanel(t){for(const n of e.panelViewAssignments.values()){const e=n.indexOf(t);if(e>0){const t=n[e-1];n[e-1]=n[e],n[e]=t;break}}},moveViewDownInPanel(t){for(const n of e.panelViewAssignments.values()){const e=n.indexOf(t);if(-1!==e&&e<n.length-1){const t=n[e+1];n[e+1]=n[e],n[e]=t;break}}},moveViewToTopInPanel(t){for(const n of e.panelViewAssignments.values()){const e=n.indexOf(t);if(e>0){n.splice(e,1),n.unshift(t);break}}},moveViewToBottomInPanel(t){for(const n of e.panelViewAssignments.values()){const e=n.indexOf(t);if(-1!==e&&e<n.length-1){n.splice(e,1),n.push(t);break}}}})).postProcessSnapshot(e=>{if(!e)return e;const{dockviewLayout:t,panelViewAssignments:n,init:s,activePanelId:o,...r}=e;return{...r,...void 0!==t?{dockviewLayout:t}:{},...n&&Object.keys(n).length?{panelViewAssignments:n}:{},...void 0!==o?{activePanelId:o}:{}}})}function r(e){return"dockviewLayout"in e&&"setDockviewLayout"in e}},15416(e,t,n){n.d(t,{DH:()=>r,qk:()=>i});var s=n(27868),o=n(99226);function r(e){return o.types.model({id:s.K,name:o.types.string,margin:0}).volatile(()=>({selection:void 0,hovered:void 0})).views(e=>({get root(){return(0,o.getParent)(e)}})).views(e=>({get jbrowse(){return e.root.jbrowse},get rpcManager(){return e.root.rpcManager},get configuration(){return this.jbrowse.configuration},get adminMode(){return e.root.adminMode},get textSearchManager(){return e.root.textSearchManager}})).views(e=>({get assemblies(){return e.jbrowse.assemblies}})).actions(e=>({setSelection(t){e.selection=t},clearSelection(){e.selection=void 0},setHovered(t){e.hovered=t}})).postProcessSnapshot(e=>{if(!e)return e;const{margin:t,...n}=e;return{...n,...t?{margin:t}:{}}})}function i(e){return"id"in e&&"name"in e&&"root"in e}},20616(e,t,n){n.d(t,{Ay:()=>p,Cx:()=>l,Hm:()=>f,Nz:()=>u,lc:()=>d,rE:()=>c});var s=n(57397),o=n.n(s),r=n(54351),i=n(28874),a=n(77251);function c(e){return(void 0!==e.umdUrl||void 0!==e.url||void 0!==e.umdLoc)&&void 0!==e.name}function l(e){return void 0!==e.esmUrl||void 0!==e.esmLoc}function u(e){return void 0!==e.cjsUrl}function d(e){return c(e)?`UMD plugin ${e.name}`:l(e)?`ESM plugin ${e.esmUrl||e.esmLoc.uri}`:u(e)?`CJS plugin ${e.cjsUrl}`:"unknown plugin"}function f(e){return c(e)?e.url??e.umdLoc?.uri??e.umdUrl:l(e)?e.esmUrl??e.esmUri??e.esmLoc?.uri:u(e)?e.cjsUrl||e.cjsLoc.uri:"unknown url"}class p{definitions=[];constructor(e=[],t){this.fetchESM=t?.fetchESM,this.fetchCJS=t?.fetchCJS,this.definitions=JSON.parse(JSON.stringify(e))}async loadCJSPlugin(e,t){const n=new URL(e.cjsUrl,t);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`Cannot load plugins using protocol "${n.protocol}"`);if(!this.fetchCJS)throw new Error("No fetchCJS callback provided");return this.fetchCJS(n.href)}async loadESMPlugin(e,t){const n="esmUrl"in e?new URL(e.esmUrl,t):new URL(e.esmLoc.uri,e.esmLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`cannot load plugins using protocol "${n.protocol}"`);if(!this.fetchESM)throw new Error("No ESM fetcher installed");const s=await this.fetchESM(n.href);if(!s)throw new Error(`Could not load ESM plugin: ${n}`);return s}async loadUMDPlugin(e,t){const n="url"in e?new URL(e.url,t):"umdUrl"in e?new URL(e.umdUrl,t):new URL(e.umdLoc.uri,e.umdLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`cannot load plugins using protocol "${n.protocol}"`);const s=e.name,i=`JBrowsePlugin${s}`;"undefined"==typeof jest?await async function(e){if(!("WorkerGlobalScope"in globalThis))return t=e,new Promise((e,n)=>{o()(t,(t,s)=>{t?n(t):e(s.src)})});var t;if(!globalThis.importScripts)throw new Error("cannot figure out how to load external JS scripts in this environment");await globalThis.importScripts(e)}(n.href):globalThis[i]={default:r.A};const a=globalThis[i];if(!a)throw new Error(`Failed to load UMD bundle for ${s}, ${i} is undefined`);return a}async loadPlugin(e,t){let n;if(a.isElectron&&u(e))n=await this.loadCJSPlugin(e,t);else if(l(e))n=await this.loadESMPlugin(e,t);else{if(!c(e))throw!a.isElectron&&u(e)?new Error(`CommonJS plugin found, but not in a NodeJS environment: ${JSON.stringify(e)}`):new Error(`Could not determine plugin type: ${JSON.stringify(e)}`);n=await this.loadUMDPlugin(e,t)}if(!n.default)throw new Error(`${d(e)} does not have a default export, cannot load`);return n.default}installGlobalReExports(e){return e.JBrowseExports=Object.fromEntries(Object.entries(i.A).map(([e,t])=>[e,t])),this}async load(e){return Promise.all(this.definitions.map(async t=>({plugin:await this.loadPlugin(t,e),definition:t})))}}},37777(e,t,n){function s(){return new URLSearchParams(window.location.search)}function o(e){const t=e.toString(),n=t?`${window.location.pathname}?${t}`:window.location.pathname;window.history.replaceState(null,"",n)}function r(e){const t=s(),n={};for(const s of e)n[s]=t.get(s)??void 0;return n}function i(e){const t=s();for(const n of e)t.delete(n);o(t)}function a(e){const t=s();for(const[n,s]of Object.entries(e))void 0===s?t.delete(n):t.set(n,s);o(t)}n.d(t,{BW:()=>r,dR:()=>a,oP:()=>i}),n(30936),n(42918)},40446(e,t,n){n.d(t,{F:()=>i,M:()=>a});var s=n(11259),o=n(99226),r=n(15416);function i(e){return o.types.model({connectionInstances:o.types.array(e.pluggableMstType("connection","stateModel"))}).views(e=>({get connections(){const{jbrowse:t}=e;return t.connections}})).actions(t=>({makeConnection(n,o={}){const r=n.type;if(!r)throw new Error("track configuration has no `type` listed");const i=(0,s.QZ)(n,"name");if(!e.getConnectionType(r))throw new Error(`unknown connection type ${r}`);const a=t.connectionInstances.push({...o,name:i,type:r,configuration:n});return t.connectionInstances[a-1]},prepareToBreakConnection(e){const n=t,o=[],r={},i=(0,s.QZ)(e,"name"),a=t.connectionInstances.find(e=>e.name===i);if(a){for(const e of a.tracks){const t=n.getReferring(e);n.removeReferring(t,e,o,r)}return[()=>{for(const e of o)e();this.breakConnection(e)},r]}},breakConnection(e){const n=(0,s.QZ)(e,"name"),o=t.connectionInstances.find(e=>e.name===n);if(!o)throw new Error(`no connection found with name ${n}`);t.connectionInstances.remove(o)},deleteConnection(e){const{jbrowse:n}=t;return n.deleteConnectionConf(e)},addConnectionConf(e){const{jbrowse:n}=t;return n.addConnectionConf(e)},clearConnections(){t.connectionInstances.clear()}})).postProcessSnapshot(e=>{if(!e)return e;const{connectionInstances:t,...n}=e;return{...n,...t?.length?{connectionInstances:t}:{}}})}function a(e){return(0,r.qk)(e)&&"connectionInstances"in e}},48991(e,t,n){n.d(t,{K$:()=>l,LP:()=>o,Vr:()=>c,XE:()=>a,eW:()=>r,pK:()=>i});var s=n(99226);async function o(e){const t=function(e){let t=0;switch(e.length%4){case 3:t=1;break;case 2:t=2;break;case 0:t=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(t)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:s}=await n.e(3084).then(n.t.bind(n,93084,19)),{inflate:o}=await n.e(8068).then(n.bind(n,18068)),r=o(s(t),void 0);return new TextDecoder("utf8").decode(r)}async function r(e){const t=(new TextEncoder).encode(e),{deflate:s}=await n.e(8068).then(n.bind(n,18068)),{fromByteArray:o}=await n.e(3084).then(n.t.bind(n,93084,19)),r=o(s(t,void 0)),i=r.indexOf("=");return i>0?r.slice(0,i).replaceAll("+","-").replaceAll("/","_"):r.replaceAll("+","-").replaceAll("/","_")}function i(e,t){if(void 0!==e)if((0,s.isArrayType)(t)){const t=e,n=(0,s.getChildType)(e);if((0,s.isReferenceType)(n))for(let e=0;e<t.length;)(0,s.isValidReference)(()=>t[e])?e+=1:t.splice(e,1);t.forEach(e=>{i(e,n)})}else if((0,s.isMapType)(t)){const t=e,n=(0,s.getChildType)(t);if((0,s.isReferenceType)(n))for(const e in t.keys())(0,s.isValidReference)(()=>t.get(e))||t.delete(e);t.forEach(e=>{i(e,n)})}else if((0,s.isModelType)(t)){const{properties:t}=(0,s.getPropertyMembers)(e);Object.entries(t).forEach(([t,n])=>{i(e[t],n)})}}function a(e,t){if("object"==typeof e&&null!==e)for(const n of Object.keys(e))"object"==typeof e[n]&&null!==e[n]?a(e[n],t):"uri"===n&&(e.baseUri=e.baseUri??t.href)}function c({configuration:e},t,n){return e?.[t]||n}function l(e,t){for(const n in e)n===t?delete e[n]:"object"==typeof e[n]&&l(e[n],t);return e}},50172(e,t,n){n.d(t,{A:()=>f,m:()=>d});var s=n(42918),o=n(54351),r=n(67930),i=n(11163),a=n(92905),c=n(7668),l=n(26911),u=n(35986);const d=(0,s.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8507),n.e(9479)]).then(n.bind(n,3073)));class f extends o.A{name="DataManagementPlugin";exports={AssemblyManager:d};install(e){(0,u.A)(e),(0,c.A)(e),(0,i.A)(e),(0,a.Ay)(e),(0,r.A)(e),(0,l.A)(e)}configure(e){}}},50271(e,t,n){n.d(t,{J:()=>r,Z:()=>i});var s=n(48991);function o(e){try{return JSON.parse(e).message}catch(t){return e}}async function r(e,t,r){const i=await(0,s.eW)(JSON.stringify(e)),a=window.btoa([...window.crypto.getRandomValues(new Uint8Array(10))].map(e=>String.fromCharCode(e)).join("")).replaceAll(/[+/]/g,"").slice(0,5);const c=await(async(e,t)=>(await Promise.all([n.e(6716),n.e(6216),n.e(7167)]).then(n.t.bind(n,86216,23))).encrypt(e,t).toString())(i,a),l=new FormData;l.append("session",c),l.append("dateShared",`${Date.now()}`),l.append("referer",r);const u=await fetch(`${t}share`,{method:"POST",mode:"cors",body:l});if(!u.ok){const e=await u.text();throw new Error(o(e))}return{json:await u.json(),encryptedSession:c,password:a}}async function i(e,t,s,r){const i=t.split("share-")[1],a=`${e}?sessionId=${encodeURIComponent(i)}`,c=await fetch(a,{signal:r});if(!c.ok){const e=await c.text();throw new Error(o(e))}return(async(e,t)=>{const s=await Promise.all([n.e(6716),n.e(6216),n.e(7167)]).then(n.t.bind(n,86216,23)),o=await Promise.all([n.e(6716),n.e(4721)]).then(n.t.bind(n,81335,23));return s.decrypt(e,t).toString(o)})((await c.json()).session,s)}},58693(e,t,n){n.d(t,{A8:()=>l,jT:()=>i,uB:()=>c,xU:()=>a});var s=n(30936),o=n(27159),r=n(32118);function i(e){const t=(0,s.c)(3);let n,i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsx)("path",{d:"M19.31 18.9L22.39 22L21 23.39L17.88 20.32C17.19 20.75 16.37 21 15.5 21C13 21 11 19 11 16.5C11 14 13 12 15.5 12C18 12 20 14 20 16.5C20 17.38 19.75 18.21 19.31 18.9M15.5 19C16.88 19 18 17.88 18 16.5C18 15.12 16.88 14 15.5 14C14.12 14 13 15.12 13 16.5C13 17.88 14.12 19 15.5 19M21 4V6H3V4H21M3 16V14H9V16H3M3 11V9H21V11H18.97C17.96 10.37 16.77 10 15.5 10C14.23 10 13.04 10.37 12.03 11H3Z"}),t[0]=n):n=t[0],t[1]!==e?(i=(0,r.jsx)(o.A,{...e,children:n}),t[1]=e,t[2]=i):i=t[2],i}function a(e){const t=(0,s.c)(3);let n,i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsx)("path",{d:"M21 19v-2H8v2h13m0-6v-2H8v2h13M8 7h13V5H8v2M4 5v2h2V5H4M3 5a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"}),t[0]=n):n=t[0],t[1]!==e?(i=(0,r.jsx)(o.A,{...e,children:n}),t[1]=e,t[2]=i):i=t[2],i}function c(e){const t=(0,s.c)(3);let n,i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsx)("path",{fill:"currentColor",d:"M4,2H6V4C6,5.44 6.68,6.61 7.88,7.78C8.74,8.61 9.89,9.41 11.09,10.2L9.26,11.39C8.27,10.72 7.31,10 6.5,9.21C5.07,7.82 4,6.1 4,4V2M18,2H20V4C20,6.1 18.93,7.82 17.5,9.21C16.09,10.59 14.29,11.73 12.54,12.84C10.79,13.96 9.09,15.05 7.88,16.22C6.68,17.39 6,18.56 6,20V22H4V20C4,17.9 5.07,16.18 6.5,14.79C7.91,13.41 9.71,12.27 11.46,11.16C13.21,10.04 14.91,8.95 16.12,7.78C17.32,6.61 18,5.44 18,4V2M14.74,12.61C15.73,13.28 16.69,14 17.5,14.79C18.93,16.18 20,17.9 20,20V22H18V20C18,18.56 17.32,17.39 16.12,16.22C15.26,15.39 14.11,14.59 12.91,13.8L14.74,12.61M7,3H17V4L16.94,4.5H7.06L7,4V3M7.68,6H16.32C16.08,6.34 15.8,6.69 15.42,7.06L14.91,7.5H9.07L8.58,7.06C8.2,6.69 7.92,6.34 7.68,6M9.09,16.5H14.93L15.42,16.94C15.8,17.31 16.08,17.66 16.32,18H7.68C7.92,17.66 8.2,17.31 8.58,16.94L9.09,16.5M7.06,19.5H16.94L17,20V21H7V20L7.06,19.5Z"}),t[0]=n):n=t[0],t[1]!==e?(i=(0,r.jsx)(o.A,{...e,children:n}),t[1]=e,t[2]=i):i=t[2],i}function l(e){const t=(0,s.c)(3);let n,i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,r.jsx)("path",{d:"M20 5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v1h-1v4c0 .55.45 1 1 1h1v7c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-2.21-1.79-4-4-4S5 4.79 5 7v7H4c-.55 0-1 .45-1 1v4h1v1c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-1h1v-4c0-.55-.45-1-1-1H7V7c0-1.1.9-2 2-2s2 .9 2 2v10c0 2.21 1.79 4 4 4s4-1.79 4-4v-7h1c.55 0 1-.45 1-1V5h-1z"}),t[0]=n):n=t[0],t[1]!==e?(i=(0,r.jsx)(o.A,{...e,children:n}),t[1]=e,t[2]=i):i=t[2],i}},58765(e,t,n){n.d(t,{S:()=>c,X:()=>l});var s=n(77251),o=n(99226),r=n(38567),i=n(15416),a=n(73713);function c(e){return o.types.compose((0,i.DH)(e),(0,a.X)(e),o.types.model({views:o.types.array(e.pluggableMstType("view","stateModel")),stickyViewHeaders:o.types.optional(o.types.boolean,()=>(0,s.localStorageGetBoolean)("stickyViewHeaders",!0)),useWorkspaces:o.types.optional(o.types.boolean,()=>(0,s.localStorageGetBoolean)("useWorkspaces",!1))})).actions(t=>({moveViewDown(e){const n=t.views.findIndex(t=>t.id===e);-1!==n&&n<t.views.length-1&&t.views.splice(n,2,t.views[n+1],t.views[n])},moveViewUp(e){const n=t.views.findIndex(t=>t.id===e);n>0&&t.views.splice(n-1,2,t.views[n],t.views[n-1])},moveViewToTop(e){const n=t.views.findIndex(t=>t.id===e);t.views=(0,o.cast)([t.views[n],...t.views.filter(t=>t.id!==e)])},moveViewToBottom(e){const n=t.views.findIndex(t=>t.id===e);t.views=(0,o.cast)([...t.views.filter(t=>t.id!==e),t.views[n]])},addView(n,s={}){if(!e.getElementType("view",n))throw new Error(`unknown view type ${n}`);const o=t.views.push({...s,type:n});return t.views[o-1]},removeView(e){for(const[,n]of t.activeWidgets)n.view?.id===e.id&&t.hideWidget(n);t.views.remove(e)},setStickyViewHeaders(e){t.stickyViewHeaders=e},setUseWorkspaces(e){t.useWorkspaces=e},afterAttach(){(0,o.addDisposer)(t,(0,r.autorun)(function(){(0,s.localStorageSetBoolean)("stickyViewHeaders",t.stickyViewHeaders)},{name:"StickyViewHeaders"})),(0,o.addDisposer)(t,(0,r.autorun)(function(){(0,s.localStorageSetBoolean)("useWorkspaces",t.useWorkspaces)},{name:"UseWorkspaces"}))}})).postProcessSnapshot(e=>{if(!e)return e;const{stickyViewHeaders:t,useWorkspaces:n,...s}=e;return{...s,...t?{}:{stickyViewHeaders:t},...n?{useWorkspaces:n}:{}}})}function l(e){return(0,i.qk)(e)&&"views"in e}},73713(e,t,n){n.d(t,{X:()=>a});var s=n(11259),o=n(77251),r=n(99226),i=n(38567);function a(e){const t=e.pluggableMstType("widget","stateModel");return r.types.model({drawerPosition:r.types.optional(r.types.string,()=>(0,o.localStorageGetItem)("drawerPosition")||"right"),drawerWidth:r.types.optional(r.types.refinement(r.types.integer,e=>e>=128),384),widgets:r.types.map(t),activeWidgets:r.types.map(r.types.safeReference(t)),minimized:r.types.optional(r.types.boolean,!1)}).views(e=>({get visibleWidget(){if((0,r.isAlive)(e))return[...e.activeWidgets.values()][e.activeWidgets.size-1]}})).actions(t=>({setDrawerPosition(e){t.drawerPosition=e,localStorage.setItem("drawerPosition",e)},updateDrawerWidth(e){if(e===t.drawerWidth)return t.drawerWidth;let n=e;return n<128&&(n=128),t.drawerWidth=n,n},resizeDrawer(e){"left"===t.drawerPosition&&(e*=-1);const n=t.drawerWidth;return n-this.updateDrawerWidth(n-e)},addWidget(n,s,o={},r){if(!e.getElementType("widget",n))throw new Error(`unknown widget type ${n}`);const i={...o,id:s,type:n,configuration:r||{type:n}};return t.widgets.set(s,i),t.widgets.get(s)},showWidget(e){t.activeWidgets.has(e.id)&&t.activeWidgets.delete(e.id),t.activeWidgets.set(e.id,e),t.minimized=!1},hasWidget:e=>t.activeWidgets.has(e.id),hideWidget(e){t.activeWidgets.delete(e.id)},minimizeWidgetDrawer(){t.minimized=!0},showWidgetDrawer(){t.minimized=!1},hideAllWidgets(){t.activeWidgets.clear()},editConfiguration(n){let o;if((0,r.isStateTreeNode)(n)&&(0,s.wo)(n))o=n;else{if(!("trackId"in n))throw new Error("must pass a configuration model or frozen config with trackId to editConfiguration");o=e.pluggableConfigSchemaType("track").create(n,(0,r.getEnv)(t))}const i=this.addWidget("ConfigurationEditorWidget","configEditor",{});i.setTarget(o),this.showWidget(i)},afterAttach(){(0,r.addDisposer)(t,(0,i.autorun)(function(){(0,o.localStorageSetItem)("drawerPosition",t.drawerPosition)},{name:"DrawerPosition"}))}})).postProcessSnapshot(e=>{if(!e)return e;const{drawerPosition:t,drawerWidth:n,widgets:s,activeWidgets:o,minimized:r,...i}=e;return{...i,..."right"!==t?{drawerPosition:t}:{},...384!==n?{drawerWidth:n}:{},...Object.keys(s??{}).length?{widgets:s}:{},...Object.keys(o??{}).length?{activeWidgets:o}:{},...r?{minimized:r}:{}}})}},77251(e,t,n){n.r(t),n.d(t,{AuthNeededError:()=>m._u,ReactRendering:()=>b.aE,RetryError:()=>m.J_,SimpleFeature:()=>v.A,TextSearchManager:()=>m.rz,UNKNOWN:()=>T.UNKNOWN,UNSUPPORTED:()=>T.UNSUPPORTED,abortBreakPoint:()=>A.Yo,assembleLocString:()=>B,assembleLocStringFast:()=>O,avg:()=>Je,blobToDataURL:()=>k.y,bpSpanPx:()=>Y,bpToPx:()=>H,bytesForRegions:()=>Ne,calculateLayoutBounds:()=>ee,cartesianToPolar:()=>Z,checkAbortSignal:()=>A.pB,checkStopToken:()=>p.SW,checkStopToken2:()=>p.As,clamp:()=>F,coarseStripHTML:()=>u.Z,collectTransferables:()=>w.XY,compareLocStrings:()=>z,compareLocs:()=>G,complement:()=>me,complementTable:()=>de,createCanvas:()=>w.Nw,createImageBitmap:()=>w.T9,createStopToken:()=>p.y5,createStopTokenChecker:()=>p.jL,dedupe:()=>y.Q,defaultCodonTable:()=>ve,defaultStarts:()=>be,defaultStops:()=>Se,degToRad:()=>Q,doesIntersect2:()=>h.R6,drawImageOntoCanvasContext:()=>w.pv,featureSpanPx:()=>X,fetchAndMaybeUnzip:()=>st,fetchAndMaybeUnzipText:()=>ot,findLast:()=>se,findLastIndex:()=>ne,findParentThat:()=>j,findParentThatIs:()=>W,forEachWithStopTokenCheck:()=>p.ib,gatherOverlaps:()=>Ze,generateCodonTable:()=>ke,generateUnknownTrackConf:()=>T.generateUnknownTrackConf,generateUnsupportedTrackConf:()=>T.generateUnsupportedTrackConf,getBlob:()=>T.getBlob,getBlobMap:()=>T.getBlobMap,getBpDisplayStr:()=>Ie,getConfAssemblyNames:()=>T.getConfAssemblyNames,getContainingDisplay:()=>V,getContainingTrack:()=>$,getContainingView:()=>U,getEnv:()=>Oe,getFileName:()=>T.getFileName,getFillProps:()=>et,getFrame:()=>we,getLayoutId:()=>De,getParentRenderProps:()=>T.getParentRenderProps,getProgressDisplayStr:()=>Ee,getRpcSessionId:()=>T.getRpcSessionId,getSerializedSvg:()=>b.Jy,getSession:()=>L,getStatsId:()=>We,getStr:()=>$e,getStrokeProps:()=>Ye,getTickDisplayStr:()=>je,getTrackAssemblyNames:()=>T.getTrackAssemblyNames,getTrackName:()=>T.getTrackName,getUriLink:()=>Ue,groupBy:()=>Ke,guessAdapter:()=>T.guessAdapter,guessTrackType:()=>T.guessTrackType,hashCode:()=>Te,hideTrackGeneric:()=>T.hideTrackGeneric,intersection2:()=>h.ky,isAbortException:()=>A.Kp,isAbstractMenuManager:()=>m.Nh,isAppRootModel:()=>m.bV,isAuthNeededException:()=>m.ZL,isBlobLocation:()=>m.rF,isContainedWithin:()=>h.Xx,isDetachedBuffer:()=>w.pc,isDisplayModel:()=>m.Uy,isElectron:()=>ue,isFeature:()=>v.l,isGzip:()=>nt,isImageBitmap:()=>w.Fw,isLocalPathLocation:()=>m.EV,isObject:()=>rt,isRetryException:()=>m.yH,isRootModelWithInternetAccounts:()=>m.lL,isRpcResult:()=>S.N,isSelectionContainer:()=>m.mY,isSessionModel:()=>m.Y$,isSessionModelWithConfigEditing:()=>m.u3,isSessionModelWithConnectionEditing:()=>m.gx,isSessionModelWithConnections:()=>m.BY,isSessionModelWithWidgets:()=>m.lO,isSessionWithAddTracks:()=>m.QW,isSessionWithSessionPlugins:()=>m.zA,isSessionWithShareURL:()=>m.xv,isSupportedIndexingAdapter:()=>Pe,isTrackModel:()=>m.xU,isTrackViewModel:()=>m.EO,isUriLocation:()=>m.C1,isViewContainer:()=>m.DW,isViewModel:()=>m.Tl,iterMap:()=>te,linkify:()=>Ve,localStorageGetBoolean:()=>at,localStorageGetItem:()=>Ge,localStorageGetNumber:()=>it,localStorageSetBoolean:()=>ct,localStorageSetItem:()=>ze,makeAbortError:()=>A.zm,makeAbortableReaction:()=>C.I,makeIndex:()=>T.makeIndex,makeIndexType:()=>T.makeIndexType,max:()=>Fe,measureGridWidth:()=>Be,measureText:()=>ye,mergeIntervals:()=>_e,min:()=>He,minmax:()=>ie,notEmpty:()=>Qe,objectHash:()=>Me,observeAbortSignal:()=>A.R1,parseLocString:()=>f.f,parseLocStringOneBased:()=>f.m,polarToCartesian:()=>_,rIC:()=>ge,radToDeg:()=>K,reducePrecision:()=>xe,renameRegionIfNeeded:()=>oe,renameRegionsIfNeeded:()=>re,renderToAbstractCanvas:()=>b.u1,renderToStaticMarkup:()=>tt,renderingToSvg:()=>b.MD,revcom:()=>fe,reverse:()=>pe,setBlobMap:()=>T.setBlobMap,shorten:()=>ae,shorten2:()=>ce,showTrackGeneric:()=>T.showTrackGeneric,springAnimate:()=>D,stopStopToken:()=>p.CF,storeBlobLocation:()=>T.storeBlobLocation,stringify:()=>le,stripAlpha:()=>Xe,sum:()=>qe,testAdapter:()=>lt,toLocale:()=>Re,toggleTrackGeneric:()=>T.toggleTrackGeneric,updateStatus:()=>Ce,updateStatus2:()=>Ae,useDebounce:()=>x,useDebouncedCallback:()=>R,useLocalStorage:()=>Le,useWidthSetter:()=>E,when:()=>g.z});var s=n(30936),o=n(42918),r=n(20961),i=n(38282),a=n(99226),c=n(12205),l=n(10998),u=n(14227),d=n(19598),f=n(53504),p=n(52901),m=n(10525),g=n(19183),h=n(25978),y=n(61132),w=n(53205),b=n(28423),S=n(62492),v=n(53155),k=n(84708),C=n(58836),A=n(8201),T=n(70203);const M=new WeakMap,N=new WeakMap,P=new WeakMap,I=new WeakMap;function x(e,t){const n=(0,s.c)(4),[r,i]=(0,o.useState)(e);let a,c;return n[0]!==t||n[1]!==e?(a=()=>{const n=setTimeout(()=>{i(e)},t);return()=>{clearTimeout(n)}},c=[e,t],n[0]=t,n[1]=e,n[2]=a,n[3]=c):(a=n[2],c=n[3]),(0,o.useEffect)(a,c),r}function E(e,t){const n=(0,s.c)(7),[r,c]=(0,i.A)(),{width:l}=c;let u,d;return n[0]!==e||n[1]!==l?(u=()=>{let t;return l&&(0,a.isAlive)(e)&&(t=requestAnimationFrame(()=>{e.setWidth(l)})),()=>{t&&cancelAnimationFrame(t)}},n[0]=e,n[1]=l,n[2]=u):u=n[2],n[3]!==t||n[4]!==e||n[5]!==l?(d=[t,e,l],n[3]=t,n[4]=e,n[5]=l,n[6]=d):d=n[6],(0,o.useEffect)(u,d),r}function R(e,t){const n=(0,s.c)(5),r=void 0===t?400:t,i=(0,o.useRef)(null),a=(0,o.useRef)(null);let c,l,u;return n[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{a.current&&clearTimeout(a.current)},l=[],n[0]=c,n[1]=l):(c=n[0],l=n[1]),(0,o.useEffect)(c,l),n[2]!==e||n[3]!==r?(u=function(...t){const n=t;i.current=n,a.current&&clearTimeout(a.current),a.current=setTimeout(()=>{i.current&&e(...i.current)},r)},n[2]=e,n[3]=r,n[4]=u):u=n[4],u}function j(e,t){if(!(0,a.hasParent)(e))throw new Error("node does not have parent");let n=(0,a.getParent)(e);for(;n&&(0,a.isAlive)(n);){if(t(n))return n;if(!(0,a.hasParent)(n))break;n=(0,a.getParent)(n)}throw new Error("no matching node found")}function D(e,t,n,s=()=>{},o=0,r=400,i=20,a=!0){let c;function l(u){const d=performance.now();let f=u.lastPosition,p=u.lastTime||d,m=u.lastVelocity||0;d>p+64&&(p=d);const g=Math.floor(d-p);for(let e=0;e<g;++e)m+=(-r*(f-t)+-i*m)/1*1/1e3,f+=1*m/1e3;const h=Math.abs(m)<=o,y=0===r||Math.abs(t-f)<=o;a&&0!==r&&(e<t?f>t:f<t)||h&&y?(n(t),s()):(n(f),c=requestAnimationFrame(()=>{l({lastPosition:f,lastTime:d,lastVelocity:m})}))}return o||(o=Math.abs(t-e)/1e3),[()=>{l({lastPosition:e})},()=>{cancelAnimationFrame(c)}]}function W(e,t){return j(e,t)}function L(e){const t=I.get(e);if(t&&(0,a.isAlive)(t))return t;try{const t=W(e,m.Y$);return I.set(e,t),t}catch(e){throw new Error("no session model found!")}}function U(e){const t=P.get(e);if(t&&(0,a.isAlive)(t))return t;try{const t=W(e,m.Tl);return P.set(e,t),t}catch(e){throw new Error("no containing view found")}}function $(e){const t=N.get(e);if(t&&(0,a.isAlive)(t))return t;try{const t=W(e,m.xU);return N.set(e,t),t}catch(e){throw new Error("no containing track found")}}function V(e){const t=M.get(e);if(t&&(0,a.isAlive)(t))return t;try{const t=W(e,m.Uy);return M.set(e,t),t}catch(e){throw new Error("no containing display found")}}function B(e){return O(e,Re)}function O(e,t=e=>e){const{assemblyName:n,refName:s,start:o,end:r,reversed:i}=e,a=n?`{${n}}`:"";let c,l;c=void 0!==o?`:${t(o+1)}`:void 0!==r?":1":"",l=void 0!==r?void 0!==o&&o+1===r?"":`..${t(r)}`:void 0!==o?"..":"";let u="";return i&&(u="[rev]"),`${a}${s}${c}${l}${u}`}function G(e,t){const n=e.assemblyName||t.assemblyName?(e.assemblyName||"").localeCompare(t.assemblyName||""):0;if(n)return n;const s=e.refName||t.refName?(e.refName||"").localeCompare(t.refName||""):0;if(s)return s;if(void 0!==e.start&&void 0!==t.start){const n=e.start-t.start;if(n)return n}if(void 0!==e.end&&void 0!==t.end){const n=e.end-t.end;if(n)return n}return 0}function z(e,t,n){return G((0,f.f)(e,n),(0,f.f)(t,n))}function F(e,t,n){return e<t?t:e>n?n:e}function H(e,{reversed:t,end:n=0,start:s=0},o){return r=(t?n-e:e-s)/o,Math.round(10*r)/10;var r}const q=180/Math.PI,J=Math.PI/180;function K(e){return e*q%360}function Q(e){return e*J%(2*Math.PI)}function _(e,t){return[e*Math.cos(t),e*Math.sin(t)]}function Z(e,t){return[Math.sqrt(e*e+t*t),Math.atan(t/e)]}function X(e,t,n){return Y(e.get("start"),e.get("end"),t,n)}function Y(e,t,n,s){const o=H(e,n,s),r=H(t,n,s);return n.reversed?[r,o]:[o,r]}function ee(e,t,n,s){const o=t-e,r=Math.max(0,n-o);return s?[e-r,t]:[e,e+n]}function te(e,t,n){const s=Array.from({length:n||0});let o=0;for(const n of e)s[o]=t(n),o+=1;return s}function ne(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return n;return-1}function se(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return e[n]}function oe(e,t){if((0,a.isStateTreeNode)(t)&&!(0,a.isAlive)(t))return t;if(e?.[t.refName]){const n=e[(t=(0,a.isStateTreeNode)(t)?{...(0,a.getSnapshot)(t)}:{...t}).refName];if(n)return{...t,refName:n,originalRefName:t.refName}}return t}async function re(e,t){const{regions:n=[],adapterConfig:s}=t;if(!t.sessionId)throw new Error("sessionId is required");const o=n.map(e=>e.assemblyName),r=Object.fromEntries(await Promise.all([...new Set(o)].map(async n=>[n,await e.getRefNameMapForAdapter(s,n,t)])));return{...t,regions:n.map((e,t)=>oe(r[o[t]],e))}}function ie(e,t){return[Math.min(e,t),Math.max(e,t)]}function ae(e,t=70,n=30){return e.length>t?`${e.slice(0,n)}...${e.slice(-n)}`:e}function ce(e,t=70){return e.length>t?`${e.slice(0,t)}...`:e}function le({refName:e,coord:t,assemblyName:n,oob:s},o){return[n&&o?`{${n}}`:"",e?`${ae(e)}:${Re(t)}${s?" (out of bounds)":""}`:""].join("")}const ue=/electron/i.test("undefined"!=typeof navigator?navigator.userAgent:""),de={S:"S",w:"w",T:"A",r:"y",a:"t",N:"N",K:"M",x:"x",d:"h",Y:"R",V:"B",y:"r",M:"K",h:"d",k:"m",C:"G",g:"c",t:"a",A:"T",n:"n",W:"W",X:"X",m:"k",v:"b",B:"V",s:"s",H:"D",c:"g",D:"H",b:"v",R:"Y",G:"C"};function fe(e){const t=[];for(let n=e.length-1;n>=0;n--)t.push(de[e[n]]??e[n]);return t.join("")}function pe(e){const t=[];for(let n=e.length-1;n>=0;n--)t.push(e[n]);return t.join("")}function me(e){const t=[];for(let n=0,s=e.length;n<s;n++)t.push(de[e[n]]??e[n]);return t.join("")}const ge="undefined"==typeof jest?"undefined"!=typeof window&&window.requestIdleCallback?window.requestIdleCallback:e=>setTimeout(()=>{e()},1):e=>{e()},he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];function ye(e,t=10){const n=String(e);let s=0;for(let e=0,t=n.length;e<t;e++)s+=he[n.charCodeAt(e)]??.5279276315789471;return s*t}function we(e,t,n,s){return 1===n?(e+s)%3+1:(t-s)%3*-1-1}const be=["ATG"],Se=["TAA","TAG","TGA"],ve={TCA:"S",TCC:"S",TCG:"S",TCT:"S",TTC:"F",TTT:"F",TTA:"L",TTG:"L",TAC:"Y",TAT:"Y",TAA:"*",TAG:"*",TGC:"C",TGT:"C",TGA:"*",TGG:"W",CTA:"L",CTC:"L",CTG:"L",CTT:"L",CCA:"P",CCC:"P",CCG:"P",CCT:"P",CAC:"H",CAT:"H",CAA:"Q",CAG:"Q",CGA:"R",CGC:"R",CGG:"R",CGT:"R",ATA:"I",ATC:"I",ATT:"I",ATG:"M",ACA:"T",ACC:"T",ACG:"T",ACT:"T",AAC:"N",AAT:"N",AAA:"K",AAG:"K",AGC:"S",AGT:"S",AGA:"R",AGG:"R",GTA:"V",GTC:"V",GTG:"V",GTT:"V",GCA:"A",GCC:"A",GCG:"A",GCT:"A",GAC:"D",GAT:"D",GAA:"E",GAG:"E",GGA:"G",GGC:"G",GGG:"G",GGT:"G"};function ke(e){const t={};for(const n of Object.keys(e)){const s=e[n],o=[];for(let e=0;e<3;e++){const t=n.charAt(e);o[e]=[],o[e][0]=t.toUpperCase(),o[e][1]=t.toLowerCase()}for(let e=0;e<2;e++){const n=o[0][e];for(let e=0;e<2;e++){const r=o[1][e];for(let e=0;e<2;e++)t[n+r+o[2][e]]=s}}}return t}async function Ce(e,t,n){t?.(e);const s=await n();return t?.(""),s}async function Ae(e,t,n,s){t(e);const o=await s();return(0,p.SW)(n),t(""),o}function Te(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}function Me(e){return`${Te(JSON.stringify(e))}`}async function Ne(e,t){return qe((await Promise.all(e.map(e=>t.blocksForRange(e.refName,e.start,e.end)))).flat().map(e=>e.maxv.blockPosition+65535-e.minv.blockPosition))}function Pe(e=""){return["Gff3TabixAdapter","VcfTabixAdapter","Gff3Adapter","VcfAdapter"].includes(e)}function Ie(e){return Math.floor(e/1e6)>0?`${xe(e/1e6)}Mbp`:Math.floor(e/1e3)>0?`${xe(e/1e3)}Kbp`:`${Math.floor(e)}bp`}function xe(e,t=3){return Re(Number.parseFloat(e.toPrecision(t)))}function Ee(e,t){return Math.floor(t/1e6)>0?`${xe(e/1e6)}/${xe(t/1e6)}Mb`:Math.floor(t/1e3)>0?`${xe(e/1e3)}/${xe(t/1e3)}Kb`:`${xe(e)}/${xe(t)} bytes`}function Re(e){if(e<1e3)return String(e);const t=String(e),n=t.length;let s="";for(let e=0;e<n;e++)e>0&&(n-e)%3==0&&(s+=","),s+=t[e];return s}function je(e,t){return Math.floor(t/1e3)>0?`${Re(Number.parseFloat((e/1e6).toFixed(2)))}M`:Re(Math.floor(e))}function De({sessionId:e,trackInstanceId:t}){return`${e}-${t}`}function We({sessionId:e,trackInstanceId:t}){return`${e}-${t}`}function Le(e,t,n=!0){const[s,r]=(0,o.useState)(()=>{if("undefined"==typeof window||!n)return t;try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return console.error(e),t}});return[s,t=>{try{const o=t instanceof Function?t(s):t;r(o),"undefined"!=typeof window&&n&&window.localStorage.setItem(e,JSON.stringify(o))}catch(e){console.error(e)}}]}function Ue(e){const{uri:t,baseUri:n=""}=e;let s;try{s=new URL(t,n).href}catch(e){s=t}return s}function $e(e){return rt(e)?(0,m.C1)(e)?Ue(e):JSON.stringify(e):String(e)}function Ve(e){return e.replaceAll(/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[-A-Z0-9+\u0026\u2019@#/%?=()~_|!:,.;]*[-A-Z0-9+\u0026@#/%=~()_|])/gi,"$1<a href='$2' target=\"_blank\">$2</a>")}function Be(e,t){const{padding:n=30,minWidth:s=80,fontSize:o=12,maxWidth:r=1e3,stripHTML:i=!1}=t||{};return Fe(e.map(e=>$e(e)).map(e=>i?(0,u.Z)(e):e).map(e=>ye(e,o)).map(e=>Math.min(Math.max(e+n,s),r)))}function Oe(e){return(0,a.getEnv)(e)}function Ge(e){return"undefined"!=typeof localStorage?localStorage.getItem(e):void 0}function ze(e,t){"undefined"!=typeof localStorage&&localStorage.setItem(e,t)}function Fe(e,t=Number.NEGATIVE_INFINITY){let n=t;for(const t of e)n=Math.max(t,n);return n}function He(e,t=Number.POSITIVE_INFINITY){let n=t;for(const t of e)n=Math.min(t,n);return n}function qe(e){let t=0;for(const n of e)t+=n;return t}function Je(e){return qe(e)/e.length}function Ke(e,t){const n={};for(const s of e){const e=t(s);n[e]||(n[e]=[]),n[e].push(s)}return n}function Qe(e){return null!=e}function _e(e,t=5e3){if(e.length<=1)return e;const n=[];let s=null;e=e.sort((e,t)=>e.start-t.start),n.push(e[0]);for(let o=1;o<e.length;o++)s=n.at(-1),s.end+t<e[o].start-t?n.push(e[o]):s.end<e[o].end&&(s.end=Math.max(s.end,e[o].end),n.pop(),n.push(s));return n}function Ze(e,t=5e3){const n={};for(const t of e)n[t.refName]||(n[t.refName]=[]),n[t.refName].push(t);return Object.values(n).flatMap(e=>_e(e.sort((e,t)=>e.start-t.start),t))}function Xe(e){return(0,d.M)(e).alpha(1).toHex()}function Ye(e){if(e){const t=(0,d.M)(e);return{strokeOpacity:t.alpha(),stroke:t.alpha(1).toHex()}}return{}}function et(e){if(e){const t=(0,d.M)(e);return{fillOpacity:t.alpha(),fill:t.alpha(1).toHex()}}return{}}function tt(e){const t=document.createElement("div");return(0,c.flushSync)(()=>{(0,l.createRoot)(t).render(e)}),t.innerHTML.replaceAll(/\brgba\((.+?),[^,]+?\)/g,"rgb($1)")}function nt(e){return 31===e[0]&&139===e[1]&&8===e[2]}async function st(e,t={}){const{statusCallback:n=()=>{}}=t,s=await Ce("Downloading file",n,()=>e.readFile(t));return nt(s)?await Ce("Unzipping",n,()=>(0,r.$1)(s)):s}async function ot(e,t){const n=await st(e,t);if(n.length>536870888)throw new Error("Data exceeds maximum string length (512MB)");return new TextDecoder("utf8",{fatal:!0}).decode(n)}function rt(e){return"object"==typeof e&&null!==e}function it(e,t){return+(Ge(e)??t)}function at(e,t){return Boolean(JSON.parse(Ge(e)||JSON.stringify(t)))}function ct(e,t){ze(e,JSON.stringify(t))}function lt(e,t,n,s){return t.test(e)&&!n||n===s}},84250(e,t,n){async function s(){window.location=window.location.pathname}n.d(t,{A:()=>s})}}]);
//# sourceMappingURL=5864.247dcd85.chunk.js.map