"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2535],{62535(e,t,n){n.r(t),n.d(t,{default:()=>L});var s=n(30936),i=n(42918),o=n(71547),l=n(77251),r=n(57141),d=n(64074),a=n(27351),c=n(87574),h=n(65045),x=n(32118);const g=(0,h.n)()({loading:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.15)",backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.05) 8px, rgba(0, 0, 0, 0.05) 16px)",pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},loadingMessage:{zIndex:2,pointerEvents:"none"}}),u=(0,d.observer)(function({model:e,children:t}){const{error:n,regionTooLarge:s}=e;return n?(0,x.jsx)(a.A,{error:n}):s?e.regionCannotBeRendered():(0,x.jsx)(m,{model:e,children:t})}),m=(0,d.observer)(function({model:e,children:t}){const{drawn:n,loading:s}=e;return(0,x.jsxs)("div",{"data-testid":`drawn-${n}`,children:[t,s?(0,x.jsx)(v,{model:e}):null]})}),v=(0,d.observer)(function({model:e}){const{classes:t}=g(),{statusMessage:n}=e;return(0,x.jsx)("div",{className:t.loading,children:(0,x.jsx)("div",{className:t.loadingMessage,children:(0,x.jsx)(c.A,{message:n})})})}),f=u;var p=n(44016),j=n(45402),y=n(81818),b=n(26823);const w=Math.sqrt(2);function P(e){const t=(0,s.c)(17),{item:n,x:i,y:l,ldMetric:r,signedLD:d}=e;let a;a="dprime"===r?"D'":d?"R":"RÂ²";const c=i+15;let h,g,u;t[0]!==c||t[1]!==l?(h={x:c,y:l},t[0]=c,t[1]=l,t[2]=h):h=t[2],t[3]!==n.snp1.id?(g=(0,x.jsx)("div",{children:n.snp1.id}),t[3]=n.snp1.id,t[4]=g):g=t[4],t[5]!==n.snp2.id?(u=(0,x.jsx)("div",{children:n.snp2.id}),t[5]=n.snp2.id,t[6]=u):u=t[6];const m=a;let v,f,p;return t[7]!==n.ldValue?(v=n.ldValue.toFixed(3),t[7]=n.ldValue,t[8]=v):v=t[8],t[9]!==a||t[10]!==v?(f=(0,x.jsxs)("div",{children:[m,": ",v]}),t[9]=a,t[10]=v,t[11]=f):f=t[11],t[12]!==h||t[13]!==g||t[14]!==u||t[15]!==f?(p=(0,x.jsxs)(o.A,{clientPoint:h,children:[g,u,f]}),t[12]=h,t[13]=g,t[14]=u,t[15]=f,t[16]=p):p=t[16],p}function k(e){const t=(0,s.c)(60),{hoveredItem:n,cellWidth:i,genomicX1:o,genomicX2:l,yScalar:r,lineZoneHeight:d,tickHeight:a,width:c,height:h,useGenomicPositions:g,snps:u,regionStart:m,bpPerPx:v,canvasOffset:f}=e,{i:p,j}=n;let y;t[0]!==d||t[1]!==r?(y=(e,t)=>({x:(e+t)/w,y:(t-e)/w*r+d}),t[0]=d,t[1]=r,t[2]=y):y=t[2];const b=y;let P,k,M,$;if(g&&u.length>0){let e;t[3]!==v||t[4]!==m||t[5]!==u?(e=e=>{const t=u[e].start;return(((e>0?u[e-1].start:m)+t)/2-m)/v/w},t[3]=v,t[4]=m,t[5]=u,t[6]=e):e=t[6];const n=e;let s;t[7]!==v||t[8]!==m||t[9]!==u?(s=e=>e+1<u.length?((u[e].start+u[e+1].start)/2-m)/v/w:(u[u.length-1].start+50*v-m)/v/w,t[7]=v,t[8]=m,t[9]=u,t[10]=s):s=t[10];const i=s,r=n(j),a=n(p),c=(r+i(j))/2,h=(a+i(p))/2;let x,g,f;t[11]!==c||t[12]!==h||t[13]!==b?(x=b(c,h),t[11]=c,t[12]=h,t[13]=b,t[14]=x):x=t[14],P=x,t[15]!==o||t[16]!==d?(g={x:o,y:d},t[15]=o,t[16]=d,t[17]=g):g=t[17],k=g,t[18]!==l||t[19]!==d?(f={x:l,y:d},t[18]=l,t[19]=d,t[20]=f):f=t[20],M=f}else{const e=i,n=(j+.5)*e,s=(p+.5)*e;let o;t[21]!==n||t[22]!==s||t[23]!==b?(o=b(n,s),t[21]=n,t[22]=s,t[23]=b,t[24]=o):o=t[24],P=o;const l=(j+.5)*e,r=(j+.5)*e;let d;t[25]!==l||t[26]!==r||t[27]!==b?(d=b(l,r),t[25]=l,t[26]=r,t[27]=b,t[28]=d):d=t[28],k=d;const a=(p+.5)*e,c=(p+.5)*e;let h;t[29]!==a||t[30]!==c||t[31]!==b?(h=b(a,c),t[29]=a,t[30]=c,t[31]=b,t[32]=h):h=t[32],M=h}t[33]!==f||t[34]!==h||t[35]!==c?($={position:"absolute",left:f,top:0,width:c,height:h,pointerEvents:"none"},t[33]=f,t[34]=h,t[35]=c,t[36]=$):$=t[36];const L=`M ${k.x} ${k.y} L ${P.x} ${P.y} L ${M.x} ${M.y}`;let C,V;t[37]!==L?(C=(0,x.jsx)("path",{stroke:"rgba(0, 0, 0, 0.6)",strokeWidth:1,fill:"none",d:L}),t[37]=L,t[38]=C):C=t[38],t[39]!==o||t[40]!==l||t[41]!==M.x||t[42]!==M.y||t[43]!==k.x||t[44]!==k.y||t[45]!==a||t[46]!==g?(V=g?null:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("path",{d:`M ${k.x} ${k.y} L ${o} ${a}`}),(0,x.jsx)("path",{d:`M ${M.x} ${M.y} L ${l} ${a}`})]}),t[39]=o,t[40]=l,t[41]=M.x,t[42]=M.y,t[43]=k.x,t[44]=k.y,t[45]=a,t[46]=g,t[47]=V):V=t[47];const D=`M ${o} 0 L ${o} ${a}`;let G;t[48]!==D?(G=(0,x.jsx)("path",{d:D}),t[48]=D,t[49]=G):G=t[49];const I=`M ${l} 0 L ${l} ${a}`;let A,H,R;return t[50]!==I?(A=(0,x.jsx)("path",{d:I}),t[50]=I,t[51]=A):A=t[51],t[52]!==V||t[53]!==G||t[54]!==A?(H=(0,x.jsxs)("g",{stroke:"#e00",strokeWidth:"1.5",fill:"none",children:[V,G,A]}),t[52]=V,t[53]=G,t[54]=A,t[55]=H):H=t[55],t[56]!==H||t[57]!==$||t[58]!==C?(R=(0,x.jsxs)("svg",{style:$,children:[C,H]}),t[56]=H,t[57]=$,t[58]=C,t[59]=R):R=t[59],R}const M=(0,d.observer)(function({model:e}){const t=(0,l.getContainingView)(e),n=Math.round(t.dynamicBlocks.totalWidthPx),{fullyDrawn:s,flatbush:o,flatbushItems:d,yScalar:a,cellWidth:c,showLegend:h,ldMetric:g,lineZoneHeight:u,fitToHeight:m,ldCanvasHeight:v,useGenomicPositions:f,snps:M,lastDrawnOffsetPx:$,signedLD:L}=e,C=m?v:n/2,V=C+u,[D,G]=(0,i.useState)(),[I,A]=(0,i.useState)(),H=(0,i.useRef)(null),R=t.dynamicBlocks.contentBlocks[0],S=t.bpPerPx,W=D&&R?(D.snp2.start-R.start)/S:void 0,B=D&&R?(D.snp1.start-R.start)/S:void 0,E=t.offsetPx>=0?($??0)-t.offsetPx:Math.max(0,-t.offsetPx),X=E;(0,i.useEffect)(()=>(void 0!==W&&void 0!==B&&e.showVerticalGuides?t.setVolatileGuides([{xPos:W+X},{xPos:B+X}]):t.setVolatileGuides([]),()=>{t.setVolatileGuides([])}),[W,B,e.showVerticalGuides,t,X]);const _=(0,i.useMemo)(()=>o?r.A.from(o):null,[o]),T=(0,i.useCallback)(t=>{e.setRef(t)},[e,n,C]),O=(0,i.useCallback)(e=>{const t=H.current;if(!t||!_||!d.length)return G(void 0),void A(void 0);const n=t.getBoundingClientRect(),s=E,i=e.clientX-n.left-s,o=e.clientY-n.top;if(A({x:e.clientX,y:e.clientY}),o<u)return void G(void 0);const{x:l,y:r}=function(e,t,n,s){const i=(t-s)/n;return{x:(e-i)/w,y:(e+i)/w}}(i,o,a,u),c=_.search(l-1,r-1,l+1,r+1);if(c.length>0){const e=d[c[0]];G(e)}else G(void 0)},[_,d,a,u,E]),Z=(0,i.useCallback)(()=>{G(void 0),A(void 0)},[]);return(0,x.jsxs)("div",{ref:H,style:{cursor:D&&I?"crosshair":void 0,position:"relative",width:n,height:V,overflow:"hidden"},onMouseMove:O,onMouseLeave:Z,children:[(0,x.jsx)("canvas",{"data-testid":"ld_canvas"+(s?"_done":""),ref:T,style:{width:n,height:C,position:"absolute",left:E,top:u},width:2*n,height:2*C}),D&&void 0!==W&&void 0!==B?(0,x.jsx)(k,{hoveredItem:D,cellWidth:c,genomicX1:W,genomicX2:B,yScalar:a,lineZoneHeight:u,tickHeight:e.tickHeight,width:n,height:V,useGenomicPositions:f,snps:M,regionStart:R?.start??0,bpPerPx:S,canvasOffset:E}):null,D&&I?(0,x.jsx)(P,{item:D,x:I.x,y:I.y,ldMetric:g,signedLD:L}):null,h?(0,x.jsx)(p.Ay,{ldMetric:g,signedLD:L}):null,f?(0,x.jsx)(j.mO,{model:e,children:(0,x.jsx)(j.Vu,{model:e})}):(0,x.jsx)(j.Ay,{model:e}),e.showRecombination&&e.recombination?(0,x.jsxs)("div",{style:{position:"absolute",left:E,top:u/2,width:n,height:u/2,pointerEvents:"none"},children:[(0,x.jsx)(y.A,{model:e,width:n,height:u/2,useGenomicPositions:f,regionStart:R?.start,bpPerPx:S}),(0,x.jsx)(b.A,{height:u/2,maxValue:Math.max(...e.recombination.values,.1)})]}):null]})}),$=(0,d.observer)(function({model:e}){const t=(0,l.getContainingView)(e),n=Math.round(t.dynamicBlocks.totalWidthPx),{height:s,showLDTriangle:i,showRecombination:o}=e;return t.bpPerPx>1e3?(0,x.jsx)("div",{style:{width:n,height:s,display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Zoom in to see LD data"}):i||o?(0,x.jsx)("div",{style:{position:"relative",width:n,height:s},children:i?(0,x.jsx)(M,{model:e}):null}):(0,x.jsx)("div",{style:{width:n,height:s,display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"Enable LD triangle or recombination track in display settings"})}),L=(0,d.observer)(function({model:e}){return(0,x.jsx)(f,{model:e,children:(0,x.jsx)($,{model:e})})})}}]);
//# sourceMappingURL=2535.c555e3d5.chunk.js.map