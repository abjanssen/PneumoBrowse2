"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[809],{5690:(e,t,s)=>{s.d(t,{A:()=>m});var n=s(7552),l=s(93878),i=s(75100),o=s(80317),a=s(21928),r=s(50864),c=s(69112),d=s(69500);const h=(0,o.Ay)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableGutters&&t.gutters,t[s.variant]]}})((0,a.A)(({theme:e})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:e.mixins.toolbar}]}))),m=n.forwardRef(function(e,t){const s=(0,r.b)({props:e,name:"MuiToolbar"}),{className:n,component:o="div",disableGutters:a=!1,variant:m="regular",...u}=s,f={...s,component:o,disableGutters:a,variant:m},p=(e=>{const{classes:t,disableGutters:s,variant:n}=e,l={root:["root",!s&&"gutters",n]};return(0,i.A)(l,c.U,t)})(f);return(0,d.jsx)(h,{as:o,className:(0,l.A)(p.root,n),ref:t,ownerState:f,...u})})},11158:(e,t,s)=>{s.r(t),s.d(t,{default:()=>E});var n=s(67112),l=s(76218),i=s(68446),o=s(13476),a=s(75785),r=s(67758),c=s(7552),d=s(99546),h=s(18423),m=s(8193),u=s(71098),f=s(37962),p=s(89870),g=s(91818),x=s(61282),w=s(21049),v=s(69500);const b=(0,a.n9)()(e=>({facet:{margin:0,marginLeft:e.spacing(2)},select:{marginBottom:e.spacing(2)}}));function j(e){const t=(0,r.c)(5),{onClick:s}=e;let n,l,i;return t[0]!==s?(n=()=>{s()},t[0]=s,t[1]=n):n=t[1],t[2]===Symbol.for("react.memo_cache_sentinel")?(l=(0,v.jsx)(m.A,{}),t[2]=l):l=t[2],t[3]!==n?(i=(0,v.jsx)(f.A,{title:"Clear selection on this facet filter",children:(0,v.jsx)(p.A,{onClick:n,size:"small",children:l})}),t[3]=n,t[4]=i):i=t[4],i}function k(e){const t=(0,r.c)(7),{visible:s,onClick:n}=e;let l,i,o;return t[0]!==n?(l=()=>{n()},t[0]=n,t[1]=l):l=t[1],t[2]!==s?(i=s?(0,v.jsx)(u.A,{}):(0,v.jsx)(h.A,{}),t[2]=s,t[3]=i):i=t[3],t[4]!==l||t[5]!==i?(o=(0,v.jsx)(f.A,{title:"Minimize/expand this facet filter",children:(0,v.jsx)(p.A,{onClick:l,size:"small",children:i})}),t[4]=l,t[5]=i,t[6]=o):o=t[6],o}const C=(0,i.observer)(function({column:e,vals:t,model:s}){const{classes:n}=b(),[l,i]=(0,c.useState)(!0),{faceted:o}=s,{filters:a}=o,{field:r}=e;return(0,v.jsxs)(g.A,{className:n.facet,fullWidth:!0,children:[(0,v.jsxs)("div",{children:[(0,v.jsx)(x.A,{component:"span",children:r}),(0,v.jsx)(j,{onClick:()=>{o.setFilter(r,[])}}),(0,v.jsx)(k,{visible:l,onClick:()=>{i(!l)}})]}),l?(0,v.jsx)(w.A,{multiple:!0,native:!0,className:n.select,value:a.get(e.field)||[],onChange:t=>{o.setFilter(e.field,[...t.target.options].filter(e=>e.selected).map(e=>e.value))},children:t.sort((e,t)=>e[0].localeCompare(t[0])).map(([e,t])=>(0,v.jsxs)("option",{value:e,children:[(0,d.coarseStripHTML)(e)," (",t,")"]},e))}):null]})});var S=s(6842);const A=(0,i.observer)(function({rows:e,columns:t,model:s}){const{faceted:n}=s,{filters:l}=n,i=t.slice(1),o=new Map(t.slice(1).map(e=>[e.field,new Map])),a=n.filters.keys(),r=i.map(e=>e.field),c=new Set;for(const e of a)l.get(e)?.length&&c.add(e);for(const e of r)c.add(e);let d=e;for(const e of c){const t=o.get(e);if(t)for(const s of d){const n=(0,S.a)(e,s),l=t.get(n);n&&(void 0===l?t.set(n,1):t.set(n,l+1))}const s=l.get(e)?.length?new Set(l.get(e)):void 0;d=d.filter(t=>void 0===s||s.has((0,S.a)(e,t)))}return(0,v.jsx)("div",{children:i.map(e=>(0,v.jsx)(C,{vals:[...o.get(e.field)],column:e,model:s},e.field))})});var y=s(84132),T=s(42489),M=s(36422);const H=(0,i.observer)(function({model:e,columns:t,shownTrackIds:s,selection:n}){const{pluginManager:l}=(0,d.getEnv)(e),{view:i,faceted:o}=e,{rows:a,useShoppingCart:r,showOptions:h,filteredRows:m,filteredNonMetadataKeys:u,filteredMetadataKeys:f,visible:p}=o,[g,x]=(0,c.useState)({name:(0,d.measureGridWidth)(a.map(e=>e.name),{maxWidth:500,stripHTML:!0})+15,...Object.fromEntries(u.filter(e=>p[e]).map(e=>[e,(0,d.measureGridWidth)(a.map(t=>t[e]),{maxWidth:400,stripHTML:!0})])),...Object.fromEntries(f.filter(e=>p[`metadata.${e}`]).map(e=>[`metadata.${e}`,(0,d.measureGridWidth)(a.map(t=>t.metadata[e]),{maxWidth:400,stripHTML:!0})]))});return(0,v.jsx)(y.z,{rowHeight:25,columnHeaderHeight:35,checkboxSelection:!0,disableRowSelectionOnClick:!0,keepNonExistentRowsSelected:!0,rows:m,columnVisibilityModel:p,showToolbar:h,onColumnWidthChange:e=>{x({...g,[e.colDef.field]:e.width})},onColumnVisibilityModelChange:t=>{e.faceted.setVisible(t)},onRowSelectionModelChange:t=>{if(r){const s=(0,M.getRoot)(e),n=l.pluggableConfigSchemaType("track");e.setSelection([...t.ids].map(e=>(0,M.resolveIdentifier)(n,s,e)))}else{const n=s,l=t.ids;(0,T.transaction)(()=>{[...n].filter(e=>!l.has(e)).map(e=>i.hideTrack(e)),[...l].filter(e=>!n.has(e)).map(t=>{i.showTrack(t),e.addToRecentlyUsed(t)})})}},rowSelectionModel:{type:"include",ids:new Set(r?n.map(e=>e.trackId):[...s])},columns:t.map(e=>({...e,width:g[e.field]}))})});var W=s(2020),N=s(33896),R=s(93062),_=s(92826),F=s(9469);function I(e){const t=(0,r.c)(55),{model:s}=e,{faceted:l}=s,[i,o]=(0,c.useState)(null),{showOptions:a,showFilters:d,showSparse:h,useShoppingCart:u}=l;let f,g,x,w,b,j,k,C;t[0]!==l?(f=e=>{l.setFilterText(e.target.value)},t[0]=l,t[1]=f):f=t[1],t[2]!==l?(g=()=>{l.setFilterText("")},t[2]=l,t[3]=g):g=t[3],t[4]===Symbol.for("react.memo_cache_sentinel")?(x=(0,v.jsx)(m.A,{}),t[4]=x):x=t[4],t[5]!==g?(w={input:{endAdornment:(0,v.jsx)(N.A,{position:"end",children:(0,v.jsx)(p.A,{onClick:g,children:x})})}},t[5]=g,t[6]=w):w=t[6],t[7]!==l.filterText||t[8]!==f||t[9]!==w?(b=(0,v.jsx)(R.A,{label:"Search...",value:l.filterText,onChange:f,slotProps:w}),t[7]=l.filterText,t[8]=f,t[9]=w,t[10]=b):b=t[10],t[11]===Symbol.for("react.memo_cache_sentinel")?(j=(0,v.jsx)(p.A,{onClick:e=>{o(e.currentTarget)},children:(0,v.jsx)(W.A,{})}),t[11]=j):j=t[11],t[12]!==s?(k=(0,v.jsx)(F.A,{model:s}),t[12]=s,t[13]=k):k=t[13],t[14]!==b||t[15]!==k?(C=(0,v.jsxs)(_.A,{container:!0,spacing:4,alignItems:"center",children:[b,j,k]}),t[14]=b,t[15]=k,t[16]=C):C=t[16];const S=!!i;let A,y,T,M,H,I,G,L,z,O,E,$,K;return t[17]===Symbol.for("react.memo_cache_sentinel")?(A=()=>{o(null)},y=(e,t)=>{t(),o(null)},t[17]=A,t[18]=y):(A=t[17],y=t[18]),t[19]!==l||t[20]!==u?(T=()=>{l.setUseShoppingCart(!u)},t[19]=l,t[20]=u,t[21]=T):T=t[21],t[22]!==T||t[23]!==u?(M={label:"Add tracks to selection instead of turning them on/off",onClick:T,type:"checkbox",checked:u},t[22]=T,t[23]=u,t[24]=M):M=t[24],t[25]!==l||t[26]!==h?(H=()=>{l.setShowSparse(!h)},t[25]=l,t[26]=h,t[27]=H):H=t[27],t[28]!==h||t[29]!==H?(I={label:"Show sparse metadata columns",onClick:H,checked:h,type:"checkbox"},t[28]=h,t[29]=H,t[30]=I):I=t[30],t[31]!==l||t[32]!==d?(G=()=>{l.setShowFilters(!d)},t[31]=l,t[32]=d,t[33]=G):G=t[33],t[34]!==d||t[35]!==G?(L={label:"Show facet filters",onClick:G,checked:d,type:"checkbox"},t[34]=d,t[35]=G,t[36]=L):L=t[36],t[37]!==l||t[38]!==a?(z=()=>{l.setShowOptions(!a)},t[37]=l,t[38]=a,t[39]=z):z=t[39],t[40]!==a||t[41]!==z?(O={label:"Show extra table options",onClick:z,checked:a,type:"checkbox"},t[40]=a,t[41]=z,t[42]=O):O=t[42],t[43]!==M||t[44]!==I||t[45]!==L||t[46]!==O?(E=[M,I,L,O],t[43]=M,t[44]=I,t[45]=L,t[46]=O,t[47]=E):E=t[47],t[48]!==i||t[49]!==E||t[50]!==S?($=(0,v.jsx)(n.Menu,{anchorEl:i,open:S,onClose:A,onMenuItemClick:y,menuItems:E}),t[48]=i,t[49]=E,t[50]=S,t[51]=$):$=t[51],t[52]!==$||t[53]!==C?(K=(0,v.jsxs)(v.Fragment,{children:[C,$]}),t[52]=$,t[53]=C,t[54]=K):K=t[54],K}var G=s(26027);const L=(0,a.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},resizeHandle:{marginLeft:5,background:"grey",width:5}}),z=.75,O=(0,i.observer)(function({model:e}){const{classes:t}=L(),{selection:s,shownTrackIds:l,faceted:i}=e,{rows:a,panelWidth:r,showFilters:c,filteredNonMetadataKeys:d,filteredMetadataKeys:h}=i,m=[{field:"name",hideable:!1,renderCell:s=>{const{value:n,row:l}=s,{id:i,conf:a}=l;return(0,v.jsxs)("div",{className:t.cell,children:[(0,v.jsx)(o.A,{html:n}),(0,v.jsx)(G.A,{id:i,conf:a,trackId:i,model:e})]})}},...d.map(e=>({field:e,renderCell:e=>{const s=e.value;return s?(0,v.jsx)(o.A,{className:t.cell,html:s}):""}})),...h.map(e=>({field:`metadata.${e}`,headerName:["name",...d].includes(e)?`${e} (from metadata)`:e,valueGetter:(t,s)=>`${s.metadata[e]??""}`,renderCell:e=>{const s=e.value;return s?(0,v.jsx)(o.A,{className:t.cell,html:s}):""}}))];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(I,{model:e}),(0,v.jsxs)("div",{style:{display:"flex",overflow:"hidden",height:window.innerHeight*z,width:window.innerWidth*z},children:[(0,v.jsx)("div",{style:{height:window.innerHeight*z,width:window.innerWidth*z-(c?r:0)},children:(0,v.jsx)(H,{model:e,columns:m,shownTrackIds:l,selection:s})}),c?(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(n.ResizeHandle,{vertical:!0,onDrag:e=>i.setPanelWidth(r-e),className:t.resizeHandle}),(0,v.jsx)("div",{style:{width:r,overflow:"auto"},children:(0,v.jsx)(A,{model:e,rows:a,columns:m})})]}):null]})]})}),E=(0,i.observer)(function(e){const{handleClose:t}=e;return(0,v.jsx)(n.Dialog,{open:!0,onClose:t,maxWidth:"xl",title:"Faceted track selector",children:(0,v.jsx)(l.A,{children:(0,v.jsx)(O,{...e})})})})},69112:(e,t,s)=>{s.d(t,{A:()=>o,U:()=>i});var n=s(51062),l=s(2958);function i(e){return(0,l.Ay)("MuiToolbar",e)}const o=(0,n.A)("MuiToolbar",["root","gutters","regular","dense"])}}]);
//# sourceMappingURL=809.bb2cc4b6.chunk.js.map