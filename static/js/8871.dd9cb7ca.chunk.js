"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8871],{23111(e,t,n){n.d(t,{H_:()=>s,XM:()=>i,bn:()=>r,qW:()=>o,xE:()=>l});var a=n(20208);function s({feature:e,assembly:t}){const n=e.get("ALT")?.[0],s=n?(0,a.An)(n):void 0,r=e.get("start"),i=e.get("refName"),o=e=>t.getCanonicalRefName(e)||e;if("<TRA>"===n){const t=e.get("INFO");return{pos:r,refName:o(i),mateRefName:o(t.CHR2[0]),matePos:t.END[0]-1}}if(s?.MatePosition){const e=s.MatePosition.split(":");return{pos:r,refName:o(i),mateRefName:o(e[0]),matePos:+e[1]-1}}if(e.get("mate")){const t=e.get("mate"),n=e.get("strand"),a=t.strand,s=1===n?e.get("end"):r,l=1===a?t.start:t.end??t.start;return{pos:s,refName:o(i),mateRefName:o(t.refName),matePos:l}}return{pos:r,refName:o(i),mateRefName:o(i),matePos:e.get("end")}}function r(e){return e.map(({id:e,displays:t,...n})=>({...n,displays:t.map(({id:e,...t})=>t)}))}function i(e){return`${e.get("name")||e.get("id")||"breakend"} split detail`}function o(e){return e?.assemblyNames[0]}function l(e,t,n){return[{...e,end:t+1,...void 0!==n&&{assemblyName:n}},{...e,start:t,...void 0!==n&&{assemblyName:n}}]}},68871(e,t,n){n.r(t),n.d(t,{default:()=>b});var a=n(55614),s=n(86551),r=n(23886),i=n(30128),o=n(62088),l=n(43102),c=n(23111),m=n(54825),f=n(15731),u=n(153),d=n(44460);const g=(0,i.lazy)(()=>Promise.all([n.e(6740),n.e(6348)]).then(n.bind(n,26348)));function p(e){const t=(0,a.c)(8),{model:n,feature:s}=e,{view:p}=n,[h,N]=(0,i.useState)(),[y,b]=(0,i.useState)();let w,v,j;if(t[0]!==s||t[1]!==p?(w=()=>{(async()=>{try{const e=await async function({view:e,feature:t}){const{assemblyManager:n}=(0,r.getSession)(e),a=t.get("CIGAR"),s=t.get("strand"),i=t.get("tags")?.SA||"",o=t.get("name"),l=(0,u.NI)(a,1),c=await n.waitForAssembly(e.assemblyNames[0]);if(!c)throw new Error("assembly not found");const m=(0,u.Cu)(i,t.id(),s,o,!0),f=[{...t.toJSON(),clipLengthAtStartOfRead:l,strand:1,mate:{refName:o,start:l,end:l+(0,u.Gl)(a)}},...m];for(const[e,t]of f.entries()){const n=t;n.refName=c.getCanonicalRefName2(n.refName),n.syntenyId=e,n.mate.syntenyId=e,n.mate.uniqueId=`${n.uniqueId}_mate`}return f.toSorted((e,t)=>e.clipLengthAtStartOfRead-t.clipLengthAtStartOfRead)}({view:p,feature:new l.A(s)});N(e)}catch(e){const t=e;b(t),console.error(t)}})()},v=[s,p],t[0]=s,t[1]=p,t[2]=w,t[3]=v):(w=t[2],v=t[3]),(0,i.useEffect)(w,v),t[4]!==y||t[5]!==n||t[6]!==h){const e=[];if(h)for(let t=0;t<h.length-1;t++)e.push([h[t],h[t+1]]);const a=(0,r.getSession)(n),s=(0,c.qW)(n.view);j=e.length&&s?(0,d.jsxs)("div",{children:[(0,d.jsx)(m.A,{children:"Launch split view"}),y?(0,d.jsx)(o.A,{error:y}):null,(0,d.jsx)("ul",{children:e.map((e,t)=>{const[i,o]=e;return(0,d.jsxs)("li",{children:[i.refName,":",(0,r.toLocale)(1===i.strand?i.end:i.start)," ->"," ",o.refName,":",(0,r.toLocale)(1===o.strand?o.start:o.end)," ",(0,d.jsx)(f.A,{href:"#",onClick:e=>{e.preventDefault(),a.queueDialog(e=>[g,{handleClose:e,session:a,feature:new l.A({...i,mate:o}),view:n.view,assemblyName:s}])},children:"(breakpoint split view)"})]},`${JSON.stringify(e)}-${t}`)})})]}):null,t[4]=y,t[5]=n,t[6]=h,t[7]=j}else j=t[7];return j}var h=n(74291);function N(e){const t=(0,a.c)(8),{tag:n,model:s}=e;let i,o,l;if(t[0]===Symbol.for("react.memo_cache_sentinel")?(i=(0,d.jsx)(m.A,{children:"List of supplementary alignment locations"}),t[0]=i):i=t[0],t[1]!==s||t[2]!==n){let e;t[4]!==s?(e=(e,t)=>{const[n,a,i,o]=e.split(","),l=(0,u.PC)(o),c=Math.floor(l/5),m=+a,g=+a+l,p=m-c,N=g+c,y=`${n}:${Math.max(1,p)}-${N}`,b=`${n}:${(0,r.toLocale)(m)}-${(0,r.toLocale)(g)} (${i}) [${l}bp]`;return(0,d.jsx)("li",{children:(0,d.jsx)(f.A,{href:"#",onClick:async e=>{e.preventDefault(),(0,h.h)(y,s)},children:b})},`${y}-${t}`)},t[4]=s,t[5]=e):e=t[5],o=n.split(";").filter(y).map(e),t[1]=s,t[2]=n,t[3]=o}else o=t[3];return t[6]!==o?(l=(0,d.jsxs)("div",{children:[i,(0,d.jsx)("ul",{children:o})]}),t[6]=o,t[7]=l):l=t[7],l}function y(e){return!!e}function b(e){const t=(0,a.c)(13),{model:n,tag:i,feature:o}=e;let l,c,m,f;if(t[0]!==n){const e=(0,r.getSession)(n),{pluginManager:a}=(0,r.getEnv)(e);l=!1;try{l=!!a.getViewType("BreakpointSplitView")}catch(c){}t[0]=n,t[1]=l}else l=t[1];return t[2]!==n||t[3]!==i?(c=(0,d.jsx)(N,{model:n,tag:i}),t[2]=n,t[3]=i,t[4]=c):c=t[4],t[5]!==o||t[6]!==l||t[7]!==n?(m=l?(0,d.jsx)(p,{model:n,feature:o}):null,t[5]=o,t[6]=l,t[7]=n,t[8]=m):m=t[8],t[9]!==e||t[10]!==c||t[11]!==m?(f=(0,d.jsxs)(s.default,{...e,title:"Supplementary alignments",children:[c,m]}),t[9]=e,t[10]=c,t[11]=m,t[12]=f):f=t[12],f}}}]);
//# sourceMappingURL=8871.dd9cb7ca.chunk.js.map