"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5669],{45669:(e,t,r)=>{r.r(t),r.d(t,{default:()=>b});var n=r(7552),s=r(68446),o=r(99546),a=r(373);const c="rgb(220,220,180)",l="rgba(250,200,200)";function d({str:e,charactersPerRow:t,showCoordinates:r,currRemainder:n=0,splitSize:s=10}){const o=Math.ceil(e.length/t),a=new Array(o);let c=n%10,l=0,d=0;for(;l<o+1;++l){const o=0===l?t-n:t,i=e.slice(d,d+o);if(!i)break;if(r){let e="";for(let t=0,r=c;t<i.length;t++,r++)r%s===0&&(e+=" ",r=0),e+=i[t];e&&(a[l]=e)}else a[l]=i;c=0,d+=o}return{segments:a,remainder:((a.at(-1)?.replaceAll(" ","").length||0)+(l<2?n:0))%t}}var i=r(69500);const u=(0,s.observer)((function({chunks:e,start:t,color:r,strand:s=1,coordStart:o=t,model:a}){const{charactersPerRow:c,showCoordinates:l}=a;return e.map(((a,d)=>{const u=0===d&&t%c===0||d>0?`${(""+(o-t%c+d*s*c)).padStart(4)}   `:"",h=d===e.length-1&&(e.at(-1)?.replaceAll(" ","").length||0)+(0===d?t%c:0)!==c?null:l?" \n":"";return(0,i.jsxs)(n.Fragment,{children:[l?u:null,(0,i.jsx)("span",{style:{background:r},children:a}),h]},`${a}-${d}`)}))})),h=(0,s.observer)((function({utr:e,cds:t,exons:r,sequence:n,upstream:s,downstream:o,feature:a,includeIntrons:h,collapseIntron:m,model:g}){const{upperCaseCDS:w,intronBp:f,charactersPerRow:p,showCoordinates:x,showCoordinatesSetting:j}=g,b=t.length>0,C=(t.length?[...t,...e].sort(((e,t)=>e.start-t.start)):r).filter((e=>e.start!==e.end)),k=e=>w?e.toLowerCase():e,q=e=>w?e.toUpperCase():e,R=-1===a.strand?-1:1,S="genomic"===j&&h&&!m,v=S?R:1;let y=S?R>0?a.start+1-(s?.length||0):a.end+(s?.length||0):0,P=0,$=0,_=null;if(s){const{segments:e,remainder:t}=d({str:k(s),charactersPerRow:p,showCoordinates:x});_=(0,i.jsx)(u,{model:g,color:l,strand:v,start:P,coordStart:y,chunks:e}),$=t,P+=s.length*v,y+=s.length*v}const I=[];for(let e=0;e<C.length;e++){const t=C[e],r=n.slice(t.end,C[e+1]?.start),s=n.slice(t.start,t.end),{segments:o,remainder:a}=d({str:b?"CDS"===t.type?q(s):k(s):q(s),charactersPerRow:p,currRemainder:$,showCoordinates:x});if(I.push((0,i.jsx)(u,{model:g,color:"CDS"===t.type?c:"rgb(200,240,240)",strand:v,start:P,coordStart:y,chunks:o},`${JSON.stringify(t)}-mid`)),$=a,P+=s.length*v,y+=s.length*v,r&&h&&e<C.length-1){const e=k(m&&r.length>2*f?`${r.slice(0,f)}...${r.slice(-f)}`:r),{segments:n,remainder:s}=d({str:e,charactersPerRow:p,currRemainder:$,showCoordinates:x});n.length&&(I.push((0,i.jsx)(u,{model:g,strand:v,coordStart:y,start:P,chunks:n},`${JSON.stringify(t)}-intron`)),$=s,P+=e.length*v,y+=e.length*v)}}let F=null;if(o){const{segments:e}=d({str:k(o),charactersPerRow:p,currRemainder:$,showCoordinates:x});F=(0,i.jsx)(u,{start:P,model:g,strand:v,chunks:e,coordStart:y,color:l})}return(0,i.jsxs)(i.Fragment,{children:[_,I,F]})})),m=(0,s.observer)((function({cds:e,sequence:t,model:r}){const{charactersPerRow:n,showCoordinates:s}=r,{segments:o}=d({str:(0,a.o9)(e,t),charactersPerRow:n,showCoordinates:s});return(0,i.jsx)(u,{model:r,color:c,chunks:o,start:0})})),g=(0,s.observer)((function({sequence:e,upstream:t,feature:r,downstream:n,model:s}){const{charactersPerRow:o,showCoordinatesSetting:a,showCoordinates:c}=s;let h=0,m=null,g=0;const w=-1===r.strand?-1:1,f="genomic"===a,p=f?w:1;let x=f?w>0?r.start+1-(t?.length||0):r.end+(t?.length||0):0;if(t){const{segments:e,remainder:r}=d({str:t,charactersPerRow:o,showCoordinates:c});m=(0,i.jsx)(u,{model:s,color:l,start:h,coordStart:x,chunks:e}),g=r,h+=t.length*p,x+=t.length*p}const{segments:j,remainder:b}=d({str:e,charactersPerRow:o,showCoordinates:c,currRemainder:g}),C=(0,i.jsx)(u,{model:s,color:"rgb(200,280,200)",start:h,coordStart:x,chunks:j});g=b,h+=e.length*p,x+=e.length*p;let k=null;if(n){const{segments:e}=d({str:n,charactersPerRow:o,currRemainder:g,showCoordinates:c});k=(0,i.jsx)(u,{start:h,model:s,chunks:e,coordStart:x,color:l})}return(0,i.jsxs)(i.Fragment,{children:[m,C,k]})})),w=(0,s.observer)((function({cds:e,sequence:t,codonTable:r,model:n}){const{charactersPerRow:s,showCoordinates:o}=n,c=(0,a.o9)(e,t);let l="";for(let e=0;e<c.length;e+=3)l+=r[c.slice(e,e+3)]||"&";const{segments:h}=d({str:l,charactersPerRow:s,showCoordinates:o});return(0,i.jsx)(u,{model:n,color:"rgb(220,160,220)",chunks:h,start:0})})),f=(0,s.observer)((function({mode:e,feature:t,sequence:r,model:n}){let{seq:s,upstream:c="",downstream:l=""}=r;const d=t.subfeatures?.sort(((e,t)=>e.start-t.start)).map((e=>({...e,start:e.start-t.start,end:e.end-t.start})))||[];let u=(0,a.Qq)(d.filter((e=>"CDS"===e.type))),f=(0,a.Qq)(d.filter((e=>e.type?.match(/utr/i)))),p=(0,a.Qq)(d.filter((e=>"exon"===e.type)));return!f.length&&u.length&&p.length&&(f=(0,a.h8)(u,p)),f.length||!u.length||p.length||(f=(0,a.V4)(u,{start:0,end:t.end-t.start,type:"gene"})),-1===t.strand&&([s,c,l]=[(0,o.revcom)(s),(0,o.revcom)(l),(0,o.revcom)(c)],u=(0,a.YC)(u,s.length),p=(0,a.YC)(p,s.length),f=(0,a.YC)(f,s.length)),(0,i.jsx)(i.Fragment,{children:"genomic"===e?(0,i.jsx)(g,{feature:t,model:n,sequence:s}):"genomic_sequence_updownstream"===e?(0,i.jsx)(g,{model:n,feature:t,sequence:s,upstream:c,downstream:l}):"cds"===e?(0,i.jsx)(m,{model:n,cds:u,sequence:s}):"cdna"===e?(0,i.jsx)(h,{model:n,exons:p,feature:t,cds:u,utr:f,sequence:s}):"protein"===e?(0,i.jsx)(w,{model:n,cds:u,codonTable:(0,o.generateCodonTable)(o.defaultCodonTable),sequence:s}):"gene"===e?(0,i.jsx)(h,{model:n,exons:p,feature:t,cds:u,utr:f,sequence:s,includeIntrons:!0}):"gene_collapsed_intron"===e?(0,i.jsx)(h,{model:n,exons:p,feature:t,cds:u,sequence:s,utr:f,includeIntrons:!0,collapseIntron:!0}):"gene_updownstream"===e?(0,i.jsx)(h,{model:n,exons:p,feature:t,cds:u,sequence:s,utr:f,upstream:c,downstream:l,includeIntrons:!0}):"gene_updownstream_collapsed_intron"===e?(0,i.jsx)(h,{model:n,exons:p,feature:t,cds:u,sequence:s,utr:f,upstream:c,downstream:l,includeIntrons:!0,collapseIntron:!0}):(0,i.jsx)("div",{children:"Unknown type"})})})),p=(0,s.observer)((function({mode:e,model:t,feature:r}){return(0,i.jsx)("div",{style:{background:"white"},children:`>${[[r.name||r.id,e].filter((e=>!!e)).join("-"),`${r.refName}:${(0,o.toLocale)(r.start+1)}-${(0,o.toLocale)(r.end)}${n=r.strand,-1===n?"(-)":1===n?"(+)":""}`,e.endsWith("updownstream")?`+/- ${(0,o.toLocale)(t.upDownBp)} up/downstream bp`:""].filter((e=>!!e)).join(" ")}\n`});var n}));function x({children:e}){return(0,i.jsx)("pre",{style:{fontFamily:"monospace",color:"black",fontSize:11},children:e})}function j({children:e}){return(0,i.jsx)("div",{style:{fontFamily:"monospace",color:"black",fontSize:11,maxWidth:600,whiteSpace:"wrap",wordBreak:"break-all"},children:e})}const b=(0,s.observer)((0,n.forwardRef)((function(e,t){const{sequence:r,model:n,feature:s}=e,{showCoordinates:o,mode:a}=n,c=o?x:j;return(0,i.jsx)("div",{"data-testid":"sequence_panel",ref:t,style:{maxHeight:300,overflow:"auto"},children:(0,i.jsxs)(c,{children:[(0,i.jsx)(p,{model:n,mode:a,feature:s}),(0,i.jsx)(f,{model:n,mode:a,feature:s,sequence:r})]})})})))}}]);
//# sourceMappingURL=5669.65d0de3d.chunk.js.map