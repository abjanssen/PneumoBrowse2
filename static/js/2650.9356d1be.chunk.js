"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2650],{57881(e,n,t){t.d(n,{A:()=>b});var o=t(55614),l=t(30128),s=t(46625),r=t(20449),c=t(69301),i=t(64975),a=t(16457),d=t(62633),u=t(59705),h=t(48993),m=t(69566),x=t(31853),f=t.n(x),j=t(44460);const p=(0,s.n)()(e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}));function C(e){const n=(0,o.c)(2),t=(0,l.useRef)(null);let s;return n[0]!==e?(s=(0,j.jsx)(f(),{nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',onStart:g,children:(0,j.jsx)(c.A,{ref:t,...e})}),n[0]=e,n[1]=s):s=n[1],s}function g(e){return`${e.target?.className}`.includes("MuiDialogTitle")}const b=(0,m.observer)(function(e){const{classes:n}=p(),{title:t,children:o,onClose:l}=e;return(0,j.jsx)(i.A,{...e,PaperComponent:C,children:(0,j.jsxs)(a.A,{children:[(0,j.jsxs)(d.A,{style:{cursor:"move"},children:[t,l?(0,j.jsx)(u.A,{className:n.closeButton,onClick:()=>{l()},children:(0,j.jsx)(r.A,{})}):null]}),(0,j.jsx)(h.A,{}),o]})})})},44569(e,n,t){t.d(n,{l:()=>s});var o=t(92558),l=t(18846);function s(e,n){if(!n||0===e.length)return e;if(!e.some(e=>n in e))return e;const t=new Map;for(const o of e){const e=String(o[n]??"");t.set(e,(t.get(e)||0)+1)}const s=Object.fromEntries([...t.entries()].sort((e,n)=>e[1]-n[1]).map(([e],n)=>[e,o.set1[n]||(0,l.randomColor)(e)]));return e.map(e=>({...e,color:s[String(e[n]??"")]}))}},2650(e,n,t){t.r(n),t.d(n,{default:()=>K});var o=t(55614),l=t(30128),s=t(57881),r=t(23886),c=t(46625),i=t(63209),a=t(35703),d=t(44641),u=t(28910),h=t(57081),m=t(44460);function x(e){const n=(0,o.c)(12),{handleClose:t,onConfirm:l}=e;let s,r,c,x,f;return n[0]===Symbol.for("react.memo_cache_sentinel")?(s=(0,m.jsx)(i.A,{children:(0,m.jsx)(h.A,{children:"You have changed the row order. This will clear the cluster tree visualization. Do you want to continue?"})}),n[0]=s):s=n[0],n[1]!==t?(r=(0,m.jsx)(a.A,{onClick:t,color:"primary",children:"Cancel"}),n[1]=t,n[2]=r):r=n[2],n[3]!==t||n[4]!==l?(c=(0,m.jsx)(a.A,{variant:"contained",color:"primary",onClick:()=>{l(),t()},children:"Continue"}),n[3]=t,n[4]=l,n[5]=c):c=n[5],n[6]!==r||n[7]!==c?(x=(0,m.jsxs)(d.A,{children:[r,c]}),n[6]=r,n[7]=c,n[8]=x):x=n[8],n[9]!==t||n[10]!==x?(f=(0,m.jsxs)(u.A,{open:!0,title:"Clear cluster tree?",onClose:t,children:[s,x]}),n[9]=t,n[10]=x,n[11]=f):f=n[11],f}var f=t(62088),j=t(54825),p=t(23149);const C=(0,c.n)()({textAreaFont:{fontFamily:"Courier New"}});function g(e){const n=(0,o.c)(29),{onClose:t,currLayout:s}=e,{classes:r}=C(),[c,u]=(0,l.useState)(""),[h,x]=(0,l.useState)();let g;n[0]!==s||n[1]!==t||n[2]!==c?(g=e=>{const n=c.split("\n").map(w).filter(Boolean),o=n[0].split(/[,\t]/gm);if(!o.includes("name"))return void x(new Error('No "name" column found on line 1'));x("");const l=Object.fromEntries(s.map(b)),r=Object.fromEntries(n.slice(1).map(e=>{const n=e.split(/[,\t]/gm),t=Object.fromEntries(n.map((e,n)=>[o[n],e]));return[t.name,{...t,...l[t.name]}]}));t(s.map(n=>e?{...n,...r[n.name]}:{...r[n.name]}))},n[0]=s,n[1]=t,n[2]=c,n[3]=g):g=n[3];const S=g;let v,A,y,k,_,T,M,F,N,R,H;return n[4]===Symbol.for("react.memo_cache_sentinel")?(v=(0,m.jsx)(j.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),n[4]=v):v=n[4],n[5]!==h?(A=h?(0,m.jsx)(f.A,{error:h}):null,n[5]=h,n[6]=A):A=n[6],n[7]===Symbol.for("react.memo_cache_sentinel")?(y=e=>{u(e.target.value)},n[7]=y):y=n[7],n[8]!==r.textAreaFont?(k={input:{classes:{input:r.textAreaFont}}},n[8]=r.textAreaFont,n[9]=k):k=n[9],n[10]!==k||n[11]!==c?(_=(0,m.jsx)(p.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:c,onChange:y,slotProps:k}),n[10]=k,n[11]=c,n[12]=_):_=n[12],n[13]!==A||n[14]!==_?(T=(0,m.jsxs)(i.A,{children:[v,A,_]}),n[13]=A,n[14]=_,n[15]=T):T=n[15],n[16]!==S?(M=(0,m.jsx)(a.A,{variant:"contained",color:"secondary",onClick:()=>{S(!0)},children:"Update rows"}),n[16]=S,n[17]=M):M=n[17],n[18]!==S?(F=(0,m.jsx)(a.A,{variant:"contained",color:"primary",onClick:()=>{S(!1)},children:"Replace rows"}),n[18]=S,n[19]=F):F=n[19],n[20]!==t?(N=(0,m.jsx)(a.A,{variant:"contained",color:"inherit",onClick:()=>{t()},children:"Cancel"}),n[20]=t,n[21]=N):N=n[21],n[22]!==N||n[23]!==M||n[24]!==F?(R=(0,m.jsxs)(d.A,{children:[M,F,N]}),n[22]=N,n[23]=M,n[24]=F,n[25]=R):R=n[25],n[26]!==R||n[27]!==T?(H=(0,m.jsxs)(m.Fragment,{children:[T,R]}),n[26]=R,n[27]=T,n[28]=H):H=n[28],H}function b(e){return[e.name,e]}function w(e){return e.trim()}function S(){const e=(0,o.c)(1);let n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,m.jsxs)(m.Fragment,{children:["Helpful tips",(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,m.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,m.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,m.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,m.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,m.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,m.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]}),e[0]=n):n=e[0],n}var v=t(44569);const A=new Set(["name","color","label","id","HP"]);function y(e){const n=(0,o.c)(12),{setCurrLayout:t,currLayout:l}=e,s=l[0];if(!s)return null;let r;n[0]!==s?(r=Object.keys(s).filter(_),n[0]=s,n[1]=r):r=n[1];const c=r;let i,d,u;return n[2]!==l||n[3]!==c||n[4]!==t?(i=c.map(e=>(0,m.jsx)(a.A,{variant:"contained",color:"inherit",onClick:()=>{t((0,v.l)(l,e))},children:e},e)),n[2]=l,n[3]=c,n[4]=t,n[5]=i):i=n[5],n[6]!==l||n[7]!==t?(d=(0,m.jsx)(a.A,{onClick:()=>{t(l.map(k))},children:"Clear colors"}),n[6]=l,n[7]=t,n[8]=d):d=n[8],n[9]!==i||n[10]!==d?(u=(0,m.jsxs)("div",{children:["Create color palette based on...",i,d]}),n[9]=i,n[10]=d,n[11]=u):u=n[11],u}function k(e){return{...e,color:void 0}}function _(e){return!A.has(e)}const T=(0,c.n)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8}});function M(e){const n=(0,o.c)(25),{model:t,handleClose:c,title:u,enableBulkEdit:h,enableRowPalettizer:f,showTipsStorageKey:j,SourcesGridComponent:p}=e,C=void 0===u?"Color/arrangement editor":u,b=void 0!==h&&h,w=void 0!==f&&f,v=void 0===j?"setColorDialog-showTips":j,{classes:A}=T(),{sources:k}=t,[_,M]=(0,l.useState)(!1);let F,N;n[0]!==k?(F=k||[],n[0]=k,n[1]=F):F=n[1],n[2]!==F?(N=structuredClone(F),n[2]=F,n[3]=N):N=n[3];const[R,H]=(0,l.useState)(N),[L,G]=(0,r.useLocalStorage)(v,!1),[O,B]=(0,l.useState)(!1);let E,P,I;return n[4]!==p||n[5]!==A||n[6]!==R||n[7]!==b||n[8]!==w||n[9]!==c||n[10]!==t||n[11]!==G||n[12]!==_||n[13]!==L?(E=_&&b?(0,m.jsx)(g,{currLayout:R,onClose:e=>{e&&H(e),M(!1)}}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(i.A,{className:A.content,children:[(0,m.jsxs)("div",{className:A.fr,children:[(0,m.jsx)(a.A,{variant:"contained",onClick:()=>{G(!L)},children:L?"Hide tips":"Show tips"}),b?(0,m.jsx)(a.A,{color:"secondary",variant:"contained",onClick:()=>{M(!_)},children:"Show Bulk row editor"}):null]}),L?(0,m.jsx)(S,{}):null,w?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("br",{}),(0,m.jsx)(y,{currLayout:R,setCurrLayout:H})]}):null,(0,m.jsx)(p,{rows:R,onChange:H,showTips:L})]}),(0,m.jsxs)(d.A,{children:[(0,m.jsx)(a.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),H(t.sources||[])},children:"Clear custom settings"}),(0,m.jsx)(a.A,{variant:"contained",color:"secondary",onClick:()=>{c(),H([...t.sources||[]])},children:"Cancel"}),(0,m.jsx)(a.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{const{sources:e,clusterTree:n}=t;n&&e?.length===R.length&&e.some((e,n)=>e.name!==R[n]?.name)?B(!0):(t.setLayout(R),c())},children:"Submit"})]})]}),n[4]=p,n[5]=A,n[6]=R,n[7]=b,n[8]=w,n[9]=c,n[10]=t,n[11]=G,n[12]=_,n[13]=L,n[14]=E):E=n[14],n[15]!==R||n[16]!==c||n[17]!==t||n[18]!==O?(P=O?(0,m.jsx)(x,{handleClose:()=>{B(!1)},onConfirm:()=>{t.setLayout(R),c()}}):null,n[15]=R,n[16]=c,n[17]=t,n[18]=O,n[19]=P):P=n[19],n[20]!==c||n[21]!==E||n[22]!==P||n[23]!==C?(I=(0,m.jsxs)(s.A,{open:!0,onClose:c,maxWidth:"xl",title:C,children:[E,P]}),n[20]=c,n[21]=E,n[22]=P,n[23]=C,n[24]=I):I=n[24],I}var F=t(37472),N=t(97689),R=t(27529);const H=(0,c.n)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function L(e){const n=(0,o.c)(34),{rows:t,onChange:s,setSelected:c}=e,{classes:i}=H();let a,d;if(n[0]!==t[0]){const{name:e,color:o,baseUri:l,baseName:s,HP:r,...c}=t[0];a=c,n[0]=t[0],n[1]=a}else a=n[1];n[2]===Symbol.for("react.memo_cache_sentinel")?(d={idx:0,field:null},n[2]=d):d=n[2];const[u,h]=(0,l.useState)(d);let x,f,j,p,C,g,b,w,S,v,A;return n[3]===Symbol.for("react.memo_cache_sentinel")?(x={height:400,width:"100%"},n[3]=x):x=n[3],n[4]!==c?(f=e=>{c([...e.ids])},n[4]=c,n[5]=f):f=n[5],n[6]!==s||n[7]!==t?(j={field:"color",headerName:"Color",renderCell:e=>{const{value:n,id:o}=e;return(0,m.jsx)(N.Ay,{color:n||"blue",onChange:e=>{const n=t.find(e=>e.name===o);n&&(n.color=e),s([...t])}})}},n[6]=s,n[7]=t,n[8]=j):j=n[8],n[9]!==t?(p=(0,r.measureGridWidth)(t.map(G)),n[9]=t,n[10]=p):p=n[10],n[11]!==p?(C={field:"name",headerName:"Name",width:p},n[11]=p,n[12]=C):C=n[12],n[13]!==a?(g=Object.keys(a),n[13]=a,n[14]=g):g=n[14],n[15]!==i||n[16]!==t||n[17]!==g?(b=g.map(e=>({field:e,renderCell:e=>{const{value:n}=e;return(0,m.jsx)("div",{className:i.cell,children:(0,m.jsx)(F.A,{html:(0,r.getStr)(n)})})},width:(0,r.measureGridWidth)(t.map(n=>`${n[e]}`))})),n[15]=i,n[16]=t,n[17]=g,n[18]=b):b=n[18],n[19]!==j||n[20]!==C||n[21]!==b?(w=[j,C,...b],n[19]=j,n[20]=C,n[21]=b,n[22]=w):w=n[22],n[23]===Symbol.for("react.memo_cache_sentinel")?(S=[],n[23]=S):S=n[23],n[24]!==u.field||n[25]!==u.idx||n[26]!==s||n[27]!==t?(v=e=>{const n=e[0],o=(u.idx+1)%2,l=n.field||u.field;h({idx:o,field:l}),s(l?[...t].sort((e,n)=>{const t=(0,r.getStr)(e[l]),s=(0,r.getStr)(n[l]);return 1===o?t.localeCompare(s):s.localeCompare(t)}):t)},n[24]=u.field,n[25]=u.idx,n[26]=s,n[27]=t,n[28]=v):v=n[28],n[29]!==t||n[30]!==v||n[31]!==f||n[32]!==w?(A=(0,m.jsx)("div",{style:x,children:(0,m.jsx)(R.z,{checkboxSelection:!0,disableRowSelectionOnClick:!0,getRowId:O,onRowSelectionModelChange:f,rows:t,rowHeight:25,columnHeaderHeight:33,columns:w,sortModel:S,onSortModelChange:v})}),n[29]=t,n[30]=v,n[31]=f,n[32]=w,n[33]=A):A=n[33],A}function G(e){return e.name}function O(e){return e.name}var B=t(94759),E=t(52642),P=t(90632),I=t(4237);function D(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>e-n);let l=0;for(const n of o){const o=Math.max(l,n-t);o>=l&&e.splice(o,0,e.splice(n,1)[0]),l+=1}return e}function W(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>n-e);let l=e.length-1;for(const n of o){const o=Math.min(l,n+t);o<=l&&e.splice(o,0,e.splice(n,1)[0]),l-=1}return e}function z(e){const n=(0,o.c)(55),{selected:t,onChange:s,rows:r,showTips:c}=e,[i,d]=(0,l.useState)(null),[u,h]=(0,l.useState)("blue"),x=!t.length;let f,j,p;n[0]===Symbol.for("react.memo_cache_sentinel")?(f=e=>{d(e.currentTarget)},n[0]=f):f=n[0],n[1]!==x?(j=(0,m.jsx)(a.A,{disabled:x,onClick:f,children:"Change color of selected items"}),n[1]=x,n[2]=j):j=n[2],n[3]!==s||n[4]!==r||n[5]!==t?(p=()=>{s(D([...r],t))},n[3]=s,n[4]=r,n[5]=t,n[6]=p):p=n[6];const C=!t.length;let g;n[7]===Symbol.for("react.memo_cache_sentinel")?(g=(0,m.jsx)(E.A,{}),n[7]=g):g=n[7];const b=c?"Move selected items up":null;let w,S;n[8]!==p||n[9]!==C||n[10]!==b?(w=(0,m.jsxs)(a.A,{onClick:p,disabled:C,children:[g,b]}),n[8]=p,n[9]=C,n[10]=b,n[11]=w):w=n[11],n[12]!==s||n[13]!==r||n[14]!==t?(S=()=>{s(W([...r],t))},n[12]=s,n[13]=r,n[14]=t,n[15]=S):S=n[15];const v=!t.length;let A;n[16]===Symbol.for("react.memo_cache_sentinel")?(A=(0,m.jsx)(B.A,{}),n[16]=A):A=n[16];const y=c?"Move selected items down":null;let k,_;n[17]!==v||n[18]!==y||n[19]!==S?(k=(0,m.jsxs)(a.A,{onClick:S,disabled:v,children:[A,y]}),n[17]=v,n[18]=y,n[19]=S,n[20]=k):k=n[20],n[21]!==s||n[22]!==r||n[23]!==t?(_=()=>{s(D([...r],t,r.length))},n[21]=s,n[22]=r,n[23]=t,n[24]=_):_=n[24];const T=!t.length;let M;n[25]===Symbol.for("react.memo_cache_sentinel")?(M=(0,m.jsx)(I.A,{}),n[25]=M):M=n[25];const F=c?"Move selected items to top":null;let R,H;n[26]!==_||n[27]!==T||n[28]!==F?(R=(0,m.jsxs)(a.A,{onClick:_,disabled:T,children:[M,F]}),n[26]=_,n[27]=T,n[28]=F,n[29]=R):R=n[29],n[30]!==s||n[31]!==r||n[32]!==t?(H=()=>{s(W([...r],t,r.length))},n[30]=s,n[31]=r,n[32]=t,n[33]=H):H=n[33];const L=!t.length;let G;n[34]===Symbol.for("react.memo_cache_sentinel")?(G=(0,m.jsx)(P.A,{}),n[34]=G):G=n[34];const O=c?"Move selected items to bottom":null;let z,Y,K,U,V;return n[35]!==H||n[36]!==L||n[37]!==O?(z=(0,m.jsxs)(a.A,{onClick:H,disabled:L,children:[G,O]}),n[35]=H,n[36]=L,n[37]=O,n[38]=z):z=n[38],n[39]!==s||n[40]!==r||n[41]!==t?(Y=e=>{h(e);for(const n of t){const t=r.find(e=>e.name===n);t&&(t.color=e)}s([...r])},n[39]=s,n[40]=r,n[41]=t,n[42]=Y):Y=n[42],n[43]===Symbol.for("react.memo_cache_sentinel")?(K=()=>{d(null)},n[43]=K):K=n[43],n[44]!==i||n[45]!==Y||n[46]!==u?(U=(0,m.jsx)(N.FO,{anchorEl:i,color:u,onChange:Y,onClose:K}),n[44]=i,n[45]=Y,n[46]=u,n[47]=U):U=n[47],n[48]!==k||n[49]!==R||n[50]!==z||n[51]!==U||n[52]!==j||n[53]!==w?(V=(0,m.jsxs)(m.Fragment,{children:[j,w,k,R,z,U]}),n[48]=k,n[49]=R,n[50]=z,n[51]=U,n[52]=j,n[53]=w,n[54]=V):V=n[54],V}const Y=function(e){const n=(0,o.c)(12),{rows:t,onChange:s,showTips:r}=e;let c;n[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],n[0]=c):c=n[0];const[i,a]=(0,l.useState)(c);let d,u,h;return n[1]!==s||n[2]!==t||n[3]!==i||n[4]!==r?(d=(0,m.jsx)(z,{selected:i,rows:t,showTips:r,onChange:s}),n[1]=s,n[2]=t,n[3]=i,n[4]=r,n[5]=d):d=n[5],n[6]!==s||n[7]!==t?(u=t.length?(0,m.jsx)(L,{rows:t,onChange:s,setSelected:a}):(0,m.jsx)("div",{children:"No rows"}),n[6]=s,n[7]=t,n[8]=u):u=n[8],n[9]!==d||n[10]!==u?(h=(0,m.jsxs)("div",{children:[d,u]}),n[9]=d,n[10]=u,n[11]=h):h=n[11],h};function K(e){const n=(0,o.c)(3),{model:t,handleClose:l}=e,s=t;let r;return n[0]!==l||n[1]!==s?(r=(0,m.jsx)(M,{model:s,handleClose:l,title:"Multi-sample variant display - Color/arrangement editor",enableBulkEdit:!0,enableRowPalettizer:!0,showTipsStorageKey:"multivariant-showTips",SourcesGridComponent:Y}),n[0]=l,n[1]=s,n[2]=r):r=n[2],r}}}]);
//# sourceMappingURL=2650.9356d1be.chunk.js.map