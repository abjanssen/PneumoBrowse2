"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[1777],{61777(e,i,n){n.d(i,{doAfterAttach:()=>d});var a=n(77251),t=n(8201),s=n(70203),r=n(52901),o=n(99226),c=n(42456),l=n(38567);function d(e){(async()=>{try{const{rpcManager:i}=(0,a.getSession)(e),n=(0,s.getRpcSessionId)(e),{norms:t}=await i.call(n,"CoreGetInfo",{adapterConfig:e.adapterConfig});(0,o.isAlive)(e)&&t&&e.setAvailableNormalizations(t)}catch(i){console.error(i),(0,o.isAlive)(e)&&(0,a.getSession)(e).notifyError(`${i}`,i)}})(),(0,o.addDisposer)(e,(0,l.autorun)(()=>{if(e.isMinimized)return;const i=(0,a.getContainingView)(e);if(!i.initialized)return;const{dynamicBlocks:n}=i,c=n.contentBlocks;e.resolution,e.useLogScale,e.colorScheme,e.activeNormalization,e.mode,e.height,!(0,l.untracked)(()=>e.error)&&c.length&&(async()=>{if(e.isMinimized)return;const i=(0,a.getContainingView)(e),{bpPerPx:n,dynamicBlocks:c}=i,d=c.contentBlocks;if(!d.length)return;const{adapterConfig:g}=e,p=e.renderProps();try{const t=(0,a.getSession)(e),{rpcManager:c}=t,u=(0,s.getRpcSessionId)(e),f=(0,l.untracked)(()=>e.renderingStopToken);f&&(0,r.CF)(f);const m=(0,r.y5)();e.setRenderingStopToken(m),e.setLoading(!0);const h=await c.call(u,"CoreRender",{sessionId:u,rendererType:"HicRenderer",regions:[...d],adapterConfig:g,bpPerPx:n,stopToken:m,...p},{statusCallback:i=>{(0,o.isAlive)(e)&&e.setStatusMessage(i)}});h.imageData&&(e.setRenderingImageData(h.imageData),e.setLastDrawnOffsetPx(i.offsetPx)),e.setFlatbushData(h.flatbush,h.items??[],h.maxScore??0,h.yScalar??1)}catch(i){(0,t.Kp)(i)||(0,o.isAlive)(e)&&e.setError(i)}finally{(0,o.isAlive)(e)&&(e.setRenderingStopToken(void 0),e.setLoading(!1))}})()},{delay:1e3,name:"LinearHicDisplayRender"})),(0,o.addDisposer)(e,(0,l.autorun)(()=>{e.isMinimized||(0,a.getContainingView)(e).initialized&&(0,c.y6)(e.ref,e.renderingImageData)},{name:"LinearHicDisplayCanvas"}))}}}]);
//# sourceMappingURL=1777.110c7346.chunk.js.map