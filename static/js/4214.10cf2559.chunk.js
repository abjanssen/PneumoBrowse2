"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[4214],{24214(e,t,n){n.d(t,{doAfterAttach:()=>d});var i=n(77251),a=n(8201),r=n(70203),s=n(52901),o=n(99226),l=n(42456),c=n(38567);function d(e){(0,o.addDisposer)(e,(0,c.autorun)(()=>{if(e.isMinimized)return;const t=(0,i.getContainingView)(e);if(!t.initialized)return;const{dynamicBlocks:n}=t,l=n.contentBlocks;e.ldMetric,e.minorAlleleFrequencyFilter,e.lengthCutoffFilter,e.hweFilterThreshold,e.callRateFilter,e.colorScheme,e.showLDTriangle,e.fitToHeight,e.useGenomicPositions,e.signedLD,e.fitToHeight&&e.ldCanvasHeight,!(0,c.untracked)(()=>e.error)&&l.length&&(async()=>{if(e.isMinimized)return;if(!e.showLDTriangle)return;const t=(0,i.getContainingView)(e),{bpPerPx:n,dynamicBlocks:l}=t,d=l.contentBlocks;if(!d.length)return;if(n>1e3)return;const{adapterConfig:g}=e,u=(0,c.untracked)(()=>e.renderProps());try{const a=(0,i.getSession)(e),{rpcManager:l}=a,f=(0,r.getRpcSessionId)(e),p=(0,c.untracked)(()=>e.renderingStopToken);p&&(0,s.CF)(p);const h=(0,s.y5)();e.setRenderingStopToken(h),e.setLoading(!0),e.setCanvasDrawn(!1);const D=await l.call(f,"CoreRender",{sessionId:f,rendererType:"LDRenderer",regions:[...d],adapterConfig:g,bpPerPx:n,stopToken:h,...u},{statusCallback:t=>{(0,o.isAlive)(e)&&e.setStatusMessage(t)}});D.imageData&&(e.setRenderingImageData(D.imageData),e.setLastDrawnOffsetPx(t.offsetPx),e.setLastDrawnBpPerPx(t.bpPerPx)),e.setFlatbushData(D.flatbush,D.items??[],D.ldData?.snps??[],D.maxScore??1,D.yScalar??1,D.w??0),e.setFilterStats(D.filterStats),e.setRecombination(D.recombination)}catch(t){(0,a.Kp)(t)||(console.error(t),(0,o.isAlive)(e)&&e.setError(t))}finally{(0,o.isAlive)(e)&&(e.setRenderingStopToken(void 0),e.setLoading(!1))}})()},{delay:500,name:"LDDisplayRender"})),(0,o.addDisposer)(e,(0,c.autorun)(()=>{if(e.isMinimized)return;if(!(0,i.getContainingView)(e).initialized)return;const t=(0,l.y6)(e.ref,e.renderingImageData);(0,o.isAlive)(e)&&e.setCanvasDrawn(t)},{delay:1e3,name:"LDDisplayCanvas"}))}}}]);
//# sourceMappingURL=4214.10cf2559.chunk.js.map