"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[6214],{86214:(e,t,r)=>{r.r(t),r.d(t,{default:()=>d});var n=r(60972),s=r(46377),a=r(99834),i=r(66885),o=r(99546),c=r(68120),u=r(28493);class d extends s.BaseFeatureDataAdapter{static capabilities=["getFeatures","getRefNames"];constructor(e,t,r){super(e,t,r);const s=this.getConf("bedGzLocation"),i=this.getConf(["index","indexType"]),o=this.getConf(["index","location"]),u=this.getConf("autoSql"),d=this.pluginManager;this.bed=new c.wD({filehandle:(0,a.openLocation)(s,d),csiFilehandle:"CSI"===i?(0,a.openLocation)(o,d):void 0,tbiFilehandle:"CSI"!==i?(0,a.openLocation)(o,d):void 0,chunkCacheSize:52428800}),this.columnNames=this.getConf("columnNames"),this.scoreColumn=this.getConf("scoreColumn"),this.parser=new n.A({autoSql:u})}async getRefNames(e={}){return this.bed.getReferenceSequenceNames(e)}async getHeader(){return this.bed.getHeader()}async getNames(){if(this.columnNames.length)return this.columnNames;const e=(await this.bed.getHeader()).split(/\n|\r\n|\r/).filter((e=>!!e)).at(-1);return e?.includes("\t")?e.slice(1).split("\t").map((e=>e.trim())):void 0}getFeatures(e,t={}){return(0,i.ObservableCreate)((async r=>{const n=await this.bed.getMetadata(),{columnNumbers:s}=n,a=s.ref-1,i=s.start-1,c=s.end-1,d=await this.getNames();await this.bed.getLines(e.refName,e.start,e.end,{lineCallback:(e,t)=>{r.next(new o.SimpleFeature((0,u.dE)({line:e,colRef:a,colStart:i,colEnd:c,scoreColumn:this.scoreColumn,parser:this.parser,uniqueId:`${this.id}-${t}`,names:d})))},signal:t.signal}),r.complete()}),t.signal)}freeResources(){}}},28493:(e,t,r)=>{function n(e){const t=e?.trim().split(" ");return[0,1,2,3,5,6].every((e=>void 0!==t?.[e]&&!Number.isNaN(+t[e])))}function s(e){if(n(e)){const[t,r,n,s,a,i,o,c,u,d,l,m,p,f,h]=e.trim().split(" ");return{bitsw_score:t,percent_div:r,percent_del:n,percent_ins:s,query_chr:a,query_begin:i,query_end:o,query_remaining:c,orientation:u,matching_repeat_name:d,matching_repeat_class:l,matching_repeat_begin:m,matching_repeat_end:p,matching_repeat_remaining:f,repeat_id:h}}return{description:e}}function a({line:e,colRef:t,colStart:r,colEnd:n,scoreColumn:s,parser:a,uniqueId:o,names:c}){const u=e.split("\t");return i({line:e,refName:u[t],start:+u[r],end:+u[n]+(r===n?1:0),parser:a,uniqueId:o,scoreColumn:s,names:c})}function i({line:e,refName:t,start:r,end:a,parser:i,uniqueId:c,scoreColumn:u,names:d}){const l=e.split("\t"),m=d?function(e,t){const r=Object.fromEntries(t.split("\t").map(((t,r)=>[e[r],t]))),{blockStarts:n,blockCount:s,chromStarts:a,thickEnd:i,thickStart:c,blockSizes:u,...d}=r;return{...d,blockStarts:o(n),chromStarts:o(a),blockSizes:o(u),thickStart:c?+c:void 0,thickEnd:i?+i:void 0,blockCount:s?+s:void 0}}(d,e):i.parseLine(e,{uniqueId:c}),{strand:p,score:f,chrom:h,chromStart:b,chromEnd:_,...k}=m,{chromStarts:S,blockSizes:N,blockStarts:g,type:C,blockCount:y,thickStart:q,thickEnd:v,description:I,...w}=k,R=u?+m[u]:f?+f:void 0,E="string"==typeof p?"-1"===(z=p)?-1:"+"===z?1:0:p;var z;const T=function({start:e,uniqueId:t,refName:r,chromStarts:n,blockCount:s,blockSizes:a,blockStarts:i}){if(s){const o=[],c=n||i||[];for(let n=0;n<s;n++){const s=(c[n]||0)+e,i=a?.[n];if(i&&i>0){const e=s+i;o.push({uniqueId:`${t}-${n}`,start:s,end:e,refName:r,type:"block"})}}return o}return[]}({start:r,uniqueId:c,refName:t,chromStarts:S,blockCount:y,blockSizes:N,blockStarts:g});return function({splitLine:e,start:t,end:r}){return+(e[6]||0)===t&&+(e[7]||0)===r}({splitLine:l,start:r,end:a})?function({line:e,uniqueId:t,refName:r,start:n,end:s}){const[,,,a,,i,,,o,c,u,d,l,m,p,f,h,b]=e.split("\t");return{uniqueId:t,refName:r,start:n,end:s,code:a,score:u,strand:i,color:o,source:a,n_valid_cov:c,fraction_modified:u,n_mod:d,n_canonical:l,n_other_mod:m,n_delete:p,n_fail:f,n_diff:h,n_nocall:b}}({line:e,uniqueId:c,refName:t,start:r,end:a}):n(I)?function({uniqueId:e,refName:t,start:r,end:n,description:a,...i}){return{...i,...s(a),uniqueId:e,refName:t,start:r,end:n}}({...w,uniqueId:c,description:I,type:C,score:R,start:r,end:a,strand:E,refName:t,subfeatures:T}):function({thickStart:e,blockCount:t,strand:r}){return e&&t&&0!==r}({strand:E,blockCount:y,thickStart:q})?function(e){const{strand:t=0,chrom:r,chromStart:n,chromEnd:s,chromStarts:a,blockStarts:i,blockSizes:o,uniqueId:c,...u}=e,{subfeatures:d,thickStart:l,thickEnd:m,blockCount:p,refName:f,...h}=u,b=[],_=d.filter((e=>"block"===e.type)).sort(((e,t)=>e.start-t.start));for(const e of _){const r=e.start,n=e.end;l>=n?b.push({type:(t>0?"five":"three")+"_prime_UTR",start:r,end:n,refName:f}):l>r&&l<n&&m>=n?b.push({type:(t>0?"five":"three")+"_prime_UTR",start:r,end:l,refName:f},{type:"CDS",start:l,end:n,refName:f}):l<=r&&m>=n?b.push({type:"CDS",start:r,end:n,refName:f}):l>r&&l<n&&m<n?b.push({type:(t>0?"five":"three")+"_prime_UTR",start:r,end:l,refName:f},{type:"CDS",start:l,end:m,refName:f},{type:(t>0?"three":"five")+"_prime_UTR",start:m,end:n,refName:f}):l<=r&&m>r&&m<n?b.push({type:"CDS",start:r,end:m,refName:f},{type:(t>0?"three":"five")+"_prime_UTR",start:m,end:n,refName:f}):m<=r&&b.push({type:(t>0?"three":"five")+"_prime_UTR",start:r,end:n,refName:f})}return{...h,uniqueId:c,strand:t,type:"mRNA",refName:f,subfeatures:b}}({...k,description:I,chromStarts:S,thickStart:q,thickEnd:v,blockSizes:N,blockCount:y,type:C,score:R,start:r,end:a,strand:E,refName:t,uniqueId:c,subfeatures:T}):{...k,uniqueId:c,description:I,type:C,score:R,start:r,end:a,strand:E,refName:t,subfeatures:T}}function o(e){return void 0!==e?"string"==typeof e?e.split(",").map((e=>+e)):e:void 0}r.d(t,{dE:()=>a,np:()=>i})}}]);
//# sourceMappingURL=6214.ac6a34fc.chunk.js.map