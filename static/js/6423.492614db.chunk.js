"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[6423],{16423:(e,t,n)=>{n.r(t),n.d(t,{default:()=>K});var s=n(68446),o=n(75785),i=n(7552),r=n(23758),l=n(90542),a=n(2020),c=n(31294),d=n(36866),u=n(48747),m=n(69500);const f=(0,s.observer)(function({model:e}){const t=e.levels[0]?.tracks[0]?.displays[0],n=t?.colorBy??"default",s=t=>{for(const n of e.levels)for(const e of n.tracks)for(const n of e.displays)n.setColorBy(t)};return(0,m.jsx)(r.A,{menuItems:[{label:"Default",type:"radio",checked:"default"===n,onClick:()=>{s("default")},helpText:"Use the default color scheme with CIGAR operation coloring. Insertions, deletions, matches, and mismatches are shown in different colors with transparency."},{label:"Strand",type:"radio",checked:"strand"===n,onClick:()=>{s("strand")},helpText:"Color alignments by strand orientation. Forward strand alignments and reverse strand alignments are shown in different colors, making it easy to identify inversions and strand-specific patterns."},{label:"Query",type:"radio",checked:"query"===n,onClick:()=>{s("query")},helpText:"Color alignments by query sequence name. Each unique query sequence is assigned a consistent color based on its name, making it easy to visually distinguish between different sequences."}],children:(0,m.jsx)(u.A,{})})});var h=n(99546),p=n(90863),b=n(61282);const v=(0,o.n9)()(()=>({bp:{display:"flex",alignItems:"center",marginLeft:10},searchBox:{display:"flex"}})),x=(0,s.observer)(function({view:e}){const{classes:t}=v(),{assemblyDisplayNames:n,coarseTotalBp:s}=e;return(0,m.jsxs)("span",{className:t.searchBox,children:[(0,m.jsx)(p.Gd,{model:e,showHelp:!1}),(0,m.jsxs)(b.A,{variant:"body2",color:"textSecondary",className:t.bp,children:[n.join(",")," ",(0,h.getBpDisplayStr)(s)]})]})});var g=n(28097),y=n(14332),w=n(67758),j=n(37962);function k(e){const t=(0,w.c)(4),{children:n,open:s,value:o}=e;let i;return t[0]!==n||t[1]!==s||t[2]!==o?(i=(0,m.jsx)(j.A,{open:s,enterTouchDelay:0,placement:"top",title:o,arrow:!0,children:n}),t[0]=n,t[1]=s,t[2]=o,t[3]=i):i=t[3],i}const M=(0,o.n9)()({container:{display:"flex",alignItems:"center",marginLeft:16,marginRight:16,minWidth:150}}),C=(0,s.observer)(function({model:e}){const{classes:t}=M(),{levels:n}=e,s=n[0]?.tracks[0]?.displays[0],o=s?.minAlignmentLength??0,[r,l]=(0,i.useState)(100*Math.log2(Math.max(1,o)));return(0,i.useEffect)(()=>{l(100*Math.log2(Math.max(1,o)))},[o]),(0,m.jsxs)(g.A,{className:t.container,children:[(0,m.jsx)(b.A,{variant:"body2",style:{marginRight:8},children:"Min length:"}),(0,m.jsx)(y.Ay,{value:r,onChange:(e,t)=>{l(t)},onChangeCommitted:()=>{const e=Math.round(2**(r/100));for(const t of n)for(const n of t.tracks)for(const t of n.displays)t.setMinAlignmentLength(e)},min:0,max:100*Math.log2(1e6),valueLabelDisplay:"auto",valueLabelFormat:e=>Math.round(2**(e/100)).toLocaleString(),size:"small",style:{minWidth:100},slots:{valueLabel:k}})]})}),O=(0,o.n9)()({container:{display:"flex",alignItems:"center",marginLeft:16,marginRight:16,minWidth:150}}),S=(0,s.observer)(function({model:e}){const{classes:t}=O(),{levels:n}=e,s=n[0]?.tracks[0]?.displays[0],o=e=>Math.pow(e,3),i=(r=s?.alpha??1,Math.pow(r,1/3));var r;return(0,m.jsxs)(g.A,{className:t.container,children:[(0,m.jsx)(b.A,{variant:"body2",style:{marginRight:8},children:"Opacity:"}),(0,m.jsx)(y.Ay,{value:i,onChange:(e,t)=>{const s="number"==typeof t?t:t[0],i=o(s);for(const e of n)for(const t of e.tracks)for(const e of t.displays)e.setAlpha(i)},min:0,max:1,step:.01,valueLabelDisplay:"auto",size:"small",style:{minWidth:100},slots:{valueLabel:k},valueLabelFormat:e=>o(e).toFixed(3)})]})}),B=(0,o.n9)()({inline:{display:"inline-flex"}}),A=(0,s.observer)(function({model:e}){const{classes:t}=B(),{views:n,levels:s,showDynamicControls:o}=e,[u,h]=(0,i.useState)(n.length<=3),[p,b]=(0,i.useState)(n.length<=3),v=s[0]?.tracks[0]?.displays[0];return(0,m.jsxs)(d.A,{row:!0,children:[(0,m.jsx)(r.A,{menuItems:[{label:"Synteny track selectors",type:"subMenu",subMenu:n.slice(0,-1).map((t,s)=>({label:`Row ${s+1}->${s+2} (${n[s].assemblyNames.join(",")}->${n[s+1].assemblyNames.join(",")})`,onClick:()=>{e.activateTrackSelector(s)}}))},{label:"Row track selectors",type:"subMenu",subMenu:n.map((e,t)=>({label:`Row ${t+1} track selector (${e.assemblyNames.join(",")})`,onClick:()=>e.activateTrackSelector()}))}],children:(0,m.jsx)(l.xU,{})}),(0,m.jsx)(r.A,{menuItems:[{label:"Row view menus",type:"subMenu",subMenu:n.map((e,t)=>({label:`View ${t+1} Menu`,subMenu:e.menuItems()}))},...e.headerMenuItems()],children:(0,m.jsx)(a.A,{})}),(0,m.jsx)(r.A,{menuItems:[{label:"Show search boxes",type:"checkbox",checked:u,onClick:()=>{h(!u)}},{label:"Orientation - Side-by-side",type:"radio",checked:p,onClick:()=>{b(!p)}},{label:"Orientation - Vertical",type:"radio",checked:!p,onClick:()=>{b(!p)}}],children:(0,m.jsx)(c.A,{})}),v&&o?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(f,{model:e}),(0,m.jsx)(S,{model:e}),(0,m.jsx)(C,{model:e})]}):null,u?(0,m.jsx)("span",{className:p?t.inline:void 0,children:n.map(e=>(0,m.jsx)(x,{view:e},e.id))}):null]})});var I=n(68584),N=n(67112);const T=(0,o.n9)()({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},resizeHandle:{height:4,background:"#ccc"}});function D(e){const t=(0,w.c)(5),{view:n}=e;let s;if(t[0]!==n){const{pluginManager:e}=(0,h.getEnv)(n);s=e.getViewType(n.type),t[0]=n,t[1]=s}else s=t[1];const{ReactComponent:o}=s;let i;return t[2]!==o||t[3]!==n?(i=(0,m.jsx)(o,{model:n}),t[2]=o,t[3]=n,t[4]=i):i=t[4],i}const L=(0,s.observer)(function({model:e}){const{classes:t}=T(),{views:n,levels:s}=e;return(0,m.jsx)("div",{className:t.container,children:n.map((n,o)=>(0,m.jsxs)(m.Fragment,{children:[o>0?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("div",{className:t.container,children:(0,m.jsx)(R,{model:e,level:o-1})}),(0,m.jsx)(N.ResizeHandle,{onDrag:e=>s[o-1]?.setHeight((s[o-1]?.height||0)+e),className:t.resizeHandle})]}):null,(0,m.jsx)(D,{view:n})]},n.id))})}),R=(0,s.observer)(function({model:e,level:t}){const{classes:n}=T();return(0,m.jsx)(m.Fragment,{children:e.levels[t]?.tracks.map(e=>{const[t]=e.displays,{RenderingComponent:s}=t,o=(0,I.getConf)(e,"trackId");return s?(0,m.jsx)("div",{className:n.overlay,style:{height:t.height,overflow:"hidden"},children:(0,m.jsx)(s,{model:t})},o):null})})}),E=L;var _=n(62266);function $(e){const t=(0,w.c)(8),{anchorEl:n,side:s,text:o}=e,i="left"===s?"left-start":"right-start";let r,l,a,c;return t[0]===Symbol.for("react.memo_cache_sentinel")?(r=[{name:"offset",options:{offset:[-30,-10]}}],t[0]=r):r=t[0],t[1]!==n?(l={popper:{anchorEl:n,modifiers:r}},t[1]=n,t[2]=l):l=t[2],t[3]===Symbol.for("react.memo_cache_sentinel")?(a=(0,m.jsx)("span",{}),t[3]=a):a=t[3],t[4]!==i||t[5]!==l||t[6]!==o?(c=(0,m.jsx)(j.A,{title:o,open:!0,placement:i,slotProps:l,children:a}),t[4]=i,t[5]=l,t[6]=o,t[7]=c):c=t[7],c}const F=(0,o.n9)()(e=>{const{tertiary:t}=e.palette;return{rubberband:{height:"100%",background:(0,_.X4)(t.light,.7),position:"absolute",zIndex:830,textAlign:"center"},rubberbandText:{color:e.palette.tertiary.contrastText}}});function X(e){const t=(0,w.c)(19),{leftBpOffset:n,rightBpOffset:s,numOfBpSelected:o,left:r,width:l,top:a,sticky:c}=e,d=void 0===a?0:a,u=void 0!==c&&c,{classes:f}=F(),[h,p]=(0,i.useState)(null);let v,x,g,y,j;return t[0]!==h||t[1]!==n||t[2]!==s?(v=h?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)($,{side:"left",anchorEl:h,text:n.map(P)}),(0,m.jsx)($,{side:"right",anchorEl:h,text:s.map(q)})]}):null,t[0]=h,t[1]=n,t[2]=s,t[3]=v):v=t[3],t[4]!==r||t[5]!==l?(x={left:r,width:l},t[4]=r,t[5]=l,t[6]=x):x=t[6],t[7]!==f.rubberbandText||t[8]!==o||t[9]!==u||t[10]!==d?(g=o?(0,m.jsx)(b.A,{ref:e=>{p(e)},variant:"h6",className:f.rubberbandText,style:{top:d,position:u?"sticky":void 0},children:o.map(z)}):null,t[7]=f.rubberbandText,t[8]=o,t[9]=u,t[10]=d,t[11]=g):g=t[11],t[12]!==f.rubberband||t[13]!==x||t[14]!==g?(y=(0,m.jsx)("div",{className:f.rubberband,style:x,children:g}),t[12]=f.rubberband,t[13]=x,t[14]=g,t[15]=y):y=t[15],t[16]!==v||t[17]!==y?(j=(0,m.jsxs)(m.Fragment,{children:[v,y]}),t[16]=v,t[17]=y,t[18]=j):j=t[18],j}function z(e,t){return(0,m.jsx)("div",{children:(0,h.getBpDisplayStr)(e)},`bpSelectedRow-${t}`)}function q(e,t){return(0,m.jsx)("div",{children:(0,h.stringify)(e,!0)},`${JSON.stringify(e)}-right-${t}`)}function P(e,t){return(0,m.jsx)("div",{children:(0,h.stringify)(e,!0)},`${JSON.stringify(e)}-left-${t}`)}const H=(0,o.n9)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",background:"red",zIndex:1001}}),W=(0,s.observer)(function({model:e,coordX:t}){const{classes:n}=H();return(0,m.jsx)(j.A,{open:!0,placement:"top",title:e.views.map(e=>e.pxToBp(t)).map((e,t)=>(0,m.jsx)("div",{children:(0,h.stringify)(e,!0)},[JSON.stringify(e),t].join("-"))),arrow:!0,children:(0,m.jsx)("div",{className:n.guide,style:{left:t}})})});var J=n(42489);function V(e,t){return e.clientX-(t?.getBoundingClientRect().left||0)}function Y(){}const G=(0,o.n9)()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8,position:"relative",zIndex:900}}),U=(0,s.observer)(function({model:e,ControlComponent:t=(0,m.jsx)("div",{})}){const n=(0,i.useRef)(null),{classes:s}=G(),{guideX:o,rubberbandOn:r,leftBpOffset:l,rightBpOffset:a,numOfBpSelected:c,width:d,left:u,anchorPosition:f,open:h,handleMenuItemClick:p,handleClose:b,mouseMove:v,mouseDown:x,mouseOut:g}=function(e,t){const n=(0,w.c)(48),[s,o]=(0,i.useState)(),[r,l]=(0,i.useState)(),[a,c]=(0,i.useState)(),[d,u]=(0,i.useState)(),m=void 0!==s&&void 0===a;let f;n[0]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{c(void 0),o(void 0),l(void 0)},n[0]=f):f=n[0];const h=f;let p,b,v;n[1]!==t||n[2]!==m||n[3]!==e||n[4]!==s?(p=()=>{const n=function(t){if(e.current&&m){const n=V(t,e.current);l(n)}},o=function(n){if(void 0!==s&&e.current){const{clientX:o,clientY:i}=n,r=V(n,e.current);if(Math.abs(r-s)<=3)return void h();c({offsetX:r,clientX:o,clientY:i});const l=function(e){if(void 0===s)return;const n=Math.min(s,e),o=Math.max(s,e);return t.views.map(e=>({leftOffset:e.pxToBp(n),rightOffset:e.pxToBp(o)}))}(r);l&&(0,J.transaction)(()=>{for(const[e,n]of l.entries())t.views[e].setOffsets(n.leftOffset,n.rightOffset)}),u(void 0)}};return m?(window.addEventListener("mousemove",n),window.addEventListener("mouseup",o),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",o)}):Y},b=[s,m,t,e,h],n[1]=t,n[2]=m,n[3]=e,n[4]=s,n[5]=p,n[6]=b):(p=n[5],b=n[6]),(0,i.useEffect)(p,b),n[7]!==e?(v=function(t){t.preventDefault(),t.stopPropagation();const n=V(t,e.current);o(n),l(n)},n[7]=e,n[8]=v):v=n[8];const x=v;let g;n[9]!==e?(g=function(t){u(V(t,e.current))},n[9]=e,n[10]=g):g=n[10];const y=g;let j;n[11]!==t?(j=function(){u(void 0),(0,J.transaction)(()=>{for(const e of t.views)e.setOffsets(void 0,void 0)})},n[11]=t,n[12]=j):j=n[12];const k=j;let M;n[13]===Symbol.for("react.memo_cache_sentinel")?(M=function(e,t){t(),h()},n[13]=M):M=n[13];const C=M,O=Boolean(a);if(void 0===s){let e;return n[14]!==d||n[15]!==x||n[16]!==y||n[17]!==k||n[18]!==O?(e={open:O,guideX:d,mouseDown:x,mouseMove:y,mouseOut:k,handleMenuItemClick:C},n[14]=d,n[15]=x,n[16]=y,n[17]=k,n[18]=O,n[19]=e):e=n[19],e}const S=a?a.offsetX:r||0,B=Math.min(S,s),A=Math.abs(S-s);let I;if(n[20]!==B||n[21]!==t.views){let e;n[23]!==B?(e=e=>e.pxToBp(B),n[23]=B,n[24]=e):e=n[24],I=t.views.map(e),n[20]=B,n[21]=t.views,n[22]=I}else I=n[22];const N=I;let T;if(n[25]!==B||n[26]!==t.views||n[27]!==A){let e;n[29]!==B||n[30]!==A?(e=e=>e.pxToBp(B+A),n[29]=B,n[30]=A,n[31]=e):e=n[31],T=t.views.map(e),n[25]=B,n[26]=t.views,n[27]=A,n[28]=T}else T=n[28];const D=T;let L;if(n[32]!==t.views||n[33]!==A){let e;n[35]!==A?(e=e=>Math.ceil(A*e.bpPerPx),n[35]=A,n[36]=e):e=n[36],L=t.views.map(e),n[32]=t.views,n[33]=A,n[34]=L}else L=n[34];const R=L;let E;return n[37]!==a||n[38]!==B||n[39]!==N||n[40]!==x||n[41]!==y||n[42]!==k||n[43]!==R||n[44]!==O||n[45]!==D||n[46]!==A?(E={open:O,rubberbandOn:!0,mouseDown:x,mouseMove:y,mouseOut:k,handleClose:h,handleMenuItemClick:C,leftBpOffset:N,rightBpOffset:D,anchorPosition:a,numOfBpSelected:R,width:A,left:B},n[37]=a,n[38]=B,n[39]=N,n[40]=x,n[41]=y,n[42]=k,n[43]=R,n[44]=O,n[45]=D,n[46]=A,n[47]=E):E=n[47],E}(n,e);return(0,m.jsxs)(m.Fragment,{children:[void 0!==o?(0,m.jsx)(W,{model:e,coordX:o}):r?(0,m.jsx)(X,{leftBpOffset:l,rightBpOffset:a,numOfBpSelected:c,width:d,left:u}):null,f?(0,m.jsx)(N.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:f.clientX,top:f.clientY},onMenuItemClick:p,open:h,onClose:b,menuItems:e.rubberBandMenuItems()}):null,(0,m.jsx)("div",{"data-testid":"rubberband_controls",className:s.rubberbandControl,ref:n,onMouseDown:x,onMouseMove:v,onMouseOut:g,children:t})]})}),Q=(0,o.n9)()(e=>({rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:e.palette.action.disabledBackground,height:15,"&:hover":{background:e.palette.action.selected}}})),K=(0,s.observer)(function({model:e}){const{classes:t}=Q();return(0,m.jsxs)("div",{className:t.rubberbandContainer,children:[(0,m.jsx)(A,{model:e}),(0,m.jsx)(U,{model:e,ControlComponent:(0,m.jsx)("div",{className:t.rubberbandDiv})}),(0,m.jsx)(E,{model:e})]})})}}]);
//# sourceMappingURL=6423.492614db.chunk.js.map