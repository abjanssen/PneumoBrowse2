"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8142],{78142:(e,n,t)=>{t.r(n),t.d(n,{default:()=>z});var s=t(68446),o=t(75785),r=t(7552),i=t(23758),a=t(90542),l=t(2020),c=t(31294),d=t(36866),u=t(99546),p=t(53179),m=t(61282),h=t(69500);const b=(0,o.n9)()((()=>({bp:{display:"flex",alignItems:"center",marginLeft:10},searchBox:{display:"flex"}}))),v=(0,s.observer)((function({view:e}){const{classes:n}=b(),{assemblyDisplayNames:t,coarseTotalBp:s}=e;return(0,h.jsxs)("span",{className:n.searchBox,children:[(0,h.jsx)(p.Gd,{model:e,showHelp:!1}),(0,h.jsxs)(m.A,{variant:"body2",color:"textSecondary",className:n.bp,children:[t.join(",")," ",(0,u.getBpDisplayStr)(s)]})]})})),f=(0,o.n9)()({inline:{display:"inline-flex"}}),g=(0,s.observer)((function({model:e}){const{classes:n}=f(),{views:t}=e,[s,o]=(0,r.useState)(t.length<=3),[u,p]=(0,r.useState)(t.length<=3);return(0,h.jsxs)(d.A,{row:!0,children:[(0,h.jsx)(i.A,{menuItems:[{label:"Synteny track selectors",type:"subMenu",subMenu:t.slice(0,-1).map(((n,s)=>({label:`Row ${s+1}->${s+2} (${t[s].assemblyNames.join(",")}->${t[s+1].assemblyNames.join(",")})`,onClick:()=>{e.activateTrackSelector(s)}})))},{label:"Row track selectors",type:"subMenu",subMenu:t.map(((e,n)=>({label:`Row ${n+1} track selector (${e.assemblyNames.join(",")})`,onClick:()=>e.activateTrackSelector()})))}],children:(0,h.jsx)(a.xU,{})}),(0,h.jsx)(i.A,{menuItems:[{label:"Row view menus",type:"subMenu",subMenu:t.map(((e,n)=>({label:`View ${n+1} Menu`,subMenu:e.menuItems()})))},...e.headerMenuItems()],children:(0,h.jsx)(l.A,{})}),(0,h.jsx)(i.A,{menuItems:[{label:"Show search boxes",type:"checkbox",checked:s,onClick:()=>{o(!s)}},{label:"Orientation - Side-by-side",type:"radio",checked:u,onClick:()=>{p(!u)}},{label:"Orientation - Vertical",type:"radio",checked:!u,onClick:()=>{p(!u)}}],children:(0,h.jsx)(c.A,{})}),s?(0,h.jsx)("span",{className:u?n.inline:void 0,children:t.map((e=>(0,h.jsx)(v,{view:e},e.id)))}):null]})}));var x=t(67758),j=t(68584),w=t(67112);const y=(0,o.n9)()({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},resizeHandle:{height:4,background:"#ccc"}});function k(e){const n=(0,x.c)(5),{view:t}=e;let s;if(n[0]!==t){const{pluginManager:e}=(0,u.getEnv)(t);s=e.getViewType(t.type),n[0]=t,n[1]=s}else s=n[1];const{ReactComponent:o}=s;let r;return n[2]!==o||n[3]!==t?(r=(0,h.jsx)(o,{model:t}),n[2]=o,n[3]=t,n[4]=r):r=n[4],r}const M=(0,s.observer)((function({model:e}){const{classes:n}=y(),{views:t,levels:s}=e;return(0,h.jsx)("div",{className:n.container,children:t.map(((t,o)=>(0,h.jsxs)(h.Fragment,{children:[o>0?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:n.container,children:(0,h.jsx)(C,{model:e,level:o-1})}),(0,h.jsx)(w.ResizeHandle,{onDrag:e=>s[o-1]?.setHeight((s[o-1]?.height||0)+e),className:n.resizeHandle})]}):null,(0,h.jsx)(k,{view:t})]},t.id)))})})),C=(0,s.observer)((function({model:e,level:n}){const{classes:t}=y();return(0,h.jsx)(h.Fragment,{children:e.levels[n]?.tracks.map((e=>{const[n]=e.displays,{RenderingComponent:s}=n,o=(0,j.getConf)(e,"trackId");return s?(0,h.jsx)("div",{className:t.overlay,style:{height:n.height,overflow:"hidden"},children:(0,h.jsx)(s,{model:n})},o):null}))})})),N=M;var S=t(62266),O=t(87770),R=t(42489),A=t(37962);const B=(0,o.n9)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",background:"red",zIndex:1001}}),T=(0,s.observer)((function({model:e,coordX:n}){const{classes:t}=B();return(0,h.jsx)(A.A,{open:!0,placement:"top",title:e.views.map((e=>e.pxToBp(n))).map(((e,n)=>(0,h.jsx)("div",{children:(0,u.stringify)(e,!0)},[JSON.stringify(e),n].join("-")))),arrow:!0,children:(0,h.jsx)("div",{className:t.guide,style:{left:n}})})})),I=(0,o.n9)()((e=>({rubberband:{height:"100%",background:(0,S.X4)(e.palette.tertiary.main,.7),position:"absolute",zIndex:900,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:e.palette.tertiary.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}}))),E=(0,s.observer)((function({model:e,ControlComponent:n=(0,h.jsx)("div",{})}){const[t,s]=(0,r.useState)(),[o,i]=(0,r.useState)(),[a,l]=(0,r.useState)(),[c,d]=(0,r.useState)(),p=(0,r.useRef)(null),b=(0,r.useRef)(null),{classes:v}=I(),f=void 0!==t&&void 0===a;function g(e){e.preventDefault(),e.stopPropagation();const n=e.clientX-e.target.getBoundingClientRect().left;s(n),i(n)}function x(e){const n=e.target;d(e.clientX-n.getBoundingClientRect().left)}function j(){d(void 0),(0,R.transaction)((()=>{for(const n of e.views)n.setOffsets(void 0,void 0)}))}function y(){l(void 0),s(void 0),i(void 0)}(0,r.useEffect)((()=>{function n(e,n){if(void 0===t)return;let s=t,o=e;return o<s&&([s,o]=[o,s]),{leftOffset:n.pxToBp(s),rightOffset:n.pxToBp(o)}}function s(e){if(p.current&&f){const n=e.clientX-p.current.getBoundingClientRect().left;i(n)}}function o(s){if(void 0!==t&&p.current){const{clientX:t,clientY:o}=s,r=t-p.current.getBoundingClientRect().left;l({offsetX:r,clientX:t,clientY:o}),(0,R.transaction)((()=>{for(const t of e.views){const e=n(r,t);if(e){const{leftOffset:n,rightOffset:s}=e;t.setOffsets(n,s)}}})),d(void 0)}}return f?(window.addEventListener("mousemove",s),window.addEventListener("mouseup",o),()=>{window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",o)}):()=>{}}),[t,f,e]),(0,r.useEffect)((()=>{!f&&void 0!==o&&void 0!==t&&Math.abs(o-t)<=3&&y()}),[f,o,t]);const k=Boolean(a);if(void 0===t)return(0,h.jsxs)(h.Fragment,{children:[void 0!==c?(0,h.jsx)(T,{model:e,coordX:c}):null,(0,h.jsx)("div",{ref:p,className:v.rubberbandControl,onMouseDown:g,onMouseOut:j,onMouseMove:x,children:n})]});const M=a?a.offsetX:o||0,C=Math.min(M,t),N=Math.abs(M-t),{views:S}=e,A=S.map((e=>e.pxToBp(C))),B=S.map((e=>e.pxToBp(C+N))),E=S.map((e=>Math.ceil(N*e.bpPerPx)));return(0,h.jsxs)(h.Fragment,{children:[b.current?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(O.Ay,{className:v.popover,classes:{paper:v.paper},open:!0,anchorEl:b.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0,children:A.map(((e,n)=>(0,h.jsx)(m.A,{children:(0,u.stringify)(e,!0)},[JSON.stringify(e),n,"left"].join("-"))))}),(0,h.jsx)(O.Ay,{className:v.popover,classes:{paper:v.paper},open:!0,anchorEl:b.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0,children:B.map(((e,n)=>(0,h.jsx)(m.A,{children:(0,u.stringify)(e,!0)},[JSON.stringify(e),n,"right"].join("-"))))})]}):null,(0,h.jsx)("div",{ref:b,className:v.rubberband,style:{left:C,width:N},children:(0,h.jsx)(m.A,{variant:"h6",className:v.rubberbandText,children:E.map(((e,n)=>(0,h.jsx)(m.A,{children:`${e.toLocaleString("en-US")}bp`},`${e}_${n}`)))})}),(0,h.jsx)("div",{className:v.rubberbandControl,ref:p,onMouseDown:g,onMouseOut:j,onMouseMove:x,children:n}),a?(0,h.jsx)(w.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:a.clientX,top:a.clientY},onMenuItemClick:function(e,n){n(),y()},open:k,onClose:y,menuItems:e.rubberBandMenuItems()}):null]})})),X=(0,o.n9)()((e=>({rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:e.palette.action.disabledBackground,height:15,"&:hover":{background:e.palette.action.selected}}}))),z=(0,s.observer)((function({model:e}){const{classes:n}=X();return(0,h.jsxs)("div",{className:n.rubberbandContainer,children:[(0,h.jsx)(g,{model:e}),(0,h.jsx)(E,{model:e,ControlComponent:(0,h.jsx)("div",{className:n.rubberbandDiv})}),(0,h.jsx)(N,{model:e})]})}))}}]);
//# sourceMappingURL=8142.3d1b7e1c.chunk.js.map