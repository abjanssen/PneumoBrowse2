"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7],{50007(e,t,n){n.r(t),n.d(t,{default:()=>p});var r=n(30128),i=n(45084),o=n(23886),l=n(61425),s=n(69566);function u(e,t){let n,r=1/0;for(const i of e){const e=t(i);e<r&&(r=e,n=i)}return n}var a=n(17253),c=n(44460);const p=(0,s.observer)(function(e){const{flatbush:t,items:n,displayModel:s,featureGenotypeMap:p,totalHeight:f,origScrollTop:g,renderingProps:d}=e,h=(0,r.useRef)(null),v=(0,r.useRef)(void 0),b=(0,r.useMemo)(()=>l.A.from(t),[t]),y=(0,r.useCallback)((e,t)=>{if(!h.current)return;const r=h.current.getBoundingClientRect(),i=e-r.left,l=t-r.top-g,s=b.search(i,l,i+1,l+1);if(s.length){const e=u(s,e=>n[e]?.bpLen??0),{bpLen:t,genotype:r,featureId:i,...l}=n[e]??{},c=void 0!==i?p[i]:void 0;if(c&&r){const{ref:e,alt:t,name:n,description:i,length:s}=c;return{...l,genotype:r,alleles:(0,a.Fm)(r,e,t),featureName:n,description:t.length>=3?"multiple ALT alleles":i,length:(0,o.getBpDisplayStr)(s)}}}},[b,n,p,g]),m=(0,r.useCallback)(e=>{const t=y(e.clientX,e.clientY),n=t?`${t.name}:${t.genotype}`:void 0;n!==v.current&&(v.current=n,s.setHoveredGenotype?.(t))},[y,s]),k=(0,r.useCallback)(()=>{void 0!==v.current&&(v.current=void 0,s.setHoveredGenotype?.(void 0))},[s]),C=(0,r.useCallback)((e,t)=>{if(!h.current)return;const r=h.current.getBoundingClientRect(),i=e-r.left,o=t-r.top-g,l=b.search(i,o,i+1,o+1);if(l.length){const e=u(l,e=>n[e]?.bpLen??0);return n[e]?.featureId}},[b,n,g]),_=(0,r.useCallback)(e=>{const t=C(e.clientX,e.clientY);t&&d?.onFeatureClick?.(e,t)},[C,d]);return(0,c.jsx)("div",{ref:h,onMouseMove:m,onMouseLeave:k,onMouseOut:k,onClick:_,style:{overflow:"visible",position:"relative",height:f},children:(0,c.jsx)(i.A,{...e,style:{position:"absolute",left:0,top:g}})})})},17253(e,t,n){n.d(t,{Fm:()=>f,M_:()=>a,bC:()=>p});var r=n(20208),i=n(23886);const o=/[/|]/;function l(e){return e.includes("[")||e.includes("]")||e.startsWith(".")||e.endsWith(".")}function s(e){return e.startsWith("<")||l(e)}const u={"<DEL>":"deletion","<INS>":"insertion","<DUP>":"duplication","<INV>":"inversion","<INVDUP>":"inverted_duplication","<CNV>":"copy_number_variation","<TRA>":"translocation","<DUP:TANDEM>":"tandem_duplication","<NON_REF>":"sequence_variant","<*>":"sequence_variant"};function a(e,t,n){if(!t||0===t.length)return["remark","no alternative alleles"];const o=t.map(t=>function(e,t,n){if(e.startsWith("<"))return c(e,n)??"variant";if(l(e)&&(0,r.An)(e))return"breakend";const i=t.length,o=e.length;return 1===i&&1===o?"SNV":i===o?function(e,t){return e.split("").reverse().join("")===t}(t,e)?"inversion":"substitution":i<o?"insertion":"deletion"}(t,e,n)),u=[...new Set(o)],a=function(e,t){if(t.every(s))return t.join(",");const n=e.length;return`${e.length>10?(0,i.getBpDisplayStr)(n):e} -> ${t.map(e=>e.length>10?(0,i.getBpDisplayStr)(e.length):e).join(",")}`}(e,t);return[u.join(","),a]}function c(e,t){if(u[e])return u[e];if(t.getMetadata("ALT",e))return"sequence_variant";const n=e.slice(1,-1).split(":");return n.length>1?c(`<${n.slice(0,-1).join(":")}>`,t):void 0}function p(e,t){if(s(t)||1===e.length&&1===t.length)return t;const n=e.length,r=t.length;return n>5||r>5?`${(0,i.getBpDisplayStr)(n)} -> ${(0,i.getBpDisplayStr)(r)}`:`${e} -> ${t}`}function f(e,t,n){return e.split(o).map(e=>"."===e?".":0===+e?`ref(${t.length<10?t:(0,i.getBpDisplayStr)(t.length)})`:p(t,n[+e-1]||"")).join(e.includes("|")?"|":"/")}}}]);
//# sourceMappingURL=7.e33f0df9.chunk.js.map