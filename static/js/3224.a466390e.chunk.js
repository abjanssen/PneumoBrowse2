"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3224,9364],{27108(t,e,n){n.d(e,{TA:()=>r,fY:()=>a,gJ:()=>i,qm:()=>o,xI:()=>c});var s=n(77251);function a(t){return new Map(t.split(/\n|\r\n|\r/).filter(t=>!!t&&!t.startsWith("#")).map(t=>{const[e,n,s,a,r,c]=t.split("\t");return[a,{refName:e,start:+n,end:+s,score:+r,name:a,strand:"-"===c?-1:1}]}))}async function r(t,e){return(0,s.fetchAndMaybeUnzipText)(t,e)}function c(t){const e=t.split("\t"),n=e.slice(12),s={numMatches:+e[9],blockLen:+e[10],mappingQual:+e[11]};if(n.length)for(const t of n){const e=t.indexOf(":");s[t.slice(0,e)]=t.slice(e+3)}return{tname:e[5],tstart:+e[7],tend:+e[8],qname:e[0],qstart:+e[2],qend:+e[3],strand:"-"===e[4]?-1:1,extra:s}}function o(t){const e=[];for(let n=t.length-2;n>=0;n-=2){e.push(t[n]);const s=t[n+1];"D"===s?e.push("I"):"I"===s?e.push("D"):e.push(s)}return e}function i(t){return t.replaceAll("D","K").replaceAll("I","D").replaceAll("K","I")}},39861(t,e,n){function s(t){const e={};for(const n of t){const t=`${n.qname}-${n.tname}`,s=n.extra.mappingQual||1,a=n.extra.blockLen||1,r=e[t];r?(r.valueSum+=s*a,r.weightSum+=a):e[t]={valueSum:s*a,weightSum:a}}const n={};let s=1/0,a=-1/0;for(const[t,{valueSum:r,weightSum:c}]of Object.entries(e)){const e=r/c;n[t]=e,s=Math.min(e,s),a=Math.max(e,a)}const r=a-s;for(const e of t){const t=n[`${e.qname}-${e.tname}`];e.extra.meanScore=r>0?(t-s)/r:1}return t}n.d(e,{W:()=>s})},42661(t,e,n){n.d(e,{A:()=>c});var s=n(53155),a=n(35635);const{DQ:r}=a;class c extends s.A{get(t){return"mismatches"===t?r(this.get("CIGAR")):super.get(t)}}},49364(t,e,n){n.d(e,{default:()=>p});var s=n(48455),a=n(77251),r=n(33624),c=n(94645),o=n(25978),i=n(86618),u=n(35635),l=n(42661),m=n(27108),h=n(39861);const{eL:f}=u;class p extends s.L{static capabilities=["getFeatures","getRefNames"];async setup(t){return this.setupP||(this.setupP=this.setupPre(t).catch(t=>{throw this.setupP=void 0,t})),this.setupP}async setupPre(t){const e=[];return(0,c.P)(await(0,a.fetchAndMaybeUnzip)((0,r.openLocation)(this.getConf("pafLocation"),this.pluginManager),t),t=>(e.push((0,m.xI)(t)),!0),t?.statusCallback),(0,h.W)(e)}async hasDataForRefName(){return!0}getAssemblyNames(){const t=this.getConf("assemblyNames");return 0===t.length?[this.getConf("queryAssembly"),this.getConf("targetAssembly")]:t}async getRefNames(t={}){const e=t.regions?.[0].assemblyName,n=await this.setup(t),s=this.getAssemblyNames().indexOf(e);if(-1!==s){const t=new Set;for(const e of n)t.add(0===s?e.qname:e.tname);return[...t]}return console.warn("Unable to do ref renaming on adapter"),[]}getFeatures(t,e={}){return(0,i.ObservableCreate)(async n=>{const s=await this.setup(e),a=this.getAssemblyNames(),{start:r,end:c,refName:i,assemblyName:u}=t,h=a.indexOf(u),p=0===h;-1===h&&(console.warn(`${u} not found in this adapter`),n.complete());for(let t=0;t<s.length;t++){const e=s[t];let h=0,d=0,g="",b="",y=0,w=0;p?(h=e.qstart,d=e.qend,g=e.qname,b=e.tname,y=e.tstart,w=e.tend):(h=e.tstart,d=e.tend,g=e.tname,b=e.qname,y=e.qstart,w=e.qend);const{extra:x,strand:q}=e;if(g===i&&(0,o.R6)(r,c,h,d)){const{numMatches:e=0,blockLen:s=1,cg:r,...c}=x;let o=x.cg;x.cg&&(p&&-1===q?o=(0,m.qm)(f(x.cg)).join(""):p&&(o=(0,m.gJ)(x.cg))),n.next(new l.A({uniqueId:t+u,assemblyName:u,start:h,end:d,type:"match",refName:g,strand:q,...c,CIGAR:o,syntenyId:t,identity:e/s,numMatches:e,blockLen:s,mate:{start:y,end:w,refName:b,assemblyName:a[+p]}}))}}n.complete()})}}},93224(t,e,n){n.d(e,{default:()=>u});var s=n(77251),a=n(33624),r=n(94645);function c(t,e,n,s,a,r,c,o,i){return{qname:t,qstart:e,qend:n,tname:a,tstart:r,tend:c,strand:"-"===s?-1:1,extra:{numMatches:i,blockLen:Math.max(n-e,c-r),mappingQual:0,cg:o}}}var o=n(49364),i=n(39861);class u extends o.default{async setupPre(t){return(0,i.W)(function(t,e){const{statusCallback:n=()=>{}}=e||{};let s="",a=0,o=0,i="",u="",l="",m=0,h=0,f=0,p="";const d=[];return(0,r.P)(t,t=>{if(!t||t.startsWith("#"))return!0;const e=t.split(/[ \t]+/);if("chain"===e[0]){if(p&&d.push(c(i,m,h,l,s,a,o,p,f)),s=e[2],a=+e[5],o=+e[6],i=e[7],u=e[8],l=e[9],m=+e[10],h=+e[11],"-"===l){const t=m;m=+u-h,h=+u-t}f=0,p=""}else{const t=+e[0]||0,n=e.length>1?+e[1]:0,s=e.length>2?+e[2]:0;0!==t&&(f+=t,p+=`${t}M`),0!==s&&(p+=`${s}I`),0!==n&&(p+=`${n}D`)}return!0},e?.statusCallback),p&&d.push(c(i,m,h,l,s,a,o,p,f)),n(""),d}(await(0,s.fetchAndMaybeUnzip)((0,a.openLocation)(this.getConf("chainLocation"),this.pluginManager),t),t))}}},94645(t,e,n){n.d(e,{P:()=>a});var s=n(77251);function a(t,e,n=()=>{}){const a=new TextDecoder("utf8");let r=0,c=0;for(;r<t.length;){const o=t.indexOf(10,r),i=-1===o?t.length:o,u=t.subarray(r,i),l=a.decode(u).trim();if(l&&!1===e(l,c))break;c++%1e4==0&&n(`Loading ${(0,s.getProgressDisplayStr)(r,t.length)}`),r=i+1}}}}]);
//# sourceMappingURL=3224.a466390e.chunk.js.map