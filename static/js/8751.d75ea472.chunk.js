"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8751],{36157:(e,n,t)=>{t.d(n,{A:()=>g});var o=t(7552),s=t(30157),l=t(943),r=t(40985),i=t(2187),c=t(43163),a=t(61723),d=t(24387),h=t(68446),u=t(21254),m=t.n(u),x=t(75785),p=t(69500);const j=(0,x.n9)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function f(e){const n=(0,o.useRef)(null);return(0,p.jsx)(m(),{nodeRef:n,cancel:'[class*="MuiDialogContent-root"]',onStart:e=>`${e.target?.className}`.includes("MuiDialogTitle"),children:(0,p.jsx)(l.A,{ref:n,...e})})}const g=(0,h.observer)((function(e){const{classes:n}=j(),{title:t,children:o,onClose:l}=e;return(0,p.jsx)(r.A,{...e,PaperComponent:f,children:(0,p.jsxs)(i.A,{children:[(0,p.jsxs)(c.A,{style:{cursor:"move"},children:[t,l?(0,p.jsx)(a.A,{className:n.closeButton,onClick:()=>{l()},children:(0,p.jsx)(s.A,{})}):null]}),(0,p.jsx)(d.A,{}),o]})})}))},38751:(e,n,t)=>{t.r(n),t.d(n,{default:()=>E});var o=t(7552),s=t(36157),l=t(99546),r=t(29499),i=t(5401),c=t(58507),a=t(75785),d=t(49823),h=t(36715),u=t(1343),m=t(69500);const x=(0,a.n9)()({textAreaFont:{fontFamily:"Courier New"}});function p({onClose:e,currLayout:n}){const{classes:t}=x(),[s,l]=(0,o.useState)(""),[a,p]=(0,o.useState)();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.A,{children:[(0,m.jsx)(h.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),a?(0,m.jsx)(d.ErrorMessage,{error:a}):null,(0,m.jsx)(u.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:s,onChange:e=>{l(e.target.value)},slotProps:{input:{classes:{input:t.textAreaFont}}}})]}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(i.A,{variant:"contained",color:"secondary",onClick:()=>{const t=s.split("\n").map((e=>e.trim())).filter((e=>!!e)),o=t[0].split(/[,\t]/gm);if(o.includes("name")){p("");const s=Object.fromEntries(n.map((e=>[e.name,e]))),l=Object.fromEntries(t.slice(1).map((e=>{const n=e.split(/[,\t]/gm),t=Object.fromEntries(n.map(((e,n)=>[o[n],e])));return[t.name,{...t,...s[t.name]}]})));e(n.map((e=>({...e,...l[e.name]}))))}else p(new Error('No "name" column found on line 1'))},children:"Update rows"}),(0,m.jsx)(i.A,{variant:"contained",color:"primary",onClick:()=>{const t=s.split("\n").map((e=>e.trim())).filter((e=>!!e)),o=t[0].split(/[,\t]/gm);if(o.includes("name")){p("");const s=Object.fromEntries(n.map((e=>[e.name,e]))),l=Object.fromEntries(t.slice(1).map((e=>{const n=e.split(/[,\t]/gm),t=Object.fromEntries(n.map(((e,n)=>[o[n],e])));return[t.name,{...t,...s[t.name]}]})));e(n.map((e=>({...l[e.name]}))))}else p(new Error('No "name" column found on line 1'))},children:"Replace rows"}),(0,m.jsx)(i.A,{variant:"contained",color:"inherit",onClick:()=>{e()},children:"Cancel"})]})]})}function j(){return(0,m.jsxs)(m.Fragment,{children:["Helpful tips",(0,m.jsxs)("ul",{children:[(0,m.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,m.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,m.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,m.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,m.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,m.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,m.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]})}var f=t(40898),g=t(42268);function C({setCurrLayout:e,currLayout:n}){return(0,m.jsxs)("div",{children:["Create color palette based on...",Object.keys(n[0]??[]).filter((e=>"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e)).map((t=>(0,m.jsx)(i.A,{variant:"contained",color:"inherit",onClick:()=>{const o=new Map;for(const e of n){const n=o.get(e[t]);n?o.set(e[t],n+1):o.set(e[t],1)}const s=Object.fromEntries([...o.entries()].sort(((e,n)=>e[1]-n[1])).map(((e,n)=>[e[0],f.set1[n]||(0,g.XL)(e[0])])));e(n.map((e=>({...e,color:s[e[t]]}))))},children:t},t))),(0,m.jsx)(i.A,{onClick:()=>{e(n.map((e=>({...e,color:void 0}))))},children:"Clear colors"})]})}var b=t(66395),w=t(36793);const v=(0,a.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function A({rows:e,onChange:n,setSelected:t}){const{classes:s}=v(),[r,i]=(0,o.useState)({idx:0,field:null});if(e.length){const{id:o,name:c,label:a,color:h,baseUri:u,HP:x,...p}=e[0];return(0,m.jsx)("div",{style:{height:400,width:"100%"},children:(0,m.jsx)(w.z,{checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{t(e)},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:t=>{const{value:o,id:s}=t;return(0,m.jsx)(b.Ay,{color:o||"blue",onChange:t=>{const o=e.find((e=>e.name===s));o&&(o.color=t),n([...e])}})}},{field:"label",headerName:"Name",width:(0,l.measureGridWidth)(e.map((e=>e.label)))},...Object.keys(p).map((n=>({field:n,renderCell:({value:e})=>(0,m.jsx)("div",{className:s.cell,children:(0,m.jsx)(d.SanitizedHTML,{html:(0,l.getStr)(e)})}),width:(0,l.measureGridWidth)(e.map((e=>`${e[n]}`)))})))],sortModel:[],onSortModelChange:t=>{const o=t[0],s=(r.idx+1)%2,c=o.field||r.field;i({idx:s,field:c}),n(c?[...e].sort(((e,n)=>{const t=(0,l.getStr)(e[c]),o=(0,l.getStr)(n[c]);return 1===s?t.localeCompare(o):o.localeCompare(t)})):e)}})})}return(0,m.jsx)("div",{children:"No rows, check sample metadata configuration"})}var k=t(66195),S=t(21430),y=t(91388),M=t(42281);function H(e,n,t=1){const o=n.map((n=>e.findIndex((e=>e.name===n)))).sort(((e,n)=>e-n));let s=0;for(const n of o){const o=Math.max(s,n-t);o>=s&&e.splice(o,0,e.splice(n,1)[0]),s+=1}return e}function N(e,n,t=1){const o=n.map((n=>e.findIndex((e=>e.name===n)))).sort(((e,n)=>n-e));let s=e.length-1;for(const n of o){const o=Math.min(s,n+t);o<=s&&e.splice(o,0,e.splice(n,1)[0]),s-=1}return e}function L({selected:e,onChange:n,rows:t,showTips:s}){const[l,r]=(0,o.useState)(null),[c,a]=(0,o.useState)("blue");return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(i.A,{disabled:!e.length,onClick:e=>{r(e.currentTarget)},children:"Change color of selected items"}),(0,m.jsxs)(i.A,{onClick:()=>{n(H([...t],e))},disabled:!e.length,children:[(0,m.jsx)(S.A,{}),s?"Move selected items up":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(N([...t],e))},disabled:!e.length,children:[(0,m.jsx)(k.A,{}),s?"Move selected items down":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(H([...t],e,t.length))},disabled:!e.length,children:[(0,m.jsx)(M.A,{}),s?"Move selected items to top":null]}),(0,m.jsxs)(i.A,{onClick:()=>{n(N([...t],e,t.length))},disabled:!e.length,children:[(0,m.jsx)(y.A,{}),s?"Move selected items to bottom":null]}),(0,m.jsx)(b.FO,{anchorEl:l,color:c,onChange:o=>{a(o);for(const n of e){const e=t.find((e=>e.name===n));e&&(e.color=o)}n([...t])},onClose:()=>{r(null)}})]})}const O=function({rows:e,onChange:n,showTips:t}){const[s,l]=(0,o.useState)([]);return(0,m.jsxs)("div",{children:[(0,m.jsx)(L,{selected:s,rows:e,showTips:t,onChange:n}),(0,m.jsx)(A,{rows:e,onChange:n,setSelected:l})]})},T=(0,a.n9)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8},textAreaFont:{fontFamily:"Courier New"}});function E({model:e,handleClose:n}){const{classes:t}=T(),{sources:a}=e,[d,h]=(0,o.useState)(!1),[u,x]=(0,o.useState)(a||[]),[f,g]=(0,l.useLocalStorage)("multivariant-showTips",!1);return(0,m.jsx)(s.A,{open:!0,onClose:n,maxWidth:"xl",title:"Multi-variant color/arrangement editor",children:d?(0,m.jsx)(p,{currLayout:u,onClose:e=>{e&&x(e),h(!1)}}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(r.A,{className:t.content,children:[(0,m.jsxs)("div",{className:t.fr,children:[(0,m.jsx)(i.A,{variant:"contained",onClick:()=>{g(!f)},children:f?"Hide tips":"Show tips"}),(0,m.jsx)(i.A,{color:"secondary",variant:"contained",onClick:()=>{h(!d)},children:"Show Bulk row editor"})]}),f?(0,m.jsx)(j,{}):null,(0,m.jsx)("br",{}),(0,m.jsx)(C,{currLayout:u,setCurrLayout:x}),(0,m.jsx)(O,{rows:u,onChange:x,showTips:f})]}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(i.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),x(e.sources||[])},children:"Clear custom settings"}),(0,m.jsx)(i.A,{variant:"contained",color:"secondary",onClick:()=>{n(),x([...e.sources||[]])},children:"Cancel"}),(0,m.jsx)(i.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(u),n()},children:"Submit"})]})]})})}},42268:(e,n,t)=>{function o(e){let n=0;for(let t=0;t<e.length;t++)n+=e.charCodeAt(t);return s(10*n)}function s(e){return`hsl(${e%255}, 50%, 50%)`}t.d(n,{XL:()=>o,qH:()=>s})}}]);
//# sourceMappingURL=8751.d75ea472.chunk.js.map