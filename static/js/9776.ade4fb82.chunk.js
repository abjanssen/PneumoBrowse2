"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[9776],{29776(t,e,a){a.r(e),a.d(e,{getQuantitativeStatsAutorun:()=>u});var s=a(77251),r=a(8201),i=a(52901),n=a(99226),o=a(38567),c=a(11259),l=a(70203);function u(t){(0,n.addDisposer)(t,(0,o.autorun)(async()=>{try{if(t.isMinimized)return;if(t.quantitativeStatsReady){const e=(0,s.getContainingView)(t),a=(0,i.y5)();t.setStatsLoading(a);const r=JSON.stringify(e.dynamicBlocks),o=await async function(t,e){const{rpcManager:a}=(0,s.getSession)(t),r=(0,c.FI)(t,"numStdDev")||3,{adapterConfig:i,autoscaleType:o,effectiveRpcDriverName:u}=t,g=(0,l.getRpcSessionId)(t),p=(0,s.getContainingTrack)(t).id,{currStatsBpPerPx:d}=e,S={sessionId:g,trackInstanceId:p,adapterConfig:i,rpcDriverName:u,statusCallback:e=>{(0,n.isAlive)(t)&&t.setStatusMessage(e)},...e};if("global"===o||"globalsd"===o){const t=await a.call(g,"WiggleGetGlobalQuantitativeStats",S),{scoreMin:e,scoreMean:s,scoreStdDev:i}=t;return"globalsd"===o?{...t,scoreMin:e>=0?0:s-r*i,scoreMax:s+r*i,currStatsBpPerPx:d}:{...t,currStatsBpPerPx:d}}if("local"===o||"localsd"===o){const{dynamicBlocks:e,staticBlocks:i,bpPerPx:n}=(0,s.getContainingView)(t),c=await a.call(g,"WiggleGetMultiRegionQuantitativeStats",{...S,regions:e.contentBlocks.map(t=>{const{start:e,end:a}=t;return{...JSON.parse(JSON.stringify(t)),start:Math.floor(e),end:Math.ceil(a)}}),staticBlocks:i.contentBlocks.map(t=>{const{start:e,end:a}=t;return{...JSON.parse(JSON.stringify(t)),start:Math.floor(e),end:Math.ceil(a)}}),bpPerPx:n}),{scoreMin:l,scoreMean:u,scoreStdDev:p}=c;return"localsd"===o?{...c,scoreMin:l>=0?0:u-r*p,scoreMax:u+r*p,currStatsBpPerPx:d}:{...c,currStatsBpPerPx:d}}if("zscale"===o)return a.call(g,"WiggleGetGlobalQuantitativeStats",S);throw new Error(`invalid autoscaleType '${o}'`)}(t,{stopToken:a,filters:[],currStatsBpPerPx:e.bpPerPx,...t.adapterProps()});(0,n.isAlive)(t)&&t.updateQuantitativeStats(o,r)}}catch(e){(0,n.isAlive)(t)&&!(0,r.Kp)(e)&&(console.error(e),t.setError(e))}},{delay:500}))}}}]);
//# sourceMappingURL=9776.ade4fb82.chunk.js.map