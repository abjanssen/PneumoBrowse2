"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7714,9865],{7714(e,t,o){o.r(t),o.d(t,{default:()=>B});var s=o(87574),n=o(28397),r=o(77251),i=o(65045),a=o(64074),l=o(42918),c=o(58693),d=o(14391),m=o(19258),h=o(63881),x=o(32118);const u=(0,h.A)((0,x.jsx)("path",{d:"M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2m6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m0 12H6V10h12z"}),"LockOpen");var g=o(21267),p=o(12094);const b=(0,h.A)((0,x.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47M6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47m1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93"}),"RotateLeft"),f=(0,h.A)((0,x.jsx)("path",{d:"M15.55 5.55 11 1v3.07C7.06 4.56 4 7.92 4 12s3.05 7.44 7 7.93v-2.02c-2.84-.48-5-2.94-5-5.91s2.16-5.43 5-5.91V10zM19.93 11c-.17-1.39-.72-2.73-1.62-3.89l-1.42 1.42c.54.75.88 1.6 1.02 2.47zM13 17.9v2.02c1.39-.17 2.74-.71 3.9-1.61l-1.44-1.44c-.75.54-1.59.89-2.46 1.03m3.89-2.42 1.42 1.41c.9-1.16 1.45-2.5 1.62-3.89h-2.02c-.14.87-.48 1.72-1.02 2.48"}),"RotateRight");var j=o(9913),v=o(72868),A=o(74919),k=o(19865);const C=(0,i.n)()(e=>({controls:{position:"absolute",borderRight:`1px solid ${e.palette.divider}`,borderBottom:`1px solid ${e.palette.divider}`,left:0,top:0}})),w=(0,a.observer)(function({model:e}){const{classes:t}=C(),[o,s]=(0,l.useState)(null);return(0,x.jsxs)("div",{className:t.controls,children:[(0,x.jsx)(A.A,{onClick:e.zoomOutButton,title:e.lockedFitToWindow?"unlock to zoom out":"zoom out",disabled:e.atMaxBpPerPx||e.lockedFitToWindow,children:(0,x.jsx)(v.A,{})}),(0,x.jsx)(A.A,{onClick:e.zoomInButton,disabled:e.atMinBpPerPx,title:"zoom in",children:(0,x.jsx)(j.A,{})}),(0,x.jsx)(A.A,{onClick:e.rotateCounterClockwiseButton,title:"rotate counter-clockwise",children:(0,x.jsx)(b,{})}),(0,x.jsx)(A.A,{onClick:e.rotateClockwiseButton,title:"rotate clockwise",children:(0,x.jsx)(f,{})}),(0,x.jsx)(A.A,{onClick:e.toggleFitToWindowLock,title:e.lockedFitToWindow?"locked model to window size":"unlocked model to zoom further",disabled:e.tooSmallToLock,children:e.lockedFitToWindow?(0,x.jsx)(m.A,{}):(0,x.jsx)(u,{})}),(0,x.jsx)(A.A,{onClick:e=>{s(e.currentTarget)},children:(0,x.jsx)(g.A,{})}),e.hideTrackSelectorButton?null:(0,x.jsx)(A.A,{onClick:e.activateTrackSelector,title:"Open track selector","data-testid":"circular_track_select",children:(0,x.jsx)(c.xU,{})}),o?(0,x.jsx)(d.A,{anchorEl:o,menuItems:[{label:"Export SVG",icon:p.A,onClick:()=>{(0,r.getSession)(e).queueDialog(t=>[k.default,{model:e,handleClose:t}])}}],onMenuItemClick:(e,t)=>{t(),s(null)},open:Boolean(o),onClose:()=>{s(null)}}):null]})});var y=o(27351),S=o(34592),T=o(18522),W=o(42913),M=o(65525);const R=(0,i.n)()(e=>({importFormContainer:{padding:e.spacing(6)}})),z=(0,a.observer)(function({model:e}){const{classes:t}=R(),o=(0,r.getSession)(e),{error:s}=e,{assemblyNames:n,assemblyManager:i}=o,[a,c]=(0,l.useState)(n[0]),d=i.get(a),m=n.length?d?.error:"No configured assemblies",h=d?.regions||[],u=m||s;return(0,x.jsxs)(T.A,{className:t.importFormContainer,children:[u?(0,x.jsx)(W.A,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:(0,x.jsx)(y.A,{error:u})}):null,(0,x.jsxs)(W.A,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,x.jsx)(S.A,{onChange:t=>{e.setError(void 0),c(t)},session:o,selected:a}),(0,x.jsx)(M.A,{disabled:!h.length,onClick:()=>{e.setError(void 0),e.setDisplayedRegions(h)},variant:"contained",color:"primary",children:h.length||u?"Open":"Loading..."})]})]})});var L=o(90853);const $=(0,i.n)()(e=>({root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},scroller:{overflow:"auto"}})),P=(0,a.observer)(function({model:e}){return(0,x.jsxs)(x.Fragment,{children:[e.staticSlices.map(t=>(0,x.jsx)(L.A,{model:e,slice:t},(0,r.assembleLocString)(t.region.elided?t.region.regions[0]:t.region))),e.tracks.map(t=>{const o=t.displays[0];return(0,x.jsx)(o.RenderingComponent,{display:o,view:e},o.id)})]})}),N=(0,a.observer)(function({model:e}){const{showLoading:t,showView:o,showImportForm:n,loadingMessage:r}=e;return t?(0,x.jsx)(s.A,{variant:"h6",message:r}):n?(0,x.jsx)(z,{model:e}):o?(0,x.jsx)(V,{model:e}):null}),V=(0,a.observer)(function({model:e}){const{width:t,height:o,id:s,offsetRadians:r,centerXY:i,figureWidth:a,figureHeight:l,hideVerticalResizeHandle:c}=e,{classes:d}=$();return(0,x.jsxs)("div",{className:d.root,style:{width:t,height:o},"data-testid":s,children:[(0,x.jsx)("div",{className:d.scroller,style:{width:t,height:o},children:(0,x.jsx)("svg",{style:{transform:`rotate(${r}rad)`,transition:"transform 0.5s",transformOrigin:i.map(e=>`${e}px`).join(" "),position:"absolute",left:0,top:0},width:a,height:l,children:(0,x.jsx)("g",{transform:`translate(${i})`,children:(0,x.jsx)(P,{model:e})})})}),(0,x.jsx)(w,{model:e}),c?null:(0,x.jsx)(n.A,{onDrag:e.resizeHeight,style:{height:3,position:"absolute",bottom:0,left:0,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})]})}),B=N},18522(e,t,o){o.d(t,{A:()=>j});var s=o(42918),n=o(77710),r=o(47739),i=o(62981),a=o(65441),l=o(92627),c=o(97863),d=o(17248),m=o(32118);const h=(0,d.A)(),x=(0,c.A)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[`maxWidth${(0,a.A)(String(o.maxWidth))}`],o.fixed&&t.fixed,o.disableGutters&&t.disableGutters]}}),u=e=>(0,l.A)({props:e,name:"MuiContainer",defaultTheme:h});var g=o(88842),p=o(41680),b=o(32717);const f=function(e={}){const{createStyledComponent:t=x,useThemeProps:o=u,componentName:l="MuiContainer"}=e,c=t(({theme:e,ownerState:t})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!t.disableGutters&&{paddingLeft:e.spacing(2),paddingRight:e.spacing(2),[e.breakpoints.up("sm")]:{paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}}}),({theme:e,ownerState:t})=>t.fixed&&Object.keys(e.breakpoints.values).reduce((t,o)=>{const s=o,n=e.breakpoints.values[s];return 0!==n&&(t[e.breakpoints.up(s)]={maxWidth:`${n}${e.breakpoints.unit}`}),t},{}),({theme:e,ownerState:t})=>({..."xs"===t.maxWidth&&{[e.breakpoints.up("xs")]:{maxWidth:Math.max(e.breakpoints.values.xs,444)}},...t.maxWidth&&"xs"!==t.maxWidth&&{[e.breakpoints.up(t.maxWidth)]:{maxWidth:`${e.breakpoints.values[t.maxWidth]}${e.breakpoints.unit}`}}})),d=s.forwardRef(function(e,t){const s=o(e),{className:d,component:h="div",disableGutters:x=!1,fixed:u=!1,maxWidth:g="lg",classes:p,...b}=s,f={...s,component:h,disableGutters:x,fixed:u,maxWidth:g},j=((e,t)=>{const{classes:o,fixed:s,disableGutters:n,maxWidth:l}=e,c={root:["root",l&&`maxWidth${(0,a.A)(String(l))}`,s&&"fixed",n&&"disableGutters"]};return(0,i.A)(c,e=>(0,r.Ay)(t,e),o)})(f,l);return(0,m.jsx)(c,{as:h,ownerState:f,className:(0,n.A)(j.root,d),ref:t,...b})});return d}({createStyledComponent:(0,p.Ay)("div",{name:"MuiContainer",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:o}=e;return[t.root,t[`maxWidth${(0,g.A)(String(o.maxWidth))}`],o.fixed&&t.fixed,o.disableGutters&&t.disableGutters]}}),useThemeProps:e=>(0,b.b)({props:e,name:"MuiContainer"})}),j=f},19258(e,t,o){o.d(t,{A:()=>r});var s=o(63881),n=o(32118);const r=(0,s.A)((0,n.jsx)("path",{d:"M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2m-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2m3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1s3.1 1.39 3.1 3.1z"}),"Lock")},19865(e,t,o){o.r(t),o.d(t,{default:()=>A});var s=o(30936),n=o(42918),r=o(85787),i=o(27351),a=o(77251),l=o(25861),c=o(1591),d=o(15675),m=o(24215),h=o(9625),x=o(37015),u=o(42783),g=o(11543),p=o(65525),b=o(32118);function f(){const e=(0,s.c)(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,b.jsxs)("div",{children:[(0,b.jsx)(l.A,{size:20,style:{marginRight:20}}),(0,b.jsx)(c.A,{display:"inline",children:"Creating SVG"})]}),e[0]=t):t=e[0],t}function j(e){const t=(0,s.c)(6);let o,n,r;return t[0]!==e?(({children:o,...n}=e),t[0]=e,t[1]=o,t[2]=n):(o=t[1],n=t[2]),t[3]!==o||t[4]!==n?(r=(0,b.jsx)("div",{children:(0,b.jsx)(d.A,{...n,children:o})}),t[3]=o,t[4]=n,t[5]=r):r=t[5],r}function v(e,t){return(0,a.useLocalStorage)(`svg-${e}`,t)}function A({model:e,handleClose:t}){const o=(0,a.getSession)(e),s="undefined"!=typeof OffscreenCanvas,[l,d]=(0,n.useState)(s),[A,k]=(0,n.useState)(!1),[C,w]=(0,n.useState)(),[y,S]=v("file","jbrowse.svg"),[T,W]=v("theme",o.themeName||"default");return(0,b.jsxs)(r.A,{open:!0,onClose:t,title:"Export SVG",children:[(0,b.jsxs)(m.A,{children:[C?(0,b.jsx)(i.A,{error:C}):A?(0,b.jsx)(f,{}):null,(0,b.jsx)(j,{helperText:"filename",value:y,onChange:e=>{S(e.target.value)}}),o.allThemes?(0,b.jsx)(j,{select:!0,label:"Theme",value:T,onChange:e=>{W(e.target.value)},children:Object.entries(o.allThemes()).map(([e,t])=>(0,b.jsx)(h.A,{value:e,children:t.name||"(Unknown name)"},e))}):null,s?(0,b.jsx)(x.A,{control:(0,b.jsx)(u.A,{checked:l,onChange:()=>{d(e=>!e)}}),label:"Rasterize canvas based tracks? File may be much larger if this is turned off"}):(0,b.jsx)(c.A,{children:"Note: rasterizing layers not yet supported in this browser, so SVG size may be large"})]}),(0,b.jsxs)(g.A,{children:[(0,b.jsx)(p.A,{variant:"contained",color:"secondary",onClick:()=>{t()},children:"Cancel"}),(0,b.jsx)(p.A,{variant:"contained",color:"primary",type:"submit",onClick:async()=>{k(!0),w(void 0);try{await e.exportSvg({rasterizeLayers:l,filename:y,themeName:T}),t()}catch(e){console.error(e),w(e)}finally{k(!1)}},children:"Submit"})]})]})}},90853(e,t,o){o.d(t,{A:()=>u});var s=o(77251),n=o(71247),r=o(65045),i=o(33579),a=o(64074),l=o(32118);const c=(0,r.n)()({rulerLabel:{fontSize:"0.8rem",fontWeight:500,lineHeight:1.6,letterSpacing:"0.0075em"}});function d(e,t,o,s){e.flipped&&([o,s]=[s,o]);const n=e.bpToXY(o,t),r=e.bpToXY(s,t);return["M",...n,"A",t,t,"0",Math.abs(s-o)/e.bpPerRadian>Math.PI?"1":"0","1",...r].join(" ")}const m=(0,a.observer)(function({model:e,slice:t,region:o}){const n=(0,i.A)(),{radiusPx:r}=e,a=r+1,{endRadians:c,startRadians:d}=t,m=(0,s.polarToCartesian)(a,d),x=(0,s.polarToCartesian)(a,c),u=(c-d)*a,g=c-d>Math.PI?"1":"0",p=(c+d)/2,b=`[${(0,s.toLocale)(o.regions.length)}]`;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{text:b,view:e,maxWidthPx:u,radians:p,radiusPx:a,title:`${b} more regions`,color:n.palette.text.primary}),(0,l.jsx)("path",{d:["M",...m,"A",a,a,"0",g,"1",...x].join(" "),...(0,s.getStrokeProps)(n.palette.text.secondary),strokeWidth:2,strokeDasharray:"2,2",fill:"none"})]})}),h=(0,a.observer)(function({view:e,text:t,maxWidthPx:o,radians:n,radiusPx:r,title:i,color:a}){const{classes:d}=c(),m=(0,s.polarToCartesian)(r+5,n);return t?6.5*t.length<o?(0,l.jsxs)("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"middle",dominantBaseline:"middle",transform:`translate(${m}) rotate(${(0,s.radToDeg)(n)+90})`,...(0,s.getFillProps)(a),children:[t,(0,l.jsx)("title",{children:i||t})]}):o>4?(0,s.radToDeg)(n+e.offsetRadians-Math.PI/2)>=180?(0,l.jsxs)("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"start",dominantBaseline:"middle",transform:`translate(${m}) rotate(${(0,s.radToDeg)(n)})`,fill:a,children:[t,(0,l.jsx)("title",{children:i||t})]}):(0,l.jsxs)("text",{x:0,y:0,className:d.rulerLabel,textAnchor:"end",dominantBaseline:"middle",transform:`translate(${m}) rotate(${(0,s.radToDeg)(n)+180})`,fill:a,children:[t,(0,l.jsx)("title",{children:i||t})]}):null:null}),x=(0,a.observer)(function({model:e,slice:t,region:o}){const r=(0,i.A)(),{radiusPx:a}=e,{endRadians:c,startRadians:m}=t,x=(c+m)/2,u=(c-m)*a,g=(0,s.getSession)(e).assemblyManager.get(o.assemblyName);let p=g?g.getRefNameColor(o.refName):void 0;if(p)try{p=(0,n.makeContrasting)(p,r.palette.background.paper)}catch(e){p=r.palette.text.primary}else p=r.palette.text.primary;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(h,{text:o.refName,view:e,maxWidthPx:u,radians:x,radiusPx:a,color:p}),(0,l.jsx)("path",{d:d(t,a+1,o.start,o.end),stroke:p,strokeWidth:2,fill:"none"})]})}),u=(0,a.observer)(function({model:e,slice:t}){return t.region.elided?(0,l.jsx)(m,{model:e,region:t.region,slice:t},(0,s.assembleLocString)(t.region.regions[0])):(0,l.jsx)(x,{region:t.region,model:e,slice:t},(0,s.assembleLocString)(t.region))})}}]);
//# sourceMappingURL=7714.d423293a.chunk.js.map