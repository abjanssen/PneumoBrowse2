{"version":3,"file":"static/js/3047.2cd17936.chunk.js","mappings":"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","sources":["../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/drawSynteny.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/components/util.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyView/svgcomponents/SVGBackground.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyView/svgcomponents/SVGLinearGenomeView.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyView/svgcomponents/SVGLinearSyntenyView.tsx"],"sourcesContent":["import { doesIntersect2, getContainingView } from '@jbrowse/core/util'\n\nimport { draw, drawMatchSimple } from './components/util'\n\nimport type { LinearSyntenyDisplayModel } from './model'\nimport type { LinearSyntenyViewModel } from '../LinearSyntenyView/model'\n\nexport const MAX_COLOR_RANGE = 255 * 255 * 255 // max color range\n\nfunction makeColor(idx: number) {\n  const r = Math.floor(idx / (255 * 255)) % 255\n  const g = Math.floor(idx / 255) % 255\n  const b = idx % 255\n  return `rgb(${r},${g},${b})`\n}\n\nconst colorMap = {\n  I: '#ff03',\n  N: '#0a03',\n  D: '#00f3',\n  X: 'brown',\n  M: '#f003',\n  '=': '#f003',\n}\n\nconst lineLimit = 3\n\nconst oobLimit = 1600\n\nexport function getId(r: number, g: number, b: number, unitMultiplier: number) {\n  return Math.floor((r * 255 * 255 + g * 255 + b - 1) / unitMultiplier)\n}\n\nexport function drawRef(\n  model: LinearSyntenyDisplayModel,\n  ctx1: CanvasRenderingContext2D,\n  ctx3?: CanvasRenderingContext2D,\n) {\n  const view = getContainingView(model) as LinearSyntenyViewModel\n  const drawCurves = view.drawCurves\n  const drawCIGAR = view.drawCIGAR\n  const { level, height, featPositions } = model\n  const width = view.width\n  const bpPerPxs = view.views.map(v => v.bpPerPx)\n\n  if (ctx3) {\n    ctx3.imageSmoothingEnabled = false\n  }\n\n  ctx1.beginPath()\n  const offsets = view.views.map(v => v.offsetPx)\n  const unitMultiplier = Math.floor(MAX_COLOR_RANGE / featPositions.length)\n\n  // this loop is optimized to draw many thin lines with a single ctx.stroke\n  // call, a separate loop below draws larger boxes\n  ctx1.fillStyle = colorMap.M\n  ctx1.strokeStyle = colorMap.M\n  for (const { p11, p12, p21, p22 } of featPositions) {\n    const x11 = p11.offsetPx - offsets[level]!\n    const x12 = p12.offsetPx - offsets[level]!\n    const x21 = p21.offsetPx - offsets[level + 1]!\n    const x22 = p22.offsetPx - offsets[level + 1]!\n    const l1 = Math.abs(x12 - x11)\n    const l2 = Math.abs(x22 - x21)\n    const y1 = 0\n    const y2 = height\n    const mid = (y2 - y1) / 2\n\n    // drawing a line if the results are thin results in much less pixellation\n    // than filling in a thin polygon\n    if (\n      l1 <= lineLimit &&\n      l2 <= lineLimit &&\n      x21 < width + oobLimit &&\n      x21 > -oobLimit\n    ) {\n      ctx1.moveTo(x11, y1)\n      if (drawCurves) {\n        ctx1.bezierCurveTo(x11, mid, x21, mid, x21, y2)\n      } else {\n        ctx1.lineTo(x21, y2)\n      }\n    }\n  }\n  ctx1.stroke()\n\n  // this loop only draws small lines as a polyline, the polyline calls\n  // ctx.stroke once is much more efficient than calling stroke() many times\n  ctx1.fillStyle = colorMap.M\n  ctx1.strokeStyle = colorMap.M\n  for (const { p11, p12, p21, p22, f, cigar } of featPositions) {\n    const x11 = p11.offsetPx - offsets[level]!\n    const x12 = p12.offsetPx - offsets[level]!\n    const x21 = p21.offsetPx - offsets[level + 1]!\n    const x22 = p22.offsetPx - offsets[level + 1]!\n    const l1 = Math.abs(x12 - x11)\n    const l2 = Math.abs(x22 - x21)\n    const minX = Math.min(x21, x22)\n    const maxX = Math.max(x21, x22)\n    const y1 = 0\n    const y2 = height\n    const mid = (y2 - y1) / 2\n\n    if (\n      !(l1 <= lineLimit && l2 <= lineLimit) &&\n      doesIntersect2(minX, maxX, -oobLimit, view.width + oobLimit)\n    ) {\n      const s1 = f.get('strand')\n      const k1 = s1 === -1 ? x12 : x11\n      const k2 = s1 === -1 ? x11 : x12\n\n      // rev1/rev2 flip the direction of the CIGAR drawing in horizontally flipped\n      // modes. somewhat heuristically determined, but tested for\n      const rev1 = k1 < k2 ? 1 : -1\n      const rev2 = (x21 < x22 ? 1 : -1) * s1\n\n      // cx1/cx2 are the current x positions on top and bottom rows\n      let cx1 = k1\n      let cx2 = s1 === -1 ? x22 : x21\n      if (cigar.length && drawCIGAR) {\n        // continuingFlag skips drawing commands on very small CIGAR features\n        let continuingFlag = false\n\n        // px1/px2 are the previous x positions on the top and bottom rows\n        let px1 = 0\n        let px2 = 0\n        const unitMultiplier2 = Math.floor(MAX_COLOR_RANGE / cigar.length)\n        for (let j = 0; j < cigar.length; j += 2) {\n          const idx = j * unitMultiplier2 + 1\n\n          const len = +cigar[j]!\n          const op = cigar[j + 1] as keyof typeof colorMap\n\n          if (!continuingFlag) {\n            px1 = cx1\n            px2 = cx2\n          }\n\n          const d1 = len / bpPerPxs[level]!\n          const d2 = len / bpPerPxs[level + 1]!\n\n          if (op === 'M' || op === '=' || op === 'X') {\n            cx1 += d1 * rev1\n            cx2 += d2 * rev2\n          } else if (op === 'D' || op === 'N') {\n            cx1 += d1 * rev1\n          }\n          // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n          else if (op === 'I') {\n            cx2 += d2 * rev2\n          }\n\n          // check that we are even drawing in view here, e.g. that all\n          // points are not all less than 0 or greater than width\n          if (\n            !(\n              Math.max(px1, px2, cx1, cx2) < 0 ||\n              Math.min(px1, px2, cx1, cx2) > width\n            )\n          ) {\n            // if it is a small feature and not the last element of the\n            // CIGAR (which could skip rendering it entire if we did turn\n            // it on), then turn on continuing flag\n            const isNotLast = j < cigar.length - 2\n            if (\n              Math.abs(cx1 - px1) <= 1 &&\n              Math.abs(cx2 - px2) <= 1 &&\n              isNotLast\n            ) {\n              continuingFlag = true\n            } else {\n              // allow rendering the dominant color when using continuing\n              // flag if the last element of continuing was a large\n              // feature, else just use match\n              ctx1.fillStyle =\n                colorMap[(continuingFlag && d1 > 1) || d2 > 1 ? op : 'M']\n              continuingFlag = false\n\n              draw(ctx1, px1, cx1, y1, cx2, px2, y2, mid, drawCurves)\n              ctx1.fill()\n              if (ctx3) {\n                ctx3.fillStyle = makeColor(idx)\n                draw(ctx3, px1, cx1, y1, cx2, px2, y2, mid, drawCurves)\n                ctx3.fill()\n              }\n            }\n          }\n        }\n      } else {\n        draw(ctx1, x11, x12, y1, x22, x21, y2, mid, drawCurves)\n        ctx1.fill()\n      }\n    }\n  }\n\n  // draw click map\n  const ctx2 = model.clickMapCanvas?.getContext('2d')\n  if (!ctx2) {\n    return\n  }\n  ctx2.imageSmoothingEnabled = false\n  ctx2.clearRect(0, 0, width, height)\n  for (let i = 0; i < featPositions.length; i++) {\n    const feature = featPositions[i]!\n    const idx = i * unitMultiplier + 1\n    ctx2.fillStyle = makeColor(idx)\n\n    // too many click map false positives with colored stroked lines\n    drawMatchSimple({\n      cb: ctx => {\n        ctx.fill()\n      },\n      feature,\n      ctx: ctx2,\n      drawCurves,\n      level,\n      offsets,\n      oobLimit,\n      viewWidth: view.width,\n      hideTiny: true,\n      height,\n    })\n  }\n}\n\nexport function drawMouseoverSynteny(model: LinearSyntenyDisplayModel) {\n  const { level, clickId, mouseoverId } = model\n  const highResolutionScaling = 1\n  const view = getContainingView(model) as LinearSyntenyViewModel\n  const drawCurves = view.drawCurves\n  const height = model.height\n  const width = view.width\n  const ctx = model.mouseoverCanvas?.getContext('2d')\n  const offsets = view.views.map(v => v.offsetPx)\n\n  if (!ctx) {\n    return\n  }\n  ctx.resetTransform()\n  ctx.scale(highResolutionScaling, highResolutionScaling)\n  ctx.clearRect(0, 0, width, height)\n  ctx.strokeStyle = 'rgba(0, 0, 0, 0.9)'\n  ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'\n  const feature1 = model.featMap[mouseoverId || '']\n  if (feature1) {\n    drawMatchSimple({\n      cb: ctx => {\n        ctx.fill()\n      },\n      feature: feature1,\n      level,\n      ctx,\n      oobLimit,\n      viewWidth: view.width,\n      drawCurves,\n      offsets,\n      height,\n    })\n  }\n  const feature2 = model.featMap[clickId || '']\n  if (feature2) {\n    drawMatchSimple({\n      cb: ctx => {\n        ctx.stroke()\n      },\n      feature: feature2,\n      ctx,\n      level,\n      oobLimit,\n      viewWidth: view.width,\n      drawCurves,\n      offsets,\n      height,\n    })\n  }\n}\n","import type React from 'react'\n\nimport {\n  assembleLocString,\n  doesIntersect2,\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\n\nimport { MAX_COLOR_RANGE, getId } from '../drawSynteny'\n\nimport type { LinearSyntenyDisplayModel } from '../model'\nimport type { Feature } from '@jbrowse/core/util'\n\ninterface Pos {\n  offsetPx: number\n}\n\nexport interface ClickCoord {\n  clientX: number\n  clientY: number\n  feature: { f: Feature }\n}\n\ninterface FeatPos {\n  p11: Pos\n  p12: Pos\n  p21: Pos\n  p22: Pos\n  f: Feature\n  cigar: string[]\n}\n\nexport function drawMatchSimple({\n  feature,\n  ctx,\n  offsets,\n  level,\n  cb,\n  height,\n  drawCurves,\n  oobLimit,\n  viewWidth,\n  hideTiny,\n}: {\n  feature: FeatPos\n  ctx: CanvasRenderingContext2D\n  offsets: number[]\n  level: number\n  oobLimit: number\n  viewWidth: number\n  cb: (ctx: CanvasRenderingContext2D) => void\n  height: number\n  drawCurves?: boolean\n  hideTiny?: boolean\n}) {\n  const { p11, p12, p21, p22 } = feature\n\n  const x11 = p11.offsetPx - offsets[level]!\n  const x12 = p12.offsetPx - offsets[level]!\n  const x21 = p21.offsetPx - offsets[level + 1]!\n  const x22 = p22.offsetPx - offsets[level + 1]!\n\n  const l1 = Math.abs(x12 - x11)\n  const l2 = Math.abs(x22 - x21)\n  const y1 = 0\n  const y2 = height\n  const mid = (y2 - y1) / 2\n  const minX = Math.min(x21, x22)\n  const maxX = Math.max(x21, x22)\n\n  if (!doesIntersect2(minX, maxX, -oobLimit, viewWidth + oobLimit)) {\n    return\n  }\n\n  // drawing a line if the results are thin: drawing a line results in much\n  // less pixellation than filling in a thin polygon\n  if (l1 <= 1 && l2 <= 1) {\n    // hideTiny can be used to avoid drawing mouseover for thin lines in this\n    // case\n    if (!hideTiny) {\n      ctx.beginPath()\n      ctx.moveTo(x11, y1)\n      if (drawCurves) {\n        ctx.bezierCurveTo(x11, mid, x21, mid, x21, y2)\n      } else {\n        ctx.lineTo(x21, y2)\n      }\n      ctx.stroke()\n    }\n  } else {\n    draw(ctx, x11, x12, y1, x22, x21, y2, mid, drawCurves)\n    cb(ctx)\n  }\n}\n\nexport function draw(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n  mid: number,\n  drawCurves?: boolean,\n) {\n  if (drawCurves) {\n    drawBezierBox(ctx, x1, x2, y1, x3, x4, y2, mid)\n  } else {\n    drawBox(ctx, x1, x2, y1, x3, x4, y2)\n  }\n}\n\nexport function drawBox(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n) {\n  ctx.beginPath()\n  ctx.moveTo(x1, y1)\n  ctx.lineTo(x2, y1)\n  ctx.lineTo(x3, y2)\n  ctx.lineTo(x4, y2)\n  ctx.closePath()\n}\n\nexport function drawBezierBox(\n  ctx: CanvasRenderingContext2D,\n  x1: number,\n  x2: number,\n  y1: number,\n  x3: number,\n  x4: number,\n  y2: number,\n  mid: number,\n) {\n  const len1 = Math.abs(x1 - x2)\n  const len2 = Math.abs(x1 - x2)\n\n  // heuristic to not draw hourglass inversions with bezier curves when they\n  // are thin and far apart because it results in areas that are not drawn well\n  // demo https://codesandbox.io/s/fast-glitter-q3b1or?file=/src/index.js\n  if (len1 < 5 && len2 < 5 && x2 < x1 && Math.abs(x1 - x3) > 100) {\n    const tmp = x1\n    x1 = x2\n    x2 = tmp\n  }\n  ctx.beginPath()\n  ctx.moveTo(x1, y1)\n  ctx.lineTo(x2, y1)\n  ctx.bezierCurveTo(x2, mid, x3, mid, x3, y2)\n  ctx.lineTo(x4, y2)\n  ctx.bezierCurveTo(x4, mid, x1, mid, x1, y1)\n  ctx.closePath()\n}\n\nexport function onSynClick(\n  event: React.MouseEvent,\n  model: LinearSyntenyDisplayModel,\n) {\n  const view = getContainingView(model)\n  const track = getContainingTrack(model)\n  const {\n    featPositions,\n    numFeats,\n    clickMapCanvas: ref1,\n    cigarClickMapCanvas: ref2,\n    level,\n  } = model\n  if (!ref1 || !ref2) {\n    return\n  }\n  const rect = ref1.getBoundingClientRect()\n  const ctx1 = ref1.getContext('2d')\n  const ctx2 = ref2.getContext('2d')\n  if (!ctx1 || !ctx2) {\n    return\n  }\n  const x = event.clientX - rect.left\n  const y = event.clientY - rect.top\n  const [r1, g1, b1] = ctx1.getImageData(x, y, 1, 1).data\n  const unitMultiplier = Math.floor(MAX_COLOR_RANGE / numFeats)\n  const id = getId(r1!, g1!, b1!, unitMultiplier)\n  const feat = featPositions[id]\n  if (feat) {\n    const { f } = feat\n    model.setClickId(f.id())\n    const session = getSession(model)\n    if (isSessionModelWithWidgets(session)) {\n      session.showWidget(\n        session.addWidget('SyntenyFeatureWidget', 'syntenyFeature', {\n          view,\n          track,\n          featureData: f.toJSON(),\n          level,\n        }),\n      )\n    }\n  }\n  return feat\n}\n\nexport function onSynContextClick(\n  event: React.MouseEvent,\n  model: LinearSyntenyDisplayModel,\n  setAnchorEl: (arg: ClickCoord) => void,\n) {\n  event.preventDefault()\n  const ref1 = model.clickMapCanvas\n  const ref2 = model.cigarClickMapCanvas\n  if (!ref1 || !ref2) {\n    return\n  }\n  const rect = ref1.getBoundingClientRect()\n  const ctx1 = ref1.getContext('2d')\n  const ctx2 = ref2.getContext('2d')\n  if (!ctx1 || !ctx2) {\n    return\n  }\n  const { clientX, clientY } = event\n  const x = clientX - rect.left\n  const y = clientY - rect.top\n  const [r1, g1, b1] = ctx1.getImageData(x, y, 1, 1).data\n  const unitMultiplier = Math.floor(MAX_COLOR_RANGE / model.numFeats)\n  const id = getId(r1!, g1!, b1!, unitMultiplier)\n  const f = model.featPositions[id]\n  if (f) {\n    model.setClickId(f.f.id())\n    setAnchorEl({ clientX, clientY, feature: f })\n  }\n}\n\nexport function getTooltip({\n  feature,\n  cigarOp,\n  cigarOpLen,\n}: {\n  feature: Feature\n  cigarOp?: string\n  cigarOpLen?: string\n}) {\n  // @ts-expect-error\n  const f1 = feature.toJSON() as {\n    refName: string\n    start: number\n    end: number\n    strand?: number\n    assemblyName: string\n    identity?: number\n    name?: string\n    mate: {\n      start: number\n      end: number\n      refName: string\n      name: string\n    }\n  }\n  const f2 = f1.mate\n  const l1 = f1.end - f1.start\n  const l2 = f2.end - f2.start\n  const identity = f1.identity\n  const n1 = f1.name\n  const n2 = f2.name\n  return [\n    `Loc1: ${assembleLocString(f1)}`,\n    `Loc2: ${assembleLocString(f2)}`,\n    `Inverted: ${f1.strand === -1}`,\n    `Query len: ${l1.toLocaleString('en-US')}`,\n    `Target len: ${l2.toLocaleString('en-US')}`,\n    identity ? `Identity: ${identity.toPrecision(2)}` : '',\n    cigarOp ? `CIGAR operator: ${cigarOp}${cigarOpLen}` : '',\n    n1 ? `Name 1: ${n1}` : '',\n    n2 ? `Name 2: ${n2}` : '',\n  ]\n    .filter(f => !!f)\n    .join('<br/>')\n}\n","import { stripAlpha } from '@jbrowse/core/util'\nimport { useTheme } from '@mui/material'\n\nexport default function SVGBackground({\n  width,\n  height,\n  shift,\n}: {\n  width: number\n  height: number\n  shift: number\n}) {\n  const theme = useTheme()\n  return (\n    <rect\n      width={width + shift * 2}\n      height={height}\n      fill={stripAlpha(theme.palette.background.default)}\n    />\n  )\n}\n","import { getFillProps } from '@jbrowse/core/util'\nimport { SVGRuler, SVGTracks } from '@jbrowse/plugin-linear-genome-view'\nimport { useTheme } from '@mui/material'\n\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nexport default function SVGLinearGenomeView({\n  trackLabelOffset,\n  fontSize,\n  textHeight,\n  trackLabels,\n  view,\n  displayResults,\n  rulerHeight,\n  shift,\n}: {\n  textHeight: number\n  trackLabels: string\n  trackLabelOffset: number\n  fontSize: number\n  view: LinearGenomeViewModel\n\n  displayResults: any\n  rulerHeight: number\n  shift: number\n}) {\n  const theme = useTheme()\n  return (\n    <g transform={`translate(${shift} ${fontSize})`}>\n      <g transform={`translate(${trackLabelOffset})`}>\n        <text\n          x={0}\n          fontSize={fontSize}\n          {...getFillProps(theme.palette.text.primary)}\n        >\n          {view.assemblyNames.join(', ')}\n        </text>\n        <SVGRuler model={displayResults.view} fontSize={fontSize} />\n      </g>\n      <g transform={`translate(0 ${rulerHeight + fontSize})`}>\n        <SVGTracks\n          textHeight={textHeight}\n          trackLabels={trackLabels}\n          fontSize={fontSize}\n          model={displayResults.view}\n          displayResults={displayResults.data}\n          trackLabelOffset={trackLabelOffset}\n        />\n      </g>\n    </g>\n  )\n}\n","import { createJBrowseTheme } from '@jbrowse/core/ui'\nimport {\n  ReactRendering,\n  getSerializedSvg,\n  getSession,\n  max,\n  measureText,\n  renderToAbstractCanvas,\n  renderToStaticMarkup,\n  sum,\n} from '@jbrowse/core/util'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\nimport { totalHeight } from '@jbrowse/plugin-linear-genome-view'\nimport { ThemeProvider } from '@mui/material'\nimport { when } from 'mobx'\n\nimport SVGBackground from './SVGBackground'\nimport SVGLinearGenomeView from './SVGLinearGenomeView'\nimport { drawRef } from '../../LinearSyntenyDisplay/drawSynteny'\n\nimport type { ExportSvgOptions, LinearSyntenyViewModel } from '../model'\n\n// render LGV to SVG\nexport async function renderToSvg(\n  model: LinearSyntenyViewModel,\n  opts: ExportSvgOptions,\n) {\n  await when(() => model.initialized)\n  const {\n    textHeight = 18,\n    rulerHeight = 30,\n    fontSize = 13,\n    trackLabels = 'offset',\n    Wrapper = ({ children }) => children,\n    themeName = 'default',\n  } = opts\n  const session = getSession(model)\n  const themeVar = session.allThemes?.()[themeName]\n  const { width, views, levels } = model\n  const shift = 50\n  const offset = rulerHeight\n\n  const heights = views.map(\n    v => totalHeight(v.tracks, textHeight, trackLabels) + offset,\n  )\n  const totalHeightSvg = sum(heights) + sum(levels.map(l => l.height)) + 100\n\n  const displayResults = await Promise.all(\n    views.map(\n      async view =>\n        ({\n          view,\n          data: await Promise.all(\n            view.tracks.map(async track => {\n              const d = track.displays[0]\n              await when(() => (d.ready !== undefined ? d.ready : true))\n              return {\n                track,\n                result: await d.renderSvg({ ...opts, theme: themeVar }),\n              }\n            }),\n          ),\n        }) as const,\n    ),\n  )\n\n  const renderings = await Promise.all(\n    levels.map(\n      async level =>\n        await Promise.all(\n          level.tracks.map(async track => {\n            const d = track.displays[0]\n            await when(() => (d.ready !== undefined ? d.ready : true))\n            const r = await renderToAbstractCanvas(\n              width,\n              level.height,\n              { exportSVG: opts },\n              ctx => {\n                drawRef(d, ctx)\n                return undefined\n              },\n            )\n\n            if ('imageData' in r) {\n              throw new Error('found a canvas in svg export, probably a bug')\n            } else if ('canvasRecordedData' in r) {\n              return {\n                html: await getSerializedSvg({\n                  ...r,\n                  width,\n                  height: level.height,\n                }),\n              }\n            } else {\n              return r\n            }\n          }),\n        ),\n    ),\n  )\n\n  const trackLabelMaxLen =\n    max(\n      views.flatMap(view =>\n        view.tracks.map(track =>\n          measureText(getTrackName(track.configuration, session), fontSize),\n        ),\n      ),\n      0,\n    ) + 40\n  const trackLabelOffset = trackLabels === 'left' ? trackLabelMaxLen : 0\n  const w = width + trackLabelOffset\n  const theme = createJBrowseTheme(themeVar)\n  const RenderList = [\n    <SVGLinearGenomeView\n      rulerHeight={rulerHeight}\n      trackLabelOffset={trackLabelOffset}\n      shift={shift}\n      textHeight={textHeight}\n      trackLabels={trackLabels}\n      displayResults={displayResults[0]}\n      key={views[0]!.id}\n      view={views[0]!}\n      fontSize={fontSize}\n    />,\n  ] as React.ReactNode[]\n  let currOffset = heights[0]! + fontSize + rulerHeight\n  for (let i = 1; i < views.length; i++) {\n    const view = views[i]!\n    const level = levels[i - 1]!\n    const rendering = renderings[i - 1]\n    const height = heights[i]!\n    const levelHeight = level.height || 0\n    RenderList.push(\n      <g key={view.id} transform={`translate(0 ${currOffset})`}>\n        {levelHeight ? (\n          <defs>\n            <clipPath id={`synclip-${i}`}>\n              <rect x={0} y={0} width={width} height={levelHeight} />\n            </clipPath>\n          </defs>\n        ) : null}\n        <g\n          transform={`translate(${shift + trackLabelOffset} ${fontSize})`}\n          clipPath={`url(#synclip-${i})`}\n        >\n          {rendering?.map((r, i) => (\n            /* biome-ignore lint/suspicious/noArrayIndexKey: */\n            <ReactRendering key={i} rendering={r} />\n          ))}\n        </g>\n        <g transform={`translate(0 ${levelHeight})`}>\n          <SVGLinearGenomeView\n            rulerHeight={rulerHeight}\n            shift={shift}\n            trackLabelOffset={trackLabelOffset}\n            textHeight={textHeight}\n            trackLabels={trackLabels}\n            displayResults={displayResults[i]}\n            key={view.id}\n            view={view}\n            fontSize={fontSize}\n          />\n        </g>\n      </g>,\n    )\n    currOffset += height + fontSize + rulerHeight + levelHeight\n  }\n\n  // the xlink namespace is used for rendering <image> tag\n  return renderToStaticMarkup(\n    <ThemeProvider theme={theme}>\n      <Wrapper>\n        <svg\n          width={width}\n          height={totalHeightSvg}\n          xmlns=\"http://www.w3.org/2000/svg\"\n          xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n          viewBox={[0, 0, w + shift * 2, totalHeightSvg].toString()}\n        >\n          <SVGBackground width={w} height={totalHeightSvg} shift={shift} />\n          {RenderList}\n        </svg>\n      </Wrapper>\n    </ThemeProvider>,\n  )\n}\n"],"names":["MAX_COLOR_RANGE","makeColor","idx","Math","floor","colorMap","I","N","D","X","M","lineLimit","oobLimit","getId","r","g","b","unitMultiplier","drawRef","model","ctx1","ctx3","view","getContainingView","drawCurves","drawCIGAR","level","height","featPositions","width","bpPerPxs","views","map","v","bpPerPx","imageSmoothingEnabled","beginPath","offsets","offsetPx","length","fillStyle","strokeStyle","p11","p12","p21","p22","x11","x12","x21","x22","l1","abs","l2","y1","y2","mid","moveTo","bezierCurveTo","lineTo","stroke","f","cigar","minX","min","maxX","max","doesIntersect2","s1","get","k1","rev1","rev2","cx1","cx2","continuingFlag","px1","px2","unitMultiplier2","j","len","op","d1","d2","isNotLast","draw","fill","ctx2","clickMapCanvas","getContext","clearRect","i","feature","drawMatchSimple","cb","ctx","viewWidth","hideTiny","drawMouseoverSynteny","clickId","mouseoverId","mouseoverCanvas","resetTransform","scale","feature1","featMap","feature2","x1","x2","x3","x4","len1","len2","tmp","closePath","drawBezierBox","drawBox","onSynClick","event","track","getContainingTrack","numFeats","ref1","cigarClickMapCanvas","ref2","rect","getBoundingClientRect","x","clientX","left","y","clientY","top","r1","g1","b1","getImageData","data","feat","setClickId","id","session","getSession","isSessionModelWithWidgets","showWidget","addWidget","featureData","toJSON","onSynContextClick","setAnchorEl","preventDefault","getTooltip","cigarOp","cigarOpLen","f1","f2","mate","end","start","identity","n1","name","n2","assembleLocString","strand","toLocaleString","toPrecision","filter","join","SVGBackground","shift","theme","useTheme","_jsx","stripAlpha","palette","background","default","SVGLinearGenomeView","trackLabelOffset","fontSize","textHeight","trackLabels","displayResults","rulerHeight","_jsxs","transform","children","getFillProps","text","primary","assemblyNames","SVGRuler","SVGTracks","async","renderToSvg","opts","when","initialized","Wrapper","themeName","themeVar","allThemes","levels","offset","heights","totalHeight","tracks","totalHeightSvg","sum","l","Promise","all","d","displays","undefined","ready","result","renderSvg","renderings","renderToAbstractCanvas","exportSVG","Error","html","getSerializedSvg","trackLabelMaxLen","flatMap","measureText","getTrackName","configuration","w","createJBrowseTheme","RenderList","currOffset","rendering","levelHeight","push","clipPath","ReactRendering","renderToStaticMarkup","ThemeProvider","xmlns","xmlnsXlink","viewBox","toString"],"sourceRoot":""}