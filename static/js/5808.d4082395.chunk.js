"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5808],{1231(e,t,n){n.d(t,{X:()=>d});var r=n(99226),a=n(12197),o=n(87877),i=n(11259),s=n(9255),l=n(27868);const c="undefined"==typeof sessionStorage,d=r.types.model("InternetAccount",{id:l.K,type:r.types.string,configuration:(0,o.AK)(a.y)}).views(e=>({get name(){return(0,i.FI)(e,"name")},get description(){return(0,i.FI)(e,"description")},get internetAccountId(){return(0,i.FI)(e,"internetAccountId")},get authHeader(){return(0,i.FI)(e,"authHeader")},get tokenType(){return(0,i.FI)(e,"tokenType")},get domains(){return(0,i.FI)(e,"domains")},get toggleContents(){return null},get SelectorComponent(){},get selectorLabel(){}})).views(e=>({handlesLocation:t=>e.domains.some(e=>t.uri.includes(e)),get tokenKey(){return`${e.internetAccountId}-token`}})).actions(e=>({getTokenFromUser(e,t){throw new Error("getTokenFromUser must be implemented by extending model")},storeToken(t){sessionStorage.setItem(e.tokenKey,t)},removeToken(){sessionStorage.removeItem(e.tokenKey)},retrieveToken:()=>sessionStorage.getItem(e.tokenKey),validateToken:async(e,t)=>e})).actions(e=>{let t;return{async getToken(n){if(t)return t;let r=n?.internetAccountPreAuthorization?.authInfo?.token;if(r)return t=Promise.resolve(r),t;if(c)throw new Error("Did not get internet account pre-authorization info in worker");return r=e.retrieveToken(),r?(t=Promise.resolve(r),t):(t=new Promise((t,n)=>{e.getTokenFromUser(n=>{e.storeToken(n),t(n)},t=>{e.removeToken(),n(t)})}),t)}}}).actions(e=>({addAuthHeaderToInit:(t,n)=>({...t,headers:new Headers({...t?.headers,...n?{[e.authHeader]:e.tokenType?`${e.tokenType} ${n}`:n}:{}})}),async getPreAuthorizationInformation(t){const n=await e.getToken(t);let r;try{r=await e.validateToken(n,t)}catch(t){throw e.removeToken(),t}return{internetAccountType:e.type,authInfo:{token:r,configuration:(0,i.FI)(e)}}}})).actions(e=>({getFetcher:t=>async(n,r)=>{const a=await e.getToken(t),o=e.addAuthHeaderToInit(r,a);return fetch(n,o)}})).actions(e=>({openLocation:t=>new s.g(t.uri,{fetch:e.getFetcher(t)})}))},1818(e,t,n){n.d(t,{$G:()=>l,Db:()=>c,fK:()=>d});var r=n(30936),a=n(65045),o=n(64074),i=n(32118);const s=(0,a.n)()(e=>({contentBlock:{position:"relative",minHeight:"100%",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden"},elidedBlock:{minHeight:"100%",boxSizing:"border-box",backgroundColor:"#999",backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)"},interRegionPaddingBlock:{minHeight:"100%",backgroundColor:e.palette.text.disabled},boundaryPaddingBlock:{minHeight:"100%",backgroundColor:e.palette.action.disabledBackground}})),l=(0,o.observer)(function({block:e,children:t}){const{classes:n}=s(),{widthPx:r}=e;return(0,i.jsx)("div",{style:{width:r},className:n.contentBlock,children:t})});function c(e){const t=(0,r.c)(5),{width:n}=e,{classes:a}=s();let o,l;return t[0]!==n?(o={width:n},t[0]=n,t[1]=o):o=t[1],t[2]!==a.elidedBlock||t[3]!==o?(l=(0,i.jsx)("div",{className:a.elidedBlock,style:o}),t[2]=a.elidedBlock,t[3]=o,t[4]=l):l=t[4],l}function d(e){const t=(0,r.c)(8),{boundary:n,width:a,style:o}=e;let l;t[0]!==o?(l=void 0===o?{}:o,t[0]=o,t[1]=l):l=t[1];const c=l,{classes:d}=s();let u;t[2]!==c||t[3]!==a?(u={...c,width:a},t[2]=c,t[3]=a,t[4]=u):u=t[4];const p=n?d.boundaryPaddingBlock:d.interRegionPaddingBlock;let h;return t[5]!==u||t[6]!==p?(h=(0,i.jsx)("div",{style:u,className:p}),t[5]=u,t[6]=p,t[7]=h):h=t[7],h}},1821(e,t,n){n.r(t),n.d(t,{AssemblySelector:()=>o.A,BaseTooltip:()=>b.A,CascadingMenu:()=>i.A,CascadingMenuButton:()=>s.A,Dialog:()=>l.A,EditableTypography:()=>c.A,ErrorMessage:()=>d.A,ExternalLink:()=>f.A,FatalErrorDialog:()=>u.A,FileSelector:()=>p.A,LoadingEllipses:()=>h.A,LogoFull:()=>a.P,Logomark:()=>a.R,Menu:()=>i.A,PrerenderedCanvas:()=>g.A,ResizeHandle:()=>m.A,SanitizedHTML:()=>y.A,VIEW_HEADER_HEIGHT:()=>w,createJBrowseBaseTheme:()=>r.createJBrowseBaseTheme,createJBrowseTheme:()=>r.createJBrowseTheme,defaultThemes:()=>r.defaultThemes});var r=n(17868),a=n(68674),o=n(34592),i=n(14391),s=n(35913),l=n(85787),c=n(86520),d=n(27351),u=n(64171),p=n(82699),h=n(87574),g=n(93111),m=n(28397),f=n(84830),y=n(50639),b=n(71547);const w=28},1879(e,t,n){function r(e,t){return{range:e.range(),values:e.ticks(t),format:e.tickFormat(t),position:e.copy()}}n.d(t,{A:()=>r})},2156(e,t,n){n.d(t,{A:()=>o});var r=n(87877),a=n(98612);const o=function(e){return(0,r.S7)("LinearBasicDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:a.A,explicitlyTyped:!0})}},3026(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{displayTypes=[];constructor(e){super(e),this.stateModel=e.stateModel,this.configSchema=e.configSchema}addDisplayType(e){this.displayTypes.push(e)}}},3231(e,t,n){n.d(t,{S:()=>a});var r=n(77251);function a(e){return 0===e.length?0:20+Math.max(...e.map(e=>(0,r.measureText)(e.label,10)))+6+20}},4648(e,t,n){n.r(t),n.d(t,{default:()=>l});var r=n(42918),a=n(93111),o=n(77251),i=n(64074),s=n(32118);const l=(0,i.observer)(function(e){const{regions:t,features:n,bpPerPx:i,width:l,height:c,displayModel:d}=e,u=t[0],p=(0,r.useRef)(null);function h(e){let t=0;p.current&&(t=p.current.getBoundingClientRect().left);const r=e-t,a=u.reversed?l-r:r,o=u.start+i*a;let s;for(const e of n.values())if(o<=e.get("end")+i&&o>=e.get("start")){s=e;break}return s}return(0,s.jsx)("div",{ref:p,"data-testid":"wiggle-rendering-test",onMouseMove:e=>{d.setFeatureIdUnderMouse(h(e.clientX)?.id())},onClick:e=>{const t=h(e.clientX)?.id();t&&d.selectFeatureById(t).catch(e=>{console.error(e),(0,o.getSession)(d).notifyError(`${e}`,e)})},onMouseLeave:()=>{d.setFeatureIdUnderMouse(void 0)},style:{overflow:"visible",position:"relative",height:c},children:(0,s.jsx)(a.A,{...e})})})},5248(e,t,n){n.d(t,{KS:()=>o,Xx:()=>r,ap:()=>i,fs:()=>s,q3:()=>a});const r=1,a=8,o=32,i=256,s=2048},7062(e,t,n){n.d(t,{J:()=>o});var r=n(99226),a=n(87877);function o(e){return(0,a.S7)("BaseTrack",{name:{description:"descriptive name of the track",type:"string",defaultValue:"Track"},assemblyNames:{description:"name of the assembly (or assemblies) track belongs to",type:"stringArray",defaultValue:["assemblyName"]},description:{description:"a description of the track",type:"string",defaultValue:""},category:{description:"the category and sub-categories of a track",type:"stringArray",defaultValue:[]},metadata:{type:"frozen",description:"anything to add about this track",defaultValue:{}},rpcDriverName:{type:"string",description:"RPC driver to use for this track. Leave empty to use the display-level or global default.",defaultValue:""},adapter:e.pluggableConfigSchemaType("adapter"),textSearching:(0,a.S7)("textSearching",{indexingAttributes:{type:"stringArray",description:"list of which feature attributes to index for text searching",defaultValue:["Name","ID"]},indexingFeatureTypesToExclude:{type:"stringArray",description:"list of feature types to exclude in text search index",defaultValue:["CDS","exon"]},textSearchAdapter:e.pluggableConfigSchemaType("text search adapter")}),displays:r.types.array(e.pluggableConfigSchemaType("display")),formatDetails:(0,a.S7)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth of subfeatures to iterate the formatter on formatDetails.subfeatures (e.g. you may not want to format the exon/cds subfeatures, so limited to 2"},maxDepth:{type:"number",defaultValue:99999,description:"Maximum depth to render subfeatures"}}),formatAbout:(0,a.S7)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}})},{preProcessSnapshot:t=>{const n=e.evaluateExtensionPoint("Core-preProcessTrackConfig",structuredClone(t)),{displays:r=[]}=n;if("placeholderId"!==n.trackId)try{const t=new Set(r.map(e=>e.type));for(const a of e.getTrackType(n.type).displayTypes)t.has(a.name)||r.push({displayId:`${n.trackId}-${a.name}`,type:a.name})}catch(e){throw new Error(`Unknown track type "${n.type}" in ${JSON.stringify(n)}`,{cause:e})}return{...n,displays:r.map(e=>({...e,displayId:e.displayId??`${n.trackId}-${e.type}`}))}},explicitIdentifier:"trackId",explicitlyTyped:!0,actions:e=>({addDisplayConf(t){const{type:n}=t;if(!n)throw new Error(`unknown display type ${n}`);const r=e.displays.find(e=>e?.displayId===t.displayId);if(r)return r;const a=e.displays.push(t);return e.displays[a-1]}})})}},7668(e,t,n){n.d(t,{A:()=>d});var r=n(14261),a=n(87877),o=n(13861);const i=(0,a.S7)("JB2TrackHubConnection",{configJsonLocation:{type:"fileLocation",defaultValue:{uri:"http://mysite.com/path/to/config.json",locationType:"UriLocation"},description:"location of the jb2 config file (usually called config.json)"},assemblyNames:{type:"stringArray",defaultValue:[],description:"optional list of genomes to import from this config.json, if empty all genomes will be imported"}},{baseConfiguration:o.A,preProcessSnapshot:e=>e.uri?{...e,configJsonLocation:{uri:e.uri,baseUri:e.baseUri}}:e});var s=n(89322),l=n(99226);function c(e){return l.types.compose("JB2TrackHubConnection",(0,s.A)(e),l.types.model({configuration:(0,a.AK)(i),type:l.types.literal("JB2TrackHubConnection")})).actions(e=>({async connect(){const{doConnect:t}=await n.e(5784).then(n.bind(n,35784));t(e)}}))}function d(e){e.addConnectionType(()=>new r.A({name:"JB2TrackHubConnection",configSchema:i,stateModel:c(e),displayName:"JB2 Track Hub",description:"A JBrowse 2 config file based trackhub",url:"https://jbrowse.org/jb2/"}))}},8201(e,t,n){n.d(t,{Kp:()=>d,R1:()=>c,Yo:()=>s,pB:()=>i,zm:()=>l});var r=n(84913),a=n(6172);class o extends Error{}function i(e){if(e){if(!(e instanceof AbortSignal))throw new TypeError("must pass an AbortSignal");if(e.aborted)throw l()}}async function s(e){await new Promise(e=>setTimeout(e,1)),i(e)}function l(){if("undefined"!=typeof DOMException)return new DOMException("aborted","AbortError");const e=new o("aborted");return e.code="ERR_ABORTED",e}function c(e){return e?(0,a.R)(e,"abort"):new r.c}function d(e){return e instanceof Error&&("AbortError"===e.name||"ERR_ABORTED"===e.code||/\b(aborted|aborterror)\b/i.test(e.message))}},9255(e,t,n){n.d(t,{g:()=>s});var r=n(8213),a=n(70029);const o={},i=new r.j({fetch:function(e,t,n,r={}){const a=o[e];if(!a)throw new Error(`fetch not registered for ${e}`);return a(e,t,n,r)},size:524288e3,chunkSize:131072,maxFetchSize:104857600,minimumTTL:864e5});class s extends a.A{async fetch(e,t){const n=String(e);o[n]||(o[n]=this.fetchBinaryRange.bind(this));const r=new Headers(t?.headers).get("range");if(r){const t=/bytes=(\d+)-(\d+)/.exec(r);if(t){const[,n,r]=t,a=Number.parseInt(n,10),o=Number.parseInt(r,10)-a,{buffer:s,headers:l}=await i.getRange(`${e}`,a,o+1);return new Response(s,{status:206,headers:l})}}return super.fetch(e,t)}async fetchBinaryRange(e,t,n,r={}){const a=new Date,o=await super.fetch(e,{...r,headers:{...r.headers,range:`bytes=${t}-${n}`}}),i=new Date;if(!o.ok){const r=`HTTP ${o.status} fetching ${e} bytes ${t}-${n}`,a=" (should be 206 for range requests)";throw new Error(`${r}${200===o.status?a:""}`)}const s={};for(const[e,t]of o.headers.entries())s[e]=t;const l=await o.arrayBuffer();return{headers:s,requestDate:a,responseDate:i,buffer:new Uint8Array(l)}}}},10240(e,t,n){n.d(t,{A:()=>h});var r=n(42918),a=n(87877),o=n(11259),i=n(77251),s=n(10525),l=n(52901),c=n(99226),d=n(58730),u=n(27535);const p=(0,r.lazy)(()=>n.e(3369).then(n.bind(n,83369)));function h(e){return c.types.compose(d.L,c.types.model({selectedRendering:c.types.optional(c.types.string,""),resolution:c.types.optional(c.types.number,1),fill:c.types.maybe(c.types.boolean),minSize:c.types.maybe(c.types.number),color:c.types.maybe(c.types.string),posColor:c.types.maybe(c.types.string),negColor:c.types.maybe(c.types.string),summaryScoreMode:c.types.maybe(c.types.string),rendererTypeNameState:c.types.maybe(c.types.string),scale:c.types.maybe(c.types.string),autoscale:c.types.maybe(c.types.string),displayCrossHatches:c.types.maybe(c.types.boolean),constraints:c.types.optional(c.types.model({max:c.types.maybe(c.types.number),min:c.types.maybe(c.types.number)}),{}),configuration:(0,a.AK)(e)})).volatile(()=>({message:void 0,stats:void 0,statsFetchInProgress:void 0})).actions(e=>({updateQuantitativeStats(t,n){const{currStatsBpPerPx:r,scoreMin:a,scoreMax:o}=t,i=1e-6;(!e.stats||Math.abs(e.stats.scoreMax-o)>i||Math.abs(e.stats.scoreMin-a)>i||e.stats.statsRegion!==n)&&(e.stats={currStatsBpPerPx:r,scoreMin:a,scoreMax:o,statsRegion:n})},setColor(t){e.color=t},setPosColor(t){e.posColor=t},setNegColor(t){e.negColor=t},setStatsLoading(t){e.statsFetchInProgress&&(0,l.CF)(e.statsFetchInProgress),e.statsFetchInProgress=t},selectFeature(t){const n=(0,i.getSession)(e);(0,s.mY)(n)&&n.setSelection(t)},setResolution(t){e.resolution=t},setFill(t){0===t?(e.fill=!0,e.minSize=0):1===t?(e.fill=!1,e.minSize=1):2===t&&(e.fill=!1,e.minSize=2)},toggleLogScale(){e.scale="log"===e.scale?"linear":"log"},setScaleType(t){e.scale=t},setSummaryScoreMode(t){e.summaryScoreMode=t},setAutoscale(t){e.autoscale=t},setMaxScore(t){e.constraints.max=t},setRendererType(t){e.rendererTypeNameState=t},setMinScore(t){e.constraints.min=t},toggleCrossHatches(){e.displayCrossHatches=!e.displayCrossHatches},setCrossHatches(t){e.displayCrossHatches=t}})).views(e=>({get adapterTypeName(){return e.adapterConfig.type},get rendererTypeNameSimple(){return e.rendererTypeNameState??(0,o.FI)(e,"defaultRendering")},get filters(){},get scaleType(){return e.scale??(0,o.FI)(e,"scaleType")},get maxScore(){return e.constraints.max??(0,o.FI)(e,"maxScore")},get minScore(){return e.constraints.min??(0,o.FI)(e,"minScore")}})).views(e=>({get adapterCapabilities(){const t=e.adapterTypeName,{pluginManager:n}=(0,i.getEnv)(e);return n.getAdapterType(t).adapterCapabilities},get rendererConfig(){const{color:t,displayCrossHatches:n,fill:r,minSize:a,negColor:i,posColor:s,summaryScoreMode:l,scaleType:c,rendererTypeName:d}=e,u=e.configuration.renderers?.[d];return{scaleType:c??(0,o.QZ)(u,"scaleType"),filled:r??(0,o.QZ)(u,"filled"),displayCrossHatches:n??(0,o.QZ)(u,"displayCrossHatches"),summaryScoreMode:l??(0,o.QZ)(u,"summaryScoreMode"),color:t??(0,o.QZ)(u,"color"),negColor:i??(0,o.QZ)(u,"negColor"),posColor:s??(0,o.QZ)(u,"posColor"),minSize:a??(0,o.QZ)(u,"minSize")}},get autoscaleType(){return e.autoscale??(0,o.FI)(e,"autoscale")}})).views(e=>{let t=[0,0];return{get domain(){const{stats:n,scaleType:r,minScore:a,maxScore:o}=e;if(!n)return;const i=(0,u.getNiceDomain)({domain:[n.scoreMin,n.scoreMax],bounds:[a,o],scaleType:r});return"log"===r&&i[1]===Number.MIN_VALUE?[0,Number.MIN_VALUE]:(JSON.stringify(t)!==JSON.stringify(i)&&(t=i),t)}}}).views(e=>({get filled(){return e.rendererConfig.filled},get summaryScoreModeSetting(){return e.rendererConfig.summaryScoreMode},get scaleOpts(){return{domain:e.domain,stats:e.stats,autoscaleType:e.autoscaleType,scaleType:e.scaleType,inverted:(0,o.FI)(e,"inverted")}},get canHaveFill(){return"XYPlotRenderer"===e.rendererTypeName},get displayCrossHatchesSetting(){return e.rendererConfig.displayCrossHatches},get hasResolution(){return e.adapterCapabilities.includes("hasResolution")},get hasGlobalStats(){return e.adapterCapabilities.includes("hasGlobalStats")}})).views(e=>({scoreTrackMenuItems:()=>[...e.hasResolution?[{label:"Resolution",subMenu:[{label:"Finer resolution",onClick:()=>{e.setResolution(5*e.resolution)}},{label:"Coarser resolution",onClick:()=>{e.setResolution(e.resolution/5)}}]},{label:"Summary score mode",subMenu:["min","max","avg","whiskers"].map(t=>({label:t,type:"radio",checked:e.summaryScoreModeSetting===t,onClick:()=>{e.setSummaryScoreMode(t)}}))}]:[],{label:"Scale type",subMenu:[{label:"Linear scale",type:"radio",checked:"linear"===e.scaleType,onClick:()=>{e.setScaleType("linear")}},{label:"Log scale",type:"radio",checked:"log"===e.scaleType,onClick:()=>{e.setScaleType("log")}}]},{label:"Autoscale type",subMenu:[["local","Local"],...e.hasGlobalStats?[["global","Global"],["globalsd","Global ± 3σ"]]:[],["localsd","Local ± 3σ"]].map(([t,n])=>({label:n,type:"radio",checked:e.autoscaleType===t,onClick:()=>{e.setAutoscale(t)}}))},{label:"Set min/max score",onClick:()=>{(0,i.getSession)(e).queueDialog(t=>[p,{model:e,handleClose:t}])}}]})).actions(e=>{const{reload:t}=e;return{async reload(){e.setError(),t()}}}).postProcessSnapshot(e=>{if(!e)return e;const{selectedRendering:t,resolution:n,fill:r,minSize:a,color:o,posColor:i,negColor:s,summaryScoreMode:l,rendererTypeNameState:c,scale:d,autoscale:u,displayCrossHatches:p,constraints:h,...g}=e;return{...g,...t?{selectedRendering:t}:{},...1!==n?{resolution:n}:{},...void 0!==r?{fill:r}:{},...void 0!==a?{minSize:a}:{},...void 0!==o?{color:o}:{},...void 0!==i?{posColor:i}:{},...void 0!==s?{negColor:s}:{},...void 0!==l?{summaryScoreMode:l}:{},...void 0!==c?{rendererTypeNameState:c}:{},...void 0!==d?{scale:d}:{},...void 0!==u?{autoscale:u}:{},...void 0!==p?{displayCrossHatches:p}:{},...void 0!==h.min||void 0!==h.max?{constraints:h}:{}}})}},10387(e,t,n){n.d(t,{H2:()=>i,rQ:()=>o,wJ:()=>a});var r=n(77251);function a(e,t,n=!0){const{assemblyName:a,refName:o,start:i,offset:s,oob:l}=t.pxToBp(e),c=Math.floor(i+s);return l?"out of bounds":`${n?`{${a}}`:""}${o}:${(0,r.toLocale)(c)}`}function o(e,t,n){const r=new Set,a=[...e].sort((e,t)=>{const n=e.end-e.start;return t.end-t.start-n}),o=new Set;for(const{key:e,offsetPx:i}of a){const a=Math.round(t-i+n),s=Math.max(a-12,0);let l=0===a;if(!l)for(let e=s;e<a;e++)if(o.has(e)){l=!0;break}if(l)r.add(e);else for(let e=s;e<a;e++)o.add(e)}return r}function i(e,t,n=!0,r=!0){const a=[],o=function(e){const t=60*(e=Math.abs(e));let n=10**+t.toExponential().split(/e/i)[1];for(;n<t&&(n*=2,!(n>=t));)n*=2.5;n=Math.max(n,5);const r=n/e;let a=0;return!(n%10)&&r/10>=15?a=n/10:!(n%5)&&r/5>=15?a=n/5:!(n%2)&&r/2>=15&&(a=n/2),{majorPitch:n,minorPitch:a}}(t),i=o.minorPitch||o.majorPitch;for(const{start:t,end:s,refName:l}of e){let e=0;const c=t,d=s;for(let s=Math.floor(c/i)*i;s<Math.ceil(d/i)*i+1;s+=i)r&&s%o.majorPitch?(a.push({type:"minor",base:s-1,index:e,refName:l}),e+=1):n&&Math.abs(s-t)>o.minorPitch&&(a.push({type:"major",base:s-1,index:e,refName:l}),e+=1)}return a}},10525(e,t,n){n.d(t,{BY:()=>u,C1:()=>k,DW:()=>o,EO:()=>b,EV:()=>x,J_:()=>A,Nh:()=>S,QW:()=>l,Tl:()=>m,Uy:()=>y,Y$:()=>i,ZL:()=>M,_u:()=>T,bV:()=>w,gx:()=>p,lL:()=>v,lO:()=>d,mY:()=>g,rF:()=>C,rz:()=>a.A,u3:()=>s,xU:()=>f,xv:()=>c,yH:()=>P,zA:()=>h});var r=n(99226),a=n(25986);function o(e){return(0,r.isStateTreeNode)(e)&&"removeView"in e&&"addView"in e&&"views"in e}function i(e){return"object"==typeof e&&null!==e&&"rpcManager"in e&&"configuration"in e}function s(e){return i(e)&&"editConfiguration"in e}function l(e){return i(e)&&"addTrackConf"in e&&!e.disableAddTracks}function c(e){return i(e)&&"shareURL"in e&&!!e.shareURL}function d(e){return i(e)&&"widgets"in e}function u(e){return i(e)&&"makeConnection"in e}function p(e){return i(e)&&"addConnectionConf"in e}function h(e){return i(e)&&"sessionPlugins"in e}function g(e){return"object"==typeof e&&null!==e&&"selection"in e&&"setSelection"in e}function m(e){return"object"==typeof e&&null!==e&&"width"in e&&"setWidth"in e}function f(e){return"object"==typeof e&&null!==e&&"configuration"in e&&e.configuration.trackId}function y(e){return"object"==typeof e&&null!==e&&"configuration"in e&&e.configuration.displayId}function b(e){return"object"==typeof e&&null!==e&&"showTrack"in e&&"hideTrack"in e}function w(e){return"object"==typeof e&&null!==e&&"findAppropriateInternetAccount"in e}function v(e){return"object"==typeof e&&null!==e&&"internetAccounts"in e&&"findAppropriateInternetAccount"in e}function S(e){return"object"==typeof e&&null!==e&&"appendMenu"in e&&"appendToSubMenu"in e}function k(e){return"object"==typeof e&&null!==e&&"uri"in e&&!!e.uri}function x(e){return"object"==typeof e&&null!==e&&"localPath"in e&&!!e.localPath}function C(e){return"object"==typeof e&&null!==e&&"blobId"in e&&!!e.blobId}class T extends Error{constructor(e,t){super(e),this.message=e,this.url=t,this.name="AuthNeededError",Object.setPrototypeOf(this,T.prototype)}}class A extends Error{constructor(e,t){super(e),this.message=e,this.internetAccountId=t,this.name="RetryError"}}function M(e){return e instanceof Error&&("AuthNeededError"===e.name||void 0!==e.url)}function P(e){return"RetryError"===e.name||void 0!==e.internetAccountId}},11163(e,t,n){n.d(t,{A:()=>b});var r=n(42918),a=n(87877),o=n(14665),i=n(10525),s=n(77251),l=n(70203),c=n(27868),d=n(99226),u=n(68560),p=n.n(u);function h(e){return(0,i.C1)(e)?e.uri:void 0}function g(e=""){try{return new URL(e),!1}catch{return!e.startsWith("/")}}const m={trackData:void 0,indexTrackData:void 0,altAssemblyName:"",altTrackName:"",altTrackType:"",adapterHint:"",textIndexTrack:!0,textIndexingConf:void 0,mixinData:{}};function f(e){return d.types.model("AddTrackModel",{id:c.K,type:d.types.literal("AddTrackWidget"),view:d.types.safeReference(e.pluggableMstType("view","stateModel"))}).volatile(()=>({...m})).actions(e=>({setMixinData(t){e.mixinData=t},setAdapterHint(t){e.adapterHint=t},setTextIndexingConf(t){e.textIndexingConf=t},setTextIndexTrack(t){e.textIndexTrack=t},setTrackData(t){e.trackData=t,e.adapterHint=""},setIndexTrackData(t){e.indexTrackData=t,e.adapterHint=""},setAssembly(t){e.altAssemblyName=t},setTrackName(t){e.altTrackName=t},setTrackType(t){e.altTrackType=t},clearData(){e.altTrackName=m.altTrackName,e.altTrackType=m.altTrackType,e.altAssemblyName=m.altAssemblyName,e.adapterHint=m.adapterHint,e.indexTrackData=m.indexTrackData,e.trackData=m.trackData,e.textIndexingConf=m.textIndexingConf,e.textIndexTrack=m.textIndexTrack,e.mixinData={}}})).views(e=>({get trackAdapter(){const{trackData:t,indexTrackData:n,adapterHint:r}=e;return t?(0,l.guessAdapter)(t,n,r,e):void 0},get trackName(){return e.altTrackName||(e.trackData?(0,l.getFileName)(e.trackData):"")},get isFtp(){const t=h(e.trackData),n=h(e.indexTrackData);return!(!n?.startsWith("ftp://")&&!t?.startsWith("ftp://"))},get isRelativeTrackUrl(){const t=h(e.trackData);return!!t&&g(t)},get isRelativeIndexUrl(){const t=h(e.indexTrackData);return!!t&&g(t)},get isRelativeUrl(){return this.isRelativeIndexUrl||this.isRelativeTrackUrl},get trackHttp(){return h(e.trackData)?.startsWith("http://")},get indexHttp(){return h(e.indexTrackData)?.startsWith("http://")},get wrongProtocol(){return"https:"===window.location.protocol&&(this.trackHttp||this.indexHttp)},get unsupported(){return this.trackAdapter?.type===l.UNSUPPORTED},get assembly(){return e.altAssemblyName||e.view?.assemblyNames?.[0]},get trackAdapterType(){return this.trackAdapter?.type},get trackType(){return e.altTrackType||(this.trackAdapterType?(0,l.guessTrackType)(this.trackAdapterType,e):"")}})).views(e=>({getTrackConfig(t){const n=(0,s.getSession)(e);return n.assemblyManager.get(e.assembly)&&e.trackAdapter&&"UNKNOWN"!==e.trackAdapter.type?p()({trackId:[`${e.trackName.toLowerCase().replaceAll(" ","_")}-${t}`,n.adminMode?"":"-sessionTrack"].join(""),type:e.trackType,name:e.trackName,assemblyNames:[e.assembly],adapter:e.trackAdapter},e.mixinData):void 0},get warningMessage(){return e.isFtp?"Warning: JBrowse cannot access files using the ftp protocol":e.isRelativeUrl?"Warning: one or more of your files do not provide the protocol e.g.\n          https://, please provide an absolute URL unless you are sure a\n          relative URL is intended.":e.wrongProtocol?"Warning: You entered a http:// resources but we cannot access HTTP\n          resources from JBrowse when it is running on https. Please use an\n          https URL for your track, or access the JBrowse app from the http\n          protocol":""}}))}const y=(0,a.S7)("AddTrackWidget",{});function b(e){e.addWidgetType(()=>new o.A({name:"AddTrackWidget",heading:"Add a track",configSchema:y,stateModel:f(e),ReactComponent:(0,r.lazy)(()=>Promise.all([n.e(6444),n.e(5720),n.e(4385)]).then(n.bind(n,84385)))}))}},11259(e,t,n){n.d(t,{C$:()=>l,FI:()=>i,JC:()=>s,QZ:()=>o,Rg:()=>p,oG:()=>c,wo:()=>u});var r=n(99226),a=n(47785);function o(e,t,n={}){if(!t)return(0,r.isStateTreeNode)(e)?structuredClone((0,r.getSnapshot)(e)):structuredClone(e);if("string"==typeof t){let a=e[t];if(!a&&((0,r.isStateTreeNode)(e)&&(0,r.isMapType)((0,r.getType)(e))&&(a=e.get(t)),!a))return;const o=function(e){return"function"==typeof e?.getValue}(a)?a.getValue(n):a;return null===o||"object"!=typeof o?o:(0,r.isStateTreeNode)(o)?structuredClone((0,r.getSnapshot)(o)):o}if(Array.isArray(t)){const a=t[0];if(t.length>1){const i=t.slice(1);let s=e[a];return!s&&(0,r.isStateTreeNode)(e)&&(0,r.isMapType)((0,r.getType)(e))&&(s=e.get(a)),s?o(s,i,n):void 0}return o(e,a,n)}throw new TypeError("slotPath must be a string or array")}function i(e,t,n){return o(e.configuration,t,n)}function s(e){if((0,r.isType)(e)&&(e=(0,a.resolveLateType)(e),(0,r.isUnionType)(e))){const t=[];for(let n of(0,a.getUnionSubTypes)(e)){n=(0,a.resolveLateType)(n);let e=s(n);if(e.length||(e=[(0,a.getDefaultValue)(n).type]),!e[0])throw new Error(`invalid config schema type ${n}`);t.push(...e)}return t}return[]}function l(e){if((0,r.isType)(e)){if((0,r.isModelType)(e)&&("isJBrowseConfigurationSchema"in e||e.name.includes("ConfigurationSchema")))return!0;if((0,r.isLateType)(e))return!0}return!1}function c(e){return!!(0,r.isType)(e)&&(!!l(e)||((0,r.isUnionType)(e)?(0,a.getUnionSubTypes)(e).every(e=>c(e)||"undefined"===e.name):!(!(0,r.isOptionalType)(e)||!c((0,a.getSubType)(e)))||!(!(0,r.isArrayType)(e)||!c((0,a.getSubType)(e)))||!(!(0,r.isMapType)(e)||!c((0,a.getSubType)(e)))))}const d=new WeakMap;function u(e){if(!e||"object"!=typeof e)return!1;let t=d.get(e);return void 0===t&&(t=(0,r.isStateTreeNode)(e)&&c((0,r.getType)(e)),d.set(e,t)),t}function p(e){return"object"==typeof e&&null!==e&&"isJBrowseConfigurationSlot"in e}},11550(e,t,n){n.d(t,{A:()=>a});var r=n(47578);function a(){const e=new r.kJ;return e.addFunction("get",(e,t)=>e.get(t)),e.addFunction("parent",e=>e.parent?.()),e.addFunction("id",e=>e.id()),e.addFunction("cast",e=>e),e.addFunction("log",e=>(console.log(e),e)),e.addFunction("max",Math.max),e.addFunction("min",Math.min),e.addFunction("sqrt",Math.sqrt),e.addFunction("ceil",Math.ceil),e.addFunction("floor",Math.floor),e.addFunction("round",Math.round),e.addFunction("abs",Math.abs),e.addFunction("log10",Math.log10),e.addFunction("parseInt",Number.parseInt),e.addFunction("parseFloat",Number.parseFloat),e.addFunction("split",(e,t)=>e.split(t)),e.addFunction("join",(e,...t)=>[...t].filter(e=>!!e).join(e)),e.addFunction("charAt",(e,t)=>e.charAt(t)),e.addFunction("charCodeAt",(e,t)=>e.charCodeAt(t)),e.addFunction("codePointAt",(e,t)=>e.codePointAt(t)),e.addFunction("startsWith",(e,t,n)=>e.startsWith(t,n)),e.addFunction("endsWith",(e,t,n)=>e.endsWith(t,n)),e.addFunction("padEnd",(e,t,n)=>e.padEnd(t,n)),e.addFunction("padStart",(e,t,n)=>e.padStart(t,n)),e.addFunction("repeat",(e,t)=>e.repeat(t)),e.addFunction("replace",(e,t,n)=>e.replace(t,n)),e.addFunction("replaceAll",(e,t,n)=>e.replaceAll(t,n)),e.addFunction("slice",(e,t,n)=>e.slice(t,n)),e.addFunction("startsWith",(e,t,n)=>e.startsWith(t,n)),e.addFunction("substring",(e,t,n)=>e.substring(t,n)),e.addFunction("toLowerCase",e=>e.toLowerCase()),e.addFunction("toUpperCase",e=>e.toUpperCase()),e.addFunction("jsonParse",e=>JSON.parse(e)),e.addFunction("trim",e=>e.trim()),e.addFunction("trimEnd",e=>e.trimEnd()),e.addFunction("trimStart",e=>e.trimStart()),e.addFunction("getTag",(e,t)=>{const n=e.get("tags");return n?n[t]:e.get(t)}),e.addBinaryOp("&",15,(e,t)=>e&t),e}},12197(e,t,n){n.d(t,{y:()=>r});const r=(0,n(87877).S7)("InternetAccount",{name:{description:"descriptive name of the internet account",type:"string",defaultValue:""},description:{description:"a description of the internet account",type:"string",defaultValue:""},authHeader:{description:"request header for credentials",type:"string",defaultValue:"Authorization"},tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:""},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:[]}},{explicitIdentifier:"internetAccountId",explicitlyTyped:!0})},12485(e,t,n){n.r(t),n.d(t,{default:()=>Re});var r=n(42918),a=n(87574),o=n(64074),i=n(1821),s=n(77251),l=n(65045),c=n(58955),d=n(27351),u=n(28397),p=n(90975),h=n(51800),g=n(99226),m=n(30936),f=n(1818),y=n(38157),b=n(32118);const w=(0,l.n)()(e=>({verticalGuidesZoomContainer:{position:"absolute",top:0,height:"100%",width:"100%",pointerEvents:"none"},verticalGuidesContainer:{position:"absolute",height:"100%",pointerEvents:"none",display:"flex"},tick:{position:"absolute",height:"100%",width:1},majorTick:{background:e.palette.action.disabled},minorTick:{background:e.palette.divider}}));function v(e){const t=(0,m.c)(22),{block:n,bpPerPx:r}=e,{classes:a}=w(),{start:o,end:i,reversed:s}=n;let l,c,d,u;if(t[0]!==n||t[1]!==r||t[2]!==a.majorTick||t[3]!==a.minorTick||t[4]!==a.tick||t[5]!==i||t[6]!==s||t[7]!==o){const e=(0,y.H2)(o,i,r),u=`${a.tick} ${a.majorTick}`,p=`${a.tick} ${a.minorTick}`;let h;l=f.$G,c=n,t[11]!==r||t[12]!==i||t[13]!==u||t[14]!==p||t[15]!==s||t[16]!==o?(h=e=>{const{type:t,base:n}=e,a=(s?i-n:n-o)/r;return(0,b.jsx)("div",{className:"major"===t||"labeledMajor"===t?u:p,style:{left:a}},n)},t[11]=r,t[12]=i,t[13]=u,t[14]=p,t[15]=s,t[16]=o,t[17]=h):h=t[17],d=e.map(h),t[0]=n,t[1]=r,t[2]=a.majorTick,t[3]=a.minorTick,t[4]=a.tick,t[5]=i,t[6]=s,t[7]=o,t[8]=l,t[9]=c,t[10]=d}else l=t[8],c=t[9],d=t[10];return t[18]!==l||t[19]!==c||t[20]!==d?(u=(0,b.jsx)(l,{block:c,children:d}),t[18]=l,t[19]=c,t[20]=d,t[21]=u):u=t[21],u}const S=(0,o.observer)(function({model:e}){const{staticBlocks:t,bpPerPx:n}=e;return(0,b.jsx)(b.Fragment,{children:t.map((e,t)=>{const r=`${e.key}-${t}`;return"ContentBlock"===e.type?(0,b.jsx)(v,{block:e,bpPerPx:n},r):"ElidedBlock"===e.type?(0,b.jsx)(f.Db,{width:e.widthPx},r):"InterRegionPaddingBlock"===e.type?(0,b.jsx)(f.fK,{width:e.widthPx,boundary:"boundary"===e.variant},r):null})})}),k=(0,o.observer)(function({model:e,offset:t=0}){const{classes:n}=w(),{staticBlocks:r,scaleFactor:a}=e;return(0,b.jsx)("div",{className:n.verticalGuidesZoomContainer,style:{transform:1!==a?`scaleX(${a})`:void 0},children:(0,b.jsx)("div",{className:n.verticalGuidesContainer,style:{left:`calc(${r.offsetPx}px - var(--offset-px) - ${t}px)`,width:r.totalWidthPx},children:(0,b.jsx)(S,{model:e})})})});var x=n(50639),C=n(70203),T=n(6773),A=n(15943),M=n(74919),P=n(1591),I=n(93874);const R=(0,l.n)()({dragHandle:{cursor:"grab"},dragHandleIcon:{display:"inline-block",verticalAlign:"middle",pointerEvents:"none"}}),L=function(e){const t=(0,m.c)(13),{trackId:n,view:r,track:a}=e,{classes:o}=R();let i,s;t[0]!==a||t[1]!==r?(i=e=>{const t=e.currentTarget;if(t.parentNode){const n=t.parentNode;e.dataTransfer.setDragImage(n,20,20),r.setDraggingTrackId(a.id)}},t[0]=a,t[1]=r,t[2]=i):i=t[2],t[3]!==r?(s=()=>{r.setDraggingTrackId(void 0)},t[3]=r,t[4]=s):s=t[4];const l=`dragHandle-${r.id}-${n}`;let c,d;return t[5]!==o.dragHandleIcon?(c=(0,b.jsx)(I.A,{className:o.dragHandleIcon,fontSize:"small"}),t[5]=o.dragHandleIcon,t[6]=c):c=t[6],t[7]!==o.dragHandle||t[8]!==i||t[9]!==s||t[10]!==l||t[11]!==c?(d=(0,b.jsx)("span",{draggable:!0,className:o.dragHandle,onDragStart:i,onDragEnd:s,"data-testid":l,children:c}),t[7]=o.dragHandle,t[8]=i,t[9]=s,t[10]=l,t[11]=c,t[12]=d):d=t[12],d};var F=n(35913),D=n(87134),N=n(65595),B=n(37918),E=n(64740),V=n(60785),z=n(86059),j=n(91073),H=n(21267),_=n(34014);const O=(0,o.observer)(function({track:e}){const t=(0,s.getContainingView)(e),n=(0,s.getSession)(e),a=(0,r.useCallback)(()=>{const r=e.configuration,a=e.minimized,o=e.pinned,{isTopLevelView:i}=t,s=e.trackMenuItems(),l=s.find(e=>"label"in e&&"Save track data"===e.label),c=s.filter(e=>!("label"in e)||"Save track data"!==e.label),d=n.getTrackActionMenuItems?.(r,l?[l]:[])||[];return[{label:"Track order",icon:z.A,type:"subMenu",priority:1e3,subMenu:[...i?[{label:o?"Unpin track":"Pin track",icon:_.A,onClick:()=>{e.setPinned(!o)}}]:[],{label:a?"Restore track":"Minimize track",icon:a?D.A:j.A,onClick:()=>{e.setMinimized(!a)}},...t.tracks.length>2?[{label:"Move track to top",icon:V.A,onClick:()=>{t.moveTrackToTop(e.id)}}]:[],...t.tracks.length>1?[{label:"Move track up",icon:B.A,onClick:()=>{t.moveTrackUp(e.id)}},{label:"Move track down",icon:N.A,onClick:()=>{t.moveTrackDown(e.id)}}]:[],...t.tracks.length>2?[{label:"Move track to bottom",icon:E.A,onClick:()=>{t.moveTrackToBottom(e.id)}}]:[]]},...d,...c].sort((e,t)=>(t.priority||0)-(e.priority||0))},[e,t,n]);return(0,b.jsx)(F.A,{menuItems:a,"data-testid":"track_menu_icon",children:(0,b.jsx)(H.A,{fontSize:"small"})})}),$=(0,l.n)()(e=>({root:{zIndex:200,background:(0,A.X4)(e.palette.background.paper,.8),"&:hover":{background:e.palette.background.paper}},trackName:{margin:"0 auto",width:"90%",fontSize:"0.8rem",pointerEvents:"none"},iconButton:{padding:e.spacing(1)}})),G=(0,o.observer)(function({track:e,className:t}){const{classes:n}=$(),r=(0,s.getContainingView)(e),a=(0,s.getSession)(e),{minimized:o}=e,i=e.trackId,l=(0,C.getTrackName)(e.configuration,a);return(0,b.jsxs)(c.A,{className:(0,h.cx)(t,n.root),onClick:e=>{e.stopPropagation()},children:[(0,b.jsx)(L,{track:e,trackId:i,view:r}),(0,b.jsx)(M.A,{onClick:()=>r.hideTrack(i),className:n.iconButton,title:"close this track",children:(0,b.jsx)(T.A,{fontSize:"small"})}),(0,b.jsx)(P.A,{variant:"body1",component:"span",className:n.trackName,children:(0,b.jsx)(x.A,{html:[l,o?"(minimized)":""].filter(e=>!!e).join(" ")})}),(0,b.jsx)(O,{track:e})]})}),W=(0,l.n)()({trackLabel:{zIndex:2},trackLabelOffset:{position:"relative",display:"inline-block"},trackLabelOverlap:{position:"absolute"}}),U=(0,o.observer)(function({track:e,view:t}){const{classes:n}=W(),r=e.displays[0],a="overlapping"!==t.trackLabelsSetting||r.prefersOffset?n.trackLabelOffset:n.trackLabelOverlap;return"hidden"!==t.trackLabelsSetting?(0,b.jsx)(G,{track:e,className:(0,h.cx)(n.trackLabel,a)}):null}),q=(0,l.n)()({renderingComponentContainer:{position:"absolute",left:-1,height:"100%",width:"100%"},trackRenderingContainer:{overflowY:"auto",overflowX:"hidden",whiteSpace:"nowrap",position:"relative",background:"none",contain:"strict"}}),J=(0,o.observer)(function({model:e,track:t}){const{classes:n}=q(),o=t.displays[0],{height:i,RenderingComponent:s,DisplayBlurb:l}=o,{trackRefs:c,id:d,scaleFactor:u}=e,p=t.trackId,h=(0,r.useRef)(null),g=t.minimized;return(0,r.useEffect)(()=>(h.current&&(c[p]=h.current),()=>{delete c[p]}),[c,p]),(0,b.jsx)("div",{className:n.trackRenderingContainer,style:{height:g?20:i},onScroll:e=>o.setScrollTop(e.currentTarget.scrollTop),"data-testid":`trackRenderingContainer-${d}-${p}`,children:g?null:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{ref:h,className:n.renderingComponentContainer,style:{transform:1!==u?`scaleX(${u})`:void 0},children:(0,b.jsx)(r.Suspense,{fallback:(0,b.jsx)(a.A,{}),children:(0,b.jsx)(s,{model:o,onHorizontalScroll:e.horizontalScroll})})}),l?(0,b.jsx)("div",{style:{position:"absolute",left:0,top:o.height-20},children:(0,b.jsx)(l,{model:o})}):null]})})});var X=n(97892);const K=(0,l.n)()(e=>({root:{marginTop:2,overflow:"hidden",position:"relative",contain:"layout style paint"},unpinnedTrack:{background:"none"},resizeHandle:{height:4,boxSizing:"border-box",position:"relative",background:"transparent","&:hover":{background:e.palette.divider}}})),Q=(0,o.observer)(function({model:e,track:t}){const{classes:n}=K(),a=t.displays[0],{draggingTrackId:o,showTrackOutlines:i}=e,s=(0,r.useRef)(null);return(0,b.jsxs)(c.A,{ref:s,className:(0,h.cx)(n.root,t.pinned?null:n.unpinnedTrack),variant:i?"outlined":void 0,elevation:i?void 0:0,onClick:t=>{if(2===t.detail&&!a.featureIdUnderMouse){const n=s.current?.getBoundingClientRect().left||0;e.zoomTo(e.bpPerPx/2,t.clientX-n,!0)}},onDragOver:n=>{if((0,g.isAlive)(a)&&void 0!==o&&o!==a.id){const r=e.tracks.findIndex(e=>e.id===o),a=e.tracks.findIndex(e=>e.id===t.id)>r,i=n.clientY;(0,X.D7)(e.lastTrackDragY,i,a)&&(e.setLastTrackDragY(i),e.moveTrack(o,t.id))}},children:[t.pinned?(0,b.jsx)(k,{model:e,offset:1}):null,(0,b.jsx)(U,{track:t,view:e}),(0,b.jsx)(p.t,{FallbackComponent:e=>(0,b.jsx)(d.A,{error:e.error}),children:(0,b.jsx)(J,{model:e,track:t})}),(0,b.jsx)(u.A,{onDrag:a.resizeHeight,className:n.resizeHandle})]})});var Y=n(14391),Z=n(28788),ee=n(27607);const te=(0,l.n)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",left:0,background:"red",zIndex:1001},tooltipTarget:{position:"sticky",left:0,width:1}}),ne=(0,o.observer)(function({model:e,coordX:t}){const{classes:n}=te(),{stickyViewHeaders:r,rubberbandTop:a}=e;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(ee.A,{open:!0,placement:"top",title:(0,s.stringify)(e.pxToBp(t)),arrow:!0,children:(0,b.jsx)("div",{className:n.tooltipTarget,style:{transform:`translateX(${t+6}px)`,top:a,position:r?"sticky":void 0}})}),(0,b.jsx)("div",{className:n.guide,style:{transform:`translateX(${t}px)`}})]})});function re(e,t,n){const a=(0,m.c)(54),[o,i]=(0,r.useState)(),[s,l]=(0,r.useState)(),[c,d]=(0,r.useState)(),[u,p]=(0,r.useState)(),h=void 0!==o&&void 0===c;let g;a[0]===Symbol.for("react.memo_cache_sentinel")?(g=()=>{d(void 0),i(void 0),l(void 0),p(void 0)},a[0]=g):g=a[0];const f=g;let y,b,w;a[1]!==t||a[2]!==h||a[3]!==e||a[4]!==o?(y=()=>{const n=function(t){if(e.current&&h){const n=(0,X.Pn)(t,e.current);l(n)}},r=function(n){if(void 0!==o&&e.current){const{clientX:r,clientY:a}=n,s=(0,X.Pn)(n,e.current),c=Math.abs(s-o)<=3;if(c&&t.scalebarRefNameClickPending)return i(void 0),void l(void 0);if(!c&&t.scalebarRefNameClickPending&&t.setScalebarRefNameClickPending(!1),d({offsetX:s,clientX:r,clientY:a,isClick:c}),c)p(s);else{const e=function(e){if(void 0===o)return;const n=Math.min(o,e),r=Math.max(o,e);return{leftOffset:t.pxToBp(n),rightOffset:t.pxToBp(r)}}(s);e&&t.setOffsets(e.leftOffset,e.rightOffset),p(void 0)}}};return h?(window.addEventListener("mousemove",n),window.addEventListener("mouseup",r),()=>{window.removeEventListener("mousemove",n),window.removeEventListener("mouseup",r)}):ae},b=[o,h,t,e,f],a[1]=t,a[2]=h,a[3]=e,a[4]=o,a[5]=y,a[6]=b):(y=a[5],b=a[6]),(0,r.useEffect)(y,b),a[7]!==t||a[8]!==e||a[9]!==n?(w=function(r){if(n&&!r.shiftKey)return;if(t.isScalebarRefNameMenuOpen)return;r.preventDefault(),r.stopPropagation();const a=(0,X.Pn)(r,e.current);i(a),l(a)},a[7]=t,a[8]=e,a[9]=n,a[10]=w):w=a[10];const v=w;let S;a[11]!==c?.isClick||a[12]!==h||a[13]!==e||a[14]!==n?(S=function(t){!1!==c?.isClick&&(h?p(void 0):n?t.shiftKey?p((0,X.Pn)(t,e.current)):p(void 0):p((0,X.Pn)(t,e.current)))},a[11]=c?.isClick,a[12]=h,a[13]=e,a[14]=n,a[15]=S):S=a[15];const k=S;let x;a[16]!==c?.isClick?(x=function(){c?.isClick||p(void 0)},a[16]=c?.isClick,a[17]=x):x=a[17];const C=x;let T;a[18]===Symbol.for("react.memo_cache_sentinel")?(T=function(e,t){t(),f()},a[18]=T):T=a[18];const A=T,M=Boolean(c),P=c?.isClick;let I;a[19]!==c||a[20]!==P||a[21]!==t?(I=P?t.pxToBp(c.offsetX):void 0,a[19]=c,a[20]=P,a[21]=t,a[22]=I):I=a[22];const R=I;if(void 0===o){let e;return a[23]!==c||a[24]!==R||a[25]!==u||a[26]!==P||a[27]!==v||a[28]!==k||a[29]!==C||a[30]!==M?(e={open:M,isClick:P,clickBpOffset:R,guideX:u,mouseDown:v,mouseMove:k,mouseOut:C,handleClose:f,handleMenuItemClick:A,anchorPosition:c},a[23]=c,a[24]=R,a[25]=u,a[26]=P,a[27]=v,a[28]=k,a[29]=C,a[30]=M,a[31]=e):e=a[31],e}const L=c?c.offsetX:s||0,F=Math.min(L,o),D=Math.abs(L-o);let N;a[32]!==F||a[33]!==t?(N=t.pxToBp(F),a[32]=F,a[33]=t,a[34]=N):N=a[34];const B=N;let E;a[35]!==F||a[36]!==t||a[37]!==D?(E=t.pxToBp(F+D),a[35]=F,a[36]=t,a[37]=D,a[38]=E):E=a[38];const V=E,z=Math.ceil(D*t.bpPerPx),j=!P;let H;return a[39]!==c||a[40]!==R||a[41]!==u||a[42]!==P||a[43]!==F||a[44]!==B||a[45]!==v||a[46]!==k||a[47]!==C||a[48]!==z||a[49]!==M||a[50]!==V||a[51]!==j||a[52]!==D?(H={open:M,isClick:P,clickBpOffset:R,guideX:u,rubberbandOn:j,mouseDown:v,mouseMove:k,mouseOut:C,handleClose:f,handleMenuItemClick:A,leftBpOffset:B,rightBpOffset:V,anchorPosition:c,numOfBpSelected:z,width:D,left:F},a[39]=c,a[40]=R,a[41]=u,a[42]=P,a[43]=F,a[44]=B,a[45]=v,a[46]=k,a[47]=C,a[48]=z,a[49]=M,a[50]=V,a[51]=j,a[52]=D,a[53]=H):H=a[53],H}function ae(){}const oe=(0,l.n)()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8,zIndex:825}}),ie=(0,o.observer)(function({model:e,ControlComponent:t=(0,b.jsx)("div",{})}){const n=(0,r.useRef)(null),{classes:a}=oe(),{stickyViewHeaders:o,rubberbandTop:i,isScalebarRefNameMenuOpen:s}=e,{guideX:l,rubberbandOn:c,leftBpOffset:d,rightBpOffset:u,numOfBpSelected:p,width:h,left:g,anchorPosition:m,open:f,isClick:y,clickBpOffset:w,handleMenuItemClick:v,handleClose:S,mouseMove:k,mouseDown:x,mouseOut:C}=re(n,e);return(0,b.jsxs)(b.Fragment,{children:[void 0===l||s?c?(0,b.jsx)(Z.default,{leftBpOffset:d,rightBpOffset:u,numOfBpSelected:p,width:h,left:g,top:i,sticky:o}):null:(0,b.jsx)(ne,{model:e,coordX:l}),m?(0,b.jsx)(Y.A,{anchorReference:"anchorPosition",anchorPosition:{left:m.clientX+10,top:m.clientY},onMenuItemClick:v,open:f,onClose:S,menuItems:y&&w?e.rubberbandClickMenuItems(w):e.rubberBandMenuItems()}):null,(0,b.jsx)("div",{"data-testid":"rubberband_controls",className:a.rubberbandControl,style:{top:i,position:o?"sticky":void 0},ref:n,onMouseDown:x,onMouseMove:k,onMouseOut:C,children:t})]})}),se=(0,l.n)()(e=>({block:{position:"relative",flexShrink:0,overflow:"hidden",height:13},elidedBlock:{backgroundColor:"#999",backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)"},tick:{position:"absolute",width:0,display:"flex",justifyContent:"center",pointerEvents:"none"},label:{fontSize:11,zIndex:1,background:e.palette.background.paper,lineHeight:"normal",pointerEvents:"none"}}));function le(e){const t=(0,m.c)(18),{block:n,bpPerPx:r}=e,{classes:a}=se();let o;if(t[0]!==n.end||t[1]!==n.reversed||t[2]!==n.start||t[3]!==n.widthPx||t[4]!==r||t[5]!==a.block||t[6]!==a.label||t[7]!==a.tick){const e=(0,y.H2)(n.start,n.end,r,!0,!1);let i,l;t[9]!==n.widthPx?(i={width:n.widthPx},t[9]=n.widthPx,t[10]=i):i=t[10],t[11]!==n.end||t[12]!==n.reversed||t[13]!==n.start||t[14]!==r||t[15]!==a.label||t[16]!==a.tick?(l=e=>{const{type:t,base:o}=e;if("major"!==t)return null;const i=(n.reversed?n.end-o:o-n.start)/r;return(0,b.jsx)("div",{className:a.tick,style:{left:i},children:(0,b.jsx)("div",{className:a.label,children:(0,s.getTickDisplayStr)(o+1,r)})},o)},t[11]=n.end,t[12]=n.reversed,t[13]=n.start,t[14]=r,t[15]=a.label,t[16]=a.tick,t[17]=l):l=t[17],o=(0,b.jsx)("div",{className:a.block,style:i,children:e.map(l)}),t[0]=n.end,t[1]=n.reversed,t[2]=n.start,t[3]=n.widthPx,t[4]=r,t[5]=a.block,t[6]=a.label,t[7]=a.tick,t[8]=o}else o=t[8];return o}const ce=(0,o.observer)(function({model:e}){const{classes:t,cx:n}=se(),{staticBlocks:r,bpPerPx:a}=e;return(0,b.jsx)("div",{style:{display:"flex"},children:r.map((e,r)=>{const o=`${e.key}-${r}`;return"ContentBlock"===e.type?(0,b.jsx)(le,{block:e,bpPerPx:a},o):"ElidedBlock"===e.type?(0,b.jsx)("div",{className:n(t.block,t.elidedBlock),style:{width:e.widthPx}},o):(0,b.jsx)("div",{className:t.block,style:{width:e.widthPx}},o)})})}),de=(0,l.n)()(e=>({refLabel:{fontSize:11,position:"absolute",left:2,top:-1,fontWeight:"bold",lineHeight:"normal",zIndex:1,background:e.palette.background.paper,cursor:"pointer",overflow:"hidden",whiteSpace:"nowrap","&:hover":{background:e.palette.grey[300]}},b0:{left:0,zIndex:100}}));function ue(e){const t=(0,m.c)(43),{model:n,menuState:r,onClose:a}=e,{displayedRegions:o}=n,{refName:i,regionNumber:s}=r,l=o.length;let c;t[0]!==o||t[1]!==n?(c=function(e,t){const r=[...o],[a]=r.splice(e,1);r.splice(t,0,a),n.setDisplayedRegions(r)},t[0]=o,t[1]=n,t[2]=c):c=t[2];const d=c;let u;t[3]!==o||t[4]!==n?(u=function(e){const t=o.filter((t,n)=>n!==e);n.setDisplayedRegions(t)},t[3]=o,t[4]=n,t[5]=u):u=t[5];const p=u;let h,g,f,y,w,v;t[6]!==d||t[7]!==s?(h=s>0?[{label:"Move left",onClick:()=>{d(s,s-1)}}]:[],t[6]=d,t[7]=s,t[8]=h):h=t[8],t[9]!==d||t[10]!==l||t[11]!==s?(g=s<l-1?[{label:"Move right",onClick:()=>{d(s,s+1)}}]:[],f=l>2&&s>0?[{label:"Move to far left",onClick:()=>{d(s,0)}}]:[],y=l>2&&s<l-1?[{label:"Move to far right",onClick:()=>{d(s,l-1)}}]:[],t[9]=d,t[10]=l,t[11]=s,t[12]=g,t[13]=f,t[14]=y):(g=t[12],f=t[13],y=t[14]),t[15]!==s||t[16]!==p?(w={label:"Remove this region from view",onClick:()=>{p(s)}},t[15]=s,t[16]=p,t[17]=w):w=t[17],t[18]!==h||t[19]!==g||t[20]!==f||t[21]!==y||t[22]!==w?(v=[...h,...g,...f,...y,w],t[18]=h,t[19]=g,t[20]=f,t[21]=y,t[22]=w,t[23]=v):v=t[23];const S=v;let k;t[24]!==a?(k=(e,t)=>{t(),a()},t[24]=a,t[25]=k):k=t[25];const x=`Focus on ${i}`;let C,T,A,M,P;return t[26]!==n||t[27]!==i?(C=()=>{n.navTo({refName:i})},t[26]=n,t[27]=i,t[28]=C):C=t[28],t[29]!==x||t[30]!==C?(T={label:x,onClick:C},t[29]=x,t[30]=C,t[31]=T):T=t[31],t[32]!==S||t[33]!==l?(A=l>1?[{label:"Actions",subMenu:S}]:[],t[32]=S,t[33]=l,t[34]=A):A=t[34],t[35]!==T||t[36]!==A?(M=[T,...A],t[35]=T,t[36]=A,t[37]=M):M=t[37],t[38]!==r.anchorEl||t[39]!==a||t[40]!==M||t[41]!==k?(P=(0,b.jsx)(Y.A,{anchorEl:r.anchorEl,open:!0,onClose:a,onMenuItemClick:k,menuItems:M}),t[38]=r.anchorEl,t[39]=a,t[40]=M,t[41]=k,t[42]=P):P=t[42],P}const pe=(0,o.observer)(function({model:e}){const{classes:t,cx:n}=de(),{staticBlocks:a,offsetPx:o,scalebarDisplayPrefix:i}=e,[s,l]=(0,r.useState)();(0,r.useEffect)(()=>{e.setIsScalebarRefNameMenuOpen(!!s)},[e,s]);let c=a.blocks.findIndex(e=>"ContentBlock"===e.type);c<0&&(c=0),a.forEach((e,t)=>{"ContentBlock"===e.type&&e.offsetPx-o<0&&(c=t)});const d=i(),u=a.blocks[0],p=new Map;for(const e of a.blocks)if("ContentBlock"===e.type&&void 0!==e.regionNumber){const t=e.offsetPx+e.widthPx,n=p.get(e.regionNumber);(void 0===n||t>n)&&p.set(e.regionNumber,t)}return(0,b.jsxs)(b.Fragment,{children:["ContentBlock"!==u?.type&&d?(0,b.jsx)("span",{className:n(t.b0,t.refLabel),children:d}):null,a.map((n,r)=>{const{offsetPx:a,isLeftEndOfDisplayedRegion:i,key:s,type:u,refName:h,regionNumber:g}=n,m=r===c,f=void 0!==g?p.get(g):void 0,y=void 0!==f?f-(m?o:a)-2:void 0;return"ContentBlock"===u&&(i||m)&&(void 0===y||y>=20)?(0,b.jsxs)("span",{style:{left:m?"max(0px, calc(-1 * var(--offset-px)))":`calc(${a}px - var(--offset-px) - 1px)`,paddingLeft:m?0:1,maxWidth:void 0!==y&&y>0?y:void 0},className:t.refLabel,"data-testid":`refLabel-${h}`,onMouseDown:()=>{e.setScalebarRefNameClickPending(!0)},onClick:t=>{e.setScalebarRefNameClickPending(!1),l({anchorEl:t.currentTarget,refName:h,regionNumber:g})},children:[m&&d?`${d}:`:"",h]},`refLabel-${s}-${r}`):null}),s?(0,b.jsx)(ue,{model:e,menuState:s,onClose:()=>{l(void 0)}}):null]})}),he=(0,l.n)()({container:{overflow:"hidden",position:"relative"},zoomContainer:{position:"relative"},scalebar:{position:"absolute",display:"flex",pointerEvents:"none"}}),ge=(0,o.observer)(function({model:e,style:t,className:n,...r}){const{classes:a}=he(),{scaleFactor:o,staticBlocks:i,offsetPx:s}=e;return(0,b.jsxs)(c.A,{"data-resizer":"true",className:(0,h.cx)(a.container,n),variant:"outlined",style:{...t,"--offset-px":`${s}px`},...r,children:[(0,b.jsx)(k,{model:e,offset:1}),(0,b.jsx)("div",{className:a.zoomContainer,style:{transform:1!==o?`scaleX(${o})`:void 0},children:(0,b.jsx)("div",{className:a.scalebar,style:{transform:`translateX(calc(${i.offsetPx}px - var(--offset-px) - 1px))`,width:i.totalWidthPx},children:(0,b.jsx)(ce,{model:e})})}),(0,b.jsx)(pe,{model:e})]})});var me=n(56097);function fe(){}function ye(){}const be=(0,r.lazy)(()=>n.e(5889).then(n.bind(n,35889))),we=(0,r.lazy)(()=>n.e(6337).then(n.bind(n,78718))),ve=(0,r.lazy)(()=>Promise.resolve().then(n.bind(n,28788))),Se=(0,l.n)()({tracksContainer:{position:"relative",contain:"layout style"}}),ke=(0,o.observer)(function({children:e,model:t}){const{classes:n}=Se(),{pluginManager:a}=(0,s.getEnv)(t),{mouseDown:o,mouseUp:i}=function(e){const t=(0,m.c)(6),[n,a]=(0,r.useState)(!1),o=(0,r.useRef)(!1),i=(0,r.useRef)(0);let s,l,c;t[0]!==e||t[1]!==n?(s=()=>{let t=fe;const r=function(t){t.preventDefault();const n=t.clientX-i.current;n&&(o.current||(o.current=!0,window.requestAnimationFrame(()=>{e.horizontalScroll(-n),o.current=!1,i.current=t.clientX})))},s=function(){i.current=0,n&&a(!1)};return n&&(window.addEventListener("mousemove",r,!0),window.addEventListener("mouseup",s,!0),t=()=>{window.removeEventListener("mousemove",r,!0),window.removeEventListener("mouseup",s,!0)}),t},l=[e,n],t[0]=e,t[1]=n,t[2]=s,t[3]=l):(s=t[2],l=t[3]),(0,r.useEffect)(s,l),t[4]===Symbol.for("react.memo_cache_sentinel")?(c=function(e){if(e.shiftKey)return;const t=e.target;t.draggable||t.dataset.resizer||0===e.button&&(i.current=e.clientX,a(!0))},t[4]=c):c=t[4];const d=c;let u;return t[5]===Symbol.for("react.memo_cache_sentinel")?(u={mouseDown:d,mouseUp:function(e){e.preventDefault(),a(!1)}},t[5]=u):u=t[5],u}(t),{stickyViewHeaders:l,rubberbandTop:c,showGridlines:d,showCenterLine:u,isScalebarRefNameMenuOpen:p}=t,h=(0,r.useRef)(null),{guideX:g,rubberbandOn:f,leftBpOffset:y,rightBpOffset:w,numOfBpSelected:v,width:S,left:x,anchorPosition:C,open:T,isClick:A,clickBpOffset:M,handleMenuItemClick:P,handleClose:I,mouseMove:R,mouseDown:L}=re(h,t,!0);!function(e,t){const n=(0,m.c)(4),a=(0,r.useRef)(0),o=(0,r.useRef)(0),i=(0,r.useRef)(null),l=(0,r.useRef)(0),c=(0,r.useRef)(!1);let d,u;n[0]!==t||n[1]!==e?(d=()=>{let n=[];const r=e.current,d=function(e){if(e.ctrlKey){e.preventDefault(),n.push(e.deltaY);const o=Math.abs((0,s.sum)(n))/n.length,l=o<6?25:o>30?o>150?500:150:75;a.current=a.current+e.deltaY/l,t.setScaleFactor(a.current<0?1-a.current:1/(1+a.current)),i.current&&clearTimeout(i.current),i.current=setTimeout(()=>{t.setScaleFactor(1),t.zoomTo(a.current>0?t.bpPerPx*(1+a.current):t.bpPerPx/(1-a.current),e.clientX-(r?.getBoundingClientRect().left||0)),a.current=0,n=[]},300)}else Math.abs(e.deltaX)>Math.abs(2*e.deltaY)&&e.preventDefault(),o.current=o.current+e.deltaX,c.current||(c.current=!0,l.current=window.requestAnimationFrame(()=>{t.horizontalScroll(o.current),o.current=0,c.current=!1}))};return r?(r.addEventListener("wheel",d,{passive:!1}),()=>{r.removeEventListener("wheel",d),i.current&&clearTimeout(i.current),l.current&&cancelAnimationFrame(l.current)}):ye},u=[t,e],n[0]=t,n[1]=e,n[2]=d,n[3]=u):(d=n[2],u=n[3]),(0,r.useEffect)(d,u)}(h,t);const F=a.evaluateExtensionPoint("LinearGenomeView-TracksContainerComponent",void 0,{model:t});return(0,b.jsxs)("div",{ref:h,"data-testid":"tracksContainer",className:n.tracksContainer,style:{"--offset-px":`${t.offsetPx}px`},onMouseDown:e=>{o(e),L(e)},onMouseMove:R,onMouseUp:i,children:[d?(0,b.jsx)(k,{model:t}):null,(0,b.jsx)(r.Suspense,{fallback:null,children:u?(0,b.jsx)(be,{model:t}):null}),void 0===g||p?f?(0,b.jsx)(r.Suspense,{fallback:null,children:(0,b.jsx)(ve,{leftBpOffset:y,rightBpOffset:w,numOfBpSelected:v,width:S,left:x,top:c,sticky:l})}):null:(0,b.jsx)(ne,{model:t,coordX:g}),C?(0,b.jsx)(Y.A,{anchorReference:"anchorPosition",anchorPosition:{left:C.clientX,top:C.clientY},onMenuItemClick:P,open:T,onClose:I,menuItems:A&&M?t.rubberbandClickMenuItems(M):t.rubberBandMenuItems()}):null,(0,b.jsx)(ie,{model:t,ControlComponent:(0,b.jsx)(ge,{model:t,style:{height:me.jE,boxSizing:"border-box"}})}),(0,b.jsx)(xe,{model:t}),F,e]})}),xe=(0,o.observer)(function({model:e}){return e.highlight.length?(0,b.jsx)(r.Suspense,{fallback:null,children:e.highlight.map((t,n)=>(0,b.jsx)(we,{model:e,highlight:t},`${JSON.stringify(t)}-${n}`))}):null}),Ce=ke,Te=(0,r.lazy)(()=>n.e(7371).then(n.bind(n,37371))),Ae=(0,l.n)()(e=>({header:{background:e.palette.background.paper,top:i.VIEW_HEADER_HEIGHT,zIndex:850},pinnedTracks:{position:"sticky",zIndex:3},rel:{position:"relative"}})),Me=(0,o.observer)(function({model:e}){const{pinnedTracks:t,stickyViewHeaders:n,pinnedTracksTop:a,tracks:o,unpinnedTracks:i}=e,{classes:l}=Ae(),d=(0,s.getSession)(e),u=(0,r.useRef)(null),p=e.MiniControlsComponent(),h=e.HeaderComponent();return(0,r.useEffect)(()=>{function t(t){t.target instanceof Element&&u.current?.contains(t.target)&&d.setFocusedViewId?.(e.id)}return document.addEventListener("mousedown",t),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",t)}},[d,e]),(0,b.jsxs)("div",{className:l.rel,ref:u,onMouseLeave:()=>{d.setHovered(void 0)},onMouseMove:t=>{const n=u.current;if(!n)return;const{tracks:r}=e,a=t.clientX-n.getBoundingClientRect().left,o=e.pxToBp(a),i=r.find(e=>e.displays[0].featureUnderMouse);d.setHovered({hoverPosition:o,hoverFeature:i})},children:[(0,b.jsxs)("div",{className:l.header,style:{position:n?"sticky":void 0},children:[(0,b.jsx)(h,{model:e}),(0,b.jsx)(p,{model:e})]}),(0,b.jsx)(Ce,{model:e,children:o.length?(0,b.jsxs)(b.Fragment,{children:[t.length?(0,b.jsx)(c.A,{elevation:6,className:l.pinnedTracks,style:{top:a},children:t.map(t=>(0,b.jsx)(Q,{model:e,track:t},t.id))}):null,i.map(t=>(0,b.jsx)(Q,{model:e,track:t},t.id))]}):(0,b.jsx)(r.Suspense,{fallback:null,children:(0,b.jsx)(Te,{model:e})})})]})}),Pe=Me,Ie=(0,r.lazy)(()=>Promise.all([n.e(2913),n.e(5013)]).then(n.bind(n,65013))),Re=(0,o.observer)(function({model:e}){const{showLoading:t,showImportForm:n,loadingMessage:r}=e;return t?(0,b.jsx)(a.A,{variant:"h6",message:r}):n?(0,b.jsx)(Ie,{model:e}):(0,b.jsx)(Pe,{model:e})})},12644(e,t,n){n.d(t,{WD:()=>i,Yv:()=>l,qn:()=>s});var r=n(96852),a=n(14808);function o(e,t,n,r=!1){if(0===n)return 0;let a;return r?a=t/n-e*e/(n*n):(a=t-e*e/n,n>1&&(a/=n-1)),a<0?0:Math.sqrt(a)}function i(e){return{...e,scoreMean:(e.scoreSum||0)/(e.featureCount||e.basesCovered||1),scoreStdDev:o(e.scoreSum,e.scoreSumSquares,e.featureCount||e.basesCovered),featureDensity:(e.featureCount||1)/e.basesCovered}}async function s(e,t){const{start:n,end:o}=e,s={scoreMin:Number.MAX_VALUE,scoreMax:Number.MIN_VALUE,scoreSum:0,scoreSumSquares:0,featureCount:0};let l=!1;const{scoreMin:c,scoreMax:d,scoreSum:u,scoreSumSquares:p,featureCount:h}=await(0,r._)(t.pipe((0,a.T)((e,t)=>{const n=t.get("score"),r=t.get("summary"),{scoreMax:a,scoreMin:o}=e;return e.scoreMax=Math.max(a,r?t.get("maxScore"):n),e.scoreMin=Math.min(o,r?t.get("minScore"):n),e.scoreSum+=n,e.scoreSumSquares+=n*n,e.featureCount+=1,l=!0,e},s)));return l?i({scoreMax:d,scoreMin:c,scoreSum:u,scoreSumSquares:p,featureCount:h,basesCovered:o-n+1}):{scoreMin:0,scoreMax:0,scoreMean:0,scoreStdDev:0,scoreSum:0,scoreSumSquares:0,featureCount:0,featureDensity:0,basesCovered:0}}function l(){return{scoreMin:0,scoreMax:0,scoreMean:0,scoreStdDev:0,scoreSum:0,scoreSumSquares:0,featureCount:0,featureDensity:0,basesCovered:0}}},13861(e,t,n){n.d(t,{A:()=>r});const r=(0,n(87877).S7)("BaseConnection",{name:{type:"string",defaultValue:"nameOfConnection",description:"a unique name for this connection"},assemblyNames:{type:"stringArray",defaultValue:[],description:"optional list of names of assemblies in this connection"}},{explicitlyTyped:!0,explicitIdentifier:"connectionId"})},14050(e,t,n){n.d(t,{VY:()=>i,og:()=>o});var r=n(36790);function a(e,t,n){return(0,r.A)().base(2).domain([Math.max(1,e),Math.max(2,t)]).range([0,n-20]).clamp(!0)}function o(e,t){const[n,r]=e,o=a(n,r,t);return{ticks:o.ticks(6).map(e=>({value:e,y:o(e)})),height:t,minDistance:n,maxDistance:r}}function i(e,t,n){const r=new Map;if(n){const[,o]=n,i=a(1,o,t);for(const{id:t,distance:n}of e){const e=n>0?i(n):0;r.set(t,e)}return{chainYOffsets:r,cloudMaxDistance:o}}let o=Number.MIN_VALUE;for(const{distance:t}of e)t>0&&(o=Math.max(o,t));o===Number.MIN_VALUE&&(o=1e3);const i=a(1,o,t);for(const{id:t,distance:n}of e){const e=n>0?i(n):0;r.set(t,e)}return{chainYOffsets:r,cloudMaxDistance:o}}},14157(e,t,n){n.r(t),n.d(t,{category10:()=>r,dark2:()=>a,ggplot2Colors3:()=>u,ggplot2Colors4:()=>d,ggplot2Colors5:()=>c,ggplot2Colors6:()=>l,set1:()=>o,set2:()=>i,tableau10:()=>s});const r=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],a=["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],o=["#377eb8","#e41a1c","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],i=["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],s=["#4e79a7","#f28e2c","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab"],l=["#F8766D","#B79F00","#00BA38","#00BFC4","#619CFF","#F564E3"],c=["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],d=["#F8766D","#7CAE00","#00BFC4","#C77CFF"],u=["#F8766D","#00BA38","#619CFF"]},14227(e,t,n){function r(e){let t="",n=!1;for(let r=0,a=e.length;r<a;r++){const a=e[r];"<"===a?n=!0:">"===a?n=!1:n||(t+=a)}return t}n.d(t,{Z:()=>r})},14261(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.stateModel=e.stateModel,this.configSchema=e.configSchema,this.description=e.description,this.url=e.url,this.configEditorComponent=e.configEditorComponent}}},14391(e,t,n){n.d(t,{A:()=>B});var r=n(30936),a=n(42918),o=n(49754),i=n(44153),s=n(94185),l=n(9625),c=n(29023),d=n(28919),u=n(75695),p=n(13162),h=n(74919),g=n(24215),m=n(85787),f=n(32118);function y(e){const t=(0,r.c)(8),{onClose:n,helpText:a,label:o}=e;let i,s,l;return t[0]!==o?(i=o?(0,f.jsxs)(f.Fragment,{children:["Help: ",o]}):void 0,t[0]=o,t[1]=i):i=t[1],t[2]!==a?(s=(0,f.jsx)(g.A,{children:a}),t[2]=a,t[3]=s):s=t[3],t[4]!==n||t[5]!==i||t[6]!==s?(l=(0,f.jsx)(m.A,{open:!0,onClose:n,title:"Help",titleNode:i,onClick:w,onMouseDown:b,children:s}),t[4]=n,t[5]=i,t[6]=s,t[7]=l):l=t[7],l}function b(e){e.stopPropagation()}function w(e){e.stopPropagation()}function v(e){const t=(0,r.c)(7),{helpText:n,label:o}=e,[i,s]=(0,a.useState)(!1);let l,c,d;return t[0]===Symbol.for("react.memo_cache_sentinel")?(l=(0,f.jsx)(h.A,{size:"small",onClick:e=>{e.stopPropagation(),s(!0)},style:{marginLeft:4,padding:4},children:(0,f.jsx)(p.A,{fontSize:"small"})}),t[0]=l):l=t[0],t[1]!==i||t[2]!==n||t[3]!==o?(c=i?(0,f.jsxs)(a.Suspense,{fallback:null,children:[(0,f.jsx)(y,{helpText:n,label:o,onClose:e=>{e.stopPropagation(),s(!1)}})," "]}):null,t[1]=i,t[2]=n,t[3]=o,t[4]=c):c=t[4],t[5]!==c?(d=(0,f.jsxs)(f.Fragment,{children:[l,c]}),t[5]=c,t[6]=d):d=t[6],d}const S=a.forwardRef(function(e,t){const n=(0,r.c)(10);let a,o,i,s;return n[0]!==e.style?(a={pointerEvents:"none",...e.style},n[0]=e.style,n[1]=a):a=n[1],n[2]===Symbol.for("react.memo_cache_sentinel")?(o={style:{pointerEvents:"auto"}},n[2]=o):o=n[2],n[3]!==e.slotProps?(i={...e.slotProps,paper:o},n[3]=e.slotProps,n[4]=i):i=n[4],n[5]!==e||n[6]!==t||n[7]!==a||n[8]!==i?(s=(0,f.jsx)(u.A,{...e,ref:t,style:a,slotProps:i}),n[5]=e,n[6]=t,n[7]=a,n[8]=i,n[9]=s):s=n[9],s});var k=n(56540),x=n(28584),C=n(89248),T=n(81117),A=n(30108);const M=(0,n(65045).n)()({menuItemEndDecoration:{padding:0,margin:0,height:16}});function P(e){const t=(0,r.c)(10),{classes:n}=M(),{type:a}=e;let o,i,s,l;"checked"in e&&({checked:o,disabled:i}=e);e:switch(a){case"subMenu":{let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,f.jsx)(k.A,{color:"action"}),t[0]=e):e=t[0],s=e;break e}case"checkbox":if(o){const e=i?"inherit":void 0;let n;t[1]!==e?(n=(0,f.jsx)(x.A,{color:e}),t[1]=e,t[2]=n):n=t[2],s=n}else{let e;t[3]===Symbol.for("react.memo_cache_sentinel")?(e=(0,f.jsx)(C.A,{color:"action"}),t[3]=e):e=t[3],s=e}break e;case"radio":if(o){const e=i?"inherit":void 0;let n;t[4]!==e?(n=(0,f.jsx)(T.A,{color:e}),t[4]=e,t[5]=n):n=t[5],s=n}else{let e;t[6]===Symbol.for("react.memo_cache_sentinel")?(e=(0,f.jsx)(A.A,{color:"action"}),t[6]=e):e=t[6],s=e}}return t[7]!==n.menuItemEndDecoration||t[8]!==s?(l=(0,f.jsx)("div",{className:n.menuItemEndDecoration,children:s}),t[7]=n.menuItemEndDecoration,t[8]=s,t[9]=l):l=t[9],l}function I(e){if("string"==typeof e)return e.toLowerCase().replace(/\s+/g,"_")}function R(e){const t=(0,r.c)(28),{title:n,Icon:c,inset:d,menuItems:u,onMenuItemClick:p,closeAfterItemClick:h,onCloseRoot:g,isOpen:m,onOpen:y,onClose:b}=e,[w,v]=(0,a.useState)(null);let k;t[0]!==n?(k=I(n),t[0]=n,t[1]=k):k=t[1];const x=k?`cascading-submenu-${k}`:void 0;let C,T,A,M,P,R,F,D,N;return t[2]!==c?(C=c?(0,f.jsx)(i.A,{children:(0,f.jsx)(c,{})}):null,t[2]=c,t[3]=C):C=t[3],t[4]!==d||t[5]!==n?(T=(0,f.jsx)(s.A,{primary:n,inset:d}),t[4]=d,t[5]=n,t[6]=T):T=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(A=(0,f.jsx)(o.A,{}),t[7]=A):A=t[7],t[8]!==y||t[9]!==x||t[10]!==C||t[11]!==T?(M=(0,f.jsxs)(l.A,{ref:v,"data-testid":x,onMouseOver:y,onFocus:y,onClick:y,children:[C,T,A]}),t[8]=y,t[9]=x,t[10]=C,t[11]=T,t[12]=M):M=t[12],t[13]===Symbol.for("react.memo_cache_sentinel")?(P={vertical:"top",horizontal:"right"},R={vertical:"top",horizontal:"left"},t[13]=P,t[14]=R):(P=t[13],R=t[14]),t[15]!==h||t[16]!==u||t[17]!==g||t[18]!==p?(F=(0,f.jsx)(L,{closeAfterItemClick:h,onMenuItemClick:p,menuItems:u,onCloseRoot:g}),t[15]=h,t[16]=u,t[17]=g,t[18]=p,t[19]=F):F=t[19],t[20]!==w||t[21]!==m||t[22]!==b||t[23]!==F?(D=(0,f.jsx)(S,{open:m,anchorEl:w,onClose:b,anchorOrigin:P,transformOrigin:R,children:F}),t[20]=w,t[21]=m,t[22]=b,t[23]=F,t[24]=D):D=t[24],t[25]!==D||t[26]!==M?(N=(0,f.jsxs)(f.Fragment,{children:[M,D]}),t[25]=D,t[26]=M,t[27]=N):N=t[27],N}function L(e){const t=(0,r.c)(22),{onMenuItemClick:n,closeAfterItemClick:o,menuItems:u,onCloseRoot:p}=e,[h,g]=(0,a.useState)();let m;t[0]===Symbol.for("react.memo_cache_sentinel")?(m=()=>{g(void 0)},t[0]=m):m=t[0];const y=m;let b;t[1]!==u?(b=u.some(N),t[1]=u,t[2]=b):b=t[2];const w=b;let S;t[3]!==u?(S=u.some(D),t[3]=u,t[4]=S):S=t[4];const k=S;let x,C;if(t[5]!==o||t[6]!==k||t[7]!==w||t[8]!==u||t[9]!==p||t[10]!==n||t[11]!==h){const e=u.toSorted(F);let r;t[13]!==o||t[14]!==k||t[15]!==w||t[16]!==p||t[17]!==n||t[18]!==h?(r=(e,t)=>{if("subMenu"in e)return(0,f.jsx)(R,{title:e.label,Icon:e.icon,inset:w&&!e.icon,onMenuItemClick:n,menuItems:e.subMenu,closeAfterItemClick:o,onCloseRoot:p,isOpen:h===t,onOpen:()=>{g(t)},onClose:y},`subMenu-${e.label}-${t}`);if("divider"===e.type)return(0,f.jsx)(c.A,{component:"li"},`divider-${t}`);if("subHeader"===e.type)return(0,f.jsx)(d.A,{children:e.label},`subHeader-${e.label}-${t}`);const r=e,a=r.helpText,u="checkbox"===r.type||"radio"===r.type,m=I(r.label);return(0,f.jsxs)(l.A,{"data-testid":m?`cascading-menuitem-${m}`:void 0,disabled:Boolean(r.disabled),onClick:e=>{o&&p(),n(e,r.onClick)},onMouseOver:y,children:[r.icon?(0,f.jsx)(i.A,{children:(0,f.jsx)(r.icon,{})}):null,(0,f.jsx)(s.A,{primary:r.label,secondary:r.subLabel,inset:w&&!r.icon}),(0,f.jsx)("div",{style:{flexGrow:1,minWidth:10}}),u?(0,f.jsx)(P,{type:r.type,checked:r.checked,disabled:r.disabled}):null,a?(0,f.jsx)(v,{helpText:a,label:r.label}):u&&k?(0,f.jsx)("div",{style:{marginLeft:4,padding:4,width:28,height:28}}):null]},`${r.label}-${t}`)},t[13]=o,t[14]=k,t[15]=w,t[16]=p,t[17]=n,t[18]=h,t[19]=r):r=t[19],x=e.map(r),t[5]=o,t[6]=k,t[7]=w,t[8]=u,t[9]=p,t[10]=n,t[11]=h,t[12]=x}else x=t[12];return t[20]!==x?(C=(0,f.jsx)(f.Fragment,{children:x}),t[20]=x,t[21]=C):C=t[21],C}function F(e,t){return(t.priority||0)-(e.priority||0)}function D(e){return("checkbox"===e.type||"radio"===e.type)&&"helpText"in e&&e.helpText}function N(e){return"icon"in e&&e.icon}function B(e){const t=(0,r.c)(19),{onMenuItemClick:n,closeAfterItemClick:a,menuItems:o,open:i,onClose:s,anchorEl:l,anchorOrigin:c,transformOrigin:d,anchorReference:p,anchorPosition:h,slotProps:g,marginThreshold:m,style:y}=e,b=void 0===a||a;let w;t[0]!==o?(w=Array.isArray(o)?o:o(),t[0]=o,t[1]=w):w=t[1];const v=w,S=m??void 0;let k,x;return t[2]!==b||t[3]!==v||t[4]!==s||t[5]!==n?(k=(0,f.jsx)(L,{menuItems:v,closeAfterItemClick:b,onMenuItemClick:n,onCloseRoot:s}),t[2]=b,t[3]=v,t[4]=s,t[5]=n,t[6]=k):k=t[6],t[7]!==l||t[8]!==c||t[9]!==h||t[10]!==p||t[11]!==s||t[12]!==i||t[13]!==g||t[14]!==y||t[15]!==S||t[16]!==k||t[17]!==d?(x=(0,f.jsx)(u.A,{anchorEl:l,open:i,onClose:s,anchorOrigin:c,transformOrigin:d,anchorReference:p,anchorPosition:h,slotProps:g,marginThreshold:S,style:y,children:k}),t[7]=l,t[8]=c,t[9]=h,t[10]=p,t[11]=s,t[12]=i,t[13]=g,t[14]=y,t[15]=S,t[16]=k,t[17]=d,t[18]=x):x=t[18],x}},14647(e,t,n){n.d(t,{E6:()=>h,Ec:()=>p,JV:()=>f,Tp:()=>u,_u:()=>m,eW:()=>d,y$:()=>g});var r=n(30936),a=n(42918),o=n(11259),i=n(77251),s=n(70203);const[,l,,c]=[0,1,2,3];function d(e,t,n,r){return r?r(t,n):e[n].trackRefs[t]?.getBoundingClientRect().top||0}function u(e,t,n){return(e.bpToPx({refName:t,coord:n})?.offsetPx||0)-e.offsetPx}function p(e,t,n,r,a,o){const s=r[t].displays[0],u=s.height,p=s.SNPCoverageDisplay?.height??0,h=o?0:s.scrollTop;return(0,i.clamp)(a[l]-h+((g=a)[c]-g[l])/2+p,p,u)+d(n,e,t,o);var g}const h=e=>{const t=(0,r.c)(5),[,n]=(0,a.useState)();let o,i;t[0]!==n||t[1]!==e?(o=()=>{n(e)},t[0]=n,t[1]=e,t[2]=o):o=t[2],t[3]!==e?(i=[e],t[3]=e,t[4]=i):i=t[4],(0,a.useEffect)(o,i)};function g(e,t=[],n=[],...r){const a=new Set(n.map(t=>e(t))),o=t.filter(t=>a.has(e(t)));return 0===r.length?o:g(e,o,...r)}function m(e,t){return e.displays[0].searchFeatureByID?.(t.id())}async function f(e,t){const{views:n}=e,{rpcManager:r}=(0,i.getSession)(e),a=(0,s.getRpcSessionId)(t);return Promise.all(n.flatMap(async e=>await r.call(a,"BreakpointGetFeatures",{adapterConfig:(0,o.FI)(t,["adapter"]),sessionId:a,regions:e.staticBlocks.contentBlocks})))}},14665(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.heading=e.heading,this.HeadingComponent=e.HeadingComponent,this.configSchema=e.configSchema,this.stateModel=e.stateModel,this.ReactComponent=e.ReactComponent,this.helpText=e.helpText}}},14800(e,t,n){n.d(t,{A:()=>r});class r{subLayouts=new Map;constructor(e,t={}){this.SubLayoutClass=e,this.subLayoutConstructorArgs=t}getDataByID(e){for(const t of this.subLayouts.values()){const n=t.getDataByID(e);if(n)return n}}getSublayout(e){let t=this.subLayouts.get(e);return void 0===t?(t=new this.SubLayoutClass(this.subLayoutConstructorArgs),this.subLayouts.set(e,t),t):t}addRect(e,t,n,r,a,o={},i){return this.getSublayout(e).addRect(t,n,r,a,o,i)}discardRange(e,t,n){return this.subLayouts.get(e)?.discardRange(t,n)}toJSON(){const e={};for(const[t,n]of this.subLayouts.entries())e[t]=n.toJSON();return e}}},15391(e,t,n){n.d(t,{DW:()=>u,J8:()=>a,L9:()=>c,PJ:()=>g,Pq:()=>h,en:()=>l,pf:()=>o,sY:()=>p,w7:()=>i});var r=n(86470);const a={PROPER_PAIR:0,LONG_INSERT:1,SHORT_INSERT:2,INTER_CHROM:3,ABNORMAL_ORIENTATION:4,UNMAPPED_MATE:5},o={color_fwd_strand_not_proper:"#ECC8C8",color_rev_strand_not_proper:"#BEBED8",color_fwd_strand:"#EC8B8B",color_rev_strand:"#8F8FD8",color_fwd_missing_mate:"#D11919",color_rev_missing_mate:"#1919D1",color_fwd_diff_chr:"#000",color_rev_diff_chr:"#969696",color_pair_lr:"lightgrey",color_pair_rr:"#3a3a9d",color_pair_rl:"teal",color_pair_ll:"green",color_nostrand:"#c8c8c8",color_interchrom:"purple",color_longinsert:"red",color_shortinsert:"pink",color_unmapped_mate:"#8B4513",color_unknown:"grey",color_longread_rev_fwd:"navy",color_longread_fwd_rev:"green",color_longread_same:"grey",color_supplementary:"#f0b878"},i={color_fwd_strand_not_proper:"#CA6767",color_rev_strand_not_proper:"#7272AA",color_fwd_strand:"#DC2A2A",color_rev_strand:"#4141BA",color_fwd_missing_mate:"#921111",color_rev_missing_mate:"#111192",color_fwd_diff_chr:"#000000",color_rev_diff_chr:"#696969",color_pair_lr:"#8C8C8C",color_pair_rr:"#00002A",color_pair_rl:"#005A5A",color_pair_ll:"#005A00",color_nostrand:"#8C8C8C",color_interchrom:"#5A005A",color_longinsert:"#B30000",color_shortinsert:"#FF3A5C",color_unmapped_mate:"#5D2E0D",color_unknown:"#444",color_longread_rev_fwd:"#00004D",color_longread_fwd_rev:"#005A00",color_longread_same:"#444",color_supplementary:"#c88030"},s=[o.color_pair_lr,i.color_pair_lr];function l({type:e,f:t,stats:n}){if(void 0!==t.flags&&8&t.flags)return a.UNMAPPED_MATE;if("insertSizeAndOrientation"===e||"orientation"===e){const e=r.il.fr[t.pair_orientation||""];if(e&&"LR"!==e)return a.ABNORMAL_ORIENTATION}if("insertSizeAndOrientation"===e||"insertSize"===e){const e=t.refName===t.next_ref,r=Math.abs(t.tlen||0);if(!e)return a.INTER_CHROM;if(n){if(r>n.upper)return a.LONG_INSERT;if(r<n.lower)return a.SHORT_INSERT}}return a.PROPER_PAIR}function c(e,t){switch(l({type:"insertSize",f:e,stats:t})){case a.UNMAPPED_MATE:return[o.color_unmapped_mate,i.color_unmapped_mate];case a.LONG_INSERT:return[o.color_longinsert,i.color_longinsert];case a.SHORT_INSERT:return[o.color_shortinsert,i.color_shortinsert];case a.INTER_CHROM:return[o.color_interchrom,i.color_interchrom];case a.PROPER_PAIR:default:return}}function d(e){if(void 0!==e.flags&&8&e.flags)return[o.color_unmapped_mate,i.color_unmapped_mate];const t=r.il.fr[e.pair_orientation||""];if(!t||"LR"===t)return;const n=r.rr[t];return[o[n],i[n]]}function u(e){return d(e)||s}function p(e,t){return d(e)||c(e,t)||s}function h(e,t){const n=Math.abs(e.tlen||0);return t&&n>t.upper?[o.color_fwd_missing_mate,i.color_fwd_missing_mate]:s}function g({type:e,v0:t,stats:n}){const r={refName:t.get("refName"),next_ref:t.get("next_ref"),pair_orientation:t.get("pair_orientation"),tlen:t.get("template_length"),flags:t.get("flags")};return"insertSizeAndOrientation"===e?p(r,n):"orientation"===e?u(r):"insertSize"===e?c(r,n):void 0}},15705(e,t,n){n.d(t,{OX:()=>s,W7:()=>i,bf:()=>l});var r=n(77251),a=n(70203),o=n(99226);function i(e){return Math.floor(e/1e6)>0?`${Number.parseFloat((e/1e6).toPrecision(3))} Mb`:Math.floor(e/1e3)>0?`${Number.parseFloat((e/1e3).toPrecision(3))} Kb`:`${Math.floor(e)} bytes`}function s(e,t){const n="undefined"==typeof jest;return["clip",n?e:"jest",t,n?Math.random():""].filter(e=>!!e).join("-")}async function l(e){const t=(0,r.getContainingView)(e).staticBlocks.contentBlocks,{rpcManager:n}=(0,r.getSession)(e),{adapterConfig:i,effectiveRpcDriverName:s}=e;if(i){const r=(0,a.getRpcSessionId)(e);return n.call(r,"CoreGetFeatureDensityStats",{sessionId:r,regions:t,adapterConfig:i,rpcDriverName:s,statusCallback:t=>{(0,o.isAlive)(e)&&e.setStatusMessage(t)}})}return{}}},17868(e,t,n){n.r(t),n.d(t,{createJBrowseBaseTheme:()=>L,createJBrowseTheme:()=>D,defaultThemes:()=>I});var r=n(88050),a=n(28514),o=n(93533),i=n(66286),s=n(42451),l=n(15022),c=n(68560),d=n.n(c);const u=(0,r.A)(),p=u.palette.augmentColor({color:{main:"#0D233F"}}),h=u.palette.augmentColor({color:{main:"#721E63"}}),g=u.palette.augmentColor({color:{main:"#135560"}}),m=u.palette.augmentColor({color:{main:"#FFB11D"}}),f=u.palette.augmentColor({color:{main:"#aaa"}}),y={A:u.palette.augmentColor({color:i.A}),C:u.palette.augmentColor({color:o.A}),G:u.palette.augmentColor({color:s.A}),T:u.palette.augmentColor({color:a.A})},b=[null,u.palette.augmentColor({color:{main:"#FF8080"}}),u.palette.augmentColor({color:{main:"#80FF80"}}),u.palette.augmentColor({color:{main:"#8080FF"}}),u.palette.augmentColor({color:{main:"#8080FF"}}),u.palette.augmentColor({color:{main:"#80FF80"}}),u.palette.augmentColor({color:{main:"#FF8080"}})],w=[null,u.palette.augmentColor({color:{main:"#8f8f8f"}}),u.palette.augmentColor({color:{main:"#adadad"}}),u.palette.augmentColor({color:{main:"#d8d8d8"}}),u.palette.augmentColor({color:{main:"#d8d8d8"}}),u.palette.augmentColor({color:{main:"#adadad"}}),u.palette.augmentColor({color:{main:"#8f8f8f"}})],v="#e22",S="#3e3",k="#800080",x="#808080",C="#f00",T="#00f",A="#97b8c9",M={primary:p,secondary:h,tertiary:g,quaternary:m,highlight:m,stopCodon:v,startCodon:S,insertion:k,deletion:x,softclip:T,hardclip:C,bases:y,frames:w,framesCDS:b,skip:A};function P(){return{palette:{...M,mode:void 0},components:{MuiLink:{styleOverrides:{root:({theme:e})=>({color:e.palette.tertiary.main})}}}}}const I={default:{...P(),name:"Default (from config)"},lightStock:{...P(),name:"Light (stock)"},lightMinimal:{name:"Light (minimal)",palette:{...M,primary:{main:l.A[900]},secondary:{main:l.A[800]},tertiary:u.palette.augmentColor({color:{main:l.A[900]}})}},darkMinimal:{name:"Dark (minimal)",palette:{...M,mode:"dark",primary:{main:l.A[700]},secondary:{main:l.A[800]},tertiary:u.palette.augmentColor({color:{main:l.A[900]}})}},darkStock:{name:"Dark (stock)",palette:{...M,mode:"dark"},components:{MuiAppBar:{defaultProps:{enableColorOnDark:!0},styleOverrides:{root:({theme:e})=>e.palette.primary.main}}}}};function R(e,t){return t}function L(e){const t={palette:e?.palette,typography:{fontSize:12},spacing:4,components:{MuiTooltip:{styleOverrides:{tooltip:{fontSize:12}}},MuiButton:{defaultProps:{size:"small"},styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.primary}:void 0}},MuiAccordion:{defaultProps:{disableGutters:!0,slotProps:{transition:{timeout:150,unmountOnExit:!0}}}},MuiFilledInput:{defaultProps:{margin:"dense"}},MuiFormControl:{defaultProps:{margin:"dense",size:"small"}},MuiFormHelperText:{defaultProps:{margin:"dense"}},MuiIconButton:{defaultProps:{size:"small"}},MuiInputBase:{defaultProps:{margin:"dense"}},MuiAutocomplete:{defaultProps:{size:"small"}},MuiInputLabel:{defaultProps:{margin:"dense"}},MuiToolbar:{defaultProps:{variant:"dense"}},MuiListItem:{defaultProps:{dense:!0}},MuiOutlinedInput:{defaultProps:{margin:"dense"}},MuiFab:{defaultProps:{size:"small"},styleOverrides:{secondary:{backgroundColor:e?.palette?.quaternary?.main}}},MuiTable:{defaultProps:{size:"small"}},MuiPopover:{defaultProps:{transitionDuration:0}},MuiMenu:{defaultProps:{transitionDuration:0}},MuiMenuItem:{defaultProps:{dense:!0}},MuiTextField:{defaultProps:{margin:"dense",variant:"standard"}},MuiLink:{styleOverrides:{root:({theme:e})=>({color:e.palette.text.secondary})}},MuiCheckbox:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-checked":{color:e.palette.text.secondary}}:void 0}},MuiRadio:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-checked":{color:e.palette.text.secondary}}:void 0}},MuiFormLabel:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-focused":{color:e.palette.text.secondary}}:void 0}},MuiAccordionSummary:{styleOverrides:{root:{backgroundColor:e?.palette?.tertiary?.main},content:{color:e?.palette?.tertiary?.contrastText}}},MuiToggleButtonGroup:{defaultProps:{size:"small"}},MuiButtonBase:{styleOverrides:{root:{"& .MuiTouchRipple-ripple":{animationDuration:"50ms !important"},"& .MuiTouchRipple-child":{animationDuration:"50ms !important"}}}}}};return d()(t,e||{},{arrayMerge:R})}const F=new Map;function D(e={},t=I,n="default"){const a=function(e,t){return JSON.stringify({configTheme:e,themeName:t})}(e,n),o=F.get(a);if(o)return o;const i=(0,r.A)(L("default"===n?d()(t.default,N(e),{arrayMerge:R}):function(e={}){const{palette:t}=e;return N(d()(e,{palette:{quaternary:t?.quaternary||f,tertiary:t?.tertiary||f,highlight:t?.highlight||m,insertion:t?.insertion||k,softclip:t?.softclip||T,skip:t?.skip||A,hardclip:t?.hardclip||C,deletion:t?.deletion||x,startCodon:t?.startCodon||S,stopCodon:t?.stopCodon||v}}))}(t[n])));return F.set(a,i),i}function N(e={}){const t=Object.create(null);for(const n of["primary","secondary","tertiary","quaternary","highlight"]){const r=e.palette?.[n];r&&(t[n]=u.palette.augmentColor("color"in r?r:{color:r}))}return Object.keys(t).length>0?d()(e,{palette:t}):e}},18543(e,t,n){n.r(t),n.d(t,{default:()=>u});var r=n(96852),a=n(10596),o=n(44121),i=n(40704),s=n(79387),l=n(38433),c=n(77251),d=n(53155);class u extends o.default{async renderDirect(e){return{...await super.renderDirect(e),blockKey:e.blockKey}}serializeArgsInClient(e){return super.serializeArgsInClient({...e,displayModel:void 0,regions:structuredClone(e.regions)})}deserializeResultsInClient(e,t){const n=new Map(e.features?.map(e=>d.A.fromJSON(e)).map(e=>[e.id(),e]));return{...super.deserializeResultsInClient({...e,features:n},t),blockKey:t.blockKey,features:n}}serializeResultsInWorker(e,t){const n=super.serializeResultsInWorker(e,t),{features:r}=e;return{...n,features:r instanceof Map?(0,c.iterMap)(r.values(),e=>e.toJSON(),r.size):void 0}}getExpandedRegion(e,t){return e}async getFeatures(e){const t=this.pluginManager,{regions:n,sessionId:o,adapterConfig:c}=e,{dataAdapter:d}=await(0,l.cK)(t,o,c);if(!(0,s.c7)(d))throw new Error("Adapter does not support retrieving features");const u=n.map(e=>(0,i.w)(e)),p=1===u.length?d.getFeatures(this.getExpandedRegion(u[0],e),e):d.getFeaturesInMultipleRegions(u,e),h=await(0,r._)(p.pipe((0,a.$)()));return new Map(h.filter(t=>this.featurePassesFilters(e,t)).map(e=>[e.id(),e]))}featurePassesFilters(e,t){return!e.filters||e.filters.passes(t,e)}async render(e){const t=await this.getFeatures(e);return{...await super.render({...e,features:t}),features:t}}}},18769(e,t,n){n.d(t,{Ay:()=>v});var r=n(42918),a=n(11259),o=n(65045),i=n(33579),s=n(64074),l=n(85376),c=n(1818),d=n(30936),u=n(32118);const p=(0,o.n)()({heightOverflowed:{position:"absolute",color:"rgb(77,77,77)",borderBottom:"2px solid rgb(77,77,77)",textShadow:"white 0px 0px 1px",whiteSpace:"nowrap",width:"100%",fontWeight:"bold",textAlign:"center",zIndex:999,boxSizing:"border-box"}}),h=(0,r.memo)(function(e){const t=(0,d.c)(5),{top:n}=e,{classes:r}=p();let a,o;return t[0]!==n?(a={top:n,pointerEvents:"none",height:16},t[0]=n,t[1]=a):a=t[1],t[2]!==r.heightOverflowed||t[3]!==a?(o=(0,u.jsx)("div",{className:r.heightOverflowed,style:a,children:"Max height reached"}),t[2]=r.heightOverflowed,t[3]=a,t[4]=o):o=t[4],o}),g=(0,s.observer)(function({model:e}){const{blockDefinitions:t,blockState:n}=e;return t.map(t=>{const r=`${e.id}-${t.key}`;if("ContentBlock"===t.type){const e=n.get(t.key);return(0,u.jsxs)(c.$G,{block:t,children:[e?.ReactComponent?(0,u.jsx)(e.ReactComponent,{model:e}):null,e?.maxHeightReached?(0,u.jsx)(h,{top:e.layout.getTotalHeight()-16}):null]},r)}if("ElidedBlock"===t.type)return(0,u.jsx)(c.Db,{width:t.widthPx},r);if("InterRegionPaddingBlock"===t.type)return(0,u.jsx)(c.fK,{width:t.widthPx,style:{background:"none"},boundary:"boundary"===t.variant},r);throw new Error(`invalid block type ${JSON.stringify(t)}`)})}),m=(0,o.n)()({linearBlocks:{whiteSpace:"nowrap",textAlign:"left",position:"absolute",minHeight:"100%",display:"flex"}}),f=(0,s.observer)(function({model:e}){const{classes:t}=m(),{blockDefinitions:n}=e;return(0,u.jsx)("div",{className:t.linearBlocks,style:{left:`calc(${n.offsetPx}px - var(--offset-px))`},children:(0,u.jsx)(g,{model:e})})});var y=n(14391);const b=(0,s.observer)(function({onClose:e,contextCoord:t,model:n}){const r=n.contextMenuItems();return(0,u.jsx)(y.A,{open:r.length>0,onMenuItemClick:(t,n)=>{n(),e()},onClose:()=>{e(),n.setContextMenuFeature(void 0)},slotProps:{transition:{onExit:()=>{e(),n.setContextMenuFeature(void 0)}}},anchorReference:"anchorPosition",anchorPosition:{top:t[1],left:t[0]},menuItems:r})}),w=(0,o.n)()({display:{position:"relative",whiteSpace:"nowrap",textAlign:"left",width:"100%",minHeight:"100%"}}),v=(0,s.observer)(function(e){const{classes:t}=w(),n=(0,r.useRef)(null),[o,s]=(0,r.useState)(),[c,d]=(0,r.useState)([0,0]),[p,h]=(0,r.useState)([0,0]),[g,m]=(0,r.useState)(),{model:y,children:v}=e,{TooltipComponent:S,DisplayMessageComponent:k,height:x,showLegend:C,showTooltipsEnabled:T}=y,A=(0,i.A)(),M=y.legendItems(A);return(0,u.jsxs)("div",{ref:n,"data-testid":`display-${(0,a.FI)(y,"displayId")}`,className:t.display,onContextMenu:e=>{e.preventDefault(),g?m(void 0):n.current&&m([e.clientX,e.clientY])},onMouseMove:e=>{if(!n.current)return;const t=n.current.getBoundingClientRect(),{left:r,top:a}=t;d([e.clientX-r,e.clientY-a]),h([e.clientX,e.clientY]),s(t)},children:[k?(0,u.jsx)(k,{model:y}):(0,u.jsx)(f,{...e}),v,C&&M.length>0?(0,u.jsx)(l.A,{items:M}):null,T?(0,u.jsx)(r.Suspense,{fallback:null,children:(0,u.jsx)(S,{model:y,height:x,offsetMouseCoord:c,clientMouseCoord:p,clientRect:o,mouseCoord:c})}):null,g?(0,u.jsx)(b,{contextCoord:g,model:y,onClose:()=>{m(void 0)}}):null]})})},19183(e,t,n){n.d(t,{z:()=>r.when});var r=n(38567)},19482(e,t,n){n.d(t,{A:()=>o});var r=n(11550);const a={};function o(e,t){const n=`nosig|${e}`;if(!a[n]){if(!e.startsWith("jexl:"))throw new Error("string does not appear to be in jexl format");const o=e.split("jexl:")[1],i=t?t.compile(o):(0,r.A)().compile(o);a[n]=i}return a[n]}},19598(e,t,n){n.d(t,{M:()=>s});var r=n(42791),a=n(28520),o=n(19818);let i=!1;function s(e){return i||((0,r.X$)([a.A,o.A]),i=!0),(0,r.Mj)(e)}},20067(e,t,n){n.d(t,{A:()=>q});var r={};n.r(r),n.d(r,{CoreFreeResources:()=>P,CoreGetExportData:()=>L,CoreGetFeatureDensityStats:()=>I,CoreGetFeatureDetails:()=>b,CoreGetFeatures:()=>C,CoreGetFileInfo:()=>v,CoreGetMetadata:()=>w,CoreGetRefNames:()=>f,CoreGetRegions:()=>R,CoreGetSequence:()=>T,CoreRender:()=>M});var a=n(99226),o=n(42918),i=n(87877);const s=(0,i.S7)("BaseFeatureWidget",{});var l=n(20369),c=n(54351);const d=(0,i.S7)("CytobandAdapter",{cytobandLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/cytoband.txt.gz"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,cytobandLocation:{uri:e.uri,baseUri:e.baseUri}}:e});var u=n(58946),p=n(14665),h=n(79387),g=n(38433),m=n(74603);class f extends m.A{name="CoreGetRefNames";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{sessionId:a,adapterConfig:o,sequenceAdapter:i}=r,{dataAdapter:s}=await(0,g.cK)(n,a,o);return(0,h.c7)(s)?(i&&!s.sequenceAdapterConfig&&s.setSequenceAdapterConfig(i),s.getRefNames(r)):[]}}var y=n(77251);class b extends m.A{name="CoreGetFeatureDetails";async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,e),o=await super.serializeArguments(a,t),{rendererType:i}=e;return this.pluginManager.getRendererType(i).serializeArgsInClient(o)}async execute(e,t){const n=await this.deserializeArguments(e,t),{rendererType:r,featureId:a}=n,o=this.pluginManager.getRendererType(r);return{feature:o.getLayoutSession(e)?.cachedLayout.layout.getDataByID(a)?.toJSON()}}}class w extends m.A{name="CoreGetMetadata";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{sessionId:a,adapterConfig:o}=r,{dataAdapter:i}=await(0,g.cK)(n,a,o);return(0,h.c7)(i)?i.getMetadata(r):null}}class v extends m.A{name="CoreGetInfo";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{sessionId:a,adapterConfig:o}=r,{dataAdapter:i}=await(0,g.cK)(n,a,o);return(0,h.c7)(i)?i.getHeader(r):null}}var S=n(96852),k=n(10596),x=n(53155);class C extends m.A{name="CoreGetFeatures";async deserializeReturn(e,t,n){return(await super.deserializeReturn(e,t,n)).map(e=>new x.A(e))}async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,e);return super.serializeArguments(a,t)}async execute(e,t){const{stopToken:n,statusCallback:r,sessionId:a,adapterConfig:o,regions:i,opts:s}=await this.deserializeArguments(e,t),l=(await(0,g.cK)(this.pluginManager,a,o)).dataAdapter;return(await(0,S._)(l.getFeaturesInMultipleRegions(i,{...s,statusCallback:r,stopToken:n}).pipe((0,k.$)()))).map(e=>e.toJSON())}}class T extends m.A{name="CoreGetSequence";async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,e);return super.serializeArguments(a,t)}async execute(e,t){const{stopToken:n,sessionId:r,adapterConfig:a,region:o}=await this.deserializeArguments(e,t);return(await(0,g.cK)(this.pluginManager,r,a)).dataAdapter.getSequence(o,{stopToken:n})}}function A(e,t){if(!t.ReactComponent)throw new Error(`renderer ${e} has no ReactComponent, it may not be completely implemented yet`);return t}class M extends m.A{name="CoreRender";async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,e),o=await super.serializeArguments(a,t);return A(e.rendererType,this.pluginManager.getRendererType(e.rendererType)).serializeArgsInClient(o)}async executeDirect(e){const{rootModel:t}=this.pluginManager,n=t.session.assemblyManager,r=await(0,y.renameRegionsIfNeeded)(n,e),{sessionId:a,rendererType:o}=r;if(!a)throw new Error("must pass a unique session id");return A(o,this.pluginManager.getRendererType(o)).renderDirect(r)}async execute(e,t){const n=await this.deserializeArguments(e,t),{sessionId:r,rendererType:a}=n;if(!r)throw new Error("must pass a unique session id");return A(a,this.pluginManager.getRendererType(a)).renderInWorker(n)}async deserializeReturn(e,t,n){const r=await super.deserializeReturn(e,t,n);return A(t.rendererType,this.pluginManager.getRendererType(t.rendererType)).deserializeResultsInClient(r,t)}}class P extends m.A{name="CoreFreeResources";async execute(e){await(0,g.pZ)(e);for(const t of this.pluginManager.getRendererTypes())t.freeResources(e)}async serializeArguments(e,t){return e}}class I extends m.A{name="CoreGetFeatureDensityStats";async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,{...e,filters:e.filters?.toJSON().filters});return super.serializeArguments(a,t)}async execute(e,t){const n=await this.deserializeArguments(e,t),{adapterConfig:r,sessionId:a,regions:o}=n,{dataAdapter:i}=await(0,g.cK)(this.pluginManager,a,r);if(!(0,h.c7)(i))throw new Error("Adapter does not support retrieving features");return i.getMultiRegionFeatureDensityStats(o,n)}}class R extends m.A{name="CoreGetRegions";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{sessionId:a,adapterConfig:o}=r,{dataAdapter:i}=await(0,g.cK)(n,a,o);return(0,h.DD)(i)?i.getRegions(r):[]}}class L extends m.A{name="CoreGetExportData";async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,y.renameRegionsIfNeeded)(r,e);return super.serializeArguments(a,t)}async execute(e,t){const{sessionId:n,adapterConfig:r,regions:a,formatType:o,opts:i}=await this.deserializeArguments(e,t),s=(await(0,g.cK)(this.pluginManager,n,r)).dataAdapter;return await s.getExportData(a,o,i)||""}}class F extends c.A{name="CorePlugin";install(e){for(const t of Object.values(r))e.addRpcMethod(()=>new t(e));!function(e){e.addAdapterType(()=>new u.A({name:"CytobandAdapter",configSchema:d,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(4627).then(n.bind(n,4627)).then(e=>e.default)}))}(e),e.addWidgetType(()=>new p.A({name:"BaseFeatureWidget",heading:"Feature details",configSchema:s,stateModel:(0,l.n)(e),ReactComponent:(0,o.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(9764),n.e(1941)]).then(n.bind(n,51941)))}))}}class D{phaseCallbacks=new Map;phaseOrder=[];constructor(...e){this.phaseOrder=e}add(e,t){if(!this.phaseOrder.includes(e))throw new Error(`unknown phase ${e}`);let n=this.phaseCallbacks.get(e);n||(n=[],this.phaseCallbacks.set(e,n)),n.push(t)}run(){for(const e of this.phaseOrder)for(const t of this.phaseCallbacks.get(e)||[])t()}}var N=n(28874),B=n(11259),E=n(39494),V=n(14261),z=n(61451),j=n(48635),H=n(99697),_=n(47011),O=n(3026),$=n(23460),G=n(20749),W=n(11550);class U{registeredTypes={};constructor(e,t){this.typeName=e,this.baseClass=t}add(e,t){this.registeredTypes[e]=t}has(e){return e in this.registeredTypes}get(e){if(!this.has(e))throw new Error(`${this.typeName} '${e}' not found, perhaps its plugin is not loaded or its plugin has not added it.`);return this.registeredTypes[e]}all(){return Object.values(this.registeredTypes)}}class q{plugins=[];jexl=(0,W.A)();pluginMetadata={};runtimePluginDefinitions=[];elementCreationSchedule=new D("glyph","renderer","adapter","text search adapter","display","track","connection","view","widget","rpc method","internet account","add track workflow");glyphTypes=new U("GlyphType",j.A);rendererTypes=new U("RendererType",G.default);adapterTypes=new U("AdapterType",u.A);textSearchAdapterTypes=new U("TextSearchAdapterType",_.A);trackTypes=new U("TrackType",O.A);displayTypes=new U("DisplayType",z.A);connectionTypes=new U("ConnectionType",V.A);viewTypes=new U("ViewType",$.A);widgetTypes=new U("WidgetType",p.A);rpcMethods=new U("RpcMethodType",m.A);addTrackWidgets=new U("AddTrackWorkflow",E.A);internetAccountTypes=new U("InternetAccountType",H.A);configured=!1;extensionPoints=new Map;constructor(e=[]){this.addPlugin({plugin:new F,metadata:{isCore:!0}});for(const t of e)this.addPlugin(t)}pluginConfigurationNamespacedSchemas(){const e={};for(const t of this.plugins)t.configurationSchema&&(e[t.name]=t.configurationSchema);return e}pluginConfigurationUnnamespacedSchemas(){let e={};for(const t of this.plugins)t.configurationSchemaUnnamespaced&&(e={...e,...t.configurationSchemaUnnamespaced});return e}pluginConfigurationRootSchemas(){let e={};for(const t of this.plugins)t.rootConfigurationSchema&&(e={...e,...t.rootConfigurationSchema(this)});return e}addPlugin(e){if(this.configured)throw new Error("JBrowse already configured, cannot add plugins");const[t,n={}]="install"in e&&"configure"in e?[e,{}]:[e.plugin,e.metadata];if(this.plugins.includes(t))throw new Error("plugin already installed");return this.pluginMetadata[t.name]=n,"definition"in e&&this.runtimePluginDefinitions.push(e.definition),t.install(this),this.plugins.push(t),this}getPlugin(e){return this.plugins.find(t=>t.name===e)}hasPlugin(e){return void 0!==this.getPlugin(e)}createPluggableElements(){return this.elementCreationSchedule&&(this.elementCreationSchedule.run(),this.elementCreationSchedule=void 0),this}setRootModel(e){return this.rootModel=e,this}configure(){if(this.configured)throw new Error("already configured");for(const e of this.plugins)e.configure(this);return this.configured=!0,this}getElementTypeRecord(e){switch(e){case"adapter":return this.adapterTypes;case"text search adapter":return this.textSearchAdapterTypes;case"connection":return this.connectionTypes;case"widget":return this.widgetTypes;case"renderer":return this.rendererTypes;case"display":return this.displayTypes;case"track":return this.trackTypes;case"view":return this.viewTypes;case"rpc method":return this.rpcMethods;case"internet account":return this.internetAccountTypes;case"add track workflow":return this.addTrackWidgets;case"glyph":return this.glyphTypes;default:throw new Error(`invalid element type '${e}'`)}}addElementType(e,t){if("function"!=typeof t)throw new Error("must provide a callback function that returns the new type object");const n=this.getElementTypeRecord(e);return this.elementCreationSchedule?.add(e,()=>{const r=t(this);if(!r.name)throw new Error(`cannot add a ${e} with no name`);n.has(r.name)?console.warn(`${e} ${r.name} already registered, cannot register it again`):n.add(r.name,this.evaluateExtensionPoint("Core-extendPluggableElement",r))}),this}getElementType(e,t){return this.getElementTypeRecord(e).get(t)}getElementTypesInGroup(e){return this.getElementTypeRecord(e).all()}getViewElements(){return this.getElementTypesInGroup("view")}getTrackElements(){return this.getElementTypesInGroup("track")}getConnectionElements(){return this.getElementTypesInGroup("connection")}getAddTrackWorkflowElements(){return this.getElementTypesInGroup("add track workflow")}getRpcElements(){return this.getElementTypesInGroup("rpc method")}getDisplayElements(){return this.getElementTypesInGroup("display")}getAdapterElements(){return this.getElementTypesInGroup("adapter")}pluggableMstType(e,t,n=a.types.maybe(a.types.null)){const r=this.getElementTypeRecord(e).all().map(e=>e[t]).filter(e=>(0,a.isType)(e)&&(0,a.isModelType)(e));return 0===r.length&&"undefined"==typeof jest?(console.warn(`No pluggable types found matching ('${e}','${t}')`),n):a.types.union(...r)}pluggableConfigSchemaType(e,t="configSchema"){const n=this.getElementTypeRecord(e).all().map(e=>e[t]).filter(e=>(0,B.C$)(e));return 0===n.length&&n.push((0,i.S7)("Null",{})),a.types.union(...n)}jbrequireCache=new Map;lib=N.A;load=e=>(this.jbrequireCache.has(e)||this.jbrequireCache.set(e,e(this)),this.jbrequireCache.get(e));jbrequire=e=>{if("string"==typeof e){const t=this.lib[e];if(!t)throw new TypeError(`No jbrequire re-export defined for package '${e}'. If this package must be shared between plugins, add it to ReExports.js. If it does not need to be shared, just import it normally.`);return t}if("function"==typeof e)return this.load(e);if(e.default)return console.warn("initiated jbrequire on a {default:Function}"),this.jbrequire(e.default);throw new TypeError("lib passed to jbrequire must be either a string or a function")};getRendererType(e){return this.rendererTypes.get(e)}getRendererTypes(){return this.rendererTypes.all()}getAdapterType(e){return this.adapterTypes.get(e)}getTextSearchAdapterType(e){return this.textSearchAdapterTypes.get(e)}getTrackType(e){return this.trackTypes.get(e)}getDisplayType(e){return this.displayTypes.get(e)}getViewType(e){return this.viewTypes.get(e)}getAddTrackWorkflow(e){return this.addTrackWidgets.get(e)}getWidgetType(e){return this.widgetTypes.get(e)}getConnectionType(e){return this.connectionTypes.get(e)}getRpcMethodType(e){return this.rpcMethods.get(e)}getInternetAccountType(e){return this.internetAccountTypes.get(e)}addRendererType(e){return this.addElementType("renderer",e)}addAdapterType(e){return this.addElementType("adapter",e)}addTextSearchAdapterType(e){return this.addElementType("text search adapter",e)}addTrackType(e){return this.addElementType("track",()=>{const t=e(this),n=this.getElementTypesInGroup("display");for(const e of n)e.trackType!==t.name||t.displayTypes.includes(e)||t.addDisplayType(e);return t})}addDisplayType(e){return this.addElementType("display",e)}addViewType(e){return this.addElementType("view",()=>{const t=e(this),n=this.getElementTypesInGroup("display");for(const e of n)e.viewType!==t.name&&e.viewType!==t.extendedName||t.displayTypes.includes(e)||t.addDisplayType(e);return t})}addWidgetType(e){return this.addElementType("widget",e)}addConnectionType(e){return this.addElementType("connection",e)}addRpcMethod(e){return this.addElementType("rpc method",e)}addInternetAccountType(e){return this.addElementType("internet account",e)}addAddTrackWorkflowType(e){return this.addElementType("add track workflow",e)}addGlyphType(e){return this.addElementType("glyph",e)}getGlyphType(e){return this.glyphTypes.get(e)}getGlyphTypes(){return this.glyphTypes.all()}addToExtensionPoint(e,t){let n=this.extensionPoints.get(e);n||(n=[],this.extensionPoints.set(e,n)),n.push(t)}evaluateExtensionPoint(e,t,n){const r=this.extensionPoints.get(e);let a=t;if(r)for(const e of r)try{a=e(a,n)}catch(e){console.error(e)}return a}async evaluateAsyncExtensionPoint(e,t,n){const r=this.extensionPoints.get(e);let a=t;if(r)for(const e of r)try{a=await e(a,n)}catch(e){console.error(e)}return a}}},20369(e,t,n){n.d(t,{n:()=>u});var r=n(99226),a=n(38567),o=n(11259),i=n(77251);function s(e,t){(0,i.localStorageSetItem)(e,JSON.stringify(t))}const l="sequenceFeatureDetails";var c=n(91674),d=n(27868);function u(e){return r.types.model("BaseFeatureWidget",{id:d.K,type:r.types.literal("BaseFeatureWidget"),featureData:r.types.frozen(),formattedFields:r.types.frozen(),unformattedFeatureData:r.types.frozen(),view:r.types.safeReference(e.pluggableMstType("view","stateModel")),track:r.types.safeReference(e.pluggableMstType("track","stateModel")),trackId:r.types.maybe(r.types.string),trackType:r.types.maybe(r.types.string),maxDepth:r.types.maybe(r.types.number),sequenceFeatureDetails:r.types.optional(r.types.model("SequenceFeatureDetails").volatile(()=>({showCoordinatesSetting:(0,i.localStorageGetItem)(`${l}-showCoordinatesSetting`)||"none",intronBp:(0,i.localStorageGetNumber)(`${l}-intronBp`,10),upDownBp:(0,i.localStorageGetNumber)(`${l}-upDownBp`,100),upperCaseCDS:(0,i.localStorageGetBoolean)(`${l}-upperCaseCDS`,!0),charactersPerRow:100,feature:void 0,mode:""})).actions(e=>({setFeature(t){e.feature=t},setUpDownBp(t){e.upDownBp=t},setIntronBp(t){e.intronBp=t},setUpperCaseCDS(t){e.upperCaseCDS=t},setShowCoordinates(t){e.showCoordinatesSetting=t},setMode(t){e.mode=t}})).views(e=>({get showCoordinates(){return"none"!==e.showCoordinatesSetting},get showGenomicCoordsOption(){return"gene"===e.mode||"gene_updownstream"===e.mode||"genomic"===e.mode||"genomic_sequence_updownstream"===e.mode},get hasCDS(){const t=e.feature?.type?.toLowerCase();return"mature_protein_region_of_cds"===t||e.feature?.subfeatures?.some(e=>{const t=e.type?.toLowerCase();return"cds"===t||"mature_protein_region_of_cds"===t})},get hasExon(){return e.feature?.subfeatures?.some(e=>"exon"===e.type)},get hasExonOrCDS(){return this.hasExon||this.hasCDS}})).actions(e=>({afterAttach(){(0,r.addDisposer)(e,(0,a.autorun)(function(){var t,n;s(`${l}-upDownBp`,e.upDownBp),s(`${l}-intronBp`,e.intronBp),t=`${l}-upperCaseCDS`,n=e.upperCaseCDS,(0,i.localStorageSetItem)(t,JSON.stringify(n)),(0,i.localStorageSetItem)(`${l}-showCoordinatesSetting`,e.showCoordinatesSetting)},{name:"SequenceFeatureLocalStorage"})),(0,r.addDisposer)(e,(0,a.autorun)(function(){e.setMode(e.hasCDS?"cds":e.hasExon?"cdna":"genomic")},{name:"SequenceFeatureMode"}))}})),{}),descriptions:r.types.frozen()}).volatile(()=>({error:void 0})).actions(e=>({setFeatureData(t){e.unformattedFeatureData=t},clearFeatureData(){e.featureData=void 0},setFormattedData(t){e.featureData=t},setExtra(t,n,r){e.trackId=n,e.trackType=t,e.maxDepth=r},setError(t){e.error=t}})).actions(e=>({afterCreate(){(0,r.addDisposer)(e,(0,a.autorun)(function(){try{const{unformattedFeatureData:t,track:n}=e,r=(0,i.getSession)(e);if(n&&e.setExtra(n.type,n.configuration.trackId,(0,o.FI)(n,["formatDetails","maxDepth"])),t){const a=structuredClone(t),i=(e,t)=>({...(0,o.FI)(r,["formatDetails",e],{feature:t}),...(0,o.FI)(n,["formatDetails",e],{feature:t})});n&&(a.__jbrowsefmt=i("feature",a),(0,c.fq)(a,(0,o.FI)(n,["formatDetails","depth"]),e=>{e.__jbrowsefmt=i("subfeatures",e)})),e.setFormattedData(a)}}catch(t){console.error(t),e.setError(t)}},{name:"FeatureWidget"}))}})).preProcessSnapshot(e=>{const{featureData:t,finalizedFeatureData:n,...r}=e;return{unformattedFeatureData:t,featureData:n,...r}}).postProcessSnapshot(e=>{const{unformattedFeatureData:t,featureData:n,...r}=e,a=JSON.stringify(n,(e,t)=>void 0===t?null:t);return{finalizedFeatureData:!a||a.length>2e6?void 0:JSON.parse(a),...r}})}},20637(e,t,n){n.d(t,{A:()=>s});var r=n(99226),a=n(67401),o=n(27868);const i=r.types.model("BaseView",{id:o.K,displayName:r.types.maybe(r.types.string),minimized:!1}).volatile(()=>({width:800})).views(()=>({menuItems:()=>[]})).actions(e=>({setDisplayName(t){e.displayName=t},setWidth(t){e.width=t},setMinimized(t){e.minimized=t}})).postProcessSnapshot(e=>{if(!e)return e;const{minimized:t,...n}=e;return{...n,...t?{minimized:t}:{}}}),s=i;i.props({displayedRegions:r.types.array(a.Region)})},20749(e,t,n){n.r(t),n.d(t,{default:()=>o});var r=n(92035),a=n(32118);class o extends r.A{supportsSVG=!0;constructor(e){super(e),this.ReactComponent=e.ReactComponent,this.configSchema=e.configSchema,this.pluginManager=e.pluginManager}async render(e){return{reactElement:(0,a.jsx)(this.ReactComponent,{...e})}}freeResources(e){}}},21455(e,t,n){n.d(t,{v:()=>c});var r=n(38433),a=n(52901),o=n(96852),i=n(10596),s=n(95067);const l=/[/|]/;async function c({pluginManager:e,args:t}){const{sources:n,minorAlleleFrequencyFilter:c,regions:d,adapterConfig:u,sessionId:p,lengthCutoffFilter:h,stopToken:g}=t,m=(0,a.jL)(g),f=(await(0,r.cK)(e,p,u)).dataAdapter,y=Object.fromEntries(n.map(e=>[e.name,[]])),b={},w=(0,s.Cg)({minorAlleleFrequencyFilter:c,lengthCutoffFilter:h,lastCheck:m,splitCache:b,features:await(0,o._)(f.getFeaturesInMultipleRegions(d,t).pipe((0,i.$)()))});for(const{feature:e}of w){const t=e.get("genotypes");for(const{name:e}of n){const n=t[e],r=b[n]??(b[n]=n.split(l));let a=0,o=0;for(let e=0,t=r.length;e<t;e++){const t=r[e];"."===t?o++:"0"!==t&&a++}const i=o===r.length?-1:0===a?0:a===r.length?2:1;y[e].push(i)}(0,a.As)(m)}return y}},23460(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{displayTypes=[];viewMetadata={};constructor(e){super(e),this.ReactComponent=e.ReactComponent,this.viewMetadata=e.viewMetadata||{},this.stateModel=e.stateModel,this.extendedName=e.extendedName}addDisplayType(e){this.displayTypes.push(e)}}},23628(e,t,n){function r(e,t){const n=[];for(let r=0;r<t;r++){const t=`${e.name} HP${r}`;n.push({...e,name:t,baseName:e.name,HP:r})}return n}function a({sources:e,sampleInfo:t}){return e.flatMap(e=>r(e,t[e.name]?.maxPloidy??2))}function o({sources:e,layout:t=e,renderingMode:n,sampleInfo:a}){const o=Object.fromEntries(e.map(e=>[e.name,e]));return t.flatMap(e=>{const t=e.baseName??e.name,i=o[t];if(!i)return[];const s={...i,...e};if("phased"===n){if(void 0!==e.HP)return[{...s,baseName:t}];const n=a?.[e.name]?.maxPloidy;return n?r(s,n):[]}return[s]})}n.d(t,{X:()=>o,d:()=>a})},23950(e,t,n){n.d(t,{L:()=>a});var r=n(70312);function a(e={}){return`${(0,r.A)(e)}`}},24644(e,t,n){n.d(t,{GY:()=>c,iz:()=>s});var r=n(96852),a=n(10596),o=n(77251),i=n(12644);function s(e){return(0,i.WD)({scoreMax:(0,o.max)(e.map(e=>e.scoreMax)),scoreMin:(0,o.min)(e.map(e=>e.scoreMin)),scoreSum:(0,o.sum)(e.map(e=>e.scoreSum)),scoreSumSquares:(0,o.sum)(e.map(e=>e.scoreSumSquares)),featureCount:(0,o.sum)(e.map(e=>e.featureCount)),basesCovered:(0,o.sum)(e.map(e=>e.basesCovered))})}function l(e,t,n,o){const{start:i,end:s}=e,l=.75*i+.25*s;return(0,r._)(n({...e,start:Math.max(0,Math.round(l-t/2)),end:Math.min(Math.round(l+t/2),s)},o).pipe((0,a.$)()))}async function c(e,t,n){const r=e.end-e.start;let a=1e3,o=0,i=performance.now();for(;;){const s=(await l(e,a,t,n)).length;if(s>=70||2*a>r)return{featureDensity:s/a};if(o>5e3)return console.warn("Stats estimation reached timeout, or didn't get enough features"),{featureDensity:Number.POSITIVE_INFINITY};const c=performance.now();o+=c-i,i=c,a*=2}}},25196(e,t,n){n.d(t,{A:()=>c});var r=n(77251),a=n(15943),o=n(33579),i=n(64074),s=n(56097),l=n(32118);const c=(0,i.observer)(function({model:e,overview:t,useOffset:n=!0}){const i=(0,o.A)().palette.tertiary.light,c=Number(n),{interRegionPaddingWidth:d,offsetPx:u,dynamicBlocks:p,cytobandOffset:h}=e,{contentBlocks:g,totalWidthPxWithoutBorders:m}=p;if(!g.length)return null;const f=g.at(0),y=g.at(-1),b=(t.bpToPx({refName:f.refName,coord:f.reversed?f.end:f.start})||0)+h*c,w=(t.bpToPx({refName:y.refName,coord:y.reversed?y.start:y.end})||0)+h*c,v=Math.max(0,-u),S=v+m+g.length*d/2,k=[[v,s.Ij],[S,s.Ij],[w,0],[b,0]];return(0,l.jsx)("polygon",{points:k.toString(),...(0,r.getFillProps)((0,a.X4)(i,.3)),...(0,r.getStrokeProps)((0,a.X4)(i,.8))})})},25978(e,t,n){function r(e,t,n,r){return t>n&&e<r&&r-n&&t-e?e>n?t<r?[e,t]:[e,r]:t<r?[n,t]:[n,r]:[]}function a(e,t,n,r){return t>n&&e<r}function o(e,t,n,r){return n<=e&&r>=t}n.d(t,{R6:()=>a,Xx:()=>o,ky:()=>r})},25986(e,t,n){n.d(t,{A:()=>i});var r=n(84946),a=n(11259),o=n(37759);class i{adapterCache=new o.A({maxSize:15});constructor(e){this.pluginManager=e}loadTextSearchAdapters(e){return Promise.all(this.relevantAdapters(e).map(async e=>{const t=(0,a.QZ)(e,"textSearchAdapterId"),n=this.adapterCache.get(t);if(n)return n;{const n=this.pluginManager.getTextSearchAdapterType(e.type),r=new(await n.getAdapterClass())(e,void 0,this.pluginManager);return this.adapterCache.set(t,r),r}}))}relevantAdapters(e){const t=this.pluginManager.rootModel,{aggregateTextSearchAdapters:n}=t?.jbrowse,{tracks:r}=t?.session,{assemblyName:a}=e;return[...this.getAdaptersWithAssembly(a,n),...this.getTrackAdaptersWithAssembly(a,r)]}getAdaptersWithAssembly(e,t){return t.filter(t=>(0,a.QZ)(t,"assemblyNames")?.includes(e))}getTrackAdaptersWithAssembly(e,t){return t.filter(t=>(0,a.QZ)(t,["textSearching","textSearchAdapter","assemblyNames"])?.includes(e)).map(e=>e.textSearching.textSearchAdapter)}async search(e,t,n){return this.search2({args:e,searchScope:t,rankFn:n})}async search2({args:e,searchScope:t,rankFn:n}){const r=await this.loadTextSearchAdapters(t),a=await Promise.all(r.map(t=>t.searchIndex(e)));return this.sortResults2({args:e,results:a.flat(),rankFn:n})}sortResults2({results:e,rankFn:t,args:n}){const a=new r.A({}),o=e.map(e=>e.getDisplayString()),i=n.queryString,s=a.filter(o,i),l=[];if(null!=s&&s.length>0){const t=a.info(s,o,i),n=a.sort(t,o,i);for(const r of n)l.push(e[t.idx[r]])}return t(l)}}},26911(e,t,n){n.d(t,{A:()=>d});var r=n(42918),a=n(87877),o=n(14665),i=n(27868),s=n(99226);function l(e){return s.types.model("PluginStoreModel",{id:i.K,type:s.types.literal("PluginStoreWidget"),filterText:"",view:s.types.safeReference(e.pluggableMstType("view","stateModel"))}).actions(e=>({clearFilterText(){e.filterText=""},setFilterText(t){e.filterText=t}}))}const c=(0,a.S7)("PluginStoreWidget",{});function d(e){e.addWidgetType(()=>new o.A({name:"PluginStoreWidget",heading:"Plugin store",configSchema:c,stateModel:l(e),ReactComponent:(0,r.lazy)(()=>Promise.all([n.e(2687),n.e(8163)]).then(n.bind(n,98163)))}))}},26931(e,t,n){function r(e){return 0===e.byteLength}function a(e){return null!==e&&"object"==typeof e&&"number"==typeof e.byteLength}function o(e){const t=[],{imageData:n,flatbush:o,subfeatureFlatbush:i}=e;return"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap&&t.push(n),a(o)&&(r(o)?console.warn("flatbush buffer is already detached, cannot transfer"):t.push(o)),a(i)&&(r(i)?console.warn("subfeatureFlatbush buffer is already detached, cannot transfer"):t.push(i)),t}n.d(t,{X:()=>o,p:()=>r})},27351(e,t,n){n.d(t,{A:()=>f});var r=n(30936),a=n(42918),o=n(2462),i=n(13363),s=n(27607),l=n(74919),c=n(65045),d=n(32118);const u=(0,c.n)()(e=>({bg:{padding:4,margin:4,overflow:"auto",maxHeight:200,background:"dark"===e.palette.mode?"#833":"#f88",border:`1px solid ${e.palette.divider}`}}));function p(e){const t=(0,r.c)(3),{children:n}=e,{classes:a}=u();let o;return t[0]!==n||t[1]!==a.bg?(o=(0,d.jsx)("div",{className:a.bg,children:n}),t[0]=n,t[1]=a.bg,t[2]=o):o=t[2],o}const h=(0,a.lazy)(()=>Promise.all([n.e(9011),n.e(7258)]).then(n.bind(n,87258))),g=(0,c.n)()(e=>({bg:{background:e.palette.divider,border:"1px solid black",margin:20},iconFloat:{float:"right",marginLeft:100}}));function m(e){const t=(0,r.c)(12),{error:n,onReset:c}=e,{classes:u}=g(),[p,m]=(0,a.useState)(!1);let f,y,b,w;return t[0]!==n?(f="object"==typeof n&&n&&"stack"in n?(0,d.jsx)(s.A,{title:"Get stack trace",children:(0,d.jsx)(l.A,{onClick:()=>{m(!0)},color:"primary",children:(0,d.jsx)(i.A,{})})}):null,t[0]=n,t[1]=f):f=t[1],t[2]!==c?(y=c?(0,d.jsx)(s.A,{title:"Retry",children:(0,d.jsx)(l.A,{onClick:c,color:"primary",children:(0,d.jsx)(o.A,{})})}):null,t[2]=c,t[3]=y):y=t[3],t[4]!==n||t[5]!==p?(b=p?(0,d.jsx)(a.Suspense,{fallback:null,children:(0,d.jsx)(h,{error:n,onClose:()=>{m(!1)}})}):null,t[4]=n,t[5]=p,t[6]=b):b=t[6],t[7]!==u.iconFloat||t[8]!==f||t[9]!==y||t[10]!==b?(w=(0,d.jsxs)("div",{className:u.iconFloat,children:[f,y,b]}),t[7]=u.iconFloat,t[8]=f,t[9]=y,t[10]=b,t[11]=w):w=t[11],w}const f=function(e){const t=(0,r.c)(8),{error:n,onReset:a}=e,{classes:o}=g(),i=`${n}`;let s;if(t[0]!==o||t[1]!==n||t[2]!==a||t[3]!==i){const e=i.indexOf("expected an instance of"),r=-1!==e?i.slice(0,e):i,l=function(e){let t="";const n=e.indexOf("is not assignable");if(-1!==n){const r=e.slice(0,n+17),a=/.*at path "(.*)" snapshot `(.*)` is not assignable/m.exec(r);a&&(e=`Failed to load element at ${a[1]}...Failed element had snapshot`,t=a[2]);const o=/.*snapshot `(.*)` is not assignable/.exec(r);o&&(e="Failed to load element...Failed element had snapshot",t=o[1])}return t}(i);let c;t[5]!==n||t[6]!==a?(c=(0,d.jsx)(m,{error:n,onReset:a}),t[5]=n,t[6]=a,t[7]=c):c=t[7],s=(0,d.jsxs)(p,{children:[r.slice(0,1e4),c,l?(0,d.jsx)("pre",{className:o.bg,children:JSON.stringify(JSON.parse(l),null,2)}):null]}),t[0]=o,t[1]=n,t[2]=a,t[3]=i,t[4]=s}else s=t[4];return s}},27535(e,t,n){n.r(t),n.d(t,{WIGGLE_CLIP_HEIGHT:()=>y,WIGGLE_COLOR_DEFAULT:()=>l,WIGGLE_FUDGE_FACTOR:()=>f,YSCALEBAR_LABEL_OFFSET:()=>s,fillRectCtx:()=>w,getColorCallback:()=>c,getNiceDomain:()=>p,getOrigin:()=>u,getScale:()=>d,getScaleValues:()=>b,round:()=>m,serializeWiggleFeature:()=>g,toP:()=>h});var r=n(11259),a=n(85512),o=n(36790),i=n(86272);const s=5,l="#f0f";function c(e,t){const n=(0,r.QZ)(e,"color"),a=e.color?.isCallback;if(a)return t=>(0,r.QZ)(e,"color",{feature:t});if(n!==l)return()=>n;if(t?.defaultColor)return()=>t.defaultColor;const o=(0,r.QZ)(e,"bicolorPivotValue"),i=(0,r.QZ)(e,"negColor"),s=(0,r.QZ)(e,"posColor");return(e,t)=>t<o?i:s}function d({domain:e,range:t,scaleType:n,pivotValue:r,inverted:s}){let l;const[c,d]=e;if(void 0===c||void 0===d)throw new Error("invalid domain");if("linear"===n)l=(0,a.A)();else if("log"===n)l=(0,o.A)().base(2);else{if("quantize"!==n)throw new Error("undefined scaleType");l=(0,i.A)()}l.domain(void 0!==r?[c,r,d]:[c,d]),l.nice();const[u,p]=t;if(void 0===u||void 0===p)throw new Error("invalid range");return l.range(s?t.slice().reverse():t),l}function u(e){return"log"===e?1:0}function p({scaleType:e,domain:t,bounds:n}){const[r,s]=n;let[l,c]=t;"linear"===e&&(c<0&&(c=0),l>0&&(l=0)),"log"===e&&l>=0&&c>1&&(l=1),void 0!==r&&r!==Number.MIN_VALUE&&(l=r),void 0!==s&&s!==Number.MAX_VALUE&&(c=s);const d=(e=>{if("linear"===e)return(0,a.A)();if("log"===e){const e=(0,o.A)();return e.base(2),e}if("quantize"===e)return(0,i.A)();throw new Error(`undefined scaleType ${e}`)})(e);return d.domain([l,c]),d.nice(),d.domain()}function h(e=0){return+e.toPrecision(6)}function g(e){return{uniqueId:e.id(),start:e.get("start"),end:e.get("end"),score:e.get("score"),source:e.get("source"),refName:e.get("refName"),maxScore:e.get("maxScore"),minScore:e.get("minScore"),summary:e.get("summary")}}function m(e){return Math.round(1e5*e)/1e5}const f=.3,y=2;function b(e,t){const n=d({...e,range:[0,t]}).domain(),r=n[0],a=n[1],o=a-r,i="log"===e.scaleType,s=0!==o?t/o:0,l=Math.log(2),c=Math.log(r)/l,u=Math.log(a)/l-c;return{niceMin:r,niceMax:a,height:t,linearRatio:s,log2:l,logMin:c,logRatio:0!==u?t/u:0,isLog:i}}function w(e,t,n,r,a,o){n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),o&&(a.fillStyle=o),a.fillRect(e,t,n,r)}},27768(e,t,n){n.d(t,{A:()=>g});var r=n(11259),a=n(77251),o=n(99226),i=n(38567),s=n(8201),l=n(15705),c=n(65525),d=n(64074),u=n(82947),p=n(32118);const h=(0,d.observer)(function({model:e}){const{regionTooLargeReason:t}=e;return(0,p.jsx)(u.A,{severity:"warning",action:(0,p.jsx)(c.A,{onClick:()=>{(0,o.isAlive)(e)&&(e.setFeatureDensityStatsLimit(e.featureDensityStats),e.reload())},children:"Force load"}),message:[t,"Zoom in to see features or force load (may be slow)"].filter(e=>!!e).join(". ")})});function g(){return o.types.model({userBpPerPxLimit:o.types.maybe(o.types.number),userByteSizeLimit:o.types.maybe(o.types.number)}).volatile(()=>({featureDensityStatsP:void 0,featureDensityStats:void 0,currStatsBpPerPx:0})).views(e=>({get currentBytesRequested(){return e.featureDensityStats?.bytes||0},get currentFeatureScreenDensity(){const t=(0,a.getContainingView)(e);return(e.featureDensityStats?.featureDensity||0)*t.bpPerPx},get maxFeatureScreenDensity(){return(0,r.FI)(e,"maxFeatureScreenDensity")},get featureDensityStatsReady(){const t=(0,a.getContainingView)(e);return!(e.currStatsBpPerPx!==t.bpPerPx||!e.featureDensityStats&&!e.userBpPerPxLimit)},get maxAllowableBytes(){return e.userByteSizeLimit||e.featureDensityStats?.fetchSizeLimit||(0,r.FI)(e,"fetchSizeLimit")}})).actions(e=>({afterAttach(){(0,o.addDisposer)(e,(0,i.autorun)(()=>async function(e){try{const t=(0,a.getContainingView)(e);if(!t.initialized||!t.staticBlocks.contentBlocks.length||t.bpPerPx===e.currStatsBpPerPx||e.error)return;if(void 0!==e.featureDensityStats?.featureDensity)return void e.setCurrStatsBpPerPx(t.bpPerPx);e.clearFeatureDensityStats(),e.setCurrStatsBpPerPx(t.bpPerPx);const n=await e.getFeatureDensityStats();(0,o.isAlive)(e)&&e.setFeatureDensityStats(n)}catch(t){console.error(t),(0,o.isAlive)(e)&&!(0,s.Kp)(t)&&e.setError(t)}}(e)))}})).actions(e=>({setCurrStatsBpPerPx(t){e.currStatsBpPerPx=t},setFeatureDensityStatsLimit(t){const n=(0,a.getContainingView)(e);t?.bytes?e.userByteSizeLimit=t.bytes:e.userBpPerPxLimit=n.bpPerPx},getFeatureDensityStats(){return e.featureDensityStatsP||(e.featureDensityStatsP=(0,l.bf)(e).catch(t=>{throw(0,o.isAlive)(e)&&this.setFeatureDensityStatsP(void 0),t})),e.featureDensityStatsP},setFeatureDensityStatsP(t){e.featureDensityStatsP=t},setFeatureDensityStats(t){e.featureDensityStats=t},clearFeatureDensityStats(){e.featureDensityStatsP=void 0,e.featureDensityStats=void 0}})).views(e=>({get regionTooLarge(){const t=(0,a.getContainingView)(e);return!(!e.featureDensityStatsReady||t.dynamicBlocks.totalBp<2e4)&&(e.currentBytesRequested>e.maxAllowableBytes||(e.userBpPerPxLimit?t.bpPerPx>e.userBpPerPxLimit:e.currentFeatureScreenDensity>e.maxFeatureScreenDensity))},get regionTooLargeReason(){const t=e.currentBytesRequested,n=e.maxAllowableBytes;return t&&t>n?`Requested too much data (${(0,l.W7)(t)})`:""}})).views(e=>({get featureDensityStatsReadyAndRegionNotTooLarge(){return e.featureDensityStatsReady&&!e.regionTooLarge},regionCannotBeRenderedText:t=>e.regionTooLarge?"Force load to see features":"",regionCannotBeRendered:t=>e.regionTooLarge?(0,p.jsx)(h,{model:e}):null}))}},27868(e,t,n){n.d(t,{K:()=>i,w:()=>o});var r=n(99226),a=n(44068);function o(){return(0,a.Ak)(10)}const i=r.types.optional(r.types.identifier,o)},28397(e,t,n){n.d(t,{A:()=>c});var r=n(30936),a=n(42918),o=n(51800),i=n(65045),s=n(32118);const l=(0,i.n)()({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}}),c=function(e){const t=(0,r.c)(24);let n,i,c,d,u,p;t[0]!==e?(({onDrag:n,vertical:u,flexbox:p,className:c,onMouseDown:i,...d}=e),t[0]=e,t[1]=n,t[2]=i,t[3]=c,t[4]=d,t[5]=u,t[6]=p):(n=t[1],i=t[2],c=t[3],d=t[4],u=t[5],p=t[6]);const h=void 0!==u&&u,g=void 0!==p&&p,[m,f]=(0,a.useState)(!1),y=(0,a.useRef)(0),b=(0,a.useRef)(0),{classes:w}=l();let v;t[7]!==h?(v=e=>h?e.clientX:e.clientY,t[7]=h,t[8]=v):v=t[8];const S=v;let k,x,C;t[9]!==S||t[10]!==m||t[11]!==n?(k=()=>{if(!m)return;const e=function(e){e.preventDefault();const t=S(e),r=y.current-t,a=t-b.current;b.current=t,n(a,r)},t=function(){f(!1)};return window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",t,!0),()=>{window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",t,!0)}},x=[m,n,S],t[9]=S,t[10]=m,t[11]=n,t[12]=k,t[13]=x):(k=t[12],x=t[13]),(0,a.useEffect)(k,x),t[14]!==S||t[15]!==i?(C=e=>{e.preventDefault();const t=S(e);y.current=t,b.current=t,f(!0),i?.(e)},t[14]=S,t[15]=i,t[16]=C):C=t[16];const T=C,A=g?h?w.flexbox_verticalHandle:w.flexbox_horizontalHandle:h?w.verticalHandle:w.horizontalHandle;let M,P;return t[17]!==A||t[18]!==c?(M=(0,o.cx)(c,A),t[17]=A,t[18]=c,t[19]=M):M=t[19],t[20]!==T||t[21]!==d||t[22]!==M?(P=(0,s.jsx)("div",{"data-resizer":"true",onMouseDown:T,className:M,...d}),t[20]=T,t[21]=d,t[22]=M,t[23]=P):P=t[23],P}},28423(e,t,n){n.d(t,{Jy:()=>s.getSerializedSvg,MD:()=>c,aE:()=>l,u1:()=>i.u});var r=n(30936),a=n(42918),o=n(32118),i=n(83640),s=n(30713);function l(e){const t=(0,r.c)(3),{rendering:n}=e;let i;return t[0]!==n.html||t[1]!==n.reactElement?(i=(0,a.isValidElement)(n.reactElement)?n.reactElement:(0,o.jsx)("g",{dangerouslySetInnerHTML:{__html:n.html||""}}),t[0]=n.html,t[1]=n.reactElement,t[2]=i):i=t[2],i}async function c(e,t,r){if(e.canvasRecordedData&&!e.html){const{getSerializedSvg:a}=await Promise.resolve().then(n.bind(n,30713)),o=await a({width:t,height:r,canvasRecordedData:e.canvasRecordedData});return{...e,html:o}}return e}},28788(e,t,n){n.r(t),n.d(t,{default:()=>h});var r=n(30936),a=n(42918),o=n(77251),i=n(65045),s=n(15943),l=n(1591),c=n(27607),d=n(32118);function u(e){const t=(0,r.c)(8),{anchorEl:n,side:a,text:o}=e,i="left"===a?"left-start":"right-start";let s,l,u,p;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s=[{name:"offset",options:{offset:[-30,-10]}}],t[0]=s):s=t[0],t[1]!==n?(l={popper:{anchorEl:n,modifiers:s}},t[1]=n,t[2]=l):l=t[2],t[3]===Symbol.for("react.memo_cache_sentinel")?(u=(0,d.jsx)("span",{}),t[3]=u):u=t[3],t[4]!==i||t[5]!==l||t[6]!==o?(p=(0,d.jsx)(c.A,{title:o,open:!0,placement:i,slotProps:l,children:u}),t[4]=i,t[5]=l,t[6]=o,t[7]=p):p=t[7],p}const p=(0,i.n)()(e=>{const{tertiary:t}=e.palette;return{rubberband:{height:"100%",background:(0,s.X4)(t.light,.7),position:"absolute",left:0,zIndex:830,textAlign:"center",cursor:"crosshair"},rubberbandText:{color:e.palette.tertiary.contrastText}}});function h(e){const t=(0,r.c)(19),{leftBpOffset:n,rightBpOffset:i,numOfBpSelected:s,left:c,width:h,top:g,sticky:m}=e,f=void 0===g?0:g,y=void 0!==m&&m,{classes:b}=p(),[w,v]=(0,a.useState)(null);let S;t[0]!==w||t[1]!==n||t[2]!==i?(S=w?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(u,{side:"left",anchorEl:w,text:(0,o.stringify)(n)}),(0,d.jsx)(u,{side:"right",anchorEl:w,text:(0,o.stringify)(i)})]}):null,t[0]=w,t[1]=n,t[2]=i,t[3]=S):S=t[3];const k=`translateX(${c}px)`;let x,C,T,A;return t[4]!==k||t[5]!==h?(x={transform:k,width:h},t[4]=k,t[5]=h,t[6]=x):x=t[6],t[7]!==b.rubberbandText||t[8]!==s||t[9]!==y||t[10]!==f?(C=s?(0,d.jsx)(l.A,{ref:v,variant:"h6",className:b.rubberbandText,style:{top:f,position:y?"sticky":void 0},children:(0,o.getBpDisplayStr)(s)}):null,t[7]=b.rubberbandText,t[8]=s,t[9]=y,t[10]=f,t[11]=C):C=t[11],t[12]!==b.rubberband||t[13]!==x||t[14]!==C?(T=(0,d.jsx)("div",{className:b.rubberband,style:x,children:C}),t[12]=b.rubberband,t[13]=x,t[14]=C,t[15]=T):T=t[15],t[16]!==S||t[17]!==T?(A=(0,d.jsxs)(d.Fragment,{children:[S,T]}),t[16]=S,t[17]=T,t[18]=A):A=t[18],A}},28874(e,t,n){n.d(t,{A:()=>Fe});var r={};n.r(r),n.d(r,{ConfigurationReference:()=>N.AK,ConfigurationSchema:()=>N.S7,getConf:()=>B.FI,getTypeNamesFromExplicitlyTypedUnion:()=>B.JC,isBareConfigurationSchemaType:()=>B.C$,isConfigurationModel:()=>B.wo,isConfigurationSchemaType:()=>B.oG,isConfigurationSlotType:()=>B.Rg,readConfObject:()=>B.QZ});var a={};n.r(a),n.d(a,{BaseAdapter:()=>V.D,BaseFeatureDataAdapter:()=>z.L,BaseSequenceAdapter:()=>j.Q,isFeatureAdapter:()=>E.c7,isRefNameAliasAdapter:()=>E.iD,isRegionsAdapter:()=>E.DD,isSequenceAdapter:()=>E.z_,isTextSearchAdapter:()=>E.V0});var o={};n.r(o),n.d(o,{BaseConnectionModelFactory:()=>K.A,BaseDisplay:()=>Y.q,BaseInternetAccountConfig:()=>ee.y,BaseViewModel:()=>Q.A,InternetAccount:()=>Z.X,baseConnectionConfig:()=>X.A,createBaseTrackConfig:()=>ne.J,createBaseTrackModel:()=>te.E});var i={};n.r(i),n.d(i,{AdapterType:()=>H.A,AddTrackWorkflowType:()=>le.A,BaseConnectionModelFactory:()=>K.A,BaseDisplay:()=>Y.q,BaseInternetAccountConfig:()=>ee.y,BaseViewModel:()=>Q.A,BoxRendererType:()=>W.default,CircularChordRendererType:()=>U.A,ConnectionType:()=>ae.A,DisplayType:()=>_.A,FeatureRendererType:()=>q.default,GlyphType:()=>ie.A,InternetAccount:()=>Z.X,InternetAccountType:()=>oe.A,RendererType:()=>re.default,RpcMethodType:()=>se.A,ServerSideRendererType:()=>J.default,TextSearchAdapterType:()=>ce.A,TrackType:()=>O.A,ViewType:()=>$.A,WidgetType:()=>G.A,baseConnectionConfig:()=>X.A,createBaseTrackConfig:()=>ne.J,createBaseTrackModel:()=>te.E});var s={};n.r(s),n.d(s,{GranularRectLayout:()=>fe.A,MultiLayout:()=>ye.A,PileupLayout:()=>be.A,PrecomputedLayout:()=>we.A,SceneGraph:()=>ve});var l=n(42918),c=n.t(l,2),d=n(99226),u=n(33579),p=n(15943),h=n(88050),g=n(55277),m=n(7262),f=n(17447),y=n(56345),b=n(44376),w=n(38567),v=n(64074),S=n(32118),k=n.t(S,2),x=n(12205),C=n.t(x,2),T=n(10998),A=n.t(T,2),M=n(54351),P=n(30936);function I(e,t=""){return Object.fromEntries(Object.entries(e).map(([e,n])=>function(e,t){const n=(0,l.forwardRef)((e,n)=>{const r=(0,P.c)(3);let a;return r[0]!==e||r[1]!==n?(a=(0,S.jsx)(l.Suspense,{fallback:null,children:(0,S.jsx)(t,{...e,ref:n})}),r[0]=e,r[1]=n,r[2]=a):a=r[2],a});return n.displayName=e,[e,n]}(`${t}${e}`,n)))}const R=I({Attributes:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8507),n.e(8769),n.e(9335)]).then(n.bind(n,58769))),FeatureDetails:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(9764)]).then(n.bind(n,59650))),BaseCard:(0,l.lazy)(()=>Promise.all([n.e(2687),n.e(4456)]).then(n.bind(n,34456))),BaseAttributes:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(5727)]).then(n.bind(n,56121))),BaseCoreDetails:(0,l.lazy)(()=>Promise.all([n.e(2687),n.e(7785)]).then(n.bind(n,57785)))},"@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail/"),L={DataGrid:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.DataGrid}))),GridActionsCellItem:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridActionsCellItem}))),GridAddIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridAddIcon}))),GridArrowDownwardIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridArrowDownwardIcon}))),GridArrowUpwardIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridArrowUpwardIcon}))),GridCellCheckboxForwardRef:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridCellCheckboxForwardRef}))),GridCellCheckboxRenderer:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridCellCheckboxRenderer}))),GridCheckCircleIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridCheckCircleIcon}))),GridCheckIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridCheckIcon}))),GridCloseIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridCloseIcon}))),GridColumnHeaderSeparator:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridColumnHeaderSeparator}))),GridColumnHeaderSortIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridColumnHeaderSortIcon}))),GridColumnIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridColumnIcon}))),GridColumnMenu:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridColumnMenu}))),GridColumnMenuContainer:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridColumnMenuContainer}))),GridDragIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridDragIcon}))),GridExpandMoreIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridExpandMoreIcon}))),GridFilterAltIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFilterAltIcon}))),GridFilterForm:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFilterForm}))),GridFilterListIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFilterListIcon}))),GridFilterPanel:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFilterPanel}))),GridFooter:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFooter}))),GridFooterContainer:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridFooterContainer}))),GridHeader:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridHeader}))),GridHeaderCheckbox:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridHeaderCheckbox}))),GridKeyboardArrowRight:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridKeyboardArrowRight}))),GridLoadIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridLoadIcon}))),GridLoadingOverlay:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridLoadingOverlay}))),GridMenuIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridMenuIcon}))),GridMoreVertIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridMoreVertIcon}))),GridNoRowsOverlay:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridNoRowsOverlay}))),GridOverlay:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridOverlay}))),GridPagination:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridPagination}))),GridPanel:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridPanel}))),GridPanelWrapper:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridPanelWrapper}))),GridRemoveIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridRemoveIcon}))),GridRoot:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridRoot}))),GridRowCount:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridRowCount}))),GridSearchIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridSearchIcon}))),GridSelectedRowCount:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridSelectedRowCount}))),GridSeparatorIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridSeparatorIcon}))),GridTableRowsIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridTableRowsIcon}))),GridToolbarExportContainer:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridToolbarExportContainer}))),GridTripleDotsVerticalIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridTripleDotsVerticalIcon}))),GridViewHeadlineIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridViewHeadlineIcon}))),GridViewStreamIcon:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8390),n.e(8033)]).then(n.bind(n,59410)).then(e=>({default:e.GridViewStreamIcon})))},F={Accordion:(0,l.lazy)(()=>Promise.all([n.e(2687),n.e(1641)]).then(n.bind(n,31641))),AccordionActions:(0,l.lazy)(()=>n.e(4496).then(n.bind(n,34496))),AccordionDetails:(0,l.lazy)(()=>n.e(2121).then(n.bind(n,62121))),AccordionSummary:(0,l.lazy)(()=>n.e(9267).then(n.bind(n,29267))),Alert:(0,l.lazy)(()=>n.e(2641).then(n.bind(n,52641))),AlertTitle:(0,l.lazy)(()=>n.e(3630).then(n.bind(n,33630))),Autocomplete:(0,l.lazy)(()=>n.e(4917).then(n.bind(n,94917))),Avatar:(0,l.lazy)(()=>n.e(4244).then(n.bind(n,54244))),AvatarGroup:(0,l.lazy)(()=>n.e(8726).then(n.bind(n,98726))),Backdrop:(0,l.lazy)(()=>n.e(2699).then(n.bind(n,12699))),Badge:(0,l.lazy)(()=>n.e(1600).then(n.bind(n,11600))),Box:(0,l.lazy)(()=>n.e(2430).then(n.bind(n,22430))),Breadcrumbs:(0,l.lazy)(()=>n.e(2214).then(n.bind(n,72214))),Button:(0,l.lazy)(()=>n.e(8417).then(n.bind(n,58417))),ButtonGroup:(0,l.lazy)(()=>n.e(86).then(n.bind(n,10086))),Card:(0,l.lazy)(()=>n.e(7259).then(n.bind(n,77259))),CardActions:(0,l.lazy)(()=>n.e(7222).then(n.bind(n,47222))),CardActionArea:(0,l.lazy)(()=>n.e(1260).then(n.bind(n,11260))),CardContent:(0,l.lazy)(()=>n.e(5168).then(n.bind(n,95168))),CardHeader:(0,l.lazy)(()=>n.e(9066).then(n.bind(n,49066))),CardMedia:(0,l.lazy)(()=>n.e(5235).then(n.bind(n,95235))),CircularProgress:(0,l.lazy)(()=>n.e(8663).then(n.bind(n,98663))),Collapse:(0,l.lazy)(()=>n.e(3522).then(n.bind(n,73522))),ClickAwayListener:(0,l.lazy)(()=>n.e(4805).then(n.bind(n,74805))),Chip:(0,l.lazy)(()=>n.e(5107).then(n.bind(n,5107))),Checkbox:(0,l.lazy)(()=>n.e(2112).then(n.bind(n,2112))),Container:(0,l.lazy)(()=>n.e(9353).then(n.bind(n,49353))),Dialog:(0,l.lazy)(()=>n.e(5025).then(n.bind(n,85025))),DialogActions:(0,l.lazy)(()=>n.e(8944).then(n.bind(n,38944))),DialogTitle:(0,l.lazy)(()=>n.e(8397).then(n.bind(n,88397))),DialogContent:(0,l.lazy)(()=>n.e(6202).then(n.bind(n,86202))),DialogContentText:(0,l.lazy)(()=>n.e(9021).then(n.bind(n,19021))),Divider:(0,l.lazy)(()=>n.e(4770).then(n.bind(n,64770))),Drawer:(0,l.lazy)(()=>n.e(9269).then(n.bind(n,29269))),Fab:(0,l.lazy)(()=>n.e(1266).then(n.bind(n,91266))),Fade:(0,l.lazy)(()=>n.e(9159).then(n.bind(n,99159))),FilledInput:(0,l.lazy)(()=>n.e(6027).then(n.bind(n,36027))),FormLabel:(0,l.lazy)(()=>n.e(2395).then(n.bind(n,32395))),FormControl:(0,l.lazy)(()=>n.e(7256).then(n.bind(n,87256))),FormControlLabel:(0,l.lazy)(()=>n.e(4674).then(n.bind(n,64674))),FormHelperText:(0,l.lazy)(()=>n.e(5596).then(n.bind(n,5596))),FormGroup:(0,l.lazy)(()=>n.e(1034).then(n.bind(n,51034))),Grid:(0,l.lazy)(()=>Promise.all([n.e(2913),n.e(1942)]).then(n.bind(n,51942))),Grid2:(0,l.lazy)(()=>Promise.all([n.e(2913),n.e(1942)]).then(n.bind(n,51942))),Grow:(0,l.lazy)(()=>n.e(5118).then(n.bind(n,75118))),Icon:(0,l.lazy)(()=>n.e(1279).then(n.bind(n,91279))),IconButton:(0,l.lazy)(()=>n.e(284).then(n.bind(n,284))),Input:(0,l.lazy)(()=>n.e(2471).then(n.bind(n,22471))),InputBase:(0,l.lazy)(()=>n.e(9170).then(n.bind(n,69170))),InputLabel:(0,l.lazy)(()=>n.e(3231).then(n.bind(n,25612))),InputAdornment:(0,l.lazy)(()=>n.e(2055).then(n.bind(n,62055))),Link:(0,l.lazy)(()=>n.e(5633).then(n.bind(n,55633))),LinearProgress:(0,l.lazy)(()=>n.e(8799).then(n.bind(n,78799))),List:(0,l.lazy)(()=>n.e(3273).then(n.bind(n,23273))),ListItem:(0,l.lazy)(()=>n.e(5662).then(n.bind(n,65662))),ListItemAvatar:(0,l.lazy)(()=>n.e(8987).then(n.bind(n,58987))),ListItemButton:(0,l.lazy)(()=>n.e(2958).then(n.bind(n,32958))),ListItemSecondaryAction:(0,l.lazy)(()=>n.e(610).then(n.bind(n,40610))),ListItemIcon:(0,l.lazy)(()=>n.e(3539).then(n.bind(n,43539))),ListSubheader:(0,l.lazy)(()=>n.e(9324).then(n.bind(n,49324))),ListItemText:(0,l.lazy)(()=>n.e(1033).then(n.bind(n,61033))),Menu:(0,l.lazy)(()=>n.e(246).then(n.bind(n,90246))),MenuItem:(0,l.lazy)(()=>n.e(4017).then(n.bind(n,84017))),MenuList:(0,l.lazy)(()=>n.e(8474).then(n.bind(n,8474))),Modal:(0,l.lazy)(()=>n.e(4362).then(n.bind(n,84362))),NativeSelect:(0,l.lazy)(()=>n.e(3448).then(n.bind(n,63448))),OutlinedInput:(0,l.lazy)(()=>n.e(9673).then(n.bind(n,99673))),Pagination:(0,l.lazy)(()=>n.e(6284).then(n.bind(n,46284))),PaginationItem:(0,l.lazy)(()=>n.e(4734).then(n.bind(n,24734))),Paper:(0,l.lazy)(()=>n.e(3297).then(n.bind(n,53297))),Popover:(0,l.lazy)(()=>n.e(7166).then(n.bind(n,37166))),Popper:(0,l.lazy)(()=>n.e(3627).then(n.bind(n,73627))),Portal:(0,l.lazy)(()=>n.e(7055).then(n.bind(n,77055))),Radio:(0,l.lazy)(()=>n.e(3740).then(n.bind(n,13740))),RadioGroup:(0,l.lazy)(()=>n.e(6115).then(n.bind(n,46115))),Rating:(0,l.lazy)(()=>n.e(9024).then(n.bind(n,69024))),ScopedCssBaseline:(0,l.lazy)(()=>n.e(5971).then(n.bind(n,85971))),Select:(0,l.lazy)(()=>n.e(3261).then(n.bind(n,63261))),Skeleton:(0,l.lazy)(()=>n.e(1458).then(n.bind(n,51458))),Slider:(0,l.lazy)(()=>n.e(3188).then(n.bind(n,93188))),Snackbar:(0,l.lazy)(()=>Promise.all([n.e(2830),n.e(2118)]).then(n.bind(n,12118))),SnackbarContent:(0,l.lazy)(()=>n.e(8679).then(n.bind(n,38679))),SpeedDial:(0,l.lazy)(()=>n.e(5397).then(n.bind(n,45397))),SpeedDialAction:(0,l.lazy)(()=>n.e(162).then(n.bind(n,70162))),SpeedDialIcon:(0,l.lazy)(()=>n.e(7241).then(n.bind(n,37241))),Stack:(0,l.lazy)(()=>n.e(8853).then(n.bind(n,38853))),Step:(0,l.lazy)(()=>n.e(9699).then(n.bind(n,59699))),StepButton:(0,l.lazy)(()=>n.e(9659).then(n.bind(n,19659))),StepConnector:(0,l.lazy)(()=>n.e(118).then(n.bind(n,60118))),StepLabel:(0,l.lazy)(()=>n.e(8379).then(n.bind(n,98379))),StepIcon:(0,l.lazy)(()=>n.e(642).then(n.bind(n,50642))),Stepper:(0,l.lazy)(()=>n.e(3218).then(n.bind(n,3218))),SvgIcon:(0,l.lazy)(()=>n.e(2500).then(n.bind(n,42500))),Switch:(0,l.lazy)(()=>n.e(9833).then(n.bind(n,9833))),Tab:(0,l.lazy)(()=>n.e(8700).then(n.bind(n,78700))),Table:(0,l.lazy)(()=>n.e(435).then(n.bind(n,70435))),TableBody:(0,l.lazy)(()=>n.e(4203).then(n.bind(n,24203))),TableCell:(0,l.lazy)(()=>n.e(2151).then(n.bind(n,82151))),TableContainer:(0,l.lazy)(()=>n.e(5529).then(n.bind(n,67910))),TableFooter:(0,l.lazy)(()=>n.e(1107).then(n.bind(n,81107))),TableHead:(0,l.lazy)(()=>n.e(773).then(n.bind(n,40773))),TablePagination:(0,l.lazy)(()=>Promise.all([n.e(4138),n.e(1664)]).then(n.bind(n,17199))),TableRow:(0,l.lazy)(()=>n.e(6277).then(n.bind(n,26277))),TableSortLabel:(0,l.lazy)(()=>n.e(5678).then(n.bind(n,73297))),Tabs:(0,l.lazy)(()=>Promise.all([n.e(9916),n.e(949)]).then(n.bind(n,80949))),TextField:(0,l.lazy)(()=>n.e(6758).then(n.bind(n,86758))),TextareaAutosize:(0,l.lazy)(()=>n.e(1321).then(n.bind(n,81321))),ToggleButton:(0,l.lazy)(()=>n.e(7169).then(n.bind(n,17169))),ToggleButtonGroup:(0,l.lazy)(()=>n.e(3944).then(n.bind(n,13944))),Toolbar:(0,l.lazy)(()=>n.e(9288).then(n.bind(n,69288))),Tooltip:(0,l.lazy)(()=>n.e(7464).then(n.bind(n,67464))),Typography:(0,l.lazy)(()=>n.e(8580).then(n.bind(n,8580)))},D=["mobx","@jbrowse/mobx-state-tree","mobx-state-tree","react","react/jsx-runtime","react-dom","react-dom/client","mobx-react","@mui/x-data-grid","@mui/material/utils","@material-ui/core/utils","tss-react","tss-react/mui","@material-ui/core","@mui/material","@mui/material/styles","@material-ui/core/styles","@material-ui/core/Accordion","@material-ui/core/AccordionActions","@material-ui/core/AccordionDetails","@material-ui/core/AccordionSummary","@material-ui/core/Alert","@material-ui/core/AlertTitle","@material-ui/core/Autocomplete","@material-ui/core/Avatar","@material-ui/core/AvatarGroup","@material-ui/core/Backdrop","@material-ui/core/Badge","@material-ui/core/Box","@material-ui/core/Breadcrumbs","@material-ui/core/Button","@material-ui/core/ButtonGroup","@material-ui/core/Card","@material-ui/core/CardActions","@material-ui/core/CardActionArea","@material-ui/core/CardContent","@material-ui/core/CardHeader","@material-ui/core/CardMedia","@material-ui/core/CircularProgress","@material-ui/core/Collapse","@material-ui/core/ClickAwayListener","@material-ui/core/Chip","@material-ui/core/Checkbox","@material-ui/core/Container","@material-ui/core/Dialog","@material-ui/core/DialogActions","@material-ui/core/DialogTitle","@material-ui/core/DialogContent","@material-ui/core/DialogContentText","@material-ui/core/Divider","@material-ui/core/Drawer","@material-ui/core/Fab","@material-ui/core/Fade","@material-ui/core/FilledInput","@material-ui/core/FormLabel","@material-ui/core/FormControl","@material-ui/core/FormControlLabel","@material-ui/core/FormHelperText","@material-ui/core/FormGroup","@material-ui/core/Grid","@material-ui/core/Grid2","@material-ui/core/Grow","@material-ui/core/Icon","@material-ui/core/IconButton","@material-ui/core/Input","@material-ui/core/InputBase","@material-ui/core/InputLabel","@material-ui/core/InputAdornment","@material-ui/core/Link","@material-ui/core/LinearProgress","@material-ui/core/List","@material-ui/core/ListItem","@material-ui/core/ListItemAvatar","@material-ui/core/ListItemButton","@material-ui/core/ListItemSecondaryAction","@material-ui/core/ListItemIcon","@material-ui/core/ListSubheader","@material-ui/core/ListItemText","@material-ui/core/Menu","@material-ui/core/MenuItem","@material-ui/core/MenuList","@material-ui/core/Modal","@material-ui/core/NativeSelect","@material-ui/core/OutlinedInput","@material-ui/core/Pagination","@material-ui/core/PaginationItem","@material-ui/core/Paper","@material-ui/core/Popover","@material-ui/core/Popper","@material-ui/core/Portal","@material-ui/core/Radio","@material-ui/core/RadioGroup","@material-ui/core/Rating","@material-ui/core/ScopedCssBaseline","@material-ui/core/Select","@material-ui/core/Skeleton","@material-ui/core/Slider","@material-ui/core/Snackbar","@material-ui/core/SnackbarContent","@material-ui/core/SpeedDial","@material-ui/core/SpeedDialAction","@material-ui/core/SpeedDialIcon","@material-ui/core/Stack","@material-ui/core/Step","@material-ui/core/StepButton","@material-ui/core/StepConnector","@material-ui/core/StepLabel","@material-ui/core/StepIcon","@material-ui/core/Stepper","@material-ui/core/SvgIcon","@material-ui/core/Switch","@material-ui/core/Tab","@material-ui/core/Table","@material-ui/core/TableBody","@material-ui/core/TableCell","@material-ui/core/TableContainer","@material-ui/core/TableFooter","@material-ui/core/TableHead","@material-ui/core/TablePagination","@material-ui/core/TableRow","@material-ui/core/TableSortLabel","@material-ui/core/Tabs","@material-ui/core/TextField","@material-ui/core/TextareaAutosize","@material-ui/core/ToggleButton","@material-ui/core/ToggleButtonGroup","@material-ui/core/Toolbar","@material-ui/core/Tooltip","@material-ui/core/Typography","@mui/material/Accordion","@mui/material/AccordionActions","@mui/material/AccordionDetails","@mui/material/AccordionSummary","@mui/material/Alert","@mui/material/AlertTitle","@mui/material/Autocomplete","@mui/material/Avatar","@mui/material/AvatarGroup","@mui/material/Backdrop","@mui/material/Badge","@mui/material/Box","@mui/material/Breadcrumbs","@mui/material/Button","@mui/material/ButtonGroup","@mui/material/Card","@mui/material/CardActions","@mui/material/CardActionArea","@mui/material/CardContent","@mui/material/CardHeader","@mui/material/CardMedia","@mui/material/CircularProgress","@mui/material/Collapse","@mui/material/ClickAwayListener","@mui/material/Chip","@mui/material/Checkbox","@mui/material/Container","@mui/material/Dialog","@mui/material/DialogActions","@mui/material/DialogTitle","@mui/material/DialogContent","@mui/material/DialogContentText","@mui/material/Divider","@mui/material/Drawer","@mui/material/Fab","@mui/material/Fade","@mui/material/FilledInput","@mui/material/FormLabel","@mui/material/FormControl","@mui/material/FormControlLabel","@mui/material/FormHelperText","@mui/material/FormGroup","@mui/material/Grid","@mui/material/Grid2","@mui/material/Grow","@mui/material/Icon","@mui/material/IconButton","@mui/material/Input","@mui/material/InputBase","@mui/material/InputLabel","@mui/material/InputAdornment","@mui/material/Link","@mui/material/LinearProgress","@mui/material/List","@mui/material/ListItem","@mui/material/ListItemAvatar","@mui/material/ListItemButton","@mui/material/ListItemSecondaryAction","@mui/material/ListItemIcon","@mui/material/ListSubheader","@mui/material/ListItemText","@mui/material/Menu","@mui/material/MenuItem","@mui/material/MenuList","@mui/material/Modal","@mui/material/NativeSelect","@mui/material/OutlinedInput","@mui/material/Pagination","@mui/material/PaginationItem","@mui/material/Paper","@mui/material/Popover","@mui/material/Popper","@mui/material/Portal","@mui/material/Radio","@mui/material/RadioGroup","@mui/material/Rating","@mui/material/ScopedCssBaseline","@mui/material/Select","@mui/material/Skeleton","@mui/material/Slider","@mui/material/Snackbar","@mui/material/SnackbarContent","@mui/material/SpeedDial","@mui/material/SpeedDialAction","@mui/material/SpeedDialIcon","@mui/material/Stack","@mui/material/Step","@mui/material/StepButton","@mui/material/StepConnector","@mui/material/StepLabel","@mui/material/StepIcon","@mui/material/Stepper","@mui/material/SvgIcon","@mui/material/Switch","@mui/material/Tab","@mui/material/Table","@mui/material/TableBody","@mui/material/TableCell","@mui/material/TableContainer","@mui/material/TableFooter","@mui/material/TableHead","@mui/material/TablePagination","@mui/material/TableRow","@mui/material/TableSortLabel","@mui/material/Tabs","@mui/material/TextField","@mui/material/TextareaAutosize","@mui/material/ToggleButton","@mui/material/ToggleButtonGroup","@mui/material/Toolbar","@mui/material/Tooltip","@mui/material/Typography","@material-ui/lab/ToggleButton","@material-ui/lab/ToggleButtonGroup","@material-ui/lab/Autocomplete","@material-ui/lab/Alert","@material-ui/lab","@jbrowse/core/Plugin","@jbrowse/core/pluggableElementTypes","@jbrowse/core/pluggableElementTypes/ViewType","@jbrowse/core/pluggableElementTypes/AdapterType","@jbrowse/core/pluggableElementTypes/DisplayType","@jbrowse/core/pluggableElementTypes/TrackType","@jbrowse/core/pluggableElementTypes/WidgetType","@jbrowse/core/pluggableElementTypes/models","@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType","@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType","@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType","@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType","@jbrowse/core/pluggableElementTypes/renderers/RendererType","@jbrowse/core/configuration","@jbrowse/core/util/types/mst","@jbrowse/core/ui","@jbrowse/core/ui/theme","@jbrowse/core/util","@jbrowse/core/util/color","@jbrowse/core/util/layouts","@jbrowse/core/util/tracks","@jbrowse/core/util/Base1DViewModel","@jbrowse/core/util/io","@jbrowse/core/util/mst-reflection","@jbrowse/core/util/rxjs","@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail","@jbrowse/core/data_adapters/BaseAdapter"];var N=n(87877),B=n(11259),E=n(79387),V=n(54523),z=n(48455),j=n(36592),H=n(58946),_=n(61451),O=n(3026),$=n(23460),G=n(14665),W=n(63531),U=n(45912),q=n(18543),J=n(44121),X=n(13861),K=n(89322),Q=n(20637),Y=n(62296),Z=n(1231),ee=n(12197),te=n(75976),ne=n(7062),re=n(20749),ae=n(14261),oe=n(99697),ie=n(48635),se=n(74603),le=n(39494),ce=n(47011),de=n(1821),ue=n(17868),pe=n(68589),he=n(71247),ge=n(77251),me=n(33624),fe=n(49647),ye=n(14800),be=n(45089),we=n(87663);class ve{constructor(e,t,n,r,a,o){this.name=e,this.left=t,this.top=n,this.width=r,this.height=a,this.data=o,this.children=new Map,this.absoluteCache={dirty:!0}}addChild(e,t,n,r,a,o){const i=e instanceof ve?e:new ve(e,t,n,r,a,o);if(!(i instanceof ve))throw new TypeError("argument to addChild must be an array or a SceneGraph");if(this.children.has(i.name))throw new Error(`child named "${i.name}" already exists`);i.parent=this;const{left:s,right:l,top:c,bottom:d}=i.absolute;return void 0!==s&&void 0!==l&&void 0!==c&&void 0!==d&&(this.expand(s,l,c,d),this.children.set(i.name,i)),i}getSubRecord(e){return this.children.get(e)}expand(e,t,n,r){const{left:a,right:o,top:i,bottom:s}=this.absolute;if(void 0!==a&&e<a){const t=a-e;this.width+=t,this.left-=t}if(void 0!==o&&t>o&&(this.width+=t-o),void 0!==i&&n<i){const e=i-n;this.height+=e,this.top-=e}void 0!==s&&r>s&&(this.height+=r-s),this.parent&&this.parent.expand(e,t,n,r),this.absoluteCache.dirty=!0}get bottom(){return this.top+this.height}get right(){return this.left+this.width}walkParents(e){this.parent&&(e(this.parent),this.parent.walkParents(e))}walkChildren(e){for(const t of this.children.values())e(t),t.walkChildren(e)}get absolute(){if(this.absoluteCache.dirty){let e=0,t=0;this.walkParents(n=>{e+=n.left,t+=n.top}),this.absoluteCache={dirty:!1,left:this.left+e,right:this.right+e,top:this.top+t,bottom:this.bottom+t,width:this.width,height:this.height}}return this.absoluteCache}move(e,t){this.left+=e,this.top+=t,this.absoluteCache.dirty=!0,this.walkChildren(e=>{e.absoluteCache.dirty=!0});const{left:n,right:r,top:a,bottom:o}=this.absolute;void 0!==n&&void 0!==r&&void 0!==a&&void 0!==o&&this.expand(n,r,a,o)}}var Se=n(47785),ke=n(86618),xe=n(70203),Ce=n(51800),Te=n(6432),Ae=n(65045),Me=n(67401);const Pe={mobx:w,"@jbrowse/mobx-state-tree":d,"mobx-state-tree":d,react:c,"react/jsx-runtime":k,"react-dom":C,"react-dom/client":A,"mobx-react":v,"@mui/x-data-grid":{useGridApiContext:f.h,useGridApiRef:y.b,useGridRootProps:b.A,...I(L)},"@mui/material/utils":m,"@material-ui/core/utils":m,"tss-react":{cx:Ce.cx,keyframes:Te.i7,makeStyles:Ae.n},"tss-react/mui":{cx:Ce.cx,keyframes:Te.i7,makeStyles:Ae.n},"@material-ui/core":{...I(F),useTheme:u.A,alpha:p.X4,makeStyles:e=>{const t=(0,Ae.n)()(e);return()=>t().classes}},"@mui/material":{...I(F),alpha:p.X4,useTheme:u.A,createTheme:h.A},...I(F,"@mui/material/"),...I(F,"@material-ui/core/"),"@mui/material/styles":{...g,makeStyles:e=>{const t=(0,Ae.n)()(e);return()=>t().classes}},"@material-ui/core/styles":{...g,makeStyles:e=>{const t=(0,Ae.n)()(e);return()=>t().classes}},"@material-ui/lab/ToggleButton":F.ToggleButton,"@material-ui/lab/ToggleButtonGroup":F.ToggleButtonGroup,"@material-ui/lab/Autocomplete":F.Autocomplete,"@material-ui/lab/Alert":F.Alert,"@material-ui/lab":{Alert:F.Alert,Autocomplete:F.Autocomplete,ToggleButton:F.ToggleButton,ToggleButtonGroup:F.ToggleButtonGroup},"@jbrowse/core/Plugin":M.A,"@jbrowse/core/pluggableElementTypes/renderers/RendererType":re,"@jbrowse/core/configuration":r,"@jbrowse/core/util/types/mst":Me,"@jbrowse/core/ui":de,"@jbrowse/core/ui/theme":ue,"@jbrowse/core/util":ge,"@jbrowse/core/util/color":he,"@jbrowse/core/util/layouts":s,"@jbrowse/core/util/tracks":xe,"@jbrowse/core/util/Base1DViewModel":pe.A,"@jbrowse/core/util/io":me,"@jbrowse/core/util/mst-reflection":Se,"@jbrowse/core/util/rxjs":ke,"@jbrowse/core/pluggableElementTypes":i,"@jbrowse/core/pluggableElementTypes/ViewType":$.A,"@jbrowse/core/pluggableElementTypes/AdapterType":H.A,"@jbrowse/core/pluggableElementTypes/DisplayType":_.A,"@jbrowse/core/pluggableElementTypes/TrackType":O.A,"@jbrowse/core/pluggableElementTypes/WidgetType":G.A,"@jbrowse/core/pluggableElementTypes/models":o,"@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType":J,"@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType":U.A,"@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType":W,"@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType":q,"@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail":R,"@jbrowse/core/data_adapters/BaseAdapter":a},Ie=Object.keys(Pe),Re=Ie.filter(e=>!D.includes(e));if(Re.length>0)throw new Error(`The following modules are in the modules libs, but not the re-exports list: ${Re.join(", ")}`);const Le=D.filter(e=>!Ie.includes(e));if(Le.length)throw new Error(`The following modules are in the re-exports list, but not the modules libs: ${Le.join(", ")}`);const Fe=Pe},29463(e,t,n){n.d(t,{OM:()=>o,mJ:()=>i});var r=n(77251);function a(e,t,n,r,a,o){return function(e,t,n,r,a,o){const i=t?.getCanonicalRefName(n)||n,s=e.bpToPx({refName:i,coord:r})?.offsetPx,l=e.bpToPx({refName:i,coord:a})?.offsetPx;if(void 0!==s){const e=void 0!==l?l:s+(a-r)/o;return{leftPx:Math.min(s,e),rightPx:Math.max(s,e)}}if(void 0!==l){const e=l-(a-r)/o;return{leftPx:Math.min(e,l),rightPx:Math.max(e,l)}}}(e,t,n,r,a,o)||function(e,t,n,r,a){const o=t?.getCanonicalRefName(n)||n,i=e.displayedRegions.filter(e=>e.refName===o&&e.start<a&&e.end>r);if(0===i.length)return;let s=1/0,l=-1/0;for(const t of i){const n=Math.max(r,t.start),i=Math.min(a,t.end),c=e.bpToPx({refName:o,coord:n})?.offsetPx,d=e.bpToPx({refName:o,coord:i})?.offsetPx;void 0!==c&&void 0!==d&&(s=Math.min(s,c,d),l=Math.max(l,c,d))}return s!==1/0&&l!==-1/0?{leftPx:s,rightPx:l}:void 0}(e,t,n,r,a)}function o(e,t,n,r){const o=new Map;for(const[i,s]of e.entries()){if(!s?.[4])continue;const[,e,,,l]=s,{refName:c,floatingLabels:d,totalFeatureHeight:u,actualTopPx:p,featureWidth:h,totalLayoutWidth:g,featureStartBp:m,featureEndBp:f}=l,y=p??e;if(!d||0===d.length||!u||void 0===h||void 0===g||void 0===m||void 0===f)continue;const b=a(t,n,c,m,f,r);if(!b)continue;const w=o.get(i);(!w||b.leftPx<w.leftPx)&&o.set(i,{leftPx:b.leftPx,rightPx:b.rightPx,topPx:y,totalFeatureHeight:u,floatingLabels:d,featureWidth:h,totalLayoutWidth:g})}return o}function i(e,t,n,a,o){if(n>t-e)return e-a;const i=Math.max(e,o)-a,s=t-a-n;return(0,r.clamp)(i,0,s)}},29512(e,t,n){n.d(t,{n:()=>l});var r=n(87877),a=n(11259),o=n(70203),i=n(99226),s=n(58730);function l(e){return i.types.compose("LinearBareDisplay",s.L,i.types.model({type:i.types.literal("LinearBareDisplay"),configuration:(0,r.AK)(e)})).views(e=>({get rendererConfig(){return(0,a.FI)(e,["renderer"])||{}},get rendererTypeName(){return(0,a.FI)(e,["renderer","type"])}})).views(e=>{const{renderProps:t}=e;return{renderProps:()=>({...t(),...(0,o.getParentRenderProps)(e),config:e.rendererConfig})}})}},29742(e,t,n){n.d(t,{OX:()=>c,Th:()=>h,_b:()=>l,i0:()=>d,m$:()=>i,u5:()=>s,xx:()=>o,yM:()=>p});var r=n(14157),a=n(19598);const o=16581375,i=3,s=1600;function l(e){return`rgb(${Math.floor(e/65025)%255},${Math.floor(e/255)%255},${e%255})`}function c(e,t,n,r){return Math.floor((255*e*255+255*t+n-1)/r)}function d(e){const t=function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return Math.abs(t)}(e);return r.category10[t%r.category10.length]}const u={I:"#ff03",N:"#0a03",D:"#00f3",X:"brown",M:"#f003","=":"#f003"},p={default:{cigarColors:u},strand:{posColor:"red",negColor:"blue",cigarColors:{I:"#ff03",N:"#a020f0",D:"#a020f0",X:"brown",M:"#f003","=":"#f003"}},query:{cigarColors:u}};function h(e,t){return 1===t?e:(0,a.M)(e).alpha(t).toHex()}},30524(e,t,n){n.d(t,{A:()=>i});var r=n(74603),a=n(77251),o=n(46413);class i extends r.A{async deserializeArguments(e,t){return{...await super.deserializeArguments(e,t),filters:e.filters?new o.A({filters:e.filters}):void 0}}async serializeArguments(e,t){const n=this.pluginManager,r=n.rootModel?.session?.assemblyManager;if(!r)throw new Error("no assembly manager");const o=await(0,a.renameRegionsIfNeeded)(r,{...e,filters:e.filters?.toJSON().filters});return super.serializeArguments(o,t)}}},30713(e,t,n){n.d(t,{getSerializedSvg:()=>a});var r=n(81275);async function a(e){const{width:t,height:a,canvasRecordedData:o}=e,i=new((await n.e(475).then(n.t.bind(n,70475,23))).default)(t,a);return new r.w(o).execute(i),i.getSvg().innerHTML}},33624(e,t,n){n.r(t),n.d(t,{RemoteFileWithRangeCache:()=>s.g,getFetcher:()=>h,openLocation:()=>p,resolveUriLocation:()=>u});var r=n(45136),a=n.n(r),o=n(53221),i=n(4e4),s=n(9255),l=n(77251),c=n(70203),d=n(10525);function u(e){return e.baseUri?{...e,uri:new URL(e.uri,e.baseUri).href}:e}function p(e,t){if(function(e){return"localPath"in e}(e)){if(!e.localPath)throw new Error("No local path provided");if(a()||l.isElectron)return new o.EY(e.localPath);throw new Error("can't use local files in the browser")}if(function(e){return"blobId"in e}(e)){const t=(0,c.getBlob)(e.blobId);if(!t)throw new Error(`file ("${e.name}") was opened locally from a previous session. To restore it, go to track settings and reopen the file`);return new i.A(t)}if((0,d.C1)(e)){if(!e.uri)throw new Error("No URI provided");const n=u(e);if(t){const r=g(e,t);if(r)return r.openLocation(n)}return new s.g(n.uri,{fetch:m})}throw new Error("invalid fileLocation")}function h(e,t){if(!(0,d.C1)(e))throw new Error(`Not a valid UriLocation: ${JSON.stringify(e)}`);if(t){const n=g(e,t);if(n)return n.getFetcher(e)}return m}function g(e,t){const{rootModel:n}=t;if(n&&(0,d.lL)(n))return n.findAppropriateInternetAccount(e);if(e.internetAccountPreAuthorization){if(!e.internetAccountPreAuthorization.authInfo.token)throw new Error("Failed to obtain token from internet account. Try reloading the page");return t.getInternetAccountType(e.internetAccountPreAuthorization.internetAccountType).stateModel.create({type:e.internetAccountPreAuthorization.internetAccountType,configuration:e.internetAccountPreAuthorization.authInfo.configuration})}}async function m(e,t){const n=await fetch(e,t);if(401===n.status&&n.headers.get("WWW-Authenticate")?.includes("Basic"))throw new d._u("Accessing HTTPBasic resource without authentication",e.toString());return n}},34588(e,t,n){n.d(t,{A:()=>o});var r=n(11259),a=n(99226);function o(){return a.types.model({heightPreConfig:a.types.maybe(a.types.refinement("displayHeight",a.types.number,e=>e>=20))}).volatile(()=>({scrollTop:0})).views(e=>({get height(){return e.heightPreConfig??(0,r.FI)(e,"height")}})).actions(e=>({setScrollTop(t){e.scrollTop=t},setHeight:t=>(e.heightPreConfig=Math.max(t,20),e.height),resizeHeight(t){const n=e.height;return this.setHeight(e.height+t)-n}}))}},34592(e,t,n){n.d(t,{A:()=>u});var r=n(42918),a=n(15675),o=n(9625),i=n(64074),s=n(77251),l=n(65045),c=n(32118);const d=(0,l.n)()({importFormEntry:{minWidth:180}}),u=(0,i.observer)(function({session:e,onChange:t,label:n="Assembly",selected:i,InputProps:l,TextFieldProps:u,localStorageKey:p,helperText:h="Select assembly to view"}){const{classes:g}=d(),{assemblyNames:m,assemblyManager:f}=e,y=new URLSearchParams(window.location.search).get("config"),[b,w]=(0,s.useLocalStorage)(`lastAssembly-${[window.location.host+window.location.pathname,y,p].join("-")}`,i,"undefined"==typeof jest&&Boolean(p)),v=m.includes(b||"")?b:i;(0,r.useEffect)(()=>{v&&v!==i&&t(v)},[v,t,i]);const S=m.length?"":"No configured assemblies";return(0,c.jsx)(a.A,{select:!0,"data-testid":"assembly-selector-textfield",label:n,variant:"outlined",helperText:S||h,value:v||"",onChange:e=>{w(e.target.value)},error:!!S,disabled:!!S,className:g.importFormEntry,...u,slotProps:{input:l,htmlInput:{"data-testid":"assembly-selector"}},children:m.map(e=>(0,c.jsx)(o.A,{value:e,children:f.get(e)?.displayName||e},e))})})},35635(e,t,n){n.d(t,{Cu:()=>g,NI:()=>p,R3:()=>d,PC:()=>c,Gl:()=>u,DQ:()=>l,bH:()=>h,eL:()=>o,YJ:()=>s});const r=new RegExp(/(\d+)[SH]$/),a=new RegExp(/^(\d+)([SH])/);function o(e=""){let t="";const n=[];for(let r=0,a=e.length;r<a;r++){const a=e[r];a>="0"&&a<="9"?t+=a:(n.push(t,a),t="")}return n}const i={77:0,73:1,68:2,78:3,83:4,72:5,80:6,61:7,88:8};function s(e=""){let t=0;const n=[];for(let r=0,a=e.length;r<a;r++){const a=e.charCodeAt(r);if(a>=48&&a<=57)t=10*t+(a-48);else{const e=i[a];n.push(t<<4|e),t=0}}return new Uint32Array(n)}function l(e,t,n,r,a){let i=[];const s=o(e);return e&&(i=i.concat(function(e,t,n,r){let a=0,o=0;const i=[],s=n&&t;for(let l=0;l<e.length;l+=2){const c=+e[l],d=e[l+1];if("M"===d||"="===d||"E"===d){if(s)for(let e=0;e<c;e++)(32|t.charCodeAt(o+e))!=(32|n.charCodeAt(a+e))&&i.push({start:a+e,type:"mismatch",base:t[o+e],altbase:n[a+e],length:1});o+=c}if("I"===d)i.push({start:a,type:"insertion",insertlen:c,insertedBases:t?.slice(o,o+c),length:0}),o+=c;else if("D"===d)i.push({start:a,type:"deletion",length:c});else if("N"===d)i.push({start:a,type:"skip",length:c});else if("X"===d){const e=t?.slice(o,o+c)||[],n=r?.subarray(o,o+c)||[];for(let t=0;t<c;t++)i.push({start:a+t,type:"mismatch",base:e[t]||"X",qual:n[t],length:1});o+=c}else"H"===d?i.push({start:a,type:"hardclip",cliplen:c,length:1}):"S"===d&&(i.push({start:a,type:"softclip",cliplen:c,length:1}),o+=c);"I"!==d&&"S"!==d&&"H"!==d&&(a+=c)}return i}(s,n,r,a))),t&&n&&(i=i.concat(function(e,t,n,r,a){const o=[],i=t.length,s=r.length,l=void 0!==a,c=n.length;let d=!1;for(let e=0;e<c;e++)if("skip"===n[e].type){d=!0;break}let u=0,p=0,h=0,g=0,m=0,f=0;const y=e.length;for(;f<y;){const b=e.charCodeAt(f);if(b>=48&&b<=57){let t=0;for(;f<y;){const n=e.charCodeAt(f);if(!(n>=48&&n<=57))break;t=10*t+(n-48),f++}u+=t}else if(94===b){f++;let t=0;for(;f<y;){const n=e.charCodeAt(f);if(!(n>=65&&n<=90))break;t++,f++}u+=t}else if(b>=65&&b<=90){const y=e[f];if(f++,d)for(;m<c;){const e=n[m];if("skip"===e.type&&u>=e.start)u+=e.length,m++;else{if("skip"===e.type)break;m++}}let b=h,w=g;for(let e=p;e<i&&w<=u;e+=2,p=e){const n=+t[e],r=t[e+1];"S"===r||"I"===r?b+=n:"D"===r||"P"===r||"N"===r?w+=n:"H"!==r&&(b+=n,w+=n)}h=b,g=w;const v=b-(w-u),S=v<s?r[v]:"X";o.push({start:u,base:S,qual:l?a[v]:void 0,altbase:y,length:1,type:"mismatch"}),u++}else f++}return o}(t,s,i,n,a))),i}function c(e){const t=o(e);let n=0;for(let e=0;e<t.length;e+=2){const r=+t[e],a=t[e+1];"H"!==a&&"S"!==a&&"I"!==a&&(n+=r)}return n}function d(e){const t=o(e);let n=0;for(let e=0;e<t.length;e+=2){const r=+t[e],a=t[e+1];"D"!==a&&"N"!==a&&(n+=r)}return n}function u(e){const t=o(e);let n=0;for(let e=0;e<t.length;e+=2){const r=+t[e],a=t[e+1];"H"!==a&&"S"!==a&&"D"!==a&&"N"!==a&&(n+=r)}return n}function p(e,t){return-1===t?+(r.exec(e)||[])[1]||0:+(a.exec(e)||[])[1]||0}function h(e,t){return e.get("tags")[t]}function g(e,t,n,r,a){return e?.split(";").filter(e=>!!e).map((e,o)=>{const i=e.split(","),s=i[0],l=i[1],h=i[2],g=i[3],m=c(g),f=d(g),y=u(g),b="-"===h?-1:1,w=p(g,(a?n:1)*b),v=+l-1;return{refName:s,start:v,end:v+m,seqLength:f,clipLengthAtStartOfRead:w,CIGAR:g,strand:(a?n:1)*b,uniqueId:`${t}_SA${o}`,mate:{start:w,end:w+y,refName:r}}})||[]}},35913(e,t,n){n.d(t,{A:()=>c});var r=n(30936),a=n(42918),o=n(74919),i=n(14391),s=n(32118);function l(e,t){t()}const c=function(e){const t=(0,r.c)(37);let n,c,d,u,p,h,g,m,f,y,b,w;t[0]!==e?(({children:c,menuItems:p,closeAfterItemClick:y,stopPropagation:f,disabled:d,setOpen:m,ButtonComponent:b,onClick:h,anchorOrigin:n,transformOrigin:w,marginThreshold:u,...g}=e),t[0]=e,t[1]=n,t[2]=c,t[3]=d,t[4]=u,t[5]=p,t[6]=h,t[7]=g,t[8]=m,t[9]=f,t[10]=y,t[11]=b,t[12]=w):(n=t[1],c=t[2],d=t[3],u=t[4],p=t[5],h=t[6],g=t[7],m=t[8],f=t[9],y=t[10],b=t[11],w=t[12]);const v=void 0===y||y,S=void 0===b?o.A:b,[k,x]=(0,a.useState)(null),C=Boolean(k);let T,A;t[13]!==C||t[14]!==m?(T=()=>{m?.(C)},A=[C,m],t[13]=C,t[14]=m,t[15]=T,t[16]=A):(T=t[15],A=t[16]),(0,a.useEffect)(T,A);const M=d??(Array.isArray(p)&&0===p.length);let P,I,R,L;return t[17]!==h||t[18]!==f?(P=e=>{f&&e.stopPropagation(),x(e.currentTarget),h?.(e)},t[17]=h,t[18]=f,t[19]=P):P=t[19],t[20]!==S||t[21]!==c||t[22]!==M||t[23]!==g||t[24]!==P?(I=(0,s.jsx)(S,{onClick:P,...g,disabled:M,children:c}),t[20]=S,t[21]=c,t[22]=M,t[23]=g,t[24]=P,t[25]=I):I=t[25],t[26]!==k||t[27]!==n||t[28]!==v||t[29]!==u||t[30]!==p||t[31]!==C||t[32]!==w?(R=C?(0,s.jsx)(i.A,{open:C,onClose:()=>{x(null)},anchorEl:k,anchorOrigin:n,transformOrigin:w,marginThreshold:u,menuItems:p,closeAfterItemClick:v,onMenuItemClick:l}):null,t[26]=k,t[27]=n,t[28]=v,t[29]=u,t[30]=p,t[31]=C,t[32]=w,t[33]=R):R=t[33],t[34]!==I||t[35]!==R?(L=(0,s.jsxs)(s.Fragment,{children:[I,R]}),t[34]=I,t[35]=R,t[36]=L):L=t[36],L}},35986(e,t,n){n.d(t,{A:()=>d});var r=n(14261),a=n(87877),o=n(13861);const i=(0,a.S7)("UCSCTrackHubConnection",{hubTxtLocation:{type:"fileLocation",defaultValue:{uri:"http://mysite.com/path/to/hub.txt",locationType:"UriLocation"},description:"location of the hub file (usually called hub.txt)"},assemblyNames:{type:"stringArray",defaultValue:[],description:"optional list of genomes to import from this track hub, if empty all genomes will be imported"}},{baseConfiguration:o.A,preProcessSnapshot:e=>e.uri?{...e,hubTxtLocation:{uri:e.uri,baseUri:e.baseUri}}:e});var s=n(89322),l=n(99226);function c(e){return l.types.compose("UCSCTrackHubConnection",(0,s.A)(e),l.types.model({configuration:(0,a.AK)(i),type:l.types.literal("UCSCTrackHubConnection")})).actions(e=>({async connect(){const{doConnect:t}=await n.e(7621).then(n.bind(n,97621));t(e)}}))}function d(e){e.addConnectionType(()=>new r.A({name:"UCSCTrackHubConnection",configSchema:i,stateModel:c(e),displayName:"UCSC Track Hub",description:"A track or assembly hub in the Track Hub format",url:"https://genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Intro"}))}},36412(e,t,n){n.d(t,{k:()=>r});const r=new RegExp(/([A-Z])([-+])([a-z]+|[0-9]+)([.?]?)/)},36565(e,t,n){n.d(t,{LinearWiggleDisplayReactComponent:()=>C.default,Ay:()=>he});var r=n(54351),a=n(58946),o=n(87877);const i=(0,o.S7)("BigWigAdapter",{bigWigLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bw",locationType:"UriLocation"}},source:{type:"string",defaultValue:"",description:"Used for multiwiggle"},resolutionMultiplier:{type:"number",defaultValue:1,description:"Initial resolution multiplier, <1 is higher resolution, >1 is lower resolution"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bigWigLocation:{uri:e.uri,baseUri:e.baseUri}}:e});var s=n(42918),l=n(11259),c=n(77251),d=n(10525);const u=(0,s.lazy)(()=>n.e(6155).then(n.bind(n,6155)));var p=n(18543);class h extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(5680).then(n.bind(n,5680));return t(e,this.pluginManager)}}var g=n(99226);const m=(0,o.S7)("WiggleRenderer",{color:{type:"color",description:"the color of track, overrides posColor and negColor",defaultValue:"#f0f",contextVariable:["feature"]},posColor:{type:"color",description:"the color to use when the score is positive",defaultValue:"blue",contextVariable:["feature"]},negColor:{type:"color",description:"the color to use when the score is negative",defaultValue:"red",contextVariable:["feature"]},clipColor:{type:"color",description:"the color of the clipping marker",defaultValue:"red"},bicolorPivot:{type:"stringEnum",model:g.types.enumeration("Scale type",["numeric","mean","z_score","none"]),description:"type of bicolor pivot",defaultValue:"numeric"},bicolorPivotValue:{type:"number",defaultValue:0,description:"value to use for bicolor pivot"}},{explicitlyTyped:!0}),f=(0,o.S7)("DensityRenderer",{},{baseConfiguration:m,explicitlyTyped:!0});var y=n(70203);class b extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(1317).then(n.bind(n,1317));return t(e,this.pluginManager)}}const w=(0,o.S7)("LinePlotRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1}},{baseConfiguration:m,explicitlyTyped:!0});var v=n(61451),S=n(98612);function k(){return(0,o.S7)("SharedWiggleDisplay",{autoscale:{type:"stringEnum",defaultValue:"local",model:g.types.enumeration("Autoscale type",["global","local","globalsd","localsd","zscore"]),description:"global/local using their min/max values or w/ standard deviations (globalsd/localsd)"},minimalTicks:{type:"boolean",defaultValue:!1,description:"use the minimal amount of ticks"},minScore:{type:"number",defaultValue:Number.MIN_VALUE,description:"minimum value for the y-scale"},maxScore:{type:"number",description:"maximum value for the y-scale",defaultValue:Number.MAX_VALUE},numStdDev:{type:"number",description:"number of standard deviations to use for autoscale types globalsd or localsd",defaultValue:3},scaleType:{type:"stringEnum",model:g.types.enumeration("Scale type",["linear","log"]),description:"The type of scale to use",defaultValue:"linear"},inverted:{type:"boolean",description:"draw upside down",defaultValue:!1}},{baseConfiguration:S.A,explicitlyTyped:!0})}var x=n(74691);var C=n(47333);class T extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(6327).then(n.bind(n,96327));return t(e,this.pluginManager)}}const A=(0,o.S7)("MultiDensityRenderer",{},{baseConfiguration:m,explicitlyTyped:!0});class M extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(1291).then(n.bind(n,11291));return t(e,this.pluginManager)}}const P=(0,o.S7)("MultiLineRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:g.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"}},{baseConfiguration:m,explicitlyTyped:!0});var I=n(14157),R=n(52901),L=n(10877),F=n(89913),D=n(62202),N=n.n(D),B=n(10240),E=n(1879),V=n(27535);const z=()=>"#000000".replaceAll("0",()=>(~~(16*Math.random())).toString(16)),j=(0,s.lazy)(()=>n.e(167).then(n.bind(n,10167))),H=(0,s.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(7667),n.e(8501),n.e(1436)]).then(n.bind(n,31436))),_=(0,s.lazy)(()=>n.e(1065).then(n.bind(n,51065))),O=new Map([["xyplot","MultiXYPlotRenderer"],["multirowxy","MultiRowXYPlotRenderer"],["multirowdensity","MultiDensityRenderer"],["multiline","MultiLineRenderer"],["multirowline","MultiRowLineRenderer"]]),$=function(e,t){return g.types.compose("MultiLinearWiggleDisplay",(0,B.A)(t),g.types.model({type:g.types.literal("MultiLinearWiggleDisplay"),layout:g.types.optional(g.types.frozen(),[]),showSidebar:!0})).volatile(()=>({sourcesLoadingStopToken:void 0,featureUnderMouseVolatile:void 0,sourcesVolatile:void 0})).actions(e=>({setShowSidebar(t){e.showSidebar=t},setSourcesLoading(t){e.sourcesLoadingStopToken&&(0,R.CF)(e.sourcesLoadingStopToken),e.sourcesLoadingStopToken=t},setLayout(t){e.layout=t},clearLayout(){e.layout=[]},setSources(t){N()(t,e.sourcesVolatile)||(e.sourcesVolatile=t)},setFeatureUnderMouse(t){e.featureUnderMouseVolatile=t}})).views(e=>({get featureUnderMouse(){return e.featureUnderMouseVolatile},get TooltipComponent(){return j},get rendererTypeName(){const t=e.rendererTypeNameSimple,n=O.get(t);if(!n)throw new Error(`unknown renderer ${t}`);return n}})).views(e=>({get graphType(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName||"MultiLineRenderer"===e.rendererTypeName||"MultiRowLineRenderer"===e.rendererTypeName},get needsFullHeightScalebar(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiLineRenderer"===e.rendererTypeName},get isMultiRow(){return"MultiRowXYPlotRenderer"===e.rendererTypeName||"MultiRowLineRenderer"===e.rendererTypeName||"MultiDensityRenderer"===e.rendererTypeName},get canHaveFill(){return"MultiXYPlotRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName},get needsCustomLegend(){return"MultiDensityRenderer"===e.rendererTypeName},get renderColorBoxes(){return!("MultiRowLineRenderer"===e.rendererTypeName||"MultiRowXYPlotRenderer"===e.rendererTypeName)},get prefersOffset(){return this.isMultiRow},get sourcesWithoutLayout(){const t=Object.fromEntries(e.sourcesVolatile?.map(e=>[e.name,e])||[]),n=e.sourcesVolatile;return n?.map(e=>({...t[e.name],...e})).map((e,t)=>({...e,color:e.color||(this.isMultiRow?"blue":I.set1[t]||z())}))},get sources(){const t=Object.fromEntries(e.sourcesVolatile?.map(e=>[e.name,e])||[]),n=e.layout.length?e.layout:e.sourcesVolatile;return n?.map(e=>({...t[e.name],...e})).map((e,t)=>({...e,color:e.color||(this.isMultiRow?"blue":I.set1[t]||z())}))},get quantitativeStatsReady(){return(0,c.getContainingView)(e).initialized&&e.featureDensityStatsReadyAndRegionNotTooLarge&&!e.error}})).views(e=>({get rowHeight(){const{sources:t,height:n,isMultiRow:r}=e;return r?n/(t?.length||1):n},get rowHeightTooSmallForScalebar(){return this.rowHeight<70},get useMinimalTicks(){return(0,l.FI)(e,"minimalTicks")||this.rowHeightTooSmallForScalebar}})).views(e=>{const{renderProps:t}=e;return{adapterProps:()=>({...t(),config:e.rendererConfig,filters:e.filters,resolution:e.resolution,sources:e.sources}),get ticks(){const{scaleType:t,domain:n,isMultiRow:r,rowHeight:a,useMinimalTicks:o}=e;if(!n)return;const i=r?0:V.YSCALEBAR_LABEL_OFFSET,s=(0,E.A)((0,V.getScale)({scaleType:t,domain:n,range:[a-i,i],inverted:(0,l.FI)(e,"inverted")}),4);return o?{...s,values:n}:s},get colors(){return["red","blue","green","orange","purple","cyan","pink","darkblue","darkred","pink"]},get quantitativeStatsRelevantToCurrentZoom(){const t=(0,c.getContainingView)(e);return e.stats?.currStatsBpPerPx===t.bpPerPx}}}).views(e=>({get legendFontSize(){return Math.min(e.rowHeight,8)},get canDisplayLegendLabels(){return e.rowHeight>7},get labelWidth(){return(0,c.max)(e.sources?.map(e=>(0,c.measureText)(e.name,this.legendFontSize)).map(e=>this.canDisplayLegendLabels?e:20)||[])},renderProps(){const t=e.adapterProps();return{...t,notReady:t.notReady||!e.sources||!e.stats,displayCrossHatches:e.displayCrossHatches,height:e.height,ticks:e.ticks,stats:e.stats,scaleOpts:e.scaleOpts,offset:e.isMultiRow?0:V.YSCALEBAR_LABEL_OFFSET}},renderingProps:()=>({displayModel:e}),get hasResolution(){return e.adapterCapabilities.includes("hasResolution")},get hasGlobalStats(){return e.adapterCapabilities.includes("hasGlobalStats")},get fillSetting(){return e.filled?0:1===e.minSize?1:2}})).views(e=>{const{trackMenuItems:t}=e,n=(0,l.FI)(e,"defaultRendering");return{trackMenuItems:()=>[...t(),{label:"Show...",icon:F.A,subMenu:[{label:"Show tooltips",type:"checkbox",checked:e.showTooltipsEnabled,onClick:()=>{e.setShowTooltips(!e.showTooltipsEnabled)}},{label:"Show sidebar",type:"checkbox",checked:e.showSidebar,onClick:()=>{e.setShowSidebar(!e.showSidebar)}},...e.graphType?[{type:"checkbox",label:"Show cross hatches",checked:e.displayCrossHatchesSetting,onClick:()=>{e.toggleCrossHatches()}}]:[]]},{label:"Score",icon:L.A,subMenu:e.scoreTrackMenuItems()},...e.canHaveFill?[{label:"Fill mode",subMenu:["filled","no fill","no fill w/ emphasis"].map((t,n)=>({label:t,type:"radio",checked:e.fillSetting===n,onClick:()=>{e.setFill(n)}}))}]:[],...n?[{label:"Renderer type",subMenu:["xyplot","multirowxy","multirowdensity","multiline","multirowline"].map(t=>({label:t,type:"radio",checked:e.rendererTypeNameSimple===t,onClick:()=>{e.setRendererType(t)}}))}]:[],...e.isMultiRow?[{label:"Cluster rows by score",onClick:()=>{(0,c.getSession)(e).queueDialog(t=>[_,{model:e,handleClose:t}])}}]:[],{label:"Edit colors/arrangement...",onClick:()=>{(0,c.getSession)(e).queueDialog(t=>[H,{model:e,handleClose:t}])}}]}}).actions(e=>{const{renderSvg:t}=e;return{afterAttach(){(async()=>{try{const[{getMultiWiggleSourcesAutorun:t},{getQuantitativeStatsAutorun:r}]=await Promise.all([n.e(6785).then(n.bind(n,56785)),n.e(9776).then(n.bind(n,29776))]);r(e),t(e)}catch(t){(0,g.isAlive)(e)&&(console.error(t),(0,c.getSession)(e).notifyError(`${t}`,t))}})()},async renderSvg(r){const{renderSvg:a}=await n.e(661).then(n.bind(n,30661));return a(e,r,t)}}}).postProcessSnapshot(e=>{if(!e)return e;const{layout:t,showSidebar:n,...r}=e;return{...r,...t?.length?{layout:t}:{},...n?{}:{showSidebar:n}}})};var G=n(3026),W=n(75976),U=n(7062);function q({features:e}){return e.map(e=>`${e.get("refName")}\t${e.get("start")}\t${e.get("end")}\t${e.get("score")??0}`).join("\n")}class J extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(6993).then(n.bind(n,36993));return t(e,this.pluginManager)}}const X=(0,o.S7)("MultiRowLineRenderer",{displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:g.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"}},{baseConfiguration:m,explicitlyTyped:!0});class K extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(1003).then(n.bind(n,81003));return t(e,this.pluginManager)}}const Q=(0,o.S7)("MultiRowXYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:g.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"whiskers"},minSize:{type:"number",defaultValue:.7}},{baseConfiguration:m,explicitlyTyped:!0}),Y=(0,o.S7)("MultiWiggleAdapter",{subadapters:{type:"frozen",defaultValue:[],description:"array of subadapter JSON objects"},bigWigs:{type:"frozen",description:"array of bigwig filenames, alternative to the subadapters slot",defaultValue:[]}},{explicitlyTyped:!0});var Z=n(39494);class ee extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(8045).then(n.bind(n,88045));return t(e,this.pluginManager)}}const te=(0,o.S7)("MultiXYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:g.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"avg"},minSize:{type:"number",defaultValue:.7}},{baseConfiguration:m,explicitlyTyped:!0});var ne=n(38433),re=n(30524);class ae extends re.A{name="WiggleGetGlobalQuantitativeStats";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{adapterConfig:a,sessionId:o}=r,{dataAdapter:i}=await(0,ne.cK)(n,o,a);return i.getGlobalStats(r)}}class oe extends re.A{name="WiggleGetMultiRegionQuantitativeStats";async serializeArguments(e,t){const n=this.pluginManager,r=n.rootModel?.session?.assemblyManager;if(!r)throw new Error("no assembly manager");let a=e.staticBlocks;return e.staticBlocks?.length&&(a=(await(0,c.renameRegionsIfNeeded)(r,{...e,regions:e.staticBlocks})).regions),{...await super.serializeArguments(e,t),staticBlocks:a}}async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{regions:a,staticBlocks:o,adapterConfig:i,sessionId:s}=r,{dataAdapter:l}=await(0,ne.cK)(n,s,i);return l.getMultiRegionQuantitativeStats(a,{...r,staticBlocks:o})}}class ie extends re.A{name="MultiWiggleGetSources";async execute(e,t){const n=this.pluginManager,r=await this.deserializeArguments(e,t),{regions:a,adapterConfig:o,sessionId:i}=r,{dataAdapter:s}=await(0,ne.cK)(n,i,o);return s.getSources(a,r)}}var se=n(74045);class le extends re.A{name="MultiWiggleGetScoreMatrix";async execute(e,t){const n=await this.deserializeArguments(e,t);return(0,se.G)({args:n,pluginManager:this.pluginManager})}}class ce extends re.A{name="MultiWiggleClusterScoreMatrix";async execute(e,t){const r=await this.deserializeArguments(e,t),{executeClusterScoreMatrix:a}=await Promise.all([n.e(3678),n.e(414)]).then(n.bind(n,60414));return a({pluginManager:this.pluginManager,args:r})}}class de extends p.default{supportsSVG=!0;async render(e){const{makeImageData:t}=await n.e(7588).then(n.bind(n,17588));return t(e,this.pluginManager)}}const ue=(0,o.S7)("XYPlotRenderer",{filled:{type:"boolean",defaultValue:!0},displayCrossHatches:{type:"boolean",description:"choose to draw cross hatches (sideways lines)",defaultValue:!1},summaryScoreMode:{type:"stringEnum",model:g.types.enumeration("Score type",["max","min","avg","whiskers"]),description:"choose whether to use max/min/average or whiskers which combines all three into the same rendering",defaultValue:"whiskers"},minSize:{type:"number",defaultValue:.7}},{baseConfiguration:m,explicitlyTyped:!0});var pe=n(4648);class he extends r.A{name="WigglePlugin";install(e){e.addAdapterType(()=>new a.A({name:"MultiWiggleAdapter",displayName:"Multi-wiggle adapter",configSchema:Y,adapterCapabilities:["hasResolution","hasLocalStats","hasGlobalStats"],adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(5248).then(n.bind(n,45248)).then(e=>e.default)})),e.addAdapterType(()=>new a.A({name:"BigWigAdapter",displayName:"BigWig adapter",configSchema:i,adapterCapabilities:["hasResolution","hasLocalStats","hasGlobalStats"],getAdapterClass:()=>Promise.all([n.e(6601),n.e(36)]).then(n.bind(n,70036)).then(e=>e.default)})),function(e){e.addTrackType(()=>{const t=function(e){return(0,o.S7)("QuantitativeTrack",{},{baseConfiguration:(0,U.J)(e)})}(e);return new G.A({name:"QuantitativeTrack",displayName:"Quantitative track",configSchema:t,stateModel:(0,W.E)(e,"QuantitativeTrack",t).views(()=>({saveTrackFileFormatOptions:()=>({bedGraph:{name:"BedGraph",extension:"bedgraph",callback:q}})}))})})}(e),function(e){e.addTrackType(()=>{const t=(e=>(0,o.S7)("MultiQuantitativeTrack",{},{baseConfiguration:(0,U.J)(e)}))(e);return new G.A({name:"MultiQuantitativeTrack",displayName:"Multi-quantitative track",configSchema:t,stateModel:(0,W.E)(e,"MultiQuantitativeTrack",t).views(()=>({saveTrackFileFormatOptions:()=>({bedGraph:{name:"BedGraph",extension:"bedgraph",callback:q}})}))})})}(e),function(e){e.addDisplayType(()=>{const t=function(e){const t=e.getRendererType("XYPlotRenderer").configSchema,n=e.getRendererType("DensityRenderer").configSchema,r=e.getRendererType("LinePlotRenderer").configSchema;return(0,o.S7)("LinearWiggleDisplay",{defaultRendering:{type:"stringEnum",model:g.types.enumeration("Rendering",["density","xyplot","line"]),defaultValue:"xyplot"},renderers:(0,o.S7)("RenderersConfiguration",{DensityRenderer:n,XYPlotRenderer:t,LinePlotRenderer:r})},{baseConfiguration:k(),explicitlyTyped:!0})}(e),r=(0,x.A)(e,t);return new v.A({name:"LinearWiggleDisplay",displayName:"Wiggle display",configSchema:t,stateModel:r,trackType:"QuantitativeTrack",viewType:"LinearGenomeView",ReactComponent:(0,s.lazy)(()=>Promise.resolve().then(n.bind(n,47333)))})})}(e),function(e){e.addDisplayType(()=>{const t=function(e){const t=e.getRendererType("MultiXYPlotRenderer").configSchema,n=e.getRendererType("MultiDensityRenderer").configSchema,r=e.getRendererType("MultiRowXYPlotRenderer").configSchema,a=e.getRendererType("MultiLineRenderer").configSchema,i=e.getRendererType("MultiRowLineRenderer").configSchema;return(0,o.S7)("MultiLinearWiggleDisplay",{defaultRendering:{type:"stringEnum",model:g.types.enumeration("Rendering",["multirowxy","xyplot","multirowdensity","multiline","multirowline"]),defaultValue:"multirowxy"},renderers:(0,o.S7)("RenderersConfiguration",{MultiXYPlotRenderer:t,MultiDensityRenderer:n,MultiRowXYPlotRenderer:r,MultiLineRenderer:a,MultiRowLineRenderer:i}),height:{type:"number",defaultValue:200}},{baseConfiguration:k(),explicitlyTyped:!0})}(e);return new v.A({name:"MultiLinearWiggleDisplay",displayName:"Multi-wiggle display",configSchema:t,stateModel:$(0,t),trackType:"MultiQuantitativeTrack",viewType:"LinearGenomeView",ReactComponent:(0,s.lazy)(()=>n.e(1104).then(n.bind(n,1104)))})})}(e),function(e){e.addRendererType(()=>new b({name:"LinePlotRenderer",ReactComponent:(0,s.lazy)(()=>Promise.resolve().then(n.bind(n,4648))),configSchema:w,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new de({name:"XYPlotRenderer",ReactComponent:(0,s.lazy)(()=>Promise.resolve().then(n.bind(n,4648))),configSchema:ue,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new h({name:"DensityRenderer",ReactComponent:(0,s.lazy)(()=>Promise.resolve().then(n.bind(n,4648))),configSchema:f,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new ee({name:"MultiXYPlotRenderer",ReactComponent:(0,s.lazy)(()=>n.e(2177).then(n.bind(n,22177))),configSchema:te,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new K({name:"MultiRowXYPlotRenderer",ReactComponent:(0,s.lazy)(()=>n.e(2177).then(n.bind(n,22177))),configSchema:Q,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new T({name:"MultiDensityRenderer",ReactComponent:(0,s.lazy)(()=>n.e(2177).then(n.bind(n,22177))),configSchema:A,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new M({name:"MultiLineRenderer",ReactComponent:(0,s.lazy)(()=>n.e(2177).then(n.bind(n,22177))),configSchema:P,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new J({name:"MultiRowLineRenderer",ReactComponent:(0,s.lazy)(()=>n.e(2177).then(n.bind(n,22177))),configSchema:X,pluginManager:e}))}(e),function(e){e.addAddTrackWorkflowType(()=>new Z.A({name:"Multi-wiggle track",ReactComponent:(0,s.lazy)(()=>n.e(8072).then(n.bind(n,98072))),stateModel:g.types.model({})}))}(e),function(e){e.addToExtensionPoint("TrackSelector-multiTrackMenuItems",(e,t)=>{const{session:n}=t;return[...e,...(0,d.QW)(n)?[{label:"Create multi-wiggle track",onClick:e=>{const t=e.selection;(0,c.getSession)(e).queueDialog(n=>[u,{tracks:t,onClose:(t,r)=>{t&&r&&function({model:e,arg:t}){const n=e.selection,r=n.map(e=>(0,l.QZ)(e,"name")),a=n.map(e=>(0,l.QZ)(e,"adapter")).map((e,t)=>({...e,source:r[t]})),o=`multitrack-${Date.now()}-sessionTrack`,i=(0,c.getSession)(e);(0,d.QW)(i)&&(i.addTrackConf({type:"MultiQuantitativeTrack",trackId:o,name:t.name,assemblyNames:[...new Set(n.flatMap(e=>(0,l.QZ)(e,"assemblyNames")))],adapter:{type:"MultiWiggleAdapter",subadapters:a}}),e.view.showTrack(o))}({model:e,arg:r}),n()}}])}}]:[]]})}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,y.getFileName)(t);return(0,c.testAdapter)(a,/\.(bw|bigwig)$/i,r,"BigWigAdapter")?{type:"BigWigAdapter",bigWigLocation:t}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"BigWigAdapter"===t?"QuantitativeTrack":e(t))}(e),e.addRpcMethod(()=>new ae(e)),e.addRpcMethod(()=>new oe(e)),e.addRpcMethod(()=>new ie(e)),e.addRpcMethod(()=>new le(e)),e.addRpcMethod(()=>new ce(e))}exports={LinearWiggleDisplayReactComponent:C.default,XYPlotRendererReactComponent:pe.default,XYPlotRenderer:de,linearWiggleDisplayModelFactory:x.A,xyPlotRendererConfigSchema:ue,utils:V}}},36592(e,t,n){n.d(t,{Q:()=>i});var r=n(96852),a=n(10596),o=n(48455);class i extends o.L{async getMultiRegionFeatureDensityStats(){return{featureDensity:0}}async getSequence(e,t){const n=await(0,r._)(this.getFeatures({...e,assemblyName:""},t).pipe((0,a.$)()));return n[0]?.get("seq")}}},38157(e,t,n){n.d(t,{CU:()=>c,Cz:()=>l,H2:()=>s,H4:()=>d,Tn:()=>o,i3:()=>i});var r=n(77251),a=n(53504);function o(e,t,n,r=0,a=1/0){const o=(t-e)*n;return{start:Math.max(r,e-o),end:Math.min(a,t+o)}}function i(e,t,n){const r=t*(e=Math.abs(e));let a=10**+r.toExponential().split(/e/i)[1];for(;a<r&&(a*=2,!(a>=r));)a*=2.5;a=Math.max(a,5);const o=a/e;let i=0;return!(a%10)&&o/10>=n?i=a/10:!(a%5)&&o/5>=n?i=a/5:!(a%2)&&o/2>=n&&(i=a/2),{majorPitch:a,minorPitch:i}}function s(e,t,n,r=!0,a=!0){const o=i(n,60,15);let s=e,l=t;n<0&&([s,l]=[l,s]),s-=Math.abs(20*n)-1,l+=Math.abs(20*n)+1;const c=o.minorPitch||o.majorPitch;let d=0;const u=[];for(let e=Math.floor(s/c)*c;e<Math.ceil(l/c)*c+1;e+=c)a&&e%(2*o.majorPitch)?(u.push({type:"minor",base:e-1,index:d}),d+=1):!r||e%(2*o.majorPitch)||(u.push({type:"major",base:e-1,index:d}),d+=1);return u}async function l({regions:e,assemblyManager:t,assemblyName:n,grow:r}){return Promise.all(e.map(async e=>{const a=e.assemblyName||n;if(!a)throw new Error("no assembly provided");const i=await t.waitForAssembly(a),{refName:s}=e;if(!i)throw new Error(`assembly ${a} not found`);const{regions:l}=i;if(!l)throw new Error(`regions not loaded yet for ${a}`);const c=i.getCanonicalRefName(e.refName);if(!c)throw new Error(`Could not find refName ${s} in ${i.name}`);const d=l.find(e=>e.refName===c);if(!d)throw new Error(`Could not find refName ${s} in ${a}`);const{start:u,end:p}=e,h=r&&void 0!==u&&void 0!==p?o(u,p,r):void 0;return{...e,...h?{start:h.start,end:h.end}:{},assemblyName:a,parentRegion:d}}))}function c(e,t,n){const r=e.split(/(\s+)/).map(e=>e.trim()).filter(e=>!!e);try{return r.map(e=>(0,a.f)(e,e=>n(e,t)))}catch(e){const[o,i,s]=r;if(/Unknown feature or sequence/.exec(`${e}`)&&Number.isInteger(+i)&&Number.isInteger(+s))return[(0,a.f)(`${o}:${i}..${s}`,e=>n(e,t))];throw e}}function d(e){if(e.length){const t=e.every(t=>t.assemblyName===e[0].assemblyName);return e.map(e=>(0,r.assembleLocString)({refName:e.refName,start:Math.round(e.start),end:Math.round(e.end),assemblyName:t?void 0:e.assemblyName,reversed:e.reversed})).join(" ")}return""}},38282(e,t,n){n.d(t,{A:()=>o});var r=n(30936),a=n(42918);function o(){const e=(0,r.c)(5),t=(0,a.useRef)(null);let n;e[0]===Symbol.for("react.memo_cache_sentinel")?(n={width:void 0,height:void 0},e[0]=n):n=e[0];const[o,i]=(0,a.useState)(n);let s,l,c;return e[1]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{if(!t.current)return;const e="undefined"!=typeof window&&"ResizeObserver"in window?window.ResizeObserver:void 0;if(!e)return;const n=new e(e=>{i({width:e[0].contentRect.width,height:e[0].contentRect.height})});return n.observe(t.current),()=>{n.disconnect()}},l=[],e[1]=s,e[2]=l):(s=e[1],l=e[2]),(0,a.useEffect)(s,l),e[3]!==o?(c=[t,o],e[3]=o,e[4]=c):c=e[4],c}},38433(e,t,n){n.d(t,{cK:()=>o,pZ:()=>i});var r=n(23950);let a={};async function o(e,t,n){const i=(0,r.L)(n);a[i]??=async function(e,t,n){const r=n?.type;if(!r)throw new Error(`could not determine adapter type from adapter config snapshot ${JSON.stringify(n)}`);const a=e.getAdapterType(r);if(!a)throw new Error(`unknown data adapter type ${r}`);const i=a.configSchema.create(n,{pluginManager:e}),s=o.bind(null,e,t);return{dataAdapter:new(await a.getAdapterClass())(i,s,e),sessionIds:new Set([t])}}(e,t,n);const s=await a[i];return s.sessionIds.add(t),s}async function i(e){const t=Object.keys(e);if(1===t.length&&"sessionId"===t[0]){const{sessionId:t}=e;for(const[e,n]of Object.entries(a)){const r=await n;r.sessionIds.delete(t),0===r.sessionIds.size&&delete a[e]}}else for(const t of Object.values(a)){const n=await t,r=e.regions||(e.region?[e.region]:[]);for(const e of r)void 0!==e.refName&&n.dataAdapter.freeResources(e)}}},38452(e,t,n){n.d(t,{$:()=>i,I:()=>o});var r=n(77251),a=n(70203);function o(e){const t=(0,r.getContainingView)(e),{rendererType:n}=e,{rpcManager:o}=(0,r.getSession)(t);return{rendererType:n,rpcManager:o,renderProps:e.renderProps(),renderingProps:e.renderingProps?.(),renderArgs:{assemblyName:t.displayedRegions[0].assemblyName,adapterConfig:structuredClone(e.adapterConfig),rendererType:n.name,regions:structuredClone(t.displayedRegions),blockDefinitions:e.blockDefinitions,sessionId:(0,a.getRpcSessionId)(e),trackInstanceId:(0,r.getContainingTrack)(e).id,timeout:1e6}}}async function i(e,t){if(!e)throw new Error("cannot render with no props");const{rendererType:n,rpcManager:r,cannotBeRenderedReason:a,renderArgs:o,renderProps:i,renderingProps:s,exportSVG:l}=e;if(a)return{message:a};if(!i.radius||!o.regions?.length)return{message:"Skipping render"};const{html:c,...d}=await n.renderInClient(r,{...o,...i,renderingProps:s,exportSVG:l,stopToken:t});return{html:c,data:d,reactElement:d.reactElement,renderingComponent:n.ReactComponent}}},39494(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.ReactComponent=e.ReactComponent,this.stateModel=e.stateModel}}},40704(e,t,n){function r(e){return{...e,start:Math.floor(e.start),end:Math.ceil(e.end)}}function a(e,t){return{...e,start:Math.floor(Math.max(e.start-t,0)),end:Math.ceil(e.end+t)}}n.d(t,{T:()=>a,w:()=>r})},42456(e,t,n){n.d(t,{Ac:()=>o,IU:()=>i,Ud:()=>s,_1:()=>l,y6:()=>c});var r=n(77251),a=n(53155);async function o({rpcManager:e,sessionId:t,trackId:n,rendererType:r,featureId:o,parentFeatureId:s}){const l=s||o,{feature:c}=await e.call(t,"CoreGetFeatureDetails",{featureId:l,sessionId:t,trackInstanceId:n,rendererType:r});if(!c)return;const d=new a.A(c);return s?i(d,o):d}function i(e,t){const n=e.get("subfeatures");if(n)for(const e of n){if(e.id()===t)return e;const n=i(e,t);if(n)return n}}function s(e){const t=e.flatMap(e=>e.get("subfeatures")?.filter(e=>"exon"===e.get("type")||"CDS"===e.get("type"))??[]);return!(t.length<2)&&(0,r.mergeIntervals)(t.map(e=>({start:e.get("start"),end:e.get("end")})),0).length>1}function l(e){return e?function(e){return(e.get("subfeatures")??[]).some(e=>"exon"===e.get("type")||"CDS"===e.get("type"))}(e)?[e]:e.get("subfeatures")??[]:[]}function c(e,t){if(!e||!t)return!1;const n=e.getContext("2d");return!!n&&(n.resetTransform(),n.clearRect(0,0,e.width,e.height),n.drawImage(t,0,0),!0)}},43788(e,t,n){n.d(t,{A:()=>f});var r=n(42918),a=n(87877),o=n(11259),i=n(46413),s=n(77251),l=n(53155),c=n(70203),d=n(99226),u=n(89913),p=n(38567),h=n(58730);const g=(0,r.lazy)(()=>n.e(3603).then(n.bind(n,73603))),m=(0,r.lazy)(()=>n.e(7482).then(n.bind(n,97482))),f=function(e){return d.types.compose("LinearFeatureDisplay",h.L,d.types.model({type:d.types.literal("LinearFeatureDisplay"),trackShowLabels:d.types.maybe(d.types.boolean),trackShowDescriptions:d.types.maybe(d.types.boolean),trackDisplayMode:d.types.maybe(d.types.string),trackMaxHeight:d.types.maybe(d.types.number),configuration:(0,a.AK)(e),jexlFilters:d.types.maybe(d.types.array(d.types.string))})).volatile(()=>({featureUnderMouseVolatile:void 0})).views(e=>({get activeFilters(){return e.jexlFilters??(0,o.FI)(e,"jexlFilters").map(e=>`jexl:${e}`)},get rendererTypeName(){return(0,o.FI)(e,["renderer","type"])},get sequenceAdapter(){const{assemblyManager:t}=(0,s.getSession)(e),n=(0,d.getParent)(e,2),r=(0,o.QZ)(n.configuration,"assemblyNames"),a=t.get(r[0]);return a?(0,o.FI)(a,["sequence","adapter"]):void 0},get showLabels(){return e.trackShowLabels??(0,o.FI)(e,["renderer","showLabels"])},get showDescriptions(){return e.trackShowDescriptions??(0,o.FI)(e,["renderer","showDescriptions"])},get maxHeight(){return e.trackMaxHeight??(0,o.FI)(e,["renderer","maxHeight"])},get displayMode(){return e.trackDisplayMode??(0,o.FI)(e,["renderer","displayMode"])}})).views(e=>({get rendererConfig(){const t=(0,o.FI)(e,["renderer"])||{};return{...t,showLabels:e.trackShowLabels??t.showLabels,showDescriptions:e.trackShowDescriptions??t.showDescriptions,displayMode:e.trackDisplayMode??t.displayMode,maxHeight:e.trackMaxHeight??t.maxHeight}}})).actions(e=>({setJexlFilters(t){e.jexlFilters=(0,d.cast)(t)},setFeatureUnderMouse(t){e.featureUnderMouseVolatile=t},toggleShowLabels(){e.trackShowLabels=!e.showLabels},toggleShowDescriptions(){e.trackShowDescriptions=!e.showDescriptions},setDisplayMode(t){e.trackDisplayMode=t},setMaxHeight(t){e.trackMaxHeight=t}})).views(e=>({get featureUnderMouse(){return e.featureUnderMouseVolatile}})).views(e=>{const{trackMenuItems:t,renderProps:n,renderingProps:r}=e;return{renderProps:()=>({...n(),config:e.rendererConfig,filters:new i.A({filters:e.activeFilters}),sequenceAdapter:e.sequenceAdapter}),renderingProps(){const t=r(),n=(0,s.getSession)(e);return{...t,async onFeatureClick(t,r){const{rpcManager:a}=n,{parentTrack:o}=e;try{const t=r||e.featureIdUnderMouse;if(t){const n=(0,c.getRpcSessionId)(e),{feature:r}=await a.call(n,"CoreGetFeatureDetails",{featureId:t,sessionId:n,trackInstanceId:o.id,rendererType:e.rendererTypeName});(0,d.isAlive)(e)&&r&&e.selectFeature(new l.A(r))}else e.clearFeatureSelection()}catch(e){console.error(e),n.notifyError(`${e}`,e)}},async onFeatureContextMenu(t,r){const{rpcManager:a}=n,{parentTrack:o}=e;try{const t=r||e.featureIdUnderMouse;if(t){const n=(0,c.getRpcSessionId)(e),{feature:r}=await a.call(n,"CoreGetFeatureDetails",{featureId:t,sessionId:n,trackInstanceId:o.id,rendererType:e.rendererTypeName});(0,d.isAlive)(e)&&r&&e.setContextMenuFeature(new l.A(r))}else e.clearFeatureSelection()}catch(e){console.error(e),n.notifyError(`${e}`,e)}}}},trackMenuItems:()=>[...t(),{label:"Show...",icon:u.A,subMenu:[{label:"Show tooltips",type:"checkbox",checked:e.showTooltipsEnabled,onClick:()=>{e.setShowTooltips(!e.showTooltipsEnabled)}},{label:"Show labels",type:"checkbox",checked:e.showLabels,onClick:()=>{e.toggleShowLabels()}},{label:"Show descriptions",type:"checkbox",checked:e.showDescriptions,onClick:()=>{e.toggleShowDescriptions()}}]},{label:"Display mode",icon:u.A,subMenu:["normal","compact","reducedRepresentation","collapse"].map(t=>({label:t,type:"radio",checked:e.displayMode===t,onClick:()=>{e.setDisplayMode(t)}}))},{label:"Set max track height",onClick:()=>{(0,s.getSession)(e).queueDialog(t=>[g,{model:e,handleClose:t}])}},{label:"Filters",subMenu:[{label:"Edit filters...",onClick:()=>{(0,s.getSession)(e).queueDialog(t=>[m,{model:e,handleClose:t}])}}]}]}}).actions(e=>({afterAttach(){(0,d.addDisposer)(e,(0,p.reaction)(()=>e.featureIdUnderMouse,async t=>{if(!t)return void e.setFeatureUnderMouse(void 0);const n=(0,s.getSession)(e),{rpcManager:r}=n,{parentTrack:a}=e;try{const n=(0,c.getRpcSessionId)(e),{feature:o}=await r.call(n,"CoreGetFeatureDetails",{featureId:t,sessionId:n,trackInstanceId:a.id,rendererType:e.rendererTypeName});(0,d.isAlive)(e)&&o&&e.featureIdUnderMouse===t&&e.setFeatureUnderMouse(new l.A(o))}catch(e){}},{delay:50,name:"LinearFeatureDisplayMouseoverReaction"}))}})).postProcessSnapshot(e=>{if(!e)return e;const{trackShowLabels:t,trackShowDescriptions:n,trackDisplayMode:r,trackMaxHeight:a,jexlFilters:o,...i}=e;return{...i,...void 0!==t?{trackShowLabels:t}:{},...void 0!==n?{trackShowDescriptions:n}:{},...void 0!==r?{trackDisplayMode:r}:{},...void 0!==a?{trackMaxHeight:a}:{},...o?.length?{jexlFilters:o}:{}}})}},44068(e,t,n){n.d(t,{Ak:()=>r});const r=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((e,t)=>e+((t&=63)<36?t.toString(36):t<62?(t-26).toString(36).toUpperCase():t>62?"-":"_"),"")},44121(e,t,n){n.r(t),n.d(t,{default:()=>h});var r=n(99226),a=n(20749),o=n(46413),i=n(77251),s=n(30713),l=n(62492),c=n(52901),d=n(32118);function u(e,t,n,r){if(!function(e){return!!e.html}(e))return r?(0,d.jsx)(n,{...t,...e}):(0,d.jsx)("text",{y:"12",fill:"black",children:"SVG export not supported for this track"})}function p(e,t,n,r){return(0,d.jsx)(n,{...t,...e,...r})}class h extends a.default{async renderDirect(e){const{renderingProps:t,...n}=e,a=(0,r.isStateTreeNode)(e.config)?e.config:this.configSchema.create(e.config||{},{pluginManager:this.pluginManager}),o=await this.render({...n,config:a});if((0,l.N)(o)){const t=o.value;return this.deserializeResultsInClient(t,e)}const{reactElement:i,...s}=o;return{...s,reactElement:e.exportSVG?u(s,e,this.ReactComponent,this.supportsSVG):p(s,e,this.ReactComponent,t)}}serializeArgsInClient(e){const{renderingProps:t,...n}=e;return{...n,config:(0,r.isStateTreeNode)(e.config)?(0,r.getSnapshot)(e.config):e.config,filters:e.filters?.toJSON().filters}}deserializeResultsInClient(e,t){const{renderingProps:n}=t;return{...e,reactElement:t.exportSVG?u(e,t,this.ReactComponent,this.supportsSVG):p(e,t,this.ReactComponent,n)}}deserializeArgsInWorker(e){return{...e,config:this.configSchema.create(e.config||{},{pluginManager:this.pluginManager}),filters:e.filters?new o.A({filters:e.filters}):void 0}}serializeResultsInWorker(e,t){const{reactElement:n,...r}=e;return r}async renderInClient(e,t){const n=await e.call(t.sessionId,"CoreRender",t);if("canvasRecordedData"in n){const{reactElement:e,...t}=n;return{...t,html:await(0,s.getSerializedSvg)(n)}}return n}async renderInWorker(e){const{stopToken:t,statusCallback:n=()=>{}}=e,r=this.deserializeArgsInWorker(e),a=await(0,i.updateStatus)("Rendering plot",n,()=>this.render(r));return(0,c.SW)(t),(0,l.N)(a)?a:(0,i.updateStatus)("Serializing results",n,()=>this.serializeResultsInWorker(a,r))}async freeResourcesInClient(e,t){const n=this.serializeArgsInClient(t),{sessionId:r}=t;await e.call(r,"CoreFreeResources",n)}}},45089(e,t,n){function r(e,t,n){const r=e.length;if(0===r)return!0;if(r<40){for(let a=0;a<r;a+=2)if(e[a+1]>t&&e[a]<n)return!1;return!0}let a=0,o=r>>1;for(;a<o;){const n=a+o>>>1;e[1+(n<<1)]<=t?a=n+1:o=n}const i=a<<1;return i>=r||e[i]>=n}n.d(t,{A:()=>a});class a{rows=[];rowMaxEnd=[];rectangles=new Map;lastLeft=-1/0;lastRow=0;maxHeightReached=!1;constructor(e={}){this.featureHeight=e.featureHeight??7,this.spacing=e.spacing??0,this.rowHeight=this.featureHeight+this.spacing,this.padding=e.padding??1,this.maxRows=e.maxHeight?Math.floor(e.maxHeight/this.rowHeight):1e5}addRect(e,t,n,r,a,o){const i=this.rectangles.get(e);if(i)return null===i.top?null:i.top*this.rowHeight;let s=0;t===this.lastLeft&&(s=this.lastRow+1);const l=n+this.padding,c=this.findFreeRow(t,l,s);if(null===c){const r={id:e,l:t,r:n,top:null,h:1,originalHeight:this.featureHeight,data:a,serializableData:o};return this.rectangles.set(e,r),this.maxHeightReached=!0,null}this.addToRow(c,t,l);const d={id:e,l:t,r:n,top:c,h:1,originalHeight:this.featureHeight,data:a,serializableData:o};return this.rectangles.set(e,d),this.lastLeft=t,this.lastRow=c,c*this.rowHeight}findFreeRow(e,t,n){const a=this.rows,o=this.rowMaxEnd;for(let i=n;i<this.maxRows;i++){const n=a[i];if(!n)return i;if(e>=o[i])return i;if(r(n,e,t))return i}return null}addToRow(e,t,n){let r=this.rows[e];r||(r=[],this.rows[e]=r,this.rowMaxEnd[e]=0);const a=r.length;if(0===a||t>=r[a-2])r.push(t,n);else{const e=function(e,t){const n=e.length;if(n<40){for(let r=0;r<n;r+=2)if(t<e[r])return r;return n}let r=0,a=n>>1;for(;r<a;){const n=r+a>>>1;e[n<<1]<t?r=n+1:a=n}return r<<1}(r,t);!function(e,t,n,r){const a=e.length;e.push(0,0);for(let n=a+1;n>t+1;n--)e[n]=e[n-2];e[t]=n,e[t+1]=r}(r,e,t,n)}n>this.rowMaxEnd[e]&&(this.rowMaxEnd[e]=n)}collides(e,t){return!1}addRectToBitmap(e){}getTotalHeight(){let e=0;for(let t=this.rows.length-1;t>=0;t--)if(this.rows[t]){e=t+1;break}return e*this.rowHeight}getRectangles(){const e=new Map,t=this.rowHeight,n=this.featureHeight;for(const[r,a]of this.rectangles)if(null!==a.top){const o=a.top*t;e.set(r,[a.l,o,a.r,o+n])}return e}discardRange(e,t){for(let n=0;n<this.rows.length;n++){const r=this.rows[n];if(!r)continue;const a=[];let o=0;for(let n=0;n<r.length;n+=2){const i=r[n],s=r[n+1];s<=e||i>=t?(a.push(i,s),s>o&&(o=s)):i<e&&s>e&&s<=t?(a.push(i,e),e>o&&(o=e)):i>=e&&i<t&&s>t?(a.push(t,s),s>o&&(o=s)):i<e&&s>t&&(a.push(i,e,t,s),s>o&&(o=s))}this.rows[n]=a,this.rowMaxEnd[n]=o}this.lastLeft=-1/0,this.lastRow=0}getDataByID(e){return this.rectangles.get(e)?.data}serializeRegion(e){const{start:t,end:n}=e,r={};for(const[e,a]of this.rectangles.entries()){if(null===a.top)continue;const{l:o,r:i,top:s}=a;if(n>=o&&i>=t){const t=s*this.rowHeight;r[e]=[o,t,i,t+this.featureHeight]}}return{rectangles:r,totalHeight:this.getTotalHeight(),maxHeightReached:this.maxHeightReached}}toJSON(){return{rectangles:Object.fromEntries(this.getRectangles()),totalHeight:this.getTotalHeight(),maxHeightReached:this.maxHeightReached}}}},45514(e,t,n){n.d(t,{p:()=>r});const r=e=>{const t=e.length;let n=0,a="";for(;n<t;n++){const t=e[n];if(null==t)continue;let o;switch(typeof t){case"boolean":break;case"object":if(Array.isArray(t))o=r(t);else{const e=t;o="";for(const t in e)e[t]&&t&&(o&&(o+=" "),o+=t)}break;default:o=t}o&&(a&&(a+=" "),a+=o)}return a}},45912(e,t,n){n.d(t,{A:()=>a});var r=n(18543);class a extends r.default{supportsSVG=!0}},46413(e,t,n){n.d(t,{A:()=>a});var r=n(19482);class a{constructor({filters:e}){this.filterChain=e.map(e=>e.trim()).filter(e=>!!e).map(e=>{if("string"==typeof e)return{expr:(0,r.A)(e),string:e};throw new Error(`invalid inputFilter string "${e}"`)})}passes(...e){for(const t of this.filterChain)if(!t.expr.eval({feature:e[0]}))return!1;return!0}toJSON(){return{filters:this.filterChain.map(e=>e.string)}}static fromJSON(e){return new a(e)}}},47011(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.description=e.description,this.configSchema=e.configSchema,this.getAdapterClass="getAdapterClass"in e?e.getAdapterClass:async()=>e.AdapterClass}}},47333(e,t,n){n.r(t),n.d(t,{default:()=>c});var r=n(11259),a=n(77251),o=n(18769),i=n(64074),s=n(79079),l=n(32118);const c=(0,i.observer)(function(e){const{model:t}=e,{stats:n,height:i,graphType:c}=t,{trackLabels:d}=(0,a.getContainingView)(t),u=(0,a.getContainingTrack)(t);return(0,l.jsxs)("div",{children:[(0,l.jsx)(o.Ay,{...e}),n&&c?(0,l.jsx)("svg",{style:{position:"absolute",top:0,left:"overlapping"===d?(0,a.measureText)((0,r.FI)(u,"name"),12.8)+100:50,pointerEvents:"none",height:i,width:50},children:(0,l.jsx)(s.A,{model:t})}):null]})})},47354(e,t,n){n.d(t,{$Q:()=>d,Ar:()=>p,B$:()=>S,CQ:()=>u,Fz:()=>y,Hh:()=>x,JD:()=>c,Kl:()=>m,Kt:()=>h,LI:()=>w,P9:()=>k,SP:()=>f,Sr:()=>C,_7:()=>v,cY:()=>b,ce:()=>A,dv:()=>s,hn:()=>M,lE:()=>g,yr:()=>l});var r=n(77251),a=n(19598),o=n(54257),i=n(5248);function s(e){for(const t of e.chains.values())if(t[0].get("flags")&i.Xx)return!0;return!1}function l(e,t){return 1!==t?(0,a.M)(e).alpha(Math.min(1,t*t+.1)).toHslString():e}const c={flagInclude:0,flagExclude:1540};function d(e){return!e||0===e.flagInclude&&1540===e.flagExclude&&!e.readName&&!e.tagFilter}const u={flagInclude:16,flagExclude:1540},p={flagInclude:0,flagExclude:1556};function h(e,t){const n=Object.getOwnPropertyDescriptor(e.prototype,t).get;Object.defineProperty(e.prototype,t,{get(){const e=n.call(this);return Object.defineProperty(this,t,{value:e}),e}})}function g(e,t,n){return(e&t)!==t||!!(e&n)}function m(e,t){return"*"===t?void 0===e:`${e}`!=`${t}`}function f(e,t){return e<50&&t>=3}const y=5;function b(e){const t=[],n={},r=[];let a=0,o=0;for(const i of e){const e=i;if("SQ"===e.tag){const r=e.data;for(const e of r){const r=e;if("SN"===r.tag){const e=r.value;n[e]=a,t[a]=e;break}}a++}else if("RG"===e.tag){const t=e.data;for(const e of t){const t=e;if("ID"===t.tag){r[o]=t.value;break}}o++}}return{idToName:t,nameToId:n,readGroups:r}}function w(e){const{skip:t,deletion:n,insertion:r,hardclip:a,softclip:o,bases:i}=e.palette;return{A:i.A.main,C:i.C.main,G:i.G.main,T:i.T.main,deletion:n,insertion:r,hardclip:a,softclip:o,skip:t}}function v(e){return Object.fromEntries(Object.entries(w(e)).map(([t,n])=>[t,e.palette.getContrastText(n)]))}function S(e){return["methylation","modifications"].includes(e||"")}function k(){return!0}function x(e){e.font="bold 10px Courier New,monospace"}function C(){return{charWidth:(0,r.measureText)("A"),charHeight:(0,r.measureText)("M")-2}}function T(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function A(e){const t={};for(const[n,r]of Object.entries(e))t[n]=T(r)?[...r]:r;return t}function M(e,t){const n=new Map;return"forEachMismatch"in e&&e.forEachMismatch((e,r,a,i)=>{e===o.oq&&n.set(t+r,i)}),n}new Map,new Map},47785(e,t,n){n.r(t),n.d(t,{getDefaultValue:()=>s,getEnumerationValues:()=>l,getPropertyType:()=>i,getSubType:()=>a,getUnionSubTypes:()=>o,resolveLateType:()=>c});var r=n(99226);function a(e){let t;if((0,r.isOptionalType)(e))t=e._subtype||e.type;else{if(!(0,r.isArrayType)(e)&&!(0,r.isMapType)(e)){if("function"==typeof e.getSubType)return e.getSubType();throw new TypeError("unsupported mst type")}t=e._subtype||e._subType||e.subType}if(!t)throw new Error("failed to get subtype");return t}function o(e){if(!(0,r.isUnionType)(e))throw new TypeError("not an MST union type");const t=e._types||e.types||a(e)._types||a(e).types;if(!t)throw new Error("failed to extract subtypes from mst union");return t}function i(e,t){return e.properties[t]}function s(e){if(!(0,r.isOptionalType)(e))throw new TypeError("type must be an optional type");return e._defaultValue||e.defaultValue}function l(e){return o(e).map(e=>e.value)}function c(e){return(0,r.isUnionType)(e)||(0,r.isArrayType)(e)||!(0,r.isLateType)(e)?e:e.getSubType()}},47864(e,t,n){n.d(t,{A:()=>k});var r=n(77251),a=n(65045),o=n(33579),i=n(15943),s=n(64074),l=n(30936),c=n(42918),d=n(43506),u=n(66489),p=n(74919),h=n(13737),g=n(32118);const m=(0,c.lazy)(()=>n.e(4820).then(n.bind(n,64820)));function f(){const e=(0,l.c)(6),[t,n]=(0,c.useState)(!1);let r,a,o,i;return e[0]===Symbol.for("react.memo_cache_sentinel")?(r=()=>{n(!0)},e[0]=r):r=e[0],e[1]===Symbol.for("react.memo_cache_sentinel")?(a=(0,g.jsx)(p.A,{onClick:r,size:"small",children:(0,g.jsx)(d.A,{fontSize:"small"})}),e[1]=a):a=e[1],e[2]!==t?(o=t?(0,g.jsx)(c.Suspense,{fallback:null,children:(0,g.jsx)(m,{handleClose:()=>{n(!1)}})}):null,e[2]=t,e[3]=o):o=e[3],e[4]!==o?(i=(0,g.jsxs)(g.Fragment,{children:[a,o]}),e[4]=o,e[5]=i):i=e[5],i}function y(e){const t=(0,l.c)(6),{showHelp:n}=e;let r,a,o,i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(r={marginRight:7},a=(0,g.jsx)(u.A,{fontSize:"small"}),t[0]=r,t[1]=a):(r=t[0],a=t[1]),t[2]!==n?(o=n?(0,g.jsx)(f,{}):null,t[2]=n,t[3]=o):o=t[3],t[4]!==o?(i=(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)(h.A,{position:"end",style:r,children:[a,o]})}),t[4]=o,t[5]=i):i=t[5],i}var b=n(54077),w=n(84182),v=n(56097);const S=(0,a.n)()({headerRefName:{minWidth:100}}),k=(0,s.observer)(function({model:e,showHelp:t=!0}){const{classes:n}=S(),a=(0,o.A)(),s=(0,r.getSession)(e),{textSearchManager:l,assemblyManager:c}=s,{assemblyNames:d,rankSearchResults:u}=e,p=d[0],h=c.get(p),m=e.searchScope(p);return(0,g.jsx)(b.A,{onSelect:async t=>{try{await async function({option:e,model:t,assemblyName:n}){const{assemblyManager:a}=(0,r.getSession)(t),o=a.get(n);e.hasLocation()?await(0,w.Kd)({option:e,model:t,assemblyName:n}):e.results?.length?t.setSearchResults(e.results,e.getLabel()):o&&await(0,w.cm)({input:e.getLabel(),assembly:o,model:t})}({model:e,assemblyName:p,option:t})}catch(t){console.error(t),(0,r.getSession)(e).notify(`${t}`,"warning")}},assemblyName:p,fetchResults:e=>(0,w.Jf)({queryString:e,searchScope:m,rankSearchResults:u,textSearchManager:l,assembly:h}),model:e,minWidth:175,TextFieldProps:{variant:"outlined",className:n.headerRefName,style:{margin:v.Es},slotProps:{input:{style:{padding:0,height:v.P5,background:(0,i.X4)(a.palette.background.paper,.8)},endAdornment:(0,g.jsx)(y,{showHelp:t})}}}})})},48455(e,t,n){n.d(t,{L:()=>d});var r=n(96852),a=n(9768),o=n(10596),i=n(54523),s=n(24644),l=n(86618),c=n(12644);class d extends i.D{async getHeader(e){return null}async getMetadata(e){return null}getFeaturesInRegion(e,t={}){return(0,l.ObservableCreate)(async n=>{await this.hasDataForRefName(e.refName,t)?this.getFeatures(e,t).subscribe(n):n.complete()})}getFeaturesInMultipleRegions(e,t={}){return(0,a.h)(...e.map(e=>this.getFeaturesInRegion(e,t)))}async hasDataForRefName(e,t={}){return(await this.getRefNames(t)).includes(e)}async getRegionQuantitativeStats(e,t){const n=this.getFeatures(e,{...t,statsEstimationMode:!0});return(0,c.qn)(e,n)}async getMultiRegionQuantitativeStats(e=[],t){if(!e.length)return(0,c.Yv)();const n=await Promise.all(e.map(e=>this.getRegionQuantitativeStats(e,t)));return(0,s.iz)(n)}getRegionFeatureDensityStats(e,t){return(0,s.GY)(e,(e,t)=>this.getFeatures(e,t),t)}async getMultiRegionFeatureDensityStats(e,t){if(!e.length)throw new Error("No regions supplied");return this.getRegionFeatureDensityStats(e[0],t)}async getSources(e){const t=await(0,r._)(this.getFeaturesInMultipleRegions(e).pipe((0,o.$)())),n=new Set;for(const e of t)n.add(e.get("source"));return[...n].map(e=>({name:e}))}async getExportData(e,t,n){}}},48635(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.draw=e.draw,this.getChildFeatures=e.getChildFeatures,this.getHeightMultiplier=e.getHeightMultiplier,this.getSubfeatureMouseover=e.getSubfeatureMouseover,this.match=e.match,this.priority=e.priority??0}}},49647(e,t,n){n.d(t,{A:()=>a});class r{padding=1;intervals=[];data=[];setAllFilled(e){this.allFilled=e}getIntervals(){return this.intervals}getItemAt(e){if(this.allFilled)return this.allFilled;const t=this.intervals,n=t.length;if(0===n)return;if(n<40){for(let r=0;r<n;r+=2)if(e>=t[r]&&e<t[r+1])return this.data[r>>1];return}let r=0,a=n>>1;for(;r<a;){const n=r+a>>>1;t[1+(n<<1)]<=e?r=n+1:a=n}const o=r<<1;return o<n&&e>=t[o]&&e<t[o+1]?this.data[r]:void 0}isRangeClear(e,t){if(this.allFilled)return!1;const n=this.intervals,r=n.length;if(0===r)return!0;if(r<40){for(let a=0;a<r;a+=2){const r=n[a];if(n[a+1]>e&&r<t)return!1}return!0}let a=0,o=r>>1;for(;a<o;){const t=a+o>>>1;n[1+(t<<1)]<=e?a=t+1:o=t}const i=a<<1;return i>=r||n[i]>=t}addRect(e,t){const n=e.l,r=e.r+this.padding,a=this.intervals,o=a.length;if(o<40){let e=o;for(let t=0;t<o;t+=2)if(n<a[t]){e=t;break}a.splice(e,0,n,r),this.data.splice(e>>1,0,t)}else{let e=0,i=o>>1;for(;e<i;){const t=e+i>>>1;a[t<<1]<n?e=t+1:i=t}a.splice(e<<1,0,n,r),this.data.splice(e,0,t)}}discardRange(e,t){if(this.allFilled)return;const n=this.intervals,r=this.data,a=n.length,o=[],i=[];for(let s=0;s<a;s+=2){const a=n[s],l=n[s+1],c=r[s>>1];a>=e&&l<=t||(l<=e||a>=t?(o.push(a,l),i.push(c)):a<e&&l>e?l<=t?(o.push(a,e),i.push(c)):(o.push(a,e,t,l),i.push(c,c)):a<t&&l>t&&(o.push(t,l),i.push(c)))}this.intervals=o,this.data=i}}class a{constructor({pitchX:e=10,pitchY:t=10,maxHeight:n=1e4,hardRowLimit:r=1e4,displayMode:a="normal"}={}){this.pitchX=e,this.pitchY=t,this.hardRowLimit=r,this.maxHeightReached=!1,this.displayMode=a,"compact"===this.displayMode&&(this.pitchY=Math.round(this.pitchY/4)||1,this.pitchX=Math.round(this.pitchX/4)||1),this.bitmap=[],this.rectangles=new Map,this.maxHeight=Math.ceil(n/this.pitchY),this.pTotalHeight=0}addRect(e,t,n,r,a,o,i){const s=this.pitchX,l=this.pitchY,c=this.rectangles.get(e);if(c)return void 0!==o&&(c.serializableData=o),null===c.top?null:(this.addRectToBitmap(c),c.top*l);const d=Math.trunc(t/s),u=Math.trunc(n/s),p=Math.ceil(r/l),h={id:e,l:d,r:u,top:null,h:p,originalHeight:r,data:a,serializableData:o},g=this.maxHeight;let m=void 0!==i?Math.min(Math.floor(i/l),g):0;if("collapse"!==this.displayMode){const t=this.bitmap;e:for(;m<=g;m+=1){const e=m+p;for(let n=m;n<e;n+=1){const e=t[n];if(!e)continue;if(e.allFilled)continue e;const r=e.getIntervals(),a=r.length;if(a>0)if(a<40)for(let e=0;e<a;e+=2){const t=r[e];if(r[e+1]>d&&t<u)continue e}else{let e=0,t=a>>1;for(;e<t;){const n=e+t>>>1;r[1+(n<<1)]<=d?e=n+1:t=n}const n=e<<1;if(n<a&&r[n]<u)continue e}}break}if(m>g)return h.top=null,this.rectangles.set(e,h),this.maxHeightReached=!0,null}return h.top=m,this.addRectToBitmap(h),this.rectangles.set(e,h),this.pTotalHeight=Math.max(this.pTotalHeight||0,m+p),m*l}collides(e,t){const{bitmap:n}=this,r=t+e.h;for(let a=t;a<r;a+=1){const t=n[a];if(void 0!==t&&!t.isRangeClear(e.l,e.r))return!0}return!1}addRectToBitmap(e){if(null===e.top)return;const t=e.id,n=e.top+e.h,a=this.bitmap,o=this.hardRowLimit,i=this.pitchY;if(e.r-e.l>2e4)for(let s=e.top;s<n;s+=1){let e=a[s];if(!e){if(s>o)throw new Error(`layout hard limit (${o*i}px) exceeded, aborting layout`);e=new r,a[s]=e}e.setAllFilled(t)}else for(let s=e.top;s<n;s+=1){let n=a[s];if(!n){if(s>o)throw new Error(`layout hard limit (${o*i}px) exceeded, aborting layout`);n=new r,a[s]=n}n.addRect(e,t)}}discardRange(e,t){const n=Math.trunc(e/this.pitchX),r=Math.trunc(t/this.pitchX),{bitmap:a}=this;for(const e of a)e.discardRange(n,r)}hasSeen(e){return this.rectangles.has(e)}getByCoord(e,t){const n=Math.trunc(t/this.pitchY),r=this.bitmap[n];if(!r)return;const a=Math.trunc(e/this.pitchX);return r.getItemAt(a)}getByID(e){const t=this.rectangles.get(e);if(t){const e=t.top*this.pitchY;return[t.l*this.pitchX,e,t.r*this.pitchX,e+t.originalHeight]}}getDataByID(e){return this.rectangles.get(e)?.data}getSerializableDataByID(e){return this.rectangles.get(e)?.serializableData}cleanup(){}getTotalHeight(){return this.pTotalHeight*this.pitchY}get totalHeight(){return this.getTotalHeight()}getRectangles(){const e=this.pitchX,t=this.pitchY;return new Map([...this.rectangles.entries()].map(([n,r])=>{const{l:a,r:o,originalHeight:i,top:s,serializableData:l}=r,c=(s||0)*t;return[n,[a*e,c,o*e,c+i,l]]}))}serializeRegion(e){const t=this.pitchX,n=this.pitchY,r=e.start,a=e.end,o={};let i=!1;for(const[e,s]of this.rectangles.entries()){const{l,r:c,originalHeight:d,top:u}=s;if(null===u)i=!0;else{const i=u*n,p=i+d,h=l*t,g=c*t;a>=h-t&&g+t>=r&&(o[e]=[h,i,g,p,s.serializableData])}}return{rectangles:o,totalHeight:this.getTotalHeight(),maxHeightReached:i}}toJSON(){return{rectangles:Object.fromEntries(this.getRectangles()),totalHeight:this.getTotalHeight(),maxHeightReached:this.maxHeightReached}}}},50639(e,t,n){n.d(t,{A:()=>p});var r=n(30936),a=n(42918),o=n(61762),i=n(10855),s=n.n(i),l=n(77251),c=n(32118);let d=!1;const u=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","sup","sub","td","tfoot","th","thead","tr","u","ul"].map(e=>String.raw`<${e}\b[^>]*>`).join("|"),"i");function p(e){const t=(0,r.c)(6),{html:n,className:i}=e,d=(0,l.linkify)(`${n}`),p=(g=d,u.test(g)?d:s()(d));var g;let m;t[0]===Symbol.for("react.memo_cache_sentinel")?(m=[],t[0]=m):m=t[0],(0,a.useEffect)(h,m);const f=o.A.sanitize(p);let y,b;return t[1]!==f?(y={__html:f},t[1]=f,t[2]=y):y=t[2],t[3]!==i||t[4]!==y?(b=(0,c.jsx)("span",{className:i,dangerouslySetInnerHTML:y}),t[3]=i,t[4]=y,t[5]=b):b=t[5],b}function h(){d||(d=!0,o.A.addHook("afterSanitizeAttributes",g))}function g(e){"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}},51800(e,t,n){n.d(t,{cx:()=>a});var r=n(45514);function a(...e){return(0,r.p)(e)}},52901(e,t,n){function r(e){return{time:Date.now(),iters:0,stopToken:e}}function a(){return URL.createObjectURL?.(new Blob)||`${Math.random()}`}function o(e){try{return"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}catch{return!1}}function i(e){void 0!==e&&(o(e)?Atomics.store(new Int32Array(e),0,1):URL.revokeObjectURL?.(e))}function s(e){if(void 0!==e)if(o(e)){if(1===Atomics.load(new Int32Array(e),0))throw new Error("aborted")}else if("undefined"==typeof jest&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope){const t=new XMLHttpRequest;t.open("GET",e,!1);try{t.send(null)}catch{throw new Error("aborted")}}}function l(e){if(!e)return;const{stopToken:t,backoff:n=!0,checkInterval:r=50,checkIters:a=100}=e;if(e.iters++,void 0===t)return;if(e.iters%a!==0)return;o(t)&&s(t);const i=Date.now();i-e.time>r&&(e.time=i,s(t),n&&(e.checkInterval??=r,e.checkInterval+=r))}function c(e,t,n,r=400,a=100,o=!0){const i={time:Date.now(),iters:0,checkInterval:r,backoff:o,checkIters:a,stopToken:t};let s=0;for(const t of e)n(t,s++),l(i)}n.d(t,{SW:()=>s,As:()=>l,y5:()=>a,jL:()=>r,ib:()=>c,CF:()=>i})},53155(e,t,n){function r(e){return"object"==typeof e&&null!==e&&"function"==typeof e.get&&"function"==typeof e.id}function a(e){return"uniqueId"in e&&"object"!=typeof e.data}n.d(t,{A:()=>o,l:()=>r});class o{constructor(e){a(e)?this.data=e:(this.data=e.data,this.parentHandle=e.parent);const t=a(e)?e.uniqueId:e.id;if(null==t)throw new Error("SimpleFeature requires a unique `id` or `data.uniqueId` attribute");if(this.uniqueId=String(t),!(this.data.aliases||this.data.end-this.data.start>=0))throw new Error(`invalid feature data, end less than start. end: ${this.data.end} start: ${this.data.start}`);this.data.subfeatures&&(this.subfeatures=this.data.subfeatures?.map((e,n)=>"function"!=typeof e.get?new o({id:e.uniqueId||`${t}-${n}`,data:{strand:this.data.strand,...e},parent:this}):e))}get(e){return"subfeatures"===e?this.subfeatures:"parent"===e?this.parent():this.data[e]}set(e,t){this.data[e]=t}tags(){return Object.keys(this.data)}id(){return this.uniqueId}parent(){return this.parentHandle}children(){return this.get("subfeatures")}toJSON(){const e={...this.data,uniqueId:this.id()},t=this.parent();t&&(e.parentId=t.id());const n=this.children();return n&&(e.subfeatures=n.map(e=>e.toJSON())),e}static fromJSON(e){return new o({...e})}}},53205(e,t,n){n.d(t,{Fw:()=>s,Nw:()=>c,T9:()=>d,XY:()=>i.X,pc:()=>i.p,pv:()=>l});var r=n(81275),a=n(45136),o=n.n(a),i=n(26931);function s(e){return"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap}function l(e,t){e.serializedCommands?new r.w(e.serializedCommands).execute(t):t.drawImage(e,0,0)}function c(e,t){if("function"==typeof OffscreenCanvas)return new OffscreenCanvas(e,t);if(o())return nodeCreateCanvas(e,t);{const n=new r.w;return{width:e,height:t,getContext:()=>n}}}async function d(e){if("function"==typeof OffscreenCanvas)return e.transferToImageBitmap();if(o()){const t=e.toDataURL(),n=new nodeImage;return new Promise((e,r)=>{n.onload=()=>{e(n)},n.onerror=r,n.src=t})}{const t=e.getContext("2d");return{height:e.height,width:e.width,serializedCommands:t.toJSON()}}}},53504(e,t,n){n.d(t,{f:()=>i,m:()=>o});const r=/^(-?\d+)(?:(?:\.\.|[-–])(-?\d+))?(\.\.|[-–])?$/,a=/^(?:\{([^}]+)\})?(.+)/;function o(e,t){if(!e)throw new Error("no location string provided, could not parse");let n=!1;e.endsWith("[rev]")&&(n=!0,e=e.slice(0,-5)),e=e.replaceAll(/\s/g,"");const o=a.exec(e);if(!o)throw new Error(`invalid location string: "${e}"`);const[,i,s]=o;if(!i&&s.startsWith("{}"))throw new Error(`no assembly name was provided in location "${s}"`);const l=s.lastIndexOf(":");if(-1===l){if(t(s,i))return{assemblyName:i,refName:s,reversed:n};throw new Error(`Unknown feature or sequence "${s}"`)}const c=s.slice(0,l),d=s.slice(l+1),u=t(c,i),p=t(s,i);if(u&&p)throw new Error(`ambiguous location string: "${e}"`);if(p)return{assemblyName:i,refName:s,reversed:n};if(u){if(!d)return{assemblyName:i,refName:c,reversed:n};const t=function(e,t){const n=r.exec(e.replaceAll(",",""));if(!n)throw new Error(`could not parse range "${e}" on location "${t}"`);const[,a,o,i]=n,s=+a;return{start:s,end:o?+o:i?void 0:s}}(d,e);return{assemblyName:i,refName:c,reversed:n,...t}}throw new Error(`unknown reference sequence name in location "${e}"`)}function i(e,t){const n=o(e,t);return"number"==typeof n.start&&(n.start-=1),n}},53705(e,t,n){n.d(t,{$G:()=>o,Db:()=>i,fK:()=>s,mh:()=>r});class r{constructor(e=[]){this.blocks=e}*[Symbol.iterator](){yield*this.blocks}push(e){if("ElidedBlock"===e.type&&this.blocks.length>0){const t=this.blocks.at(-1);if("ElidedBlock"===t?.type)return void t.push(e)}this.blocks.push(e)}getBlocks(){return this.blocks}getRegions(){return this.blocks.map(e=>e.toRegion())}map(e,t){return this.blocks.map(e,t)}forEach(e,t){this.blocks.forEach(e,t)}get length(){return this.blocks.length}get totalWidthPx(){let e=0;for(let t=0,n=this.blocks.length;t<n;t++)e+=this.blocks[t].widthPx;return e}get totalWidthPxWithoutBorders(){let e=0;for(let t=0,n=this.blocks.length;t<n;t++)"boundary"!==this.blocks[t].variant&&(e+=this.blocks[t].widthPx);return e}get offsetPx(){return this.blocks.length>0?this.blocks[0].offsetPx:0}get contentBlocks(){return this.blocks.filter(e=>"ContentBlock"===e.type)}get totalBp(){let e=0;for(let t=0,n=this.contentBlocks.length;t<n;t++){const n=this.contentBlocks[t];e+=n.end-n.start}return e}}class a{type="BaseBlock";widthPx=0;constructor(e){Object.assign(this,e),this.assemblyName=e.assemblyName,this.refName=e.refName,this.start=e.start,this.end=e.end,this.key=e.key,this.offsetPx=e.offsetPx}toRegion(){return{refName:this.refName,start:this.start,end:this.end,assemblyName:this.assemblyName,reversed:this.reversed}}}class o extends a{type="ContentBlock"}class i extends a{type="ElidedBlock";elidedBlockCount=0;constructor(e){super(e),this.widthPx=e.widthPx}push(e){this.elidedBlockCount+=1,this.refName="",this.start=0,this.end=0,this.widthPx+=e.widthPx}}class s extends a{type="InterRegionPaddingBlock"}},53732(e,t,n){function r(e,t){return`${(e.startsWith("metadata.")?t.metadata?.[e.replace("metadata.","")]:t[e])||""}`}n.d(t,{a:()=>r})},54077(e,t,n){n.d(t,{A:()=>p});var r=n(42918),a=n(80009),o=n(77251),i=n(85441),s=n(64074),l=n(30936),c=n(15675),d=n(32118);function u(e){const t=(0,l.c)(23),{TextFieldProps:n,inputBoxVal:r,params:a,setInputValue:o,setCurrentSearch:i}=e,{helperText:s,slotProps:u}=n;let p;t[0]!==u?(p=void 0===u?{}:u,t[0]=u,t[1]=p):p=t[1];const h=p;let g,m,f,y,b,w,v;if(t[2]!==a.InputProps?(({ref:g,...m}=a.InputProps),t[2]=a.InputProps,t[3]=g,t[4]=m):(g=t[3],m=t[4]),t[5]!==a){const{InputProps:e,...n}=a;f=n,t[5]=a,t[6]=f}else f=t[6];return t[7]!==r||t[8]!==o?(y=()=>{o(r)},t[7]=r,t[8]=o,t[9]=y):y=t[9],t[10]!==m||t[11]!==h.input?(b={input:{...m,...h.input}},t[10]=m,t[11]=h.input,t[12]=b):b=t[12],t[13]!==i?(w=e=>{i(e.target.value)},t[13]=i,t[14]=w):w=t[14],t[15]!==n||t[16]!==s||t[17]!==g||t[18]!==f||t[19]!==y||t[20]!==b||t[21]!==w?(v=(0,d.jsx)(c.A,{onBlur:y,...f,...n,inputRef:g,size:"small",helperText:s,slotProps:b,placeholder:"Search for location",onChange:w}),t[15]=n,t[16]=s,t[17]=g,t[18]=f,t[19]=y,t[20]=b,t[21]=w,t[22]=v):v=t[22],v}const p=(0,s.observer)(function({model:e,onSelect:t,assemblyName:n,style:s,fetchResults:l,onChange:c,value:p,minWidth:h=200,maxWidth:g=550,TextFieldProps:m={}}){const f=(0,o.getSession)(e),{assemblyManager:y}=f,[b,w]=(0,r.useState)(!1),[v,S]=(0,r.useState)(!0),[k,x]=(0,r.useState)(""),[C,T]=(0,r.useState)(""),[A,M]=(0,r.useState)(),P=(0,o.useDebounce)(k,50),I=n?y.get(n):void 0,{coarseVisibleLocStrings:R,hasDisplayedRegions:L}=e;(0,r.useEffect)(()=>{const e={cancelled:!1};return(async()=>{try{if(""===P||!n)return;S(!1);const t=await l(P);e.cancelled||M(function(e){return Object.entries(function(e){const t={};for(const n of e){const e=n.getDisplayString();t[e]||(t[e]=[]),t[e].push(n)}return t}(e)).map(([e,t])=>1===t.length?{result:t[0]}:{result:new a.A({displayString:e,results:t,label:e})})}(t))}catch(t){console.error(t),e.cancelled||f.notifyError(`${t}`,t)}finally{e.cancelled||S(!0)}})(),()=>{e.cancelled=!0}},[n,l,P,f]);const F=R||p||"",D=I?.regions,N=(0,r.useMemo)(()=>D?.map(e=>({result:new a.S({refName:e.refName,label:e.refName,displayString:e.refName,matchedAttribute:"refName"})}))||[],[D]);return(0,d.jsx)(i.A,{"data-testid":"autocomplete",disableListWrap:!0,disableClearable:!0,disabled:!n,freeSolo:!0,includeInputInList:!0,selectOnFocus:!0,style:{...s,width:Math.min(Math.max((0,o.measureText)(F,14)+100,h),g)},value:F,loading:!v,inputValue:C,onInputChange:(e,t)=>{T(t),c?.(t)},loadingText:"loading results",open:b,onOpen:()=>{w(!0)},onClose:()=>{w(!1),S(!0),L&&(x(""),M(void 0))},onChange:(e,r)=>{r&&n&&(t?.("string"==typeof r?new a.A({label:r}):r.result),T(F))},options:A?.length?A:N,getOptionDisabled:e=>"limitOption"===e.group,filterOptions:(e,{inputValue:t})=>function(e,t){const n=(r=e,o=t.toLocaleLowerCase(),r.filter(({result:e})=>e.getLabel().toLowerCase().includes(o)||e.matchedObject));var r,o;return[...n.slice(0,100),...n.length>100?[{group:"limitOption",result:new a.A({label:"keep typing for more results"})}]:[]]}(e,t),renderInput:e=>(0,d.jsx)(u,{params:e,inputBoxVal:F,TextFieldProps:m,setCurrentSearch:x,setInputValue:T}),getOptionLabel:e=>"string"==typeof e?e:e.result.getDisplayString()})})},54257(e,t,n){n.d(t,{D:()=>i,Q6:()=>d,YX:()=>o,bU:()=>l,eC:()=>s,i2:()=>u,iz:()=>p,jm:()=>a,oq:()=>r,xi:()=>c});const r=0,a=1,o=2,i=3,s=4,l=5,c=50,d=12,u=["mismatch","insertion","deletion","skip","softclip","hardclip"],p={mismatch:0,insertion:1,deletion:2,skip:3,softclip:4,hardclip:5}},54351(e,t,n){n.d(t,{A:()=>r});class r{install(e){}configure(e){}}},54523(e,t,n){n.d(t,{D:()=>l});var r=n(99226),a=n(87877),o=n(11259),i=n(70312);const s=(0,a.S7)("empty",{});class l{static capabilities=[];constructor(e=s.create(),t,n){if(this.config=e,this.getSubAdapter=t,this.pluginManager=n,"undefined"==typeof jest){const t=(0,r.isStateTreeNode)(e)?(0,r.getSnapshot)(e):e;this.id=`${(0,i.A)(t)}`}else this.id="test"}setSequenceAdapterConfig(e){this.sequenceAdapterConfig=e}getConf(e){return(0,o.QZ)(this.config,e)}freeResources(e){}}},56097(e,t,n){n.d(t,{Es:()=>l,Gu:()=>a,Ij:()=>r,P5:()=>c,Rd:()=>s,i3:()=>i,jE:()=>o});const r=48,a=20,o=17,i=3,s=2,l=7,c=32},57141(e,t,n){n.d(t,{A:()=>o});class r{ids=[];values=[];length=0;clear(){this.length=0}push(e,t){let n=this.length++;for(;n>0;){const e=n-1>>1,r=this.values[e];if(t>=r)break;this.ids[n]=this.ids[e],this.values[n]=r,n=e}this.ids[n]=e,this.values[n]=t}pop(){if(0===this.length)return;const e=this.ids,t=this.values,n=e[0],r=--this.length;if(r>0){const n=e[r],a=t[r];let o=0;const i=r>>1;for(;o<i;){const n=1+(o<<1),i=n+1,s=n+(+(i<r)&+(t[i]<t[n]));if(t[s]>=a)break;e[o]=e[s],t[o]=t[s],o=s}e[o]=n,t[o]=a}return n}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}const a=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class o{static from(e,t=0){if(t%8!=0)throw new Error("byteOffset must be 8-byte aligned.");if(0===e.byteLength)throw new Error("Flatbush data buffer is detached (byteLength=0). This usually means the buffer was transferred and is no longer usable.");const[n,r]=new Uint8Array(e,t+0,2);if(251!==n)throw new Error("Data does not appear to be in a Flatbush format.");const i=r>>4;if(3!==i)throw new Error(`Got v${i} data when expected v3.`);const s=a[15&r];if(!s)throw new Error("Unrecognized array type.");const[l]=new Uint16Array(e,t+2,1),[c]=new Uint32Array(e,t+4,1);return new o(c,l,s,void 0,e,t)}constructor(e,t=16,n=Float64Array,o=ArrayBuffer,i,s=0){if(isNaN(e)||e<=0)throw new Error(`Unexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+t,2),65535),this.byteOffset=s;let l=e,c=l;this._levelBounds=[4*l];do{l=Math.ceil(l/this.nodeSize),c+=l,this._levelBounds.push(4*c)}while(1!==l);this.ArrayType=n,this.IndexArrayType=c<16384?Uint16Array:Uint32Array;const d=a.indexOf(n),u=4*c*n.BYTES_PER_ELEMENT;if(-1===d)throw new Error(`Unexpected typed array class: ${n}.`);if(i)this.data=i,this._boxes=new n(i,s+8,4*c),this._indices=new this.IndexArrayType(i,s+8+u,c),this._pos=4*c,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{const r=this.data=new o(8+u+c*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new n(r,8,4*c),this._indices=new this.IndexArrayType(r,8+u,c),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(r,0,2).set([251,48+d]),new Uint16Array(r,2,1)[0]=t,new Uint32Array(r,4,1)[0]=e}this._queue=new r}add(e,t,n=e,r=t){const a=this._pos>>2,o=this._boxes;return this._indices[a]=a,o[this._pos++]=e,o[this._pos++]=t,o[this._pos++]=n,o[this._pos++]=r,e<this.minX&&(this.minX=e),t<this.minY&&(this.minY=t),n>this.maxX&&(this.maxX=n),r>this.maxY&&(this.maxY=r),a}finish(){if(this._pos>>2!==this.numItems)throw new Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);const e=this._boxes;if(this.numItems<=this.nodeSize)return e[this._pos++]=this.minX,e[this._pos++]=this.minY,e[this._pos++]=this.maxX,void(e[this._pos++]=this.maxY);const t=this.maxX-this.minX||1,n=this.maxY-this.minY||1,r=new Uint32Array(this.numItems),a=65535/t,o=65535/n,i=this.minX,d=this.minY;for(let t=0,n=0;t<this.numItems;t++){const s=e[n++],l=e[n++],u=e[n++],p=e[n++],h=Math.floor((.5*(s+u)-i)*a),g=Math.floor((.5*(l+p)-d)*o);r[t]=c(h,g)}!function(e,t,n,r,a,o){const i=[0,a];for(;i.length>0;){const r=i.pop(),a=i.pop();if(Math.floor(a/o)>=Math.floor(r/o))continue;if(r-a<10){s(e,t,n,a,r);continue}const c=e[a],d=e[a+r>>1],u=e[r];let p=u;const h=Math.max(c,d);u>h?p=h:h===c?p=Math.max(d,u):h===d&&(p=Math.max(c,u));let g=a-1,m=r+1;for(;;){do{g++}while(e[g]<p);do{m--}while(e[m]>p);if(g>=m)break;l(e,t,n,g,m)}i.push(a,m,m+1,r)}}(r,e,this._indices,0,this.numItems-1,this.nodeSize);for(let t=0,n=0;t<this._levelBounds.length-1;t++){const r=this._levelBounds[t];for(;n<r;){const t=n;let a=e[n++],o=e[n++],i=e[n++],s=e[n++];for(let t=1;t<this.nodeSize&&n<r;t++){const t=e[n++],r=e[n++],l=e[n++],c=e[n++];t<a&&(a=t),r<o&&(o=r),l>i&&(i=l),c>s&&(s=c)}this._indices[this._pos>>2]=t,e[this._pos++]=a,e[this._pos++]=o,e[this._pos++]=i,e[this._pos++]=s}}}search(e,t,n,r,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const s=[],l=[];for(;void 0!==o;){const c=Math.min(o+4*this.nodeSize,i(o,this._levelBounds));for(let i=o;i<c;i+=4){const c=this._boxes[i];if(n<c)continue;const d=this._boxes[i+1];if(r<d)continue;const u=this._boxes[i+2];if(e>u)continue;const p=this._boxes[i+3];if(t>p)continue;const h=0|this._indices[i>>2];o>=4*this.numItems?s.push(h):(void 0===a||a(h,c,d,u,p))&&l.push(h)}o=s.pop()}return l}neighbors(e,t,n=1/0,r=1/0,a){if(this._pos!==this._boxes.length)throw new Error("Data not yet indexed - call index.finish().");let o=this._boxes.length-4;const s=this._queue,l=[],c=r*r;e:for(;void 0!==o;){const r=Math.min(o+4*this.nodeSize,i(o,this._levelBounds));for(let n=o;n<r;n+=4){const r=0|this._indices[n>>2],i=this._boxes[n],l=this._boxes[n+1],d=this._boxes[n+2],u=this._boxes[n+3],p=e<i?i-e:e>d?e-d:0,h=t<l?l-t:t>u?t-u:0,g=p*p+h*h;g>c||(o>=4*this.numItems?s.push(r<<1,g):(void 0===a||a(r))&&s.push(1+(r<<1),g))}for(;s.length&&1&s.peek();){if(s.peekValue()>c)break e;if(l.push(s.pop()>>1),l.length===n)break e}o=s.length?s.pop()>>1:void 0}return s.clear(),l}}function i(e,t){let n=0,r=t.length-1;for(;n<r;){const a=n+r>>1;t[a]>e?r=a:n=a+1}return t[n]}function s(e,t,n,r,a){for(let o=r+1;o<=a;o++){const a=e[o],i=n[o],s=4*o,l=t[s],c=t[s+1],d=t[s+2],u=t[s+3];let p=o-1;for(;p>=r&&e[p]>a;){e[p+1]=e[p],n[p+1]=n[p];const r=4*p,a=4*(p+1);t[a]=t[r],t[a+1]=t[r+1],t[a+2]=t[r+2],t[a+3]=t[r+3],p--}e[p+1]=a,n[p+1]=i;const h=4*(p+1);t[h]=l,t[h+1]=c,t[h+2]=d,t[h+3]=u}}function l(e,t,n,r,a){const o=e[r];e[r]=e[a],e[a]=o;const i=4*r,s=4*a,l=t[i],c=t[i+1],d=t[i+2],u=t[i+3];t[i]=t[s],t[i+1]=t[s+1],t[i+2]=t[s+2],t[i+3]=t[s+3],t[s]=l,t[s+1]=c,t[s+2]=d,t[s+3]=u;const p=n[r];n[r]=n[a],n[a]=p}function c(e,t){let n=e^t,r=65535^n,a=65535^(e|t),o=e&(65535^t),i=n|r>>1,s=n>>1^n,l=a>>1^r&o>>1^a,c=n&a>>1^o>>1^o;n=i,r=s,a=l,o=c,i=n&n>>2^r&r>>2,s=n&r>>2^r&(n^r)>>2,l^=n&a>>2^r&o>>2,c^=r&a>>2^(n^r)&o>>2,n=i,r=s,a=l,o=c,i=n&n>>4^r&r>>4,s=n&r>>4^r&(n^r)>>4,l^=n&a>>4^r&o>>4,c^=r&a>>4^(n^r)&o>>4,n=i,r=s,a=l,o=c,l^=n&a>>8^r&o>>8,c^=r&a>>8^(n^r)&o>>8,n=l^l>>1,r=c^c>>1;let d=e^t,u=r|65535^(d|n);return d=16711935&(d|d<<8),d=252645135&(d|d<<4),d=858993459&(d|d<<2),d=1431655765&(d|d<<1),u=16711935&(u|u<<8),u=252645135&(u|u<<4),u=858993459&(u|u<<2),u=1431655765&(u|u<<1),(u<<1|d)>>>0}},58730(e,t,n){n.d(t,{L:()=>M});var r=n(42918),a=n(87877),o=n(11259),i=n(62296),s=n(77251),l=n(53155),c=n(10525);class d{constructor(e){this.submaps=e}has(e){for(const t of this.submaps.values())if(t.has(e))return!0;return!1}get(e){for(const t of this.submaps.values())if(t.has(e))return t.get(e)}*values(){for(const e of this.keys())yield this.get(e)}*keys(){const e=new Set;for(const t of this.submaps.values())for(const n of t.keys())e.add(n);for(const t of e)yield t}find(e){for(const t of this.submaps.values())for(const n of t.values())if(e(n))return n}*[Symbol.iterator](){for(const e of this.keys())yield[e,this.get(e)]}*entries(){for(const e of this.keys())yield[e,this.get(e)]}}var u=n(70203),p=n(99226),h=n(13253),g=n(49132),m=n(2193),f=n(27214),y=n(38567),b=n(29463),w=n(3231),v=n(27768),S=n(34588),k=n(98612),x=n(98445),C=n(42456);const T=(0,r.lazy)(()=>n.e(2272).then(n.bind(n,72272))),A=(0,r.lazy)(()=>n.e(5913).then(n.bind(n,75913))),M=p.types.compose("BaseLinearDisplay",i.q,(0,S.A)(),(0,v.A)(),p.types.model({blockState:p.types.map(x.A),configuration:(0,a.AK)(k.A),showLegend:p.types.maybe(p.types.boolean),showTooltips:p.types.maybe(p.types.boolean)})).volatile(()=>({mouseoverExtraInformation:void 0,featureIdUnderMouse:void 0,subfeatureIdUnderMouse:void 0,contextMenuFeature:void 0})).views(e=>({get DisplayMessageComponent(){},get blockType(){return"staticBlocks"},get blockDefinitions(){const t=(0,s.getContainingView)(e);if(!t.initialized)throw new Error("view not initialized yet");return t[this.blockType]}})).views(e=>({get renderDelay(){return 50},get TooltipComponent(){return T},legendItems:e=>[],svgLegendWidth(t){return e.showLegend?(0,w.S)(this.legendItems(t)):0},get selectedFeatureId(){if((0,p.isAlive)(e)){const{selection:t}=(0,s.getSession)(e);if((0,l.l)(t))return t.id()}},get featureWidgetType(){return{type:"BaseFeatureWidget",id:"baseFeature"}}})).views(e=>({get showTooltipsEnabled(){return e.showTooltips??!0},get features(){const t=[];for(const n of e.blockState.values())n.features&&t.push(n.features);return new d(t)},get featureUnderMouse(){const t=e.featureIdUnderMouse;return t?this.features.get(t):void 0},getFeatureById(e,t){const n=this.features.get(e);if(n)return n;if(t){const n=this.features.get(t);if(n)return(0,C.IU)(n,e)}},get layoutFeatures(){const t=[];for(const n of e.blockState.values())n.layout?.getRectangles&&t.push(n.layout.getRectangles());return new d(t)},getFeatureOverlapping:(t,n,r)=>e.blockState.get(t)?.layout?.getByCoord(n,r),getFeatureByID:(t,n)=>e.blockState.get(t)?.layout?.getByID(n),searchFeatureByID(t){for(const n of e.blockState.values()){const e=n.layout?.getByID(t);if(e)return e}},get floatingLabelData(){const t=(0,s.getContainingView)(e),{assemblyManager:n}=(0,s.getSession)(e),r=t.assemblyNames[0],a=r?n.get(r):void 0;return(0,b.OM)(this.layoutFeatures,t,a,t.bpPerPx)}})).actions(e=>({addBlock(t,n){const r=x.A.create({key:t,region:n.toRegion()});r.setCachedDisplay(e),e.blockState.set(t,r)},deleteBlock(t){e.blockState.delete(t)},selectFeature(t){const n=(0,s.getSession)(e);if((0,c.mY)(n)&&n.setSelection(t),(0,c.lO)(n)){const{rpcManager:r}=n,a=(0,u.getRpcSessionId)(e),i=(0,s.getContainingTrack)(e),l=(0,s.getContainingView)(e),c=(0,o.FI)(i,"adapter"),{type:d,id:h}=e.featureWidgetType;r.call(a,"CoreGetMetadata",{adapterConfig:c}).then(r=>{(0,p.isAlive)(e)&&n.showWidget(n.addWidget(d,h,{featureData:t.toJSON(),view:l,track:i,descriptions:r}))}).catch(t=>{console.error(t),(0,s.getSession)(e).notifyError(`${t}`,t)})}},navToFeature(t){(0,s.getContainingView)(e).navTo({refName:t.get("refName"),start:t.get("start"),end:t.get("end")})},clearFeatureSelection(){(0,s.getSession)(e).clearSelection()},setFeatureIdUnderMouse(t){e.featureIdUnderMouse=t},setSubfeatureIdUnderMouse(t){e.subfeatureIdUnderMouse=t},setContextMenuFeature(t){e.contextMenuFeature=t},setMouseoverExtraInformation(t){e.mouseoverExtraInformation=t},setShowLegend(t){e.showLegend=t},setShowTooltips(t){e.showTooltips=t}})).actions(e=>{const{reload:t}=e;return{async reload(){e.setError(),e.setCurrStatsBpPerPx(0),e.clearFeatureDensityStats();for(const t of e.blockState.values())t.doReload();t()}}}).actions(e=>({selectFeatureById:(0,p.flow)(function*(t,n,r){const a=e.getFeatureById(t,n);if(a)return void e.selectFeature(a);const o=r&&r!==t?r:n;try{const n=(0,s.getSession)(e),r=yield(0,C.Ac)({rpcManager:n.rpcManager,sessionId:(0,u.getRpcSessionId)(e),trackId:(0,s.getContainingTrack)(e).id,rendererType:e.rendererTypeName,featureId:t,parentFeatureId:o});r&&(0,p.isAlive)(e)&&e.selectFeature(r)}catch(t){console.error(t),(0,s.getSession)(e).notifyError(`${t}`,t)}}),setContextMenuFeatureById:(0,p.flow)(function*(t,n,r){const a=e.getFeatureById(t,n);if(a)return void e.setContextMenuFeature(a);const o=r&&r!==t?r:n;try{const n=(0,s.getSession)(e),r=yield(0,C.Ac)({rpcManager:n.rpcManager,sessionId:(0,u.getRpcSessionId)(e),trackId:(0,s.getContainingTrack)(e).id,rendererType:e.rendererTypeName,featureId:t,parentFeatureId:o});r&&(0,p.isAlive)(e)&&e.setContextMenuFeature(r)}catch(t){console.error(t),(0,s.getSession)(e).notifyError(`${t}`,t)}})})).views(e=>({trackMenuItems:()=>[],contextMenuItems(){const t=e.contextMenuFeature,r=(0,C._1)(t);return t?[{label:"Open feature details",icon:f.A,onClick:()=>{e.selectFeature(t)}},{label:"Zoom to feature",icon:h.A,onClick:()=>{e.navToFeature(t)}},{label:"Copy info to clipboard",icon:m.A,onClick:async()=>{const{uniqueId:r,...a}=t.toJSON(),o=(0,s.getSession)(e),{default:i}=await n.e(8284).then(n.t.bind(n,88284,23));i(JSON.stringify(a,null,4)),o.notify("Copied to clipboard","success")}},...(0,C.Ud)(r)?[{label:"Collapse introns",icon:g.A,onClick:()=>{const t=(0,s.getContainingView)(e),{assemblyManager:n}=(0,s.getSession)(e),a=n.get(t.assemblyNames[0]);a&&(0,s.getSession)(e).queueDialog(e=>[A,{view:t,transcripts:r,handleClose:e,assembly:a}])}}]:[]]:[]},renderingProps:()=>({displayModel:e,onMouseMove(t,n){e.setFeatureIdUnderMouse(n)},onMouseLeave(t){e.setFeatureIdUnderMouse(void 0)},onContextMenu(t){e.setContextMenuFeature(void 0),e.clearFeatureSelection()}}),renderProps:()=>({...(0,u.getParentRenderProps)(e),notReady:!e.featureDensityStatsReady,rpcDriverName:e.effectiveRpcDriverName})})).actions(e=>({async renderSvg(t){const{renderBaseLinearDisplaySvg:r}=await n.e(5424).then(n.bind(n,75424));return r(e,t)},afterAttach(){(0,p.addDisposer)(e,(0,y.autorun)(function(){try{if(!(0,p.isAlive)(e)||e.isMinimized)return;if(!(0,s.getContainingView)(e).initialized)return;const t=e.blockDefinitions.contentBlocks,n=new Set(t.map(e=>e.key));for(const n of t)e.blockState.has(n.key)||e.addBlock(n.key,n);for(const t of e.blockState.keys())n.has(t)||e.deleteBlock(t)}catch(e){}},{name:"BaseLinearDisplayBlockDefinitions",delay:60}))}})).preProcessSnapshot(e=>{if(!e)return e;const{height:t,...n}=e;return{heightPreConfig:t,...n}}).postProcessSnapshot(e=>{const t=e,{blockState:n,...r}=t;return r})},58836(e,t,n){n.d(t,{I:()=>s});var r=n(99226),a=n(38567),o=n(8201),i=n(52901);function s(e,t,n,s,l,c,d){let u;function p(t){(0,o.Kp)(t)||(0,r.isAlive)(e)&&(console.error(t),d(t))}(0,r.addDisposer)(e,(0,a.reaction)(()=>{try{return t(e)}catch(e){return void p(e)}},async(t,a)=>{if(u&&(0,i.CF)(u),(0,r.isAlive)(e)){u=(0,i.y5)(),l(u);try{const o=await n(t,u,e,a);(0,r.isAlive)(e)&&c(o)}catch(e){p(e)}}},s)),(0,r.addDisposer)(e,()=>{u&&(0,i.CF)(u)})}},58946(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.getAdapterClass="AdapterClass"in e?async()=>e.AdapterClass:e.getAdapterClass,this.configSchema=e.configSchema,this.adapterCapabilities=e.adapterCapabilities||[],this.adapterMetadata=e.adapterMetadata}}},60586(e,t,n){n.d(t,{R:()=>r,y:()=>a});const r={m:{color:"rgb(255,0,0)",name:"5mC"},h:{color:"rgb(255,0,255)",name:"5hmC"},o:{color:"rgb(111, 78, 129)",name:"8oxoG"},f:{color:"rgb(246, 200, 95)",name:"5fC"},c:{color:"rgb(157, 216, 102)",name:"5cac"},g:{color:"rgb(255, 160, 86)",name:"5hmu"},e:{color:"rgb(141, 221, 208)",name:"5fU"},b:{color:"rgb(0,100,47)",name:"5caU"},a:{color:"rgb(51,0,111)",name:"6mA"},17082:{color:"rgb(51,153,255)",name:"pseU"},17596:{color:"rgb(102,153,0)",name:"inosine"},21839:{color:"rgb(153,0,153)",name:"4mC"}};function a(e){return r[e]?.name||e}},61132(e,t,n){function r(e,t=JSON.stringify){const n=[],r=new Set;for(const a of e){const e=t(a);r.has(e)||(n.push(a),r.add(e))}return n}n.d(t,{Q:()=>r})},61451(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.stateModel=e.stateModel,this.subDisplay=e.subDisplay,this.configSchema=e.configSchema,this.ReactComponent=e.ReactComponent,this.trackType=e.trackType,this.viewType=e.viewType,this.helpText=e.helpText}}},62296(e,t,n){n.d(t,{q:()=>l});var r=n(99226),a=n(11259),o=n(77251),i=n(70203),s=n(27868);const l=r.types.model("BaseDisplay",{id:s.K,type:r.types.string,rpcDriverName:r.types.maybe(r.types.string)}).volatile(()=>({rendererTypeName:"",error:void 0,statusMessage:void 0})).views(e=>({get RenderingComponent(){const{pluginManager:t}=(0,o.getEnv)(e);return t.getDisplayType(e.type).ReactComponent},get DisplayBlurb(){return null},get adapterConfig(){return(0,a.FI)(this.parentTrack,"adapter")},get parentTrack(){return(0,o.getContainingTrack)(e)},get isMinimized(){return this.parentTrack.minimized},get parentDisplay(){try{const t=(0,r.getParent)(e),n=t?.type;if("string"==typeof n&&n.endsWith("Display"))return t}catch{}},get effectiveRpcDriverName(){if(e.rpcDriverName)return e.rpcDriverName;if(this.parentDisplay?.effectiveRpcDriverName)return this.parentDisplay.effectiveRpcDriverName;try{return(0,a.FI)(this.parentTrack,"rpcDriverName")||void 0}catch{return}}})).views(e=>({renderProps:()=>({...(0,i.getParentRenderProps)(e),notReady:e.isMinimized||(0,o.getContainingView)(e).minimized,rpcDriverName:e.effectiveRpcDriverName}),renderingProps:()=>({displayModel:e}),get rendererType(){const{pluginManager:t}=(0,o.getEnv)(e);return t.getRendererType(e.rendererTypeName)},get DisplayMessageComponent(){},trackMenuItems:()=>[],get viewMenuActions(){return[]},regionCannotBeRendered:()=>null})).actions(e=>({setStatusMessage(t){e.statusMessage=t},setError(t){e.error=t},setRpcDriverName(t){e.rpcDriverName=t},reload(){}}))},62492(e,t,n){function r(e){return"object"==typeof e&&null!==e&&"__rpcResult"in e&&e.__rpcResult}n.d(t,{N:()=>r})},63531(e,t,n){n.r(t),n.d(t,{default:()=>h});var r=n(18543),a=n(62202),o=n.n(a),i=n(11259),s=n(49647),l=n(14800);class c{constructor(e){this.props=e}update(e){return this.props=e,this}makeLayout(){return new l.A(s.A,{maxHeight:(0,i.QZ)(this.props.config,"maxHeight"),displayMode:(0,i.QZ)(this.props.config,"displayMode"),pitchX:this.props.bpPerPx,pitchY:(0,i.QZ)(this.props.config,"noSpacing")?1:3})}cachedLayoutIsValid(e){return e.props.bpPerPx===this.props.bpPerPx&&o()((0,i.QZ)(this.props.config),(0,i.QZ)(e.props.config))&&o()(this.props.filters,e.props.filters)}get layout(){return this.cachedLayout&&this.cachedLayoutIsValid(this.cachedLayout)||(this.cachedLayout={layout:this.makeLayout(),props:this.props}),this.cachedLayout.layout}}var d=n(40704),u=n(77251),p=n(87663);class h extends r.default{layoutSessions={};createLayoutSession(e){return new c(e)}getLayoutSession(e){return this.layoutSessions[(0,u.getLayoutId)(e)]}getWorkerSession(e){const t=(0,u.getLayoutId)(e);return this.layoutSessions[t]||(this.layoutSessions[t]=this.createLayoutSession(e)),this.layoutSessions[t].update(e)}getExpandedRegion(e,t){const{bpPerPx:n,config:r}=t,a=(0,i.QZ)(r,"maxFeatureGlyphExpansion")||0,o=Math.round(a*n);return(0,d.T)(e,o)}freeResources(e){const t=(0,u.getLayoutId)(e),n=this.layoutSessions[t];if(n){const t=e.regions[0];n.layout.discardRange(t.refName,t.start,t.end)}}async freeResourcesInClient(e,t){return this.freeResources(t),super.freeResourcesInClient(e,t)}deserializeLayoutInClient(e){return new p.A(e)}deserializeResultsInClient(e,t){const n=this.deserializeLayoutInClient(e.layout);return super.deserializeResultsInClient({...e,layout:n},t)}createLayoutInWorker(e){const{regions:t}=e,{layout:n}=this.getWorkerSession(e);return n.getSublayout(t[0].refName)}serializeLayout(e,t){const n=t.regions[0];return e.serializeRegion(this.getExpandedRegion(n,t))}async render(e){return{features:await this.getFeatures(e),layout:this.createLayoutInWorker(e)}}serializeResultsInWorker(e,t){const{features:n,...r}=super.serializeResultsInWorker(e,t),a=t.regions[0],o=e.layout,i=o&&"serializeRegion"in o?o.serializeRegion(this.getExpandedRegion(a,t)):o;return{...r,layout:i,maxHeightReached:i.maxHeightReached,features:n?.filter(e=>!!i.rectangles[e.uniqueId])}}}},64171(e,t,n){n.d(t,{A:()=>f});var r=n(30936),a=n(42918),o=n(65525),i=n(37815),s=n(24215),l=n(11543),c=n(87861),d=n(27351),u=n(59199),p=n(85787),h=n(32118);function g(e){const t=(0,r.c)(17),{onClose:n,open:a,onFactoryReset:i}=e;let c;t[0]!==n||t[1]!==i?(c=function(e){"reset"===e&&i(),n()},t[0]=n,t[1]=i,t[2]=c):c=t[2];const d=c;let g,m,f,y,b,w;return t[3]!==d?(g=()=>{d()},t[3]=d,t[4]=g):g=t[4],t[5]===Symbol.for("react.memo_cache_sentinel")?(m=(0,h.jsx)(s.A,{children:(0,h.jsx)(u.A,{children:"Are you sure you want to reset? This will restore the default configuration."})}),t[5]=m):m=t[5],t[6]!==d?(f=(0,h.jsx)(o.A,{onClick:()=>{d()},color:"primary",children:"Cancel"}),t[6]=d,t[7]=f):f=t[7],t[8]!==d?(y=(0,h.jsx)(o.A,{onClick:()=>{d("reset")},color:"primary",variant:"contained",children:"OK"}),t[8]=d,t[9]=y):y=t[9],t[10]!==f||t[11]!==y?(b=(0,h.jsxs)(l.A,{children:[f,y]}),t[10]=f,t[11]=y,t[12]=b):b=t[12],t[13]!==a||t[14]!==g||t[15]!==b?(w=(0,h.jsxs)(p.A,{title:"Reset",onClose:g,open:a,children:[m,b]}),t[13]=a,t[14]=g,t[15]=b,t[16]=w):w=t[16],w}const m=e=>{const t=(0,r.c)(10),{onFactoryReset:n,resetButtonText:i}=e,[s,l]=(0,a.useState)(!1);let c,d,u,p,m;return t[0]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{l(!0)},t[0]=c):c=t[0],t[1]!==i?(d=(0,h.jsx)(o.A,{"data-testid":"fatal-error",color:"primary",variant:"contained",onClick:c,children:i}),t[1]=i,t[2]=d):d=t[2],t[3]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{l(!1)},t[3]=u):u=t[3],t[4]!==s||t[5]!==n?(p=(0,h.jsx)(g,{onClose:u,open:s,onFactoryReset:n}),t[4]=s,t[5]=n,t[6]=p):p=t[6],t[7]!==d||t[8]!==p?(m=(0,h.jsxs)(h.Fragment,{children:[d,p]}),t[7]=d,t[8]=p,t[9]=m):m=t[9],m};function f(e){const t=(0,r.c)(15),{componentStack:n,error:a,onFactoryReset:u,resetButtonText:p}=e,g=void 0===a?"No error message provided":a,f=void 0===p?"Factory Reset":p;let b,w,v,S,k,x,C;return t[0]===Symbol.for("react.memo_cache_sentinel")?(b=(0,h.jsx)(i.A,{children:"Fatal error"}),t[0]=b):b=t[0],t[1]!==g?(w=(0,h.jsx)(d.A,{error:g}),t[1]=g,t[2]=w):w=t[2],t[3]!==n?(v=(0,h.jsx)("pre",{children:n}),t[3]=n,t[4]=v):v=t[4],t[5]!==w||t[6]!==v?(S=(0,h.jsxs)(s.A,{children:[w,v]}),t[5]=w,t[6]=v,t[7]=S):S=t[7],t[8]===Symbol.for("react.memo_cache_sentinel")?(k=(0,h.jsx)(o.A,{color:"secondary",variant:"contained",onClick:y,children:"Refresh"}),t[8]=k):k=t[8],t[9]!==u||t[10]!==f?(x=(0,h.jsxs)(l.A,{children:[k,(0,h.jsx)(m,{onFactoryReset:u,resetButtonText:f})]}),t[9]=u,t[10]=f,t[11]=x):x=t[11],t[12]!==S||t[13]!==x?(C=(0,h.jsxs)(c.A,{maxWidth:"xl",open:!0,children:[b,S,x]}),t[12]=S,t[13]=x,t[14]=C):C=t[14],C}function y(){window.location.reload()}},64995(e,t,n){n.d(t,{A:()=>p});var r=n(77251),a=n(64074),o=n(97892),i=n(56097),s=n(32118);function l(e,t,n,r,a){return`M${e},${t}h${n-a}a${a},${a} 0 0 1 ${a},${a}v${r-2*a}a${a},${a} 0 0 1 ${-a},${a}h${a-n}z`}function c(e,t,n,r){return[[e,0],[e+n,r/2],[e,r]].toString()}function d(e,t,n,r){return[[e,r/2],[e+n,0],[e+n,r]].toString()}const u={gneg:"rgb(227,227,227)",gpos25:"rgb(142,142,142)",gpos33:"rgb(142,142,142)",gpos50:"rgb(85,85,85)",gpos66:"rgb(85,85,85)",gpos100:"rgb(0,0,0)",gpos75:"rgb(57,57,57)",gvar:"rgb(0,0,0)",stalk:"rgb(127,127,127)",acen:"#800"},p=(0,a.observer)(function({overview:e,block:t,assembly:n}){const{offsetPx:a,reversed:p}=t,h=(0,o.S5)(n,t.refName),g=p?h.length-1:0,m=p?0:h.length-1,f=i.Gu;let y=!1,b="",w=0;return(0,s.jsx)("g",{transform:`translate(-${a})`,children:h.map((t,n)=>{const a=JSON.stringify(t),{refName:o,name:i,type:h,start:v,end:S}=t,k=e.bpToPx({refName:o,coord:v})||0,x=e.bpToPx({refName:o,coord:S})||0,C=Math.min(k,x),T=Math.abs(x-k);if("n/a"===h){const e=i?.match(/^(\d+)([A-Za-z])/),t=e[1]+e[2];t&&t!==b&&(b=t,w++)}const A="n/a"===h?w%2?"black":"#a77":u[h]||"black";return"acen"!==h||y?"acen"===h&&y?(0,s.jsx)("polygon",{points:p?c(k-T,0,T,f):d(k,0,T,f),...(0,r.getFillProps)(A)},a):g===n?(0,s.jsx)("path",{d:(M=C,P=T,I=f,`M${M+8},0h${P-8}v${I}h${8-P}a8,8 0 0 1 -8,-8v${16-I}a8,8 0 0 1 8,-8z`),...(0,r.getFillProps)(A)},a):m===n?(0,s.jsx)("path",{d:l(C,0,T,f,8),...(0,r.getFillProps)(A)},a):(0,s.jsx)("rect",{x:C,y:0,width:T,height:f,...(0,r.getFillProps)(A)},a):(y=!0,(0,s.jsx)("polygon",{points:p?d(k-T,0,T,f):c(k,0,T,f),...(0,r.getFillProps)(A)},a));var M,P,I})})})},65045(e,t,n){n.d(t,{n:()=>h});var r=n(33579),a=n(42918),o=n(11991),i=n(30936),s=n(7745),l=n(82361),c=n(45514);const{createCssAndCx:d}={createCssAndCx:function(e){const{cache:t}=e,n=(...e)=>{const n=(0,s.J)(e,t.registered);(0,l.sk)(t,n,!1);const r=`${t.key}-${n.name}`;{const n=e[0];(function(e){return e instanceof Object&&!("styles"in e)&&!("length"in e)&&!("__emotion_styles"in e)})(n)&&u.saveClassNameCSSObjectMapping(t,r,n)}return r};return{css:n,cx:(...e)=>{const r=(0,c.p)(e),a=u.fixClassName(t,r,n);return function(e,t,n){const r=[],a=(0,l.Rk)(e,r,n);return r.length<2?n:a+t(r)}(t.registered,n,a)}}}},u=(()=>{const e=new WeakMap;return{saveClassNameCSSObjectMapping:(t,n,r)=>{let a=e.get(t);void 0===a&&(a=new Map,e.set(t,a)),a.set(n,r)},fixClassName:(t,n,r)=>{if(!n.includes(" "))return n;const a=e.get(t);return(0,c.p)(function(e){let t=!1;return e.map(([e,n])=>{if(void 0===n)return e;let r;if(t)r={"&&":n};else{r=e;for(const e in n)if(e.startsWith("@media")){t=!0;break}}return r})}(n.split(" ").map(e=>[e,a?.get(e)])).map(e=>"string"==typeof e?e:r(e)))}}})(),p=o._,{makeStyles:h}=function(e){const{useTheme:t}=e,{useCssAndCx:n}=function(e){const{useCache:t}=e;return{useCssAndCx:function(){const e=(0,i.c)(5),n=t();let r;e[0]!==n?(r=d({cache:n}),e[0]=n,e[1]=r):r=e[1];const{css:a,cx:o}=r;let s;return e[2]!==a||e[3]!==o?(s={css:a,cx:o},e[2]=a,e[3]=o,e[4]=s):s=e[4],s}}}({useCache:p});return{makeStyles:function(){return function(e){const r="function"==typeof e?e:()=>e;return function(e,o){const i=t(),{css:s,cx:l}=n(),c=(0,a.useMemo)(()=>{const e=r(i),t={};for(const n of Object.keys(e)){const r=e[n];t[n]=s(r)}return t},[s,i]),d=o?.props.classes,u=function(e){if(!(e instanceof Object)||"function"==typeof e)return e;const t=[];for(const n in e){const r=e[n],a=typeof r;if("string"!==a&&("number"!==a||isNaN(r))&&"boolean"!==a&&null!=r)return e;t.push(`${n}:${a}_${r}`)}return`xSqLiJdLMd9s${t.join("|")}`}(d),p=(0,a.useMemo)(()=>d?function(e,t,n){if(!(t instanceof Object))return e;const r=Object.keys(t);if(0===r.length)return e;const a={};for(const r of Object.keys(e))a[r]=n(e[r],t[r]);for(const n of r){if(n in e)continue;const r=t[n];"string"==typeof r&&(a[n]=r)}return a}(c,d,l):c,[c,u,l]);return{classes:p,theme:i,css:s,cx:l}}}}}}({useTheme:r.A})},66867(e,t,n){n.d(t,{E:()=>a});var r=n(91674);function a({cds:e,sequence:t,codonTable:n}){const a=(0,r.o9)(e,t);let o="";for(let e=0;e<a.length;e+=3)o+=n[a.slice(e,e+3)]||"&";return o}},67401(e,t,n){n.r(t),n.d(t,{BlobLocation:()=>l,ElementId:()=>a.K,FileLocation:()=>u,LocalPathLocation:()=>s,NoAssemblyRegion:()=>o,Region:()=>i,UriLocation:()=>d,UriLocationRaw:()=>c,createElementId:()=>a.w});var r=n(99226),a=n(27868);const o=r.types.model("NoAssemblyRegion",{refName:r.types.string,start:r.types.number,end:r.types.number,reversed:r.types.optional(r.types.boolean,!1)}).actions(e=>({setRefName(t){e.refName=t}})),i=r.types.compose("Region",o,r.types.model({assemblyName:r.types.string})),s=r.types.model("LocalPathLocation",{locationType:r.types.literal("LocalPathLocation"),localPath:r.types.string}),l=r.types.model("BlobLocation",{locationType:r.types.literal("BlobLocation"),name:r.types.string,blobId:r.types.string}),c=r.types.model("UriLocation",{locationType:r.types.literal("UriLocation"),uri:r.types.string,baseUri:r.types.maybe(r.types.string),internetAccountId:r.types.maybe(r.types.string),internetAccountPreAuthorization:r.types.maybe(r.types.model("InternetAccountPreAuthorization",{internetAccountType:r.types.string,authInfo:r.types.frozen()}))}),d=r.types.snapshotProcessor(c,{postProcessor:e=>{const{baseUri:t,...n}=e;return t?e:n}}),u=r.types.snapshotProcessor(r.types.union(s,d,l),{preProcessor(e){if(!e)return;const{locationType:t,...n}=e;if(!t){const{uri:e,localPath:t,blob:r}=n;let a="";return void 0!==e?a="UriLocation":void 0!==t?a="LocalPathLocation":void 0!==r&&(a="BlobLocation"),{...n,locationType:a}}return e}})},67930(e,t,n){n.d(t,{A:()=>d});var r=n(42918),a=n(87877),o=n(14665),i=n(27868),s=n(99226);const l=s.types.model("AddConnectionModel",{id:i.K,type:s.types.literal("AddConnectionWidget")}),c=(0,a.S7)("AddConnectionWidget",{});function d(e){e.addWidgetType(()=>new o.A({name:"AddConnectionWidget",heading:"Add a connection",configSchema:c,stateModel:l,ReactComponent:(0,r.lazy)(()=>Promise.all([n.e(6444),n.e(4283)]).then(n.bind(n,14283)))}))}},68589(e,t,n){n.d(t,{A:()=>c});var r=n(99226),a=n(83090),o=n(80764),i=n(89867),s=n(77251),l=n(27868);const c=r.types.model("Base1DView",{id:l.K,displayedRegions:r.types.optional(r.types.frozen(),[]),bpPerPx:0,offsetPx:0,interRegionPaddingWidth:r.types.optional(r.types.number,0),minimumBlockWidth:r.types.optional(r.types.number,0)}).volatile(()=>({features:void 0,volatileWidth:0})).actions(e=>({setDisplayedRegions(t){e.displayedRegions=(0,r.cast)(t)},setBpPerPx(t){e.bpPerPx=t},setVolatileWidth(t){e.volatileWidth=t}})).views(e=>({get width(){return e.volatileWidth},get assemblyNames(){return[...new Set(e.displayedRegions.map(e=>e.assemblyName))]},get displayedRegionsTotalPx(){return this.totalBp/e.bpPerPx},get maxOffset(){return this.displayedRegionsTotalPx-10},get minOffset(){return 30-this.width},get totalBp(){return(0,s.sum)(e.displayedRegions.map(e=>e.end-e.start))}})).views(e=>({get dynamicBlocks(){return(0,o.A)(e)},get staticBlocks(){return(0,i.A)(e)},get currBp(){return(0,s.sum)(this.dynamicBlocks.map(e=>e.end-e.start))}})).views(e=>({pxToBp:t=>(0,a.Ii)(e,t),bpToPx:({refName:t,coord:n,regionNumber:r})=>(0,a.eB)({refName:t,coord:n,regionNumber:r,self:e})?.offsetPx})).actions(e=>({setFeatures(t){e.features=t},showAllRegions(){e.bpPerPx=e.totalBp/e.width,e.offsetPx=0},zoomOut(){this.zoomTo(2*e.bpPerPx)},zoomIn(){this.zoomTo(e.bpPerPx/2)},zoomTo(t,n=e.width/2){const r=(0,s.clamp)(t,"minBpPerPx"in e?e.minBpPerPx:0,"maxBpPerPx"in e?e.maxBpPerPx:Number.POSITIVE_INFINITY),a=e.bpPerPx;return Math.abs(a-r)<1e-6?a:(e.bpPerPx=r,e.offsetPx=(0,s.clamp)(Math.round((e.offsetPx+n)*a/r-n),e.minOffset,e.maxOffset),e.bpPerPx)},scrollTo(t){const n=(0,s.clamp)(t,e.minOffset,e.maxOffset);return e.offsetPx=n,n},centerAt(t,n,r){if(!n)return;const a=e.bpToPx({refName:n,coord:t,regionNumber:r});a&&this.scrollTo(Math.round(a-e.width/2))},scroll(t){const n=e.offsetPx,r=(0,s.clamp)(e.offsetPx+t,e.minOffset,e.maxOffset);return e.offsetPx=r,r-n}})).actions(e=>({moveTo(t,n){(0,a.tw)(e,t,n)}}))},68674(e,t,n){n.d(t,{P:()=>s,R:()=>i});var r=n(30936),a=n(32118);function o(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function i(e){const t=(0,r.c)(2),{variant:n}=e;let o;return t[0]!==n?(o=(0,a.jsx)("svg",{viewBox:"0 0 175 175",children:(0,a.jsx)(l,{variant:n})}),t[0]=n,t[1]=o):o=t[1],o}function s(e){const t=(0,r.c)(2),{variant:n}=e;let o;return t[0]!==n?(o=(0,a.jsxs)("svg",{viewBox:"0 0 641 175",children:[(0,a.jsx)(c,{variant:n}),(0,a.jsx)(l,{variant:n})]}),t[0]=n,t[1]=o):o=t[1],o}function l(e){const t=(0,r.c)(18),{variant:n}=e;let i;t[0]!==n?(i=o(n),t[0]=n,t[1]=i):i=t[1];const s=i;let l,c,d,u,p,h;return t[2]!==s.midnight?(l=(0,a.jsx)("path",{style:{fill:s.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),t[2]=s.midnight,t[3]=l):l=t[3],t[4]!==s.forrest?(c=(0,a.jsx)("path",{style:{fill:s.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),t[4]=s.forrest,t[5]=c):c=t[5],t[6]!==s.grape?(d=(0,a.jsx)("path",{style:{fill:s.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),t[6]=s.grape,t[7]=d):d=t[7],t[8]!==s.mandarin?(u=(0,a.jsx)("path",{style:{fill:s.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),t[8]=s.mandarin,t[9]=u):u=t[9],t[10]!==s.gray?(p=(0,a.jsx)("path",{style:{fill:s.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"}),t[10]=s.gray,t[11]=p):p=t[11],t[12]!==l||t[13]!==c||t[14]!==d||t[15]!==u||t[16]!==p?(h=(0,a.jsxs)(a.Fragment,{children:[l,c,d,u,p]}),t[12]=l,t[13]=c,t[14]=d,t[15]=u,t[16]=p,t[17]=h):h=t[17],h}function c(e){const t=(0,r.c)(13),{variant:n}=e;let i;t[0]!==n?(i=o(n),t[0]=n,t[1]=i):i=t[1];const s=i;let l,c,d,u,p,h,g,m,f;return t[2]!==s.midnight?(l={fill:s.midnight},t[2]=s.midnight,t[3]=l):l=t[3],t[4]===Symbol.for("react.memo_cache_sentinel")?(c=(0,a.jsx)("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),d=(0,a.jsx)("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),u=(0,a.jsx)("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),p=(0,a.jsx)("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),h=(0,a.jsx)("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),g=(0,a.jsx)("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),m=(0,a.jsx)("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"}),t[4]=c,t[5]=d,t[6]=u,t[7]=p,t[8]=h,t[9]=g,t[10]=m):(c=t[4],d=t[5],u=t[6],p=t[7],h=t[8],g=t[9],m=t[10]),t[11]!==l?(f=(0,a.jsxs)("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:l,children:[c,d,u,p,h,g,m]}),t[11]=l,t[12]=f):f=t[12],f}},70203(e,t,n){n.r(t),n.d(t,{UNKNOWN:()=>u,UNSUPPORTED:()=>p,generateUnknownTrackConf:()=>T,generateUnsupportedTrackConf:()=>C,getBlob:()=>g,getBlobMap:()=>m,getConfAssemblyNames:()=>l,getFileName:()=>S,getParentRenderProps:()=>d,getRpcSessionId:()=>c,getTrackAssemblyNames:()=>s,getTrackName:()=>A,guessAdapter:()=>k,guessTrackType:()=>x,hideTrackGeneric:()=>P,makeIndex:()=>w,makeIndexType:()=>v,setBlobMap:()=>f,showTrackGeneric:()=>M,storeBlobLocation:()=>b,toggleTrackGeneric:()=>I});var r=n(99226),a=n(77251),o=n(11259);const i=new WeakMap;function s(e){let t=i.get(e);return t||(t=l(e.configuration),i.set(e,t)),t}function l(e){const t=(0,o.QZ)(e,"assemblyNames");if(!t){const t=(0,r.getParent)(e);if("sequence"in t)return[(0,o.QZ)(t,"name")];throw new Error("unknown assembly names")}return t}function c(e){let t;for(let n=e;!(0,r.isRoot)(n);n=(0,r.getParent)(n))"rpcSessionId"in n&&(t=n.rpcSessionId);if(!t)throw new Error("getRpcSessionId failed, no parent node in the state tree has an `rpcSessionId` attribute");return t}function d(e){for(let t=(0,r.getParent)(e);!(0,r.isRoot)(t);t=(0,r.getParent)(t))if("renderProps"in t)return t.renderProps();return{}}const u="UNKNOWN",p="UNSUPPORTED";let h={};function g(e){return h[e]}function m(){return h}function f(e){h=e}let y=0;function b(e){if("blob"in e){const t=`b${Date.now()}-${y++}`;return h[t]=e.blob,{name:e.blob.name,blobId:t,locationType:"BlobLocation"}}return e}function w(e,t){return"uri"in e?{uri:e.uri+t,locationType:"UriLocation"}:"localPath"in e?{localPath:e.localPath+t,locationType:"LocalPathLocation"}:e}function v(e,t,n){return e?.toUpperCase().endsWith(t)?t:n}function S(e){const t="uri"in e?e.uri:void 0,n="localPath"in e?e.localPath:void 0,r="blobId"in e?e:void 0;return r?.name||t?.slice(t.lastIndexOf("/")+1)||n?.slice(n.replace(/\\/g,"/").lastIndexOf("/")+1)||""}function k(e,t,n,r){if(r){const{pluginManager:o}=(0,a.getEnv)(r),i=o.evaluateExtensionPoint("Core-guessAdapterForLocation",(e,t,n)=>{})(e,t,n);if(i)return i}return{type:u}}function x(e,t){if(t){const n=(0,a.getSession)(t),r=(0,a.getEnv)(n).pluginManager.evaluateExtensionPoint("Core-guessTrackTypeForLocation",e=>{})(e);if(r)return r}return"FeatureTrack"}function C(e,t,n){const r={type:"FeatureTrack",name:`${e} (Unsupported)`,description:`Support not yet implemented for "${t}"`,category:n,trackId:""};return r.trackId=(0,a.objectHash)(r),r}function T(e,t,n){const r={type:"FeatureTrack",name:`${e} (Unknown)`,description:`Could not determine track type for "${t}"`,category:n,trackId:""};return r.trackId=(0,a.objectHash)(r),r}function A(e,t){const n=(0,r.isStateTreeNode)(e)?(0,o.QZ)(e,"name"):e.name??"",a=(0,r.isStateTreeNode)(e)?(0,o.QZ)(e,"type"):e.type;if(!n&&"ReferenceSequenceTrack"===a){const n=t.assemblies.find(t=>t.sequence===e);return n?`Reference sequence (${(0,o.QZ)(n,"displayName")||(0,o.QZ)(n,"name")})`:"Reference sequence"}return n}function M(e,t,n={},r={}){const{pluginManager:o}=(0,a.getEnv)(e),i=(0,a.getSession)(e),s=e.tracks.find(e=>e.configuration.trackId===t);if(s)return s;const l=i.getTracksById()[t];if(!l)throw new Error(`Could not resolve identifier "${t}"`);const c=o.getTrackType(l.type);if(!c)throw new Error(`Unknown track type ${l.type}`);const d=o.getViewType(e.type),u=new Set(d.displayTypes.map(e=>e.name)),p=(l.displays??[]).find(e=>u.has(e.type)),h=p?.type??c.displayTypes.find(e=>u.has(e.name))?.name;if(!h)throw new Error(`Could not find a compatible display for view type ${e.type}`);const g=p?.displayId??`${t}-${h}`,m=c.stateModel.create({...n,type:l.type,configuration:t,displays:[{type:h,configuration:g,...r}]});return e.tracks.push(m),m}function P(e,t){const n=e.tracks.find(e=>e.configuration.trackId===t);return n?(e.tracks.remove(n),1):0}function I(e,t){P(e,t)||M(e,t)}},70312(e,t,n){n.d(t,{A:()=>a});var r=n(77251);function a(e,t="",n=5e3){const a=[e];for(;a.length;){const e=a.pop();for(const[o,i]of Object.entries(e)){if(t.length>n)return(0,r.hashCode)(t);"object"==typeof i&&null!==i?a.push(i):t+=`${o}-${i}`}}return`adp-${(0,r.hashCode)(t)}`}},71247(e,t,n){n.r(t),n.d(t,{contrastingTextColor:()=>s,emphasize:()=>c,isNamedColor:()=>i,makeContrasting:()=>d,namedColorToHex:()=>o,randomColor:()=>u});var r=n(15943);const a={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function o(e){return a[e]}function i(e){return!!a[e]}function s(e){return l(e)>.5?"black":"white"}function l(e){const t=o(e);return(0,r.J1)(t||e)}function c(e,t=.15){const n=o(e);return(0,r.tL)(n||e,t)}function d(e,t="white",n=3){let a=o(e)||e;const i=o(t)||t,s=l(i);let c=(0,r.eM)(a,i);const d=a;let u=.05;for(;c<n;)a=s>.5?(0,r.e$)(d,u):(0,r.a)(d,u),u+=.05,c=(0,r.eM)(a,i);return a}function u(e){let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return`hsl(${10*t}, 50%, 50%)`}},71547(e,t,n){n.d(t,{A:()=>u});var r=n(78329),a=n(19819),o=n(15943),i=n(27309),s=n(33579),l=n(65045),c=n(32118);const d=(0,l.n)()(e=>({tooltip:{position:"absolute",pointerEvents:"none",backgroundColor:(0,o.X4)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.fontSize,lineHeight:Math.round(14e4)/1e5+"em",maxWidth:300,wordWrap:"break-word"}}));function u({clientPoint:e,children:t,placement:n="right"}){const o=(0,s.A)(),l=o.components?.MuiPopper,{classes:u}=d(),{refs:p,floatingStyles:h,context:g}=(0,r.we)({placement:n,strategy:"fixed",middleware:[(0,a.cY)(5)]}),m=(0,r.ju)(g,e),{getFloatingProps:f}=(0,r.bv)([m]);return(0,c.jsx)(i.A,{container:l?.defaultProps?.container,children:(0,c.jsx)("div",{className:u.tooltip,ref:p.setFloating,style:{...h,zIndex:1e5,visibility:"translate(0px, 0px)"===h.transform?"hidden":void 0,pointerEvents:"none"},...f(),children:t})})}},74045(e,t,n){n.d(t,{G:()=>s});var r=n(38433),a=n(77251),o=n(96852),i=n(10596);async function s({pluginManager:e,args:t}){const{sources:n,regions:s,adapterConfig:l,sessionId:c,bpPerPx:d}=t,u=(await(0,r.cK)(e,c,l)).dataAdapter,p=s[0],h=p.end-p.start,g=Math.floor(h/d),m=await(0,o._)(u.getFeatures(p,t).pipe((0,i.$)())),f=(0,a.groupBy)(m,e=>e.get("source")),y={},b=p.start,w=1/d;for(const e of n){const{name:t}=e,n=f[t]||[],r=new Float32Array(g);for(const e of n){const t=e.get("start"),n=e.get("end"),a=e.get("score"),o=Math.max(0,(t-b)*w|0),i=Math.min(g,(n-b)*w|0);for(let e=o;e<i;e++)0===r[e]&&(r[e]=a)}y[t]=Array.from(r)}return y}},74603(e,t,n){n.d(t,{A:()=>u});var r=n(92035);const a=Symbol("mapObjectSkip"),o=e=>"object"==typeof e&&null!==e,i=e=>{if(!o(e))return!1;if(e instanceof RegExp||e instanceof Error||e instanceof Date||e instanceof Map||e instanceof Set||e instanceof WeakMap||e instanceof WeakSet||e instanceof Promise||e instanceof ArrayBuffer||e instanceof DataView||ArrayBuffer.isView(e)||globalThis.Blob&&e instanceof globalThis.Blob)return!1;const t=e;return"symbol"!=typeof t.$$typeof&&"function"!=typeof t.asymmetricMatch},s=(e,t,n,r=new WeakMap)=>{const{target:o={},deep:l=!1,includeSymbols:c=!1}=n??{},d={deep:l,includeSymbols:c};if(r.has(e))return r.get(e);r.set(e,o);const u=e=>e.map(e=>i(e)?s(e,t,d,r):e);if(Array.isArray(e))return u(e);for(const n of((e,t)=>t?[...Object.keys(e),...Object.getOwnPropertySymbols(e).filter(t=>Object.getOwnPropertyDescriptor(e,t)?.enumerable)]:Object.keys(e))(e,d.includeSymbols)){const l=e[n],c=t(n,l,e);if(c===a)continue;if(!Array.isArray(c))throw new TypeError("Mapper must return an array or mapObjectSkip, got "+(null===c?"null":typeof c));if(c.length<2)throw new TypeError(`Mapper must return an array with at least 2 elements [key, value], got ${c.length} elements`);let[p,h,{shouldRecurse:g=!0}={}]=c;if("__proto__"!==p){d.deep&&g&&i(h)&&(h=Array.isArray(h)?u(h):s(h,t,d,r));try{o[p]=h}catch(e){if(e instanceof TypeError&&e.message.includes("read only"))continue;throw e}}}return o};var l=n(62492),c=n(70203),d=n(10525);class u extends r.A{constructor(e){super(),this.pluginManager=e}async serializeArguments(e,t){return await this.augmentLocationObjects(e,t),{...e,blobMap:(0,c.getBlobMap)()}}async serializeNewAuthArguments(e,t){const n=this.pluginManager.rootModel;if(!(0,d.bV)(n)||e.internetAccountPreAuthorization)return e;const r=n.findAppropriateInternetAccount(e);return r&&(e.internetAccountPreAuthorization=await r.getPreAuthorizationInformation(e)),e}async deserializeArguments(e,t){return e.blobMap&&(0,c.setBlobMap)(e.blobMap),e}async executeDirect(e){}supportsDirectExecution(){return this.executeDirect!==u.prototype.executeDirect}async serializeReturn(e,t,n){return e}async deserializeReturn(e,t,n){let r;try{r=await e}catch(e){if((0,d.ZL)(e)){const t=this.pluginManager.rootModel?.createEphemeralInternetAccount(`HTTPBasicInternetAccount-${new URL(e.url).origin}`,{},e.url);throw new d.J_("Retrying with created internet account",t.internetAccountId)}throw e}return(0,l.N)(r)?r.value:r}async augmentLocationObjects(e,t){const n=this.pluginManager.rootModel;if((0,d.bV)(n)&&0===n.internetAccounts.length)return e;const r=[],{renderingProps:a,...i}=e;!function(e){if(!o(e))throw new TypeError(`Expected an object, got \`${e}\` (${typeof e})`);if(Array.isArray(e))throw new TypeError("Expected an object, got an array");s(e,(e,t)=>((e,t)=>{if((0,d.C1)(t)&&r.push(t),Array.isArray(t))for(const e of t)(0,d.C1)(e)&&r.push(e);return[e,t]})(e,t),{deep:!0})}(i);for(const e of r)await this.serializeNewAuthArguments(e,t);return e}}},74691(e,t,n){n.d(t,{A:()=>f});var r=n(42918),a=n(11259),o=n(77251),i=n(99226),s=n(10877),l=n(29242),c=n(89913),d=n(10240),u=n(1879),p=n(27535);const h=(0,r.lazy)(()=>n.e(6136).then(n.bind(n,76136))),g=(0,r.lazy)(()=>Promise.all([n.e(7396),n.e(8501),n.e(8104)]).then(n.bind(n,88104))),m=new Map([["xyplot","XYPlotRenderer"],["density","DensityRenderer"],["line","LinePlotRenderer"]]),f=function(e,t){return i.types.compose("LinearWiggleDisplay",(0,d.A)(t),i.types.model({type:i.types.literal("LinearWiggleDisplay"),invertedSetting:i.types.maybe(i.types.boolean)})).actions(e=>({setInverted(t){e.invertedSetting=t}})).views(e=>({get TooltipComponent(){return h},get rendererTypeName(){const t=e.rendererTypeNameSimple,n=m.get(t);if(!n)throw new Error(`unknown renderer ${t}`);return n},get quantitativeStatsRelevantToCurrentZoom(){const t=(0,o.getContainingView)(e);return e.stats?.currStatsBpPerPx===t.bpPerPx},get graphType(){return"XYPlotRenderer"===e.rendererTypeName||"LinePlotRenderer"===e.rendererTypeName},get inverted(){return e.invertedSetting??(0,a.FI)(e,"inverted")}})).views(e=>{const{renderProps:t}=e;return{adapterProps(){const n=t(),{filters:r,resolution:a,scaleOpts:o}=e;return{...n,rpcDriverName:e.effectiveRpcDriverName,config:e.rendererConfig,displayCrossHatches:e.displayCrossHatchesSetting,scaleOpts:o,resolution:a,filters:r}},get ticks(){const{inverted:t,scaleType:n,domain:r,height:o}=e,i=(0,a.FI)(e,"minimalTicks");if(r){const e=(0,u.A)((0,p.getScale)({scaleType:n,domain:r,range:[o-p.YSCALEBAR_LABEL_OFFSET,p.YSCALEBAR_LABEL_OFFSET],inverted:t}),4);return o<100||i?{...e,values:r}:e}}}}).views(e=>({renderProps(){const{inverted:t,ticks:n,height:r,domain:a}=e,i=e.adapterProps(),s=(0,o.getContainingView)(e),l=JSON.stringify(s.dynamicBlocks);return{...e.adapterProps(),notReady:i.notReady||!a||e.stats?.statsRegion!==l,height:r,ticks:n,inverted:t,offset:p.YSCALEBAR_LABEL_OFFSET}},get fillSetting(){return e.filled?0:1===e.minSize?1:2},get quantitativeStatsReady(){return(0,o.getContainingView)(e).initialized&&e.featureDensityStatsReadyAndRegionNotTooLarge&&!e.error}})).views(e=>{const{trackMenuItems:t}=e,n=(0,a.FI)(e,"defaultRendering");return{wiggleBaseTrackMenuItems:()=>[...t(),{label:"Score",icon:s.A,subMenu:e.scoreTrackMenuItems()}],wiggleOnlyTrackMenuItems:()=>[...e.canHaveFill?[{label:"Fill mode",subMenu:["filled","no fill","no fill w/ emphasis"].map((t,n)=>({label:t,type:"radio",checked:e.fillSetting===n,onClick:()=>{e.setFill(n)}}))}]:[],...n?[{label:"Renderer type",subMenu:["xyplot","density","line"].map(t=>({label:t,type:"radio",checked:e.rendererTypeNameSimple===t,onClick:()=>{e.setRendererType(t)}}))}]:[],{label:"Color",icon:l.A,onClick:()=>{(0,o.getSession)(e).queueDialog(t=>[g,{model:e,handleClose:t}])}}]}}).views(e=>({trackMenuItems:()=>[...e.wiggleBaseTrackMenuItems(),{label:"Show...",icon:c.A,subMenu:[{label:"Show tooltips",type:"checkbox",checked:e.showTooltipsEnabled,onClick:()=>{e.setShowTooltips(!e.showTooltipsEnabled)}},...e.graphType?[{label:"Show inverted",type:"checkbox",checked:e.inverted,onClick:()=>{e.setInverted(!e.inverted)}},{label:"Show cross hatches",type:"checkbox",checked:e.displayCrossHatchesSetting,onClick:()=>{e.toggleCrossHatches()}}]:[]]},...e.wiggleOnlyTrackMenuItems()]})).actions(e=>{const{renderSvg:t}=e;return{afterAttach(){(async()=>{const{getQuantitativeStatsAutorun:t}=await n.e(9776).then(n.bind(n,29776));t(e)})()},async renderSvg(r){const{renderSvg:a}=await n.e(1912).then(n.bind(n,81912));return a(e,r,t)}}}).postProcessSnapshot(e=>{if(!e)return e;const{invertedSetting:t,...n}=e;return{...n,...void 0!==t?{invertedSetting:t}:{}}})}},75589(e,t,n){n.r(t),n.d(t,{default:()=>m});var r=n(64074),a=n(30936),o=n(42918),i=n(77251),s=n(65045),l=n(29463),c=n(32118);const d=(0,s.n)()({container:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none",zIndex:5},label:{position:"absolute",fontSize:11,cursor:"default",pointerEvents:"auto"},overlay:{backgroundColor:"rgba(255, 255, 255, 0.8)",lineHeight:1}}),u=(0,o.memo)(function(e){const t=(0,a.c)(10),{text:n,color:r,isOverlay:o,featureLeftPx:i,featureId:s,subfeatureId:l,y:d,tooltip:u,labelClass:p,overlayClass:h}=e,g=o?`${p} ${h}`:p,m=`translate(calc(${i}px - var(--offset-px)), ${d}px)`;let f,y;return t[0]!==r||t[1]!==m?(f={color:r,transform:m},t[0]=r,t[1]=m,t[2]=f):f=t[2],t[3]!==s||t[4]!==l||t[5]!==g||t[6]!==f||t[7]!==n||t[8]!==u?(y=(0,c.jsx)("div",{"data-feature-id":s,"data-subfeature-id":l,"data-tooltip":u,className:g,style:f,children:n}),t[3]=s,t[4]=l,t[5]=g,t[6]=f,t[7]=n,t[8]=u,t[9]=y):y=t[9],y});function p(e){const t=(0,a.c)(16),{text:n,color:r,isOverlay:o,featureLeftPx:i,featureRightPx:s,featureId:d,subfeatureId:u,labelWidth:p,y:h,offsetPx:g,viewportLeft:m,tooltip:f,labelClass:y,overlayClass:b}=e;let w;t[0]!==i||t[1]!==s||t[2]!==p||t[3]!==g||t[4]!==m?(w=(0,l.mJ)(i,s,p,g,m),t[0]=i,t[1]=s,t[2]=p,t[3]=g,t[4]=m,t[5]=w):w=t[5];const v=o?`${y} ${b}`:y,S=`translate(${w}px,${h}px)`;let k,x;return t[6]!==r||t[7]!==S?(k={color:r,transform:S},t[6]=r,t[7]=S,t[8]=k):k=t[8],t[9]!==d||t[10]!==u||t[11]!==v||t[12]!==k||t[13]!==n||t[14]!==f?(x=(0,c.jsx)("div",{"data-feature-id":d,"data-subfeature-id":u,"data-tooltip":f,className:v,style:k,children:n}),t[9]=d,t[10]=u,t[11]=v,t[12]=k,t[13]=n,t[14]=f,t[15]=x):x=t[15],x}const h=(0,r.observer)(function({model:e}){const{classes:t}=d(),n=(0,i.getContainingView)(e),{offsetPx:r}=n,a=e.floatingLabelData,{onFeatureClick:o,onFeatureContextMenu:s,onMouseMove:l}=e.renderingProps(),h=[],g=[],m=Math.max(0,r);for(const[e,{leftPx:n,topPx:o,totalFeatureHeight:i,floatingLabels:s,featureWidth:l}]of a.entries()){const a=o+i,d=n+l;for(let o=0,i=s.length;o<i;o++){const i=s[o],{text:f,relativeY:y,color:b,isOverlay:w,textWidth:v,parentFeatureId:S,subfeatureId:k,tooltip:x}=i,C=a+y,T=`${e}-${o}`,A=S??e;v>l?h.push((0,c.jsx)(u,{text:f,color:b,isOverlay:w??!1,featureLeftPx:n,featureId:A,subfeatureId:k,y:C,tooltip:x,labelClass:t.label,overlayClass:t.overlay},T)):g.push((0,c.jsx)(p,{text:f,color:b,isOverlay:w??!1,featureLeftPx:n,featureRightPx:d,featureId:A,subfeatureId:k,labelWidth:v,y:C,offsetPx:r,viewportLeft:m,tooltip:x,labelClass:t.label,overlayClass:t.overlay},T))}}return(0,c.jsxs)("div",{className:t.container,style:{"--offset-px":`${r}px`},onClick:e=>{const t=e.target,n=t.dataset.subfeatureId??t.dataset.featureId;n&&o?.(e,n)},onContextMenu:e=>{const t=e.target,n=t.dataset.subfeatureId??t.dataset.featureId;n&&s?.(e,n)},onMouseOver:t=>{const n=t.target,r=n.dataset.featureId;if(r){const a=n.dataset.tooltip,o=n.dataset.subfeatureId;l?.(t,r,a),e.setSubfeatureIdUnderMouse(o)}},children:[h,g]})});var g=n(18769);const m=(0,r.observer)(function(e){const{model:t}=e;return(0,c.jsx)(g.Ay,{model:t,children:(0,c.jsx)(h,{model:t})})})},75976(e,t,n){n.d(t,{E:()=>R});var r=n(42918),a=n(99226),o=n(65048);function i({features:e}){const t=["refName","start","end","name","score","strand"];return e.map(e=>t.map(t=>e.get(t)??".").join("\t").trim()).join("\n")}var s=n(11259),l=n(77251);const c=new Set(["uniqueId","refName","source","type","start","end","strand","parent","parentId","score","subfeatures","phase"]),d="                     ",u={name:"Name"};function p(e){return Array.isArray(e)?e.map(e=>p(e)).join(","):"object"==typeof e?JSON.stringify(e):`${e}`}function h(e,t,n){return[t&&n?`${d}/${n}="${t}"`:"",e.get("id")?`${d}/name=${e.get("id")}`:"",...Object.keys(e.toJSON()).filter(e=>!c.has(e)).map(t=>[t,p(e.get(t))]).filter(e=>!!e[1]&&e[0]!==n).map(e=>`${d}/${u[e[0]]||e[0]}="${e[1]}"`)].filter(e=>!!e)}function g(e,t){return`${function(e,t){return e.get("start")-t+1}(e,t)}..${function(e,t){return e.get("end")-t}(e,t)}`}function m(e,t,n,r,a){const o=`join(${e.map(e=>g(e,a))})`,i=-1===r?`complement(${o})`:o;return e.length?[`     ${"CDS".padEnd(16)}${i}`,`${d}/${n}="${t}"`]:[]}function f(e,t,n,r){const a=function(e,t,n,r){const a=`${e.get("type")}`.slice(0,16),o=g(e,t),i=-1===e.get("strand")?`complement(${o})`:o;return[`     ${a.padEnd(16)}${i}`,...h(e,n,r)]}(e,t,n,r),o=e.get("subfeatures")||[],i=o.filter(e=>"CDS"===e.get("type")),s=o.filter(e=>"CDS"!==e.get("type")&&"exon"!==e.get("type")),l=e.get("id"),c=e.get("type"),d=e.get("strand");return[...a,...m(i,l,c,d,t),...s.flatMap(e=>f(e,t,l,c))].join("\n")}async function y({features:e,assemblyName:t,session:n}){if(!e.length)return"";const r=(0,l.min)(e.map(e=>e.get("start"))),a=(0,l.max)(e.map(e=>e.get("end"))),o=a-r,i=e[0].get("refName")||"",c=["LOCUS".padEnd(12),`${i}:${r+1}..${a}`.padEnd(20),` ${o} bp`.padEnd(15),` ${"DNA".padEnd(10)}`,"linear".padEnd(10),"UNK 10-JAN-1970"].join(""),d=await async function({session:e,region:t}){const{rpcManager:n,assemblyManager:r}=e,a=r.get(t.assemblyName);if(!a)throw new Error(`assembly ${t.assemblyName} not found`);const o="getSequence";return n.call(o,"CoreGetSequence",{adapterConfig:(0,s.FI)(a,["sequence","adapter"]),region:{...t,refName:a.getCanonicalRefName(t.refName)},sessionId:o})}({session:n,region:{assemblyName:t,start:r,end:a,refName:i}})??"";return[c,"FEATURES             Location/Qualifiers",...e.map(e=>f(e,r)),"ORIGIN",`\t1 ${d}`,"//"].join("\n")}const b=new Set(["uniqueId","refName","source","type","start","end","strand","parent","parentId","score","subfeatures","phase","_lineHash"]),w={id:"ID",name:"Name",alias:"Alias",parent:"Parent",target:"Target",gap:"Gap",derives_from:"Derives_from",note:"Note",description:"Note",dbxref:"Dbxref",ontology_term:"Ontology_term",is_circular:"Is_circular"};function v(e){return Array.isArray(e)?e.map(e=>v(e)).join(","):"object"==typeof e&&null!==e?JSON.stringify(e):String(e)}function S(e,t){const n=[];t&&n.push(`Parent=${t}`);const r=Object.keys(e.toJSON()).filter(e=>!b.has(e));for(const t of r){const r=e.get(t);if(null!=r){const e=v(r);if(e){const r=w[t]||t;n.push(`${r}=${e}`)}}}return n.join(";")}function k(e,t,n){const r=n||e.get("refName"),a=e.get("id"),o=function(e,t,n){const r=e.get("strand"),a=e.get("score"),o=e.get("phase");return[e.get("refName")||n,e.get("source")||".",e.get("type")||".",e.get("start")+1,e.get("end"),null!=a?a:".",1===r?"+":-1===r?"-":".",null!=o?o:".",S(e,t)].join("\t")}(e,t,r);return[o,...e.get("subfeatures")?.map(e=>k(e,a,r))||[]].join("\n")}function x({features:e}){return["##gff-version 3",...e.map(e=>k(e))].join("\n")}var C=n(87877),T=n(23950),A=n(10525),M=n(27868);const P=(0,r.lazy)(()=>n.e(7815).then(n.bind(n,17815)));function I(e,t){const n=e.find(e=>e.displayId===t);if(!n)throw new Error(`could not find display config ${t}`);return n}function R(e,t,n){return a.types.model(t,{id:M.K,type:a.types.literal(t),configuration:(0,C.AK)(n),minimized:!1,pinned:!1,displays:a.types.array(e.pluggableMstType("display","stateModel"))}).views(e=>({get trackId(){return e.configuration.trackId},get rpcSessionId(){const t=(0,s.FI)(e,"adapter");return t?(0,T.L)(t):this.trackId},get name(){return(0,s.FI)(e,"name")},get textSearchAdapter(){return(0,s.FI)(e,"textSearchAdapter")},get adapterConfig(){return(0,s.FI)(e,"adapter")},get viewMenuActions(){return e.displays.flatMap(e=>e.viewMenuActions)},get canConfigure(){const t=(0,l.getSession)(e),{sessionTracks:n,adminMode:r}=t;return(0,A.u3)(t)&&(r||n?.find(e=>e.trackId===this.trackId))}})).views(t=>({get adapterType(){const{adapterConfig:n}=t;if(!n)throw new Error(`no adapter configuration provided for ${t.type}`);const r=e.getAdapterType(n.type);if(!r)throw new Error(`unknown adapter type ${n.type}`);return r}})).actions(t=>({setPinned(e){t.pinned=e},setMinimized(e){t.minimized=e},showDisplay(n,r={}){const a=I(t.configuration.displays,n),o=e.getDisplayType(a.type);if(!o)throw new Error(`unknown display type ${a.type}`);t.displays.push(o.stateModel.create({...r,type:a.type,configuration:n}))},hideDisplay(e){const n=t.displays.filter(t=>t.configuration.displayId===e);for(const e of n)t.displays.remove(e);return n.length},replaceDisplay(n,r,a={}){const o=t.displays.findIndex(e=>e.configuration.displayId===n);if(-1===o)throw new Error(`could not find display id ${n} to replace`);const i=I(t.configuration.displays,r);if(!e.getDisplayType(i.type))throw new Error(`unknown display type ${i.type}`);t.displays.splice(o,1,{...a,type:i.type,configuration:r})}})).views(()=>({saveTrackFileFormatOptions:()=>({gff3:{name:"GFF3",extension:"gff3",callback:x},genbank:{name:"GenBank",extension:"gbk",callback:y,helpText:"Note: GenBank format export is experimental. The generated output may not fully conform to the GenBank specification and should be validated before use in production workflows."},bed:{name:"BED",extension:"bed",callback:i}})})).views(t=>({trackMenuItems(){const n=t.displays.flatMap(e=>e.trackMenuItems()),r=t.displays[0].configuration.displayId,a=function(e){const{pluginManager:t}=(0,l.getEnv)(e),n=(0,l.getContainingView)(e),r=t.getViewType(n.type),a=new Set(r.displayTypes.map(e=>e.name));return e.configuration.displays.filter(e=>a.has(e.type))}(t);return[...n,{label:"Save track data",icon:o.A,priority:998,onClick:()=>{(0,l.getSession)(t).queueDialog(e=>[P,{model:t,handleClose:e}])}},...a.length>1?[{type:"subMenu",label:"Display types",priority:-1e3,subMenu:a.map(n=>{const a=e.getDisplayType(n.type);return{type:"radio",label:a.displayName,helpText:a.helpText,checked:n.displayId===r,onClick:()=>{n.displayId!==r&&t.replaceDisplay(r,n.displayId,t.displays[0].getPortableSettings?.()??{})}}})}]:[]]}})).postProcessSnapshot(e=>{if(!e)return e;const{minimized:t,pinned:n,...r}=e;return{...r,...t?{minimized:t}:{},...n?{pinned:n}:{}}})}},77346(e,t,n){n.d(t,{D:()=>i});var r=n(77251),a=n(70203),o=n(99226);async function i({model:e,adapterConfig:t,blocks:n,opts:i}){const{rpcManager:s}=(0,r.getSession)(e),l=(0,a.getRpcSessionId)(e);return await s.call(l,"PileupGetVisibleModifications",{adapterConfig:t,sessionId:l,regions:n.contentBlocks,rpcDriverName:e.effectiveRpcDriverName,statusCallback:t=>{(0,o.isAlive)(e)&&e.setStatusMessage(t)},...i})}},79079(e,t,n){n.d(t,{A:()=>i});var r=n(33579),a=n(64074),o=n(32118);const i=(0,a.observer)(function({model:e,orientation:t}){const{ticks:n}=e,a=(0,r.A)();if(!n)return null;const{range:i,values:s,position:l}=n,c=a.palette.background.default,d=a.palette.text.primary,u="left"===t,p=u?-1:1,h=i[0]+.5,g=i[1]+.5;return(0,o.jsxs)("g",{fill:"none",fontSize:10,fontFamily:"sans-serif",textAnchor:u?"end":"start",strokeWidth:1,children:[(0,o.jsx)("path",{stroke:d,d:`M${6*p},${h}H0.5V${g}H${6*p}`}),s.map((e,t)=>{const n=l(e);return(0,o.jsxs)("g",{transform:`translate(0,${Number.isFinite(n)?n:0})`,children:[(0,o.jsx)("line",{stroke:d,x2:6*p,y1:.5,y2:.5}),(0,o.jsx)("text",{stroke:c,strokeWidth:2.5,paintOrder:"stroke",fill:d,dy:"0.32em",x:9*p,y:.5,children:e})]},t)})]})})},79235(e,t,n){n.d(t,{S:()=>k,A:()=>x});var r=n(42918),a=n(54351),o=n(87877),i=n(14665),s=n(99226),l=n(64074),c=n(32118);const d=(0,l.observer)(function({model:e}){const t=e?.target;if(t){if(t.type)return`${t.type} settings`;if((0,s.isStateTreeNode)(t)){const e=(0,s.getType)(t);if(e.name)return`${e.name.replace("ConfigurationSchema","")} settings`}}return(0,c.jsx)(c.Fragment,{children:"Settings"})});var u=n(77251),p=n(27868),h=n(38567);const g=(0,o.S7)("ConfigurationEditorWidget",{}),m=(0,r.lazy)(()=>Promise.all([n.e(2687),n.e(4489),n.e(8501),n.e(1272)]).then(n.bind(n,61272)));var f=n(58946);const y=(0,o.S7)("FromConfigAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"}),b=(0,o.S7)("FromConfigRegionsAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"}),w=(0,o.S7)("FromConfigSequenceAdapter",{features:{type:"frozen",defaultValue:[]}},{explicitlyTyped:!0,implicitIdentifier:"adapterId"}),v=(0,o.S7)("NcbiSequenceReportAliasAdapter",{location:{type:"fileLocation",defaultValue:{uri:"/path/to/my/sequence_report.tsv",locationType:"UriLocation"}},useNameOverride:{type:"boolean",defaultValue:!0,description:"forces usage of the UCSC names over the NCBI style names from a FASTA"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,location:{uri:e.uri,baseUri:e.baseUri}}:e}),S=(0,o.S7)("RefNameAliasAdapter",{location:{type:"fileLocation",defaultValue:{uri:"/path/to/my/aliases.txt",locationType:"UriLocation"}},refNameColumn:{type:"number",defaultValue:0},refNameColumnHeaderName:{type:"string",description:"alternative to refNameColumn, instead looks at header (starts with # and finds column name)",defaultValue:""}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,location:{uri:e.uri,baseUri:e.baseUri}}:e}),k=(0,r.lazy)(()=>Promise.all([n.e(2687),n.e(4489),n.e(8501),n.e(1272)]).then(n.bind(n,61272)));class x extends a.A{name="ConfigurationPlugin";install(e){!function(e){e.addAdapterType(()=>new f.A({name:"FromConfigAdapter",configSchema:y,getAdapterClass:()=>n.e(7819).then(n.bind(n,97819)).then(e=>e.default),adapterMetadata:{hiddenFromGUI:!0}}))}(e),function(e){e.addAdapterType(()=>new f.A({name:"FromConfigRegionsAdapter",configSchema:b,getAdapterClass:()=>n.e(2277).then(n.bind(n,82277)).then(e=>e.default),adapterMetadata:{hiddenFromGUI:!0}}))}(e),function(e){e.addAdapterType(()=>new f.A({name:"FromConfigSequenceAdapter",configSchema:w,getAdapterClass:()=>n.e(815).then(n.bind(n,90815)).then(e=>e.default),adapterMetadata:{hiddenFromGUI:!0}}))}(e),function(e){e.addAdapterType(()=>new f.A({name:"RefNameAliasAdapter",configSchema:S,getAdapterClass:()=>n.e(8875).then(n.bind(n,58875)).then(e=>e.default),adapterMetadata:{hiddenFromGUI:!0}}))}(e),function(e){e.addWidgetType(()=>new i.A({name:"ConfigurationEditorWidget",HeadingComponent:d,configSchema:g,stateModel:s.types.model("ConfigurationEditorWidget",{id:p.K,type:s.types.literal("ConfigurationEditorWidget")}).volatile(()=>({target:void 0})).actions(e=>({setTarget(t){e.target=t},afterCreate(){let t;(0,s.addDisposer)(e,(0,h.autorun)(()=>{if(e.target){const n=(0,s.getSnapshot)(e.target);clearTimeout(t),t=setTimeout(()=>{(0,u.getSession)(e).jbrowse.updateTrackConf(n)},400)}}))}})),ReactComponent:m}))}(e),function(e){e.addAdapterType(()=>new f.A({name:"NcbiSequenceReportAliasAdapter",configSchema:v,getAdapterClass:()=>n.e(7185).then(n.bind(n,67185)).then(e=>e.default),adapterMetadata:{hiddenFromGUI:!0}}))}(e)}}},79387(e,t,n){function r(e){return"getRegions"in e&&"getFeatures"in e}function a(e){return"getRegions"in e}function o(e){return"getFeatures"in e}function i(e){return"getRefNameAliases"in e}function s(e){return"searchIndex"in e}n.d(t,{DD:()=>a,V0:()=>s,c7:()=>o,iD:()=>i,z_:()=>r})},80009(e,t,n){n.d(t,{A:()=>r,S:()=>a});class r{constructor(e){this.label=e.label,this.locString=e.locString,this.renderingComponent=e.renderingComponent,this.displayString=e.displayString,this.matchedAttribute=e.matchedAttribute,this.matchedObject=e.matchedObject,this.textSearchAdapter=e.textSearchAdapter,this.relevance=e.relevance,this.trackId=e.trackId,this.score=e.score||1,this.results=e.results||[]}getLabel(){return this.label}getDisplayString(){return this.displayString||this.label}getRenderingComponent(){return this.renderingComponent}getTrackId(){return this.trackId}getScore(){return this.score}updateScore(e){return this.score=e,this.score}getId(){return`${this.getLabel()}-${this.getLocation()}-${this.getTrackId()}`}hasLocation(){return!!this.locString}getLocation(){return this.locString}getComboResults(){return this.results}}class a extends r{constructor(e){super(e),this.refName=e.refName??""}getLocation(){return this.refName}}},80449(e,t,n){n.d(t,{A:()=>T,L:()=>w});var r=n(11259),a=n(77251),o=n(61132),i=n(27868),s=n(99226),l=n(38567),c=n(70203),d=n(53732);function u(e,t,n){return e.filter(e=>t.filter(t=>n(t,e)).length>5)}function p(e,t,n){const a=(0,r.QZ)(t,"category")||[],o=e.toLowerCase();return(0,c.getTrackName)(t,n).toLowerCase().includes(o)||a.some(e=>e.toLowerCase().includes(o))}function h(e,t,n=0){let r=!1;for(const a of e)a.children.length?h(a.children,t,n+1)&&n>0&&t.push(a.id):r=!0;return r}function g(e,t){for(const n of e)n.children.length&&t.push(n.id)}const m=["category","adapter","description"];function f(e,t){const{assemblyManager:n}=(0,a.getSession)(t),{pluginManager:o}=(0,a.getEnv)(t),{view:i}=t;if(!i)return[];const s=t.assemblyNames.map(e=>n.getCanonicalAssemblyName(e)).filter(a.notEmpty),{displayTypes:l}=o.getViewType(i.type),c=new Set(l.map(e=>e.name));return e.filter(e=>{const t=(0,r.QZ)(e,"assemblyNames"),l=t?.map(e=>n.getCanonicalAssemblyName(e)).filter(a.notEmpty);return!!(i.trackSelectorAnyOverlap?function(e=[],t=[]){if(e[0]===t[0])return!0;{const n=new Set(e);return t.some(e=>n.has(e))}}(l,s):function(e=[],t=[]){const n=new Set(e);return t.every(e=>n.has(e))}(l,s))&&o.getTrackType(e.type).displayTypes.some(e=>c.has(e.name))})}function y({model:e,trackConfs:t,extra:n,noCategories:o,menuItems:i}){const s={children:[]},{filterText:l,activeSortTrackNames:d,activeSortCategories:u}=e,h=(0,a.getSession)(e),g=t.filter(e=>p(l,e,h)),m=new Map,f=new Map;for(const e of function(e,t,n){const a=e.map(e=>[e,(0,r.QZ)(e,"name"),(0,r.QZ)(e,"category")?.[0]||"",(0,r.QZ)(e,"category")?.[1]||"",(0,r.QZ)(e,"category")?.[2]||""]);return t&&a.sort((e,t)=>e[1].localeCompare(t[1])),n&&a.sort((e,t)=>e[2]!==t[2]?e[2].localeCompare(t[2]):e[3]!==t[3]?e[3].localeCompare(t[3]):e[4]!==t[4]?e[4].localeCompare(t[4]):0),a.map(e=>e[0])}(g,d,u)){const t=e.trackId.endsWith("sessionTrack"),a=(0,r.QZ)(e,"category")??[],l=t?[" Session tracks",...a]:a;let d=s,u=0;if(!o){let e="";for(const[t,r]of l.entries()){const a=r;e=e?`${e},${a}`:a;let o=f.get(d);o||(o=new Map,f.set(d,o));let s=o.get(a);s||(s={children:[],name:a,id:n?`${n}-${e}`:e,nestingLevel:t+1,menuItems:i,type:"category"},d.children.push(s),o.set(a,s)),d=s,u=t+1}}const p=m.get(d)??0;d.children.splice(p,0,{id:n?`${n},${e.trackId}`:e.trackId,trackId:e.trackId,name:(0,c.getTrackName)(e,h),conf:e,children:[],nestingLevel:u+1,type:"track"}),m.set(d,p+1)}return s.children}function b(){return"undefined"!=typeof window?[window.location.pathname,new URLSearchParams(window.location.search).get("config")].filter(Boolean).join("-"):"empty"}function w(e){return"category"===e.type?40:22}function v(e){return["recentlyUsedTracks",b(),e.join(",")].filter(Boolean).join("-")}function S(){return`favoriteTracks-${b()}}`}function k(e,t){return["collapsedCategories",b(),e.join(","),t].join("-")}function x(e,t){const n=(0,a.localStorageGetItem)(e);return null!=n&&n?JSON.parse(n):t}function C(e,t){null!=t&&(0,a.localStorageSetItem)(e,JSON.stringify(t))}function T(e){return s.types.model("HierarchicalTrackSelectorWidget",{id:i.K,type:s.types.literal("HierarchicalTrackSelectorWidget"),view:s.types.safeReference(e.pluggableMstType("view","stateModel")),faceted:s.types.optional(s.types.model("FacetedModel",{filterText:s.types.optional(s.types.string,""),showSparse:s.types.optional(s.types.boolean,()=>(0,a.localStorageGetBoolean)("facet-showSparse",!1)),showFilters:s.types.optional(s.types.boolean,()=>(0,a.localStorageGetBoolean)("facet-showFilters",!0)),showOptions:s.types.optional(s.types.boolean,()=>(0,a.localStorageGetBoolean)("facet-showTableOptions",!1)),panelWidth:s.types.optional(s.types.number,()=>(0,a.localStorageGetNumber)("facet-panelWidth",400))}).volatile(()=>({visible:{},useShoppingCart:!1,filters:l.observable.map()})).actions(e=>({setFilter(t,n){e.filters.set(t,n)},setPanelWidth:t=>(e.panelWidth=t,e.panelWidth),setUseShoppingCart(t){e.useShoppingCart=t},setFilterText(t){e.filterText=t},setShowSparse(t){e.showSparse=t},setShowOptions(t){e.showOptions=t},setShowFilters(t){e.showFilters=t},setVisible(t){e.visible=t}})).views(e=>({get allTrackConfigurations(){return(0,s.getParent)(e).allTrackConfigurations}})).views(e=>({get rows(){const t=(0,a.getSession)(e),{allTrackConfigurations:n,filterText:o}=e;return n.filter(e=>p(o,e,t)).map(e=>({id:e.trackId,conf:e,name:(0,c.getTrackName)(e,t),category:(0,r.QZ)(e,"category")?.join(", "),adapter:(0,r.QZ)(e,"adapter")?.type,description:(0,r.QZ)(e,"description"),metadata:e.metadata||{}}))}})).views(e=>({get filteredNonMetadataKeys(){return e.showSparse?m:u(m,e.rows,(e,t)=>e[t])},get metadataKeys(){return[...new Set(e.rows.flatMap(e=>{return t=e.metadata,Object.entries(t).map(([e,t])=>"string"==typeof t?e:"").filter(e=>!!e);var t}))]},get filteredMetadataKeys(){return e.showSparse?this.metadataKeys:u(this.metadataKeys,e.rows,(e,t)=>e.metadata[t])},get fields(){return["name",...this.filteredNonMetadataKeys,...this.filteredMetadataKeys.map(e=>`metadata.${e}`)]},get filteredRows(){const t=[...e.filters.entries()].filter(e=>e[1].length>0).map(([e,t])=>[e,new Set(t)]);return e.rows.filter(e=>t.every(([t,n])=>n.has((0,d.a)(t,e))))}})).actions(e=>({afterAttach(){(0,s.addDisposer)(e,(0,l.autorun)(function(){e.setVisible(Object.fromEntries(e.fields.map(e=>[e,!0])))},{name:"FacetedVisible"}))}})).postProcessSnapshot(e=>{if(!e)return e;const{filterText:t,showSparse:n,showFilters:r,showOptions:a,panelWidth:o,...i}=e;return{...i,...t?{filterText:t}:{},...n?{showSparse:n}:{},...r?{}:{showFilters:r},...a?{showOptions:a}:{},...400!==o?{panelWidth:o}:{}}}),{})}).volatile(()=>({favorites:x(S(),[]),recentlyUsed:[],selection:[],sortTrackNames:x("sortTrackNames",void 0),sortCategories:x("sortCategories",void 0),collapsed:l.observable.map(),filterText:"",recentlyUsedCounter:0,favoritesCounter:0})).views(e=>({get shownTrackIds(){return new Set(e.view?.tracks?.map(e=>e.configuration.trackId))},get selectionSet(){return new Set(e.selection)},get favoritesSet(){return new Set(e.favorites)},get recentlyUsedSet(){return new Set(e.recentlyUsed)},get assemblyNames(){return e.view?.assemblyNames||[]}})).actions(e=>({setSortTrackNames(t){e.sortTrackNames=t},setSortCategories(t){e.sortCategories=t},setSelection(t){e.selection=t},addToSelection(t){e.selection=(0,o.Q)([...e.selection,...t],e=>e.trackId)},removeFromSelection(t){const n=new Set(t);e.selection=e.selection.filter(e=>!n.has(e))},clearSelection(){e.selection=[]},addToFavorites(t){e.favoritesCounter+=1,e.favorites=[...e.favorites,t]},removeFromFavorites(t){e.favorites=e.favorites.filter(e=>e!==t)},clearFavorites(){e.favorites=[]},setRecentlyUsedCounter(t){e.recentlyUsedCounter=t},setRecentlyUsed(t){e.recentlyUsed=t},setFavorites(t){e.favorites=t},setFavoritesCounter(t){e.favoritesCounter=t},addToRecentlyUsed(t){e.recentlyUsed.includes(t)||(e.recentlyUsedCounter=Math.min(e.recentlyUsedCounter+1,10),e.recentlyUsed=e.recentlyUsed.length>=10?[...e.recentlyUsed.slice(1),t]:[...e.recentlyUsed,t])},clearRecentlyUsed(){e.recentlyUsed=[]},setView(t){e.view=t},toggleCategory(t){e.collapsed.set(t,!e.collapsed.get(t))},setCategoryCollapsed(t,n){e.collapsed.set(t,n)},expandAllCategories(){e.collapsed.clear()},setCollapsedCategories(t){e.collapsed.replace(t)},clearFilterText(){e.filterText=""},setFilterText(t){e.filterText=t}})).views(t=>({isSelected:e=>t.selectionSet.has(e),isFavorite:e=>t.favoritesSet.has(e),isRecentlyUsed:e=>t.recentlyUsedSet.has(e),getRefSeqTrackConf(n){const{assemblyManager:r}=(0,a.getSession)(t),o=r.get(n),i=o?.configuration.sequence,s=e.getViewType(t.view.type);if(i)for(const e of i.displays)if(s.displayTypes.some(t=>t.name===e.type))return i}})).views(e=>({get activeSortTrackNames(){return e.sortTrackNames??(0,r.FI)((0,a.getSession)(e),["hierarchical","sort","trackNames"])},get activeSortCategories(){return e.sortCategories??(0,r.FI)((0,a.getSession)(e),["hierarchical","sort","categories"])},get configAndSessionTrackConfigurations(){return[...e.assemblyNames.map(t=>e.getRefSeqTrackConf(t)),...f((0,a.getSession)(e).tracks,e)].filter(a.notEmpty)},get allTrackConfigurations(){const{connectionInstances:t=[]}=(0,a.getSession)(e);return[...this.configAndSessionTrackConfigurations,...t.flatMap(e=>e.tracks)]},get allTrackConfigurationTrackIdSet(){return new Map(this.allTrackConfigurations.map(e=>[e.trackId,e]))}})).views(e=>({get favoriteTracks(){return e.favorites.filter(t=>e.allTrackConfigurationTrackIdSet.has(t)).map(t=>e.allTrackConfigurationTrackIdSet.get(t))},get recentlyUsedTracks(){return e.recentlyUsed.filter(t=>e.allTrackConfigurationTrackIdSet.has(t)).map(t=>e.allTrackConfigurationTrackIdSet.get(t))}})).views(e=>({get allTracks(){const{connectionInstances:t=[]}=(0,a.getSession)(e);return[{group:"Tracks",tracks:e.configAndSessionTrackConfigurations,noCategories:!1,menuItems:[]},...t.flatMap(t=>({group:(0,r.FI)(t,"name"),tracks:f(t.tracks,e),noCategories:!1,menuItems:[]}))]}})).views(e=>({get hierarchy(){return{name:"Root",id:"Root",type:"category",children:e.allTracks.map(t=>({name:t.group,id:t.group,type:"category",menuItems:t.menuItems,nestingLevel:0,children:y({model:e,trackConfs:t.tracks,extra:t.group,noCategories:t.noCategories})}))}}})).views(e=>({get flattenedItems(){const t=(n,r=[])=>{for(const a of n)r.push(a),a.children.length>0&&!e.collapsed.get(a.id)&&t(a.children,r);return r};return t(e.hierarchy.children)},get flattenedItemOffsets(){const e=[];let t=0;for(let n=0,r=this.flattenedItems.length;n<r;n++)e.push(t),t+=w(this.flattenedItems[n]);return{cumulativeHeight:t,offsets:e}}})).views(e=>({itemOffsets(t,n){const{flattenedItemOffsets:r}=e,{cumulativeHeight:a,offsets:o}=r;if(0===o.length)return{startIndex:0,endIndex:0,totalHeight:0,itemOffsets:o};const i=e=>{let t=0,n=o.length-1;for(;t<=n;){const r=Math.floor((t+n)/2);if(o[r]<=e&&(r===o.length-1||o[r+1]>e))return r;o[r]<e?t=r+1:n=r-1}return 0},s=n+t+440;return{startIndex:Math.max(0,i(n)-20),endIndex:Math.min(o.length-1,i(s)+20),totalHeight:a,itemOffsets:o}}})).actions(e=>({collapseSubCategories(){const t=[];h(e.hierarchy.children,t);for(const n of t)e.setCategoryCollapsed(n,!0)},collapseTopLevelCategories(){const t=[];for(const n of e.hierarchy.children)n.children.length&&g(n.children,t);for(const n of t)e.setCategoryCollapsed(n,!0)}})).views(e=>({get hasAnySubcategories(){return e.allTracks.some(e=>e.tracks.some(e=>(0,r.QZ)(e,"category")?.length>1))}})).actions(e=>({afterAttach(){(0,s.addDisposer)(e,(0,l.autorun)(function(){const{assemblyNames:t,view:n}=e;if(e.setRecentlyUsed(x(v(t),[])),n){const o=x(k(t,n.type),void 0),i=["hierarchical","defaultCollapsed"],s=(0,a.getSession)(e);if(o)e.setCollapsedCategories(o);else{e.expandAllCategories(),(0,r.FI)(s,[...i,"topLevelCategories"])&&e.collapseTopLevelCategories(),(0,r.FI)(s,[...i,"subCategories"])&&e.collapseSubCategories();for(const t of(0,r.FI)(s,[...i,"categoryNames"]))e.setCategoryCollapsed(`Tracks-${t}`,!0)}}},{name:"TrackSelectorInit"})),(0,s.addDisposer)(e,(0,l.autorun)(function(){const{sortTrackNames:t,sortCategories:n,favorites:r,recentlyUsed:a,assemblyNames:o,collapsed:i,view:s}=e;C(v(o),a),C(S(),r),C("sortTrackNames",t),C("sortCategories",n),s&&C(k(o,s.type),i)},{name:"TrackSelectorLocalStorage"}))}}))}},80764(e,t,n){n.d(t,{A:()=>s});var r=n(99226),a=n(53705),o=n(77251),i=n(25978);function s(e,t=!0,n=!0){const{offsetPx:s,displayedRegions:l,bpPerPx:c,width:d,minimumBlockWidth:u,interRegionPaddingWidth:p}=e;if(!d)throw new Error("view has no width, cannot calculate displayed blocks");const h=1/c,g=new a.mh;let m=0;const f=s,y=f+d;for(let e=0;e<l.length;e++){const b=l[e],{assemblyName:w,refName:v,start:S,end:k,reversed:x}=b,C=m+(k-S)*h,T=(k-S)*h,A=(0,r.isStateTreeNode)(b)?(0,r.getSnapshot)(b):b,[M,P]=(0,i.ky)(f,y,m,C);if(void 0!==M&&void 0!==P){let r,i,f,y,b;x?(r=Math.max(S,k-(P-m)*c),i=k-(M-m)*c,f=i===k,y=r===S,b=m+(k-i)*h):(r=(M-m)*c+S,i=Math.min(k,(P-m)*c+S),f=r===S,y=i===k,b=m+(r-S)*h);const C={assemblyName:w,refName:v,start:r,end:i,reversed:x,offsetPx:b,parentRegion:A,regionNumber:e,widthPx:(i-r)*h,isLeftEndOfDisplayedRegion:f,isRightEndOfDisplayedRegion:y,key:`${(0,o.assembleLocStringFast)({assemblyName:w,refName:v,start:r,end:i,reversed:x})}-${e}${x?"-reversed":""}`};t&&0===g.length&&f&&g.push(new a.fK({key:`${C.key}-beforeFirstRegion`,widthPx:-s,offsetPx:C.offsetPx+s,variant:"boundary"})),n&&T<u?g.push(new a.Db(C)):g.push(new a.$G(C)),t&&(T>=u&&C.isRightEndOfDisplayedRegion&&e<l.length-1&&(g.push(new a.fK({key:`${C.key}-rightpad`,widthPx:p,offsetPx:C.offsetPx+C.widthPx})),m+=p),e===l.length-1&&C.isRightEndOfDisplayedRegion&&(b=C.offsetPx+C.widthPx,g.push(new a.fK({key:`${C.key}-afterLastRegion`,widthPx:d-b+s,offsetPx:b,variant:"boundary"}))))}m+=(k-S)*h}return g}},80921(e,t,n){n.d(t,{FX:()=>o,Lp:()=>s,Us:()=>a,V4:()=>l,Vg:()=>c,f2:()=>r,fb:()=>d,lh:()=>i});const r=.3,a="#ccc",o="hsl(50,50%,50%)",i="black",s=200,l=50,c="hsl(0,100%,20%)";function d(e){return`hsl(${s},${l}%,${80-50*e}%)`}},82699(e,t,n){n.d(t,{A:()=>V});var r=n(42918),a=n(17252),o=n(74753),i=n(58919),s=n(52743),l=n(64074),c=n(30936),d=n(96919),u=n(65525),p=n(1591),h=n(77251),g=n(70203),m=n(65045),f=n(32118);function y(e){return"blobId"in e}const b=(0,m.n)()(e=>({filename:{marginLeft:e.spacing(1)}})),w=function(e){const t=(0,c.c)(18),{location:n,setLocation:r}=e,{classes:o}=b();let i;t[0]!==n?(i=n&&(y(n)&&n.name||"localPath"in n&&n.localPath),t[0]=n,t[1]=i):i=t[1];const s=i;let l;t[2]!==n?(l=n&&y(n)&&!(0,g.getBlob)(n.blobId),t[2]=n,t[3]=l):l=t[3];const m=l;let w;t[4]!==r?(w=(0,f.jsx)(a.A,{children:(0,f.jsx)(d.A,{fullWidth:!0,children:(0,f.jsxs)(u.A,{variant:"outlined",component:"label",children:["Choose File",(0,f.jsx)("input",{type:"file",hidden:!0,onChange:e=>{const{target:t}=e,n=t.files?.[0];if(n)if(h.isElectron){const{webUtils:e}=window.require("electron");r({localPath:e.getPathForFile(n),locationType:"LocalPathLocation"})}else r((0,g.storeBlobLocation)({blob:n}))}})]})})}),t[4]=r,t[5]=w):w=t[5];const v=s?"initial":"textSecondary",S=s||"No file chosen";let k,x,C,T;return t[6]!==o.filename||t[7]!==v||t[8]!==S?(k=(0,f.jsx)(p.A,{component:"span",className:o.filename,color:v,children:S}),t[6]=o.filename,t[7]=v,t[8]=S,t[9]=k):k=t[9],t[10]!==m?(x=m?(0,f.jsx)(p.A,{color:"error",children:"(need to reload)"}):null,t[10]=m,t[11]=x):x=t[11],t[12]!==k||t[13]!==x?(C=(0,f.jsxs)(a.A,{children:[k,x]}),t[12]=k,t[13]=x,t[14]=C):C=t[14],t[15]!==w||t[16]!==C?(T=(0,f.jsxs)(a.A,{display:"flex",flexDirection:"row",alignItems:"center",children:[w,C]}),t[15]=w,t[16]=C,t[17]=T):T=t[17],T};var v=n(15675),S=n(10525);const k=(0,l.observer)(function({location:e,label:t,style:n,setLocation:r}){return(0,f.jsx)(v.A,{variant:"outlined",fullWidth:!0,defaultValue:e&&(0,S.C1)(e)?e.uri:"",label:t||"Enter URL",style:n,onChange:e=>{r({uri:e.target.value.trim(),locationType:"UriLocation"})},slotProps:{htmlInput:{"data-testid":"urlInput"}}})});function x(e){const t=(0,c.c)(13),{toggleButtonValue:n,selectedAccount:r,location:a,inline:o,setLocation:i}=e;if(r?.SelectorComponent){let e;return t[0]!==r||t[1]!==i?(e=(0,f.jsx)(r.SelectorComponent,{setLocation:i,selectedAccount:r}),t[0]=r,t[1]=i,t[2]=e):e=t[2],e}if("url"===n){const e=r?.selectorLabel;let n,s;return t[3]!==o?(n=o?{margin:0}:void 0,t[3]=o,t[4]=n):n=t[4],t[5]!==a||t[6]!==i||t[7]!==e||t[8]!==n?(s=(0,f.jsx)(k,{location:a,setLocation:i,label:e,style:n}),t[5]=a,t[6]=i,t[7]=e,t[8]=n,t[9]=s):s=t[9],s}if("file"===n){let e;return t[10]!==a||t[11]!==i?(e=(0,f.jsx)(w,{location:a,setLocation:i}),t[10]=a,t[11]=i,t[12]=e):e=t[12],e}return null}var C=n(36533),T=n(95321),A=n(27607),M=n(9625),P=n(75695),I=n(27463);function R(e,t){return e.length>t?`${e.slice(0,t)}…`:e}function L(e){const t=(0,c.c)(10);let n,r,a;t[0]!==e?(({title:a,children:n,...r}=e),t[0]=e,t[1]=n,t[2]=r,t[3]=a):(n=t[1],r=t[2],a=t[3]);const o=a||"";let i,s;return t[4]!==n||t[5]!==r?(i=(0,f.jsx)(T.A,{...r,children:n}),t[4]=n,t[5]=r,t[6]=i):i=t[6],t[7]!==o||t[8]!==i?(s=(0,f.jsx)(A.A,{title:o,children:i}),t[7]=o,t[8]=i,t[9]=s):s=t[9],s}function F(e){const t=(0,c.c)(13),{anchorEl:n,hiddenAccountIds:r,accountMap:a,onClose:o,onSelect:i}=e;if(!n)return null;let s,l,d,u;if(t[0]===Symbol.for("react.memo_cache_sentinel")?(s={vertical:"bottom",horizontal:"center"},l={vertical:"top",horizontal:"center"},t[0]=s,t[1]=l):(s=t[0],l=t[1]),t[2]!==a||t[3]!==r||t[4]!==i){let e;t[6]!==a||t[7]!==i?(e=e=>(0,f.jsx)(M.A,{value:e,onClick:()=>{i(e)},children:a[e].name},e),t[6]=a,t[7]=i,t[8]=e):e=t[8],d=r.map(e),t[2]=a,t[3]=r,t[4]=i,t[5]=d}else d=t[5];return t[9]!==n||t[10]!==o||t[11]!==d?(u=(0,f.jsx)(P.A,{open:!0,anchorEl:n,anchorOrigin:s,transformOrigin:l,onClose:o,children:d}),t[9]=n,t[10]=o,t[11]=d,t[12]=u):u=t[12],u}function D(e){const t=(0,c.c)(25),{value:n,shownAccountIds:a,hiddenAccountIds:o,accountMap:i,onChange:s,onHiddenAccountSelect:l}=e,[d,u]=(0,r.useState)(null);let p,h,g,m,y,b,w,v,S;if(t[0]===Symbol.for("react.memo_cache_sentinel")?(p=null!==new URLSearchParams(window.location.search).get("adminKey")?null:(0,f.jsx)(T.A,{size:"small",value:"file","aria-label":"local file",children:"File"}),h=(0,f.jsx)(T.A,{size:"small",value:"url","aria-label":"url",children:"URL"}),t[0]=p,t[1]=h):(p=t[0],h=t[1]),t[2]!==i||t[3]!==a){let e;t[5]!==i?(e=e=>{const t=i[e],{toggleContents:n,name:r}=t,a="string"==typeof n?R(n,5):n||R(r,5);return(0,f.jsx)(L,{value:e,title:r,children:a},e)},t[5]=i,t[6]=e):e=t[6],g=a.map(e),t[2]=i,t[3]=a,t[4]=g}else g=t[4];return t[7]!==o.length?(m=o.length>0?(0,f.jsxs)(T.A,{value:"more",onClick:e=>{u(e.target)},selected:!1,children:["More",(0,f.jsx)(C.A,{})]}):null,t[7]=o.length,t[8]=m):m=t[8],t[9]!==s||t[10]!==g||t[11]!==m||t[12]!==n?(y=(0,f.jsxs)(I.A,{value:n,exclusive:!0,size:"small",onChange:s,"aria-label":"file, url, or account picker",children:[p,h,g,m]}),t[9]=s,t[10]=g,t[11]=m,t[12]=n,t[13]=y):y=t[13],t[14]===Symbol.for("react.memo_cache_sentinel")?(b=()=>{u(null)},t[14]=b):b=t[14],t[15]!==l?(w=e=>{l(e),u(null)},t[15]=l,t[16]=w):w=t[16],t[17]!==i||t[18]!==d||t[19]!==o||t[20]!==w?(v=(0,f.jsx)(F,{anchorEl:d,hiddenAccountIds:o,accountMap:i,onClose:b,onSelect:w}),t[17]=i,t[18]=d,t[19]=o,t[20]=w,t[21]=v):v=t[21],t[22]!==y||t[23]!==v?(S=(0,f.jsxs)(f.Fragment,{children:[y,v]}),t[22]=y,t[23]=v,t[24]=S):S=t[24],S}function N(e){return e.internetAccountId}function B(e){return[e.internetAccountId,e]}function E(e){return"HTTPBasicInternetAccount"!==e.type}const V=(0,l.observer)(function({inline:e,location:t,name:n,description:l,rootModel:d,setLocation:u}){const[p,g]=(0,r.useState)(()=>function(e){return e&&"internetAccountId"in e&&e.internetAccountId?e.internetAccountId:!e||(0,S.C1)(e)?"url":"file"}(t)),{accountMap:m,shownAccountIds:y,hiddenAccountIds:b,recentlyUsed:w,setRecentlyUsed:v}=function(e){const t=(0,c.c)(14);let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=[],t[0]=n):n=t[0];const[r,a]=(0,h.useLocalStorage)("fileSelector-recentlyUsedInternetAccounts",n);let o,i,s,l;if(t[1]!==r||t[2]!==e){const n=(0,S.bV)(e)?e.internetAccounts.filter(E):[],a=Object.fromEntries(n.map(B));let l;t[6]!==r?(l=(e,t)=>r.indexOf(e)-r.indexOf(t),t[6]=r,t[7]=l):l=t[7];const c=[...new Set(n.map(N))].sort(l);o=a,i=c.slice(0,2),s=c.slice(2),t[1]=r,t[2]=e,t[3]=o,t[4]=i,t[5]=s}else o=t[3],i=t[4],s=t[5];return t[8]!==r||t[9]!==a||t[10]!==o||t[11]!==i||t[12]!==s?(l={accountMap:o,shownAccountIds:i,hiddenAccountIds:s,recentlyUsed:r,setRecentlyUsed:a},t[8]=r,t[9]=a,t[10]=o,t[11]=i,t[12]=s,t[13]=l):l=t[13],l}(d),k=m[p],C=(0,r.useCallback)(e=>{u({...e,...k&&(0,S.C1)(e)?{internetAccountId:k.internetAccountId}:{}})},[u,k]);(0,r.useEffect)(()=>{k&&(0,S.C1)(t)&&t.internetAccountId!==k.internetAccountId&&C(t)},[t,k,C]);const T=(0,r.useCallback)(e=>{v([...new Set([e,...w].filter(h.notEmpty))]),e&&g(e),(0,S.C1)(t)&&C(t)},[t,w,v,C]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.A,{display:"flex",children:(0,f.jsx)(o.A,{shrink:!0,children:n})}),(0,f.jsx)(i.A,{children:(0,f.jsxs)(a.A,{display:"flex",flexDirection:e?"row":"column",gap:.5,children:[(0,f.jsx)(D,{value:p,shownAccountIds:y,hiddenAccountIds:b,accountMap:m,onChange:(e,t)=>{T(t)},onHiddenAccountSelect:T}),(0,f.jsx)(x,{toggleButtonValue:p,selectedAccount:k,location:t,inline:e,setLocation:C})]})}),(0,f.jsx)(s.A,{children:l})]})})},82947(e,t,n){n.d(t,{A:()=>c});var r=n(30936),a=n(65045),o=n(27607),i=n(52681),s=n(32118);const l=(0,a.n)()({ellipses:{textOverflow:"ellipsis",overflow:"hidden"},content:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",maxWidth:"80%",textAlign:"center"}});function c(e){const t=(0,r.c)(13),{message:n,severity:a,action:c}=e,{classes:p}=l();let h,g,m,f;return t[0]!==p.ellipses?(h={message:p.ellipses},t[0]=p.ellipses,t[1]=h):h=t[1],t[2]!==p.content||t[3]!==n?(g=(0,s.jsx)("div",{className:p.content,children:n}),t[2]=p.content,t[3]=n,t[4]=g):g=t[4],t[5]!==n||t[6]!==g?(m=(0,s.jsx)(o.A,{title:n,children:g}),t[5]=n,t[6]=g,t[7]=m):m=t[7],t[8]!==c||t[9]!==a||t[10]!==h||t[11]!==m?(f=(0,s.jsx)(i.A,{severity:a,action:c,classes:h,onMouseDown:u,onClick:d,children:m}),t[8]=c,t[9]=a,t[10]=h,t[11]=m,t[12]=f):f=t[12],f}function d(e){e.stopPropagation()}function u(e){e.stopPropagation()}},83090(e,t,n){function r(e,t,n){if(!t||!n)return;const{width:r,interRegionPaddingWidth:a,displayedRegions:o,bpPerPx:i,minimumBlockWidth:s}=e,l=function(e,t,n){let r=0;const{displayedRegions:a}=e;if(t.index===n.index)r+=n.offset-t.offset;else{const e=a[t.index];if(r+=e.end-e.start-t.offset,n.index-t.index>=2)for(let e=t.index+1,o=n.index;e<o;e++){const t=a[e];r+=t.end-t.start}r+=n.offset}return r}(e,t,n);let c=0;for(let e=t.index,r=n.index;e<r;e++){const t=o[e];(t.end-t.start)/i>s&&c++}const d=l/(r-a*c),u=e.zoomTo(d);let p=0;d<u&&(p=(u-d)*e.width/2);let h=-p;for(let e=0,n=o.length;e<n;e++){const n=o[e];if(t.index===e){h+=t.offset;break}h+=n.end-n.start}const g=Math.round(h/e.bpPerPx);e.scrollTo(g)}function a(e,t){return Math.floor(e.reversed?e.end-t:e.start+t)+1}function o(e,t){let n=0;const{bpPerPx:r,offsetPx:o,displayedRegions:i,interRegionPaddingWidth:s,staticBlocks:l}=e,c=l.contentBlocks,d=(o+t)*r;if(d<0){const e=i[0];return{...e,oob:!0,coord:a(e,d),offset:d,index:0}}const u=s*r;let p=0;for(let e=0,t=i.length;e<t;e++){const t=i[e],r=t.end-t.start,o=d-n;if(r+n>d&&n<=d)return{...t,oob:!1,offset:o,coord:a(t,o),index:e};if(c[p]?.regionNumber===e){const t=n+r;if(d>=t&&d<t+u&&e+1<i.length){const t=i[e+1];return{...t,oob:!1,offset:0,coord:a(t,0),index:e+1}}n+=r+u,p++}else n+=r}if(d>=n&&i.length>0){const e=i.at(-1),t=d-n+(e.end-e.start);return{...e,oob:!0,offset:t,coord:a(e,t),index:i.length-1}}return{coord:0,index:0,refName:"",oob:!0,assemblyName:"",offset:0,start:0,end:0,reversed:!1}}function i({refName:e,coord:t,regionNumber:n,self:r}){let a=0;const{interRegionPaddingWidth:o,bpPerPx:i,displayedRegions:s,staticBlocks:l}=r,c=l.contentBlocks,d=o*i;let u=0,p=0;for(let r=s.length;p<r;p++){const r=s[p],o=r.end-r.start;if(e===r.refName&&t>=r.start&&t<=r.end&&(!n||n===p)){a+=r.reversed?r.end-t:t-r.start;break}c[u]?.regionNumber===p?(a+=o+d,u++):a+=o}if(s[p])return{index:p,offsetPx:Math.round(a/i)}}n.d(t,{Ii:()=>o,eB:()=>i,tw:()=>r})},83640(e,t,n){n.d(t,{u:()=>i});var r=n(81275),a=n(84708),o=n(53205);async function i(e,t,n,i){const{exportSVG:s,highResolutionScaling:l=1}=n,c=Math.max(1,e),d=Math.max(1,t);if(s){if(s.rasterizeLayers){const n=s.scale||l,r=(0,o.Nw)(Math.ceil(c*n),Math.ceil(d*n)),u=r.getContext("2d");if(!u)throw new Error("2d canvas rendering not supported on this platform");return 1!==n&&u.scale(n,n),{...await i(u),html:`<image width="${e}" height="${t}" href="${"convertToBlob"in r?await(0,a.y)(await r.convertToBlob({type:"image/png"})):r.toDataURL("image/png")}" />`}}{const e=new r.w;return{...await i(e),canvasRecordedData:e.toJSON()}}}{const e=(0,o.Nw)(Math.ceil(c*l),Math.ceil(d*l)),t=e.getContext("2d");if(!t)throw new Error("2d canvas rendering not supported on this platform");return 1!==l&&t.scale(l,l),{...await i(t),imageData:await(0,o.T9)(e)}}}},84182(e,t,n){n.d(t,{Jf:()=>l,Kd:()=>i,cm:()=>s});var r=n(80009),a=n(77251),o=n(61132);async function i({option:e,model:t,assemblyName:n}){const r=e.getLocation(),a=e.getTrackId();r&&(await t.navToLocString(r,n,.2),a&&t.showTrack(a))}async function s({input:e,model:t,assembly:n}){const r=n.allRefNamesWithLowerCase||[],o=n.name;if(e.split(" ").every(e=>function(e,t){const[n,r]=function(e){const t=e.lastIndexOf(":");if(-1===t)return[e,""];return[e.slice(0,t),e.slice(t+1)]}(e);return t.includes(e)||t.includes(n)&&!Number.isNaN(Number.parseInt(r,10))}(e,r)))await t.navToLocString(e,n.name);else{const r=t.searchScope(o),{textSearchManager:s}=(0,a.getSession)(t),c=await l({queryString:e,searchType:"exact",searchScope:r,rankSearchResults:t.rankSearchResults,textSearchManager:s,assembly:n});c.length>1?t.setSearchResults(c,e.toLowerCase(),o):1===c.length?await i({option:c[0],model:t,assemblyName:o}):await t.navToLocString(e,o)}}async function l({queryString:e,searchType:t,searchScope:n,rankSearchResults:a,textSearchManager:i,assembly:s}){i||console.warn("No text search manager");const l=await(i?.search({queryString:e,searchType:t},n,a)),c=s?.allRefNames?.filter(t=>t.toLowerCase().startsWith(e.toLowerCase())).slice(0,10).map(e=>new r.A({label:e}));return(0,o.Q)([...c||[],...l||[]],e=>e.getId())}},84708(e,t,n){function r(e){const t=new FileReader;return new Promise((n,r)=>{t.onload=e=>{e.target?n(e.target.result):r(new Error("unknown result reading blob from canvas"))},t.readAsDataURL(e)})}n.d(t,{y:()=>r})},84830(e,t,n){n.d(t,{A:()=>s});var r=n(30936),a=n(38630),o=n(16750),i=n(32118);function s(e){const t=(0,r.c)(7);let n,s,l,c;return t[0]!==e?(({children:n,...s}=e),t[0]=e,t[1]=n,t[2]=s):(n=t[1],s=t[2]),t[3]===Symbol.for("react.memo_cache_sentinel")?(l=(0,i.jsx)(a.A,{fontSize:"small"}),t[3]=l):l=t[3],t[4]!==n||t[5]!==s?(c=(0,i.jsxs)(o.A,{...s,target:"_blank",rel:"noopener noreferrer",children:[n," ",l]}),t[4]=n,t[5]=s,t[6]=c):c=t[6],c}},85376(e,t,n){n.d(t,{A:()=>s});var r=n(65045),a=n(64074),o=n(32118);const i=(0,r.n)()(e=>({legend:{position:"absolute",right:10,top:10,background:e.palette.background.paper,padding:3,fontSize:10,pointerEvents:"none",zIndex:100,maxWidth:200},item:{display:"flex",alignItems:"center",marginBottom:1,"&:last-child":{marginBottom:0}},colorBox:{width:12,height:12,marginRight:6,flexShrink:0},label:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})),s=(0,a.observer)(function({items:e}){const{classes:t}=i();return 0===e.length?null:(0,o.jsx)("div",{className:t.legend,children:e.map((e,n)=>(0,o.jsxs)("div",{className:t.item,children:[(0,o.jsx)("div",{className:t.colorBox,style:{backgroundColor:e.color}}),(0,o.jsx)("span",{className:t.label,children:e.label})]},`${e.label}-${n}`))})})},85787(e,t,n){n.d(t,{A:()=>k});var r=n(30936),a=n(42918),o=n(6773),i=n(87861),s=n(74983),l=n(37815),c=n(74919),d=n(29023),u=n(88050),p=n(33579),h=n(34202),g=n(64074),m=n(90975),f=n(27351),y=n(50639),b=n(65045),w=n(32118);const v=(0,b.n)()(e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]},errorBox:{width:800,margin:40}}));function S(e){const t=(0,r.c)(5),{error:n}=e,{classes:a}=v();let o,i;return t[0]!==n?(o=(0,w.jsx)(f.A,{error:n}),t[0]=n,t[1]=o):o=t[1],t[2]!==a.errorBox||t[3]!==o?(i=(0,w.jsx)("div",{className:a.errorBox,children:o}),t[2]=a.errorBox,t[3]=o,t[4]=i):i=t[4],i}const k=(0,g.observer)(function(e){const{classes:t}=v(),{titleNode:n,...r}=e,{title:g,header:f,children:b,onClose:k}=r,x=(0,p.A)();return(0,w.jsx)(i.A,{...r,children:(0,w.jsxs)(s.A,{children:[(0,a.isValidElement)(f)?f:(0,w.jsxs)(l.A,{children:[n||(0,w.jsx)(y.A,{html:g||""}),k?(0,w.jsx)(c.A,{className:t.closeButton,onClick:e=>{k(e,"backdropClick")},children:(0,w.jsx)(o.A,{})}):null]}),(0,w.jsx)(d.A,{}),(0,w.jsx)(m.t,{FallbackComponent:S,children:(0,w.jsx)(h.A,{theme:(0,u.A)(x,{components:{MuiInputBase:{styleOverrides:{input:{boxSizing:"content-box!important"}}}}}),children:b})})]})})})},86470(e,t,n){n.d(t,{Iw:()=>u,c$:()=>l,il:()=>c,rT:()=>h,rr:()=>d,vi:()=>p});var r=n(99226),a=n(38567),o=n(96852),i=n(10596),s=n(60586);function l(e,t,n){const r=e.get("tags");return r[t]??r[n]}const c={fr:{F1R2:"LR",F2R1:"LR",F1F2:"LL",F2F1:"LL",R1R2:"RR",R2R1:"RR",R1F2:"RL",R2F1:"RL"},rf:{R1F2:"LR",R2F1:"LR",R1R2:"LL",R2R1:"LL",F1F2:"RR",F2F1:"RR",F1R2:"RL",F2R1:"RL"},ff:{F2F1:"LR",R1R2:"LR",F2R1:"LL",R1F2:"LL",R2F1:"RR",F1R2:"RR",R2R1:"RL",F1F2:"RL"}},d={LR:"color_pair_lr",LL:"color_pair_ll",RR:"color_pair_rr",RL:"color_pair_rl"};async function u(e,t){const{start:n,end:r,originalRefName:a,refName:s}=e,l=await(0,o._)(t.getFeatures({...e,refName:a||s,end:r,start:n}).pipe((0,i.$)()));return l[0]?.get("seq")}function p(e,t,n){(0,r.addDisposer)(e,(0,a.autorun)(async function(){try{await t()}catch(t){(0,r.isAlive)(e)&&e.setError?.(t)}},n))}function h(e){return s.R[e]?.color||function(e){let t=0;for(let n=0;n<e.length;n++)t+=e.charCodeAt(n);return`hsl(${10*t}, 20%, 50%)`}(e)}},86520(e,t,n){n.d(t,{A:()=>p});var r=n(30936),a=n(42918),o=n(38282),i=n(1591),s=n(70235),l=n(33579),c=n(65045),d=n(32118);const u=(0,c.n)()(e=>({input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderWidth:2}})),p=(0,a.forwardRef)(function(e,t){const n=(0,r.c)(43);let c,p,h,g;n[0]!==e?(({value:h,setValue:p,variant:g,...c}=e),n[0]=e,n[1]=c,n[2]=p,n[3]=h,n[4]=g):(c=n[1],p=n[2],h=n[3],g=n[4]);const[m,f]=(0,o.A)(),{width:y}=f,[b,w]=(0,a.useState)(),[v,S]=(0,a.useState)(null);let k;n[5]!==e?(k={props:e},n[5]=e,n[6]=k):k=n[6];const{classes:x}=u(e,k),C=(0,l.A)(),T=void 0===b?h:b;let A,M,P,I,R,L,F,D,N,B,E;return n[7]===Symbol.for("react.memo_cache_sentinel")?(A={position:"relative"},n[7]=A):A=n[7],n[8]!==x.typography||n[9]!==m||n[10]!==T||n[11]!==g?(M=(0,d.jsx)("div",{style:A,children:(0,d.jsx)(i.A,{ref:m,component:"span",variant:g,className:x.typography,children:T})}),n[8]=x.typography,n[9]=m,n[10]=T,n[11]=g,n[12]=M):M=n[12],n[13]===Symbol.for("react.memo_cache_sentinel")?(P=e=>{S(e)},n[13]=P):P=n[13],n[14]!==C||n[15]!==g?(I=g&&"inherit"!==g?C.typography[g]:{},n[14]=C,n[15]=g,n[16]=I):I=n[16],n[17]!==I||n[18]!==y?(R={style:{width:y,...I}},n[17]=I,n[18]=y,n[19]=R):R=n[19],n[20]!==x.input||n[21]!==x.inputFocused||n[22]!==x.inputRoot?(L={input:x.input,root:x.inputRoot,focused:x.inputFocused},n[20]=x.input,n[21]=x.inputFocused,n[22]=x.inputRoot,n[23]=L):L=n[23],n[24]===Symbol.for("react.memo_cache_sentinel")?(F=e=>{w(e.target.value)},n[24]=F):F=n[24],n[25]!==v?(D=e=>{"Enter"===e.key?v?.blur():"Escape"===e.key&&(w(void 0),v?.blur())},n[25]=v,n[26]=D):D=n[26],n[27]!==b||n[28]!==p||n[29]!==h?(N=()=>{p(b||h||""),w(void 0)},n[27]=b,n[28]=p,n[29]=h,n[30]=N):N=n[30],n[31]!==x.inputBase||n[32]!==N||n[33]!==R||n[34]!==L||n[35]!==D||n[36]!==T?(B=(0,d.jsx)(s.Ay,{inputRef:P,className:x.inputBase,inputProps:R,classes:L,value:T,onChange:F,onKeyDown:D,onBlur:N}),n[31]=x.inputBase,n[32]=N,n[33]=R,n[34]=L,n[35]=D,n[36]=T,n[37]=B):B=n[37],n[38]!==c||n[39]!==t||n[40]!==B||n[41]!==M?(E=(0,d.jsxs)("div",{...c,ref:t,children:[M,B]}),n[38]=c,n[39]=t,n[40]=B,n[41]=M,n[42]=E):E=n[42],E})},86618(e,t,n){n.r(t),n.d(t,{ObservableCreate:()=>a});var r=n(84913);function a(e,t){return new r.c(t=>{try{const n=e(t);n?.catch&&n.catch(e=>{t.error(e)})}catch(e){t.error(e)}})}},87574(e,t,n){n.d(t,{A:()=>d});var r=n(30936),a=n(1591),o=n(51800),i=n(65045),s=n(6432),l=n(32118);const c=(0,i.n)()({dots:{"&::after":{display:"inline-block",content:'""',width:"1em",textAlign:"left",animation:`${s.i7`
      0% {
        content: '';
      }
      25% {
          content: '.';
      }
      50% {
        content: '..';
      }
      75% {
        content: '...';
      }
      `} 1.2s infinite ease-in-out`}}});function d(e){const t=(0,r.c)(6),{message:n,children:i,variant:s,...d}=e,u=void 0===s?"body2":s,{classes:p}=c(),h=a.A,g=(0,o.cx)(p.dots,d.className),m=n||"Loading";let f;return t[0]!==h||t[1]!==d||t[2]!==g||t[3]!==m||t[4]!==u?(f=(0,l.jsx)(h,{className:g,...d,variant:u,children:m}),t[0]=h,t[1]=d,t[2]=g,t[3]=m,t[4]=u,t[5]=f):f=t[5],f}},87663(e,t,n){n.d(t,{A:()=>a});var r=n(57141);class a{indexData=[];constructor({rectangles:e,totalHeight:t,maxHeightReached:n}){this.rectangles=new Map(Object.entries(e)),this.totalHeight=t,this.maxHeightReached=n,this.buildIndex()}buildIndex(){if(0!==this.rectangles.size){this.index=new r.A(this.rectangles.size),this.indexData=[];for(const[e,t]of this.rectangles)this.index.add(t[0],t[1],t[2],t[3]),this.indexData.push({name:e,rect:t});this.index.finish()}}addRect(e){const t=this.rectangles.get(e);if(!t)throw new Error(`id ${e} not found in precomputed feature layout`);return t[1]}getRectangles(){return this.rectangles}getTotalHeight(){return this.totalHeight}collides(e,t){throw new Error("Method not implemented.")}getByCoord(e,t){if(!this.index)return;const n=this.index.search(e,t,e+1,t+1);return n.length>0?this.indexData[n[0]]?.name:void 0}getByID(e){return this.rectangles.get(e)}addRectToBitmap(e,t){throw new Error("Method not implemented.")}discardRange(e,t){throw new Error("Method not implemented.")}serializeRegion(e){throw new Error("Method not implemented.")}toJSON(){return{rectangles:Object.fromEntries(this.rectangles),totalHeight:this.totalHeight,maxHeightReached:!1}}}},87877(e,t,n){n.d(t,{AK:()=>w,S7:()=>b});var r=n(99226),a=n(77251),o=n(19482),i=n(67401);const s={stringArray:r.types.array(r.types.string),stringArrayMap:r.types.map(r.types.array(r.types.string)),numberMap:r.types.map(r.types.number),boolean:r.types.boolean,color:r.types.refinement("Color",r.types.string,function(e){return!0}),integer:r.types.integer,number:r.types.number,string:r.types.string,text:r.types.string,fileLocation:i.FileLocation,frozen:r.types.frozen()},l={stringArray:[],stringArrayMap:{},numberMap:{},boolean:!0,color:"black",integer:1,number:1,string:"",text:"",fileLocation:{uri:"/path/to/resource.txt",locationType:"UriLocation"},frozen:{}},c=e=>({views:{get valueJSON(){return e.value}}}),d=e=>({views:{get valueJSON(){return JSON.stringify(e.value)}}}),u={fileLocation:d,number:c,integer:c,boolean:c,frozen:d,stringArray:e=>({views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add(t){e.value.push(t)},removeAtIndex(t){e.value.splice(t,1)},setAtIndex(t,n){e.value[t]=n}}}),stringArrayMap:e=>({views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add(t,n){e.value.set(t,n)},remove(t){e.value.delete(t)},addToKey(t,n){const r=e.value.get(t);if(!r)throw new Error(`${t} not found`);r.push(n)},removeAtKeyIndex(t,n){const r=e.value.get(t);if(!r)throw new Error(`${t} not found`);r.splice(n,1)},setAtKeyIndex(t,n,r){const a=e.value.get(t);if(!a)throw new Error(`${t} not found`);a[n]=r}}}),numberMap:e=>({views:{get valueJSON(){return JSON.stringify(e.value)}},actions:{add(t,n){e.value.set(t,n)},remove(t){e.value.delete(t)}}})},p=r.types.refinement("JexlString",r.types.string,e=>e.startsWith("jexl:"));function h(e,{description:t="",model:n,type:i,defaultValue:c,contextVariable:d=[]}){if(!i)throw new Error("type name required");if(n||(n=s[i]),!n)throw new Error(`no builtin config slot type "${i}", and no 'model' param provided`);if(void 0===c)throw new Error("no 'defaultValue' provided");const h=`${e.charAt(0).toUpperCase()}${e.slice(1)}ConfigSlot`;let g=r.types.model(h,{name:r.types.literal(e),description:r.types.literal(t),type:r.types.literal(i),value:r.types.optional(r.types.union(p,n),c)}).volatile(()=>({contextVariable:d})).views(e=>({get isCallback(){return String(e.value).startsWith("jexl:")}})).views(e=>({get expr(){return e.isCallback?(0,o.A)(String(e.value),(0,a.getEnv)(e).pluginManager.jexl):{eval:()=>e.value}},get valueJSON(){return e.isCallback?void 0:(t=e.value,t?.toJSON?t.toJSON():`"${t}"`);var t}})).views(e=>({getValue(t={}){const n=e.value;return"string"==typeof n&&n.startsWith("jexl:")?e.expr.eval(t):n}})).preProcessSnapshot(n=>"object"==typeof n&&n.name===e?n:{name:e,description:t,type:i,value:n}).postProcessSnapshot(e=>"object"==typeof e.value?JSON.stringify(e.value)!==JSON.stringify(c)?e.value:void 0:e.value!==c?e.value:void 0).actions(e=>({set(t){e.value=t},reset(){e.value=c},convertToCallback(){e.isCallback||(e.value=`jexl:${e.valueJSON||"''"}`)},convertToValue(){if(e.isCallback){try{const t=e.expr.eval();if(void 0!==t)return void(e.value=t)}catch(e){}if(e.value=c,!(i in l))throw new Error(`no fallbackDefault defined for type ${i}`);e.value=l[i]}}}));u[i]&&(g=g.extend(u[i]));const m=r.types.optional(g,{name:e,type:i,description:t,value:c});return Object.defineProperty(m,"isJBrowseConfigurationSlot",{value:!0}),m}var g=n(11259),m=n(27868);function f(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e&&0===Object.keys(e).length}function y(e){return Array.isArray(e)&&0===e.length}function b(e,t,n){const{schemaDefinition:a,options:o}=function(e,t,n={}){if("string"!=typeof e)throw new Error("first arg must be string name of the model that this config schema goes with");let r=t,a=n;return n.baseConfiguration?.jbrowseSchemaDefinition&&(r={...n.baseConfiguration.jbrowseSchemaDefinition,...r},a={...n.baseConfiguration.jbrowseSchemaOptions,...n,baseConfiguration:void 0}),{schemaDefinition:r,options:a}}(e,t,n),i=function(e,t,n){const a={};let o;if(n.explicitlyTyped&&(a.type=r.types.optional(r.types.literal(e),e)),n.explicitIdentifier&&n.implicitIdentifier)throw new Error(`Cannot have both explicit and implicit identifiers in ${e}`);n.explicitIdentifier?"string"==typeof n.explicitIdentifier?(a[n.explicitIdentifier]=r.types.identifier,o=n.explicitIdentifier):(a.id=r.types.identifier,o="id"):n.implicitIdentifier&&("string"==typeof n.implicitIdentifier?(a[n.implicitIdentifier]=m.K,o=n.implicitIdentifier):(a.id=m.K,o="id"));const i={isJBrowseConfigurationSchema:!0,jbrowseSchema:{modelName:e,definition:t,options:n}};for(const[n,o]of Object.entries(t))if((0,r.isType)(o)&&(0,r.isLateType)(o)||(0,g.oG)(o))a[n]=o;else if("string"==typeof o||"number"==typeof o)i[n]=o;else{if("object"!=typeof o)throw new Error(`invalid configuration schema definition, "${n}" must be either a valid configuration slot definition, a constant, or a nested configuration schema`);if(!o.type)throw new Error(`no type set for config slot ${e}.${n}`);try{a[n]=h(n,o)}catch(t){throw new Error(`invalid config slot definition for ${e}.${n}: ${t}`)}}let s=r.types.model(`${e}ConfigurationSchema`,a).actions(e=>({setSubschema(t,n){if(!(0,g.oG)(a[t]))throw new Error(`${t} is not a subschema, cannot replace`);const o=(0,r.isStateTreeNode)(n)?n:a[t].create(n);return e[t]=o,o}}));Object.keys(i).length&&(s=s.volatile(()=>i)),n.actions&&(s=s.actions(n.actions)),n.views&&(s=s.views(n.views)),n.extend&&(s=s.extend(n.extend));const l=o?{[o]:"placeholderId"}:{},c=n.explicitlyTyped?{type:e,...l}:l,d=(0,r.getSnapshot)(s.create(c));return s=s.postProcessSnapshot(e=>{const t={};let n=!0;for(const[r,a]of Object.entries(e))n&&("object"==typeof d[r]&&"object"==typeof a?JSON.stringify(d[r])!==JSON.stringify(a)&&(n=!1):d[r]!==a&&(n=!1)),void 0===a||void 0!==i[r]||f(a)||y(a)||(t[r]=a);return n?{}:t}),n.preProcessSnapshot&&(s=s.preProcessSnapshot(n.preProcessSnapshot)),r.types.optional(s,c)}(e,a,o);return i.isJBrowseConfigurationSchema=!0,i.jbrowseSchemaDefinition=a,i.jbrowseSchemaOptions=o,i}function w(e){const t=e.name;return t.includes("TrackConfigurationSchema")&&!t.includes("DisplayConfigurationSchema")?function(e){const t=r.types.reference(e,{get(t,n){let o=(0,a.getSession)(n).getTracksById()[t];if(o||(o=(0,r.resolveIdentifier)(e,(0,r.getRoot)(n),t)),!o)throw new Error(`Could not resolve identifier "${t}"`);return(0,r.isStateTreeNode)(o)?o:e.create(o,(0,r.getEnv)(n))},set:e=>e.trackId});return r.types.snapshotProcessor(r.types.union({dispatcher:n=>"string"==typeof n?t:e},t,e),{postProcessor:e=>"object"==typeof e&&null!==e&&"trackId"in e?e.trackId:e})}(e):t.includes("DisplayConfigurationSchema")?function(e){const t=r.types.reference(e,{get(t,n){let o=((0,a.getContainingTrack)(n).configuration.displays||[]).find(e=>e.displayId===t);if(!o){const e=`${t}`.split("-").slice(1).join("-");e&&(o={displayId:`${t}`,type:e})}if(!o)throw new Error(`Display configuration "${t}" not found`);return(0,r.isStateTreeNode)(o)?o:e.create(o,(0,r.getEnv)(n))},set:e=>e.displayId});return r.types.union({dispatcher:n=>"string"==typeof n?t:e},t,e)}(e):r.types.union(r.types.reference(e),e)}},89322(e,t,n){n.d(t,{A:()=>i});var r=n(99226),a=n(13861),o=n(87877);const i=function(e){return r.types.model("Connection",{name:r.types.identifier,tracks:r.types.array(e.pluggableConfigSchemaType("track")),configuration:(0,o.AK)(a.A)}).actions(()=>({connect(e){}})).actions(e=>({afterAttach(){0===e.tracks.length&&e.connect(e.configuration)},addTrackConf(t){const n=e.tracks.push(t);return e.tracks[n-1]},addTrackConfs(t){for(const n of t)e.tracks.push(n)},setTrackConfs(t){e.tracks=(0,r.cast)(t)},clear(){}}))}},89867(e,t,n){n.d(t,{A:()=>i});var r=n(99226),a=n(53705),o=n(77251);function i(e,t=!0,n=!0,i=0,s=800){const{offsetPx:l,displayedRegions:c,bpPerPx:d,minimumBlockWidth:u,interRegionPaddingWidth:p,width:h}=e,g=l*d,m=(l+h)*d,f=s,y=Math.ceil(f*d),b=1/d,w=1/y;let v=0;const S=new a.mh;for(let e=0;e<c.length;e++){const l=c[e],{assemblyName:h,refName:f,start:k,end:x,reversed:C}=l,T=Math.ceil((x-k)*w),A=(0,r.isStateTreeNode)(l)?(0,r.getSnapshot)(l):l;let M=Math.floor((m-v)*w)+i;M>=T&&(M=T-1);let P=Math.floor((g-v)*w)-i;P<0&&(P=0);const I=(x-k)*b;for(let r=P;r<=M;r+=1){let i,l,g,m;C?(i=Math.max(k,x-(r+1)*y),l=x-r*y,g=l===x,m=i===k):(i=k+r*y,l=Math.min(x,k+(r+1)*y),g=i===k,m=l===x);const w={assemblyName:h,refName:f,start:i,end:l,reversed:C,offsetPx:(v+r*y)*b,parentRegion:A,regionNumber:e,widthPx:(l-i)*b,isLeftEndOfDisplayedRegion:g,isRightEndOfDisplayedRegion:m,key:`${(0,o.assembleLocStringFast)({assemblyName:h,refName:f,start:i,end:l,reversed:C})}-${e}${C?"-reversed":""}`};t&&0===e&&0===r&&S.push(new a.fK({key:`${w.key}-beforeFirstRegion`,widthPx:s,offsetPx:w.offsetPx-s,variant:"boundary"})),n&&I<u?S.push(new a.Db(w)):S.push(new a.$G(w)),t&&(I>=u&&w.isRightEndOfDisplayedRegion&&e<c.length-1&&(v+=p*d,S.push(new a.fK({key:`${w.key}-rightpad`,widthPx:p,offsetPx:w.offsetPx+w.widthPx}))),e===c.length-1&&w.isRightEndOfDisplayedRegion&&(v+=p*d,S.push(new a.fK({key:`${w.key}-afterLastRegion`,widthPx:s,offsetPx:w.offsetPx+w.widthPx,variant:"boundary"}))))}v+=x-k}return S}},90975(e,t,n){n.d(t,{t:()=>o});var r=n(42918),a=n(32118);class o extends r.Component{constructor(e){super(e),this.state={error:void 0}}componentDidCatch(e,t){console.error("ErrorBoundary caught an error:",e,t),this.setState({error:e})}render(){return this.state.error?(0,a.jsx)(this.props.FallbackComponent,{error:this.state.error}):this.props.children}}},91674(e,t,n){function r(e,t){return e.map(e=>t.slice(e.start,e.end)).join("")}function a(e){return`${e.start}-${e.end}`}function o(e){return e.filter((e,t,n)=>!t||a(e)!==a(n[t-1]))}function i(e,t){return e.map(e=>({...e,start:t-e.end,end:t-e.start})).sort((e,t)=>e.start-t.start)}function s(e,t){if(!e.length)return[];if(t.length<e.length)return console.warn("exons.length less than cds.length, cant calculate UTR properly",{exons:t,cds:e}),[];const n=e.at(0),r=e.at(-1),a=t.findIndex(e=>e.end>=n.start&&e.start<=n.start),o=t.findIndex(e=>e.end>=r.end&&e.start<=r.end),i=t[o],s=t[a];return[...[...t.slice(0,a),{start:s.start,end:n.start}].map(e=>({...e,type:"five_prime_UTR"})),...[{start:r.end,end:i.end},...t.slice(o+1)].map(e=>({...e,type:"three_prime_UTR"}))]}function l(e,t){if(!e.length)return[];const n=e.at(0),r=e.at(-1);return[...[{start:t.start,end:n.start}].map(e=>({...e,type:"five_prime_UTR"})),...[{start:r.end,end:t.end}].map(e=>({...e,type:"three_prime_UTR"}))]}function c(e){return e.length>20?`${e.slice(0,20)}...`:e}function d(e){return JSON.parse(JSON.stringify(e,(e,t)=>void 0===t?null:t))}function u(e,t,n,r=0,a={}){t<=r||e.subfeatures?.map(e=>{u(e,t,n,r+1,a),n(e)})}n.d(t,{Il:()=>d,SC:()=>o,SX:()=>c,V4:()=>l,YC:()=>i,fq:()=>u,h8:()=>s,o9:()=>r})},92035(e,t,n){n.d(t,{A:()=>r});class r{constructor(e){this.name=e?.name||"UNKNOWN",this.maybeDisplayName=e?.displayName}get displayName(){return this.maybeDisplayName||this.name}}},92905(e,t,n){n.d(t,{Ay:()=>s});var r=n(42918),a=n(14665);const o=(0,n(87877).S7)("HierarchicalTrackSelectorWidget",{});var i=n(80449);function s(e){e.addWidgetType(()=>new a.A({name:"HierarchicalTrackSelectorWidget",heading:"Available tracks",configSchema:o,stateModel:(0,i.A)(e),ReactComponent:(0,r.lazy)(()=>Promise.all([n.e(2241),n.e(9991)]).then(n.bind(n,32372)))}))}},93111(e,t,n){n.d(t,{A:()=>l});var r=n(30936),a=n(42918),o=n(53205),i=n(32118);function s(e){return!!e}const l=function(e){const t=(0,r.c)(18),{width:n,height:l,highResolutionScaling:c,style:d,imageData:u,blockKey:p,showSoftClip:h}=e,g=void 0===c?1:c;let m;t[0]!==d?(m=void 0===d?{}:d,t[0]=d,t[1]=m):m=t[1];const f=m,[y,b]=(0,a.useState)(!1),w=(0,a.useRef)(null);let v,S;t[2]!==u?(v=()=>{if(!u)return;const e=w.current;if(!e)return;const t=e.getContext("2d");t&&(t.clearRect(0,0,e.width,e.height),(0,o.pv)(u,t),b(!0))},S=[u],t[2]=u,t[3]=v,t[4]=S):(v=t[3],S=t[4]),(0,a.useEffect)(v,S);const k=h?"softclipped":"",x=y?"done":"";let C;t[5]!==p||t[6]!==k||t[7]!==x?(C=["prerendered_canvas",k,p,x].filter(s),t[5]=p,t[6]=k,t[7]=x,t[8]=C):C=t[8];const T=C.join("_"),A=n*g,M=l*g;let P,I;return t[9]!==l||t[10]!==f||t[11]!==n?(P={width:n,height:l,...f},t[9]=l,t[10]=f,t[11]=n,t[12]=P):P=t[12],t[13]!==M||t[14]!==P||t[15]!==T||t[16]!==A?(I=(0,i.jsx)("canvas",{"data-testid":T,ref:w,width:A,height:M,style:P}),t[13]=M,t[14]=P,t[15]=T,t[16]=A,t[17]=I):I=t[17],I}},93646(e,t,n){n.d(t,{LinearBasicDisplayComponent:()=>ft.default,Ay:()=>yt});var r=n(54351),a=n(87877),o=n(10525),i=n(99226),s=n(13410),l=n(18769),c=n(58730),d=n(98612),u=n(3026),p=n(75976),h=n(7062);var g=n(61451);function m(e){return(0,a.S7)("LinearBareDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:d.A,explicitlyTyped:!0})}var f=n(29512),y=n(42918),b=n(2156),w=n(11259),v=n(43788);function S(e,t){return e.find(e=>"label"in e&&e.label===t)}const k=function(e){return i.types.compose("LinearBasicDisplay",(0,v.A)(e),i.types.model({type:i.types.literal("LinearBasicDisplay"),trackGeneGlyphMode:i.types.maybe(i.types.string),trackSubfeatureLabels:i.types.maybe(i.types.string),trackDisplayDirectionalChevrons:i.types.maybe(i.types.boolean),configuration:(0,a.AK)(e)})).views(e=>({get geneGlyphMode(){return e.trackGeneGlyphMode??(0,w.FI)(e,["renderer","geneGlyphMode"])},get subfeatureLabels(){return e.trackSubfeatureLabels??(0,w.FI)(e,["renderer","subfeatureLabels"])},get displayDirectionalChevrons(){return e.trackDisplayDirectionalChevrons??(0,w.FI)(e,["renderer","displayDirectionalChevrons"])}})).views(e=>({get rendererConfig(){const t=(0,w.FI)(e,["renderer"])||{};return{...t,showLabels:e.trackShowLabels??t.showLabels,showDescriptions:e.trackShowDescriptions??t.showDescriptions,subfeatureLabels:e.trackSubfeatureLabels??t.subfeatureLabels,displayMode:e.trackDisplayMode??t.displayMode,maxHeight:e.trackMaxHeight??t.maxHeight,geneGlyphMode:e.trackGeneGlyphMode??t.geneGlyphMode,displayDirectionalChevrons:e.trackDisplayDirectionalChevrons??t.displayDirectionalChevrons}}})).actions(e=>({setGeneGlyphMode(t){e.trackGeneGlyphMode=t},setSubfeatureLabels(t){e.trackSubfeatureLabels=t},toggleDisplayDirectionalChevrons(){e.trackDisplayDirectionalChevrons=!e.displayDirectionalChevrons}})).views(e=>{const{trackMenuItems:t}=e;return{trackMenuItems(){const n=t(),r=S(n,"Show...");r&&(r.subMenu=[...r.subMenu,{label:"Show chevrons",type:"checkbox",checked:e.displayDirectionalChevrons,onClick:()=>{e.toggleDisplayDirectionalChevrons()}},{label:"Subfeature labels",subMenu:["none","below","overlay"].map(t=>({label:t,type:"radio",checked:e.subfeatureLabels===t,onClick:()=>{e.setSubfeatureLabels(t)}}))},{label:"Gene glyph",subMenu:[{value:"all",label:"All transcripts"},{value:"longest",label:"Longest transcript"},{value:"longestCoding",label:"Longest coding transcript"}].map(({value:t,label:n})=>({label:n,type:"radio",checked:e.geneGlyphMode===t,onClick:()=>{e.setGeneGlyphMode(t)}}))}]);const a=S(n,"Filters");return a&&(a.subMenu=[{label:"Show only genes",type:"checkbox",checked:e.activeFilters.includes("jexl:get(feature,'type')=='gene'"),onClick:()=>{const t="jexl:get(feature,'type')=='gene'",n=e.activeFilters;n.includes(t)?e.setJexlFilters(n.filter(e=>e!==t)):e.setJexlFilters([...n,t])}},...a.subMenu]),n}}}).postProcessSnapshot(e=>{if(!e)return e;const{trackGeneGlyphMode:t,trackSubfeatureLabels:n,trackDisplayDirectionalChevrons:r,...a}=e;return{...a,...void 0!==t?{trackGeneGlyphMode:t}:{},...void 0!==n?{trackSubfeatureLabels:n}:{},...void 0!==r?{trackDisplayDirectionalChevrons:r}:{}}})};var x=n(30936),C=n(35913),T=n(77251),A=n(65045),M=n(21267),P=n(9913),I=n(72868),R=n(27607),L=n(74919),F=n(60550),D=n(64074),N=n(32118);const B=(0,y.lazy)(()=>n.e(5589).then(n.bind(n,5589))),E=(0,A.n)()(e=>({container:{display:"flex",flexDirection:"row",alignItems:"center"},slider:{width:100,color:e.palette.text.secondary}}));function V(e){const t=(0,x.c)(4),{children:n,open:r,value:a}=e;let o;return t[0]!==n||t[1]!==r||t[2]!==a?(o=(0,N.jsx)(R.A,{open:r,enterTouchDelay:0,placement:"top",title:a,arrow:!0,children:n}),t[0]=n,t[1]=r,t[2]=a,t[3]=o):o=t[3],o}const z=(0,D.observer)(function({model:e}){const{classes:t}=E(),{width:n,maxBpPerPx:r,minBpPerPx:a,bpPerPx:o,effectiveBpPerPx:i}=e,[s,l]=(0,y.useState)(100*-Math.log2(o));(0,y.useEffect)(()=>{l(100*-Math.log2(i))},[i]);const c=i<=a+1e-4,d=i>=r-1e-4;return(0,N.jsxs)("div",{className:t.container,children:[(0,N.jsx)(R.A,{title:"Zoom out 2x",children:(0,N.jsx)("span",{children:(0,N.jsx)(L.A,{"data-testid":"zoom_out",disabled:d,onClick:()=>{e.zoom(2*o)},children:(0,N.jsx)(I.A,{})})})}),(0,N.jsx)(F.Ay,{size:"small",className:t.slider,value:s,min:100*-Math.log2(r),max:100*-Math.log2(a),onChangeCommitted:()=>e.zoomTo(2**(-s/100)),valueLabelDisplay:"auto",valueLabelFormat:e=>`Window size: ${(0,T.getBpDisplayStr)(2**(-e/100)*n)}`,slots:{valueLabel:V},onChange:(e,t)=>{l(t)}}),(0,N.jsx)(R.A,{title:"Zoom in 2x",children:(0,N.jsx)("span",{children:(0,N.jsx)(L.A,{"data-testid":"zoom_in",disabled:c,onClick:()=>{e.zoom(e.bpPerPx/2)},children:(0,N.jsx)(P.A,{})})})}),(0,N.jsx)(C.A,{menuItems:[...[100,50,10].map(t=>({label:`Zoom in ${t}x`,onClick:()=>{e.zoom(e.bpPerPx/t)}})),...[10,50,100].map(t=>({label:`Zoom out ${t}x`,onClick:()=>{e.zoom(e.bpPerPx*t)}})),{label:"Custom zoom",onClick:()=>{(0,T.getSession)(e).queueDialog(t=>[B,{model:e,handleClose:t}])}}],children:(0,N.jsx)(M.A,{})})]})}),j=z;var H=n(47864),_=n(12485),O=n(23460),$=n(20637),G=n(1821),W=n(83090),U=n(68589),q=n(80764),J=n(89867),X=n(70203),K=n(27868),Q=n(58765),Y=n(38567),Z=n(84182),ee=n(53504);var te=n(58919),ne=n(47043),re=n(17775),ae=n(15943),oe=n(65525),ie=n(56097);const se=(0,A.n)()(e=>({panButton:{background:(0,ae.X4)(e.palette.background.paper,.8),color:e.palette.text.primary,margin:ie.Es}}));function le(e){const t=(0,x.c)(15),{model:n}=e,{classes:r}=se();let a,o,i,s,l,c,d;return t[0]!==n?(a=()=>{n.slide(-.9)},t[0]=n,t[1]=a):a=t[1],t[2]===Symbol.for("react.memo_cache_sentinel")?(o=(0,N.jsx)(ne.A,{}),t[2]=o):o=t[2],t[3]!==r.panButton||t[4]!==a?(i=(0,N.jsx)(oe.A,{variant:"outlined",className:r.panButton,onClick:a,children:o}),t[3]=r.panButton,t[4]=a,t[5]=i):i=t[5],t[6]!==n?(s=()=>{n.slide(.9)},t[6]=n,t[7]=s):s=t[7],t[8]===Symbol.for("react.memo_cache_sentinel")?(l=(0,N.jsx)(re.A,{}),t[8]=l):l=t[8],t[9]!==r.panButton||t[10]!==s?(c=(0,N.jsx)(oe.A,{variant:"outlined",className:r.panButton,onClick:s,children:l}),t[9]=r.panButton,t[10]=s,t[11]=c):c=t[11],t[12]!==i||t[13]!==c?(d=(0,N.jsxs)(N.Fragment,{children:[i,c]}),t[12]=i,t[13]=c,t[14]=d):d=t[14],d}var ce=n(1591);const de=(0,A.n)()({bp:{display:"flex",alignItems:"center",marginLeft:5,cursor:"pointer"}}),ue=(0,D.observer)(function({model:e}){const{classes:t}=de(),{effectiveTotalBpDisplayStr:n}=e;return(0,N.jsx)(ce.A,{variant:"body2",color:"textSecondary",className:t.bp,children:n})}),pe=ue;var he=n(58693);const ge=(0,A.n)()(e=>({toggleButton:{height:44,border:"none",marginLeft:e.spacing(4)}})),me=(0,D.observer)(function({model:e}){const{classes:t}=ge();return(0,N.jsx)(L.A,{onClick:e.activateTrackSelector,className:t.toggleButton,title:"Open track selector",value:"track_select",children:(0,N.jsx)(he.xU,{})})}),fe=me;var ye=n(51800),be=n(33579),we=n(64995),ve=n(19598);const Se=(0,A.n)()(e=>({highlight:{height:"100%",position:"absolute",left:0,background:(0,ve.M)(e.palette.highlight.main).alpha(.35).toRgbString(),borderLeft:`1px solid ${e.palette.highlight.main}`,borderRight:`1px solid ${e.palette.highlight.main}`}})),ke=(0,D.observer)(function({model:e,overview:t}){const{classes:n}=Se(),{highlight:r,cytobandOffset:a}=e,o=(0,T.getSession)(e),{assemblyManager:i}=o;return r.map(e=>{const n=i.get(e.assemblyName),r=n?.getCanonicalRefName(e.refName)??e.refName,o=t.bpToPx({...e,refName:r,coord:e.start}),s=t.bpToPx({...e,refName:r,coord:e.end});return void 0!==o&&void 0!==s?{width:Math.abs(s-o),left:o+a}:void 0}).filter(T.notEmpty).map(({left:e,width:t},r)=>(0,N.jsx)("div",{className:n.highlight,style:{width:t,transform:`translateX(${e}px)`}},`${e}_${t}_${r}`))}),xe=ke,Ce=(0,A.n)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",left:0}}),Te=(0,D.observer)(function({model:e,open:t,guideX:n,overview:r}){const{classes:a}=Ce(),{cytobandOffset:o}=e,{assemblyManager:i}=(0,T.getSession)(e),s=r.pxToBp(n-o),l=i.get(s.assemblyName),c=l?.cytobands?.find(e=>s.coord>e.get("start")&&s.coord<e.get("end")&&s.refName===l.getCanonicalRefName(e.get("refName")));return(0,N.jsx)(R.A,{open:t,placement:"top",title:[(0,T.stringify)(s),c?.get("name"),c?.get("type")].join(" "),arrow:!0,children:(0,N.jsx)("div",{className:a.guide,style:{transform:`translateX(${n}px)`}})})}),Ae=Te;var Me=n(28788),Pe=n(97892);const Ie=(0,A.n)()({rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rel:{position:"relative"}}),Re=(0,D.observer)(function({model:e,overview:t,ControlComponent:n=(0,N.jsx)("div",{})}){const{cytobandOffset:r}=e,[a,o]=(0,y.useState)(),[i,s]=(0,y.useState)(),[l,c]=(0,y.useState)(),d=(0,y.useRef)(null),{classes:u}=Ie(),p=void 0!==a;function h(e){e.preventDefault(),e.stopPropagation(),o((0,Pe.Pn)(e,d.current))}function g(e){c((0,Pe.Pn)(e,d.current))}function m(){c(void 0)}if((0,y.useEffect)(()=>{function n(e){const t=d.current;t&&p&&s((0,Pe.Pn)(e,t))}function l(){if(void 0!==a&&void 0!==i&&Math.abs(i-a)>3){const n=Math.min(a,i),o=Math.max(a,i);e.moveTo(t.pxToBp(n-r),t.pxToBp(o-r))}if(void 0!==a&&void 0===i){const n=t.pxToBp(a-r);n.refName?e.centerAt(Math.round(n.coord),n.refName,n.index):((0,T.getSession)(e).notify("unknown position clicked"),console.error("unknown position clicked",n))}o(void 0),s(void 0),void 0!==a&&c(void 0)}function u(e){"Escape"===e.key&&(o(void 0),s(void 0))}return p?(window.addEventListener("mousemove",n,!0),window.addEventListener("mouseup",l,!0),window.addEventListener("keydown",u,!0),()=>{window.removeEventListener("mousemove",n,!0),window.removeEventListener("mouseup",l,!0),window.removeEventListener("keydown",u,!0)}):()=>{}},[p,i,a,e,t,r]),void 0===a)return(0,N.jsxs)("div",{className:u.rel,children:[void 0!==l?(0,N.jsx)(Ae,{model:e,open:!p,overview:t,guideX:l}):null,(0,N.jsx)("div",{className:u.rubberbandControl,ref:d,onMouseDown:h,onMouseOut:m,onMouseMove:g,children:n})]});let f,b,w=a||0,v=0;return void 0!==i&&(w=Math.min(i,a),v=i-a),a&&(f=t.pxToBp(a-r),b=t.pxToBp(a+v-r),void 0!==i&&i<a&&([f,b]=[b,f])),(0,N.jsxs)("div",{className:u.rel,children:[f&&b?(0,N.jsx)(Me.default,{leftBpOffset:f,rightBpOffset:b,width:Math.abs(v),left:w}):null,(0,N.jsx)("div",{"data-testid":"rubberband_controls",className:u.rubberbandControl,ref:d,onMouseDown:h,onMouseOut:m,onMouseMove:g,children:n})]})}),Le=Re;var Fe=n(25196),De=n(38157);const Ne=(0,A.n)()({scalebarLabel:{height:ie.Gu,position:"absolute",left:0,display:"flex",justifyContent:"center",pointerEvents:"none"}}),Be=(0,D.observer)(function({block:e,scale:t,overview:n,model:r}){const{classes:a}=Ne(),{start:o,end:i,reversed:s,refName:l,assemblyName:c}=e,{majorPitch:d}=(0,De.i3)(t,120,15),{assemblyManager:u}=(0,T.getSession)(r),p=u.get(c),h=p?.getRefNameColor(l),g=[];for(let e=0;e<Math.floor((i-o)/d);e++){const t=(e+1)*d;g.push(s?i-t:o+t)}return g.map((r,o)=>(0,N.jsx)(ce.A,{className:a.scalebarLabel,variant:"body2",style:{transform:`translateX(${(o+1)*d/t}px)`,color:h},children:(0,T.getTickDisplayStr)(r,n.bpPerPx)},`${JSON.stringify(e)}-${r}-${o}`))}),Ee=Be,Ve=(0,A.n)()(e=>({scalebar:{height:ie.Gu,contain:"layout style"},scalebarBorder:{border:"1px solid"},scalebarContig:{backgroundColor:e.palette.background.default,position:"absolute",top:0,left:0,height:ie.Gu,overflow:"hidden"},scalebarContigForward:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M-.1 0L6 4.5L-.1 9' fill='none' stroke='${e.palette.divider}'/%3E%3C/svg%3E")`,backgroundRepeat:"repeat"},scalebarContigReverse:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M6 0L0 4.5L6 9' fill='none' stroke='${e.palette.divider}'/%3E%3C/svg%3E")`,backgroundRepeat:"repeat"},scalebarRefName:{position:"absolute",left:0,fontWeight:"bold",pointerEvents:"none",zIndex:100},scalebarVisibleRegion:{position:"absolute",height:ie.Gu,pointerEvents:"none",zIndex:100,border:"1px solid",left:0},overview:{height:ie.Ij,position:"relative"},overviewSvg:{pointerEvents:"none",width:"100%",position:"absolute"}})),ze=(0,D.observer)(function({scale:e,model:t,block:n,overview:r}){const{classes:a}=Ve(),o=(0,be.A)(),{cytobandOffset:i,showCytobands:s}=t,{reversed:l,refName:c,assemblyName:d}=n,{assemblyManager:u}=(0,T.getSession)(t),p=u.get(d),h=p?.getRefNameColor(c),g=s&&(0,Pe.S5)(p,n.refName).length;return(0,N.jsxs)("div",{children:[(0,N.jsx)(ce.A,{style:{transform:`translateX(${n.offsetPx+3}px)`,color:g?o.palette.text.primary:h},className:a.scalebarRefName,children:c}),(0,N.jsx)("div",{className:(0,ye.cx)(a.scalebarContig,g?void 0:l?a.scalebarContigReverse:a.scalebarContigForward,g?void 0:a.scalebarBorder),style:{transform:`translateX(${n.offsetPx+i}px)`,width:n.widthPx,borderColor:h},children:g?(0,N.jsx)("svg",{style:{width:"100%"},children:(0,N.jsx)(we.A,{overview:r,assembly:p,block:n})}):(0,N.jsx)(Ee,{model:t,overview:r,scale:e,block:n})})]})}),je=(0,D.observer)(function({model:e,overview:t,className:n}){const r=(0,be.A)().palette.tertiary.light,{dynamicBlocks:a,showCytobands:o,cytobandOffset:i}=e,s=a.contentBlocks;if(!s.length)return null;const l=s.at(0),c=s.at(-1),d=t.bpToPx({refName:l.refName,coord:l.reversed?l.end:l.start})||0,u=t.bpToPx({refName:c.refName,coord:c.reversed?c.start:c.end})||0,p=o?"#f00":r,h=o?.1:.3,g=d+i;return(0,N.jsx)("div",{className:n,style:{width:u-d,transform:`translateX(${g}px)`,background:(0,ae.X4)(p,h),borderColor:p}})}),He=(0,D.observer)(function({model:e,scale:t,overview:n}){const{classes:r}=Ve(),{pluginManager:a}=(0,T.getEnv)(e),o=n.dynamicBlocks,i=a.evaluateExtensionPoint("LinearGenomeView-OverviewScalebarComponent",void 0,{model:e,overview:n});return(0,N.jsxs)("div",{className:r.scalebar,children:[(0,N.jsx)(je,{model:e,overview:n,className:r.scalebarVisibleRegion}),o.map((a,o)=>"ContentBlock"!==a.type?(0,N.jsx)("div",{className:r.scalebarContig,style:{width:a.widthPx,transform:`translateX(${a.offsetPx}px)`,backgroundColor:"#999",backgroundImage:"repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)"}},`${JSON.stringify(a)}-${o}`):(0,N.jsx)(ze,{scale:t,block:a,model:e,overview:n},`${JSON.stringify(a)}-${o}`)),(0,N.jsx)(xe,{model:e,overview:n}),i]})}),_e=(0,D.observer)(function({model:e,children:t}){const{classes:n}=Ve(),{minimumBlockWidth:r,totalBp:a,width:o,cytobandOffset:i,displayedRegions:s}=e,l=o-i,c=JSON.stringify(s),d=(0,y.useMemo)(()=>{const e=U.A.create({displayedRegions:JSON.parse(c),interRegionPaddingWidth:0,minimumBlockWidth:r});return e.setVolatileWidth(l),e.showAllRegions(),e},[c,r,l]),u=a/(l-2*(s.length-1));return(0,N.jsxs)("div",{children:[(0,N.jsx)(Le,{model:e,overview:d,ControlComponent:(0,N.jsx)(He,{model:e,overview:d,scale:u})}),(0,N.jsxs)("div",{className:n.overview,children:[(0,N.jsx)("svg",{height:ie.Ij,className:n.overviewSvg,children:(0,N.jsx)(Fe.A,{model:e,overview:d})}),t]})]})}),Oe=_e,$e=(0,A.n)()({headerBar:{display:"flex",height:ie.Ij},headerForm:{flexWrap:"nowrap",marginRight:7},spacer:{flexGrow:1}}),Ge=function(e){const t=(0,x.c)(24),{model:n}=e,{classes:r}=$e();let a,o,i,s,l,c,d,u,p;return t[0]!==n?(a=(0,N.jsx)(fe,{model:n}),t[0]=n,t[1]=a):a=t[1],t[2]!==r.spacer?(o=(0,N.jsx)("div",{className:r.spacer}),t[2]=r.spacer,t[3]=o):o=t[3],t[4]!==n?(i=(0,N.jsx)(le,{model:n}),s=(0,N.jsx)(H.A,{model:n}),t[4]=n,t[5]=i,t[6]=s):(i=t[5],s=t[6]),t[7]!==r.headerForm||t[8]!==i||t[9]!==s?(l=(0,N.jsxs)(te.A,{row:!0,className:r.headerForm,children:[i,s]}),t[7]=r.headerForm,t[8]=i,t[9]=s,t[10]=l):l=t[10],t[11]!==n?(c=(0,N.jsx)(pe,{model:n}),d=(0,N.jsx)(j,{model:n}),t[11]=n,t[12]=c,t[13]=d):(c=t[12],d=t[13]),t[14]!==r.spacer?(u=(0,N.jsx)("div",{className:r.spacer}),t[14]=r.spacer,t[15]=u):u=t[15],t[16]!==r.headerBar||t[17]!==a||t[18]!==o||t[19]!==l||t[20]!==c||t[21]!==d||t[22]!==u?(p=(0,N.jsxs)("div",{className:r.headerBar,children:[a,o,l,c,d,u]}),t[16]=r.headerBar,t[17]=a,t[18]=o,t[19]=l,t[20]=c,t[21]=d,t[22]=u,t[23]=p):p=t[23],p},We=(0,D.observer)(function({model:e}){const{hideHeader:t,hideHeaderOverview:n}=e;return t?null:n?(0,N.jsx)(Ge,{model:e}):(0,N.jsx)(Oe,{model:e,children:(0,N.jsx)(Ge,{model:e})})}),Ue=We;var qe=n(65595),Je=n(58955);const Xe=(0,A.n)()(e=>({background:{position:"absolute",right:0,background:e.palette.background.paper,zIndex:2},focusedBackground:{background:(0,ae.X4)(e.palette.secondary.light,.2)}})),Ke=(0,D.observer)(function({model:e}){const{classes:t}=Xe(),{id:n,bpPerPx:r,maxBpPerPx:a,minBpPerPx:o,hideHeader:i,effectiveBpPerPx:s}=e,{focusedViewId:l}=(0,T.getSession)(e);return i?(0,N.jsx)(Je.A,{className:t.background,children:(0,N.jsxs)(Je.A,{className:l===n?t.focusedBackground:void 0,children:[(0,N.jsx)(C.A,{menuItems:()=>e.menuItems(),children:(0,N.jsx)(qe.A,{fontSize:"small"})}),(0,N.jsx)(L.A,{"data-testid":"zoom_out",onClick:()=>{e.zoom(2*r)},disabled:s>=a-1e-4,children:(0,N.jsx)(I.A,{fontSize:"small"})}),(0,N.jsx)(L.A,{"data-testid":"zoom_in",onClick:()=>{e.zoom(r/2)},disabled:s<=o+1e-4,children:(0,N.jsx)(P.A,{fontSize:"small"})})]})}):null}),Qe=Ke;var Ye=n(13253),Ze=n(2193),et=n(25729),tt=n(97280),nt=n(27214),rt=n(29242),at=n(12094),ot=n(66489),it=n(19395),st=n(89913);const lt=(0,y.lazy)(()=>n.e(5015).then(n.bind(n,15015))),ct=(0,y.lazy)(()=>n.e(2267).then(n.bind(n,84648))),dt=(0,y.lazy)(()=>n.e(7250).then(n.bind(n,57250))),ut=(0,y.lazy)(()=>n.e(2372).then(n.bind(n,42372)));function pt(e){return(0,T.toLocale)(Math.round(e))}function ht(e,t,n){for(const r of n)if("subMenu"in r&&ht(e,t,r.subMenu),"onClick"in r){const n=r.onClick;r.onClick=(...r)=>{for(const a of e.tracks)a.type===t&&n.apply(a,[a,...r])}}}const gt=(0,y.lazy)(()=>n.e(8514).then(n.bind(n,8514)));function mt(e){return i.types.compose("LinearGenomeView",$.A,i.types.model({id:K.K,type:i.types.literal("LinearGenomeView"),offsetPx:0,bpPerPx:1,displayedRegions:i.types.optional(i.types.frozen(),[]),tracks:i.types.array(e.pluggableMstType("track","stateModel")),hideHeader:!1,hideHeaderOverview:!1,hideNoTracksActive:!1,trackSelectorType:i.types.optional(i.types.enumeration(["hierarchical"]),"hierarchical"),showCenterLine:i.types.optional(i.types.boolean,()=>(0,T.localStorageGetBoolean)("lgv-showCenterLine",!1)),showCytobandsSetting:i.types.optional(i.types.boolean,()=>(0,T.localStorageGetBoolean)("lgv-showCytobands",!0)),trackLabels:i.types.optional(i.types.string,()=>(0,T.localStorageGetItem)("lgv-trackLabels")||""),showGridlines:!0,highlight:i.types.optional(i.types.array(i.types.frozen()),[]),colorByCDS:i.types.optional(i.types.boolean,()=>(0,T.localStorageGetBoolean)("lgv-colorByCDS",!1)),showTrackOutlines:i.types.optional(i.types.boolean,()=>(0,T.localStorageGetBoolean)("lgv-showTrackOutlines",!0)),init:i.types.frozen()})).volatile(()=>({volatileWidth:void 0,minimumBlockWidth:3,draggingTrackId:void 0,lastTrackDragY:void 0,volatileError:void 0,scaleFactor:1,targetBpPerPx:void 0,trackRefs:{},coarseDynamicBlocks:[],coarseTotalBp:0,leftOffset:void 0,rightOffset:void 0,isScalebarRefNameMenuOpen:!1,scalebarRefNameClickPending:!1})).views(e=>({get pinnedTracks(){return e.tracks.filter(e=>e.pinned)},get unpinnedTracks(){return e.tracks.filter(e=>!e.pinned)},get trackLabelsSetting(){const t=(0,w.FI)((0,T.getSession)(e),["LinearGenomeViewPlugin","trackLabels"]);return e.trackLabels||t},get width(){if(void 0===e.volatileWidth)throw new Error("width undefined, make sure to check for model.initialized");return e.volatileWidth},get interRegionPaddingWidth(){return ie.Rd},get assemblyNames(){return[...new Set(e.displayedRegions.map(e=>e.assemblyName))]},get assemblyDisplayNames(){const{assemblyManager:t}=(0,T.getSession)(e);return this.assemblyNames.map(e=>t.get(e)?.displayName??e)},get isTopLevelView(){return(0,T.getSession)(e).views.some(t=>t.id===e.id)},get stickyViewHeaders(){const t=(0,T.getSession)(e);return!!(0,Q.X)(t)&&this.isTopLevelView&&t.stickyViewHeaders},get rubberbandTop(){let t=0;return this.stickyViewHeaders&&(t=G.VIEW_HEADER_HEIGHT,e.hideHeader||(t+=ie.Ij,e.hideHeaderOverview||(t+=ie.Gu))),t},get pinnedTracksTop(){return this.rubberbandTop+ie.jE}})).views(e=>({scalebarDisplayPrefix:()=>"LinearSyntenyView"===(0,i.getParent)(e,2).type?e.assemblyDisplayNames[0]:"",MiniControlsComponent:()=>Qe,HeaderComponent:()=>Ue,get assembliesNotFound(){const{assemblyManager:t}=(0,T.getSession)(e),n=e.assemblyNames.map(e=>t.get(e)?void 0:e).filter(e=>!!e).join(",");return n?`Assemblies ${n} not found`:void 0},get assemblyErrors(){const{assemblyManager:t}=(0,T.getSession)(e);return e.assemblyNames.map(e=>t.get(e)?.error).filter(e=>!!e).join(", ")},get assembliesInitialized(){const{assemblyManager:t}=(0,T.getSession)(e);return e.assemblyNames.every(e=>t.get(e)?.initialized)},get initialized(){if(void 0===e.volatileWidth)return!1;if(e.init){const{assemblyManager:t}=(0,T.getSession)(e),n=t.get(e.init.assembly);return!(!n?.initialized||!n.regions)}return this.assembliesInitialized},get hasDisplayedRegions(){return e.displayedRegions.length>0},get loadingMessage(){return this.showLoading?"Loading":void 0},get hasSomethingToShow(){return this.hasDisplayedRegions||!!e.init},get showLoading(){return!this.initialized&&!this.error&&this.hasSomethingToShow},get showImportForm(){return!this.hasSomethingToShow||!!this.error},get scalebarHeight(){return ie.jE+ie.i3},get headerHeight(){return e.hideHeader?0:e.hideHeaderOverview?ie.Ij:ie.Ij+ie.Gu},get trackHeights(){return(0,T.sum)(e.tracks.map(e=>e.displays[0].height))},get trackHeightsWithResizeHandles(){return this.trackHeights+e.tracks.length*ie.i3},get height(){return this.trackHeightsWithResizeHandles+this.headerHeight+this.scalebarHeight},get totalBp(){return(0,T.sum)(e.displayedRegions.map(e=>e.end-e.start))},get maxBpPerPx(){return this.totalBp/(.9*e.width)},get minBpPerPx(){return.02},get error(){if(e.volatileError)return e.volatileError;if(this.assemblyErrors)return this.assemblyErrors;if(this.assembliesNotFound)return this.assembliesNotFound;if(e.init){const{assemblyManager:t}=(0,T.getSession)(e),n=t.get(e.init.assembly);if(n?.error)return n.error;if(!n)return`Assembly ${e.init.assembly} not found`}},get maxOffset(){return this.displayedRegionsTotalPx-10},get minOffset(){return 30-e.width},get displayedRegionsTotalPx(){return this.totalBp/e.bpPerPx},renderProps:()=>({...(0,X.getParentRenderProps)(e),bpPerPx:e.bpPerPx,colorByCDS:e.colorByCDS}),searchScope:t=>({assemblyName:t,includeAggregateIndexes:!0,tracks:e.tracks}),get trackMap(){const t=new Map;for(const n of e.tracks)t.set(n.configuration.trackId,n);return t},getTrack(e){return this.trackMap.get(e)},rankSearchResults:e=>e,get trackTypeActions(){const t=new Map;for(const n of e.tracks)if(!t.get(n.type)){const r=structuredClone(n.viewMenuActions);ht(e,n.type,r),t.set(n.type,r)}return t}})).actions(e=>({setShowTrackOutlines(t){e.showTrackOutlines=t},setColorByCDS(t){e.colorByCDS=t},setShowCytobands(t){e.showCytobandsSetting=t},setWidth(t){e.volatileWidth=t},setError(t){e.volatileError=t},setIsScalebarRefNameMenuOpen(t){e.isScalebarRefNameMenuOpen=t},setScalebarRefNameClickPending(t){e.scalebarRefNameClickPending=t},setHideHeader(t){e.hideHeader=t},setHideHeaderOverview(t){e.hideHeaderOverview=t},setHideNoTracksActive(t){e.hideNoTracksActive=t},setShowGridlines(t){e.showGridlines=t},addToHighlights(t){e.highlight.push(t)},setHighlight(t){e.highlight=(0,i.cast)(t)},removeHighlight(t){e.highlight.remove(t)},scrollTo(t){const n=(0,T.clamp)(t,e.minOffset,e.maxOffset);return e.offsetPx=n,n},zoomTo(t,n=e.width/2,r=!1){const a=(0,T.clamp)(t,e.minBpPerPx,e.maxBpPerPx);if(a===e.bpPerPx)return a;const o=e.bpPerPx;if(Math.abs(o-a)<1e-6)return console.warn("zoomTo bpPerPx rounding error"),o;e.bpPerPx=a;const i=Math.round((e.offsetPx+n)*o/a-(r?e.width/2:n));return this.scrollTo(i),a},setOffsets(t,n){e.leftOffset=t,e.rightOffset=n},setSearchResults(t,n,r){(0,T.getSession)(e).queueDialog(a=>[gt,{model:e,searchResults:t,searchQuery:n,handleClose:a,assemblyName:r}])},setNewView(e,t){this.zoomTo(e),this.scrollTo(t)},horizontallyFlip(){e.displayedRegions=(0,i.cast)([...e.displayedRegions].reverse().map(e=>({...e,reversed:!e.reversed}))),this.scrollTo(e.totalBp/e.bpPerPx-e.offsetPx-e.width)},showTrack:(t,n={},r={})=>(0,X.showTrackGeneric)(e,t,n,r),hideTrack:t=>(0,X.hideTrackGeneric)(e,t)})).actions(e=>({moveTrackDown(t){const n=e.tracks.findIndex(e=>e.id===t);-1!==n&&n<e.tracks.length-1&&e.tracks.splice(n,2,e.tracks[n+1],e.tracks[n])},moveTrackUp(t){const n=e.tracks.findIndex(e=>e.id===t);n>0&&e.tracks.splice(n-1,2,e.tracks[n],e.tracks[n-1])},moveTrackToTop(t){const n=e.tracks.find(e=>e.id===t);n&&(e.tracks=(0,i.cast)([n,...e.tracks.filter(e=>e.id!==t)]))},moveTrackToBottom(t){const n=e.tracks.find(e=>e.id===t);n&&(e.tracks=(0,i.cast)([...e.tracks.filter(e=>e.id!==t),n]))},moveTrack(t,n){const r=e.tracks.findIndex(e=>e.id===t);if(-1===r)throw new Error(`Track ID ${t} not found`);const a=e.tracks.findIndex(e=>e.id===n);if(-1===a)throw new Error(`Track ID ${n} not found`);const o=e.tracks.filter((e,t)=>t!==r);o.splice(a,0,e.tracks[r]),e.tracks=(0,i.cast)(o)},toggleTrack(t){(0,X.toggleTrackGeneric)(e,t)},setTrackLabels(t){e.trackLabels=t},setShowCenterLine(t){e.showCenterLine=t},setDisplayedRegions(t){e.displayedRegions=(0,i.cast)(t),e.zoomTo(e.bpPerPx)},activateTrackSelector(){if("hierarchical"===e.trackSelectorType){const t=(0,T.getSession)(e);if((0,o.lO)(t)){const n=t.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:e});return t.showWidget(n),n}}throw new Error(`invalid track selector type ${e.trackSelectorType}`)},getSelectedRegions(t,n){const r=(0,i.getSnapshot)(e),a=U.A.create({...r,interRegionPaddingWidth:e.interRegionPaddingWidth});return a.setVolatileWidth(e.width),a.moveTo(t,n),a.dynamicBlocks.contentBlocks.map(e=>({assemblyName:e.assemblyName,refName:e.refName,start:Math.floor(e.start),end:Math.ceil(e.end)}))},horizontalScroll(t){const n=e.offsetPx;return e.scrollTo(e.offsetPx+t)-n},center(){const t=Math.max(0,e.displayedRegions.length-1)*e.interRegionPaddingWidth,n=(e.totalBp/e.bpPerPx+t)/2,r=Math.round(n-e.width/2);e.scrollTo(r)},showAllRegions(){e.bpPerPx=(0,T.clamp)(e.maxBpPerPx,e.minBpPerPx,e.maxBpPerPx),this.center()},showAllRegionsInAssembly(t){const n=(0,T.getSession)(e),{assemblyManager:r}=n;if(!t){const r=new Set(e.displayedRegions.map(e=>e.assemblyName));if(r.size>1)return void n.notify("Can't perform operation with multiple assemblies currently");[t]=[...r]}const a=r.get(t)?.regions;a&&(this.setDisplayedRegions(a),e.zoomTo(e.maxBpPerPx),this.center())},setDraggingTrackId(t){e.draggingTrackId=t,void 0===t&&(e.lastTrackDragY=void 0)},setLastTrackDragY(t){e.lastTrackDragY=t},setScaleFactor(t){e.scaleFactor=t},setTargetBpPerPx(t){e.targetBpPerPx=t},clearView(){this.setDisplayedRegions([]),e.tracks.clear(),e.scrollTo(0),e.zoomTo(10)},setInit(t){e.init=t},async exportSvg(t={}){const{renderToSvg:r}=await n.e(3967).then(n.bind(n,13967)),a=await r(e,t),{saveAs:o}=await n.e(9044).then(n.bind(n,99044));o(new Blob([a],{type:"image/svg+xml"}),t.filename||"image.svg")}})).actions(e=>{let t=()=>{};return{slide:function(n){const[r,a]=(0,T.springAnimate)(e.offsetPx,e.offsetPx+e.width*n,e.scrollTo,void 0,void 0,200);t(),t=a,r()}}}).actions(e=>{let t=()=>{};return{zoom:function(n){t();const r=n/e.bpPerPx;let a=(e.targetBpPerPx??e.bpPerPx)*r;a=Math.max(e.minBpPerPx,Math.min(e.maxBpPerPx,a));const o=e.targetBpPerPx??e.bpPerPx;if(a===o)return;e.setTargetBpPerPx(a);const i=e.bpPerPx/a,[s,l]=(0,T.springAnimate)(e.scaleFactor,i,e.setScaleFactor,()=>{e.zoomTo(a),e.setScaleFactor(1),e.setTargetBpPerPx(void 0)},0,1e3,50);t=l,s()}}}).views(e=>({get canShowCytobands(){return 1===e.displayedRegions.length&&this.anyCytobandsExist},get showCytobands(){return this.canShowCytobands&&e.showCytobandsSetting},get anyCytobandsExist(){const{assemblyManager:t}=(0,T.getSession)(e);return e.assemblyNames.some(e=>t.get(e)?.cytobands?.length)},get cytobandOffset(){return this.showCytobands?(0,T.measureText)(e.displayedRegions[0]?.refName||"",12)+15:0}})).views(e=>({menuItems:()=>function(e){if(!e.hasDisplayedRegions)return[];const{canShowCytobands:t,showCytobands:n}=e,r=(0,T.getSession)(e),a=[{label:"Return to import form",onClick:()=>{r.queueDialog(t=>[lt,{model:e,handleClose:t}])},icon:et.A},...(0,o.QW)(r)?[{label:"Sequence search",icon:ot.A,onClick:()=>{r.queueDialog(t=>[ct,{model:e,handleClose:t}])}}]:[],{label:"Export SVG",icon:at.A,onClick:()=>{r.queueDialog(t=>[dt,{model:e,handleClose:t}])}},{label:"Open track selector",onClick:e.activateTrackSelector,icon:he.xU},{label:"Horizontally flip",icon:it.A,onClick:e.horizontallyFlip},{label:"Color by CDS and draw amino acids",type:"checkbox",checked:e.colorByCDS,icon:rt.A,onClick:()=>{e.setColorByCDS(!e.colorByCDS)}},{label:"Show...",icon:st.A,subMenu:[{label:"Show all regions in assembly",onClick:e.showAllRegionsInAssembly},{label:"Show center line",type:"checkbox",checked:e.showCenterLine,onClick:()=>{e.setShowCenterLine(!e.showCenterLine)}},{label:"Show header",type:"checkbox",checked:!e.hideHeader,onClick:()=>{e.setHideHeader(!e.hideHeader)}},{label:"Show track outlines",type:"checkbox",checked:e.showTrackOutlines,onClick:()=>{e.setShowTrackOutlines(!e.showTrackOutlines)}},{label:"Show header overview",type:"checkbox",checked:!e.hideHeaderOverview,onClick:()=>{e.setHideHeaderOverview(!e.hideHeaderOverview)},disabled:e.hideHeader},{label:"Show no tracks active button",type:"checkbox",checked:!e.hideNoTracksActive,onClick:()=>{e.setHideNoTracksActive(!e.hideNoTracksActive)}},{label:"Show guidelines",type:"checkbox",checked:e.showGridlines,onClick:()=>{e.setShowGridlines(!e.showGridlines)}},...t?[{label:"Show ideogram",type:"checkbox",checked:e.showCytobands,onClick:()=>{e.setShowCytobands(!n)}}]:[]]},{label:"Track labels",icon:tt.A,subMenu:[{label:"Overlapping",icon:st.A,type:"radio",checked:"overlapping"===e.trackLabelsSetting,onClick:()=>{e.setTrackLabels("overlapping")}},{label:"Offset",icon:st.A,type:"radio",checked:"offset"===e.trackLabelsSetting,onClick:()=>{e.setTrackLabels("offset")}},{label:"Hidden",icon:st.A,type:"radio",checked:"hidden"===e.trackLabelsSetting,onClick:()=>{e.setTrackLabels("hidden")}}]}];for(const[t,n]of e.trackTypeActions.entries())if(n.length){a.push({type:"divider"},{type:"subHeader",label:t});for(const e of n)a.push(e)}return a}(e)})).views(e=>{let t,n;return{get staticBlocks(){const r=(0,J.A)(e),a=r.blocks.map(e=>e.key).join(",");return void 0===t||n!==a?(t=r,n=a,t):t},get dynamicBlocks(){return(0,q.A)(e)},get roundedDynamicBlocks(){return this.dynamicBlocks.contentBlocks.map(e=>({...e,start:Math.floor(e.start),end:Math.ceil(e.end)}))},get visibleLocStrings(){return(0,De.H4)(this.dynamicBlocks.contentBlocks)},get coarseVisibleLocStrings(){return(0,De.H4)(e.coarseDynamicBlocks)},get coarseTotalBpDisplayStr(){return(0,T.getBpDisplayStr)(e.coarseTotalBp)},get effectiveBpPerPx(){return e.targetBpPerPx??e.bpPerPx},get effectiveTotalBp(){return this.effectiveBpPerPx*e.width},get effectiveTotalBpDisplayStr(){return(0,T.getBpDisplayStr)(this.effectiveTotalBp)}}}).actions(e=>({setCoarseDynamicBlocks(t){e.coarseDynamicBlocks=t.contentBlocks,e.coarseTotalBp=t.totalBp}})).actions(e=>({moveTo(t,n){(0,W.tw)(e,t,n)},async navToLocString(t,n,r){const{assemblyNames:a}=e,{assemblyManager:o}=(0,T.getSession)(e),i=n||a[0];return i&&await o.waitForAssembly(i),this.navToLocations((0,De.CU)(t,i,(e,t)=>o.isValidRefName(e,t)),i,r)},async navToSearchString({input:t,assembly:n}){await(0,Z.cm)({input:t,assembly:n,model:e})},async navToLocation(e,t,n){return this.navToLocations([e],t,n)},async navToLocations(t,n,r){const{assemblyManager:a}=(0,T.getSession)(e);await(0,Y.when)(()=>void 0!==e.volatileWidth);const o=await(0,De.Cz)({regions:t,assemblyManager:a,assemblyName:n,grow:r});if(1===o.length){const t=o[0],{reversed:n,parentRegion:r,start:a,end:i}=t;e.setDisplayedRegions([{reversed:n,...r}]),this.navTo({...t,start:(0,T.clamp)(a??0,0,r.end),end:(0,T.clamp)(i??r.end,0,r.end)})}else e.setDisplayedRegions(o.map(e=>{const{start:t,end:n}=e;return void 0===t||void 0===n?e.parentRegion:{...e,start:t,end:n}})),e.showAllRegions()},navTo(e,t){this.navToMultiple([e],t)},navToMultiple(t,n){if(t.some(e=>void 0!==e.start&&void 0!==e.end&&e.start>e.end))throw new Error("found start greater than end");const r=t.at(0),a=t.at(-1);if(!r||!a)return;const o=e.assemblyNames[0],{assemblyManager:i}=(0,T.getSession)(e),s=i.get(r.assemblyName||o),l=s?.getCanonicalRefName(r.refName)||r.refName,c=e.displayedRegions.find(e=>e.refName===l),d=i.get(a.assemblyName||o),u=d?.getCanonicalRefName(a.refName)||a.refName,p=(0,T.findLast)(e.displayedRegions,e=>e.refName===u);if(!c)throw new Error(`could not find a region with refName "${l}"`);if(!p)throw new Error(`could not find a region with refName "${u}"`);let h=void 0===r.start?c.start:r.start,g=void 0===r.end?c.end:r.end,m=void 0===a.start?p.start:a.start,f=void 0===a.end?p.end:a.end;if(n){const e=(0,De.Tn)(h,f,n,c.start,p.end);h=e.start,g=e.end,m=e.start,f=e.end}const y=e.displayedRegions.findIndex(e=>l===e.refName&&h>=e.start&&h<=e.end&&g<=e.end&&g>=e.start),b=e.displayedRegions.findIndex(e=>u===e.refName&&m>=e.start&&m<=e.end&&f<=e.end&&f>=e.start);if(-1===y||-1===b)throw new Error(`could not find a region that contained "${t.map(e=>(0,T.assembleLocString)(e))}"`);const w=e.displayedRegions[y],v=e.displayedRegions[b],S=w.reversed?w.end-g:h-w.start,k=v.reversed?v.end-m:f-v.start;this.moveTo({index:y,offset:S},{index:b,offset:k})}})).views(e=>({rubberBandMenuItems:()=>function(e){const{leftOffset:t,rightOffset:r}=e,a=t?.refName??"",o=r?.refName??"",i=pt((t?.coord??0)+1),s=pt(r?.coord??0),l=a===o?`${a}:${i}-${s}`:`${a}:${i}..${o}:${s}`;return[{label:"Zoom to region",icon:P.A,onClick:()=>{e.moveTo(e.leftOffset,e.rightOffset)}},{label:"Get sequence",icon:nt.A,onClick:()=>{(0,T.getSession)(e).queueDialog(t=>[ut,{model:e,handleClose:t}])}},{label:"Copy range",icon:Ze.A,onClick:async()=>{const{default:e}=await n.e(8284).then(n.t.bind(n,88284,23));e(l)}}]}(e),bpToPx:({refName:t,coord:n,regionNumber:r})=>(0,W.eB)({refName:t,coord:n,regionNumber:r,self:e}),centerAt(t,n,r){const a=this.bpToPx({refName:n,coord:t,regionNumber:r});void 0!==a&&e.scrollTo(Math.round(a.offsetPx-e.width/2))},pxToBp:t=>(0,W.Ii)(e,t),get centerLineInfo(){return e.displayedRegions.length>0?this.pxToBp(e.width/2):void 0},get visibleRegions(){return e.dynamicBlocks.contentBlocks}})).views(e=>({rubberbandClickMenuItems:t=>function(e,t){const{coord:r,refName:a}=t;if(void 0===r||void 0===a)return[];const o=`${a}:${pt(r+1)}`;return[{label:"Center view here",icon:Ye.A,onClick:()=>{e.centerAt(r,a)}},{label:"Zoom to base level",icon:P.A,onClick:()=>{e.centerAt(r,a),e.zoomTo(e.minBpPerPx)}},{label:`Copy coordinate (${o})`,icon:Ze.A,onClick:async()=>{const{default:e}=await n.e(8284).then(n.t.bind(n,88284,23));e(o)}}]}(e,t)})).actions(e=>({afterCreate(){!function(e){function t(t){(0,T.getSession)(e).focusedViewId===e.id&&(t.ctrlKey||t.metaKey)&&("ArrowLeft"===t.code?(t.preventDefault(),e.slide(-.9)):"ArrowRight"===t.code?(t.preventDefault(),e.slide(.9)):"ArrowUp"===t.code?(t.preventDefault(),e.zoom(e.bpPerPx/2)):"ArrowDown"===t.code&&(t.preventDefault(),e.zoom(2*e.bpPerPx)))}document.addEventListener("keydown",t),(0,i.addDisposer)(e,()=>{document.removeEventListener("keydown",t)})}(e)},afterAttach(){!function(e){!function(e){(0,i.addDisposer)(e,(0,Y.autorun)(async function(){const{init:t,initialized:n}=e;if(n&&t){const n=(0,T.getSession)(e),{assemblyManager:r}=n;if(t.tracklist){e.activateTrackSelector();const t=e.volatileWidth;await(0,Y.when)(()=>e.volatileWidth!==t,{timeout:500}).catch(()=>{})}try{t.loc?await e.navToLocString(t.loc,t.assembly):e.showAllRegionsInAssembly(t.assembly)}catch(e){console.error(t,e),n.notifyError(`${e}`,e)}if(t.tracks){const r=[];for(const n of t.tracks)try{e.showTrack(n)}catch(e){if(!/Could not resolve identifier/.exec(`${e}`))throw e;r.push(n)}r.length&&n.notifyError(`Could not resolve identifiers: ${r.join(",")}`,new Error(`Could not resolve identifiers: ${r.join(",")}`))}if(void 0!==t.nav&&e.setHideHeader(!t.nav),t.highlight)for(const n of t.highlight){const a=(0,ee.f)(n,e=>r.isValidRefName(e,t.assembly)),{start:o,end:i}=a;void 0!==o&&void 0!==i&&e.addToHighlights({...a,start:o,end:i,assemblyName:t.assembly})}e.setInit(void 0)}},{name:"LGVInit"}))}(e),function(e){(0,i.addDisposer)(e,(0,Y.autorun)(function(){e.initialized&&e.setCoarseDynamicBlocks(e.dynamicBlocks)},{delay:500,name:"LGVCoarseDynamicBlocks"}))}(e),function(e){(0,i.addDisposer)(e,(0,Y.autorun)(function(){const t=e=>JSON.stringify(e),{showCytobandsSetting:n,showCenterLine:r,colorByCDS:a,showTrackOutlines:o,trackLabels:i}=e;(0,T.localStorageSetItem)("lgv-showCytobands",t(n)),(0,T.localStorageSetItem)("lgv-showCenterLine",t(r)),(0,T.localStorageSetItem)("lgv-colorByCDS",t(a)),(0,T.localStorageSetItem)("lgv-showTrackOutlines",t(o)),(0,T.localStorageSetItem)("lgv-trackLabels",i)},{name:"LGVLocalStorage"}))}(e)}(e)}})).preProcessSnapshot(e=>{if(!e)return e;const{highlight:t,...n}=e;return{highlight:Array.isArray(t)||void 0===t?t:[t],...n}}).postProcessSnapshot(e=>{if(!e)return e;const{init:t,offsetPx:n,bpPerPx:r,hideHeader:a,hideHeaderOverview:o,hideNoTracksActive:i,showGridlines:s,trackSelectorType:l,displayedRegions:c,highlight:d,showCenterLine:u,showCytobandsSetting:p,trackLabels:h,colorByCDS:g,showTrackOutlines:m,...f}=e;return{...f,...n?{offsetPx:n}:{},...1!==r?{bpPerPx:r}:{},...a?{hideHeader:a}:{},...o?{hideHeaderOverview:o}:{},...i?{hideNoTracksActive:i}:{},...s?{}:{showGridlines:s},..."hierarchical"!==l?{trackSelectorType:l}:{},...c.length?{displayedRegions:c}:{},...d.length?{highlight:d}:{},...u?{showCenterLine:u}:{},...p?{}:{showCytobandsSetting:p},...h?{trackLabels:h}:{},...g?{colorByCDS:g}:{},...m?{}:{showTrackOutlines:m}}})}var ft=n(75589);class yt extends r.A{name="LinearGenomeViewPlugin";exports={BaseLinearDisplayComponent:l.Ay,BaseLinearDisplay:c.L,baseLinearDisplayConfigSchema:d.A,SearchBox:H.A,ZoomControls:j,LinearGenomeView:_.default};configurationSchema=(0,a.S7)("LinearGenomeViewConfigSchema",{trackLabels:{type:"string",defaultValue:"overlapping",model:i.types.enumeration("trackLabelOptions",["offset","overlapping","hidden"])}});install(e){var t;(t=e).addTrackType(()=>{const e=(e=>(0,a.S7)("FeatureTrack",{},{baseConfiguration:(0,h.J)(e),explicitIdentifier:"trackId"}))(t);return new u.A({name:"FeatureTrack",displayName:"Feature track",configSchema:e,stateModel:(0,p.E)(t,"FeatureTrack",e)})}),function(e){e.addTrackType(()=>{const t=(e=>(0,a.S7)("BasicTrack",{},{baseConfiguration:(0,h.J)(e),explicitIdentifier:"trackId"}))(e);return new u.A({name:"BasicTrack",configSchema:t,stateModel:(0,p.E)(e,"BasicTrack",t)})})}(e),function(e){e.addDisplayType(()=>{const t=(0,b.A)(e);return new g.A({name:"LinearBasicDisplay",displayName:"Basic feature display",configSchema:t,stateModel:k(t),trackType:"FeatureTrack",viewType:"LinearGenomeView",ReactComponent:(0,y.lazy)(()=>Promise.resolve().then(n.bind(n,75589)))})})}(e),function(e){e.addViewType(()=>new O.A({name:"LinearGenomeView",displayName:"Linear genome view",stateModel:mt(e),ReactComponent:(0,y.lazy)(()=>Promise.resolve().then(n.bind(n,12485)))}))}(e),function(e){e.addDisplayType(()=>{const t=m(e);return new g.A({name:"LinearBareDisplay",configSchema:t,displayName:"Bare feature display",stateModel:(0,f.n)(t),trackType:"BasicTrack",viewType:"LinearGenomeView",ReactComponent:l.Ay})})}(e),function(e){e.addToExtensionPoint("LaunchView-LinearGenomeView",async({session:e,assembly:t,loc:n,tracks:r=[],tracklist:a,nav:o,highlight:i})=>{if(!t)throw new Error("No assembly provided when launching linear genome view");e.addView("LinearGenomeView",{init:{assembly:t,loc:n,tracks:r,tracklist:a,nav:o,highlight:i}})})}(e)}configure(e){(0,o.Nh)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Linear genome view",icon:s.A,onClick:e=>{e.addView("LinearGenomeView",{})}})}}},95067(e,t,n){n.d(t,{Cg:()=>s});var r=n(52901);function a(e,t){const n={},r=Object.values(e);for(const e of r){const r=e,a=t[r]??(t[r]=r.split(/[/|]/));for(const e of a){const t=e;n[t]=(n[t]||0)+1}}return n}function o(e){let t=0,n=0,r=0;for(const a of Object.values(e))r+=a,a>t?(n=t,t=a):a>n&&a!==t&&(n=a);return n/(r||1)}function i(e){let t,n=0;for(const[r,a]of Object.entries(e))"."!==r&&"0"!==r&&a>n&&(t=r,n=a);return t}function s({features:e,minorAlleleFrequencyFilter:t,lengthCutoffFilter:n,lastCheck:s,genotypesCache:l,splitCache:c={}}){const d=[];for(const u of e){if(u.get("end")-u.get("start")<=n){const e=u.id();let n=l?.get(e);n||(n=u.get("genotypes"),l?.set(e,n));const r=a(n,c);o(r)>=t&&d.push({feature:u,mostFrequentAlt:i(r),alleleCounts:r})}(0,r.As)(s)}return d}},96669(e,t,n){n.d(t,{A:()=>kl});var r=n(54351),a=n(42918),o=n(14665),i=n(87877);const s=(0,i.S7)("AlignmentsFeatureWidget",{});var l=n(20369),c=n(99226);function d(e){return c.types.compose((0,l.n)(e),c.types.model("AlignmentsFeatureWidget",{type:c.types.literal("AlignmentsFeatureWidget")}))}function u(e){e.addWidgetType(()=>new o.A({name:"AlignmentsFeatureWidget",heading:"Feature details",configSchema:s,stateModel:d(e),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(9764),n.e(122)]).then(n.bind(n,50122)))}))}var p=n(3026),h=n(75976),g=n(7062);function m(e){return e?e.split(" ").map(e=>String.fromCharCode(+e+33)).join(""):"*"}function f({features:e,session:t,assemblyName:n}){const r=["@HD\tVN:1.6\tSO:unsorted"],{assemblyManager:a}=t,o=a.get(n);if(o){const e=o.regions;if(e)for(const t of e){const e=t.end-t.start;r.push(`@SQ\tSN:${t.refName}\tLN:${e}`)}}r.push("@PG\tID:jbrowse\tPN:JBrowse\tVN:2");for(const t of e){const e=t.get("start"),n=[t.get("name")||t.get("id")||"*",t.get("flag")??"0",t.get("refName")||"*",String(e+1),t.get("mapq")??"255",t.get("CIGAR")||"*",t.get("next_ref")||"*",t.get("next_pos")??"0",t.get("template_len")??"0",t.get("seq")||"*",m(t.get("qual"))];r.push(n.join("\t"))}return r.join("\n")}function y(e){e.addTrackType(()=>{const t=(n=e,(0,i.S7)("AlignmentsTrack",{},{baseConfiguration:(0,g.J)(n)}));var n;const r=new p.A({name:"AlignmentsTrack",displayName:"Alignments track",configSchema:t,stateModel:(0,h.E)(e,"AlignmentsTrack",t).views(()=>({saveTrackFileFormatOptions:()=>({sam:{name:"SAM",extension:"sam",callback:f,helpText:"Note: SAM format export is experimental and does not currently output optional tags. The output may not fully conform to the SAM specification and should be validated before use in production workflows."}})}))}),a=e.getDisplayType("LinearAlignmentsDisplay");return r.addDisplayType(a),r})}var b=n(58946);const w=(0,i.S7)("BamAdapter",{bamLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bam",locationType:"UriLocation"}},index:(0,i.S7)("BamIndex",{indexType:{model:c.types.enumeration("IndexType",["BAI","CSI"]),type:"stringEnum",defaultValue:"BAI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bam.bai",locationType:"UriLocation"}}}),fetchSizeLimit:{type:"number",description:"size to fetch in bytes over which to display a warning to the user that too much data will be fetched",defaultValue:5e6}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bamLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.bai`,baseUri:e.baseUri}}}:e});function v(e){e.addAdapterType(()=>new b.A({name:"BamAdapter",displayName:"BAM adapter",configSchema:w,getAdapterClass:()=>Promise.all([n.e(1242),n.e(8003)]).then(n.bind(n,8003)).then(e=>e.default)}))}const S=(0,i.S7)("CramAdapter",{fetchSizeLimit:{type:"number",description:"size in bytes over which to display a warning to the user that too much data will be fetched",defaultValue:3e6},cramLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.cram",locationType:"UriLocation"}},craiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.cram.crai",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,cramLocation:{uri:e.uri,baseUri:e.baseUri},craiLocation:{uri:`${e.uri}.crai`,baseUri:e.baseUri}}:e});function k(e){e.addAdapterType(()=>new b.A({name:"CramAdapter",displayName:"CRAM adapter",configSchema:S,getAdapterClass:()=>Promise.all([n.e(8651),n.e(107)]).then(n.bind(n,107)).then(e=>e.default)}))}var x=n(77251),C=n(70203);function T(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t),o=n&&(0,C.getFileName)(n);return(0,x.testAdapter)(a,/\.bam$/i,r,"BamAdapter")?{type:"BamAdapter",bamLocation:t,index:{location:n||(0,C.makeIndex)(t,".bai"),indexType:(0,C.makeIndexType)(o,"CSI","BAI")}}:(0,x.testAdapter)(a,/\.cram$/i,r,"CramAdapter")?{type:"CramAdapter",cramLocation:t,craiLocation:n||(0,C.makeIndex)(t,".crai")}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"BamAdapter"===t||"CramAdapter"===t?"AlignmentsTrack":e(t))}const A=(0,i.S7)("HtsgetBamAdapter",{htsgetBase:{type:"string",description:"the base URL to fetch from",defaultValue:""},htsgetTrackId:{type:"string",description:"the trackId, which is appended to the base URL",defaultValue:""}},{explicitlyTyped:!0});function M(e){e.addAdapterType(()=>new b.A({name:"HtsgetBamAdapter",displayName:"Htsget BAM adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:A,getAdapterClass:()=>Promise.all([n.e(1242),n.e(4877)]).then(n.bind(n,24877)).then(e=>e.default)}))}var P=n(61451),I=n(98612),R=n(11259),L=n(62296),F=n(62202),D=n.n(F),N=n(38567);function B(e){return e.getDisplayElements().filter(e=>"LinearAlignmentsDisplay"===e.subDisplay?.type).filter(e=>e.subDisplay?.lowerPanel)}const E=function(e,t){return c.types.compose("LinearAlignmentsDisplay",L.q,function(e,t){return c.types.model({PileupDisplay:c.types.maybe(c.types.union(...B(e).map(e=>e.stateModel))),SNPCoverageDisplay:c.types.maybe(e.getDisplayType("LinearSNPCoverageDisplay").stateModel),snpCovHeight:45,type:c.types.literal("LinearAlignmentsDisplay"),configuration:(0,i.AK)(t),heightPreConfig:c.types.maybe(c.types.number),userFeatureScreenDensity:c.types.maybe(c.types.number),lowerPanelType:"LinearPileupDisplay"})}(e,t)).volatile(()=>({scrollTop:0})).actions(e=>({setScrollTop(t){e.scrollTop=t},setSNPCoverageHeight(t){e.snpCovHeight=t},setShowLegend(t){e.PileupDisplay?.setShowLegend(t)}})).views(e=>({get height(){return e.heightPreConfig??(0,R.FI)(e,"height")},get featureIdUnderMouse(){return e.PileupDisplay.featureIdUnderMouse||e.SNPCoverageDisplay.featureIdUnderMouse},get showLegend(){return e.PileupDisplay?.showLegend},svgLegendWidth(t){const n=e.PileupDisplay?.svgLegendWidth?.(t)??0,r=e.SNPCoverageDisplay?.svgLegendWidth?.(t)??0;return Math.max(n,r)}})).views(e=>({get pileupConf(){return{...(0,R.FI)(e,"pileupDisplay"),type:e.lowerPanelType,displayId:`${e.configuration.displayId}_${e.lowerPanelType}_xyz`}},getFeatureByID:(t,n)=>e.PileupDisplay.getFeatureByID(t,n),searchFeatureByID:t=>e.PileupDisplay.searchFeatureByID?.(t),get features(){return e.PileupDisplay.features},get DisplayBlurb(){return e.PileupDisplay?.DisplayBlurb},get sortedBy(){return e.PileupDisplay.sortedBy},get coverageConf(){return{...(0,R.FI)(e,"snpCoverageDisplay"),displayId:`${e.configuration.displayId}_snpcoverage_xyz`}},notReady:()=>e.PileupDisplay?.renderProps().notReady||e.SNPCoverageDisplay?.renderProps().notReady})).actions(e=>({setSNPCoverageDisplay(t){e.SNPCoverageDisplay={type:"LinearSNPCoverageDisplay",configuration:t,height:e.snpCovHeight}},setFeatureDensityStatsLimit(t){e.PileupDisplay.setFeatureDensityStatsLimit(t),e.SNPCoverageDisplay.setFeatureDensityStatsLimit(t)},setPileupDisplay(t){e.PileupDisplay={type:t.type||"LinearPileupDisplay",configuration:t}},setHeight:t=>(e.heightPreConfig=Math.max(t,20),e.heightPreConfig),setLowerPanelType(t){e.lowerPanelType=t},resizeHeight(t){const n=e.height;return this.setHeight(e.height+t)-n}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){const{SNPCoverageDisplay:t,PileupDisplay:n,coverageConf:r,pileupConf:a}=e;t?D()(r,(0,c.getSnapshot)(t.configuration))||(t.setHeight(e.snpCovHeight),t.setConfig(e.coverageConf)):e.setSNPCoverageDisplay(r),e.lowerPanelType!==n?.type?e.setPileupDisplay(a):D()(a,(0,c.getSnapshot)(n.configuration))||n.setConfig(e.pileupConf)},{name:"AlignmentsDisplayConfig"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){e.setSNPCoverageHeight(e.SNPCoverageDisplay.height)},{name:"SNPCoverageHeight"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){e.PileupDisplay.setHeight(e.height-e.SNPCoverageDisplay.height)},{name:"PileupHeight"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){const t=e.PileupDisplay.colorBy;"modifications"===t?.type||"methylation"===t?.type?e.SNPCoverageDisplay.setColorScheme(t):e.SNPCoverageDisplay.colorBy&&e.SNPCoverageDisplay.setColorScheme(void 0)},{name:"SyncColorBy"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){const t=e.PileupDisplay.filterBy;e.SNPCoverageDisplay.setFilterBy(t)},{name:"SyncFilterBy"}))},async renderSvg(t){const{renderSvg:r}=await n.e(139).then(n.bind(n,139));return r(e,t)}})).views(t=>{const{trackMenuItems:n}=t;return{trackMenuItems(){if(!t.PileupDisplay)return[];const r=B(e).map(e=>({type:"radio",label:e.displayName,checked:e.name===t.PileupDisplay.type,onClick:()=>{t.setLowerPanelType(e.name)}}));return[...n(),{type:"subMenu",label:"Pileup settings",subMenu:t.PileupDisplay.trackMenuItems()},{type:"subMenu",label:"SNPCoverage settings",subMenu:t.SNPCoverageDisplay.trackMenuItems()},{type:"subMenu",label:"Replace lower panel with...",subMenu:r}]}}}).preProcessSnapshot(e=>{if(!e)return e;const{height:t,...n}=e;return{heightPreConfig:t,...n}}).postProcessSnapshot(e=>{if(!e)return e;const{heightPreConfig:t,lowerPanelType:n,snpCovHeight:r,...a}=e;return{...a,...void 0!==t&&250!==t?{height:t}:{},..."LinearPileupDisplay"!==n?{lowerPanelType:n}:{},...45!==r?{snpCovHeight:r}:{}}})};function V(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearAlignmentsDisplay",{pileupDisplay:e.getDisplayType("LinearPileupDisplay").configSchema,snpCoverageDisplay:e.getDisplayType("LinearSNPCoverageDisplay").configSchema,height:{type:"number",defaultValue:250}},{baseConfiguration:I.A,explicitlyTyped:!0})}(e);return new P.A({name:"LinearAlignmentsDisplay",displayName:"Alignments display (combination)",configSchema:t,stateModel:E(e,t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>n.e(8979).then(n.bind(n,68979)))})})}var z=n(18769),j=n(2156),H=n(47354);const _=function(e){return(0,i.S7)("LinearPileupDisplay",{defaultRendering:{type:"stringEnum",model:c.types.enumeration("Rendering",["pileup"]),defaultValue:"pileup"},renderers:(0,i.S7)("RenderersConfiguration",{PileupRenderer:e.getRendererType("PileupRenderer").configSchema}),maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},colorBy:{type:"frozen",description:"color scheme to use",defaultValue:{type:"normal"}},filterBy:{type:"frozen",description:"default filters to use",defaultValue:H.JD}},{baseConfiguration:(0,j.A)(e),explicitlyTyped:!0})};var O=n(73482),$=n(34689),G=n(8971),W=n(46413),U=n(10525),q=n(53155),J=n(58730),X=n(54661),K=n(2193),Q=n(27214),Y=n(89913),Z=n(1591),ee=n(64074),te=n(32118);const ne=(0,ee.observer)(function({model:e}){const{sortedBy:t}=e;return t?(0,te.jsx)("div",{"data-testid":`blurb-${t}`,children:(0,te.jsx)(Z.A,{color:"secondary",variant:"caption",children:`Sorted by ${t.tag??t.type} at ${t.refName}:${t.pos}`})}):null}),re=ne;var ae=n(15391);const oe={color:ae.pf.color_supplementary,label:"Supplementary/split"},ie={color:ae.pf.color_unmapped_mate,label:"Unmapped mate"},se=[{color:ae.pf.color_pair_lr,label:"Normal pair orientation"},{color:ae.pf.color_pair_rr,label:"Both mates reverse strand"},{color:ae.pf.color_pair_rl,label:"Both mates point outward"},{color:ae.pf.color_pair_ll,label:"Both mates forward strand"}],le=[{color:ae.pf.color_longinsert,label:"Long insert"},{color:ae.pf.color_shortinsert,label:"Short insert"},{color:ae.pf.color_interchrom,label:"Inter-chromosomal"}],ce={color:ae.pf.color_pair_lr,label:"Normal"},de=[...se,ie,oe],ue=[ce,...le,ie,oe],pe=[...se,...le,ie,oe];function he(e){const{bases:t,insertion:n,deletion:r,hardclip:a,softclip:o}=e.palette;return[{color:t.A.main,label:"A"},{color:t.C.main,label:"C"},{color:t.G.main,label:"G"},{color:t.T.main,label:"T"},{color:n,label:"Insertion"},{color:r,label:"Deletion"},{color:a,label:"Hard clip"},{color:o,label:"Soft clip"}]}function ge(e,t){const n=e?.type;if("modifications"===n&&t){const e=[];for(const[n,r]of t.entries())e.push({color:r.color,label:n});return e.push(oe),e}return"insertSizeAndOrientation"===n?pe:"insertSize"===n?ue:"orientation"===n?de:[oe]}var me=n(29242),fe=n(60586);const ye=(0,a.lazy)(()=>n.e(1080).then(n.bind(n,21080))),be=(0,a.lazy)(()=>n.e(1706).then(n.bind(n,71706)));function we(e,t={}){const{includeMethylation:n=!1}=t,{modificationThreshold:r,modificationsReady:a,visibleModificationTypes:o}=e;return a?o.length?[{label:`All modifications (>= ${r}% prob)`,onClick:()=>{e.setColorScheme({type:"modifications",modifications:{threshold:r}})}},...e.visibleModificationTypes.map(t=>({label:`Show only ${fe.R[t]?.name||t} (>= ${r}% prob)`,onClick:()=>{e.setColorScheme({type:"modifications",modifications:{isolatedModification:t,threshold:r}})}})),{type:"divider"},{label:"All modifications (<50% prob colored blue)",onClick:()=>{e.setColorScheme({type:"modifications",modifications:{twoColor:!0,threshold:r}})}},...e.visibleModificationTypes.map(t=>({label:`Show only ${fe.R[t]?.name||t} (<50% prob colored blue)`,onClick:()=>{e.setColorScheme({type:"modifications",modifications:{isolatedModification:t,twoColor:!0,threshold:r}})}})),...n?[{type:"divider"},{label:"All reference CpGs",onClick:()=>{e.setColorScheme({type:"methylation",modifications:{threshold:r}})}}]:[],{type:"divider"},{label:`Adjust threshold (${r}%)`,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[be,{model:e,handleClose:t}])}}]:[{label:"No modifications currently visible"}]:[{label:"Loading modifications...",onClick:()=>{}}]}function ve(e,t={}){return{label:"Modifications",type:"subMenu",subMenu:we(e,t)}}function Se(e){const t=[{label:"Insert size ± 3σ and orientation",onClick:()=>{e.setColorScheme({type:"insertSizeAndOrientation"})}},{label:"Insert size ± 3σ",onClick:()=>{e.setColorScheme({type:"insertSize"})}},{label:"Orientation",onClick:()=>{e.setColorScheme({type:"orientation"})}},{label:"Insert size gradient",onClick:()=>{e.setColorScheme({type:"gradient"})}}],n=function(e){return"modificationsReady"in e&&"visibleModificationTypes"in e}(e)&&e.visibleModificationTypes.length>0?[ve(e)]:[];return{label:"Color scheme",icon:me.A,subMenu:[...t,...n]}}function ke(e){return{label:"Filter by",icon:X.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ye,{model:e,handleClose:t}])}}}function xe(e){return{label:"Edit filters",icon:X.A,type:"subMenu",subMenu:[{label:"Show singletons",type:"checkbox",checked:e.drawSingletons,onClick:()=>{e.setDrawSingletons(!e.drawSingletons)}},{label:"Show proper pairs",type:"checkbox",checked:e.drawProperPairs,onClick:()=>{e.setDrawProperPairs(!e.drawProperPairs)}},{type:"divider"},{label:"Edit filters...",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ye,{model:e,handleClose:t}])}}]}}function Ce(e){return{label:"Mismatch/indel display",type:"subMenu",subMenu:[{label:"Show all mismatches",type:"radio",checked:!e.hideMismatches&&!e.hideSmallIndels&&!e.hideLargeIndels,onClick:()=>{e.setHideMismatches(!1),e.setHideSmallIndels(!1),e.setHideLargeIndels(!1)}},{label:"Show mismatches and large indels+clipping",type:"radio",checked:!e.hideMismatches&&e.hideSmallIndels&&!e.hideLargeIndels,onClick:()=>{e.setHideMismatches(!1),e.setHideSmallIndels(!0),e.setHideLargeIndels(!1)}},{label:"Show just large indels",type:"radio",checked:e.hideMismatches&&e.hideSmallIndels&&!e.hideLargeIndels,onClick:()=>{e.setHideMismatches(!0),e.setHideSmallIndels(!0),e.setHideLargeIndels(!1)}},{label:"Show none",type:"radio",checked:e.hideMismatches&&e.hideSmallIndels&&e.hideLargeIndels,onClick:()=>{e.setHideMismatches(!0),e.setHideSmallIndels(!0),e.setHideLargeIndels(!0)}}]}}const Te=(0,a.lazy)(()=>n.e(1080).then(n.bind(n,21080))),Ae=(0,a.lazy)(()=>n.e(2074).then(n.bind(n,2074))),Me=(0,a.lazy)(()=>n.e(356).then(n.bind(n,10356))),Pe=(0,a.lazy)(()=>n.e(6116).then(n.bind(n,66116))),Ie=new Map([["pileup","PileupRenderer"],["svg","SvgFeatureRenderer"]]);function Re(e){return c.types.compose(J.L,c.types.model({configuration:(0,i.AK)(e),featureHeight:c.types.maybe(c.types.number),noSpacing:c.types.maybe(c.types.boolean),fadeLikelihood:c.types.maybe(c.types.boolean),trackMaxHeight:c.types.maybe(c.types.number),colorBySetting:c.types.frozen(),filterBySetting:c.types.frozen(),jexlFilters:c.types.optional(c.types.array(c.types.string),[]),hideSmallIndelsSetting:c.types.maybe(c.types.boolean),hideMismatchesSetting:c.types.maybe(c.types.boolean),hideLargeIndelsSetting:c.types.maybe(c.types.boolean)})).volatile(()=>({colorTagMap:N.observable.map({}),featureUnderMouseVolatile:void 0,tagsReady:!1})).views(e=>({get colorBy(){return e.colorBySetting??(0,R.FI)(e,"colorBy")},get filterBy(){return e.filterBySetting??(0,R.FI)(e,"filterBy")}})).views(e=>({get autorunReady(){return!e.isMinimized&&((0,x.getContainingView)(e).initialized&&e.featureDensityStatsReadyAndRegionNotTooLarge)},get hideSmallIndels(){return e.hideSmallIndelsSetting},get hideMismatches(){return e.hideMismatchesSetting},get hideLargeIndels(){return e.hideLargeIndelsSetting}})).actions(e=>({setTagsReady(t){e.tagsReady=t},setMaxHeight(t){e.trackMaxHeight=t},setFeatureHeight(t){e.featureHeight=t},setNoSpacing(t){e.noSpacing=t},setColorScheme(t){e.colorTagMap=N.observable.map({}),e.colorBySetting={...t},t.tag&&(e.tagsReady=!1)},updateColorTagMap(t){const n=["#BBCCEE","pink","#CCDDAA","#EEEEBB","#FFCCCC","lightblue","lightgreen","tan","#CCEEFF","lightsalmon"];for(const r of t)if(!e.colorTagMap.has(r)){const t=[...e.colorTagMap.keys()].length;e.colorTagMap.set(r,n[t])}},setFeatureUnderMouse(t){e.featureUnderMouseVolatile=t},selectFeature(t){const n=(0,x.getSession)(e);if((0,U.lO)(n)){const r=n.addWidget("AlignmentsFeatureWidget","alignmentFeature",{featureData:t.toJSON(),view:(0,x.getContainingView)(e),track:(0,x.getContainingTrack)(e)});n.showWidget(r)}n.setSelection(t)},setConfig(t){e.configuration=t},setFilterBy(t){e.filterBySetting={...t}},setJexlFilters(t){e.jexlFilters=(0,c.cast)(t)},setHideSmallIndels(t){e.hideSmallIndelsSetting=t},setHideMismatches(t){e.hideMismatchesSetting=t},setHideLargeIndels(t){e.hideLargeIndelsSetting=t}})).views(e=>({async copyFeatureToClipboard(t){const{uniqueId:r,...a}=t.toJSON(),o=(0,x.getSession)(e),{default:i}=await n.e(8284).then(n.t.bind(n,88284,23));i(JSON.stringify(a,null,4)),o.notify("Copied to clipboard","success")},get rendererConfig(){const{featureHeight:t,noSpacing:n,hideSmallIndels:r,hideMismatches:a,hideLargeIndels:o,trackMaxHeight:i,rendererTypeName:s}=e,l=e.configuration.renderers?.[s];return{height:t??(0,R.QZ)(l,"height"),noSpacing:n??(0,R.QZ)(l,"noSpacing"),maxHeight:i??(0,R.QZ)(l,"maxHeight"),hideSmallIndels:r??(0,R.QZ)(l,"hideSmallIndels"),hideMismatches:a??(0,R.QZ)(l,"hideMismatches"),hideLargeIndels:o??(0,R.QZ)(l,"hideLargeIndels")}}})).views(e=>({get maxHeight(){return e.rendererConfig.maxHeight},get featureHeightSetting(){return e.rendererConfig.height},get noSpacingSetting(){return e.rendererConfig.noSpacing},get featureUnderMouse(){return e.featureUnderMouseVolatile},renderReady:()=>e.tagsReady,get filters(){return new W.A({filters:e.jexlFilters})},legendItems:t=>function(e,t){const n=e?.type;return"strand"===n?[{color:ae.pf.color_fwd_strand,label:"Forward strand"},{color:ae.pf.color_rev_strand,label:"Reverse strand"},oe]:"stranded"===n?[{color:ae.pf.color_fwd_strand,label:"First-of-pair forward"},{color:ae.pf.color_rev_strand,label:"First-of-pair reverse"},oe]:"insertSize"===n?ue:"pairOrientation"===n?de:"insertSizeAndPairOrientation"===n?pe:he(t)}(e.colorBy,t),showSubMenuItems:()=>[{label:"Show tooltips",type:"checkbox",checked:e.showTooltipsEnabled,onClick:()=>{e.setShowTooltips(!e.showTooltipsEnabled)}},{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}},Ce(e)]})).views(e=>{const{trackMenuItems:t,renderProps:n,renderingProps:r}=e;return{get rendererTypeName(){const t=(0,R.FI)(e,"defaultRendering"),n=Ie.get(t);if(!n)throw new Error(`unknown alignments view name ${t}`);return n},contextMenuItems(){const t=e.contextMenuFeature;return t?[{label:"Open feature details",icon:Q.A,onClick:()=>{e.clearFeatureSelection(),e.selectFeature(t)}},{label:"Copy info to clipboard",icon:K.A,onClick:()=>{e.copyFeatureToClipboard(t)}}]:[]},get DisplayBlurb(){return re},adapterRenderProps(){const{colorTagMap:t,colorBy:r,filterBy:a}=e,o=n();return{...o,notReady:o.notReady||!e.renderReady(),colorBy:r,filterBy:a,filters:e.filters,colorTagMap:Object.fromEntries(t.toJSON()),config:e.rendererConfig}},renderingProps:()=>({...r(),async onFeatureClick(t,n){const r=(0,x.getSession)(e),{rpcManager:a}=r;try{const t=n||e.featureIdUnderMouse;if(t){const n=(0,C.getRpcSessionId)(e),{feature:r}=await a.call(n,"CoreGetFeatureDetails",{featureId:t,sessionId:n,trackInstanceId:(0,x.getContainingTrack)(e).id,rendererType:"PileupRenderer",rpcDriverName:e.effectiveRpcDriverName});(0,c.isAlive)(e)&&r&&e.selectFeature(new q.A(r))}else e.clearFeatureSelection()}catch(e){console.error(e),r.notifyError(`${e}`,e)}},onClick(){e.clearFeatureSelection()},async onFeatureContextMenu(t,n){const r=(0,x.getSession)(e),{rpcManager:a}=r;try{const t=n||e.featureIdUnderMouse;if(t){const n=(0,C.getRpcSessionId)(e),{feature:r}=await a.call(n,"CoreGetFeatureDetails",{featureId:t,sessionId:n,trackInstanceId:(0,x.getContainingTrack)(e).id,rendererType:"PileupRenderer",rpcDriverName:e.effectiveRpcDriverName});r&&e.setContextMenuFeature(new q.A(r))}else e.clearFeatureSelection()}catch(e){console.error(e),r.notifyError(`${e}`,e)}}}),colorSchemeSubMenuItems:()=>[{label:"Normal",onClick:()=>{e.setColorScheme({type:"normal"})}},{label:"Mapping quality",onClick:()=>{e.setColorScheme({type:"mappingQuality"})}},{label:"Strand",onClick:()=>{e.setColorScheme({type:"strand"})}},{label:"Per-base quality",onClick:()=>{e.setColorScheme({type:"perBaseQuality"})}},{label:"Per-base lettering",onClick:()=>{e.setColorScheme({type:"perBaseLettering"})}},{label:"First-of-pair strand",onClick:()=>{e.setColorScheme({type:"stranded"})}},{label:"Color by tag...",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Ae,{model:e,handleClose:t}])}}],trackMenuItems:()=>[...t(),{label:"Set feature height...",priority:0,subMenu:[{label:"Normal",type:"radio",checked:7===e.featureHeightSetting&&!1===e.noSpacingSetting,onClick:()=>{e.setFeatureHeight(7),e.setNoSpacing(!1)}},{label:"Compact",type:"radio",checked:2===e.featureHeightSetting&&!0===e.noSpacingSetting,onClick:()=>{e.setFeatureHeight(2),e.setNoSpacing(!0)}},{label:"Super-compact",type:"radio",checked:1===e.featureHeightSetting&&!0===e.noSpacingSetting,onClick:()=>{e.setFeatureHeight(1),e.setNoSpacing(!0)}},{label:"Custom",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Me,{model:e,handleClose:t}])}}]},{label:"Show...",icon:Y.A,priority:-1,type:"subMenu",subMenu:e.showSubMenuItems()},{label:"Set max track height...",priority:-1,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Pe,{model:e,handleClose:t}])}},{label:"Filter by...",icon:X.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Te,{model:e,handleClose:t}])}}]}}).views(e=>({renderProps:()=>e.adapterRenderProps()})).actions(e=>({afterAttach(){(async()=>{const{sharedDoAfterAttach:t}=await n.e(2258).then(n.bind(n,62258));t(e)})()}})).preProcessSnapshot(e=>{if(e){const{colorBy:t,colorBySetting:n,filterBySetting:r,filterBy:a,...o}=e;return{...o,filterBySetting:r||a,colorBySetting:n||t}}return e}).postProcessSnapshot(e=>{if(!e)return e;const{trackMaxHeight:t,colorBySetting:n,filterBySetting:r,jexlFilters:a,hideSmallIndelsSetting:o,hideMismatchesSetting:i,hideLargeIndelsSetting:s,...l}=e;return{...l,...void 0!==t?{trackMaxHeight:t}:{},...void 0!==n?{colorBySetting:n}:{},...(0,H.$Q)(r)?{}:{filterBySetting:r},...a?.length?{jexlFilters:a}:{},...void 0!==o?{hideSmallIndelsSetting:o}:{},...void 0!==i?{hideMismatchesSetting:i}:{},...void 0!==s?{hideLargeIndelsSetting:s}:{}}})}var Le=n(86470);function Fe(){return c.types.model({}).volatile(()=>({visibleModifications:N.observable.map({}),simplexModifications:new Set,modificationsReady:!1})).views(e=>({get visibleModificationTypes(){return[...e.visibleModifications.keys()]}})).actions(e=>({updateVisibleModifications(t){for(const n of t)e.visibleModifications.has(n.type)||e.visibleModifications.set(n.type,{...n,color:(0,Le.rT)(n.type)})},setSimplexModifications(t){const n=e.simplexModifications;t.length===n.size&&t.every(e=>n.has(e))||(e.simplexModifications=new Set(t))},setModificationsReady(t){e.modificationsReady=t}}))}const De=(0,a.lazy)(()=>n.e(1707).then(n.bind(n,91707))),Ne=(0,a.lazy)(()=>n.e(2276).then(n.bind(n,92276))),Be=function(e){return c.types.compose("LinearPileupDisplay",Re(e),Fe(),c.types.model({type:c.types.literal("LinearPileupDisplay"),configuration:(0,i.AK)(e),showSoftClipping:!1,mismatchAlpha:c.types.maybe(c.types.boolean),sortedBy:c.types.frozen()})).volatile(()=>({sortReady:!1,currSortBpPerPx:0})).actions(e=>({setCurrSortBpPerPx(t){e.currSortBpPerPx=t},setSortReady(t){e.sortReady=t},clearSelected(){e.sortedBy=void 0},toggleSoftClipping(){e.showSoftClipping=!e.showSoftClipping},toggleMismatchAlpha(){e.mismatchAlpha=!e.mismatchAlpha},setSortedBy(t,n){const{centerLineInfo:r}=(0,x.getContainingView)(e);if(!r)return;const{refName:a,assemblyName:o,offset:i}=r,s=Math.round(i)+1;s<0||!a||(e.sortReady=!1,e.sortedBy={type:t,pos:s,refName:a,assemblyName:o,tag:n})},setSortedByAtPosition(t,n,r){const a=(0,x.getContainingView)(e).assemblyNames[0];a&&(e.sortReady=!1,e.sortedBy={type:t,pos:n+1,refName:r,assemblyName:a})},setFeatureHeight(t){e.sortReady=!1,e.featureHeight=t}})).actions(e=>{const t=e.reload;return{reload(){e.clearSelected(),t()}}}).views(e=>({get modificationThreshold(){return e.colorBy?.modifications?.threshold??10},get rendererConfig(){const{featureHeight:t,noSpacing:n,trackMaxHeight:r,mismatchAlpha:a,hideSmallIndels:o,hideMismatches:i,hideLargeIndels:s}=e,l=e.configuration.renderers?.PileupRenderer;return{height:t??(0,R.QZ)(l,"height"),noSpacing:n??(0,R.QZ)(l,"noSpacing"),maxHeight:r??(0,R.QZ)(l,"maxHeight"),mismatchAlpha:a??(0,R.QZ)(l,"mismatchAlpha"),hideSmallIndels:o??(0,R.QZ)(l,"hideSmallIndels"),hideMismatches:i??(0,R.QZ)(l,"hideMismatches"),hideLargeIndels:s??(0,R.QZ)(l,"hideLargeIndels")}}})).views(e=>{const{renderReady:t}=e;return{get mismatchAlphaSetting(){return e.rendererConfig.mismatchAlpha},renderReady(){const n=(0,x.getContainingView)(e);return e.modificationsReady&&e.currSortBpPerPx===n.bpPerPx&&t()}}}).views(e=>{const{trackMenuItems:t,adapterRenderProps:n,renderProps:r,colorSchemeSubMenuItems:a,showSubMenuItems:o}=e;return{adapterRenderProps(){const{sortedBy:t,showSoftClipping:r,visibleModifications:a,simplexModifications:o}=e;return{...n(),showSoftClip:r,sortedBy:t,visibleModifications:Object.fromEntries(a.toJSON()),simplexModifications:[...o]}},renderProps(){const{sortReady:t}=e,n=r();return{...n,notReady:n.notReady||!t}},showSubMenuItems:()=>[...o(),{label:"Show soft clipping",type:"checkbox",checked:e.showSoftClipping,onClick:()=>{e.toggleSoftClipping(),e.showSoftClipping&&e.clearSelected()}},{label:"Show mismatches faded by quality",type:"checkbox",checked:e.mismatchAlphaSetting,onClick:()=>{e.toggleMismatchAlpha()}}],trackMenuItems:()=>[...t(),{label:"Sort by...",icon:$.A,disabled:e.showSoftClipping,subMenu:[...["Start location","Read strand","Base pair"].map(t=>({label:t,onClick:()=>{e.setSortedBy(t)}})),{label:"Sort by tag...",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[De,{model:e,handleClose:t}])}},{label:"Clear sort",onClick:()=>{e.clearSelected()}}]},{label:"Color by...",icon:O.A,subMenu:[{label:"Pair orientation",onClick:()=>{e.setColorScheme({type:"pairOrientation"})}},{label:"Modifications",type:"subMenu",subMenu:we(e,{includeMethylation:!0})},{label:"Insert size",onClick:()=>{e.setColorScheme({type:"insertSize"})}},...a()]},{label:"Group by...",icon:G.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Ne,{model:e,handleClose:t}])}}]}}).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttach:t}=await n.e(8089).then(n.bind(n,8089));t(e)}catch(t){(0,x.getSession)(e).notifyError(`${t}`,t),console.error(t)}})()}})).postProcessSnapshot(e=>{if(!e)return e;const{showSoftClipping:t,mismatchAlpha:n,sortedBy:r,...a}=e;return{...a,...t?{showSoftClipping:t}:{},...void 0!==n?{mismatchAlpha:n}:{},...void 0!==r?{sortedBy:r}:{}}})};function Ee(e){e.addDisplayType(()=>{const t=_(e);return new P.A({name:"LinearPileupDisplay",displayName:"Pileup display",helpText:"Display stacked aligned reads showing exact placement and sequences relative to the reference genome",configSchema:t,stateModel:Be(t),subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:z.Ay})})}const Ve=function(e){return(0,i.S7)("LinearReadArcsDisplay",{maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},lineWidth:{type:"number",description:"set arc line width",defaultValue:1},jitter:{type:"number",description:"jitters the x position so e.g. if many reads map to exact same x position, jittering makes it easy to see that there are many of them",defaultValue:0},colorBy:{type:"frozen",defaultValue:{type:"insertSizeAndOrientation"}},filterBy:{type:"frozen",defaultValue:H.JD}},{baseConfiguration:(0,j.A)(e),explicitlyTyped:!0})};var ze=n(34588),je=n(27768),He=n(52901);function _e(){return c.types.model("NonBlockCanvasDisplayMixin",{}).volatile(()=>({loading:!1,lastDrawnOffsetPx:void 0,ref:null,renderingImageData:void 0,renderingStopToken:void 0,statusMessage:void 0})).views(e=>({get drawn(){return void 0!==e.lastDrawnOffsetPx}})).actions(e=>({setLastDrawnOffsetPx(t){e.lastDrawnOffsetPx=t},setLoading(t){e.loading=t},setRef(t){e.ref=t},setRenderingImageData(t){e.renderingImageData=t},setRenderingStopToken(t){e.renderingStopToken=t},setStatusMessage(t){e.statusMessage=t}})).actions(e=>({beforeDestroy(){e.renderingStopToken&&(0,He.CF)(e.renderingStopToken)}}))}function Oe(){return c.types.compose("LinearReadDisplayBaseMixin",_e(),c.types.model({filterBySetting:c.types.frozen(),colorBySetting:c.types.frozen()}).volatile(()=>({chainData:void 0,lastDrawnBpPerPx:0})).actions(e=>({setLastDrawnBpPerPx(t){e.lastDrawnBpPerPx=t},setColorScheme(t){e.colorBySetting={...t}},setChainData(t){e.chainData=t},setFilterBy(t){e.filterBySetting={...t}}})))}var $e=n(3231);const Ge=function(e){return c.types.compose("LinearReadArcsDisplay",L.q,(0,ze.A)(),(0,je.A)(),Oe(),c.types.model("LinearReadArcsDisplaySettingsMixin",{lineWidth:c.types.maybe(c.types.number),jitter:c.types.maybe(c.types.number),drawInter:!0,drawLongRange:!0}).actions(e=>({setDrawInter(t){e.drawInter=t},setDrawLongRange(t){e.drawLongRange=t},setLineWidth(t){e.lineWidth=t},setJitter(t){e.jitter=t}})).views(e=>({get lineWidthSetting(){return e.lineWidth??(0,R.FI)(e,"lineWidth")},get jitterVal(){return e.jitter??(0,R.FI)(e,"jitter")}})),c.types.model({type:c.types.literal("LinearReadArcsDisplay"),configuration:(0,i.AK)(e),showLegend:c.types.maybe(c.types.boolean)})).views(e=>({get colorBy(){return e.colorBySetting??(0,R.FI)(e,"colorBy")},get filterBy(){return e.filterBySetting??(0,R.FI)(e,"filterBy")}})).actions(e=>({setShowLegend(t){e.showLegend=t},reload(){e.error=void 0}})).views(e=>({legendItems:()=>ge(e.colorBy),svgLegendWidth(){return e.showLegend?(0,$e.S)(this.legendItems()):0}})).views(e=>{const{trackMenuItems:t,renderProps:r}=e;return{renderProps:()=>({...r(),notReady:!1,filterBy:e.filterBy,colorBy:e.colorBy,drawInter:e.drawInter,drawLongRange:e.drawLongRange,lineWidth:e.lineWidthSetting,jitter:e.jitterVal,height:e.height}),trackMenuItems:()=>[...t(),ke(e),{label:"Line width",subMenu:[{label:"Thin",onClick:()=>{e.setLineWidth(1)}},{label:"Bold",onClick:()=>{e.setLineWidth(2)}},{label:"Extra bold",onClick:()=>{e.setLineWidth(5)}}]},{label:"Jitter x-positions",subMenu:[{type:"checkbox",checked:0===e.jitterVal,label:"None",onClick:()=>{e.setJitter(0)}},{type:"checkbox",checked:2===e.jitterVal,label:"Small",onClick:()=>{e.setJitter(2)}},{type:"checkbox",checked:10===e.jitterVal,label:"Large",onClick:()=>{e.setJitter(10)}}]},{label:"Show...",type:"subMenu",subMenu:[{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}},{label:"Inter-chromosomal connections (purple vertical lines)",type:"checkbox",checked:e.drawInter,onClick:()=>{e.setDrawInter(!e.drawInter)}},{label:"Long range connections (red vertical lines)",type:"checkbox",checked:e.drawLongRange,onClick:()=>{e.setDrawLongRange(!e.drawLongRange)}}]},Se(e)],async renderSvg(t){const{renderSvg:r}=await n.e(5993).then(n.bind(n,95993));return r(e,t)}}}).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttachRPC:t}=await n.e(8937).then(n.bind(n,68937));t(e)}catch(t){console.error(t),e.setError(t)}})()}})).postProcessSnapshot(e=>{if(!e)return e;const{lineWidth:t,jitter:n,drawInter:r,drawLongRange:a,showLegend:o,...i}=e;return{...i,...void 0!==t?{lineWidth:t}:{},...void 0!==n?{jitter:n}:{},...r?{}:{drawInter:r},...a?{}:{drawLongRange:a},...void 0!==o?{showLegend:o}:{}}})};function We(e){e.addDisplayType(()=>{const t=Ve(e);return new P.A({name:"LinearReadArcsDisplay",displayName:"Read arc display",helpText:"Connect paired end reads and long split reads using arcs",configSchema:t,stateModel:Ge(t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9011),n.e(3958)]).then(n.bind(n,3958)))})})}const Ue=function(e){return(0,i.S7)("LinearReadCloudDisplay",{minSubfeatureWidth:{type:"number",defaultValue:1},maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view",defaultValue:5},featureHeight:{type:"number",defaultValue:7},hideSmallIndels:{type:"boolean",defaultValue:!1},hideMismatches:{type:"boolean",defaultValue:!1},hideLargeIndels:{type:"boolean",defaultValue:!1},colorBy:{type:"frozen",defaultValue:{type:"insertSizeAndOrientation"}},filterBy:{type:"frozen",defaultValue:H.JD}},{baseConfiguration:(0,j.A)(e),explicitlyTyped:!0})};var qe=n(14050);const Je=(0,a.lazy)(()=>n.e(8995).then(n.bind(n,48995))),Xe=function(e){return c.types.compose("LinearReadCloudDisplay",L.q,(0,ze.A)(),(0,je.A)(),Oe(),c.types.model("LinearReadDisplayWithLayoutMixin",{}).volatile(()=>({featureLayout:void 0,mouseoverRef:null,featuresForFlatbush:[],mismatchLayout:void 0,mismatchItems:[]})).actions(e=>({setFeatureLayout(t){e.featureLayout=t},setMouseoverRef(t){e.mouseoverRef=t},setFeaturesForFlatbush(t){e.featuresForFlatbush=t},setMismatchLayout(t){e.mismatchLayout=t},setMismatchItems(t){e.mismatchItems=t}})),c.types.model("LinearReadDisplayWithPairFiltersMixin",{drawSingletons:!0,drawProperPairs:!0,flipStrandLongReadChains:!0,featureHeight:c.types.maybe(c.types.number)}).actions(e=>({setDrawSingletons(t){e.drawSingletons=t},setDrawProperPairs(t){e.drawProperPairs=t},setFlipStrandLongReadChains(t){e.flipStrandLongReadChains=t},setFeatureHeight(t){e.featureHeight=t}})),Fe(),c.types.model({type:c.types.literal("LinearReadCloudDisplay"),configuration:(0,i.AK)(e),drawCloud:!1,noSpacing:c.types.maybe(c.types.boolean),trackMaxHeight:c.types.maybe(c.types.number),hideSmallIndelsSetting:c.types.maybe(c.types.boolean),hideMismatchesSetting:c.types.maybe(c.types.boolean),hideLargeIndelsSetting:c.types.maybe(c.types.boolean),showLegend:c.types.maybe(c.types.boolean),showYScalebar:c.types.optional(c.types.boolean,!0),showOutline:c.types.optional(c.types.boolean,!0)})).volatile(()=>({layoutHeight:0,selectedFeatureId:void 0,cloudMaxDistance:void 0})).views(e=>({get colorBy(){return e.colorBySetting??(0,R.FI)(e,"colorBy")},get filterBy(){return e.filterBySetting??(0,R.FI)(e,"filterBy")}})).actions(e=>({reload(){e.error=void 0}})).views(e=>({get dataTestId(){return e.drawCloud?"cloud-canvas":"stack-canvas"},get featureHeightSetting(){return e.featureHeight??(0,R.FI)(e,"featureHeight")},get hideSmallIndels(){return e.hideSmallIndelsSetting??(0,R.FI)(e,"hideSmallIndels")},get hideMismatches(){return e.hideMismatchesSetting??(0,R.FI)(e,"hideMismatches")},get hideLargeIndels(){return e.hideLargeIndelsSetting??(0,R.FI)(e,"hideLargeIndels")}})).views(e=>({get modificationThreshold(){return e.colorBy?.modifications?.threshold??10},get cloudDomain(){if(void 0!==e.cloudMaxDistance)return[1,e.cloudMaxDistance]}})).views(e=>({get cloudTicks(){if(e.drawCloud&&e.cloudDomain&&e.showYScalebar)return(0,qe.og)(e.cloudDomain,e.height)}})).actions(e=>({setNoSpacing(t){e.noSpacing=t},setMaxHeight(t){e.trackMaxHeight=t},setLayoutHeight(t){e.layoutHeight=t},setCloudMaxDistance(t){(void 0===e.cloudMaxDistance||Math.abs(e.cloudMaxDistance-t)>1e-6)&&(e.cloudMaxDistance=t)},setShowYScalebar(t){e.showYScalebar=t},setShowOutline(t){e.showOutline=t},selectFeature(t){const n=(0,x.getSession)(e),r=function(e){if(0===e.length)throw new Error("Chain cannot be empty");const t=e[0];return new q.A({uniqueId:t.id,id:t.id,name:t.name,refName:t.refName,start:Math.min(...e.map(e=>e.start)),end:Math.max(...e.map(e=>e.end)),strand:t.strand,flags:t.flags,tlen:t.tlen,pair_orientation:t.pair_orientation,clipLengthAtStartOfRead:t.clipLengthAtStartOfRead,...t.next_ref&&{next_ref:t.next_ref},...void 0!==t.next_pos&&{next_pos:t.next_pos},...t.SA&&{SA:t.SA},subfeatures:e.map((e,t)=>({uniqueId:`${e.id}_${t}`,id:`${e.id}_${t}`,name:e.name,refName:e.refName,start:e.start,end:e.end,strand:e.strand,type:"alignment_part",flags:e.flags,tlen:e.tlen,pair_orientation:e.pair_orientation,clipLengthAtStartOfRead:e.clipLengthAtStartOfRead,...e.next_ref&&{next_ref:e.next_ref},...void 0!==e.next_pos&&{next_pos:e.next_pos},...e.SA&&{SA:e.SA}}))})}(t);if((0,U.lO)(n)){const t=n.addWidget("BaseFeatureWidget","baseFeature",{featureData:r.toJSON(),view:(0,x.getContainingView)(e),track:(0,x.getContainingTrack)(e)});n.showWidget(t)}n.setSelection(r)},setDrawCloud(t){e.drawCloud=t},setSelectedFeatureId(t){e.selectedFeatureId=t},setHideSmallIndels(t){e.hideSmallIndelsSetting=t},setHideMismatches(t){e.hideMismatchesSetting=t},setHideLargeIndels(t){e.hideLargeIndelsSetting=t},setShowLegend(t){e.showLegend=t}})).views(e=>({legendItems:()=>ge(e.colorBy,e.visibleModifications),svgLegendWidth(){return e.showLegend?(0,$e.S)(this.legendItems()):0}})).views(e=>{const{trackMenuItems:t,renderProps:r}=e;return{renderProps:()=>({...r(),notReady:!1,filterBy:e.filterBy,colorBy:e.colorBy,featureHeight:e.featureHeightSetting,noSpacing:e.noSpacing??!1,drawCloud:e.drawCloud,drawSingletons:e.drawSingletons,drawProperPairs:e.drawProperPairs,flipStrandLongReadChains:e.flipStrandLongReadChains,trackMaxHeight:e.trackMaxHeight,hideSmallIndels:e.hideSmallIndels,hideMismatches:e.hideMismatches,hideLargeIndels:e.hideLargeIndels,showOutline:e.showOutline,cloudDomain:e.cloudDomain,visibleModifications:Object.fromEntries(e.visibleModifications.toJSON())}),trackMenuItems:()=>[...t(),{label:"Set feature height...",subMenu:[{label:"Normal",type:"radio",checked:7===e.featureHeightSetting&&!0!==e.noSpacing,onClick:()=>{e.setFeatureHeight(7),e.setNoSpacing(!1)}},{label:"Compact",type:"radio",checked:3===e.featureHeightSetting&&!0===e.noSpacing,onClick:()=>{e.setFeatureHeight(3),e.setNoSpacing(!0)}},{label:"Super-compact",type:"radio",checked:1===e.featureHeightSetting&&!0===e.noSpacing,onClick:()=>{e.setFeatureHeight(1),e.setNoSpacing(!0)}},{label:"Manually set height...",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Je,{model:e,handleClose:t}])}}]},{label:"Show...",icon:Y.A,type:"subMenu",subMenu:[{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}},{label:"Show as 'read cloud' (paired-end reads)",type:"checkbox",helpText:"In read cloud mode, the y-coordinate of paired-end reads is proportional to insert size (TLEN). This mode is designed for paired-end short reads; long reads will appear at y=0.",checked:e.drawCloud,onClick:()=>{e.setDrawCloud(!e.drawCloud)}},{label:"Show y-scalebar",type:"checkbox",helpText:"Show insert size scale on the y-axis (only visible in cloud mode)",checked:e.showYScalebar,onClick:()=>{e.setShowYScalebar(!e.showYScalebar)}},{label:"Show read strand relative to primary",helpText:"This makes all the reads draw their strand relative to the primary alignment, which can be helpful in seeing patterns of flipping orientation in split long-read alignments",type:"checkbox",checked:e.flipStrandLongReadChains,onClick:()=>{e.setFlipStrandLongReadChains(!e.flipStrandLongReadChains)}},{label:"Show outline",helpText:"Draw an outline around each read",type:"checkbox",checked:e.showOutline,onClick:()=>{e.setShowOutline(!e.showOutline)}},Ce(e)]},xe(e),Se(e)],async renderSvg(t){const{renderSvg:r}=await n.e(7561).then(n.bind(n,57561));return r(e,t)}}}).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttachRPC:t}=await Promise.all([n.e(8781),n.e(3962),n.e(5561)]).then(n.bind(n,55561));t(e)}catch(t){console.error(t),e.setError(t)}})()}})).postProcessSnapshot(e=>{if(!e)return e;const{drawCloud:t,noSpacing:n,trackMaxHeight:r,showLegend:a,showOutline:o,hideSmallIndelsSetting:i,hideMismatchesSetting:s,hideLargeIndelsSetting:l,...c}=e;return{...c,...t?{drawCloud:t}:{},...void 0!==n?{noSpacing:n}:{},...void 0!==r?{trackMaxHeight:r}:{},...void 0!==a?{showLegend:a}:{},...o?{}:{showOutline:o},...void 0!==i?{hideSmallIndelsSetting:i}:{},...void 0!==s?{hideMismatchesSetting:s}:{},...void 0!==l?{hideLargeIndelsSetting:l}:{}}})};function Ke(e){e.addDisplayType(()=>{const t=Ue(e);return new P.A({name:"LinearReadCloudDisplay",displayName:"Linked reads display",helpText:'Display paired-end and split read (supplementary read) alignments as linked entities. Note that the concept of "linked reads" is not specifically referring to Chromium 10x linked reads, this is just the general idea of linking paired-end, and split (supplementary) alignments',configSchema:t,stateModel:Xe(t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",subDisplay:{type:"LinearAlignmentsDisplay",lowerPanel:!0},ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9011),n.e(3046)]).then(n.bind(n,3046)))})})}var Qe=n(74691),Ye=n(57399),Ze=n(77346);const et=(0,a.lazy)(()=>n.e(853).then(n.bind(n,10853))),tt=(0,a.lazy)(()=>n.e(8942).then(n.bind(n,8942))),nt=new Map([["snpcoverage","SNPCoverageRenderer"]]),rt=function(e,t){return c.types.compose("LinearSNPCoverageDisplay",(0,Qe.A)(e,t),Fe(),c.types.model({type:c.types.literal("LinearSNPCoverageDisplay"),showInterbaseCounts:c.types.maybe(c.types.boolean),showInterbaseIndicators:c.types.maybe(c.types.boolean),showArcs:c.types.maybe(c.types.boolean),minArcScore:c.types.optional(c.types.number,0),filterBySetting:c.types.frozen(),colorBySetting:c.types.frozen(),jexlFilters:c.types.optional(c.types.array(c.types.string),[])})).views(e=>({get colorBy(){return e.colorBySetting??(0,R.FI)(e,"colorBy")},get filterBy(){return e.filterBySetting??(0,R.FI)(e,"filterBy")}})).actions(e=>({setConfig(t){e.configuration=t},setFilterBy(t){e.filterBySetting={...t}},setColorScheme(t){e.colorBySetting=t?{...t}:void 0},setJexlFilters(t){e.jexlFilters=(0,c.cast)(t)}})).views(e=>{const{adapterProps:t}=e;return{get modificationThreshold(){return e.colorBy?.modifications?.threshold??10},get rendererConfig(){const{showArcs:t,showInterbaseCounts:n,showInterbaseIndicators:r}=e,a=e.configuration.renderers?.[e.rendererTypeName];return{showInterbaseCounts:n??(0,R.QZ)(a,"showInterbaseCounts"),showInterbaseIndicators:r??(0,R.QZ)(a,"showInterbaseIndicators"),showArcs:t??(0,R.QZ)(a,"showArcs")}},get showArcsSetting(){return this.rendererConfig.showArcs},get skipFeatures(){if(!this.showArcsSetting)return[];const{minArcScore:t}=e,n=new Map;for(const r of e.blockState.values())if(r.features)for(const e of r.features.values())"skip"===e.get("type")&&(e.get("score")??1)>=t&&n.set(e.id(),e);return[...n.values()]},get showInterbaseCountsSetting(){return this.rendererConfig.showInterbaseCounts},get showInterbaseIndicatorsSetting(){return this.rendererConfig.showInterbaseIndicators},get autorunReady(){return(0,x.getContainingView)(e).initialized&&e.featureDensityStatsReadyAndRegionNotTooLarge&&!e.error},adapterProps(){const n=t(),{filters:r,filterBy:a}=e;return{...n,filters:r,filterBy:a,modificationThreshold:this.modificationThreshold}}}}).actions(e=>({setShowInterbaseIndicators(t){e.showInterbaseIndicators=t},setShowInterbaseCounts(t){e.showInterbaseCounts=t},setShowArcs(t){e.showArcs=t},setMinArcScore(t){e.minArcScore=t}})).actions(e=>({afterAttach(){(0,Le.vi)(e,async()=>{if(e.setModificationsReady(!1),!e.autorunReady)return;const t=(0,x.getContainingView)(e),{staticBlocks:n}=t,{colorBy:r}=e;if("modifications"===r?.type){const{modifications:t,simplexModifications:r}=await(0,Ze.D)({model:e,adapterConfig:(0,R.FI)(e.parentTrack,"adapter"),blocks:n});(0,c.isAlive)(e)&&(e.updateVisibleModifications(t),e.setSimplexModifications(r),e.setModificationsReady(!0))}else e.setModificationsReady(!0)},{delay:1e3})}})).views(e=>{const{renderProps:t,renderingProps:r,renderSvg:a,wiggleBaseTrackMenuItems:o}=e;return{renderReady:()=>!t().notReady&&e.modificationsReady,renderProps(){const{colorBy:n,visibleModifications:r,simplexModifications:a}=e;return{...t(),notReady:!this.renderReady(),colorBy:n,visibleModifications:Object.fromEntries(r.toJSON()),simplexModifications:[...a]}},renderingProps:()=>({...r(),displayModel:e}),async renderSvg(t){const{renderSNPCoverageSvg:r}=await n.e(8628).then(n.bind(n,58628));return r(e,t,a)},get TooltipComponent(){return et},get adapterConfig(){const t=(0,R.FI)(e.parentTrack,"adapter"),n=(0,x.getContainingView)(e),r=(0,x.getSession)(e),{assemblyManager:a}=r,o=n.assemblyNames[0],i=o?a.get(o):void 0,s=i?.configuration?.sequence?.adapter;return{type:"SNPCoverageAdapter",subadapter:t,sequenceAdapter:s?(0,c.getSnapshot)(s):void 0}},get rendererTypeName(){return nt.get("snpcoverage")},get graphType(){return!0},contextMenuItems:()=>[],trackMenuItems:()=>[...o(),{label:"Show...",icon:Y.A,type:"subMenu",subMenu:[{label:"Show tooltips",type:"checkbox",checked:e.showTooltipsEnabled,onClick:()=>{e.setShowTooltips(!e.showTooltipsEnabled)}},{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}},{label:"Insertion/clipping indicators",type:"checkbox",checked:e.showInterbaseIndicatorsSetting,onClick:()=>{e.setShowInterbaseIndicators(!e.showInterbaseIndicatorsSetting)}},{label:"Insertion/clipping counts",type:"checkbox",checked:e.showInterbaseCountsSetting,onClick:()=>{e.setShowInterbaseCounts(!e.showInterbaseCountsSetting)}},{label:"Sashimi arcs",type:"checkbox",checked:e.showArcsSetting,onClick:()=>{e.setShowArcs(!e.showArcsSetting)}}]},{label:"Filter arcs by score...",icon:Ye.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[tt,{model:e,handleClose:t}])}}],get filters(){return new W.A({filters:e.jexlFilters})},legendItems:t=>function(e,t,n){if("methylation"===e?.type)return[{color:"red",label:"CpG methylated"},{color:"blue",label:"CpG unmethylated"}];if("modifications"===e?.type){const e=[];for(const[n,r]of t.entries())e.push({color:r.color,label:n});return e}return he(n)}(e.colorBy,e.visibleModifications,t)}}).preProcessSnapshot(e=>{if(e){const{colorBy:t,colorBySetting:n,filterBySetting:r,filterBy:a,...o}=e;return{...o,filterBySetting:r||a,colorBySetting:n||t}}return e}).postProcessSnapshot(e=>{if(!e)return e;const{showInterbaseCounts:t,showInterbaseIndicators:n,showArcs:r,minArcScore:a,filterBySetting:o,colorBySetting:i,jexlFilters:s,...l}=e;return{...l,...void 0!==t?{showInterbaseCounts:t}:{},...void 0!==n?{showInterbaseIndicators:n}:{},...void 0!==r?{showArcs:r}:{},...a?{minArcScore:a}:{},...(0,H.$Q)(o)?{}:{filterBySetting:o},...void 0!==i?{colorBySetting:i}:{},...s?.length?{jexlFilters:s}:{}}})};function at(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearSNPCoverageDisplay",{autoscale:{type:"stringEnum",defaultValue:"local",model:c.types.enumeration("Autoscale type",["local"]),description:"performs local autoscaling (no other options for SNP Coverage available)"},minScore:{type:"number",defaultValue:Number.MIN_VALUE,description:"minimum value for the y-scale"},maxScore:{type:"number",description:"maximum value for the y-scale",defaultValue:Number.MAX_VALUE},scaleType:{type:"stringEnum",model:c.types.enumeration("Scale type",["linear","log"]),description:"The type of scale to use",defaultValue:"linear"},inverted:{type:"boolean",description:"draw upside down",defaultValue:!1},multiTicks:{type:"boolean",description:"Display multiple values for the ticks",defaultValue:!1},renderers:(0,i.S7)("RenderersConfiguration",{SNPCoverageRenderer:e.getRendererType("SNPCoverageRenderer").configSchema}),colorBy:{type:"frozen",description:"color scheme to use",defaultValue:{type:"normal"}},filterBy:{type:"frozen",description:"default filters to use",defaultValue:H.JD}},{baseConfiguration:I.A,explicitlyTyped:!0})}(e);return new P.A({name:"LinearSNPCoverageDisplay",displayName:"SNPCoverage display",helpText:"Display coverage histogram and SNP composition for each genomic position",configSchema:t,stateModel:rt(e,t),trackType:"AlignmentsTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>n.e(2617).then(n.bind(n,72617)))})})}var ot=n(38433),it=n(96852),st=n(10596),lt=n(74603);class ct extends lt.A{async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n?.session?.assemblyManager;if(!r)throw new Error("no assembly manager available");const a=await(0,x.renameRegionsIfNeeded)(r,e);return super.serializeArguments(a,t)}}class dt extends ct{name="PileupGetGlobalValueForTag";async execute(e,t){const n=await this.deserializeArguments(e,t),{adapterConfig:r,sessionId:a,regions:o,tag:i}=n,s=(await(0,ot.cK)(this.pluginManager,a,r)).dataAdapter.getFeaturesInMultipleRegions(o,n),l=await(0,it._)(s.pipe((0,st.$)()));return[...new Set(l.map(e=>e.get("tags")?.[i]).filter(e=>void 0!==e).map(e=>`${e}`))]}}var ut=n(36412);function pt(e){const t=[],n=e.split(";");for(let e=0,r=n.length;e<r;e++){const r=n[e];if(""===r)continue;const a=r.split(",")[0],o=ut.k.exec(a);if(!o)throw new Error(`bad format for MM tag: "${r}"`);const i=o[1],s=o[2],l=o[3].split(/(\d+|.)/);for(let e=0,n=l.length;e<n;e++){const n=l[e];""!==n&&t.push({type:n,base:i,strand:s})}}return t}class ht extends ct{name="PileupGetVisibleModifications";async execute(e,t){const n=await this.deserializeArguments(e,t),{adapterConfig:r,sessionId:a,regions:o}=n,i=(await(0,ot.cK)(this.pluginManager,a,r)).dataAdapter,s=await(0,it._)(i.getFeaturesInMultipleRegions(o,n).pipe((0,st.$)())),l=new Map;for(const e of s){const t=(0,Le.c$)(e,"MM","Mm");for(const e of pt("string"==typeof t?t:"")){const t=`${e.base}${e.strand}${e.type}`;l.has(t)||l.set(t,e)}}const c=[...l.values()],d=function(e){const t=new Set,n=new Set;for(const n of e){const e=n;"-"===e.strand&&t.add(e.type)}for(const r of e){const e=r;"+"!==e.strand||t.has(e.type)||n.add(e.type)}return n}(c),u=new Map;for(const e of c)u.has(e.type)||u.set(e.type,e);return{modifications:[...u.values()],simplexModifications:[...d]}}}function gt(e){e.addRpcMethod(()=>new dt(e)),e.addRpcMethod(()=>new ht(e))}var mt=n(63531),ft=n(40704),yt=n(16876),bt=n(26931),wt=n(14800),vt=n(45089);class St{constructor(e){this.props=e}update(e){return this.props=e,this}makeLayout(){const e=(0,R.QZ)(this.props.config,"noSpacing"),t=(0,R.QZ)(this.props.config,"height"),n=(0,R.QZ)(this.props.config,"maxHeight");return new wt.A(vt.A,{featureHeight:t,spacing:e?0:2,maxHeight:n})}cachedLayoutIsValid(e){return e.props.bpPerPx===this.props.bpPerPx&&D()((0,R.QZ)(this.props.config),(0,R.QZ)(e.props.config))&&D()(this.props.filters,e.props.filters)&&this.props.showSoftClip===e.props.showSoftClip&&D()(this.props.sortedBy,e.props.sortedBy)&&D()(this.props.filterBy,e.props.filterBy)}get layout(){return this.cachedLayout&&this.cachedLayoutIsValid(this.cachedLayout)||(this.cachedLayout={layout:this.makeLayout(),props:this.props}),this.cachedLayout.layout}}class kt extends mt.default{supportsSVG=!0;getExpandedRegion(e,t){const{config:n,showSoftClip:r}=t,a=(0,R.QZ)(n,"maxClippingSize"),o=r?Math.round(a):0;return(0,ft.T)(e,o)}async render(e){const{statusCallback:t=()=>{},regions:r,bpPerPx:a}=e,o=r[0],i=(o.end-o.start)/a,s=await this.getFeatures(e),l=this.createLayoutInWorker(e),{makeImageData:c}=await Promise.all([n.e(8781),n.e(8955)]).then(n.bind(n,48955)),{result:d,height:u,featureNames:p}=await(0,x.updateStatus)("Rendering alignments",t,()=>c({width:i,renderArgs:{...e,layout:l,features:s},pluginManager:this.pluginManager})),h=this.serializeLayout(l,e);return(0,yt.lk)({...d,featureNames:p,layout:h,height:u,width:i,maxHeightReached:l.maxHeightReached},(0,bt.X)(d))}createLayoutSession(e){return new St(e)}}const xt=(0,i.S7)("PileupRenderer",{color:{type:"color",description:"the color of each feature in a pileup alignment",defaultValue:"#f0f",contextVariable:["feature"]},orientationType:{type:"stringEnum",model:c.types.enumeration("orientationType",["fr","rf","ff"]),defaultValue:"fr",description:'read sequencer orientation. fr is normal "reads pointing at each other ---\x3e <--- while some other sequencers can use other options'},displayMode:{type:"stringEnum",model:c.types.enumeration("displayMode",["normal","compact","collapse"]),description:"Alternative display modes",defaultValue:"normal"},minSubfeatureWidth:{type:"number",description:"the minimum width in px for a pileup mismatch feature. use for increasing/decreasing mismatch marker widths when zoomed out, e.g. 0 or 1",defaultValue:1},hideSmallIndels:{type:"boolean",description:"Hides small indels, sometimes occurring in long read sequencing",defaultValue:!1},hideMismatches:{type:"boolean",description:"Hides SNP mismatches",defaultValue:!1},hideLargeIndels:{type:"boolean",description:"Hides large indels (>=10bp)",defaultValue:!1},maxHeight:{type:"integer",description:"the maximum height to be used in a pileup rendering",defaultValue:1200},maxClippingSize:{type:"integer",description:"the max clip size to be used in a pileup rendering",defaultValue:1e4},height:{type:"number",description:"the height of each feature in a pileup alignment",defaultValue:7,contextVariable:["feature"]},noSpacing:{type:"boolean",description:"remove spacing between features",defaultValue:!1},largeInsertionIndicatorScale:{type:"number",description:"scale at which to draw the large insertion indicators (bp/pixel)",defaultValue:10},mismatchAlpha:{type:"boolean",defaultValue:!1,description:"Fade low quality mismatches"}},{explicitlyTyped:!0});function Ct(e){e.addRendererType(()=>new kt({name:"PileupRenderer",displayName:"Pileup renderer",ReactComponent:(0,a.lazy)(()=>n.e(6809).then(n.bind(n,26809))),configSchema:xt,pluginManager:e}))}class Tt extends lt.A{name="RenderLinearReadArcsDisplay";deserializeArguments(e,t){return{...e,config:Ve(this.pluginManager).create(e.config,{pluginManager:this.pluginManager})}}async renameRegionsIfNeeded(e){const t=this.pluginManager.rootModel?.session?.assemblyManager;if(!t)throw new Error("no assembly manager");const{view:n,sessionId:r,adapterConfig:a}=e,{displayedRegions:o}=n;if(!o.length)return e;const i=await(0,x.renameRegionsIfNeeded)(t,{sessionId:r,adapterConfig:a,regions:o});return{...e,view:{...n,displayedRegions:i.regions}}}async serializeArguments(e,t){const n=await this.renameRegionsIfNeeded(e);return super.serializeArguments(n,t)}async execute(e,t){const r=await this.deserializeArguments(e,t),{executeRenderLinearReadArcsDisplay:a}=await n.e(3928).then(n.bind(n,43928));return a({pluginManager:this.pluginManager,args:r})}}function At(e){e.addRpcMethod(()=>new Tt(e))}class Mt extends lt.A{name="RenderLinearReadCloudDisplay";async renameRegionsIfNeeded(e){const t=this.pluginManager.rootModel?.session?.assemblyManager;if(!t)throw new Error("no assembly manager");const{view:n,sessionId:r,adapterConfig:a}=e,{displayedRegions:o}=n;if(!o.length)return e;const i=await(0,x.renameRegionsIfNeeded)(t,{sessionId:r,adapterConfig:a,regions:o});return{...e,view:{...n,displayedRegions:i.regions}}}deserializeArguments(e,t){return{...e,config:Ue(this.pluginManager).create(e.config,{pluginManager:this.pluginManager})}}async serializeArguments(e,t){const n=await this.renameRegionsIfNeeded(e);return super.serializeArguments(n,t)}async execute(e,t){const r=await this.deserializeArguments(e,t),{executeRenderLinearReadCloudDisplay:a}=await Promise.all([n.e(8781),n.e(3962),n.e(423)]).then(n.bind(n,80423));return a({pluginManager:this.pluginManager,args:r})}}function Pt(e){e.addRpcMethod(()=>new Mt(e))}const It=(0,i.S7)("SNPCoverageAdapter",{subadapter:{type:"frozen",defaultValue:null},sequenceAdapter:{type:"frozen",defaultValue:null}},{explicitlyTyped:!0});function Rt(e){e.addAdapterType(()=>new b.A({name:"SNPCoverageAdapter",displayName:"SNPCoverage adapter",adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(8085).then(n.bind(n,38085)).then(e=>e.default),configSchema:It}))}var Lt=n(18543);class Ft extends Lt.default{supportsSVG=!0;deserializeResultsInClient(e,t){const n=super.deserializeResultsInClient(e,t),r=(e.skipFeatures??[]).map(e=>q.A.fromJSON(e));for(const e of r)n.features.set(e.id(),e);return{...n,skipFeatures:r}}async render(e){const{sessionId:t,adapterConfig:r,regions:a}=e,o=this.pluginManager,{dataAdapter:i}=await(0,ot.cK)(o,t,r),s=a[0],l=await(0,it._)(i.getFeatures(s,e).pipe((0,st.$)())),c=new Map(l.map(e=>[e.id(),e])),{renderSNPCoverageToCanvas:d}=await n.e(2786).then(n.bind(n,82786));return d({...e,features:c})}}const Dt=(0,i.S7)("SNPCoverageRenderer",{clipColor:{type:"color",description:"the color of the clipping marker",defaultValue:"red"},indicatorThreshold:{type:"number",description:"the proportion of reads containing a insertion/clip indicator",defaultValue:.4},showArcs:{type:"boolean",description:"Draw sashimi-style arcs for intron features",defaultValue:!0},showInterbaseCounts:{type:"boolean",description:'draw count "upsidedown histogram" of the interbase events that don\'t contribute to the coverage count so are not drawn in the normal histogram',defaultValue:!0},showInterbaseIndicators:{type:"boolean",description:"draw a triangular indicator where an event has been detected",defaultValue:!0},color:{type:"color",description:"Background color for the SNPCoverage renderer",defaultValue:"#d3d3d3"}},{explicitlyTyped:!0});function Nt(e){e.addRendererType(()=>new Ft({name:"SNPCoverageRenderer",ReactComponent:(0,a.lazy)(()=>n.e(9533).then(n.bind(n,69533))),configSchema:Dt,pluginManager:e}))}class Bt extends r.A{name="AlignmentsPlugin";install(e){[v,k,Ee,at,y,Rt,M,Ct,gt,At,Pt,Nt,We,Ke,V,u,T].map(t=>{t(e)})}}var Et=n(14157);class Vt extends Lt.default{}const zt=(0,i.S7)("ArcRenderer",{color:{type:"color",description:"the color of the arcs",defaultValue:"darkblue",contextVariable:["feature"]},thickness:{type:"number",description:"the thickness of the arcs",defaultValue:"jexl:logThickness(feature,'score')",contextVariable:["feature"]},label:{type:"string",description:"the label to appear at the apex of the arcs",defaultValue:"jexl:get(feature,'score')",contextVariable:["feature"]},height:{type:"number",description:"the height of the arcs",defaultValue:"jexl:log10(get(feature,'end')-get(feature,'start'))*50",contextVariable:["feature"]},caption:{type:"string",description:"the caption to appear when hovering over any point on the arcs",defaultValue:"jexl:get(feature,'name')",contextVariable:["feature"]},displayMode:{type:"enum",defaultValue:"arcs",model:c.types.enumeration("DisplayMode",["arcs","semicircles"]),description:"render semi-circles instead of arcs"}},{explicitlyTyped:!0});function jt(e){return c.types.compose("LinearArcDisplay",J.L,c.types.model({type:c.types.literal("LinearArcDisplay"),configuration:(0,i.AK)(e),displayMode:c.types.maybe(c.types.string)})).views(e=>({get blockType(){return"staticBlocks"},get renderDelay(){return 500},get rendererTypeName(){return e.configuration.renderer.type}})).views(e=>({get displayModeSetting(){return e.displayMode??(0,R.FI)(e,["renderer","displayMode"])}})).views(e=>({get rendererConfig(){return{...(0,R.FI)(e,["renderer"])||{},displayMode:e.displayModeSetting}}})).views(e=>{const{renderProps:t}=e;return{renderProps:()=>({...t(),config:e.rendererConfig,height:e.height})}}).actions(e=>({setDisplayMode(t){e.displayMode=t}})).views(e=>{const t=e.trackMenuItems;return{trackMenuItems:()=>[...t(),{label:"Display mode",subMenu:[{type:"radio",label:"Arcs",onClick:()=>{e.setDisplayMode("arcs")},checked:"arcs"===e.displayMode},{type:"radio",label:"Semi-circles",onClick:()=>{e.setDisplayMode("semicircles")},checked:"semicircles"===e.displayMode}]}]}})}function Ht(e){return c.types.compose("LinearPairedArcDisplay",L.q,(0,ze.A)(),(0,je.A)(),c.types.model({type:c.types.literal("LinearPairedArcDisplay"),configuration:(0,i.AK)(e),displayMode:c.types.maybe(c.types.string)})).volatile(()=>({lastDrawnOffsetPx:0,features:void 0,loading:!1,drawn:!0})).views(e=>({get displayModeSetting(){return e.displayMode??(0,R.FI)(e,["renderer","displayMode"])}})).actions(e=>({selectFeature(t){const n=(0,x.getSession)(e);if((0,U.lO)(n)){const r=n.addWidget("VariantFeatureWidget","variantFeature",{view:(0,x.getContainingView)(e),track:(0,x.getContainingTrack)(e),featureData:t.toJSON()});n.showWidget(r)}(0,U.mY)(n)&&n.setSelection(t)},setLoading(t){e.loading=t},setFeatures(t){e.features=t},setDisplayMode(t){e.displayMode=t}})).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttach:t}=await n.e(1456).then(n.bind(n,1456));t(e)}catch(t){console.error(t),e.setError(t)}})()},async renderSvg(t){const{renderArcSvg:r}=await Promise.all([n.e(3750),n.e(2675)]).then(n.bind(n,22675));return r(e,t)}}))}class _t extends r.A{name="ArcRenderer";install(e){!function(e){e.addRendererType(()=>new Vt({name:"ArcRenderer",ReactComponent:(0,a.lazy)(()=>n.e(9874).then(n.bind(n,29874))),configSchema:zt,pluginManager:e}))}(e),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearArcDisplay",{renderer:c.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"ArcRenderer"})},{baseConfiguration:I.A,explicitlyTyped:!0})}(e);return new P.A({name:"LinearArcDisplay",displayName:"Arc display",configSchema:t,stateModel:jt(t),trackType:"FeatureTrack",viewType:"LinearGenomeView",ReactComponent:z.Ay})})}(e),function(e){e.addDisplayType(()=>{const e=(0,i.S7)("LinearPairedArcDisplay",{color:{type:"color",description:"the color of the arcs",defaultValue:"jexl:defaultPairedArcColor(feature,alt)",contextVariable:["feature","alt"]}},{baseConfiguration:I.A,explicitlyTyped:!0});return new P.A({name:"LinearPairedArcDisplay",displayName:"Variant display arcs",helpText:"Can display arcs connecting SVs and breakends in VCF format or BEDPE pairs",configSchema:e,stateModel:Ht(e),trackType:"VariantTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(6983)]).then(n.bind(n,26983)))})})}(e),e.jexl.addFunction("logThickness",(e,t)=>Math.log(e.get(t)+1)),e.jexl.addFunction("defaultPairedArcColor",(e,t)=>t?.startsWith("<DEL")?Et.set1[0]:t?.startsWith("<DUP")?Et.set1[1]:t?.startsWith("<INV")?Et.set1[2]:t?.startsWith("<TRA")?Et.set1[3]:t?.startsWith("<CNV")?Et.set1[4]:Et.set1[6])}}var Ot=n(99697),$t=n(12197);const Gt=(0,i.S7)("OAuthInternetAccount",{tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:"Bearer"},authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:""},tokenEndpoint:{description:"the token endpoint of the internet account",type:"string",defaultValue:""},needsPKCE:{description:"boolean to indicate if the endpoint needs a PKCE code",type:"boolean",defaultValue:!1},clientId:{description:"id for the OAuth application",type:"string",defaultValue:""},scopes:{description:"optional scopes for the authorization call",type:"string",defaultValue:""},state:{description:"optional state for the authorization call",type:"string",defaultValue:""},responseType:{description:"the type of response from the authorization endpoint. can be 'token' or 'code'",type:"string",defaultValue:"code"}},{baseConfiguration:$t.y,explicitlyTyped:!0}),Wt=(0,i.S7)("DropboxOAuthInternetAccount",{authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:"https://www.dropbox.com/oauth2/authorize"},tokenEndpoint:{description:"the token endpoint of the internet account",type:"string",defaultValue:"https://api.dropbox.com/oauth2/token"},needsPKCE:{description:"boolean to indicate if the endpoint needs a PKCE code",type:"boolean",defaultValue:!0},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:["addtodropbox.com","db.tt","dropbox.com","dropboxapi.com","dropboxbusiness.com","dropbox.tech","getdropbox.com"]}},{baseConfiguration:Gt,explicitlyTyped:!0});var Ut=n(30936),qt=n(27159);function Jt(e){const t=(0,Ut.c)(3);let n,r;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,te.jsx)("path",{d:"M3 6.2L8 9.39L13 6.2L8 3L3 6.2M13 6.2L18 9.39L23 6.2L18 3L13 6.2M3 12.55L8 15.74L13 12.55L8 9.35L3 12.55M18 9.35L13 12.55L18 15.74L23 12.55L18 9.35M8.03 16.8L13.04 20L18.04 16.8L13.04 13.61L8.03 16.8Z"}),t[0]=n):n=t[0],t[1]!==e?(r=(0,te.jsx)(qt.A,{...e,children:n}),t[1]=e,t[2]=r):r=t[2],r}async function Xt({response:e,reason:t,statusText:n}){return[`HTTP ${e.status}`,t,n??await Kt(e)].filter(e=>!!e).join(" - ")}async function Kt(e){try{return await e.text()}catch(t){return e.statusText}}const Qt={shared_link_not_found:"The shared link wasn't found.",shared_link_access_denied:"The caller is not allowed to access this shared link.",unsupported_link_type:"This type of link is not supported; use files/export instead.",shared_link_is_directory:"Directories cannot be retrieved by this endpoint."};async function Yt(e,t){let n="";try{const t=JSON.parse(await e.text()).error[".tag"];n=Qt[t]||t}catch(e){}return Xt({response:e,reason:t,statusText:n})}var Zt=n(1231);function en(e){return e.replaceAll("+","-").replaceAll("/","_").replaceAll("=","")}function tn(e,t){try{const n=JSON.parse(e);return"invalid_grant"===n.error&&t(),n?.error_description??e}catch(e){}return e}function nn(e,t){return e.refresh_token&&t(e.refresh_token),e.access_token}const rn=e=>Zt.X.named("OAuthInternetAccount").props({type:c.types.literal("OAuthInternetAccount"),configuration:(0,i.AK)(e)}).views(()=>{let e;return{get codeVerifierPKCE(){if(!e){const t=new Uint8Array(32);globalThis.crypto.getRandomValues(t),e=en(function(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(String.fromCharCode(e[n]));return btoa(t.join(""))}(t))}return e}}}).views(e=>({get authEndpoint(){return(0,R.FI)(e,"authEndpoint")},get tokenEndpoint(){return(0,R.FI)(e,"tokenEndpoint")},get needsPKCE(){return(0,R.FI)(e,"needsPKCE")},get clientId(){return(0,R.FI)(e,"clientId")},get scopes(){return(0,R.FI)(e,"scopes")},state:()=>(0,R.FI)(e,"state"),get responseType(){return(0,R.FI)(e,"responseType")},get refreshTokenKey(){return`${e.internetAccountId}-refreshToken`}})).actions(e=>({storeRefreshToken(t){localStorage.setItem(e.refreshTokenKey,t)},removeRefreshToken(){localStorage.removeItem(e.refreshTokenKey)},retrieveRefreshToken:()=>localStorage.getItem(e.refreshTokenKey),async exchangeAuthorizationForAccessToken(t,n){const r=new URLSearchParams(Object.entries({code:t,grant_type:"authorization_code",client_id:e.clientId,redirect_uri:n,...e.needsPKCE?{code_verifier:e.codeVerifierPKCE}:{}})),a=await fetch(e.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r.toString()});if(!a.ok)throw new Error(await Xt({response:a,reason:"Failed to obtain token"}));return nn(await a.json(),e=>{this.storeRefreshToken(e)})},async exchangeRefreshForAccessToken(t){const n=await fetch(e.tokenEndpoint,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(Object.entries({grant_type:"refresh_token",refresh_token:t,client_id:e.clientId})).toString()});if(!n.ok){e.removeToken();const t=await n.text();throw new Error(await Xt({response:n,statusText:tn(t,()=>{this.removeRefreshToken()})}))}return nn(await n.json(),e=>{this.storeRefreshToken(e)})}})).actions(e=>{let t,r;return{addMessageChannel(e,n){t=t=>{this.finishOAuthWindow(t,e,n)},window.addEventListener("message",t)},deleteMessageChannel(){window.removeEventListener("message",t)},async finishOAuthWindow(t,n,r){if(t.data.name!==`JBrowseAuthWindow-${e.internetAccountId}`)return void this.deleteMessageChannel();const a=t.data.redirectUri,o=a.replace("#","?"),i=new URL(o),s=i.search,l=new URLSearchParams(s);if(l.has("access_token")){const t=l.get("access_token");return t?(e.storeToken(t),void n(t)):void r(new Error("Error with token endpoint"))}if(l.has("code")){const t=l.get("code");if(!t)return void r(new Error("Error with authorization endpoint"));try{const r=await e.exchangeAuthorizationForAccessToken(t,i.origin+i.pathname);return e.storeToken(r),void n(r)}catch(e){return void(e instanceof Error?r(e):r(new Error(String(e))))}}a.includes("access_denied")?r(new Error("OAuth flow was cancelled")):a.includes("error")?r(new Error(`OAuth flow error: ${s}`)):this.deleteMessageChannel()},async useEndpointForAuthorization(t,r){const a=x.isElectron?"http://localhost/auth":window.location.origin+window.location.pathname,o={client_id:e.clientId,redirect_uri:a,response_type:e.responseType,token_access_type:"offline"};e.state()&&(o.state=e.state()),e.scopes&&(o.scope=e.scopes),e.needsPKCE&&(o.code_challenge=await async function(e){const t=await Promise.all([n.e(6716),n.e(1156)]).then(n.t.bind(n,55668,23)).then(e=>e.default);return en((await Promise.all([n.e(6716),n.e(441)]).then(n.t.bind(n,18975,23))).stringify(t(e)))}(e.codeVerifierPKCE),o.code_challenge_method="S256");const i=new URLSearchParams(Object.entries(o)),s=new URL(e.authEndpoint);s.search=i.toString();const l=`JBrowseAuthWindow-${e.internetAccountId}`;if(x.isElectron){const{ipcRenderer:n}=window.require("electron"),a=await n.invoke("openAuthWindow",{internetAccountId:e.internetAccountId,data:o,url:s.toString()}),i=new MessageEvent("message",{data:{name:l,redirectUri:a}});this.finishOAuthWindow(i,t,r)}else window.open(s,l,"width=500,height=600,left=0,top=0")},async getTokenFromUser(t,n){const r=e.retrieveRefreshToken();let a=!0;if(r)try{t(await e.exchangeRefreshForAccessToken(r)),a=!1}catch(t){console.error(t),e.removeRefreshToken()}a&&(this.addMessageChannel(t,n),this.useEndpointForAuthorization(t,n))},async validateToken(t,n){const a=e.addAuthHeaderToInit({method:"HEAD"},t),o=await fetch(n.uri,a);if(!o.ok){e.removeToken();const t=e.retrieveRefreshToken();if(t)try{r||(r=e.exchangeRefreshForAccessToken(t));const n=await r;return r=void 0,n}catch(e){console.error("Token could not be refreshed",e)}throw new Error(await Xt({response:o,reason:"Error validating token"}))}return t}}}).actions(e=>{const t=e.getFetcher;return{getFetcher(n){const r=t(n);return async(t,a)=>(n&&await e.validateToken(await e.getToken(n),n),r(t,a))}}}),an=e=>rn(Gt).named("DropboxOAuthInternetAccount").props({type:c.types.literal("DropboxOAuthInternetAccount"),configuration:(0,i.AK)(e)}).views(()=>({get toggleContents(){return(0,te.jsx)(Jt,{})},get selectorLabel(){return"Enter Dropbox share link"}})).actions(e=>({getFetcher:t=>async(n,r)=>{const a=await e.getToken(t),o=e.addAuthHeaderToInit({...r,method:"POST"},a);o.headers.append("Dropbox-API-Arg",JSON.stringify({url:n}));const i=await fetch("https://content.dropboxapi.com/2/sharing/get_shared_link_file",o);if(!i.ok)throw new Error(await Yt(i));return i},async validateToken(t,n){const r=await fetch("https://api.dropboxapi.com/2/sharing/get_shared_link_metadata",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({url:n.uri})});if(!r.ok){const t=e.retrieveRefreshToken();if(t){e.removeRefreshToken();const r=await e.exchangeRefreshForAccessToken(t);return this.validateToken(r,n)}throw new Error(await Yt(r,"Token could not be validated"))}return t}})),on=(0,i.S7)("ExternalTokenInternetAccount",{validateWithHEAD:{description:"validate the token with a HEAD request before using it",type:"boolean",defaultValue:!0}},{baseConfiguration:$t.y,explicitlyTyped:!0});var sn=n(85787),ln=n(24215),cn=n(15675),dn=n(65525),un=n(11543);const pn=e=>{const t=(0,Ut.c)(20),{internetAccountId:n,handleClose:r}=e,[o,i]=(0,a.useState)("");let s;t[0]!==r?(s=()=>{r()},t[0]=r,t[1]=s):s=t[1];const l=`Enter token for ${n}`;let c,d,u;t[2]===Symbol.for("react.memo_cache_sentinel")?(c={display:"flex",flexDirection:"column"},t[2]=c):c=t[2],t[3]===Symbol.for("react.memo_cache_sentinel")?(d=e=>{i(e.target.value)},t[3]=d):d=t[3],t[4]===Symbol.for("react.memo_cache_sentinel")?(u=(0,te.jsx)(ln.A,{style:c,children:(0,te.jsx)(cn.A,{required:!0,label:"Enter Token",variant:"outlined",onChange:d,margin:"dense",slotProps:{htmlInput:{"data-testid":"entry-externalToken"}}})}),t[4]=u):u=t[4];const p=!o;let h,g,m,f,y;return t[5]!==r||t[6]!==o?(h=()=>{o&&r(o)},t[5]=r,t[6]=o,t[7]=h):h=t[7],t[8]!==p||t[9]!==h?(g=(0,te.jsx)(dn.A,{variant:"contained",color:"primary",type:"submit",disabled:p,onClick:h,children:"Add"}),t[8]=p,t[9]=h,t[10]=g):g=t[10],t[11]!==r?(m=(0,te.jsx)(dn.A,{variant:"contained",color:"secondary",onClick:()=>{r()},children:"Cancel"}),t[11]=r,t[12]=m):m=t[12],t[13]!==g||t[14]!==m?(f=(0,te.jsxs)(un.A,{children:[g,m]}),t[13]=g,t[14]=m,t[15]=f):f=t[15],t[16]!==s||t[17]!==f||t[18]!==l?(y=(0,te.jsxs)(sn.A,{open:!0,maxWidth:"xl","data-testid":"externalToken-form",onClose:s,title:l,children:[u,f]}),t[16]=s,t[17]=f,t[18]=l,t[19]=y):y=t[19],y},hn=e=>Zt.X.named("ExternalTokenInternetAccount").props({type:c.types.literal("ExternalTokenInternetAccount"),configuration:(0,i.AK)(e)}).views(e=>({get validateWithHEAD(){return(0,R.FI)(e,"validateWithHEAD")}})).actions(e=>({getTokenFromUser(t,n){const{session:r}=(0,c.getRoot)(e);r.queueDialog(r=>[pn,{internetAccountId:e.internetAccountId,handleClose:e=>{e?t(e):n(new Error("user cancelled entry")),r()}}])},async validateToken(t,n){if(!e.validateWithHEAD)return t;const r=e.addAuthHeaderToInit({method:"HEAD"},t),a=await fetch(n.uri,r);if(!a.ok){let e;try{e=await a.text()}catch(t){e=""}throw new Error(`Token could not be validated — ${a.status} ${e?` (${e})`:""}`)}return t}})),gn=(0,i.S7)("GoogleDriveOAuthInternetAccount",{authEndpoint:{description:"the authorization code endpoint of the internet account",type:"string",defaultValue:"https://accounts.google.com/o/oauth2/v2/auth"},scopes:{description:"optional scopes for the authorization call",type:"string",defaultValue:"https://www.googleapis.com/auth/drive.readonly"},domains:{description:"array of valid domains the url can contain to use this account",type:"stringArray",defaultValue:['drive.google.com"']},responseType:{description:"the type of response from the authorization endpoint",type:"string",defaultValue:"token"}},{baseConfiguration:Gt,explicitlyTyped:!0});var mn=n(9255);class fn extends mn.g{constructor(e,t){super(e,t),this.statsPromise=this.fetch(e,{metadataOnly:!0}).then(e=>e.json())}async fetch(e,t){return super.fetch(e,t)}async stat(){return this.statsPromise}}function yn(e){const t=(0,Ut.c)(3);let n,r;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,te.jsx)("path",{d:"M7.71,3.5L1.15,15L4.58,21L11.13,9.5M9.73,15L6.3,21H19.42L22.85,15M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z"}),t[0]=n):n=t[0],t[1]!==e?(r=(0,te.jsx)(qt.A,{...e,children:n}),t[1]=e,t[2]=r):r=t[2],r}async function bn(e,t){let n="";try{n=JSON.parse(await e.text()).error.message}catch(e){}return Xt({response:e,reason:t,statusText:n})}function wn(e){return`https://www.googleapis.com/drive/v3/files/${/[-\w]{25,}/.exec(e)}`}function vn(e){return rn(Gt).named("GoogleDriveOAuthInternetAccount").props({type:c.types.literal("GoogleDriveOAuthInternetAccount"),configuration:(0,i.AK)(e)}).views(()=>({get toggleContents(){return(0,te.jsx)(yn,{})},get selectorLabel(){return"Enter Google Drive share link"}})).actions(e=>({getFetcher:t=>async(n,r)=>{const a=new URL(wn(String(n))),o=new URLSearchParams;r?.metadataOnly?o.append("fields","size"):o.append("alt","media"),a.search=o.toString();const i=await e.getToken(t),s=await fetch(a,e.addAuthHeaderToInit({...r,method:"GET",credentials:"same-origin"},i));if(!s.ok)throw new Error(await bn(s));return s},openLocation(e){return new fn(e.uri,{fetch:this.getFetcher(e)})},async validateToken(e,t){const n=await fetch(wn(t.uri),{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/x-www-form-urlencoded"}});if(!n.ok)throw new Error(await bn(n,"Token could not be validated"));return e}}))}const Sn=(0,i.S7)("HTTPBasicInternetAccount",{tokenType:{description:"a custom name for a token to include in the header",type:"string",defaultValue:"Basic"},validateWithHEAD:{description:"validate the token with a HEAD request before using it",type:"boolean",defaultValue:!0}},{baseConfiguration:$t.y,explicitlyTyped:!0});function kn(e){const t=(0,Ut.c)(21),{internetAccountId:n,handleClose:r}=e,[o,i]=(0,a.useState)(""),[s,l]=(0,a.useState)(""),c=`Log in for ${n}`;let d,u,p,h,g,m,f,y,b,w,v;return t[0]!==r?(d=()=>{r()},t[0]=r,t[1]=d):d=t[1],t[2]!==r||t[3]!==s||t[4]!==o?(u=e=>{o&&s?r(btoa(`${o}:${s}`)):r(),e.preventDefault()},t[2]=r,t[3]=s,t[4]=o,t[5]=u):u=t[5],t[6]===Symbol.for("react.memo_cache_sentinel")?(p={display:"flex",flexDirection:"column"},t[6]=p):p=t[6],t[7]===Symbol.for("react.memo_cache_sentinel")?(h=e=>{i(e.target.value)},t[7]=h):h=t[7],t[8]===Symbol.for("react.memo_cache_sentinel")?(g=(0,te.jsx)(cn.A,{required:!0,label:"Username",variant:"outlined",onChange:h,margin:"dense",slotProps:{htmlInput:{"data-testid":"login-httpbasic-username"}}}),t[8]=g):g=t[8],t[9]===Symbol.for("react.memo_cache_sentinel")?(m=e=>{l(e.target.value)},t[9]=m):m=t[9],t[10]===Symbol.for("react.memo_cache_sentinel")?(f=(0,te.jsxs)(ln.A,{style:p,children:[g,(0,te.jsx)(cn.A,{required:!0,label:"Password",type:"password",autoComplete:"current-password",variant:"outlined",onChange:m,margin:"dense",slotProps:{htmlInput:{"data-testid":"login-httpbasic-password"}}})]}),t[10]=f):f=t[10],t[11]===Symbol.for("react.memo_cache_sentinel")?(y=(0,te.jsx)(dn.A,{variant:"contained",color:"primary",type:"submit",children:"Submit"}),t[11]=y):y=t[11],t[12]!==r?(b=(0,te.jsxs)(un.A,{children:[y,(0,te.jsx)(dn.A,{variant:"contained",color:"secondary",type:"submit",onClick:()=>{r()},children:"Cancel"})]}),t[12]=r,t[13]=b):b=t[13],t[14]!==b||t[15]!==u?(w=(0,te.jsxs)("form",{onSubmit:u,children:[f,b]}),t[14]=b,t[15]=u,t[16]=w):w=t[16],t[17]!==c||t[18]!==w||t[19]!==d?(v=(0,te.jsx)(sn.A,{open:!0,maxWidth:"xl","data-testid":"login-httpbasic",title:c,onClose:d,children:w}),t[17]=c,t[18]=w,t[19]=d,t[20]=v):v=t[20],v}const xn=e=>Zt.X.named("HTTPBasicInternetAccount").props({type:c.types.literal("HTTPBasicInternetAccount"),configuration:(0,i.AK)(e)}).views(e=>({get validateWithHEAD(){return(0,R.FI)(e,"validateWithHEAD")}})).actions(e=>({getTokenFromUser(t,n){const{session:r}=(0,c.getRoot)(e);r.queueDialog(r=>[kn,{internetAccountId:e.internetAccountId,handleClose:e=>{e?t(e):n(new Error("User cancelled entry")),r()}}])},async validateToken(t,n){if(!e.validateWithHEAD)return t;const r=e.addAuthHeaderToInit({method:"HEAD"},t),a=await fetch(n.uri,r);if(!a.ok)throw new Error(await Xt({response:a,reason:"Error validating token"}));return t}}));class Cn extends r.A{name="AuthenticationPlugin";exports={OAuthConfigSchema:Gt,OAuthInternetAccountModelFactory:rn,ExternalTokenConfigSchema:on,ExternalTokenInternetAccountModelFactory:hn,HTTPBasicConfigSchema:Sn,HTTPBasicInternetAccountModelFactory:xn,DropboxOAuthConfigSchema:Wt,DropboxOAuthInternetAccountModelFactory:an,GoogleDriveOAuthConfigSchema:gn,GoogleDriveOAuthInternetAccountModelFactory:vn};install(e){e.addInternetAccountType(()=>new Ot.A({name:"OAuthInternetAccount",configSchema:Gt,stateModel:rn(Gt)})),e.addInternetAccountType(()=>new Ot.A({name:"ExternalTokenInternetAccount",configSchema:on,stateModel:hn(on)})),e.addInternetAccountType(()=>new Ot.A({name:"HTTPBasicInternetAccount",configSchema:Sn,stateModel:xn(Sn)})),e.addInternetAccountType(()=>new Ot.A({name:"DropboxOAuthInternetAccount",configSchema:Wt,stateModel:an(Wt)})),e.addInternetAccountType(()=>new Ot.A({name:"GoogleDriveOAuthInternetAccount",configSchema:gn,stateModel:vn(gn)}))}}const Tn=(0,i.S7)("BedAdapter",{bedLocation:{type:"fileLocation",description:"path to bed file, also allows gzipped bed",defaultValue:{uri:"/path/to/my.bed.gz",locationType:"UriLocation"}},columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]},scoreColumn:{type:"string",description:'The column to use as a "score" attribute',defaultValue:""},autoSql:{type:"string",description:"The autoSql definition for the data fields in the file",defaultValue:""},colRef:{type:"number",description:'The column to use as a "refName" attribute',defaultValue:0},colStart:{type:"number",description:'The column to use as a "start" attribute',defaultValue:1},colEnd:{type:"number",description:'The column to use as a "end" attribute',defaultValue:2}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bedLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),An=(0,i.S7)("BedGraphAdapter",{bedGraphLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bedgraph",locationType:"UriLocation"}},columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bedGraphLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Mn=(0,i.S7)("BedGraphTabixAdapter",{bedGraphGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bedgraph",locationType:"UriLocation"}},index:(0,i.S7)("VcfIndex",{indexType:{model:c.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf.gz.tbi",locationType:"UriLocation"}}}),columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bedGraphGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e}),Pn=(0,i.S7)("BedTabixAdapter",{bedGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz",locationType:"UriLocation"}},index:(0,i.S7)("TabixIndex",{indexType:{model:c.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bed.gz.tbi",locationType:"UriLocation"}}}),columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]},scoreColumn:{type:"string",description:'The column to use as a "score" attribute',defaultValue:""},autoSql:{type:"string",description:"The autoSql definition for the data fields in the file",defaultValue:""}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bedGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e}),In=(0,i.S7)("BedpeAdapter",{bedpeLocation:{type:"fileLocation",description:"can be plaintext or gzipped, not indexed so loaded into memory on startup",defaultValue:{uri:"/path/to/my.bedpe.gz",locationType:"UriLocation"}},columnNames:{type:"stringArray",description:"List of column names",defaultValue:[]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bedpeLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Rn=(0,i.S7)("BigBedAdapter",{bigBedLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.bb",locationType:"UriLocation"}},scoreColumn:{type:"string",description:'The column to use as a "score" attribute',defaultValue:""},aggregateField:{type:"string",description:"An attribute to aggregate features with",defaultValue:"geneName2"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,bigBedLocation:{uri:e.uri,baseUri:e.baseUri}}:e});class Ln extends r.A{name="BedPlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"BigBedAdapter",displayName:"BigBed adapter",configSchema:Rn,getAdapterClass:()=>Promise.all([n.e(9964),n.e(6601),n.e(4552)]).then(n.bind(n,34552)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BedAdapter",displayName:"BED adapter",configSchema:Tn,getAdapterClass:()=>Promise.all([n.e(7710),n.e(9964),n.e(1062)]).then(n.bind(n,11062)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BedpeAdapter",displayName:"BEDPE adapter",configSchema:In,getAdapterClass:()=>Promise.all([n.e(7710),n.e(8462)]).then(n.bind(n,88462)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BedTabixAdapter",displayName:"BED tabix adapter",configSchema:Pn,getAdapterClass:()=>Promise.all([n.e(9272),n.e(9964),n.e(5980)]).then(n.bind(n,85980)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BedGraphAdapter",displayName:"BedGraph adapter",configSchema:An,getAdapterClass:()=>Promise.all([n.e(7710),n.e(504)]).then(n.bind(n,40504)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BedGraphTabixAdapter",displayName:"BedGraphTabix adapter",configSchema:Mn,getAdapterClass:()=>Promise.all([n.e(9272),n.e(9374)]).then(n.bind(n,89374)).then(e=>e.default)}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t),o=n&&(0,C.getFileName)(n);return(0,x.testAdapter)(a,/\.bedpe(\.gz)?$/i,r,"BedpeAdapter")?{type:"BedpeAdapter",bedpeLocation:t}:(0,x.testAdapter)(a,/\.bb$/i,r,"BigBedAdapter")||(0,x.testAdapter)(a,/\.bigBed?$/i,r,"BigBedAdapter")?{type:"BigBedAdapter",bigBedLocation:t}:(0,x.testAdapter)(a,/\.bed$/i,r,"BedAdapter")?{type:"BedAdapter",bedLocation:t}:(0,x.testAdapter)(a,/\.bg$/i,r,"BedGraphAdapter")?{type:"BedGraphAdapter",bedGraphLocation:t}:(0,x.testAdapter)(a,/\.bg(\.gz)?$/i,r,"BedGraphTabixAdapter")?{type:"BedGraphTabixAdapter",bedGraphGzLocation:t,index:{location:n||(0,C.makeIndex)(t,".tbi"),indexType:(0,C.makeIndexType)(o,"CSI","TBI")}}:(0,x.testAdapter)(a,/\.bed\.gz$/i,r,"BedTabixAdapter")?{type:"BedTabixAdapter",bedGzLocation:t,index:{location:n||(0,C.makeIndex)(t,".tbi"),indexType:(0,C.makeIndexType)(o,"CSI","TBI")}}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>({BedpeAdapter:"VariantTrack",BedGraphAdapter:"QuantitativeTrack",BedGraphTabixAdapter:"QuantitativeTrack"}[t]||e(t)))}(e)}}var Fn=n(27868);const Dn=(0,i.S7)("BreakpointAlignmentsWidget",{}),Nn=c.types.model("BreakpointAlignmentsWidget",{id:Fn.K,type:c.types.literal("BreakpointAlignmentsWidget"),featureData:c.types.frozen()}).actions(e=>({setFeatureData(t){e.featureData=t},clearFeatureData(){e.featureData=void 0}})),Bn=/(\d+)[SH]$/,En=/^(\d+)([SH])/;function Vn(e,t){return-1===t?+(Bn.exec(e)?.[1]??0):+(En.exec(e)?.[1]??0)}class zn extends lt.A{name="BreakpointGetFeatures";async deserializeReturn(e,t,n){return(await super.deserializeReturn(e,t,n)).map(e=>new q.A(e))}async serializeArguments(e,t){const{rootModel:n}=this.pluginManager,r=n.session.assemblyManager,a=await(0,x.renameRegionsIfNeeded)(r,e);return super.serializeArguments(a,t)}async execute(e,t){const{stopToken:n,statusCallback:r,sessionId:a,adapterConfig:o,regions:i,opts:s}=await this.deserializeArguments(e,t),l=(await(0,ot.cK)(this.pluginManager,a,o)).dataAdapter;return(await(0,it._)(l.getFeaturesInMultipleRegions(i,{...s,statusCallback:r,stopToken:n}).pipe((0,st.$)()))).map(e=>{const t=e.get("CIGAR"),n=e.get("strand");return{uniqueId:e.id(),start:e.get("start"),end:e.get("end"),refName:e.get("refName"),strand:n,flags:e.get("flags"),name:e.get("name"),id:e.get("id"),tags:e.get("tags"),pair_orientation:e.get("pair_orientation"),type:e.get("type"),ALT:e.get("ALT"),INFO:e.get("INFO"),clipLengthAtStartOfRead:t&&void 0!==n?Vn(t,n):void 0}})}}var jn=n(23460),Hn=n(20637),_n=n(59177),On=n(12094),$n=n(14647);const Gn=(0,a.lazy)(()=>n.e(784).then(n.bind(n,90784)));function Wn(e){return c.types.compose("BreakpointSplitView",Hn.A,c.types.model({type:c.types.literal("BreakpointSplitView"),height:c.types.optional(c.types.number,400),trackSelectorType:"hierarchical",showIntraviewLinks:!0,linkViews:!1,interactiveOverlay:!0,showHeader:!1,views:c.types.array(e.getViewType("LinearGenomeView").stateModel),init:c.types.frozen()})).volatile(()=>({width:800,matchedTrackFeatures:{}})).views(e=>({get hasSomethingToShow(){return e.views.length>0||!!e.init},get initialized(){return e.views.length>0&&e.views.every(e=>e.initialized)},get showImportForm(){return!this.hasSomethingToShow}})).views(e=>({async exportSvg(t={}){const{renderToSvg:r}=await Promise.all([n.e(3750),n.e(6128),n.e(9179)]).then(n.bind(n,59179)),a=await r(e,t),{saveAs:o}=await n.e(9044).then(n.bind(n,99044));o(new Blob([a],{type:"image/svg+xml"}),t.filename||"image.svg")}})).views(e=>({get matchedTracks(){return 1===e.views.length?e.views[0].tracks:(0,$n.y$)(e=>e.configuration.trackId,...e.views.map(e=>e.tracks))},getMatchedTracks:t=>e.views.map(e=>e.getTrack(t)).filter(x.notEmpty),hasTranslocations(e){return[...this.getTrackFeatures(e).values()].some(e=>"translocation"===e.get("type"))},hasPairedFeatures(e){return[...this.getTrackFeatures(e).values()].some(e=>"paired_feature"===e.get("type"))},getTrackFeatures:t=>new Map(e.matchedTrackFeatures[t]?.flat().map(e=>[e.id(),e])),getMatchedFeaturesInLayout(e,t){const n=this.getMatchedTracks(e);return t.map(e=>e.map(e=>{for(const[t,r]of n.entries()){const n=(0,$n._u)(r,e);if(n)return{feature:e,layout:n,level:t,clipLengthAtStartOfRead:e.get("clipLengthAtStartOfRead")??0}}}).filter(x.notEmpty))}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,c.addMiddleware)(e,(t,n)=>{if("action"===t.type&&t.id===t.rootId){const r=["horizontalScroll","zoomTo","setScaleFactor","showTrack","toggleTrack","hideTrack","setTrackLabels","toggleCenterLine"];if(e.linkViews&&r.includes(t.name)){const r=(0,c.getPath)(t.context);n(t);for(const n of e.views)(0,c.getPath)(n)!==r&&n[t.name](t.args[0]);return}}n(t)}))},setWidth(t){e.width=t;for(const n of e.views)n.setWidth(t)},setInteractiveOverlay(t){e.interactiveOverlay=t},setShowIntraviewLinks(t){e.showIntraviewLinks=t},setLinkViews(t){e.linkViews=t},setShowHeader(t){e.showHeader=t},setMatchedTrackFeatures(t){e.matchedTrackFeatures=t},reverseViewOrder(){e.views.reverse()},setInit(t){e.init=t},setViews(t){e.views=(0,c.cast)(t.map(e=>({type:"LinearGenomeView",hideHeader:!0,init:e})))}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){const{init:t,width:n}=e;n&&t&&(e.setViews(t.views),e.setInit(void 0))},{name:"BreakpointSplitViewInit"})),(0,c.addDisposer)(e,(0,N.autorun)(async()=>{try{if(!e.views.every(e=>e.initialized))return;if(e.matchedTracks.some(e=>e.displays[0].notReady?.()))return;e.setMatchedTrackFeatures(Object.fromEntries(await Promise.all(e.matchedTracks.map(async t=>[t.configuration.trackId,await(0,$n.JV)(e,t)]))))}catch(t){console.error(t),(0,x.getSession)(e).notifyError(`${t}`,t)}},{name:"BreakpointFeatureFetcher",delay:1e3}))},menuItems:()=>[...e.views.map((e,t)=>({label:`Row ${t+1} view menu`,subMenu:e.menuItems()})),...e.views.length>1?[{label:"Reverse view order",onClick:()=>{e.reverseViewOrder()}}]:[],{label:"Show header",type:"checkbox",checked:e.showHeader,onClick:()=>{e.setShowHeader(!e.showHeader)}},{label:"Show intra-view links",type:"checkbox",checked:e.showIntraviewLinks,onClick:()=>{e.setShowIntraviewLinks(!e.showIntraviewLinks)}},{label:"Allow clicking alignment squiggles?",type:"checkbox",checked:e.interactiveOverlay,onClick:()=>{e.setInteractiveOverlay(!e.interactiveOverlay)}},{label:"Link views",type:"checkbox",icon:_n.A,checked:e.linkViews,onClick:()=>{e.setLinkViews(!e.linkViews)}},{label:"Export SVG",icon:On.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Gn,{model:e,handleClose:t}])}}],rubberBandMenuItems:()=>[{label:"Zoom to region(s)",onClick:()=>{for(const t of e.views){const{leftOffset:e,rightOffset:n}=t;e&&n&&t.moveTo(e,n)}}}]})).postProcessSnapshot(e=>{if(!e)return e;const{init:t,height:n,trackSelectorType:r,showIntraviewLinks:a,linkViews:o,interactiveOverlay:i,showHeader:s,...l}=e;return{...l,...400!==n?{height:n}:{},..."hierarchical"!==r?{trackSelectorType:r}:{},...a?{}:{showIntraviewLinks:a},...o?{linkViews:o}:{},...i?{}:{interactiveOverlay:i},...s?{showHeader:s}:{}}})}class Un extends r.A{name="BreakpointSplitViewPlugin";install(e){!function(e){e.addViewType(()=>new jn.A({name:"BreakpointSplitView",displayName:"Breakpoint split view",stateModel:Wn(e),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(6128),n.e(6086)]).then(n.bind(n,96086)))}))}(e),function(e){e.addWidgetType(()=>new o.A({name:"BreakpointAlignmentsWidget",heading:"Breakpoint feature details",configSchema:Dn,stateModel:Nn,ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(2387)]).then(n.bind(n,10269)))}))}(e),function(e){e.addToExtensionPoint("LaunchView-BreakpointSplitView",async({session:e,views:t})=>{if(t.length<2)throw new Error("BreakpointSplitView requires at least 2 views to be specified");e.addView("BreakpointSplitView",{init:{views:t}})})}(e),function(e){e.addRpcMethod(()=>new zn(e))}(e)}configure(){}}var qn=n(83640);function Jn(e,t,n,r){return e.isCallback?(0,R.QZ)(t,n,{feature:r}):e.value}function Xn(e,t,n){const r=Array.isArray(t)?t.reduce((e,t)=>e?.[t],e):e[t],a=r?.isCallback??!1;return{value:a?n:(0,R.QZ)(e,t),isCallback:a}}const Kn=/(\bUTR|_UTR|untranslated[_\s]region)\b/i;function Qn(e,t){return e*(t?-1:1)}function Yn(e,t,n,r,a){return-1===a?e+t-r*n:e+r*n}function Zn(e,t=50){return e.length>t?`${e.slice(0,t-1)}…`:e}function er(e,t,n){return e+t<0||e>n}function tr(e){return Kn.test(e.get("type")||"")}function nr({feature:e,config:t,configContext:n,colorByCDS:r,theme:a}){const{color1:o,color3:i}=n;let s;s=tr(e)?Jn(i,t,"color3",e):Jn(o,t,"color1",e);const l=e.get("type"),c=e.get("strand"),d=e.get("phase");if(r&&"CDS"===l&&void 0!==c&&void 0!==d){const t=e.get("start"),n=e.get("end"),r=(0,x.getFrame)(t,n,c,d),o=a.palette.framesCDS.at(r)?.main;o&&(s=o)}return s}function rr({feature:e,config:t,configContext:n,theme:r}){const{color2:a}=n,o=Jn(a,t,"color2",e);return"#f0f"===o?(0,x.stripAlpha)(r.palette.text.secondary):o}function ar({feature:e,config:t,configContext:n,nameColor:r,descriptionColor:a,name:o,description:i}){const{showLabels:s,showDescriptions:l,fontHeight:c}=n,d=Zn(o),u=Zn(i),p=/\S/.test(d)&&s,h=/\S/.test(u)&&l;if(!p&&!h)return[];const g=Jn(c,t,["labels","fontSize"],e),m=[];return p&&h?m.push({text:d,relativeY:0,color:r,textWidth:(0,x.measureText)(d,11)},{text:u,relativeY:g,color:a,textWidth:(0,x.measureText)(u,11)}):p?m.push({text:d,relativeY:0,color:r,textWidth:(0,x.measureText)(d,11)}):h&&m.push({text:u,relativeY:0,color:a,textWidth:(0,x.measureText)(u,11)}),m}function or({displayLabel:e,featureHeight:t,subfeatureLabels:n,color:r,parentFeatureId:a,subfeatureId:o,tooltip:i}){if(!e)return null;const s=Zn(e),l="overlay"===n;return{text:s,relativeY:l?2-t:0,color:r,textWidth:(0,x.measureText)(s,11),isOverlay:l,parentFeatureId:a,subfeatureId:o,tooltip:i}}function ir(e,t){const n=e*(t?-1:1);return{left:-1===n?8:0,right:1===n?8:0,visualSide:-1===n?"left":1===n?"right":null,width:e?8:0}}function sr(e,t,n,r="Box"){const{bpPerPx:a,reversed:o,configContext:i}=n,{config:s,displayMode:l,featureHeight:c}=i,d=Jn(c,s,"height",e),u="compact"===l?d/2:d,p=e.get("start"),h=e.get("end"),g=t.get("start"),m=t.get("end"),f=(h-p)/a;return{feature:e,glyphType:r,x:(o?m-h:p-g)/a,y:0,width:f,height:u,totalLayoutHeight:u,totalLayoutWidth:f,leftPadding:0,children:[]}}function lr(e,t,n,r,a,o){const i=n+a/2;e.strokeStyle=o,e.lineWidth=1,e.beginPath(),e.moveTo(t,i),e.lineTo(t+r,i),e.stroke()}function cr(e,t,n,r,a,o,i){const s=o?-1:1,l=7*a*s,c=a*s===-1?t:a*s===1?t+r:null;null!==c&&(e.strokeStyle=i,e.lineWidth=1,e.beginPath(),e.moveTo(c,n),e.lineTo(c+l,n),e.stroke(),e.fillStyle=i,e.beginPath(),e.moveTo(c+l/2,n-2.5),e.lineTo(c+l/2,n+2.5),e.lineTo(c+l,n),e.closePath(),e.fill())}function dr(e,t,n,r){const{feature:a}=t,{region:o,canvasWidth:i}=n,s=o.reversed??!1,l=t.x,c=t.width;if(er(l,c,i))return;const d=a.get("strand");d&&cr(e,l,t.y+t.height/2,c,d,s,r)}function ur(e,t,n,r,a){const{feature:o,children:i}=t,{region:s,configContext:l,theme:c,canvasWidth:d}=n,{config:u,displayDirectionalChevrons:p}=l,h=s.reversed??!1,g=t.x,m=t.width,f=t.y,y=t.height;if(er(g,m,d))return;const b=rr({feature:o,config:u,configContext:l,theme:c});if(lr(e,g,f,m,y,b),p){const t=o.get("strand");t&&function(e,t,n,r,a,o,i=40,s=4){if(0===a||r<i)return;e.strokeStyle=o,e.lineWidth=.5,e.beginPath();const l=s/2,c=Math.floor(r/i),d=(r-c*i)/2+i/2;for(let r=0;r<c;r++){const o=t+d+r*i;1===a?(e.moveTo(o-l,n-l),e.lineTo(o+l,n),e.lineTo(o-l,n+l)):(e.moveTo(o+l,n-l),e.lineTo(o-l,n),e.lineTo(o+l,n+l))}e.stroke()}(e,g,f+y/2,m,h?-t:t,b)}for(const t of i)"CDS"===t.glyphType?a.draw(e,t,n):r.draw(e,t,n);dr(e,t,n,b)}const pr={type:"Box",match(e){if("CDS"===e.get("type"))return!1;const t=e.get("subfeatures");return!t?.length},layout(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a}=e,{config:o,displayMode:i,featureHeight:s}=a,l=Jn(s,o,"height",t),c="compact"===i?l/2:l,d=(t.get("end")-t.get("start"))/n,u=!t.parent?.(),p=t.get("strand"),h=u?ir(p,r):{left:0,right:0};return{feature:t,glyphType:"Box",x:0,y:0,width:d,height:c,totalLayoutHeight:c,totalLayoutWidth:d+h.left+h.right,leftPadding:h.left,children:[]}},draw(e,t,n){const{feature:r}=t,{region:a,bpPerPx:o,configContext:i,theme:s,canvasWidth:l}=n,{config:c}=i,d=n.colorByCDS??!1,{start:u,end:p}=a,h=Math.ceil((p-u)/o),g=t.width,m=t.x;if(er(m,g,l)||r.parent?.()&&"intron"===r.get("type"))return;let f=t.y,y=t.height;tr(r)&&(f+=.175*y,y*=.65);const b=Math.max(m,0),w=b-m,v=Math.max(2,Math.min(g-w,h)),S=nr({feature:r,config:c,configContext:i,colorByCDS:d,theme:s}),k=Jn(i.outline,c,"outline",r);e.fillStyle=S,e.fillRect(b,f,v,y),k&&(e.strokeStyle=k,e.lineWidth=1,e.strokeRect(b,f,v,y)),r.parent?.()||dr(e,t,n,rr({feature:r,config:c,configContext:i,theme:s}))}};var hr=n(19598),gr=n(15943),mr=n(7810);function fr(e){return 1/e>=1}const yr={type:"CDS",match:e=>"CDS"===e.get("type"),layout(e){const{feature:t,bpPerPx:n,configContext:r}=e,{config:a,displayMode:o,featureHeight:i}=r,s=Jn(i,a,"height",t),l="compact"===o?s/2:s,c=(t.get("end")-t.get("start"))/n;return{feature:t,glyphType:"CDS",x:0,y:0,width:c,height:l,totalLayoutHeight:l,totalLayoutWidth:c,leftPadding:0,children:[]}},draw(e,t,n){const{feature:r}=t,{region:a,bpPerPx:o,configContext:i,theme:s,canvasWidth:l,peptideDataMap:c}=n,{config:d}=i,u=n.colorByCDS??!1,p=a.reversed??!1,h=r.get("start"),g=r.get("end"),m=r.get("strand"),f=t.width,y=t.x,b=t.y,w=t.height;if(er(y,f,l))return;const v=r.parent?.()??r,S=c?.get(v.id()),k=S?.protein;if(fr(o)&&u&&k){const t=function(e,t,n,r,a){return function(e,t,n,r,a){const o=[],i=r-n;let s,l=null,c=0,d=0;for(let u=0;u<i;u++){const i=-1===a?r-u:n+u,p=t[i];if(void 0===p){console.warn(`No g2p mapping for position ${i}`);continue}const h=e[p]??"&";void 0===s?(s=p,l=h,c=d):s!==p&&(o.push({aminoAcid:l,startIndex:c,endIndex:d-1,length:d-c,proteinIndex:s}),s=p,l=h,c=d),d++}return null!==l&&o.push({aminoAcid:l,startIndex:c,endIndex:d-1,length:d-c,proteinIndex:s}),o}(t,(0,mr.W)(e.toJSON()).g2p,n,r,a)}(v,k,h,g,m);!function(e){const{ctx:t,aggregatedAminoAcids:n,baseColor:r,left:a,top:o,width:i,height:s,bpPerPx:l,strand:c,reversed:d,canvasWidth:u}=e,p=Qn(c,d),h=1/l,g=(0,hr.M)(r).toHex(),m=(0,gr.a)(g,.2),f=(0,gr.e$)(g,.1);for(let e=0,r=n.length;e<r;e++){const r=n[e],l=e%2==1?f:m,c=Yn(a,i,r.startIndex,h,p),d=Yn(a,i,r.endIndex+1,h,p),g=Math.min(c,d),y=Math.abs(c-d);g+y<0||g>u||(t.fillStyle=l,t.fillRect(g,o,y,s))}}({ctx:e,aggregatedAminoAcids:t,baseColor:nr({feature:r,config:d,configContext:i,colorByCDS:u,theme:s}),left:y,top:b,width:f,height:w,bpPerPx:o,strand:m,reversed:p,canvasWidth:l}),function(e){return 1/e>=8}(o)&&function(e){const{ctx:t,aggregatedAminoAcids:n,left:r,top:a,width:o,height:i,bpPerPx:s,strand:l,reversed:c,canvasWidth:d}=e;if(i<8)return;const u=Qn(l,c),p=1/s,h=i;t.font=`${h}px sans-serif`,t.textAlign="center",t.textBaseline="middle";const g=a+i/2;for(const e of n){const n=(Yn(r,o,e.startIndex,p,u)+Yn(r,o,e.endIndex+1,p,u))/2;if(n<0||n>d)continue;const a=e.length%3!=0||"&"===e.aminoAcid;t.fillStyle=a?"red":"black";const i=a||"*"===e.aminoAcid||"&"===e.aminoAcid?e.aminoAcid:`${e.aminoAcid}${e.proteinIndex+1}`;t.fillText(i,n,g)}}({ctx:e,aggregatedAminoAcids:t,left:y,top:b,width:f,height:w,bpPerPx:o,strand:m,reversed:p,canvasWidth:l})}else pr.draw(e,{...t,glyphType:"Box"},n)}},br=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#aec7e8","#ffbb78"],wr=new Set(["mature_protein_region_of_CDS","mature_protein_region"]);function vr(e){const t=e.get("subfeatures");return t?.filter(e=>wr.has(e.get("type")))??[]}const Sr={type:"MatureProteinRegion",hasIndexableChildren:!0,match:e=>"CDS"===e.get("type")&&vr(e).length>0,getSubfeatureMouseover(e){const t=e.get("product"),n=e.get("protein_id"),r=[];return t&&r.push(t),n&&r.push(`(${n})`),r.length>0?r.join(" "):void 0},layout(e){const{feature:t,bpPerPx:n,configContext:r}=e,{config:a,displayMode:o,featureHeight:i,subfeatureLabels:s}=r,l=t.get("start"),c=t.get("end"),d=Jn(i,a,"height",t),u="compact"===o?d/2:d,p=(c-l)/n,h=(y=vr(t).map(n=>sr(n,t,e)),[...y].sort((e,t)=>{const n=e.feature.get("start"),r=t.feature.get("start");return n!==r?n-r:t.feature.get("end")-e.feature.get("end")})),g=u*("below"===s?2:1),m=g*Math.max(1,h.length),f="below"===s?Math.floor(g/2)-1:g-2;var y;for(const[e,t]of h.entries()){const n=t;n.y=e*g+1,n.height=f,n.totalLayoutHeight=g}return{feature:t,glyphType:"MatureProteinRegion",x:0,y:0,width:p,height:m,totalLayoutHeight:m,totalLayoutWidth:p,leftPadding:0,children:h}},draw(e,t,n){const{children:r}=t,{region:a,theme:o,canvasWidth:i}=n,s=a.reversed??!1,l=o.palette.text.secondary;for(const[t,n]of r.entries())kr(e,n,i,br[t%br.length],s,l)}};function kr(e,t,n,r,a,o){const{x:i,y:s,width:l,height:c,feature:d}=t;if(er(i,l,n))return;e.fillStyle=r,e.fillRect(i,s,l,c),e.strokeStyle="rgba(0,0,0,0.3)",e.lineWidth=1,e.strokeRect(i,s,l,c);const u=d.get("strand");u&&cr(e,i,s+c/2,l,u,a,o)}function xr(e,t){let n=e.get("subfeatures");if(!n||0===n.length)return[];const r=n.some(e=>tr(e)),a=["mRNA","transcript"].includes(e.get("type"));(!r&&a||(0,R.QZ)(t,"impliedUTRs"))&&(n=function(e,t){const n=[...t];let r,a,o=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;const s=[];for(const t of n){const n=t.get("type");/^cds/i.test(n)?(o>t.get("start")&&(o=t.get("start")),i<t.get("end")&&(i=t.get("end"))):/exon/i.test(n)?s.push(t):tr(t)&&(r=t.get("start")===e.get("start"),a=t.get("end")===e.get("end"))}if(!(s.length&&o<Number.POSITIVE_INFINITY&&i>Number.NEGATIVE_INFINITY))return n;s.sort((e,t)=>e.get("start")-t.get("start"));const l=e.get("strand");let c,d;if(!r)for(const[t,r]of s.entries()){if(c=r.get("start"),c>=o)break;d=Math.min(o,r.get("end"));const a=l>=0?"five_prime_UTR":"three_prime_UTR";n.unshift(new q.A({parent:e,id:`${e.id()}_${a}_${t}`,data:{start:c,end:d,strand:l,type:a}}))}if(!a)for(let t=s.length-1;t>=0&&(d=s[t].get("end"),!(d<=i));t--){c=Math.max(i,s[t].get("start"));const r=l>=0?"three_prime_UTR":"five_prime_UTR";n.push(new q.A({parent:e,id:`${e.id()}_${r}_${t}`,data:{start:c,end:d,strand:l,type:r}}))}return n}(e,n));const o=function(e,t){const n=(0,R.QZ)(t,e),r="string"==typeof n?n.split(/\s*,\s*/):n,a=new Set(r.map(e=>e.toLowerCase()));return e=>a.has(e.get("type").toLowerCase())}("subParts",t);return n.filter(o)}const Cr={type:"ProcessedTranscript",match(e,t){const n=e.get("type"),r=e.get("subfeatures");if(!r?.length)return!1;const{transcriptTypes:a}=t;if(!a.includes(n))return!1;return r.some(e=>"CDS"===e.get("type"))},layout(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a}=e,{config:o,displayMode:i,featureHeight:s}=a,l=t.get("start"),c=t.get("end"),d=Jn(s,o,"height",t),u="compact"===i?d/2:d,p=(c-l)/n,h=ir(t.get("strand"),r),g=xr(t,o).map(n=>{const r=n.get("type");return sr(n,t,e,"CDS"===r?"CDS":"Box")});return{feature:t,glyphType:"ProcessedTranscript",x:0,y:0,width:p,height:u,totalLayoutHeight:u,totalLayoutWidth:p+h.left+h.right,leftPadding:h.left,children:g}},draw(e,t,n){ur(e,t,n,pr,yr)}},Tr={CACTA_TIR_transposon:"#e6194b",centromeric_repeat:"#3cb44b",Copia_LTR_retrotransposon:"#118119",Gypsy_LTR_retrotransposon:"#4363d8",hAT_TIR_transposon:"#f58231",helitron:"#911eb4",knob:"#46f0f0",L1_LINE_retrotransposon:"#f032e6",LINE_element:"#bcf60c",long_terminal_repeat:"#fb0",low_complexity:"#008080",LTR_retrotransposon:"#e6beff",Mutator_TIR_transposon:"#9a6324",PIF_Harbinger_TIR_transposon:"#fffac8",rDNA_intergenic_spacer_element:"#800000",repeat_region:"#aaffc3",RTE_LINE_retrotransposon:"#808000",subtelomere:"#ffd8b1",target_site_duplication:"#000075",Tc1_Mariner_TIR_transposon:"#808080"},Ar={type:"RepeatRegion",match(e){const t=e.get("type"),n=e.get("subfeatures");return"repeat_region"===t&&!!n?.length},layout(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a}=e,{config:o,displayMode:i,featureHeight:s}=a,l=t.get("start"),c=t.get("end"),d=Jn(s,o,"height",t),u="compact"===i?d/2:d,p=(c-l)/n,h=ir(t.get("strand"),r),g=(t.get("subfeatures")||[]).map(n=>sr(n,t,e));return{feature:t,glyphType:"RepeatRegion",x:0,y:0,width:p,height:u,totalLayoutHeight:u,totalLayoutWidth:p+h.left+h.right,leftPadding:h.left,children:g}},draw(e,t,n){const{children:r}=t,{theme:a,canvasWidth:o}=n,i=t.x,s=t.width,l=t.y,c=t.height;if(er(i,s,o))return;const d=a.palette.text.secondary;lr(e,i,l,s,c,d);const u=[...r].sort((e,t)=>{const n=e.feature.get("type"),r=t.feature.get("type");return n.endsWith("_retrotransposon")?-1:r.endsWith("_retrotransposon")?1:0});for(const t of u){const n=t.feature.get("type");Mr(e,t,o,Tr[n]||"#000",n.endsWith("_retrotransposon"))}dr(e,t,n,d)}};function Mr(e,t,n,r,a){const{x:o,width:i,y:s,height:l}=t;if(er(o,i,n))return;let c=s,d=l;a&&(c+=.175*d,d*=.65),e.fillStyle=r,e.fillRect(o,c,i,d)}const Pr={type:"Segments",match(e,t){const n=e.get("type");if("CDS"===n)return!1;const r=e.get("subfeatures");if(!r?.length)return!1;const{transcriptTypes:a,containerTypes:o}=t;if(a.includes(n)){if(r.some(e=>"CDS"===e.get("type")))return!1}if(o.includes(n))return!1;const i=!e.parent?.(),s=r.some(e=>e.get("subfeatures")?.length);return!i||!s},layout(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a}=e,{config:o,displayMode:i,featureHeight:s}=a,l=t.get("start"),c=t.get("end"),d=Jn(s,o,"height",t),u="compact"===i?d/2:d,p=(c-l)/n,h=ir(t.get("strand"),r),g=(t.get("subfeatures")||[]).map(n=>{const r=n.get("type");return sr(n,t,e,"CDS"===r?"CDS":"Box")});return{feature:t,glyphType:"Segments",x:0,y:0,width:p,height:u,totalLayoutHeight:u,totalLayoutWidth:p+h.left+h.right,leftPadding:h.left,children:g}},draw(e,t,n){ur(e,t,n,pr,yr)}};function Ir(e,t){const{feature:n,configContext:r,isNested:a,isTranscriptChild:o}=t,{config:i,showLabels:s,showDescriptions:l,subfeatureLabels:c,fontHeight:d,labelAllowed:u}=r;if(!u||a&&(!o||"none"===c))return;const p=!!o||s,h=!o&&l,g=Zn(String((0,R.QZ)(i,["labels","name"],{feature:n})||"")),m=/\S/.test(g)&&p,f=Zn(String((0,R.QZ)(i,["labels","description"],{feature:n})||"")),y=/\S/.test(f)&&h,b=Jn(d,i,["labels","fontSize"],n);let w=0,v=0;m&&(w+=b,v=Math.max(v,(0,x.measureText)(g,b))),y&&(w+=b,v=Math.max(v,(0,x.measureText)(f,b))),o&&"overlay"===c||(e.totalLayoutHeight=e.height+w),e.totalLayoutWidth=Math.max(e.totalLayoutWidth,v)}const Rr=[Sr,Ar,yr,Cr,Pr,pr];function Lr(e,t){return Br(e,t,Rr)}const Fr=new Set(["CDS","cds"]);function Dr(e){return(e.get("subfeatures")||[]).some(e=>Fr.has(e.get("type"))||Dr(e))}const Nr=[Sr,Ar,yr,Cr,{type:"Subfeatures",match(e,t){const n=e.get("type"),r=e.get("subfeatures");if(!r?.length)return!1;const{containerTypes:a}=t;if(a.includes(n))return!0;const o=!e.parent?.(),i=r.some(e=>e.get("subfeatures")?.length);return o&&i},layout(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a}=e,{config:o,displayMode:i,featureHeight:s,geneGlyphMode:l,transcriptTypes:c}=a,d=t.get("start"),u=t.get("end"),p=Jn(s,o,"height",t),h="compact"===i?p/2:p,g=(u-d)/n;let m=[...t.get("subfeatures")||[]];const f=new Map(m.map(e=>[e.id(),Dr(e)]));m.sort((e,t)=>{const n=f.get(e.id()),r=f.get(t.id());return n&&!r?-1:!n&&r?1:0}),"longest"!==l&&"longestCoding"!==l||(m=function(e,t,n){if(e.length<=1)return e;const r=e.filter(e=>t.includes(e.get("type")));let a=r.length>0?r:e;if("longestCoding"===n){const e=a.filter(Dr);e.length>0&&(a=e)}return[a.reduce((e,t)=>e.get("end")-e.get("start")>t.get("end")-t.get("start")?e:t)]}(m,c,l));const y=[];let b=0;const{subfeatureLabels:w}=a;for(let o=0;o<m.length;o++){const i=m[o],s=i.get("type"),l=c.includes(s),p=Lr(i,a).layout({...e,feature:i,parentFeature:t});Ir(p,{feature:i,configContext:a,isNested:!0,isTranscriptChild:l});const h={start:i.get("start"),end:i.get("end")},g=(r?u-h.end:h.start-d)/n;p.x=g,p.y=b,y.push(p),b+="below"===w&&l?p.totalLayoutHeight:p.height,o<m.length-1&&(b+=2)}const v=b>0?b:h;return{feature:t,glyphType:"Subfeatures",x:0,y:0,width:g,height:v,totalLayoutHeight:v,totalLayoutWidth:g,leftPadding:0,children:y}},draw(e,t,n){const{children:r}=t;if(0!==r.length)for(const t of r)Lr(t.feature,n.configContext).draw(e,t,n);else pr.draw(e,{...t,glyphType:"Box"},n)}},Pr,pr];function Br(e,t,n=Nr){return n.find(n=>n.match(e,t))??pr}function Er(e,t){if(t)return[...t.getGlyphTypes()].sort((e,t)=>t.priority-e.priority).find(t=>t.match?.(e))}function Vr(e){const{feature:t,bpPerPx:n,reversed:r,configContext:a,pluginManager:o,isNested:i=!1,isTranscriptChild:s=!1}=e,l=Er(t,o);let c;if(l){const e=l.getHeightMultiplier?.(t,a.config)??1,i={feature:t,bpPerPx:n,reversed:r,configContext:a,pluginManager:o};c=Br(t,a,Nr).layout(i),c.height*=e,c.totalLayoutHeight*=e}else{const e={feature:t,bpPerPx:n,reversed:r,configContext:a,pluginManager:o};c=Br(t,a,Nr).layout(e)}return Ir(c,{feature:t,configContext:a,isNested:i,isTranscriptChild:s}),c}var zr=n(17868),jr=n(57141);const Hr=Object.fromEntries(Nr.map(e=>[e.type,e]));function _r(e,t,n,r){const a=Er(t.feature,r);if(a)return void a.draw({ctx:e,feature:t.feature,featureLayout:t,region:n.region,bpPerPx:n.bpPerPx,config:n.configContext.config,theme:n.theme,reversed:n.region.reversed??!1,topLevel:!0,canvasWidth:n.canvasWidth});const o=Hr[t.glyphType];o?o.draw(e,t,n):pr.draw(e,t,n)}function Or(e){return{...e}}function $r(e,t,n){const r=t+e.x,a=n+e.y;return{...e,x:r,y:a,children:e.children.map(e=>$r(e,r,a))}}function Gr({layout:e,featureLayout:t,subfeatureCoords:n,subfeatureInfos:r,config:a,configContext:o,pluginManager:i,subfeatureLabels:s,transcriptTypes:l,labelColor:c,parentTooltip:d}){Wr({layout:e,featureLayout:t,subfeatureCoords:n,subfeatureInfos:r,config:a,configContext:o,pluginManager:i,subfeatureLabels:s,transcriptTypes:l,labelColor:c,parentTooltip:d})}function Wr({layout:e,featureLayout:t,subfeatureCoords:n,subfeatureInfos:r,config:a,configContext:o,pluginManager:i,subfeatureLabels:s,transcriptTypes:l,labelColor:c,parentTooltip:d}){const u=t.feature,p="gene"===u.get("type"),h=function(e,t,n){const r=Nr.find(n=>n.hasIndexableChildren&&n.match(e,t));if(r)return r;if(n){const t=[...n.getGlyphTypes()].sort((e,t)=>t.priority-e.priority).find(t=>t.match?.(e)&&t.getChildFeatures);if(t)return t}}(u,o,i),g=p&&t.children.some(e=>l.includes(e.feature.get("type"))),m="none"!==s;if(h||g)for(const o of t.children){const i=o.feature,u=i.get("type");if(g&&!h&&!l.includes(u))continue;const p=o.x,f=o.x+o.totalLayoutWidth,y=o.y,b=o.y+o.totalLayoutHeight;n.push(p,y,f,b);const w=h?.getSubfeatureMouseover?.(i),v=w??String((0,R.QZ)(a,"subfeatureMouseover",{feature:i})||"");r.push({featureId:i.id(),parentFeatureId:t.feature.id(),displayLabel:v,type:u,leftPx:p,topPx:y,rightPx:f,bottomPx:b});const S=[];if(m&&v){const e=or({displayLabel:v,featureHeight:o.height,subfeatureLabels:s,color:c,parentFeatureId:t.feature.id(),subfeatureId:i.id(),tooltip:h?v:d});e&&S.push(e)}const k=i.get("start"),x=i.get("end");e.addRect(i.id(),k,x,b-y,i,m&&S.length>0?Or({refName:i.get("refName"),floatingLabels:S,totalFeatureHeight:o.height,totalLayoutWidth:o.totalLayoutWidth,actualTopPx:y,featureWidth:o.width,featureStartBp:k,featureEndBp:x}):{refName:i.get("refName")})}for(const u of t.children)Wr({layout:e,featureLayout:u,subfeatureCoords:n,subfeatureInfos:r,config:a,configContext:o,pluginManager:i,subfeatureLabels:s,transcriptTypes:l,labelColor:c,parentTooltip:d})}function Ur(e,t){const n=new jr.A(Math.max(t,1));if(e.length)for(let t=0;t<e.length;t+=4)n.add(e[t],e[t+1],e[t+2],e[t+3]);else n.add(0,0,0,0);return n.finish(),n}var qr=n(66867);const Jr=["mRNA","transcript","primary_transcript","protein_coding_primary_transcript"];function Xr(e,t=Jr){return t.includes(e)}function Kr(e){const t=e.get("subfeatures");return t?.some(e=>"CDS"===e.get("type"))??!1}async function Qr(e,t,n){try{const r={...t.regions[0],start:n.get("start"),end:n.get("end")};let a=await async function(e,t,n){const{sessionId:r,sequenceAdapter:a}=t;if(a)try{const{dataAdapter:t}=await(0,ot.cK)(e,r,a),o=await(0,it._)(t.getFeatures({...n,refName:n.seqAdapterRefName??n.refName,start:Math.max(0,n.start)}).pipe((0,st.$)()));return o[0]?.get("seq")}catch(e){return void console.warn("[fetchSequence] Failed to fetch sequence:",e)}}(e,t,r);if(!a)return;const o=n.get("strand");let i=function(e){const t=e.get("subfeatures")||[],n=e.get("start");return t.filter(e=>"CDS"===e.get("type")).sort((e,t)=>e.get("start")-t.get("start")).map(e=>({start:e.get("start")-n,end:e.get("end")-n}))}(n);if(0===i.length)return;if(-1===o){a=(0,x.revcom)(a);const e=a.length;i=i.map(t=>({start:e-t.end,end:e-t.start})).reverse()}const s={seq:a,cds:i};try{return{sequenceData:s,protein:(0,qr.E)({cds:i,sequence:a,codonTable:(0,x.generateCodonTable)(x.defaultCodonTable)})}}catch(e){return console.warn(`[fetchTranscriptPeptides] Failed to convert sequence to peptides for ${n.id()}:`,e),{sequenceData:s}}}catch(e){return void console.warn(`[fetchTranscriptPeptides] Failed to fetch sequence for transcript ${n.id()}:`,e)}}async function Yr({layout:e,features:t,renderProps:n,pluginManager:r}){const{statusCallback:a=()=>{},regions:o,bpPerPx:i,config:s}=n,l=o[0],c=Math.max(1,(l.end-l.start)/i),d=function(e){const t=(0,R.QZ)(e,"displayMode");return{config:e,displayMode:t,showLabels:(0,R.QZ)(e,"showLabels"),showDescriptions:(0,R.QZ)(e,"showDescriptions"),subfeatureLabels:(0,R.QZ)(e,"subfeatureLabels"),transcriptTypes:(0,R.QZ)(e,"transcriptTypes"),containerTypes:(0,R.QZ)(e,"containerTypes"),geneGlyphMode:(0,R.QZ)(e,"geneGlyphMode"),displayDirectionalChevrons:(0,R.QZ)(e,"displayDirectionalChevrons"),color1:Xn(e,"color1","goldenrod"),color2:Xn(e,"color2","#f0f"),color3:Xn(e,"color3","#357089"),outline:Xn(e,"outline",""),featureHeight:Xn(e,"height",10),fontHeight:Xn(e,["labels","fontSize"],12),labelAllowed:"collapse"!==t}}(s),u=await(0,x.updateStatus)("Computing feature layout",a,async()=>function({features:e,bpPerPx:t,region:n,configContext:r,layout:a,pluginManager:o}){const i=n.reversed||!1,s=[],{config:l}=r;for(const n of e.values()){const e=Vr({feature:n,bpPerPx:t,reversed:i,configContext:r,pluginManager:o}),c=e.totalLayoutWidth,d=e.totalLayoutHeight,u=String((0,R.QZ)(l,["labels","name"],{feature:n})||""),p=String((0,R.QZ)(l,["labels","description"],{feature:n})||""),h=ar({feature:n,config:l,configContext:r,nameColor:"black",descriptionColor:"blue",name:u,description:p}),g=n.get("start"),m=n.get("end"),f=g-e.leftPadding*t,y=m+(c-e.width-e.leftPadding)*t,b=a.addRect(n.id(),f,y,d+5,n,{label:u,description:p,refName:n.get("refName"),floatingLabels:h,totalFeatureHeight:e.height,totalLayoutWidth:c,featureWidth:e.width,featureStartBp:g,featureEndBp:m});null!==b&&s.push({feature:n,layout:e,topPx:b,label:u,description:p})}return s}({features:t,bpPerPx:i,region:l,configContext:d,layout:e,pluginManager:r})),p=Math.max(1,e.getTotalHeight()),h=await(0,x.updateStatus)("Fetching peptide data",a,async()=>async function(e,t,n){const{colorByCDS:r,bpPerPx:a}=t,o=new Map;if(!r||!fr(a))return o;for(const r of function(e){const t=[];for(const n of e.values()){const e=n.get("type"),r=n.get("subfeatures");if("gene"===e&&r?.length)for(const e of r)Xr(e.get("type"))&&Kr(e)&&t.push(e);else Xr(e)&&Kr(n)&&t.push(n)}return t}(n)){const n=await Qr(e,t,r);n&&o.set(r.id(),n)}return o}(r,n,t));return(0,x.updateStatus)("Rendering features",a,async()=>(0,qn.u)(c,p,n,a=>function({ctx:e,layoutRecords:t,canvasWidth:n,renderArgs:r,configContext:a}){const{bpPerPx:o,regions:i,theme:s,stopToken:l,layout:c,peptideDataMap:d,colorByCDS:u,pluginManager:p}=r,h=i[0],g=(0,zr.createJBrowseTheme)(s),m={region:h,bpPerPx:o,configContext:a,theme:g,canvasWidth:n,peptideDataMap:d,colorByCDS:u},f=[],y=[],b=[],w=[];e.textBaseline="top",e.textAlign="left";const{subfeatureLabels:v,transcriptTypes:S,config:k}=a,C=(0,He.jL)(l);for(const n of t){const{feature:t,layout:r,topPx:i,label:s,description:l}=n,d=t.get(h.reversed?"end":"start"),u=$r(r,(0,x.bpToPx)(d,h,o),i);_r(e,u,m,p);const T={left:u.x,right:u.x+u.totalLayoutWidth,top:u.y,bottom:u.y+u.totalLayoutHeight},A=String((0,R.QZ)(k,"mouseover",{feature:t,label:s,description:l})||"");f.push(T.left,T.top,T.right,T.bottom),y.push({featureId:t.id(),type:"box",startBp:t.get("start"),endBp:t.get("end"),leftPx:T.left,rightPx:T.right,topPx:T.top,bottomPx:T.bottom,tooltip:A}),Gr({layout:c,featureLayout:u,subfeatureCoords:b,subfeatureInfos:w,config:k,configContext:a,pluginManager:p,subfeatureLabels:v,transcriptTypes:S,labelColor:g.palette.text.primary,parentTooltip:A}),(0,He.As)(C)}return{flatbush:Ur(f,y.length).data,items:y,subfeatureFlatbush:Ur(b,w.length).data,subfeatureInfos:w}}({ctx:a,layoutRecords:u,canvasWidth:c,renderArgs:{...n,features:t,layout:e,displayMode:d.displayMode,peptideDataMap:h,colorByCDS:n.colorByCDS,pluginManager:r},configContext:d})))}class Zr extends mt.default{supportsSVG=!0;async render(e){const t=await this.getFeatures(e),n=this.createLayoutInWorker(e),{regions:r,bpPerPx:a}=e,o=r[0],i=Math.max(1,(o.end-o.start)/a),s=await Yr({pluginManager:this.pluginManager,renderProps:e,layout:n,features:t}),l=Math.max(1,n.getTotalHeight()),c=this.serializeLayout(n,e),d={...s,layout:c,height:l,width:i,maxHeightReached:n.maxHeightReached};return(0,yt.lk)(d,(0,bt.X)(s))}}const ea=(0,i.S7)("CanvasFeatureRenderer",{color1:{type:"color",description:"the main color of each feature",defaultValue:"goldenrod",contextVariable:["feature"]},color2:{type:"color",description:"the secondary color of each feature, used for connecting lines, etc",defaultValue:"#f0f",contextVariable:["feature"]},color3:{type:"color",description:"the tertiary color of each feature, often used for contrasting fills, like on UTRs",defaultValue:"#357089",contextVariable:["feature"]},outline:{type:"color",description:"the outline for features",defaultValue:"",contextVariable:["feature"]},height:{type:"number",description:"height in pixels of the main body of each feature",defaultValue:10,contextVariable:["feature"]},showLabels:{type:"boolean",defaultValue:!0},showDescriptions:{type:"boolean",defaultValue:!0},subfeatureLabels:{type:"stringEnum",model:c.types.enumeration("subfeatureLabels",["none","below","overlay"]),description:'subfeature label display: "none" hides labels, "below" reserves extra space, "overlay" draws on top of feature',defaultValue:"none"},mouseover:{type:"string",description:"the mouseover tooltip label for features. Available variables: feature (the feature object), label (evaluated name), description (evaluated description)",defaultValue:"jexl:get(feature,'_mouseover') || get(feature,'_mouseOver') || (label && description ? label + '<br/>' + description : (label || description || ''))",contextVariable:["feature","label","description"]},subfeatureMouseover:{type:"string",description:"the mouseover tooltip label for subfeatures (e.g. transcripts). Available variables: feature (the subfeature object)",defaultValue:"jexl:get(feature,'name') || get(feature,'id')",contextVariable:["feature"]},labels:(0,i.S7)("CanvasFeatureLabels",{name:{type:"string",description:"the primary name of the feature to show, if space is available",defaultValue:"jexl:get(feature,'name') || get(feature,'id')",contextVariable:["feature"]},nameColor:{type:"color",description:"the color of the name label, if shown",defaultValue:"#f0f",contextVariable:["feature"]},description:{type:"string",description:"the text description to show, if space is available",defaultValue:"jexl:get(feature,'note') || get(feature,'description')",contextVariable:["feature"]},descriptionColor:{type:"color",description:"the color of the description, if shown",defaultValue:"blue",contextVariable:["feature"]},fontSize:{type:"number",description:"height in pixels of the text to use for names and descriptions",defaultValue:12,contextVariable:["feature"]}}),displayMode:{type:"stringEnum",model:c.types.enumeration("displayMode",["normal","compact","reducedRepresentation","collapse"]),description:"Alternative display modes",defaultValue:"normal"},maxFeatureGlyphExpansion:{type:"number",description:"maximum number of pixels on each side of a feature's bounding coordinates that a glyph is allowed to use",defaultValue:500},maxHeight:{type:"integer",description:"the maximum height to be used in a rendering",defaultValue:5e3},subParts:{type:"string",description:"subparts for a glyph",defaultValue:"CDS,UTR,five_prime_UTR,three_prime_UTR"},impliedUTRs:{type:"boolean",description:"imply UTR from the exon and CDS differences",defaultValue:!1},transcriptTypes:{type:"stringArray",defaultValue:["mRNA","transcript","primary_transcript"]},containerTypes:{type:"stringArray",defaultValue:["proteoform_orf"]},geneGlyphMode:{type:"stringEnum",model:c.types.enumeration("geneGlyphMode",["all","longest","longestCoding"]),description:'Gene glyph display mode: "all" shows all transcripts, "longest" shows only the longest transcript, "longestCoding" shows only the longest coding transcript',defaultValue:"all"},displayDirectionalChevrons:{type:"boolean",description:"Display directional chevrons on intron lines to indicate strand direction",defaultValue:!0}},{explicitlyTyped:!0}),ta=(0,i.S7)("SvgFeatureRenderer",{},{explicitlyTyped:!0,baseConfiguration:ea});class na extends r.A{name="CanvasPlugin";install(e){!function(e){e.addRendererType(()=>new Zr({name:"CanvasFeatureRenderer",ReactComponent:(0,a.lazy)(()=>n.e(4628).then(n.bind(n,14628))),configSchema:ea,pluginManager:e})),e.addRendererType(()=>new Zr({name:"SvgFeatureRenderer",ReactComponent:(0,a.lazy)(()=>n.e(4628).then(n.bind(n,14628))),configSchema:ta,pluginManager:e}))}(e)}}var ra=n(63770),aa=n(58693),oa=n(25729);function ia(e,t,n,r,a){const o=Math.abs(e-n);if(o>r)return;o===r&&a.push([t,e]);const i=Math.sqrt(r*r-o*o);a.push([t-i,e],[t+i,e])}function sa(e,t,n,r,a){const o=Math.abs(e-t);if(o>r)return;o===r&&a.push([e,n]);const i=Math.sqrt(r*r-o*o);a.push([e,n-i],[e,n+i])}function la(e,t){const n=Math.sqrt(e*e+t*t);if(0===n)return[0,0];const r=function(e,t){let n=(Math.atan(t/e)+2*Math.PI)%(2*Math.PI);return e<0&&(t<=0?n+=Math.PI:n-=Math.PI),n}(e,t);return[n,r]}const ca=2*Math.PI;class da{constructor(e,t,n,r){this.region=t,this.offsetRadians=n,this.radianWidth=r;const{bpPerRadian:a}=e;this.key="regions"in t?JSON.stringify(t.regions):(0,x.assembleLocString)(t),this.bpPerRadian=a,this.flipped=!1,this.startRadians=n,this.endRadians=t.widthBp/this.bpPerRadian+n,Object.freeze(this)}bpToXY(e,t){let n;n=this.region.elided?this.region.widthBp/2:this.flipped?this.region.end-e:e-this.region.start;const r=n/this.bpPerRadian+this.offsetRadians;return(0,x.polarToCartesian)(t,r)}toJSON(){return Object.fromEntries(Object.entries(this))}}const ua=(0,a.lazy)(()=>Promise.all([n.e(5049),n.e(9865)]).then(n.bind(n,19865))),pa=function(e){const t=-Math.PI/2;return c.types.compose("CircularView",Hn.A,c.types.model({type:c.types.literal("CircularView"),offsetRadians:t,bpPerPx:200,tracks:c.types.array(e.pluggableMstType("track","stateModel")),hideVerticalResizeHandle:!1,hideTrackSelectorButton:!1,lockedFitToWindow:!0,disableImportForm:!1,height:c.types.optional(c.types.number,400),displayedRegions:c.types.optional(c.types.frozen(),[]),scrollX:0,scrollY:0,minimumRadiusPx:25,spacingPx:10,paddingPx:80,lockedPaddingPx:100,minVisibleWidth:6,minimumBlockWidth:20,trackSelectorType:"hierarchical",init:c.types.frozen()})).volatile(()=>({volatileWidth:void 0,volatileError:void 0})).views(e=>({get width(){if(void 0===e.volatileWidth)throw new Error("wait for view to be initialized first before accessing width");return e.volatileWidth},get visibleSection(){const{scrollX:t,scrollY:n,width:r,height:a}=e;return function(e,t,n){let[r,a,o,i]=e;const[s,l]=t;if(r-=s,a-=s,o-=l,i-=l,r<0&&a>0&&o<0&&i>0){const e=[[r,o],[a,o],[r,i],[a,i]];let t=Number.NEGATIVE_INFINITY;for(const[n,r]of e){const e=Math.sqrt(n*n+r*r);e>t&&(t=e)}return{rho:[0,Math.min(n,t)],theta:[0,2*Math.PI]}}const c=[[r,o],[a,o],[r,i],[a,i]];sa(r,0,0,n,c),sa(a,0,0,n,c),ia(o,0,0,n,c),ia(i,0,0,n,c),-r<n&&c.push([r,0]),a<n&&c.push([a,0]),-o<n&&c.push([0,o]),i<n&&c.push([0,i]);const d=r>=0?-1:1;let u=Number.POSITIVE_INFINITY,p=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(const[e,t]of c)if(e>=r&&e<=a&&t>=o&&t<=i){const[r,a]=la(e*d,t*d);r<=n+.001&&(a<h&&r>1e-4&&(h=a),a>g&&r>1e-4&&(g=a),r<u&&(u=r),r>p&&(p=r))}return-1===d&&(h+=Math.PI,g+=Math.PI),h>2*Math.PI&&g>2*Math.PI&&(h-=2*Math.PI,g-=2*Math.PI),{rho:[u,Math.min(n,p)],theta:[h,g]}}([t,t+r,n,n+a],this.centerXY,this.radiusPx)},get circumferencePx(){let t=0;for(const e of this.elidedRegions)t+=e.widthBp;return t/e.bpPerPx+e.spacingPx*this.elidedRegions.length},get radiusPx(){return this.circumferencePx/(2*Math.PI)},get bpPerRadian(){return e.bpPerPx*this.radiusPx},get pxPerRadian(){return this.radiusPx},get centerXY(){return[this.radiusPx+e.paddingPx,this.radiusPx+e.paddingPx]},get totalBp(){let t=0;for(const n of e.displayedRegions)t+=n.end-n.start;return t},get maximumRadiusPx(){return e.lockedFitToWindow?Math.min(e.width,e.height)/2-e.lockedPaddingPx:1e6},get maxBpPerPx(){const t=2*Math.PI*e.minimumRadiusPx;return this.totalBp/t},get minBpPerPx(){const e=2*Math.PI*this.maximumRadiusPx;return(0,x.clamp)(this.totalBp/e,1e-10,this.maxBpPerPx)},get atMaxBpPerPx(){return e.bpPerPx>=this.maxBpPerPx},get atMinBpPerPx(){return e.bpPerPx<=this.minBpPerPx},get tooSmallToLock(){return this.minBpPerPx<=1e-10},get figureDimensions(){return[2*this.radiusPx+2*e.paddingPx,2*this.radiusPx+2*e.paddingPx]},get figureWidth(){return this.figureDimensions[0]},get figureHeight(){return this.figureDimensions[1]},get elidedRegions(){const t=[];for(const n of e.displayedRegions){const r=n.end-n.start;if(r/e.bpPerPx<e.minVisibleWidth){const e=t.at(-1);e?.elided?(e.regions.push({...n}),e.widthBp+=r):t.push({elided:!0,widthBp:r,regions:[{...n}]})}else t.push({...n,widthBp:r,elided:!1})}for(let e=0;e<t.length;e+=1){const n=t[e];n.elided&&1===n.regions.length&&(t[e]={...n,...n.regions[0],elided:!1})}return t},get assemblyNames(){const t=[];for(const n of e.displayedRegions)t.includes(n.assemblyName)||t.push(n.assemblyName);return t},get initialized(){if(void 0===e.volatileWidth)return!1;const{assemblyManager:t}=(0,x.getSession)(e);if(e.init){const n=t.get(e.init.assembly);return!(!n?.initialized||!n.regions)}return this.assemblyNames.every(e=>t.get(e)?.initialized)},get assemblyErrors(){const{assemblyManager:t}=(0,x.getSession)(e);return this.assemblyNames.map(e=>t.get(e)?.error).filter(e=>!!e).join(", ")},get error(){if(e.volatileError)return e.volatileError;if(this.assemblyErrors)return this.assemblyErrors;if(e.init){const{assemblyManager:t}=(0,x.getSession)(e),n=t.get(e.init.assembly);if(n?.error)return n.error;if(!n)return`Assembly ${e.init.assembly} not found`}},get loadingMessage(){return this.showLoading?"Loading":void 0},get hasSomethingToShow(){return e.displayedRegions.length>0||!!e.init},get showLoading(){return!this.initialized&&!this.error&&this.hasSomethingToShow},get showView(){return!!e.displayedRegions.length&&!!this.figureWidth&&!!this.figureHeight&&this.initialized},get showImportForm(){return!this.hasSomethingToShow&&!e.disableImportForm||!!this.error}})).views(e=>({get staticSlices(){return function(e){const t=[];let n=0;const{bpPerRadian:r,spacingPx:a,pxPerRadian:o}=e;for(const i of e.elidedRegions){const s=i.widthBp/r+a/o;t.push(new da(e,i,n,s)),n+=s}return t}(e)}})).views(e=>({get visibleStaticSlices(){return e.staticSlices.filter(t=>function(e,t){const{theta:[n,r]}=e.visibleSection;return a=t.offsetRadians+e.offsetRadians,i=n,s=r-n,!((o=t.radianWidth)<=0||s<=0)&&(o+1e-4>=ca||s+1e-4>=ca||(a=(a%ca+ca)%ca+ca)<(i=(i%ca+ca)%ca+ca)+s&&a+o>i||a<(i-=ca)+s&&a+o>i||a<(i+=ca+ca)+s&&a+o>i);var a,o,i,s}(e,t))}})).actions(t=>({setWidth:e=>(t.volatileWidth=Math.max(e,100),t.volatileWidth),setHeight:e=>(t.height=Math.max(e,40),t.height),resizeHeight(e){const n=t.height,r=this.setHeight(t.height+e);return this.setModelViewWhenAdjust(!t.tooSmallToLock),r-n},resizeWidth(e){const n=t.width,r=this.setWidth(t.width+e);return this.setModelViewWhenAdjust(!t.tooSmallToLock),r-n},rotateClockwiseButton(){this.rotateClockwise(Math.PI/6)},rotateCounterClockwiseButton(){this.rotateCounterClockwise(Math.PI/6)},rotateClockwise(e=.17){t.offsetRadians+=e},rotateCounterClockwise(e=.17){t.offsetRadians-=e},zoomInButton(){this.setBpPerPx(t.bpPerPx/1.4)},zoomOutButton(){this.setBpPerPx(1.4*t.bpPerPx)},setBpPerPx(e){t.bpPerPx=(0,x.clamp)(e,t.minBpPerPx,t.maxBpPerPx)},setModelViewWhenAdjust(e){t.lockedFitToWindow&&e&&this.setBpPerPx(t.minBpPerPx)},setDisplayedRegions(e){const n=0===t.displayedRegions.length;t.displayedRegions=(0,c.cast)(e),n?this.setBpPerPx(t.minBpPerPx):this.setBpPerPx(t.bpPerPx)},activateTrackSelector(){if("hierarchical"===t.trackSelectorType){const e=(0,x.getSession)(t);if((0,U.lO)(e)){const n=e.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:t});return e.showWidget(n),n}}throw new Error(`invalid track selector type ${t.trackSelectorType}`)},toggleTrack(e){(0,C.toggleTrackGeneric)(t,e)},setError(e){t.volatileError=e},setInit(e){t.init=e},showTrack(e,n={}){(0,C.showTrackGeneric)(t,e,n)},addTrackConf(n,r={}){const{type:a}=n,o=(0,R.QZ)(n,"name"),i=e.getTrackType(a);if(!i)throw new Error(`unknown track type ${a}`);const s=e.getViewType(t.type),l=new Set(s.displayTypes.map(e=>e.name)),c=n.displays.find(e=>l.has(e.type));t.tracks.push(i.stateModel.create({...r,name:o,type:a,configuration:n,displays:[{type:c.type,configuration:c}]}))},hideTrack(e){(0,C.hideTrackGeneric)(t,e)},toggleFitToWindowLock(){return t.lockedFitToWindow=!t.lockedFitToWindow,this.setModelViewWhenAdjust(t.atMinBpPerPx),t.lockedFitToWindow},async exportSvg(e={}){const{renderToSvg:r}=await n.e(4548).then(n.bind(n,44548)),a=await r(t,e),{saveAs:o}=await n.e(9044).then(n.bind(n,99044));o(new Blob([a],{type:"image/svg+xml"}),e.filename||"image.svg")}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){const{init:t,initialized:n}=e;if(n&&t){const n=(0,x.getSession)(e),{assemblyManager:r}=n,a=r.get(t.assembly)?.regions;if(a&&e.setDisplayedRegions(a),t.tracks)for(const n of t.tracks)e.showTrack(n);e.setInit(void 0)}},{name:"CircularViewInit"}))}})).views(e=>({menuItems:()=>[{label:"Return to import form",onClick:()=>{e.setDisplayedRegions([])},icon:oa.A},{label:"Export SVG",icon:On.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ua,{model:e,handleClose:t}])}},{label:"Open track selector",onClick:e.activateTrackSelector,icon:aa.xU}]})).postProcessSnapshot(e=>{if(!e)return e;const{init:n,offsetRadians:r,bpPerPx:a,hideVerticalResizeHandle:o,hideTrackSelectorButton:i,lockedFitToWindow:s,disableImportForm:l,height:c,displayedRegions:d,scrollX:u,scrollY:p,minimumRadiusPx:h,spacingPx:g,paddingPx:m,lockedPaddingPx:f,minVisibleWidth:y,minimumBlockWidth:b,trackSelectorType:w,...v}=e;return{...v,...r!==t?{offsetRadians:r}:{},...200!==a?{bpPerPx:a}:{},...o?{hideVerticalResizeHandle:o}:{},...i?{hideTrackSelectorButton:i}:{},...s?{}:{lockedFitToWindow:s},...l?{disableImportForm:l}:{},...400!==c?{height:c}:{},...d.length?{displayedRegions:d}:{},...u?{scrollX:u}:{},...p?{scrollY:p}:{},...25!==h?{minimumRadiusPx:h}:{},...10!==g?{spacingPx:g}:{},...80!==m?{paddingPx:m}:{},...100!==f?{lockedPaddingPx:f}:{},...6!==y?{minVisibleWidth:y}:{},...20!==b?{minimumBlockWidth:b}:{},..."hierarchical"!==w?{trackSelectorType:w}:{}}})};class ha extends r.A{name="CircularViewPlugin";install(e){!function(e){e.addViewType(()=>new jn.A({ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(2913),n.e(5049),n.e(7714)]).then(n.bind(n,7714))),stateModel:pa(e),name:"CircularView",displayName:"Circular view"}))}(e),function(e){e.addToExtensionPoint("LaunchView-CircularView",async({session:e,assembly:t,tracks:n=[]})=>{if(!t)throw new Error("No assembly provided when launching circular genome view");e.addView("CircularView",{init:{assembly:t,tracks:n}})})}(e)}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Circular view",icon:ra.A,onClick:e=>{e.addView("CircularView",{})}})}}const ga=(0,i.S7)("BlastTabularAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Query assembly is the first value in the array, target assembly is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the target assembly"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the query assembly"},blastTableLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/blastTable.tsv",locationType:"UriLocation"}},columns:{type:"string",description:"Optional space-separated column name list. If custom columns were used in outfmt, enter them here exactly as specified in the command. At least qseqid, sseqid, qstart, qend, sstart, and send are required",defaultValue:"qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore"}},{explicitlyTyped:!0}),ma=(0,i.S7)("ChainAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the target assembly"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the query assembly"},chainLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.chain",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,chainLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),fa=["PAFAdapter","ChainAdapter","DeltaAdapter","BlastTabularAdapter","MashMapAdapter","MCScanAnchorsAdapter","MCScanSimpleAnchorsAdapter","PairwiseIndexedPAFAdapter"],ya=["PAFAdapter","ChainAdapter","DeltaAdapter","MashMapAdapter","BlastTabularAdapter","PairwiseIndexedPAFAdapter"],ba=["MCScanAnchorsAdapter","MCScanSimpleAnchorsAdapter"],wa=(0,a.lazy)(()=>n.e(3693).then(n.bind(n,83693))),va=(0,i.S7)("DeltaAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the target assembly name"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the query assembly name"},deltaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.delta",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,deltaLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Sa=(0,a.lazy)(()=>n.e(8407).then(n.bind(n,98407))),ka=(0,i.S7)("MCScanAnchorsAdapter",{mcscanAnchorsLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mcscan.anchors",locationType:"UriLocation"}},bed1Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},bed2Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},assemblyNames:{type:"stringArray",defaultValue:[]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri&&e.bed1&&e.bed2?{...e,mcscanAnchorsLocation:{uri:e.uri,baseUri:e.baseUri},bed1Location:{uri:e.bed1,baseUri:e.baseUri},bed2Location:{uri:e.bed2,baseUri:e.baseUri}}:e}),xa=(0,i.S7)("MCScanSimpleAnchorsAdapter",{mcscanSimpleAnchorsLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mcscan.anchors.simple",locationType:"UriLocation"}},bed1Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},bed2Location:{type:"fileLocation",defaultValue:{uri:"/path/to/file.bed",locationType:"UriLocation"}},assemblyNames:{type:"stringArray",defaultValue:[]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri&&e.bed1&&e.bed2?{...e,mcscanSimpleAnchorsLocation:{uri:e.uri,baseUri:e.baseUri},bed1Location:{uri:e.bed1,baseUri:e.baseUri},bed2Location:{uri:e.bed2,baseUri:e.baseUri}}:e}),Ca=(0,i.S7)("MashMapAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the target assembly"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames array: the query assembly"},outLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/mashmap.out",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,outLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Ta=(0,i.S7)("PAFAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the target assembly name"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the query assembly name"},pafLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/file.paf",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,pafLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Aa=(0,i.S7)("PairwiseIndexedPAFAdapter",{assemblyNames:{type:"stringArray",defaultValue:[],description:"Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second"},targetAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the target assembly name"},queryAssembly:{type:"string",defaultValue:"",description:"Alternative to assemblyNames: the query assembly name"},pifGzLocation:{type:"fileLocation",description:"location of pairwise tabix indexed PAF (pif)",defaultValue:{uri:"/path/to/data/file.pif.gz",locationType:"UriLocation"}},index:(0,i.S7)("TabixIndex",{indexType:{model:c.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.paf.gz.tbi",locationType:"UriLocation"}}})},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,pifGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e});class Ma extends r.A{name="ComparativeAdaptersPlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"PAFAdapter",displayName:"PAF adapter",configSchema:Ta,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(9364).then(n.bind(n,49364)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"PairwiseIndexedPAFAdapter",displayName:"Pairwise indexed PAF adapter",configSchema:Aa,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>Promise.all([n.e(9272),n.e(13)]).then(n.bind(n,70013)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"DeltaAdapter",displayName:"MUMmer delta adapter",configSchema:va,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(6757).then(n.bind(n,26757)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"ChainAdapter",displayName:"Liftover chain adapter",configSchema:ma,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(3224).then(n.bind(n,93224)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"MCScanAnchorsAdapter",displayName:"MCScan anchors adapter",configSchema:ka,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(5483).then(n.bind(n,75483)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"MCScanSimpleAnchorsAdapter",displayName:"MCScan anchors.simple adapter",configSchema:xa,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(7231).then(n.bind(n,17231)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"MashMapAdapter",displayName:"MashMap adapter",configSchema:Ca,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(9095).then(n.bind(n,59095)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BlastTabularAdapter",displayName:"Tabular BLAST output adapter",configSchema:ga,adapterMetadata:{category:"Synteny adapters"},getAdapterClass:()=>n.e(2557).then(n.bind(n,92557)).then(e=>e.default)}))}(e),function(e){e.addToExtensionPoint("Core-addTrackComponent",(e,{model:t})=>ya.includes(t.trackAdapterType)?wa:e)}(e),function(e){e.addToExtensionPoint("Core-addTrackComponent",(e,{model:t})=>ba.includes(t.trackAdapterType)?Sa:e)}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t),o=n&&(0,C.getFileName)(n);return(0,x.testAdapter)(a,/\.paf(.gz)?/i,r,"PAFAdapter")?{type:"PAFAdapter",pafLocation:t}:"BlastTabularAdapter"===r?{type:"BlastTabularAdapter",blastTableLocation:t}:(0,x.testAdapter)(a,/\.anchors.simple(.gz)?/i,r,"MCScanSimpleAnchorsAdapter")?{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:t}:(0,x.testAdapter)(a,/\.anchors(.gz)?/i,r,"MCScanAnchorsAdapter")?{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:t}:(0,x.testAdapter)(a,/\.delta(.gz)?/i,r,"DeltaAdapter")?{type:"DeltaAdapter",deltaLocation:t}:(0,x.testAdapter)(a,/\.chain(.gz)?/i,r,"ChainAdapter")?{type:"ChainAdapter",chainLocation:t}:(0,x.testAdapter)(a,/\.out(.gz)?/i,r,"MashMapAdapter")?{type:"MashMapAdapter",outLocation:t}:(0,x.testAdapter)(a,/\.pif\.gz/i,r,"PairwiseIndexedPAFAdapter")?{type:"PairwiseIndexedPAFAdapter",pifGzLocation:t,index:{location:n||(0,C.makeIndex)(t,".tbi"),indexType:(0,C.makeIndexType)(o,"CSI","TBI")}}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>fa.includes(t)?"SyntenyTrack":e(t))}(e)}}var Pa=n(79235),Ia=n(50172),Ra=n(22638);class La extends lt.A{name="ComparativeRender";async renameRegionsIfNeeded(e,t){return t.renameRegionsIfNeeded(e)}getRenderer(e){return this.pluginManager.getRendererType(e)}async serializeArguments(e,t){const{rendererType:n}=e,r=this.getRenderer(n),a=await super.serializeArguments(e,t),o=await this.renameRegionsIfNeeded(a,r);return r.serializeArgsInClient(o)}async execute(e,t){const n=await this.deserializeArguments(e,t),{sessionId:r,rendererType:a,stopToken:o}=n;if(!r)throw new Error("must pass a unique session id");return(0,He.SW)(o),this.getRenderer(a).renderInWorker(n)}async deserializeReturn(e,t,n){const r=await super.deserializeReturn(e,t,n);return this.getRenderer(t.rendererType).deserializeResultsInClient(r,t)}}var Fa=n(30524),Da=n(68589),Na=n(80764);const Ba=Da.A.extend(e=>{const t=N.observable.box(1);return{views:{get dynamicBlocks(){return(0,Na.A)(e,!1,!1)},get scaleFactor(){return t.get()},get maxBpPerPx(){return e.totalBp/(.9*e.width)},get minBpPerPx(){return.02},get maxOffset(){const t=e.displayedRegionsTotalPx,n=e.width;return t<=n?(t-n)/2:t-10},get minOffset(){const t=e.displayedRegionsTotalPx,n=e.width;return t<=n?(t-n)/2:30-n}},actions:{setScaleFactor(e){t.set(e)},center(){const t=e.totalBp/2/e.bpPerPx;e.scrollTo(t-e.width/2)}}}}),Ea=Ba.extend(e=>({views:{get width(){return(0,c.getParent)(e).viewWidth}}})),Va=Ba.extend(e=>({views:{get width(){return(0,c.getParent)(e).viewHeight}}}));class za extends Fa.A{name="DiagonalizeDotplot";async execute(e,t){const n=await this.deserializeArguments(e,t),{view:r,sessionId:a,adapterConfig:o,stopToken:i,statusCallback:s}=n;if(!a)throw new Error("must pass a unique session id");s?.("Initializing diagonalization...");const l=[800,800],c=[r.hview,r.vview].map((e,t)=>{const n=Ba.create(e);return n.setVolatileWidth(l[t]),n})[0];(0,He.SW)(i),s?.("Getting renderer...");const d=this.pluginManager.getRendererType("DotplotRenderer");if(!d)throw new Error("DotplotRenderer not found");(0,He.SW)(i),s?.("Fetching features...");const u=await d.getFeatures({regions:c.dynamicBlocks.contentBlocks,adapterConfig:o,sessionId:a});(0,He.SW)(i),s?.("Extracting alignment data...");const p=[];for(const e of u.values()){const t=e.get("mate");t&&p.push({queryRefName:e.get("refName"),refRefName:t.refName,queryStart:e.get("start"),queryEnd:e.get("end"),refStart:t.start,refEnd:t.end,strand:e.get("strand")||1})}if(0===p.length)throw new Error("No alignments found to diagonalize");s?.(`Running diagonalization on ${p.length} alignments...`);const h=await async function(e,t,n){const r=(e,t)=>{n&&n(0,t)};r(0,`Grouping ${e.length} alignments...`);const a=new Map;for(const t of e){const e=t.refRefName;a.has(e)||a.set(e,{refAlignments:new Map,strandWeightedSum:0});const n=a.get(e),r=Math.abs(t.queryEnd-t.queryStart);n.refAlignments.has(t.queryRefName)||n.refAlignments.set(t.queryRefName,{bases:0,positions:[]});const o=n.refAlignments.get(t.queryRefName);o.bases+=r,o.positions.push((t.queryStart+t.queryEnd)/2);const i=t.strand>=0?1:-1;n.strandWeightedSum+=i*r}r(0,"Determining optimal ordering and orientation...");const o=[];for(const[e,t]of a){let n="",r=0,a=[];for(const[e,o]of t.refAlignments)o.bases>r&&(r=o.bases,n=e,a=o.positions);const i=a.reduce((e,t)=>e+t,0)/a.length,s=t.strandWeightedSum<0;o.push({refName:e,bestRefName:n,bestRefPos:i,shouldReverse:s})}r(0,`Sorting ${o.length} query regions...`),o.sort((e,t)=>e.bestRefName!==t.bestRefName?e.bestRefName.localeCompare(t.bestRefName):e.bestRefPos-t.bestRefPos),r(0,"Building new region layout...");const i=[];let s=0;for(const{refName:e,shouldReverse:n}of o){const r=t.find(t=>t.refName===e);r&&(i.push({...r,reversed:n}),n!==r.reversed&&s++)}const l=t.filter(e=>!i.some(t=>t.refName===e.refName));return r(0,"Diagonalization complete!"),{newRegions:[...i,...l],stats:{totalAlignments:e.length,regionsProcessed:o.length,regionsReordered:i.length,regionsReversed:s}}}(p,r.vview.displayedRegions,(e,t)=>{(0,He.SW)(i),s?.(t)});return s?.("Diagonalization complete!"),h}}var ja=n(28423),Ha=n(58836),_a=n(87574),Oa=n(27351),$a=n(65045);const Ga=(0,$a.n)()(e=>{const t=e.palette.action.disabledBackground;return{loading:{paddingLeft:"0.6em",backgroundColor:e.palette.background.default,backgroundImage:`repeating-linear-gradient(45deg, transparent, transparent 5px, ${t} 5px, ${t} 10px)`,textAlign:"center"}}});function Wa(){const e=(0,Ut.c)(3),{classes:t}=Ga();let n,r;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,te.jsx)(_a.A,{}),e[0]=n):n=e[0],e[1]!==t.loading?(r=(0,te.jsx)("div",{className:t.loading,children:n}),e[1]=t.loading,e[2]=r):r=e[2],r}function Ua(e){const t=(0,Ut.c)(5),{messageText:n}=e,{classes:r}=Ga();let a,o;return t[0]!==n?(a=(0,te.jsx)(_a.A,{message:n}),t[0]=n,t[1]=a):a=t[1],t[2]!==r.loading||t[3]!==a?(o=(0,te.jsx)("div",{className:r.loading,children:a}),t[2]=r.loading,t[3]=a,t[4]=o):o=t[4],o}function qa(e){const t=(0,Ut.c)(2),{error:n}=e;let r;return t[0]!==n?(r=(0,te.jsx)(Oa.A,{error:n}),t[0]=n,t[1]=r):r=t[1],r}const Ja=(0,ee.observer)(function({model:e,style:t}){return e.error?(0,te.jsx)(qa,{error:e.error,"data-testid":"reload_button"}):e.message?(0,te.jsx)(Ua,{messageText:e.message}):e.filled?e.shouldDisplay?(0,te.jsx)("div",{style:t,children:e.reactElement}):null:(0,te.jsx)(Wa,{})}),Xa=Ja;function Ka(e){const{rpcManager:t}=(0,x.getSession)(e),{rendererType:n}=e,{adapterConfig:r}=e,a=(0,x.getContainingView)(e);if((0,R.QZ)(e.configuration),(0,c.getSnapshot)(a),a.initialized){const{viewWidth:o,viewHeight:i,borderSize:s,borderX:l,borderY:d}=a;return{rendererType:n,rpcManager:t,renderProps:{...e.renderProps(),view:structuredClone((0,c.getSnapshot)(a)),width:o,height:i,borderSize:s,borderX:l,borderY:d,adapterConfig:r,rendererType:n.name,sessionId:(0,C.getRpcSessionId)(e),trackInstanceId:(0,x.getContainingTrack)(e).id,timeout:1e6,alpha:e.alpha,minAlignmentLength:e.minAlignmentLength,colorBy:e.colorBy},renderingProps:e.renderingProps?.()}}}function Qa(e){return c.types.compose("DotplotDisplay",L.q,c.types.model({type:c.types.literal("DotplotDisplay"),configuration:(0,i.AK)(e),colorBy:c.types.optional(c.types.string,"default")}).volatile(()=>({stopToken:void 0,warnings:[],filled:!1,data:void 0,reactElement:void 0,message:void 0,renderingComponent:void 0,ReactComponent2:Xa,alpha:1,minAlignmentLength:0}))).views(e=>({get shouldDisplay(){const{vview:t,hview:n}=(0,x.getContainingView)(e);return t.bpPerPx===e.data.bpPerPxY&&n.bpPerPx===e.data.bpPerPxX},get rendererTypeName(){return(0,R.FI)(e,["renderer","type"])},renderProps:()=>({...(0,C.getParentRenderProps)(e),rpcDriverName:e.rpcDriverName,config:e.configuration.renderer})})).views(e=>({async renderSvg(t){const n=Ka(e);if(!n)return null;const{rendererType:r,rpcManager:a,renderProps:o,renderingProps:i}=n,s=await r.renderInClient(a,{...o,renderingProps:i,exportSVG:t,theme:t.theme||o.theme}),{hview:l,vview:c}=(0,x.getContainingView)(e),d=-l.offsetPx+s.offsetX,u=-c.offsetPx+s.offsetY;return(0,te.jsx)("g",{transform:`translate(${d} ${-u})`,children:(0,te.jsx)(ja.aE,{rendering:s})})}})).actions(e=>({afterAttach(){(0,Ha.I)(e,()=>Ka(e),e=>async function(e){if(!e)return;const{rendererType:t,rpcManager:n,renderProps:r,renderingProps:a}=e,{reactElement:o,...i}=await t.renderInClient(n,{...r,renderingProps:a});return{reactElement:o,data:i,renderingComponent:t.ReactComponent}}(e),{name:`${e.type} ${e.id} rendering`,delay:500,fireImmediately:!0},this.setLoading,this.setRendered,this.setError)},setLoading(t){e.filled=!1,e.message=void 0,e.reactElement=void 0,e.data=void 0,e.error=void 0,e.renderingComponent=void 0,e.stopToken=t},setMessage(t){e.message=t},setRendered(t){if(void 0===t)return;const{data:n,reactElement:r,renderingComponent:a}=t;e.warnings=n.warnings,e.filled=!0,e.message=void 0,e.reactElement=r,e.data=n,e.error=void 0,e.renderingComponent=a,e.stopToken=void 0},setError(t){console.error(t),e.filled=!1,e.message=void 0,e.reactElement=void 0,e.data=void 0,e.error=t,e.renderingComponent=void 0,e.stopToken=void 0},setAlpha(t){e.alpha=t},setMinAlignmentLength(t){e.minAlignmentLength=t},setColorBy(t){e.colorBy=t}}))}var Ya=n(87134),Za=n(35635);const{Cu:eo,NI:to,R3:no,Gl:ro}=Za;var ao=n(44121),oo=n(30713),io=n(61132),so=n(16278);class lo extends ao.default{supportsSVG=!0;async renameRegionsIfNeeded(e){const t=this.pluginManager,n=t.rootModel?.session?.assemblyManager,{view:r,sessionId:a,adapterConfig:o}=e;async function i(e){if(!n)throw new Error("No assembly manager provided");return(await(0,x.renameRegionsIfNeeded)(n,{sessionId:a,adapterConfig:o,regions:e})).regions}return r.hview.displayedRegions=await i(r.hview.displayedRegions),r.vview.displayedRegions=await i(r.vview.displayedRegions),e}serializeArgsInClient(e){const{displayModel:t,...n}=e;return super.serializeArgsInClient(n)}deserializeResultsInClient(e,t){return{...super.deserializeResultsInClient(e,t),blockKey:t.blockKey}}async renderInClient(e,t){const n=await e.call(t.sessionId,"ComparativeRender",t);if("canvasRecordedData"in n){const{reactElement:e,...t}=n;return{...t,html:await(0,oo.getSerializedSvg)(n)}}return n}async getFeatures(e){const{regions:t,sessionId:n,adapterConfig:r,filters:a}=e,{dataAdapter:o}=await(0,ot.cK)(this.pluginManager,n,r),i=await(0,it._)(o.getFeaturesInMultipleRegions(t.map(e=>function(e){return{...e,start:Math.floor(e.start),end:Math.ceil(e.end)}}(e)),e).pipe((0,so.p)(t=>!a||a.passes(t,e)),(0,st.$)()));return(0,io.Q)(i,e=>e.id())}async render(e){const{width:t,height:r,view:{hview:a,vview:o}}=e,i=[t,r],s=[a,o].map((e,t)=>{const n=Ba.create(e);return n.setVolatileWidth(i[t]),n}),l=s[0],c=await this.getFeatures({...e,regions:l.dynamicBlocks.contentBlocks});l.setFeatures(c);const{drawDotplot:d}=await n.e(2672).then(n.bind(n,42672)),u=await(0,qn.u)(t,r,e,t=>d(t,{...e,views:s})),p={...u,height:r,width:t,offsetX:s[0].dynamicBlocks.blocks[0]?.offsetPx||0,offsetY:s[1].dynamicBlocks.blocks[0]?.offsetPx||0,bpPerPxX:s[0].bpPerPx,bpPerPxY:s[1].bpPerPx};return(0,yt.lk)(p,(0,bt.X)(u))}}const co=(0,i.S7)("DotplotRenderer",{color:{type:"color",description:"the color of each feature in a synteny, used with colorBy:default",defaultValue:"#f0f",contextVariable:["feature"]},posColor:{type:"color",description:"the color for forward alignments, used with colorBy:strand",defaultValue:"blue"},negColor:{type:"color",description:"the color for reverse alignments, used with colorBy:strand",defaultValue:"red"},lineWidth:{type:"number",description:"width of the lines to be drawn",defaultValue:2.5},colorBy:{type:"stringEnum",model:c.types.enumeration("colorBy",["identity","meanQueryIdentity","mappingQuality","strand","default"]),description:'Color by options:<br/>\n<ul>\n  <li>"identity" - the identity of the particular hit, similar to D-GENIES, use the other config slots \'thresholds\' and \'thresholdsPalette\' to define colors for this setting</li>\n  <li>"meanQueryIdentity" - calculates the weighted mean identity (weighted by alignment length) of all the hits that the query maps to (e.g. if the query is split aligned to many target, uses their weighted mean. can help show patterns of more related and distant synteny after WGD)</li>\n  <li>"mappingQuality" - uses mapping quality from PAF, some adapters don\'t have this setting</li>\n  <li>"strand" - colors negative alignments with negColor and positive alignments with posColor</li>\n  <li>"default" - uses the \'color\' config slot</li>\n</ul>',defaultValue:"default"},thresholdsPalette:{type:"stringArray",defaultValue:["#094b09","#2ebd40","#d5670b","#ffd84b"],description:"threshold colors, used with colorBy:identity"},thresholds:{type:"stringArray",defaultValue:["0.75","0.5","0.25","0"],description:"threshold breakpoints, used with colorBy:identity"}},{explicitlyTyped:!0});var uo=n(10387);const po=(0,a.lazy)(()=>n.e(2673).then(n.bind(n,92673))),ho=(0,a.lazy)(()=>n.e(5015).then(n.bind(n,15015)));function go(e){return(0,x.measureText)(e.slice(0,30))}function mo(e,t,n){return(0,x.max)([...e.filter(e=>!n.has(e.key)).map(e=>go(e.refName)),...e.filter(e=>!n.has(e.key)).map(e=>go((0,x.getTickDisplayStr)(e.end,t)))])}class fo extends r.A{name="DotplotPlugin";install(e){var t;!function(e){e.addViewType(()=>{return new jn.A({name:"DotplotView",displayName:"Dotplot view",stateModel:(t=e,c.types.compose("DotplotView",Hn.A,c.types.model({id:Fn.K,type:c.types.literal("DotplotView"),height:600,borderSize:20,tickSize:5,vtextRotation:0,htextRotation:-90,fontSize:15,trackSelectorType:"hierarchical",assemblyNames:c.types.array(c.types.string),drawCigar:!0,hview:c.types.optional(Ea,{}),vview:c.types.optional(Va,{}),tracks:c.types.array(t.pluggableMstType("track","stateModel")),viewTrackConfigs:c.types.array(t.pluggableConfigSchemaType("track")),init:c.types.frozen()})).volatile(()=>({volatileWidth:void 0,volatileError:void 0,cursorMode:(0,x.localStorageGetItem)("dotplot-cursorMode")||"crosshair",showPanButtons:(0,x.localStorageGetBoolean)("dotplot-showPanbuttons",!0),wheelMode:(0,x.localStorageGetItem)("dotplot-wheelMode")||"zoom",borderX:100,borderY:100,importFormSyntenyTrackSelections:N.observable.array()})).actions(e=>({importFormRemoveRow(t){e.importFormSyntenyTrackSelections.splice(t,1)},clearImportFormSyntenyTracks(){e.importFormSyntenyTrackSelections.clear()},setImportFormSyntenyTrack(t,n){e.importFormSyntenyTrackSelections[t]=n}})).views(e=>({get width(){if(!e.volatileWidth)throw new Error("width not initialized");return e.volatileWidth}})).views(e=>({get assemblyErrors(){const{assemblyManager:t}=(0,x.getSession)(e);return e.assemblyNames.map(e=>t.get(e)?.error).filter(e=>!!e).join(", ")},get assembliesInitialized(){const{assemblyManager:t}=(0,x.getSession)(e);return e.assemblyNames.every(e=>t.get(e)?.initialized??!0)}})).views(e=>({get initialized(){return void 0!==e.volatileWidth&&e.hview.displayedRegions.length>0&&e.vview.displayedRegions.length>0&&e.assembliesInitialized},get hticks(){const{hview:t}=e,{dynamicBlocks:n,staticBlocks:r,bpPerPx:a}=t;return n.contentBlocks.length>5?[]:(0,uo.H2)(r.contentBlocks,a)},get vticks(){const{vview:t}=e,{dynamicBlocks:n,staticBlocks:r,bpPerPx:a}=t;return n.contentBlocks.length>5?[]:(0,uo.H2)(r.contentBlocks,a)},get hasSomethingToShow(){return e.assemblyNames.length>0||!!e.init},get showLoading(){return this.hasSomethingToShow&&!this.initialized&&!e.volatileError&&!e.assemblyErrors},get showImportForm(){return!this.hasSomethingToShow||!!e.volatileError},get loadingMessage(){return this.showLoading?"Loading":void 0},get viewWidth(){return e.width-e.borderX},get viewHeight(){return e.height-e.borderY},get views(){return[e.hview,e.vview]},renderProps(){const t=(0,x.getSession)(e);return{...(0,C.getParentRenderProps)(e),drawCigar:e.drawCigar,highResolutionScaling:(0,R.FI)(t,"highResolutionScaling")}}})).actions(e=>({setShowPanButtons(t){e.showPanButtons=t},setWheelMode(t){e.wheelMode=t},setCursorMode(t){e.cursorMode=t},setDrawCigar(t){e.drawCigar=t},clearView(){e.hview.setDisplayedRegions([]),e.vview.setDisplayedRegions([]),e.assemblyNames=(0,c.cast)([]),e.tracks.clear()},setBorderX(t){e.borderX=t},setBorderY(t){e.borderY=t},setWidth:t=>(e.volatileWidth=t,e.volatileWidth),setHeight:t=>(e.height=t,e.height),setError(t){e.volatileError=t},setInit(t){e.init=t},zoomOut(){e.hview.zoomOut(),e.vview.zoomOut(),e.hview.bpPerPx>=.99*e.hview.maxBpPerPx&&e.hview.center(),e.vview.bpPerPx>=.99*e.vview.maxBpPerPx&&e.vview.center()},zoomIn(){e.hview.zoomIn(),e.vview.zoomIn()}})).actions(e=>({activateTrackSelector(){if("hierarchical"===e.trackSelectorType){const t=(0,x.getSession)(e);if((0,U.lO)(t)){const n=t.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:e});return t.showWidget(n),n}}throw new Error(`invalid track selector type ${e.trackSelectorType}`)},showTrack:(t,n={})=>(0,C.showTrackGeneric)(e,t,n),hideTrack:t=>(0,C.hideTrackGeneric)(e,t),toggleTrack(t){(0,C.toggleTrackGeneric)(e,t)},setAssemblyNames(t,n){e.assemblyNames=(0,c.cast)([t,n]),e.hview.setDisplayedRegions([]),e.vview.setDisplayedRegions([])},setViews(t){e.hview=(0,c.cast)(t[0]),e.vview=(0,c.cast)(t[1])},getCoords(t,n){const[r,a]=(0,x.minmax)(n[0],t[0]),[o,i]=(0,x.minmax)(n[1],t[1]);return Math.abs(a-r)>3&&Math.abs(i-o)>3?[e.hview.pxToBp(r),e.hview.pxToBp(a),e.vview.pxToBp(e.viewHeight-o),e.vview.pxToBp(e.viewHeight-i)]:void 0},zoomInToMouseCoords(t,n){const r=this.getCoords(t,n);if(r){const[t,n,a,o]=r;e.hview.moveTo(t,n),e.vview.moveTo(o,a)}},calculateBorders(){if(void 0===e.volatileWidth)return{borderX:e.borderX,borderY:e.borderY};const{vview:t,hview:n,viewHeight:r,viewWidth:a}=e,o=t.dynamicBlocks.contentBlocks,i=n.dynamicBlocks.contentBlocks,s=n.offsetPx,l=t.offsetPx,c=(0,uo.rQ)(o,r,l),d=(0,uo.rQ)(i,a,s),u=mo(i,t.bpPerPx,d),p=mo(o,n.bpPerPx,c);return{borderX:Math.max(p+40,50),borderY:Math.max(u+40,50)}},showAllRegions(){e.hview.zoomTo(e.hview.maxBpPerPx),e.vview.zoomTo(e.vview.maxBpPerPx);const{borderX:t,borderY:n}=this.calculateBorders();e.setBorderX(t),e.setBorderY(n),e.hview.zoomTo(e.hview.maxBpPerPx),e.vview.zoomTo(e.vview.maxBpPerPx),e.vview.center(),e.hview.center()},initializeDisplayedRegions(){const{hview:t,vview:n,assemblyNames:r}=e;if(t.displayedRegions.length&&n.displayedRegions.length)return;const{assemblyManager:a}=(0,x.getSession)(e);t.setDisplayedRegions(a.get(r[0])?.regions||[]),n.setDisplayedRegions(a.get(r[1])?.regions||[]),this.showAllRegions()},onDotplotView(t,n){const r=this.getCoords(t,n);if(r){const[t,n,a,o]=r,i=(0,x.getSession)(e),s=Ba.create({...(0,c.getSnapshot)(e.hview),minimumBlockWidth:0,interRegionPaddingWidth:0}),l=Ba.create({...(0,c.getSnapshot)(e.vview),minimumBlockWidth:0,interRegionPaddingWidth:0});s.setVolatileWidth(e.hview.width),l.setVolatileWidth(e.vview.width),s.moveTo(t,n),l.moveTo(o,a),s.zoomTo(s.bpPerPx/(e.width/e.hview.width),0),l.zoomTo(l.bpPerPx/(e.width/e.vview.width),0);const d=e.tracks.map(e=>e.configuration.displays.find(e=>"LinearSyntenyDisplay"===e.type)).filter(e=>!!e).map(e=>{const t=(0,c.getParent)(e,2);return{type:t.type,configuration:(0,c.getSnapshot)(t),displays:[{type:e.type,configuration:(0,c.getSnapshot)(e)}]}}),{id:u,...p}=(0,c.getSnapshot)(s),{id:h,...g}=(0,c.getSnapshot)(l),m={type:"LinearSyntenyView",views:[{type:"LinearGenomeView",tracks:[],hideHeader:!0,...p},{type:"LinearGenomeView",tracks:[],hideHeader:!0,...g}],tracks:d};i.addView("LinearSyntenyView",m)}}})).actions(e=>({async exportSvg(t={}){const{renderToSvg:r}=await n.e(1333).then(n.bind(n,11333)),a=await r(e,t),{saveAs:o}=await n.e(9044).then(n.bind(n,99044));o(new Blob([a],{type:"image/svg+xml"}),t.filename||"image.svg")},beforeDestroy(){const t=(0,x.getSession)(e);for(const n of e.assemblyNames)t.removeTemporaryAssembly?.(n)},afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){const{init:t,volatileWidth:n}=e;if(!n||!t)return;const r=(0,x.getSession)(e),a=t.views.map(e=>e.assembly);if(e.setAssemblyNames(a[0],a[1]),t.tracks)for(const n of t.tracks)try{e.showTrack(n)}catch(e){console.error(e),r.notifyError(`${e}`,e)}e.setInit(void 0)},{name:"DotplotInit"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){const{showPanButtons:t,wheelMode:n,cursorMode:r}=e;var a;"undefined"!=typeof localStorage&&(localStorage.setItem("dotplot-showPanbuttons",(a=t,JSON.stringify(a))),localStorage.setItem("dotplot-cursorMode",r),localStorage.setItem("dotplot-wheelMode",n))},{name:"DotplotLocalStorage"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){e.assemblyNames.slice(),void 0!==e.volatileWidth&&e.assembliesInitialized&&e.initializeDisplayedRegions()},{delay:1e3,name:"DotplotRegions"})),(0,c.addDisposer)(e,(0,N.autorun)(function(){if(void 0===e.volatileWidth)return;const{borderX:t,borderY:n}=e.calculateBorders();e.setBorderX(t),e.setBorderY(n)},{name:"DotplotBorder"}))},squareView(){const{hview:t,vview:n}=e,r=(t.bpPerPx+n.bpPerPx)/2,a=t.pxToBp(t.width/2),o=n.pxToBp(n.width/2);t.setBpPerPx(r),t.centerAt(a.coord,a.refName,a.index),n.setBpPerPx(r),n.centerAt(o.coord,o.refName,o.index)},squareViewProportional(){const{hview:t,vview:n}=e,r=t.width/n.width,a=(t.bpPerPx+n.bpPerPx)/2,o=t.pxToBp(t.width/2),i=n.pxToBp(n.width/2);t.setBpPerPx(a/r),t.centerAt(o.coord,o.refName,o.index),n.setBpPerPx(a),n.centerAt(i.coord,i.refName,i.index)}})).views(e=>({menuItems(){const t=(0,x.getSession)(e);return[{label:"Return to import form",icon:oa.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ho,{model:e,handleClose:t}])}},{label:"Export SVG",icon:On.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[po,{model:e,handleClose:t}])}},...(0,U.lO)(t)?[{label:"Open track selector",onClick:e.activateTrackSelector,icon:aa.xU}]:[]]},get error(){return e.volatileError||e.assemblyErrors}})).postProcessSnapshot(e=>{if(!e)return e;const{init:t,height:n,borderSize:r,tickSize:a,vtextRotation:o,htextRotation:i,fontSize:s,trackSelectorType:l,drawCigar:c,assemblyNames:d,viewTrackConfigs:u,...p}=e;return{...p,...600!==n?{height:n}:{},...20!==r?{borderSize:r}:{},...5!==a?{tickSize:a}:{},...o?{vtextRotation:o}:{},...-90!==i?{htextRotation:i}:{},...15!==s?{fontSize:s}:{},..."hierarchical"!==l?{trackSelectorType:l}:{},...c?{}:{drawCigar:c},...d.length?{assemblyNames:d}:{},...u.length?{viewTrackConfigs:u}:{}}})),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(2913),n.e(6688),n.e(1529)]).then(n.bind(n,41529)))});var t})}(e),(t=e).addDisplayType(()=>{const e=function(e){return(0,i.S7)("DotplotDisplay",{renderer:c.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"DotplotRenderer"})},{explicitIdentifier:"displayId",explicitlyTyped:!0})}(t);return new P.A({name:"DotplotDisplay",displayName:"Dotplot display",configSchema:e,stateModel:Qa(e),trackType:"SyntenyTrack",viewType:"DotplotView",ReactComponent:(0,a.lazy)(()=>n.e(9112).then(n.bind(n,19112)))})}),function(e){e.addRendererType(()=>new lo({name:"DotplotRenderer",configSchema:co,ReactComponent:(0,a.lazy)(()=>n.e(903).then(n.bind(n,90903))),pluginManager:e}))}(e),function(e){e.addToExtensionPoint("LaunchView-DotplotView",async({session:e,views:t,tracks:n=[]})=>{e.addView("DotplotView",{init:{views:t.map(e=>({assembly:e.assembly})),tracks:n}})})}(e),function(e){e.addToExtensionPoint("Core-extendPluggableElement",e=>{if("LinearPileupDisplay"===e.name){const{stateModel:t}=e,n=t.extend(e=>{const t=e.contextMenuItems;return{views:{contextMenuItems(){const n=e.contextMenuFeature;return[...t(),...n?[{label:"Dotplot of read vs ref",icon:Ya.A,onClick:()=>{!function(e,t){const n=(0,x.getSession)(t);try{const r=e.get("CIGAR"),a=to(r,1),o=e.get("flags"),i=e.get("strand"),s=e.get("name"),l=`${s}_assembly_${Date.now()}`,{parentTrack:c}=t,[d]=(0,R.FI)(c,"assemblyNames"),u=[d,l],p=`track-${Date.now()}`,h=`${s}_vs_${d}`,g=e.get("tags")?.SA,m=eo(g,e.id(),i,s,!0),f=no(2048&o?m[0].CIGAR:r),y=[{...e.toJSON(),strand:1,mate:{refName:s,start:a,end:a+ro(r)}},...m].sort((e,t)=>e.clipLengthAtStartOfRead-t.clipLengthAtStartOfRead);n.addView("DotplotView",{type:"DotplotView",hview:{offsetPx:0,bpPerPx:(0,x.sum)(y.map(e=>e.end-e.start))/800,displayedRegions:(0,x.gatherOverlaps)(y.map((e,t)=>{const{start:n,end:r,refName:a}=e;return{start:n,end:r,refName:a,index:t,assemblyName:d}}))},vview:{offsetPx:0,bpPerPx:f/400,minimumBlockWidth:0,interRegionPaddingWidth:0,displayedRegions:[{assemblyName:l,start:0,end:f,refName:s}]},viewTrackConfigs:[{type:"SyntenyTrack",assemblyNames:u,adapter:{type:"FromConfigAdapter",features:y},trackId:p,name:h}],assemblyNames:u,tracks:[{configuration:p,type:"SyntenyTrack",displays:[{type:"DotplotDisplay",configuration:`${p}-DotplotDisplay`}]}],displayName:`${s} vs ${d}`})}catch(e){console.error(e),n.notifyError(`${e}`,e)}}(n,e)}}]:[]]}}}});e.stateModel=n}return e})}(e),e.addRpcMethod(()=>new La(e)),e.addRpcMethod(()=>new za(e))}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Dotplot view",icon:Ra.A,onClick:e=>{e.addView("DotplotView",{})}})}}function yo({features:e}){return e.map(e=>`${e.get("refName")}\t${e.get("start")}\t${e.get("end")}\t${e.get("score")??0}`).join("\n")}const bo=(0,a.lazy)(()=>n.e(8494).then(n.bind(n,78494)));function wo(e,t){return c.types.compose("SharedGCContentModel",(0,Qe.A)(e,t),c.types.model({windowSize:c.types.maybe(c.types.number),windowDelta:c.types.maybe(c.types.number)})).actions(e=>({setGCContentParams({windowSize:t,windowDelta:n}){e.windowSize=t,e.windowDelta=n}})).views(e=>({get windowSizeSetting(){return e.windowSize??(0,R.FI)(e,"windowSize")},get windowDeltaSetting(){return e.windowDelta??(0,R.FI)(e,"windowDelta")}})).views(e=>{const{trackMenuItems:t,adapterProps:n}=e;return{trackMenuItems:()=>[...t(),{label:"Change GC parameters",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[bo,{model:e,handleClose:t}])}}],adapterProps(){const t=(0,R.FI)(e.parentTrack,"adapter");return{...n(),adapterConfig:{type:"GCContentAdapter",sequenceAdapter:t,windowSize:e.windowSizeSetting,windowDelta:e.windowDeltaSetting}}}}})}const vo=(0,a.lazy)(()=>Promise.resolve().then(n.bind(n,36565)).then(e=>({default:e.LinearWiggleDisplayReactComponent})));class So extends r.A{name="GCContentPlugin";install(e){var t;!function(e){e.addAdapterType(()=>new b.A({name:"GCContentAdapter",displayName:"GC content adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:(0,i.S7)("GCContentAdapter",{sequenceAdapter:{type:"frozen",defaultValue:null},windowSize:{type:"number",defaultValue:100},windowDelta:{type:"number",defaultValue:100}},{explicitlyTyped:!0}),getAdapterClass:()=>n.e(3206).then(n.bind(n,63206)).then(e=>e.default)}))}(e),(t=e).addTrackType(()=>{const e=(e=>(0,i.S7)("GCContentTrack",{},{baseConfiguration:(0,g.J)(e)}))(t);return new p.A({name:"GCContentTrack",displayName:"GCContent track",configSchema:e,stateModel:(0,h.E)(t,"GCContentTrack",e).views(()=>({saveTrackFileFormatOptions:()=>({bedGraph:{name:"BedGraph",extension:"bedgraph",callback:yo}})}))})}),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearGCContentDisplay",{windowSize:{type:"number",defaultValue:100},windowDelta:{type:"number",defaultValue:100}},{baseConfiguration:e.getDisplayType("LinearWiggleDisplay").configSchema,explicitlyTyped:!0})}(e),n=function(e,t){return c.types.compose("LinearGCContentDisplay",wo(e,t),c.types.model({type:c.types.literal("LinearGCContentDisplay")}))}(e,t);return new P.A({name:"LinearGCContentDisplay",configSchema:t,stateModel:n,displayName:"GC content display",trackType:"ReferenceSequenceTrack",viewType:"LinearGenomeView",ReactComponent:vo})}),e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearGCContentTrackDisplay",{windowSize:{type:"number",defaultValue:100},windowDelta:{type:"number",defaultValue:100}},{baseConfiguration:e.getDisplayType("LinearWiggleDisplay").configSchema,explicitlyTyped:!0})}(e),n=function(e,t){return c.types.compose("LinearGCContentTrackDisplay",wo(e,t),c.types.model({type:c.types.literal("LinearGCContentTrackDisplay")}))}(e,t);return new P.A({name:"LinearGCContentTrackDisplay",configSchema:t,stateModel:n,displayName:"GC content display",trackType:"GCContentTrack",viewType:"LinearGenomeView",ReactComponent:vo})})}(e)}}const ko=(0,i.S7)("Gff3Adapter",{gffLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,gffLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),xo=(0,i.S7)("Gff3TabixAdapter",{gffGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff.gz",locationType:"UriLocation"}},index:(0,i.S7)("Gff3TabixIndex",{indexType:{model:c.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.gff.gz.tbi",locationType:"UriLocation"}}}),dontRedispatch:{type:"stringArray",defaultValue:["chromosome","region","contig"]}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,gffGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e});class Co extends r.A{name="GFF3Plugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"Gff3TabixAdapter",displayName:"GFF3 tabix adapter",configSchema:xo,getAdapterClass:()=>Promise.all([n.e(9272),n.e(2583)]).then(n.bind(n,2583)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"Gff3Adapter",displayName:"GFF3 adapter",configSchema:ko,getAdapterClass:()=>Promise.all([n.e(7710),n.e(5895)]).then(n.bind(n,25895)).then(e=>e.default)}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t),o=n&&(0,C.getFileName)(n);return(0,x.testAdapter)(a,/\.gff3?\.b?gz$/i,r,"Gff3TabixAdapter")?{type:"Gff3TabixAdapter",bamLocation:t,gffGzLocation:t,index:{location:n||(0,C.makeIndex)(t,".tbi"),indexType:(0,C.makeIndexType)(o,"CSI","TBI")}}:(0,x.testAdapter)(a,/\.gff3?$/i,r,"Gff3Adapter")?{type:"Gff3Adapter",gffLocation:t}:e(t,n,r)})}(e)}}var To=n(59105),Ao=n(33940),Mo=n(19157),Po=n(97280),Io=n(35913),Ro=n(27607);const Lo=(0,$a.n)()({bookmarkButton:{overflow:"hidden",position:"absolute",zIndex:800},highlight:{overflow:"hidden",height:"100%",position:"absolute"}}),Fo=(0,ee.observer)(function({model:e}){const{classes:t}=Lo(),n=(0,x.getSession)(e),{assemblyManager:r}=n,{bookmarkHighlightsVisible:o,bookmarkLabelsVisible:i}=e,s=n.widgets.get("GridBookmark");(0,a.useEffect)(()=>{s||n.addWidget("GridBookmarkWidget","GridBookmark")},[n,s]);const l=new Set(e.assemblyNames);return o&&s?.bookmarks?s.bookmarks.filter(e=>l.has(e.assemblyName)).map(t=>{const n=r.get(t.assemblyName),a=n?.getCanonicalRefName(t.refName)??t.refName,o=e.bpToPx({refName:a,coord:t.start}),i=e.bpToPx({refName:a,coord:t.end});return o&&i?{width:Math.max(Math.abs(i.offsetPx-o.offsetPx),3),left:Math.min(o.offsetPx,i.offsetPx)-e.offsetPx,highlight:t.highlight,label:t.label,bookmark:t}:void 0}).filter(x.notEmpty).map(({left:e,width:r,highlight:o,label:l,bookmark:c},d)=>(0,te.jsxs)(a.Fragment,{children:[(0,te.jsx)("div",{className:t.highlight,id:"highlight",style:{left:e,width:r,background:o}}),i&&r>20?(0,te.jsx)("div",{className:t.bookmarkButton,style:{left:e},children:(0,te.jsx)(Io.A,{menuItems:[{label:"Open bookmark widget",onClick:()=>{n.showWidget(s)}},{label:"Turn off highlights",onClick:()=>{s.setBookmarkHighlightsVisible(!1)}},{label:"Remove bookmark",onClick:()=>{s.removeBookmarkObject(c)}}],children:(0,te.jsx)(Ro.A,{title:l,arrow:!0,children:(0,te.jsx)(To.A,{fontSize:"small",sx:{color:0!==(0,hr.M)(o).alpha()?(0,hr.M)(o).alpha(.8).toRgbString():(0,hr.M)(o).alpha(0).toRgbString()}})})})}):null]},`${e}_${r}_${d}`)):null}),Do=Fo,No=(0,$a.n)()({highlight:{height:"100%",position:"absolute",left:0}}),Bo=(0,ee.observer)(function({model:e,overview:t}){const{cytobandOffset:n}=e,r=(0,x.getSession)(e),{classes:o}=No(),{assemblyManager:i}=r,{bookmarkHighlightsVisible:s,bookmarkLabelsVisible:l}=e,c=r.widgets.get("GridBookmark");(0,a.useEffect)(()=>{c||r.addWidget("GridBookmarkWidget","GridBookmark")},[r,c]);const d=new Set(e.assemblyNames);return s&&c?.bookmarks?c.bookmarks.filter(e=>d.has(e.assemblyName)).map(e=>{const r=i.get(e.assemblyName),a=r?.getCanonicalRefName(e.refName)??e.refName,o=e.reversed,s=t.bpToPx({refName:a,coord:o?e.end:e.start}),l=t.bpToPx({refName:a,coord:o?e.start:e.end});return void 0!==s&&void 0!==l?{width:Math.abs(l-s),left:s+n,highlight:e.highlight,label:e.label}:void 0}).filter(x.notEmpty).map((e,t)=>{const{left:n,width:r,highlight:a,label:i}=e;return(0,te.jsx)(Ro.A,{title:l?i:"",arrow:!0,children:(0,te.jsx)("div",{className:o.highlight,style:{transform:`translateX(${n}px)`,width:r,background:a,borderLeft:`1px solid ${a}`,borderRight:`1px solid ${a}`}})},`${JSON.stringify(e)}-${t}`)}):null}),Eo=Bo;var Vo=n(67401);const zo=c.types.compose(Vo.Region,c.types.model("Label",{label:c.types.optional(c.types.string,""),highlight:c.types.optional(c.types.string,"rgba(247, 129, 192, 0.35)")})).actions(e=>({setLabel(t){e.label=t},setHighlight(t){e.highlight=t}})),jo=c.types.model("SharedBookmarksModel",{sharedBookmarks:c.types.maybe(c.types.array(zo))}),Ho=()=>"undefined"!=typeof window?`bookmarks-${[window.location.host+window.location.pathname].join("-")}`:"empty",_o=(0,i.S7)("GridBookmarkWidget",{});class Oo extends r.A{name="GridBookmarkPlugin";install(e){(function(e){e.addWidgetType(()=>new o.A({name:"GridBookmarkWidget",heading:"Bookmarked regions",configSchema:_o,stateModel:c.types.model("GridBookmarkModel",{id:Fn.K,type:c.types.literal("GridBookmarkWidget"),bookmarks:c.types.optional(c.types.array(zo),()=>JSON.parse((0,x.localStorageGetItem)(Ho())||"[]"))}).volatile(()=>({selectedBookmarks:[],selectedAssembliesPre:void 0})).views(e=>({get bookmarkAssemblies(){return[...new Set(e.bookmarks.map(e=>e.assemblyName))]},get validAssemblies(){const{assemblyManager:t}=(0,x.getSession)(e);return new Set(this.bookmarkAssemblies.filter(e=>t.get(e)))},get areBookmarksHighlightedOnAllOpenViews(){const{views:t}=(0,x.getSession)(e);return t.every(e=>!("bookmarkHighlightsVisible"in e)||e.bookmarkHighlightsVisible)},get areBookmarksHighlightLabelsOnAllOpenViews(){const{views:t}=(0,x.getSession)(e);return t.every(e=>!("bookmarkLabelsVisible"in e)||e.bookmarkLabelsVisible)}})).views(e=>({get bookmarksWithValidAssemblies(){return e.bookmarks.filter(t=>e.validAssemblies.has(t.assemblyName))}})).views(e=>({get sharedBookmarksModel(){return jo.create({sharedBookmarks:JSON.parse(JSON.stringify(e.selectedBookmarks))})},get allBookmarksModel(){return jo.create({sharedBookmarks:JSON.parse(JSON.stringify(e.bookmarksWithValidAssemblies))})}})).actions(e=>({setSelectedAssemblies(t){e.selectedAssembliesPre=t}})).views(e=>({get selectedAssemblies(){return e.selectedAssembliesPre?.filter(t=>e.validAssemblies.has(t))??[...e.validAssemblies]}})).actions(e=>({importBookmarks(t){e.bookmarks=(0,c.cast)([...e.bookmarks,...t])},addBookmark(t){e.bookmarks.push(t)},removeBookmark(t){e.bookmarks.splice(t,1)},updateBookmarkLabel(e,t){e.correspondingObj.setLabel(t)},updateBookmarkHighlight(e,t){e.correspondingObj.setHighlight(t)},updateBulkBookmarkHighlights(t){for(const n of e.selectedBookmarks)this.updateBookmarkHighlight(n,t)},setSelectedBookmarks(t){e.selectedBookmarks=t},setBookmarkedRegions(t){e.bookmarks=(0,c.cast)(t)},setBookmarkHighlightsVisible(t){const{views:n}=(0,x.getSession)(e);for(const e of n)e.setBookmarkHighlightsVisible?.(t),e.views?.map(e=>{e.setBookmarkHighlightsVisible?.(t)})},setBookmarkLabelsVisible(t){const{views:n}=(0,x.getSession)(e);for(const e of n)e.setBookmarkLabelsVisible?.(t),e.views?.map(e=>{e.setBookmarkHighlightsVisible?.(t)})}})).actions(e=>({clearAllBookmarks(){e.setBookmarkedRegions(e.bookmarks.filter(t=>!e.validAssemblies.has(t.assemblyName)))},clearSelectedBookmarks(){for(const t of e.selectedBookmarks)e.bookmarks.remove(t.correspondingObj);e.selectedBookmarks=[]},removeBookmarkObject(t){e.bookmarks.remove(t)}})).actions(e=>({afterAttach(){const t=Ho();function n(n){if(n.key===t){const n=JSON.parse((0,x.localStorageGetItem)(t)||"[]");e.setBookmarkedRegions(n)}}window.addEventListener("storage",n),(0,c.addDisposer)(e,()=>{window.removeEventListener("storage",n)}),(0,c.addDisposer)(e,(0,N.autorun)(function(){(0,x.localStorageSetItem)(t,JSON.stringify(e.bookmarks))},{name:"BookmarkLocalStorage"}))}})).postProcessSnapshot(e=>{const{bookmarks:t,...n}=e;return n}),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8507),n.e(8501),n.e(3125)]).then(n.bind(n,22427)))})),function(e){e.addToExtensionPoint("LinearGenomeView-TracksContainerComponent",(e,{model:t})=>[...e||[],(0,te.jsx)(Do,{model:t},"highlight_grid_bookmark")]),e.addToExtensionPoint("LinearGenomeView-OverviewScalebarComponent",(e,{model:t,overview:n})=>[...e||[],(0,te.jsx)(Eo,{model:t,overview:n},"overview_highlight_grid_bookmark")])}(e)})(e),e.addToExtensionPoint("Core-extendPluggableElement",e=>{if("LinearGenomeView"===e.name){const{stateModel:t}=e,n=t.props({bookmarkHighlightsVisible:!0,bookmarkLabelsVisible:!0}).actions(e=>({setBookmarkHighlightsVisible(t){e.bookmarkHighlightsVisible=t},setBookmarkLabelsVisible(t){e.bookmarkLabelsVisible=t},activateBookmarkWidget(){const t=(0,x.getSession)(e);if((0,U.lO)(t)){let e=t.widgets.get("GridBookmark");return e||(e=t.addWidget("GridBookmarkWidget","GridBookmark")),t.showWidget(e),t.widgets.get("GridBookmark")}throw new Error("Could not open bookmark widget")}})).actions(e=>({navigateNewestBookmark(){const t=(0,x.getSession)(e),n=e.activateBookmarkWidget();n.bookmarks.length?e.navTo(n.bookmarks.at(-1)):t.notify("There are no recent bookmarks to navigate to.","info")},bookmarkCurrentRegion(){if(e.id===(0,x.getSession)(e).focusedViewId){const t=e.getSelectedRegions(void 0,void 0),n=e.activateBookmarkWidget();if(!t.length)throw new Error("no region selected");n.addBookmark(t[0])}}})).views(e=>{const t=e.menuItems,n=e.rubberBandMenuItems;return{menuItems:()=>[...t(),{label:"Bookmarks",icon:Ao.A,subMenu:[{label:"Open bookmark widget",icon:Ao.A,onClick:()=>e.activateBookmarkWidget()},{label:"Bookmark current region",icon:To.A,onClick:()=>{e.bookmarkCurrentRegion()}},{label:"Toggle bookmark highlights",icon:Mo.A,type:"checkbox",checked:e.bookmarkHighlightsVisible,onClick:()=>{e.setBookmarkHighlightsVisible(!e.bookmarkHighlightsVisible)}},{label:"Toggle bookmark labels",icon:Po.A,type:"checkbox",checked:e.bookmarkLabelsVisible,onClick:()=>{e.setBookmarkLabelsVisible(!e.bookmarkLabelsVisible)}}]}],rubberBandMenuItems:()=>[...n(),{label:"Bookmark region",icon:To.A,onClick:()=>{const{leftOffset:t,rightOffset:n}=e,r=e.getSelectedRegions(t,n),a=e.activateBookmarkWidget();if(!r.length)throw new Error("no regions selected");a.addBookmark(r[0])}}]}}).actions(e=>{const t=t=>{const n=(t.ctrlKey||t.metaKey)&&t.shiftKey;n&&"KeyD"===t.code&&(t.preventDefault(),e.activateBookmarkWidget(),e.bookmarkCurrentRegion(),(0,x.getSession)(e).notify("Bookmark created.","success")),n&&"KeyM"===t.code&&(t.preventDefault(),e.navigateNewestBookmark())};return{afterCreate(){document.addEventListener("keydown",t)},beforeDestroy(){document.removeEventListener("keydown",t)}}}).postProcessSnapshot(e=>{if(!e)return e;const{bookmarkHighlightsVisible:t,bookmarkLabelsVisible:n,...r}=e;return{...r,...!1===t?{bookmarkHighlightsVisible:t}:{},...!1===n?{bookmarkLabelsVisible:n}:{}}});e.stateModel=n}return e})}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToMenu("Tools",{label:"Bookmarks",icon:Ao.A,onClick:e=>{let t=e.widgets.get("GridBookmark");t||(t=e.addWidget("GridBookmarkWidget","GridBookmark")),e.showWidget(t)}})}}const $o=(0,i.S7)("GtfAdapter",{gtfLocation:{type:"fileLocation",description:"path to gtf file, also allows for gzipped gtf",defaultValue:{uri:"/path/to/my.gtf",locationType:"UriLocation"}},aggregateField:{type:"string",description:"field used to aggregate multiple transcripts into a single parent gene feature",defaultValue:"gene_name"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,gtfLocation:{uri:e.uri,baseUri:e.baseUri}}:e});class Go extends r.A{name="GTFPlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"GtfAdapter",displayName:"GTF adapter",configSchema:$o,getAdapterClass:()=>Promise.all([n.e(7710),n.e(5376)]).then(n.bind(n,45376)).then(e=>e.default)}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t);return(0,x.testAdapter)(a,/\.gtf(\.gz)?$/i,r,"GtfAdapter")?{type:"GtfAdapter",gtfLocation:t}:e(t,n,r)})}(e)}}const Wo=(0,i.S7)("HicAdapter",{hicLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.hic",locationType:"UriLocation"}},resolutionMultiplier:{type:"number",defaultValue:1,description:"Initial resolution multiplier"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,hicLocation:{uri:e.uri,baseUri:e.baseUri}}:e});class Uo extends ao.default{supportsSVG=!0;async render(e){const{displayHeight:t,regions:r,bpPerPx:a,colorScheme:o,useLogScale:i}=e;let s=0;for(const e of r)s+=e.end-e.start;const l=s/a,c=l/2,d=t??c,u=await this.getFeatures(e),p=d/Math.max(d,c),{makeImageData:h}=await n.e(8423).then(n.bind(n,8423)),g={...await(0,qn.u)(l,d,e,t=>h(t,{...e,yScalar:p,features:u,pluginManager:this.pluginManager})),height:d,width:l,yScalar:p,colorScheme:o,useLogScale:i};return(0,yt.lk)(g,(0,bt.X)(g))}async getFeatures(e){const{regions:t,sessionId:n,adapterConfig:r}=e,{dataAdapter:a}=await(0,ot.cK)(this.pluginManager,n,r);return a.getMultiRegionContactRecords(t,e)}}const qo=(0,i.S7)("HicRenderer",{baseColor:{type:"color",description:"base color to be used in the hic alignment",defaultValue:"#f00"},color:{type:"color",description:"the color of each feature in a hic alignment",defaultValue:"jexl:interpolate(count,scale)",contextVariable:["count","maxScore","baseColor","scale"]},maxHeight:{type:"integer",description:"the maximum height to be used in a hic rendering",defaultValue:600}},{explicitlyTyped:!0});function Jo(e){return c.types.compose("LinearHicDisplay",L.q,(0,ze.A)(),(0,je.A)(),_e(),c.types.model({type:c.types.literal("LinearHicDisplay"),configuration:(0,i.AK)(e),resolution:c.types.optional(c.types.number,1),useLogScale:!1,colorScheme:c.types.maybe(c.types.string),activeNormalization:"KR",mode:"triangular",showLegend:c.types.maybe(c.types.boolean)})).volatile(()=>({availableNormalizations:void 0,flatbush:void 0,flatbushItems:[],maxScore:0,yScalar:1})).views(e=>({get rendererTypeName(){return"HicRenderer"},get rendererConfig(){return{...(0,R.FI)(e,"renderer"),...e.colorScheme?{color:"jexl:interpolate(count,scale)"}:{}}}})).views(e=>{const{renderProps:t}=e;return{renderProps:()=>({...t(),config:e.rendererConfig,resolution:e.resolution,useLogScale:e.useLogScale,colorScheme:e.colorScheme,normalization:e.activeNormalization,displayHeight:"adjust"===e.mode?e.height:void 0}),legendItems(){const t=e.colorScheme??"juicebox",n=e.useLogScale?e.maxScore:Math.round(e.maxScore/20);return[{label:`${e.useLogScale?"1":"0"} - ${n.toLocaleString()}${e.useLogScale?" (log)":""} (${t})`}]},svgLegendWidth:()=>e.showLegend&&e.maxScore>0?140:0}}).actions(e=>({setFlatbushData(t,n,r,a){e.flatbush=t,e.flatbushItems=n,e.maxScore=r,e.yScalar=a},reload(){e.error=void 0},setResolution(t){e.resolution=t},setUseLogScale(t){e.useLogScale=t},setColorScheme(t){e.colorScheme=t},setActiveNormalization(t){e.activeNormalization=t},setAvailableNormalizations(t){e.availableNormalizations=t},setMode(t){e.mode=t},setShowLegend(t){e.showLegend=t}})).views(e=>{const{trackMenuItems:t}=e;return{trackMenuItems:()=>[...t(),{label:"Use log scale",type:"checkbox",checked:e.useLogScale,onClick:()=>{e.setUseLogScale(!e.useLogScale)}},{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}},{label:"Rendering mode",type:"subMenu",subMenu:[{label:"Triangular",type:"radio",checked:"triangular"===e.mode,onClick:()=>{e.setMode("triangular")}},{label:"Adjust to height of display",type:"radio",checked:"adjust"===e.mode,onClick:()=>{e.setMode("adjust")}}]},{label:"Color scheme",type:"subMenu",subMenu:[{label:"Fall",type:"radio",checked:"fall"===e.colorScheme,onClick:()=>{e.setColorScheme("fall")}},{label:"Viridis",type:"radio",checked:"viridis"===e.colorScheme,onClick:()=>{e.setColorScheme("viridis")}},{label:"Juicebox",type:"radio",checked:"juicebox"===e.colorScheme,onClick:()=>{e.setColorScheme("juicebox")}},{label:"Default",type:"radio",checked:void 0===e.colorScheme,onClick:()=>{e.setColorScheme(void 0)}}]},{label:"Resolution",subMenu:[{label:"Finer resolution",onClick:()=>{e.setResolution(2*e.resolution)}},{label:"Coarser resolution",onClick:()=>{e.setResolution(e.resolution/2)}}]},...e.availableNormalizations?[{label:"Normalization scheme",subMenu:e.availableNormalizations.map(t=>({label:t,type:"radio",checked:t===e.activeNormalization,onClick:()=>{e.setActiveNormalization(t)}}))}]:[]],async renderSvg(t){const{renderSvg:r}=await n.e(8885).then(n.bind(n,58885));return r(e,t)}}}).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttach:t}=await n.e(1777).then(n.bind(n,61777));t(e)}catch(t){console.error(t),e.setError(t)}})()}}))}class Xo extends r.A{name="HicPlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"HicAdapter",displayName:"Hi-C adapter",configSchema:Wo,getAdapterClass:()=>Promise.all([n.e(9131),n.e(6344)]).then(n.bind(n,86344)).then(e=>e.default)}))}(e),function(e){e.addRendererType(()=>new Uo({name:"HicRenderer",ReactComponent:(0,a.lazy)(()=>n.e(9939).then(n.bind(n,9939))),configSchema:qo,pluginManager:e}))}(e),function(e){e.addTrackType(()=>{const t=(e=>(0,i.S7)("HicTrack",{},{baseConfiguration:(0,g.J)(e)}))(e);return new p.A({name:"HicTrack",displayName:"Hi-C track",configSchema:t,stateModel:(0,h.E)(e,"HicTrack",t)})})}(e),function(e){e.addDisplayType(()=>{const t=(e=>(0,i.S7)("LinearHicDisplay",{renderer:e.getRendererType("HicRenderer").configSchema,height:{type:"number",defaultValue:300,description:"default height for the Hi-C track"}},{baseConfiguration:I.A,explicitlyTyped:!0}))(e);return new P.A({name:"LinearHicDisplay",displayName:"Hi-C contact matrix display",configSchema:t,stateModel:Jo(t),trackType:"HicTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9011),n.e(2231)]).then(n.bind(n,42231)))})})}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t);return/\.hic$/i.test(a)&&!r||"HicAdapter"===r?{type:"HicAdapter",hicLocation:t}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"HicAdapter"===t?"HicTrack":e(t))}(e)}configure(e){const{jexl:t}=e;t.addFunction("alpha",(e,t)=>e.alpha(t)),t.addFunction("hsl",e=>(0,hr.M)(e.toHsl())),t.addFunction("colorString",e=>e.toHex()),t.addFunction("interpolate",(e,t)=>t(e))}}const Ko=c.types.model("Job",{name:c.types.string,statusMessage:c.types.maybe(c.types.string),progressPct:c.types.number}).volatile(()=>({cancelCallback(){}})).actions(e=>({setCancelCallback(t){e.cancelCallback=t},setStatusMessage(t){e.statusMessage=t},setProgressPct(t){e.progressPct=t}})),Qo=(0,i.S7)("JobsListWidget",{});class Yo extends r.A{name="JobsManagementPlugin";install(e){!function(e){e.addWidgetType(()=>new o.A({name:"JobsListWidget",heading:"Jobs list",configSchema:Qo,stateModel:c.types.model("JobsListModel",{id:Fn.K,type:c.types.literal("JobsListWidget"),jobs:c.types.array(Ko),finished:c.types.array(Ko),queued:c.types.array(Ko),aborted:c.types.array(Ko)}).actions(e=>({addJob(t){const{cancelCallback:n,name:r}=t,a=e.jobs.find(e=>e.name===r);if(a)return a;const o=e.jobs.push(t),i=e.jobs[o-1];return i.setCancelCallback(n),i},removeJob(t){const n=e.jobs.findIndex(e=>e.name===t);if(-1!==n)return e.jobs.splice(n,1)[0]},addFinishedJob(t){const n=e.finished.find(e=>e.name===t.name);if(n)return n;const r=e.finished.push(t);return e.finished[r-1]},addQueuedJob(t){const n=e.queued.find(e=>e.name===t.name);if(n)return n;const r=e.queued.push(t);return e.queued[r-1]},addAbortedJob(t){const n=e.aborted.find(e=>e.name===t.name);if(n)return n;const r=e.aborted.push(t);return e.aborted[r-1]},removeQueuedJob(t){const n=e.queued.findIndex(e=>e.name===t);if(-1!==n)return e.queued.splice(n,1)[0]},updateJobStatusMessage(t,n){const r=e.jobs.find(e=>e.name===t);if(!r)throw new Error(`No job found with name ${t}`);r.setStatusMessage(n)},updateJobProgressPct(t,n){const r=e.jobs.find(e=>e.name===t);if(!r)throw new Error(`No job found with name ${t}`);r.setProgressPct(n)}})),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(2687),n.e(8632)]).then(n.bind(n,48632)))}))}(e)}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToMenu("Tools",{label:"Jobs list",icon:aa.jT,onClick:e=>{if((0,U.lO)(e)){const{widgets:t}=e;let n=t.get("JobsList");n||(n=e.addWidget("JobsListWidget","JobsList")),e.showWidget(n)}}})}}var Zo=n(14261),ei=n(13861);const ti=(0,i.S7)("JBrowse1Connection",{dataDirLocation:{type:"fileLocation",defaultValue:{uri:"http://mysite.com/jbrowse/data/",locationType:"UriLocation"},description:"the location of the JBrowse 1 data directory, often something like http://mysite.com/jbrowse/data/"},assemblyNames:{description:"name of the assembly the connection belongs to, should be a single entry",type:"stringArray",defaultValue:[]}},{baseConfiguration:ei.A});var ni=n(89322);function ri(e){return c.types.compose("JBrowse1Connection",(0,ni.A)(e),c.types.model({configuration:(0,i.AK)(ti),type:c.types.literal("JBrowse1Connection")})).actions(e=>({async connect(){const t=(0,x.getSession)(e);try{const t=(0,R.FI)(e,"dataDirLocation"),{fetchJb1:r}=await n.e(6900).then(n.bind(n,86900)),{convertTrackConfig:a}=await n.e(3264).then(n.bind(n,33264)),o=await r(t),i=(0,R.FI)(e,"assemblyNames")[0];if(!i)throw new Error("assembly name required for JBrowse 1 connection");const s=o.tracks?.map(e=>({...a(e,o.dataRoot||""),assemblyNames:[i]}));e.setTrackConfs(s)}catch(n){console.error(n),t.notifyError(`There was a problem connecting to the JBrowse 1 data directory "${e.name}". Please make sure you have entered a valid location. The error that was thrown is: "${n}"`,n),t.breakConnection?.(e.configuration)}}}))}var ai=n(47011);const oi=(0,i.S7)("JBrowse1TextSearchAdapter",{namesIndexLocation:{type:"fileLocation",defaultValue:{uri:"/volvox/names",locationType:"UriLocation"},description:"the location of the JBrowse1 names index data directory"},tracks:{type:"stringArray",defaultValue:[],description:"List of tracks covered by text search adapter"},assemblyNames:{type:"stringArray",defaultValue:[],description:"List of assemblies covered by text search adapter"}},{explicitlyTyped:!0,explicitIdentifier:"textSearchAdapterId"}),ii=(0,i.S7)("NCListAdapter",{rootUrlTemplate:{type:"fileLocation",defaultValue:{uri:"/path/to/my/{refseq}/trackData.json",locationType:"UriLocation"}},refNames:{type:"stringArray",defaultValue:[],description:"List of refNames used by the NCList used for aliasing"}},{explicitlyTyped:!0});class si extends r.A{name="LegacyJBrowsePlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"NCListAdapter",displayName:"NCList adapter",configSchema:ii,adapterMetadata:{category:"Uncommon"},getAdapterClass:()=>n.e(91).then(n.bind(n,91)).then(e=>e.default)}))}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t);return/trackData.jsonz?$/i.test(a)&&!r||"NCListAdapter"===r?{type:"NCListAdapter",rootUrlTemplate:t}:e(t,n,r)})}(e),function(e){e.addTextSearchAdapterType(()=>new ai.A({name:"JBrowse1TextSearchAdapter",configSchema:oi,description:"A JBrowse 1 text search adapter",getAdapterClass:()=>n.e(6169).then(n.bind(n,76169)).then(e=>e.default)}))}(e),function(e){e.addConnectionType(()=>new Zo.A({name:"JBrowse1Connection",configSchema:ti,stateModel:ri(e),displayName:"JBrowse 1 Data",description:"A JBrowse 1 data directory",url:"//jbrowse.org/"}))}(e)}}var li=n(56994);const ci=(0,a.lazy)(()=>n.e(8183).then(n.bind(n,58183))),di=function(e){return(0,i.S7)("LinearComparativeDisplay",{},{explicitlyTyped:!0,explicitIdentifier:"displayId"})};function ui(e){const{rpcManager:t}=(0,x.getSession)(e),n=e;(0,R.QZ)(e.configuration);const{level:r,adapterConfig:a}=e,o=(0,x.getContainingView)(e),i=(0,C.getRpcSessionId)(e);return(0,c.getSnapshot)(o),o.initialized?{rpcManager:t,renderProps:{...n.renderProps(),model:n,level:r,view:o,adapterConfig:a,sessionId:i,timeout:1e6,self:e}}:void 0}async function pi(e){if(!e)return;const{rpcManager:t,renderProps:n}=e,{model:r,sessionId:a,adapterConfig:o,level:i}=n,s=n.view.views[i];return{features:(0,io.Q)(await t.call(a,"CoreGetFeatures",{regions:s.staticBlocks.contentBlocks,sessionId:a,adapterConfig:o,statusCallback:e=>{r.setLoadingStatus(e)}}),e=>e.id())}}const hi=function(e){return c.types.compose("LinearComparativeDisplay",L.q,c.types.model({type:c.types.literal("LinearComparativeDisplay"),configuration:(0,i.AK)(e)})).volatile(()=>({renderInProgress:void 0,features:void 0,message:void 0,loadingStatus:void 0})).views(e=>{const{renderProps:t}=e;return{get level(){return(0,c.getParent)(e,4).level},get height(){return(0,c.getParent)(e,4).height},renderProps:()=>({...t()})}}).actions(e=>{let t;return{setLoading(n){e.message=void 0,e.error=void 0,t=n},setMessage(n){e.message=n,e.error=void 0,t=void 0},setLoadingStatus(t){e.loadingStatus=t},setRendered(n){if(!n)return;const{features:r}=n,a=e.features||[],o=new Set(a.map(e=>e.id())),i=new Set(r.map(e=>e.id()));let s=!1,l=!1;for(const e of r)if(!o.has(e.id())){s=!0;break}for(const e of a)if(!i.has(e.id())){l=!0;break}e.message=void 0,e.error=void 0,t=void 0,(s||l||!e.features)&&(e.features=r)},setError(n){console.error(n),void 0!==t&&(0,He.CF)(t),e.message=void 0,e.error=n,t=void 0}}}).actions(e=>({afterAttach(){(0,Ha.I)(e,ui,pi,{name:`${e.type} ${e.id} rendering`,delay:1e3,fireImmediately:!0},e.setLoading,e.setRendered,e.setError)}}))},gi=(0,a.lazy)(()=>n.e(5015).then(n.bind(n,15015))),mi=function(e){const t=e.getViewType("LinearSyntenyViewHelper")?.stateModel;return c.types.compose("LinearComparativeView",Hn.A,c.types.model({id:Fn.K,type:c.types.literal("LinearComparativeView"),trackSelectorType:"hierarchical",showIntraviewLinks:!0,linkViews:!1,interactiveOverlay:!1,showDynamicControls:!0,levels:c.types.array(t),views:c.types.array(e.getViewType("LinearGenomeView").stateModel),viewTrackConfigs:c.types.array(e.pluggableConfigSchemaType("track"))})).volatile(()=>({width:void 0,isLoading:!1})).views(e=>({get initialized(){return void 0!==e.width&&e.views.length>0&&e.views.every(e=>e.initialized)},get refNames(){return e.views.map(e=>[...new Set(e.staticBlocks.map(e=>e.refName))])},get assemblyNames(){return[...new Set(e.views.flatMap(e=>e.assemblyNames))]},get loadingMessage(){return this.showLoading?"Loading":void 0},get showLoading(){return e.isLoading||!this.initialized&&e.views.length>0}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,c.addMiddleware)(e,(t,n)=>{if("action"===t.type&&t.id===t.rootId){const r=["horizontalScroll","zoomTo","setScaleFactor"];if(e.linkViews&&r.includes(t.name)){const r=(0,c.getPath)(t.context);n(t);for(const n of e.views)(0,c.getPath)(n)!==r&&n[t.name](t.args[0]);return}}n(t)}))},beforeDestroy(){const t=(0,x.getSession)(e);for(const n of e.assemblyNames)t.removeTemporaryAssembly?.(n)},setWidth(t){e.width=t},setIsLoading(t){e.isLoading=t},setViews(t){e.views=(0,c.cast)(t);const n=[];for(let e=0;e<t.length-1;e++)n.push({level:e});e.levels=(0,c.cast)(n)},removeView(t){e.views.remove(t)},setLevelHeight(t,n=0){const r=e.levels[n];return r.setHeight(t),r.height},setLinkViews(t){e.linkViews=t},setShowDynamicControls(t){e.showDynamicControls=t},activateTrackSelector(t){if("hierarchical"===e.trackSelectorType){const n=(0,x.getSession)(e);if((0,U.lO)(n)){const r=n.addWidget("HierarchicalTrackSelectorWidget","hierarchicalTrackSelector",{view:e.levels[t]});return n.showWidget(r),r}}throw new Error(`invalid track selector type ${e.trackSelectorType}`)},toggleTrack(t,n=0){e.levels[n]?.toggleTrack(t)},showTrack(t,n=0,r={}){e.levels[n]||(e.levels[n]=(0,c.cast)({level:n})),e.levels[n].showTrack(t,r)},hideTrack(t,n=0){e.levels[n]?.hideTrack(t)},squareView(){const t=(0,x.avg)(e.views.map(e=>e.bpPerPx));for(const n of e.views){const e=n.pxToBp(n.width/2);n.setNewView(t,n.offsetPx),e.refName&&n.centerAt(e.coord,e.refName,e.index)}},clearView(){e.views=(0,c.cast)([]),e.levels=(0,c.cast)([])}})).views(()=>({headerMenuItems:()=>[]})).views(e=>({menuItems:()=>[{label:"Return to import form",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[gi,{model:e,handleClose:t}])},icon:oa.A}],rubberBandMenuItems:()=>[{label:"Zoom to region(s)",onClick:()=>{for(const t of e.views){const{leftOffset:e,rightOffset:n}=t;e&&n&&t.moveTo(e,n)}}}]})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){if(e.width)for(const t of e.views)t.setWidth(e.width)},{name:"ComparativeViewWidth"}))}})).preProcessSnapshot(e=>{const{tracks:t,levels:n=[{tracks:t,level:0}],...r}=e||{};return{...r,levels:n}}).postProcessSnapshot(e=>{if(!e)return e;const{trackSelectorType:t,showIntraviewLinks:n,linkViews:r,interactiveOverlay:a,showDynamicControls:o,viewTrackConfigs:i,...s}=e;return{...s,..."hierarchical"!==t?{trackSelectorType:t}:{},...n?{}:{showIntraviewLinks:n},...r?{linkViews:r}:{},...a?{interactiveOverlay:a}:{},...o?{}:{showDynamicControls:o},...i.length?{viewTrackConfigs:i}:{}}})},fi=(0,a.lazy)(()=>n.e(7910).then(n.bind(n,7910)));var yi=n(29742);const bi=function(e){return c.types.compose("LinearSyntenyDisplay",hi(e),c.types.model({type:c.types.literal("LinearSyntenyDisplay"),configuration:(0,i.AK)(e),colorBy:c.types.optional(c.types.string,"default"),alpha:c.types.optional(c.types.number,.2),minAlignmentLength:c.types.optional(c.types.number,0)})).volatile(()=>({mainCanvas:null,clickMapCanvas:null,cigarClickMapCanvas:null,mouseoverCanvas:null,featPositions:[],mouseoverId:void 0,clickId:void 0,cigarMouseoverId:-1})).actions(e=>({setFeatPositions(t){e.featPositions=t},setMainCanvasRef(t){e.mainCanvas=t},setClickMapCanvasRef(t){e.clickMapCanvas=t},setCigarClickMapCanvasRef(t){e.cigarClickMapCanvas=t},setMouseoverCanvasRef(t){e.mouseoverCanvas=t},setMouseoverId(t){e.mouseoverId=t},setCigarMouseoverId(t){e.cigarMouseoverId=t},setClickId(t){e.clickId=t},setAlpha(t){e.alpha=t},setMinAlignmentLength(t){e.minAlignmentLength=t},setColorBy(t){e.colorBy=t}})).views(e=>({get adapterConfig(){return{name:e.parentTrack.configuration.adapter.type,assemblyNames:(0,R.FI)(e,"assemblyNames"),...(0,R.FI)(e.parentTrack,"adapter")}},get trackIds(){return(0,R.FI)(e,"trackIds")},get numFeats(){return e.featPositions.length},get ready(){return this.numFeats>0},get featMap(){return Object.fromEntries(e.featPositions.map(e=>[e.f.id(),e]))},get colorSchemeConfig(){return yi.yM[e.colorBy]||yi.yM.default},get colorMapWithAlpha(){const{alpha:t}=e,n=this.colorSchemeConfig.cigarColors;return{I:(0,yi.Th)(n.I,t),N:(0,yi.Th)(n.N,t),D:(0,yi.Th)(n.D,t),X:(0,yi.Th)(n.X,t),M:(0,yi.Th)(n.M,t),"=":(0,yi.Th)(n["="],t)}},get posColorWithAlpha(){const t="strand"===e.colorBy?yi.yM.strand.posColor:"red";return(0,yi.Th)(t,e.alpha)},get negColorWithAlpha(){const t="strand"===e.colorBy?yi.yM.strand.negColor:"blue";return(0,yi.Th)(t,e.alpha)},get queryColorWithAlphaMap(){const{alpha:t}=e,n=new Map;return e=>{if(!n.has(e)){const r=(0,yi.i0)(e);n.set(e,(0,yi.Th)(r,t))}return n.get(e)}},get queryTotalLengths(){if(e.minAlignmentLength<=0)return;const t=new Map;for(const{f:n}of e.featPositions){const e=n.get("name")||n.get("id")||n.id(),r=Math.abs(n.get("end")-n.get("start")),a=t.get(e)||0;t.set(e,a+r)}return t}})).actions(e=>({afterAttach(){(async()=>{try{const{doAfterAttach:t}=await n.e(9143).then(n.bind(n,69143));t(e)}catch(t){console.error(t),e.setError(t)}})()}}))};var wi=n(93777),vi=n(20524);function Si(e){const t=(0,Ut.c)(3);let n,r;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,te.jsx)("path",{fill:"currentColor",d:"M16.5,21C13.5,21 12.31,16.76 11.05,12.28C10.14,9.04 9,5 7.5,5C4.11,5 4,11.93 4,12H2C2,11.63 2.06,3 7.5,3C10.5,3 11.71,7.25 12.97,11.74C13.83,14.8 15,19 16.5,19C19.94,19 20.03,12.07 20.03,12H22.03C22.03,12.37 21.97,21 16.5,21Z"}),t[0]=n):n=t[0],t[1]!==e?(r=(0,te.jsx)(qt.A,{...e,children:n}),t[1]=e,t[2]=r):r=t[2],r}const ki=(0,a.lazy)(()=>n.e(3891).then(n.bind(n,93891))),xi=(0,a.lazy)(()=>n.e(9823).then(n.bind(n,79823)));function Ci(e){return c.types.compose("LinearSyntenyView",mi(e),c.types.model({type:c.types.literal("LinearSyntenyView"),drawCIGAR:!0,drawCIGARMatchesOnly:!1,drawCurves:!1,drawLocationMarkers:!1,init:c.types.frozen()})).volatile(()=>({importFormSyntenyTrackSelections:N.observable.array()})).views(e=>({get hasSomethingToShow(){return e.views.length>0||!!e.init}})).views(e=>({get showLoading(){return e.isLoading||!e.initialized&&e.hasSomethingToShow},get showImportForm(){return!e.hasSomethingToShow}})).actions(e=>({importFormRemoveRow(t){e.importFormSyntenyTrackSelections.splice(t,1)},clearImportFormSyntenyTracks(){e.importFormSyntenyTrackSelections.clear()},setImportFormSyntenyTrack(t,n){e.importFormSyntenyTrackSelections[t]=n},setDrawCurves(t){e.drawCurves=t},setDrawCIGAR(t){e.drawCIGAR=t},setDrawCIGARMatchesOnly(t){e.drawCIGARMatchesOnly=t},setDrawLocationMarkers(t){e.drawLocationMarkers=t},showAllRegions(){for(const t of e.views)t.showAllRegionsInAssembly()},setInit(t){e.init=t}})).actions(e=>({async exportSvg(t){const{renderToSvg:r}=await n.e(6619).then(n.bind(n,36619)),a=await r(e,t),{saveAs:o}=await n.e(9044).then(n.bind(n,99044));o(new Blob([a],{type:"image/svg+xml"}),t.filename||"image.svg")}})).views(e=>{const t=e.headerMenuItems,n=e.menuItems;return{headerMenuItems:()=>[...t(),{label:"Square view",onClick:e.squareView,description:"Makes both views use the same zoom level, adjusting to the average of each",icon:wi.A,helpText:"Square view synchronizes the zoom levels of both genome views by calculating the average zoom level and applying it to both panels. This helps ensure features are displayed at comparable scales, making it easier to compare syntenic regions visually."},{label:"Re-order chromosomes",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[xi,{handleClose:t,model:e}])},icon:vi.A,description:"Reorder and reorient query regions to minimize crossing lines, also known as 'diagonalizing'",helpText:"This operation 'diagonalizes' the data which algorithmically reorders and reorients chromosomes to minimize crossing synteny lines, creating a more diagonal pattern. This makes it easier to identify large-scale genomic rearrangements, inversions, and translocations. The process may take a few moments for large genomes."},{label:"Show...",subMenu:[{label:"Show all regions",onClick:e.showAllRegions,description:"Show entire genome assemblies",icon:Y.A,helpText:"This command will zoom out all views to display the entire genome assemblies. This is useful when you want to get a high-level overview of syntenic relationships across whole genomes or when you need to reset the view after zooming into specific regions."},{label:"Show dynamic controls",type:"checkbox",checked:e.showDynamicControls,onClick:()=>{e.setShowDynamicControls(!e.showDynamicControls)},helpText:"Toggle visibility of dynamic controls like opacity and minimum length sliders. These controls allow you to adjust synteny visualization parameters in real-time."},{label:"Show CIGAR insertions/deletions",checked:e.drawCIGAR,type:"checkbox",description:"If disabled, only shows the broad scale CIGAR match",onClick:()=>{e.setDrawCIGAR(!e.drawCIGAR)},helpText:"CIGAR strings encode detailed alignment information including matches, insertions, and deletions. When enabled, this option visualizes the fine-scale variations in syntenic alignments. Disable this for a cleaner view that shows only broad syntenic blocks."},{label:"Show CIGAR matches only",checked:e.drawCIGARMatchesOnly,type:"checkbox",description:"If enabled, hides the insertions and deletions in the CIGAR strings",onClick:()=>{e.setDrawCIGARMatchesOnly(!e.drawCIGARMatchesOnly)},helpText:"When comparing divergent genomes, showing all insertions and deletions can clutter the view. This option filters the CIGAR visualization to show only the matching regions, providing a cleaner view of conserved syntenic blocks while hiding small-scale indels."},{label:"Show curved lines",type:"checkbox",checked:e.drawCurves,icon:Si,onClick:()=>{e.setDrawCurves(!e.drawCurves)},helpText:"Toggle between straight lines and smooth bezier curves for synteny connections. Curved lines can make the visualization more aesthetically pleasing and may help reduce visual clutter when many syntenic regions are displayed. Straight lines provide a more direct representation."},{label:"Show location markers",type:"checkbox",checked:e.drawLocationMarkers,description:"Draw periodic markers to show location within large matches",onClick:()=>{e.setDrawLocationMarkers(!e.drawLocationMarkers)},helpText:"Location markers add periodic visual indicators along long syntenic blocks, helping you track position and scale within large conserved regions. This is particularly useful when examining very long syntenic matches where it can be difficult to gauge relative position."}]},{label:"Link views",type:"checkbox",checked:e.linkViews,icon:_n.A,onClick:()=>{e.setLinkViews(!e.linkViews)},helpText:"When linked, panning and zooming in one genome view will automatically adjust the other view to maintain the correspondence shown by synteny lines. This makes it easier to explore syntenic regions interactively. Unlink views to navigate each genome independently."},{label:"Export SVG",icon:On.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ki,{model:e,handleClose:t}])}}],menuItems:()=>[...n(),{label:"Export SVG",icon:On.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ki,{model:e,handleClose:t}])}}]}}).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(async function(){const{init:t,width:n}=e;if(!n||!t)return;const r=(0,x.getSession)(e),{assemblyManager:a}=r;try{const n=await Promise.all(t.views.map(async e=>{const t=await a.waitForAssembly(e.assembly);if(!t)throw new Error(`Assembly ${e.assembly} failed to load`);return t}));if(e.setViews(n.map(e=>({type:"LinearGenomeView",bpPerPx:1,offsetPx:0,hideHeader:!0,displayedRegions:e.regions}))),await Promise.all(e.views.map(e=>(0,N.when)(()=>e.initialized))),await Promise.all(t.views.map(async(t,n)=>{const r=e.views[n];if(r&&(t.loc?await r.navToLocString(t.loc,t.assembly):r.showAllRegionsInAssembly(t.assembly),t.tracks))for(const e of t.tracks)r.showTrack(e)})),t.tracks)for(const n of t.tracks)e.showTrack(n);e.setInit(void 0)}catch(t){console.error(t),r.notifyError(`${t}`,t),e.setInit(void 0)}},{name:"LinearSyntenyViewInit"}))}})).postProcessSnapshot(e=>{if(!e)return e;const{init:t,drawCIGAR:n,drawCIGARMatchesOnly:r,drawCurves:a,drawLocationMarkers:o,...i}=e;return{...i,...n?{}:{drawCIGAR:n},...r?{drawCIGARMatchesOnly:r}:{},...a?{drawCurves:a}:{},...o?{drawLocationMarkers:o}:{}}})}function Ti(e){return c.types.model("LinearSyntenyViewHelper",{id:Fn.K,type:"LinearSyntenyViewHelper",tracks:c.types.array(e.pluggableMstType("track","stateModel")),height:100,level:c.types.number}).actions(e=>({setHeight:t=>(e.height=t,e.height),showTrack:(t,n={})=>(0,C.showTrackGeneric)(e,t,n),hideTrack:t=>(0,C.hideTrackGeneric)(e,t),toggleTrack(t){(0,C.toggleTrackGeneric)(e,t)}})).views(e=>({get assemblyNames(){const t=(0,c.getParent)(e,2);return[t.views[e.level].assemblyNames[0],t.views[e.level+1].assemblyNames[0]]}}))}function Ai(){const e=(0,Ut.c)(1);let t;return e[0]===Symbol.for("react.memo_cache_sentinel")?(t=(0,te.jsx)("div",{}),e[0]=t):t=e[0],t}const Mi=(0,i.S7)("SyntenyFeatureWidget",{});function Pi(e){return c.types.compose((0,l.n)(e),c.types.model("SyntenyFeatureWidget",{type:c.types.literal("SyntenyFeatureWidget"),level:c.types.maybe(c.types.number)}))}class Ii extends r.A{name="LinearComparativeViewPlugin";install(e){!function(e){e.addViewType(()=>new jn.A({name:"LinearSyntenyViewHelper",displayName:"Linear synteny view (helper)",viewMetadata:{hiddenFromGUI:!0},stateModel:Ti(e),ReactComponent:Ai}))}(e),function(e){e.addViewType(()=>new jn.A({name:"LinearComparativeView",viewMetadata:{hiddenFromGUI:!0},displayName:"Linear comparative view",stateModel:mi(e),ReactComponent:(0,a.lazy)(()=>n.e(1838).then(n.bind(n,51838)))}))}(e),function(e){e.addViewType(()=>new jn.A({name:"LinearSyntenyView",displayName:"Linear synteny view",stateModel:Ci(e),ReactComponent:(0,a.lazy)(()=>n.e(5929).then(n.bind(n,95929)))}))}(e),function(e){e.addDisplayType(()=>{const e=di();return new P.A({name:"LinearComparativeDisplay",configSchema:e,stateModel:hi(e),trackType:"SyntenyTrack",viewType:"LinearComparativeView",ReactComponent:()=>null})})}(e),function(e){e.addDisplayType(()=>{const e=(0,i.S7)("LinearSyntenyDisplay",{trackIds:{type:"stringArray",defaultValue:[]},middle:{type:"boolean",defaultValue:!0}},{baseConfiguration:di(),explicitlyTyped:!0});return new P.A({name:"LinearSyntenyDisplay",configSchema:e,stateModel:bi(e),trackType:"SyntenyTrack",viewType:"LinearSyntenyViewHelper",ReactComponent:(0,a.lazy)(()=>n.e(7523).then(n.bind(n,37523)))})})}(e),function(e){e.addWidgetType(()=>new o.A({name:"SyntenyFeatureWidget",heading:"Synteny feature details",configSchema:Mi,stateModel:Pi(e),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2687),n.e(8507),n.e(8769),n.e(9764),n.e(5618)]).then(n.bind(n,55618)))}))}(e),function(e){e.addDisplayType(()=>{const t=function(e){return e.jexl.addFunction("lgvSyntenyTooltip",e=>{const t=e.get("mate"),n=e.get("name")||e.get("id"),r=t?.name||t?.id;return[n?`Name1: ${n}`:"",r?`Name2: ${r}`:"",`Loc1: ${(0,x.assembleLocString)({refName:e.get("refName"),start:e.get("start"),end:e.get("end")})} (${(0,x.toLocale)(e.get("end")-e.get("start"))}bp)`,`Loc2: ${(0,x.assembleLocString)({refName:t.refName,start:t.start,end:t.end})} (${(0,x.toLocale)(t.end-t.start)}bp)`].filter(e=>!!e).join("<br/>")}),(0,i.S7)("LGVSyntenyDisplay",{mouseover:{type:"string",defaultValue:"jexl:lgvSyntenyTooltip(feature)"}},{baseConfiguration:_(e),explicitlyTyped:!0})}(e),n=(r=t,c.types.compose("LGVSyntenyDisplay",Re(r),c.types.model({type:c.types.literal("LGVSyntenyDisplay"),configuration:(0,i.AK)(r)})).views(e=>{const t=e.contextMenuItems;return{contextMenuItems(){const n=e.contextMenuFeature;return[...t(),...n?[{label:"Launch synteny view for this position",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[ci,{view:(0,x.getContainingView)(e),trackId:(0,R.FI)((0,x.getContainingTrack)(e),"trackId"),handleClose:t,session:(0,x.getSession)(e),feature:n}])}}]:[]]}}}).views(e=>{const{trackMenuItems:t,colorSchemeSubMenuItems:n}=e;return{trackMenuItems:()=>[...t(),{label:"Color scheme",subMenu:[...n()]}]}}).actions(e=>({selectFeature(t){const n=(0,x.getSession)(e);if((0,U.lO)(n)){let r=(0,x.getContainingView)(e);try{r=(0,x.getContainingView)(r)}catch(e){}const a=n.addWidget("SyntenyFeatureWidget","syntenyFeature",{featureData:t.toJSON(),view:r,track:(0,x.getContainingTrack)(e)});n.showWidget(a)}n.setSelection(t)},afterCreate(){e.colorBySetting||"normal"!==e.colorBy.type||e.setColorScheme({type:"strand"})}})));var r;return new P.A({name:"LGVSyntenyDisplay",configSchema:t,stateModel:n,trackType:"SyntenyTrack",viewType:"LinearGenomeView",ReactComponent:z.Ay})})}(e),function(e){e.addToExtensionPoint("LaunchView-LinearSyntenyView",async({session:e,views:t,tracks:n=[]})=>{const r=Array.isArray(n[0])?n.flat():n;e.addView("LinearSyntenyView",{init:{views:t.map(e=>({loc:e.loc,assembly:e.assembly,tracks:e.tracks})),tracks:r}})})}(e),function(e){e.addTrackType(()=>{const t=(e=>(0,i.S7)("SyntenyTrack",{},{baseConfiguration:(0,g.J)(e)}))(e);return new p.A({name:"SyntenyTrack",configSchema:t,stateModel:(0,h.E)(e,"SyntenyTrack",t)})})}(e),e.addToExtensionPoint("Core-extendPluggableElement",e=>("LinearPileupDisplay"!==e.name||(e.stateModel=e.stateModel.extend(e=>{const t=e.contextMenuItems;return{views:{contextMenuItems(){const n=e.contextMenuFeature,r=(0,x.getContainingTrack)(e);return[...t(),...n?[{label:"Linear read vs ref",icon:Ya.A,onClick:()=>{(0,x.getSession)(e).queueDialog(e=>[fi,{track:r,feature:n,handleClose:e}])}}]:[]]}}}})),e))}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"Linear synteny view",icon:li.A,onClick:e=>{e.addView("LinearSyntenyView",{})}})}}var Ri=n(93646);function Li(e){return c.types.compose("LinearLollipopDisplay",J.L,c.types.model({type:c.types.literal("LinearLollipopDisplay"),configuration:(0,i.AK)(e)})).views(e=>{const{renderProps:t}=e;return{get blockType(){return"dynamicBlocks"},get renderDelay(){return 500},renderProps:()=>({...t(),config:e.configuration.renderer}),get rendererTypeName(){return e.configuration.renderer.type}}})}class Fi extends Lt.default{}const Di=(0,i.S7)("LollipopRenderer",{strokeColor:{type:"color",description:"the outer color of each lollipop",defaultValue:"green",contextVariable:["feature"]},innerColor:{type:"color",description:"the inner color of each lollipop",defaultValue:"#7fc75f",contextVariable:["feature"]},strokeWidth:{type:"number",description:"width of the stroked border",defaultValue:4,contextVariable:["feature"]},radius:{type:"number",description:"radius in pixels of each lollipop body",defaultValue:"jexl:sqrt(max(3, (get(feature,'score')*10)/3.14))",contextVariable:["feature"]},caption:{type:"string",description:"the tooltip caption displayed when the mouse hovers over a lollipop",defaultValue:"jexl:get(feature,'name')",contextVariable:["feature"]},minStickLength:{type:"number",description:'minimum lollipop "stick" length, in pixels',defaultValue:5},stickColor:{type:"color",description:"color of the lollipop stick",defaultValue:"black",contextVariable:["feature"]},stickWidth:{type:"number",description:"width in pixels of the lollipop stick",defaultValue:2,contextVariable:["feature"]},score:{type:"number",description:'the "score" of each lollipop, displayed as a number in the center of the circle',defaultValue:"jexl:get(feature,'score')",contextVariable:["feature"]}},{explicitlyTyped:!0});class Ni extends r.A{name="LollipopPlugin";install(e){!function(e){e.addRendererType(()=>new Fi({name:"LollipopRenderer",ReactComponent:(0,a.lazy)(()=>n.e(3477).then(n.bind(n,83477))),configSchema:Di,pluginManager:e}))}(e),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearLollipopDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:I.A,explicitlyTyped:!0})}(e);return new P.A({name:"LinearLollipopDisplay",configSchema:t,stateModel:Li(t),trackType:"LollipopTrack",viewType:"LinearGenomeView",ReactComponent:z.Ay})})}(e)}}var Bi=n(43506),Ei=n(76361);const Vi=(0,i.S7)("AboutWidget",{}),zi=c.types.model("AboutWidget",{id:Fn.K,type:c.types.literal("AboutWidget")}),ji=(0,i.S7)("HelpWidget",{}),Hi=c.types.model("HelpWidget",{id:Fn.K,type:c.types.literal("HelpWidget")}),_i=(0,i.S7)("ImportSessionWidget",{}),Oi=c.types.model("ImportSessionWidget",{id:Fn.K,type:c.types.literal("ImportSessionWidget")}),$i=(0,i.S7)("SessionManager",{}),Gi=c.types.model("SessionManager",{id:Fn.K,type:c.types.literal("SessionManager")});class Wi extends r.A{name="MenusPlugin";install(e){!function(e){e.addWidgetType(()=>new o.A({name:"AboutWidget",heading:"About",configSchema:Vi,stateModel:zi,ReactComponent:(0,a.lazy)(()=>n.e(1326).then(n.bind(n,71326)))}))}(e),function(e){e.addWidgetType(()=>new o.A({name:"HelpWidget",heading:"Help",configSchema:ji,stateModel:Hi,ReactComponent:(0,a.lazy)(()=>n.e(1564).then(n.bind(n,71564)))}))}(e),function(e){e.addWidgetType(()=>new o.A({name:"ImportSessionWidget",heading:"Import session",configSchema:_i,stateModel:Oi,ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(5391),n.e(375)]).then(n.bind(n,80375)))}))}(e),function(e){e.addWidgetType(()=>new o.A({name:"SessionManager",heading:"Recent sessions",configSchema:$i,stateModel:Gi,ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(8507),n.e(2116),n.e(730)]).then(n.bind(n,50730)))}))}(e)}configure(e){(0,U.Nh)(e.rootModel)&&(e.rootModel.appendToMenu("Help",{label:"About",icon:Ei.A,onClick:e=>{const t=e.addWidget("AboutWidget","aboutWidget");e.showWidget(t)}}),e.rootModel.appendToMenu("Help",{label:"Help",icon:Bi.A,onClick:e=>{const t=e.addWidget("HelpWidget","helpWidget");e.showWidget(t)}}))}}const Ui=(0,i.S7)("SPARQLAdapter",{endpoint:{type:"fileLocation",defaultValue:{uri:"https://somesite.com/sparql",locationType:"UriLocation"},description:"URL of the SPARQL endpoint"},queryTemplate:{type:"text",defaultValue:"",description:"SPARQL query where {start} {end} and {refName} will get replaced for each call"},refNamesQueryTemplate:{type:"text",defaultValue:"",description:"SPARQL query that returns the possible refNames in a ?refName column"},refNames:{type:"stringArray",defaultValue:[],description:'Possible refNames used by the SPARQL endpoint (ignored if "refNamesQueryTemplate" is provided)'},additionalQueryParams:{type:"stringArray",defaultValue:[],description:'Additional parameters to add to the query, e.g. "format=JSON"'}},{explicitlyTyped:!0});class qi extends r.A{name="RdfPlugin";install(e){!function(e){e.addAdapterType(()=>new b.A({name:"SPARQLAdapter",displayName:"SPARQL adapter",configSchema:Ui,adapterMetadata:{category:"Uncommon"},getAdapterClass:()=>n.e(8559).then(n.bind(n,88559)).then(e=>e.default)}))}(e),e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a="SPARQLAdapter",o=(0,C.getFileName)(t);return/\/sparql$/i.test(o)||r===a?{type:a,endpoint:t}:e(t,n,r)})}}const Ji=(0,i.S7)("BgzipFastaAdapter",{fastaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz",locationType:"UriLocation"}},faiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz.fai",locationType:"UriLocation"}},metadataLocation:{description:"Optional metadata file",type:"fileLocation",defaultValue:{uri:"/path/to/fa.metadata.yaml",locationType:"UriLocation"}},gziLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.gz.gzi",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,fastaLocation:{uri:e.uri,baseUri:e.baseUri},faiLocation:{uri:`${e.uri}.fai`,baseUri:e.baseUri},gziLocation:{uri:`${e.uri}.gzi`,baseUri:e.baseUri}}:e}),Xi=(0,i.S7)("ChromSizesAdapter",{chromSizesLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/species.chrom.sizes",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,chromSizesLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),Ki=(0,i.S7)("DivSequenceRenderer",{height:{type:"number",description:"height in pixels of each line of sequence",defaultValue:16}},{explicitlyTyped:!0});class Qi extends Lt.default{supportsSVG=!0;getExpandedRegion(e){return(0,ft.T)(e,3)}}const Yi=(0,i.S7)("IndexedFastaAdapter",{fastaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa",locationType:"UriLocation"}},faiLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa.fai",locationType:"UriLocation"}},metadataLocation:{description:"Optional metadata file",type:"fileLocation",defaultValue:{uri:"/path/to/fa.metadata.yaml",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,fastaLocation:{uri:e.uri,baseUri:e.baseUri},faiLocation:{uri:`${e.uri}.fai`,baseUri:e.baseUri}}:e}),Zi=(0,i.S7)("LinearReferenceSequenceDisplay",{renderer:Ki},{explicitIdentifier:"displayId",explicitlyTyped:!0});function es({features:e}){return e.map(e=>{const t=e.get("refName"),n=Math.floor(e.get("start")),r=Math.floor(e.get("end")),a=e.get("seq")??"";return`>${t}:${n+1}-${r}\n${a.match(/.{1,80}/g)?.join("\n")??""}`}).join("\n")}const ts=(0,i.S7)("SequenceSearchAdapter",{search:{type:"string",defaultValue:"",description:"Search string or regex to search for"},sequenceAdapter:{type:"frozen",defaultValue:null},searchForward:{type:"boolean",defaultValue:!0},searchReverse:{type:"boolean",defaultValue:!0},caseInsensitive:{type:"boolean",defaultValue:!0}},{explicitlyTyped:!0}),ns=(0,i.S7)("TwoBitAdapter",{twoBitLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.2bit",locationType:"UriLocation"}},chromSizesLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/default.chrom.sizes",locationType:"UriLocation"},description:"An optional chrom.sizes file can be supplied to speed up loading since parsing the twobit file can take time"}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,twoBitLocation:{uri:e.uri,baseUri:e.baseUri},...e.chromSizes?{chromSizesLocation:{uri:e.chromSizes,baseUri:e.baseUri}}:{}}:e}),rs=(0,i.S7)("UnindexedFastaAdapter",{rewriteRefNames:{type:"string",defaultValue:"",contextVariable:["refName"]},fastaLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/seq.fa",locationType:"UriLocation"}},metadataLocation:{description:"Optional metadata file",type:"fileLocation",defaultValue:{uri:"/path/to/fa.metadata.yaml",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,fastaLocation:{uri:e.uri,baseUri:e.baseUri}}:e});class as extends r.A{name="SequencePlugin";install(e){!function(e){e.addRendererType(()=>new Qi({name:"DivSequenceRenderer",ReactComponent:(0,a.lazy)(()=>n.e(3348).then(n.bind(n,33348))),configSchema:Ki,pluginManager:e}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"TwoBitAdapter",displayName:"TwoBit adapter",configSchema:ns,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(7458).then(n.bind(n,77458)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"BgzipFastaAdapter",displayName:"Bgzip-indexed FASTA adapter",configSchema:Ji,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(9752).then(n.bind(n,99752)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"ChromSizesAdapter",displayName:"Chrom sizes adapter",configSchema:Xi,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(9836).then(n.bind(n,49836)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"IndexedFastaAdapter",displayName:"Indexed FASTA adapter",configSchema:Yi,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(456).then(n.bind(n,80456)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"UnindexedFastaAdapter",displayName:"Unindexed FASTA adapter",configSchema:rs,adapterMetadata:{hiddenFromGUI:!0},getAdapterClass:()=>n.e(1916).then(n.bind(n,31916)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"SequenceSearchAdapter",displayName:"Sequence search adapter",adapterMetadata:{hiddenFromGUI:!0},configSchema:ts,getAdapterClass:()=>n.e(9348).then(n.bind(n,19348)).then(e=>e.default)}))}(e),function(e){e.addTrackType(()=>{const t=function(e){return(0,i.S7)("ReferenceSequenceTrack",{adapter:e.pluggableConfigSchemaType("adapter"),displays:c.types.array(e.pluggableConfigSchemaType("display")),name:{type:"string",description:'optional track name, otherwise uses the "Reference sequence (assemblyName)"',defaultValue:""},sequenceType:{type:"string",description:"either dna or pep",defaultValue:"dna"},description:{description:"a description of the track",type:"string",defaultValue:""},metadata:{type:"frozen",description:"anything to add about this track",defaultValue:{}},formatAbout:(0,i.S7)("FormatAbout",{config:{type:"frozen",description:"formats configuration in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}})},{preProcessSnapshot:t=>{const n=JSON.parse(JSON.stringify(t)),r=new Set,{displays:a=[]}=n;if("placeholderId"!==n.trackId){for(const e of a)e&&r.add(e.type);const t=e.getTrackType(n.type);for(const e of t?.displayTypes||[])r.has(e.name)||a.push({displayId:`${n.trackId}-${e.name}`,type:e.name})}return{...n,displays:a}},explicitIdentifier:"trackId",explicitlyTyped:!0,actions:e=>({addDisplayConf(t){const{type:n}=t;if(!n)throw new Error(`unknown display type ${n}`);const r=e.displays.find(e=>e?.displayId===t.displayId);if(r)return r;const a=e.displays.push(t);return e.displays[a-1]}})})}(e);return new p.A({name:"ReferenceSequenceTrack",displayName:"Reference sequence track",configSchema:t,stateModel:(0,h.E)(e,"ReferenceSequenceTrack",t).views(()=>({saveTrackFileFormatOptions:()=>({fasta:{name:"FASTA",extension:"fa",callback:es}})}))})})}(e),function(e){e.addDisplayType(()=>{const e=function(e){return c.types.compose("LinearReferenceSequenceDisplay",J.L,c.types.model({type:c.types.literal("LinearReferenceSequenceDisplay"),configuration:(0,i.AK)(e),showForward:!0,showReverse:!0,showTranslation:!0})).volatile(()=>({rowHeight:15})).views(e=>({get sequenceType(){return(0,R.FI)((0,x.getContainingTrack)(e),"sequenceType")},get showForwardActual(){return e.showForward},get showReverseActual(){return"dna"===this.sequenceType&&e.showReverse},get showTranslationActual(){return"dna"===this.sequenceType&&e.showTranslation}})).views(e=>({get sequenceHeight(){const{rowHeight:t,showTranslationActual:n,showReverseActual:r,showForwardActual:a}=e;return(r&&n?3*t:0)+(a&&n?3*t:0)+(r?t:0)+(a?t:0)}})).views(e=>{const{renderProps:t}=e;return{renderProps(){const{rpcDriverName:n,showForwardActual:r,showReverseActual:a,showTranslationActual:o,rowHeight:i,sequenceHeight:s,sequenceType:l}=e;return{...t(),...(0,C.getParentRenderProps)(e),config:e.configuration.renderer,rpcDriverName:n,showForward:r,showReverse:a,showTranslation:o,sequenceType:l,rowHeight:i,sequenceHeight:s}}}}).views(e=>({regionCannotBeRendered:()=>(0,x.getContainingView)(e).bpPerPx>3?"Zoom in to see sequence":void 0,get rendererTypeName(){return e.configuration.renderer.type}})).actions(e=>({toggleShowForward(){e.showForward=!e.showForward},toggleShowReverse(){e.showReverse=!e.showReverse},toggleShowTranslation(){e.showTranslation=!e.showTranslation},afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(function(){(0,x.getContainingView)(e).bpPerPx>3?e.setHeight(50):e.setHeight(e.sequenceHeight)},{name:"SequenceHeight"}))}})).views(e=>({trackMenuItems:()=>[..."dna"===e.sequenceType?[{label:"Show forward",type:"checkbox",checked:e.showForward,onClick:()=>{e.toggleShowForward()}},{label:"Show reverse",type:"checkbox",checked:e.showReverse,onClick:()=>{e.toggleShowReverse()}},{label:"Show translation",type:"checkbox",checked:e.showTranslation,onClick:()=>{e.toggleShowTranslation()}}]:[]]})).postProcessSnapshot(e=>{if(!e)return e;const{showForward:t,showReverse:n,showTranslation:r,...a}=e;return{...a,...t?{}:{showForward:t},...n?{}:{showReverse:n},...r?{}:{showTranslation:r}}})}(Zi);return new P.A({name:"LinearReferenceSequenceDisplay",configSchema:Zi,stateModel:e,displayName:"Reference sequence display",trackType:"ReferenceSequenceTrack",viewType:"LinearGenomeView",ReactComponent:z.Ay})})}(e),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a="TwoBitAdapter",o=(0,C.getFileName)(t),i={type:a,twoBitLocation:t};return/\.2bit$/i.test(o)&&!r||r===a?i:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"TwoBitAdapter"===t?"ReferenceSequenceTrack":e(t)),e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a="IndexedFastaAdapter",o=(0,C.getFileName)(t),i={type:a,fastaLocation:t,faiLocation:n||(0,C.makeIndex)(t,".fai")};return/\.(fa|fasta|fas|fna|mfa)$/i.test(o)&&!r||r===a?i:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"IndexedFastaAdapter"===t?"ReferenceSequenceTrack":e(t)),e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a="BgzipFastaAdapter",o=(0,C.getFileName)(t),i={type:a,faiLocation:(0,C.makeIndex)(t,".fai"),gziLocation:(0,C.makeIndex)(t,".gzi")};return/\.(fa|fasta|fas|fna|mfa)\.b?gz$/i.test(o)&&!r||r===a?i:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>"BgzipFastaAdapter"===t?"ReferenceSequenceTrack":e(t))}(e)}}var os=n(91790),is=n(33624);const ss=["VCF","BED","BEDPE","STAR-Fusion"],ls={VCF:()=>Promise.all([n.e(3750),n.e(6372)]).then(n.bind(n,76372)).then(e=>e.parseVcfBuffer),BED:()=>n.e(4096).then(n.bind(n,34096)).then(e=>e.parseBedBuffer),BEDPE:()=>n.e(6603).then(n.bind(n,16603)).then(e=>e.parseBedPEBuffer),"STAR-Fusion":()=>n.e(1657).then(n.bind(n,61657)).then(e=>e.parseSTARFusionBuffer)},cs={VcfAdapter:{fileType:"VCF",locationKey:"vcfLocation"},VcfTabixAdapter:{fileType:"VCF",locationKey:"vcfGzLocation"},BedAdapter:{fileType:"BED",locationKey:"bedLocation"},BedTabixAdapter:{fileType:"BED",locationKey:"bedGzLocation"},BedpeAdapter:{fileType:"BEDPE",locationKey:"bedpeLocation"}},ds=new RegExp(String.raw`\.(${ss.join("|")})(\.gz)?$`,"i");var us=n(16750);function ps({assemblyName:e,session:t,locString:n,spreadsheetViewId:r}){const a=`${r}_${e}`;let o=t.views.find(e=>e.id===a);return o||(o=t.addView("LinearGenomeView",{id:a})),o.navToLocString(n,e)}var hs=n(36533);const gs=(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(8503),n.e(4063)]).then(n.bind(n,42896)));function ms(e){const t=(0,Ut.c)(16),{assemblyName:n,session:r,spreadsheetViewId:a,feature:o}=e;let i,s,l,c,d;return t[0]!==n||t[1]!==o||t[2]!==r||t[3]!==a?(i={label:"Open in linear genome view",onClick:async()=>{try{await ps({spreadsheetViewId:a,assemblyName:n,session:r,locString:(0,x.assembleLocStringFast)(o)})}catch(e){const t=e;console.error(t),r.notifyError(`${t}`,t)}}},t[0]=n,t[1]=o,t[2]=r,t[3]=a,t[4]=i):i=t[4],t[5]!==n||t[6]!==o||t[7]!==r||t[8]!==a?(s={label:"Open in breakpoint split view",onClick:()=>{r.queueDialog(e=>[gs,{handleClose:e,session:r,stableViewId:`${a}_${n}_breakpointsplitview`,feature:new q.A(o),assemblyName:n}])}},t[5]=n,t[6]=o,t[7]=r,t[8]=a,t[9]=s):s=t[9],t[10]!==i||t[11]!==s?(l=[i,s],t[10]=i,t[11]=s,t[12]=l):l=t[12],t[13]===Symbol.for("react.memo_cache_sentinel")?(c=(0,te.jsx)(hs.A,{}),t[13]=c):c=t[13],t[14]!==l?(d=(0,te.jsx)(Io.A,{menuItems:l,children:c}),t[14]=l,t[15]=d):d=t[15],d}function fs(e){const t=(0,Ut.c)(20),{model:n,feature:r}=e;let a,o,i,s,l,d,u;return t[0]!==n?(a=(0,x.getSession)(n),t[0]=n,t[1]=a):a=t[1],t[2]!==n?(o=(0,c.getParent)(n),t[2]=n,t[3]=o):o=t[3],t[4]!==r||t[5]!==n.assemblyName||t[6]!==a||t[7]!==o.id?(i=(0,te.jsx)(ms,{session:a,spreadsheetViewId:o.id,assemblyName:n.assemblyName,feature:r}),t[4]=r,t[5]=n.assemblyName,t[6]=a,t[7]=o.id,t[8]=i):i=t[8],t[9]!==r||t[10]!==n?(s=async e=>{try{e.preventDefault(),await ps({spreadsheetViewId:(0,c.getParent)(n).id,session:(0,x.getSession)(n),locString:(0,x.assembleLocString)(r),assemblyName:n.assemblyName})}catch(e){const t=e;console.error(t),(0,x.getSession)(n).notifyError(`${t}`,t)}},t[9]=r,t[10]=n,t[11]=s):s=t[11],t[12]!==r?(l=(0,x.assembleLocString)(r),t[12]=r,t[13]=l):l=t[13],t[14]!==s||t[15]!==l?(d=(0,te.jsx)(us.A,{href:"#",onClick:s,children:l}),t[14]=s,t[15]=l,t[16]=d):d=t[16],t[17]!==i||t[18]!==d?(u=(0,te.jsxs)(te.Fragment,{children:[i,d]}),t[17]=i,t[18]=d,t[19]=u):u=t[19],u}function ys(){const e=c.types.model("SpreadsheetImportWizard",{fileType:c.types.optional(c.types.enumeration(ss),"VCF"),hasColumnNameLine:!0,columnNameLineNumber:1,selectedAssemblyName:c.types.maybe(c.types.string),cachedFileLocation:c.types.frozen()}).volatile(()=>({fileTypes:ss,fileSource:void 0,error:void 0,loading:!1})).views(e=>({get isReadyToOpen(){return e.fileSource&&(e.fileSource.blobId||e.fileSource.localPath||e.fileSource.uri)},get fileName(){return e.fileSource.uri||e.fileSource.localPath||e.fileSource.blobId&&e.fileSource.name},get requiresUnzip(){return this.fileName.endsWith("gz")},isValidRefName(t,n){const{assemblyManager:r}=(0,x.getSession)(e);return!!n&&r.isValidRefName(t,n)},tracksForAssembly(t){const n=(0,x.getSession)(e),{tracks:r,sessionTracks:a=[]}=n;return[...r,...a].flatMap(e=>{const r=(0,R.QZ)(e,"assemblyNames")??[];if(!r.includes(t))return[];const a=function(e){const t=cs[e.type];if(!t)return;const n=e[t.locationKey]??e;return{fileType:t.fileType,loc:n}}((0,R.QZ)(e,"adapter"));if(!a)return[];const o=((0,R.QZ)(e,"category")??[]).join(",");return{track:e,label:[o?`[${o}]`:"",(0,C.getTrackName)(e,n)].filter(e=>!!e).join(" "),assemblyNames:r,type:a.fileType,loc:a.loc}}).sort((e,t)=>e.label.localeCompare(t.label))}})).actions(e=>({setSelectedAssemblyName(t){e.selectedAssemblyName=t},setFileSource(t){if(e.fileSource=t,e.error=void 0,e.fileSource){const t=e.fileName;if(t){const n=ds.exec(t)?.[1];n&&(e.fileType="tsv"===n&&t.includes("star-fusion")?"STAR-Fusion":n.toUpperCase())}}},setColumnNameLineNumber(t){t>0&&(e.columnNameLineNumber=t)},setFileType(t){e.fileType=t},setError(t){e.error=t},setLoading(t){e.loading=t},cancelButton(){e.error=void 0,(0,c.getParent)(e).setDisplayMode()},setCachedFileHandle(t){e.cachedFileLocation=t}})).actions(e=>({async import(t){if(!e.fileSource)return;e.selectedAssemblyName=t;const r=e.fileType,a=await ls[r](),{fetchAndMaybeUnzip:o}=await Promise.resolve().then(n.bind(n,77251)),{pluginManager:i}=(0,x.getEnv)(e),s=(0,is.openLocation)(e.fileSource,i);e.setLoading(!0);try{if((await s.stat()).size>1e8)return void e.setError(`File is too big. Tabular files are limited to at most ${1e5.toLocaleString()}kb.`)}catch(e){console.warn(e)}finally{e.setLoading(!1)}e.setLoading(!0);try{e.fileSource.uri&&e.setCachedFileHandle({uri:e.fileSource.uri,baseUri:e.fileSource.baseUri,locationType:"UriLocation"});const n=await o(s);(0,c.getParent)(e).displaySpreadsheet({...a(n),assemblyName:t})}catch(t){console.error(t),e.setError(t)}finally{e.setLoading(!1)}}})).actions(e=>({afterAttach(){(async()=>{try{e.cachedFileLocation&&e.selectedAssemblyName&&(e.setFileSource(e.cachedFileLocation),await e.import(e.selectedAssemblyName))}catch(t){console.error(t),(0,x.getSession)(e).notifyError(`${t}`,t)}})()}}));return c.types.compose(Hn.A,c.types.model("SpreadsheetView",{type:c.types.literal("SpreadsheetView"),offsetPx:0,height:c.types.optional(c.types.number,440),hideVerticalResizeHandle:!1,hideFilterControls:!1,importWizard:c.types.optional(e,()=>e.create()),spreadsheet:c.types.maybe(c.types.model("Spreadsheet",{rowSet:c.types.frozen(),columns:c.types.frozen(),assemblyName:c.types.maybe(c.types.string),visibleColumns:c.types.frozen()}).volatile(()=>({visibleRowFlags:void 0})).views(e=>({get rows(){return e.rowSet?.rows.map((t,n)=>({id:n,feature:t.feature,...Object.fromEntries(e.columns.map((e,n)=>[e.name,t.cellData?.[e.name]??t.cells?.[n]?.text]))}))},get initialized(){const t=(0,x.getSession)(e),n=e.assemblyName;return e.rowSet&&!!n&&t.assemblyManager.get(n)?.initialized}})).views(e=>({get dataGridColumns(){const{rows:t}=e;return t?[{field:"Location",width:(0,x.measureGridWidth)(t.map(e=>e.feature?(0,x.assembleLocStringFast)(e.feature):0))+40,renderCell:({row:t})=>{const{feature:n}=t;return n?(0,te.jsx)(fs,{model:e,feature:n}):"N/A"}},{field:"Length",type:"number",width:(0,x.measureGridWidth)(t.map(e=>{const{feature:t}=e;return t?t.end-t.start:0})),valueGetter:(e,t)=>{const{feature:n}=t;return n?n.end-n.start:void 0},valueFormatter:e=>(0,x.toLocale)(e)},...e.columns.map(e=>({field:e.name,width:(0,x.measureGridWidth)([...t.map(t=>t[e.name]),e.name],{minWidth:20}),type:"number"==typeof t[0][e.name]?"number":void 0}))]:void 0}})).views(e=>({get visibleRows(){const{visibleRowFlags:t}=e;return t?e.rows?.filter((e,n)=>!1!==t[n]):e.rows}})).actions(e=>({setVisibleRows(t){e.visibleRowFlags=t},setVisibleColumns(t){e.visibleColumns=t}})).preProcessSnapshot(e=>e?{...e,columns:e.columns.filter(e=>!e.isDerived),rowSet:e.rowSet?{...e.rowSet,rows:e.rowSet.rows.map(e=>({...e,feature:e.feature??e.extendedData?.vcfFeature}))}:void 0}:e)),init:c.types.frozen()}).volatile(()=>({width:400,rowMenuItems:[]})).views(e=>({get assembly(){const t=e.spreadsheet?.assemblyName;return t?(0,x.getSession)(e).assemblyManager.get(t)?.configuration:void 0}})).actions(e=>({setRowMenuItems(t){e.rowMenuItems=t},setWidth:t=>(e.width=t,e.width),setHeight:t=>(e.height=Math.max(t,40),e.height),resizeHeight(t){const n=e.height;return this.setHeight(e.height+t)-n},resizeWidth(t){const n=e.width;return this.setWidth(e.width+t)-n},displaySpreadsheet(t){e.spreadsheet=(0,c.cast)(t)},setInit(t){e.init=t}})).actions(e=>({afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(async function(){const{init:t,width:n}=e;if(!n||!t)return;const r=(0,x.getSession)(e);try{const n=t.uri.split(".");let r=n.pop()?.toUpperCase();"GZ"===r&&(r=n.pop()?.toUpperCase()),e.importWizard.setFileType(t.fileType||r||""),e.importWizard.setSelectedAssemblyName(t.assembly),e.importWizard.setFileSource({uri:t.uri,locationType:"UriLocation"}),await e.importWizard.import(t.assembly)}catch(e){console.error(e),r.notifyError(`${e}`,e)}finally{e.setInit(void 0)}},{name:"SpreadsheetViewInit"}))}})).views(e=>({menuItems:()=>[{label:"Return to import form",icon:oa.A,onClick:()=>{e.displaySpreadsheet(void 0)}}]}))).postProcessSnapshot(e=>{const{init:t,importWizard:n,spreadsheet:r,...a}=e;if(n.cachedFileLocation&&r){const{rowSet:e,...t}=r;return{...a,importWizard:n,spreadsheet:t}}if(r){const{rowSet:e,...t}=r;return e&&JSON.stringify(e).length>1e6?{...a,importWizard:n,spreadsheet:t}:{...a,importWizard:n,spreadsheet:r}}return{...a,importWizard:n}})}class bs extends r.A{name="SpreadsheetViewPlugin";install(e){!function(e){e.addViewType(()=>new jn.A({name:"SpreadsheetView",displayName:"Spreadsheet view",stateModel:ys(),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(2e3)]).then(n.bind(n,96688)))}))}(e),function(e){e.addToExtensionPoint("LaunchView-SpreadsheetView",async({session:e,assembly:t,uri:n,fileType:r})=>{e.addView("SpreadsheetView",{init:{assembly:t,uri:n,fileType:r}})})}(e)}configure(e){const{rootModel:t}=e;(0,U.Nh)(t)&&t.appendToSubMenu(["Add"],{label:"Spreadsheet view",icon:os.A,onClick:e=>{e.addView("SpreadsheetView",{})}})}}var ws=n(17881);const vs=(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(8503),n.e(2769)]).then(n.bind(n,31332)));function Ss(e,t){const n=(0,x.getSession)(t);try{n.setSelection(e);const r=(0,x.getContainingView)(t),a=`${(0,c.getParent)(r).id}_spawned`,o=r.assemblyNames[0];n.queueDialog(t=>[vs,{handleClose:t,session:n,feature:e,stableViewId:a,assemblyName:o}])}catch(e){console.error(e),n.notifyError(`${e}`,e)}}class ks extends r.A{name="SvInspectorViewPlugin";install(e){!function(e){e.jexl.addFunction("defaultOnChordClick",Ss),e.addViewType(()=>{const t=function(e){const t=e.getViewType("SpreadsheetView"),n=e.getViewType("CircularView"),r=t.stateModel,a=n.stateModel;return c.types.compose("SvInspectorView",Hn.A,c.types.model({id:Fn.K,type:c.types.literal("SvInspectorView"),height:c.types.optional(c.types.number,550),onlyDisplayRelevantRegionsInCircularView:!1,spreadsheetView:c.types.optional(r,()=>r.create({type:"SpreadsheetView",hideVerticalResizeHandle:!0})),circularView:c.types.optional(a,()=>a.create({type:"CircularView",hideVerticalResizeHandle:!0,hideTrackSelectorButton:!0,disableImportForm:!0})),init:c.types.frozen()})).volatile(()=>({width:800,SpreadsheetViewReactComponent:t.ReactComponent,CircularViewReactComponent:n.ReactComponent,circularViewOptionsBarHeight:52})).views(e=>({get assemblyName(){const{assembly:t}=e.spreadsheetView;return t?(0,R.QZ)(t,"name"):void 0},get showCircularView(){return!!e.spreadsheetView.spreadsheet?.rowSet},get features(){return structuredClone(e.spreadsheetView.spreadsheet?.visibleRows)?.map(e=>e.feature).filter(e=>!!e)||[]},get featuresAdapterConfigSnapshot(){return{type:"FromConfigAdapter",features:this.features}},get featureRefNames(){return[...new Set([...this.features.map(e=>e.refName),...this.features.flatMap(e=>e.INFO?.CHR2),...this.features.flatMap(e=>e.mate?.refName)].filter(e=>!!e))]},get currentAssembly(){const{assemblyManager:t}=(0,x.getSession)(e);return this.assemblyName?t.get(this.assemblyName):void 0},get canonicalFeatureRefNameSet(){const e=this.currentAssembly;return new Set(e?.initialized?this.featureRefNames.map(t=>e.getCanonicalRefName(t)||t):[])},get featuresCircularTrackConfiguration(){return{type:"VariantTrack",trackId:`sv-inspector-variant-track-${e.id}`,name:"features from tabular data",adapter:this.featuresAdapterConfigSnapshot,assemblyNames:[this.assemblyName],displays:[{type:"ChordVariantDisplay",displayId:`sv-inspector-variant-track-chord-display-${e.id}`,onChordClick:"jexl:defaultOnChordClick(feature, track, pluginManager)",renderer:{type:"StructuralVariantChordRenderer"}}]}}})).actions(e=>({setWidth(t){e.width=t},setHeight:t=>(e.height=Math.max(t,400),e.height),setDisplayedRegions(t){e.circularView.setDisplayedRegions(t)},setOnlyDisplayRelevantRegionsInCircularView(t){e.onlyDisplayRelevantRegionsInCircularView=t},setInit(t){e.init=t}})).views(e=>({menuItems:()=>[{label:"Return to import form",icon:oa.A,onClick:()=>{e.spreadsheetView.displaySpreadsheet(void 0)}}]})).actions(e=>({resizeHeight(t){const n=e.height;return e.setHeight(e.height+t)-n},afterAttach(){(0,c.addDisposer)(e,(0,N.autorun)(async function(){const{init:t,width:n}=e;if(!n||!t)return;const r=(0,x.getSession)(e);try{const n=t.uri.split(".");let r=n.pop()?.toUpperCase();"GZ"===r&&(r=n.pop()?.toUpperCase()),e.spreadsheetView.importWizard.setFileType(t.fileType||r||""),e.spreadsheetView.importWizard.setSelectedAssemblyName(t.assembly),e.spreadsheetView.importWizard.setFileSource({uri:t.uri,locationType:"UriLocation"}),await e.spreadsheetView.importWizard.import(t.assembly),e.setInit(void 0)}catch(t){console.error(t),r.notifyError(`${t}`,t),e.setInit(void 0)}},{name:"SvInspectorViewInit"})),(0,c.addDisposer)(e,(0,N.autorun)(()=>{if(e.showCircularView){const t=Math.round(.66*e.width),n=e.width-t;e.spreadsheetView.setWidth(t-1),e.circularView.setWidth(n)}else e.spreadsheetView.setWidth(e.width)},{name:"SvInspectorView width binding"})),(0,c.addDisposer)(e,(0,N.autorun)(()=>{e.spreadsheetView.setHeight(e.height-52),e.circularView.setHeight(e.height-52-52)},{name:"SvInspectorView height binding"})),(0,c.addDisposer)(e,(0,N.autorun)(async()=>{const{onlyDisplayRelevantRegionsInCircularView:t,circularView:n,canonicalFeatureRefNameSet:r,currentAssembly:a}=e;if(n.initialized&&a?.regions)if(t){if(1===n.tracks.length)try{n.setDisplayedRegions(structuredClone(a.regions.filter(e=>r.has(e.refName))))}catch(t){console.error(t),(0,x.getSession)(e).notifyError(`${t}`,t)}}else n.setDisplayedRegions(a.regions)},{name:"SvInspectorView displayed regions bind"})),(0,c.addDisposer)(e,(0,N.reaction)(()=>({generatedTrackConf:e.featuresCircularTrackConfiguration,assemblyName:e.assemblyName}),t=>{if(!t)return;const{assemblyName:n,generatedTrackConf:r}=t,{circularView:a}=e;for(const e of a.tracks)a.hideTrack(e.configuration.trackId);n&&a.addTrackConf(r,{assemblyName:n})},{name:"SvInspectorView track configuration binding",fireImmediately:!0}))}})).postProcessSnapshot(e=>{const{init:t,circularView:n,...r}=e;return r})}(e);return new jn.A({name:"SvInspectorView",displayName:"SV inspector",stateModel:t,ReactComponent:(0,a.lazy)(()=>n.e(633).then(n.bind(n,50633)))})})}(e),function(e){e.addToExtensionPoint("LaunchView-SvInspectorView",async({session:e,assembly:t,uri:n,fileType:r})=>{e.addView("SvInspectorView",{init:{assembly:t,uri:n,fileType:r}})})}(e)}configure(e){(0,U.Nh)(e.rootModel)&&e.rootModel.appendToSubMenu(["Add"],{label:"SV inspector",icon:ws.A,onClick:e=>{e.addView("SvInspectorView",{})}})}}const xs=(0,i.S7)("TrixTextSearchAdapter",{ixFilePath:{type:"fileLocation",defaultValue:{uri:"out.ix",locationType:"UriLocation"}},ixxFilePath:{type:"fileLocation",defaultValue:{uri:"out.ixx",locationType:"UriLocation"}},metaFilePath:{type:"fileLocation",defaultValue:{uri:"meta.json",locationType:"UriLocation"}},tracks:{type:"stringArray",defaultValue:[],description:"List of tracks covered by text search adapter"},assemblyNames:{type:"stringArray",defaultValue:[],description:"List of assemblies covered by text search adapter"}},{explicitlyTyped:!0,explicitIdentifier:"textSearchAdapterId",preProcessSnapshot:e=>e.uri?{...e,ixFilePath:{uri:e.uri,baseUri:e.baseUri},ixxFilePath:{uri:`${e.uri}x`,baseUri:e.baseUri}}:e});class Cs extends r.A{name="TrixPlugin";install(e){e.addTextSearchAdapterType(()=>new ai.A({name:"TrixTextSearchAdapter",displayName:"Trix text search adapter",configSchema:xs,description:"Trix text search adapter",getAdapterClass:()=>n.e(9731).then(n.bind(n,42112)).then(e=>e.default)}))}}var Ts=n(38452);const As=e=>c.types.compose("ChordVariantDisplay",L.q,c.types.model({type:c.types.literal("ChordVariantDisplay"),bezierRadiusRatio:.1,assemblyName:c.types.maybe(c.types.string),configuration:(0,i.AK)(e)})).volatile(()=>({filled:!1,reactElement:void 0,data:void 0,html:void 0,message:"",renderingComponent:void 0,refNameMap:void 0})).actions(e=>{const{pluginManager:t}=(0,x.getEnv)(e),n=e;return{onChordClick(r){(0,R.FI)(e,"onChordClick",{feature:r,track:n,pluginManager:t})}}}).views(e=>({get blockDefinitions(){const t=(0,x.getContainingView)(e).staticSlices;if(!e.refNameMap)return t;const n=structuredClone(t);for(const t of n){const n=t.region.elided?t.region.regions:[t.region];for(const t of n){const n=e.refNameMap[t.refName];n&&t.refName!==n&&(t.refName=n)}}return n},get rendererTypeName(){return e.configuration.renderer.type},get rendererType(){return(0,x.getEnv)(e).pluginManager.getRendererType(this.rendererTypeName)},get selectedFeatureId(){if(!(0,c.isAlive)(e))return;const{selection:t}=(0,x.getSession)(e);return(0,q.l)(t)?t.id():void 0},renderProps(){const t=(0,x.getContainingView)(e);return{...(0,C.getParentRenderProps)(e),rpcDriverName:e.rpcDriverName,bezierRadius:t.radiusPx*e.bezierRadiusRatio,radius:t.radiusPx,blockDefinitions:this.blockDefinitions,config:e.configuration.renderer,onChordClick:e.onChordClick}},renderingProps:()=>({displayModel:e,onChordClick:t=>{e.onChordClick(t)}})})).actions(e=>({renderStarted(){e.filled=!1,e.message="",e.reactElement=void 0,e.data=void 0,e.html=void 0,e.error=void 0,e.renderingComponent=void 0},renderSuccess({message:t,data:n,reactElement:r,html:a,renderingComponent:o}){t?(e.filled=!1,e.message=t,e.reactElement=void 0,e.data=void 0,e.html=void 0,e.error=void 0,e.renderingComponent=void 0):(e.filled=!0,e.message="",e.reactElement=r,e.data=n,e.html=a,e.error=void 0,e.renderingComponent=o)},renderError(t){console.error(t),e.filled=!1,e.message="",e.reactElement=void 0,e.html=void 0,e.data=void 0,e.error=t,e.renderingComponent=void 0},setRefNameMap(t){e.refNameMap=t}})).actions(e=>({afterAttach(){(0,Ha.I)(e,Ts.I,Ts.$,{name:`${e.type} ${e.id} rendering`,fireImmediately:!0},e.renderStarted,e.renderSuccess,e.renderError),(0,Ha.I)(e,()=>({assemblyNames:(0,C.getTrackAssemblyNames)(e.parentTrack),adapter:(0,R.FI)((0,c.getParent)(e,2),"adapter"),assemblyManager:(0,x.getSession)(e).assemblyManager}),async(t,n)=>t?t.assemblyManager.getRefNameMapForAdapter(t.adapter,t.assemblyNames[0],{stopToken:n,sessionId:(0,C.getRpcSessionId)(e)}):void 0,{name:`${e.type} ${e.id} getting refNames`,fireImmediately:!0},()=>{},t=>{t&&e.setRefNameMap(t)},t=>{console.error(t),e.setError(t)})}})).views(e=>({async renderSvg(t){const{renderSvg:r}=await n.e(4827).then(n.bind(n,94827));return r(e,t)}})),Ms=function(e){return(0,i.S7)("LinearFeatureDisplay",{renderer:e.pluggableConfigSchemaType("renderer")},{baseConfiguration:I.A,explicitlyTyped:!0})};var Ps=n(43788);function Is(e){return c.types.compose("LinearVariantDisplay",(0,Ps.A)(e),c.types.model({type:c.types.literal("LinearVariantDisplay"),configuration:(0,i.AK)(e)})).views(()=>({get featureWidgetType(){return{type:"VariantFeatureWidget",id:"variantFeature"}}}))}var Rs=n(36028),Ls=n(29512),Fs=n(74601),Ds=n(32854),Ns=n(27029),Bs=n(26708),Es=n(80921),Vs=n(23628);function zs(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function js(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=_s)):void 0===t&&(t=Hs);for(var n,r,a,o,i,s=new Gs(e),l=[s];n=l.pop();)if((a=t(n.data))&&(i=(a=Array.from(a)).length))for(n.children=a,o=i-1;o>=0;--o)l.push(r=a[o]=new Gs(a[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore($s)}function Hs(e){return e.children}function _s(e){return Array.isArray(e)?e[1]:null}function Os(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function $s(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function Gs(e){this.data=e,this.depth=this.height=0,this.parent=null}function Ws(e,t){return e.parent===t.parent?1:2}function Us(e,t){return e+t.x}function qs(e,t){return Math.max(e,t.y)}Gs.prototype=js.prototype={constructor:Gs,count:function(){return this.eachAfter(zs)},each:function(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this},eachAfter:function(e,t){for(var n,r,a,o=this,i=[o],s=[],l=-1;o=i.pop();)if(s.push(o),n=o.children)for(r=0,a=n.length;r<a;++r)i.push(n[r]);for(;o=s.pop();)e.call(t,o,++l,this);return this},eachBefore:function(e,t){for(var n,r,a=this,o=[a],i=-1;a=o.pop();)if(e.call(t,a,++i,this),n=a.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r},sum:function(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;for(e=n.pop(),t=r.pop();e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r},ancestors:function(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t},copy:function(){return js(this).eachBefore(Os)},[Symbol.iterator]:function*(){var e,t,n,r,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(yield a,t=a.children)for(n=0,r=t.length;n<r;++n)o.push(t[n])}while(o.length)}};const Js=(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(7667),n.e(8501),n.e(4818)]).then(n.bind(n,44818))),Xs=(0,a.lazy)(()=>n.e(1577).then(n.bind(n,71577))),Ks=(0,a.lazy)(()=>n.e(5925).then(n.bind(n,25925))),Qs=(0,a.lazy)(()=>n.e(6667).then(n.bind(n,86667))),Ys=(0,a.lazy)(()=>n.e(8898).then(n.bind(n,38898)));function Zs(e){return c.types.compose("LinearVariantMatrixDisplay",(0,Ls.n)(e),c.types.model({type:c.types.literal("LinearVariantMatrixDisplay"),layout:c.types.optional(c.types.frozen(),[]),configuration:(0,i.AK)(e),minorAlleleFrequencyFilter:c.types.optional(c.types.number,0),showSidebarLabelsSetting:c.types.optional(c.types.boolean,!0),showTree:c.types.optional(c.types.boolean,!0),renderingMode:c.types.optional(c.types.string,"alleleCount"),rowHeightMode:c.types.optional(c.types.union(c.types.literal("auto"),c.types.number),"auto"),lengthCutoffFilter:c.types.optional(c.types.number,Number.MAX_SAFE_INTEGER),jexlFilters:c.types.maybe(c.types.array(c.types.string)),referenceDrawingMode:c.types.optional(c.types.string,"skip"),clusterTree:c.types.maybe(c.types.string),treeAreaWidth:c.types.optional(c.types.number,80),lineZoneHeight:c.types.optional(c.types.number,0)})).volatile(()=>({sourcesLoadingStopToken:void 0,simplifiedFeaturesStopToken:void 0,featureUnderMouseVolatile:void 0,sourcesVolatile:void 0,featuresVolatile:void 0,hasPhased:!1,sampleInfo:void 0,hoveredGenotype:void 0,hoveredTreeNode:void 0,treeCanvas:void 0,mouseoverCanvas:void 0})).actions(e=>({setJexlFilters(t){e.jexlFilters=(0,c.cast)(t)},setRowHeight(t){e.rowHeightMode=t},setHoveredGenotype(t){e.hoveredGenotype=t},setHoveredTreeNode(t){e.hoveredTreeNode=t},setTreeCanvasRef(t){e.treeCanvas=t||void 0},setMouseoverCanvasRef(t){e.mouseoverCanvas=t||void 0},setTreeAreaWidth(t){e.treeAreaWidth=t},setFeatures(t){e.featuresVolatile=t},setLayout(t,n=!0){const r=n&&e.clusterTree&&e.layout.length===t.length&&e.layout.some((e,n)=>e.name!==t[n]?.name);e.layout=t,r&&(e.clusterTree=void 0)},clearLayout(){e.layout=[],e.clusterTree=void 0},setClusterTree(t){e.clusterTree=t},setSourcesLoading(t){e.sourcesLoadingStopToken&&(0,He.CF)(e.sourcesLoadingStopToken),e.sourcesLoadingStopToken=t},setSimplifiedFeaturesLoading(t){e.simplifiedFeaturesStopToken&&(0,He.CF)(e.simplifiedFeaturesStopToken),e.simplifiedFeaturesStopToken=t},setSources(t){D()(t,e.sourcesVolatile)||(e.sourcesVolatile=t)},setMafFilter(t){e.minorAlleleFrequencyFilter=t},setShowSidebarLabels(t){e.showSidebarLabelsSetting=t},setShowTree(t){e.showTree=t},setPhasedMode(t){e.renderingMode!==t&&(e.layout=[],e.clusterTree=void 0),e.renderingMode=t},setAutoHeight(t){e.rowHeightMode=t?"auto":10},setHasPhased(t){e.hasPhased=t},setSampleInfo(t){D()(t,e.sampleInfo)||(e.sampleInfo=t)},setReferenceDrawingMode(t){e.referenceDrawingMode=t}})).views(e=>({get autoHeight(){return"auto"===e.rowHeightMode},get activeFilters(){return e.jexlFilters??(0,R.FI)(e,"jexlFilters").map(e=>`jexl:${e}`)},get sourcesWithoutLayout(){return e.sourcesVolatile?(0,Vs.X)({sources:e.sourcesVolatile,renderingMode:e.renderingMode,sampleInfo:e.sampleInfo}):void 0},get sources(){return e.sourcesVolatile?(0,Vs.X)({sources:e.sourcesVolatile,layout:e.layout.length?e.layout:void 0,renderingMode:e.renderingMode,sampleInfo:e.sampleInfo}):void 0},get root(){const t=e.clusterTree;if(t)return js((0,Rs.Od)(t),e=>e.children).sum(e=>e.children?0:1).sort((e,t)=>(0,Bs.A)(e.data.height||1,t.data.height||1))}})).views(e=>{const{renderProps:t}=e;return{get sourceMap(){return e.sources?Object.fromEntries(e.sources.map(e=>[e.name,e])):void 0},get availableHeight(){return e.height-e.lineZoneHeight},get nrow(){return e.sources?.length||1},get rowHeight(){return"auto"===e.rowHeightMode?this.availableHeight/this.nrow:e.rowHeightMode},get hierarchy(){const t=e.root;if(!t||!e.sources?.length)return;const n=function(){var e=Ws,t=1,n=1,r=!1;function a(a){var o,i=0;a.eachAfter(function(t){var n=t.children;n?(t.x=function(e){return e.reduce(Us,0)/e.length}(n),t.y=function(e){return 1+e.reduce(qs,0)}(n)):(t.x=o?i+=e(t,o):0,t.y=0,o=t)});var s=function(e){for(var t;t=e.children;)e=t[0];return e}(a),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(a),c=s.x-e(s,l)/2,d=l.x+e(l,s)/2;return a.eachAfter(r?function(e){e.x=(e.x-a.x)*t,e.y=(a.y-e.y)*n}:function(e){e.x=(e.x-c)/(d-c)*t,e.y=(1-(a.y?e.y/a.y:1))*n})}return a.separation=function(t){return arguments.length?(e=t,a):e},a.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],a):r?null:[t,n]},a.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],a):r?[t,n]:null},a}();return n.size([this.rowHeight*this.nrow,e.treeAreaWidth]),n.separation(()=>1),n(t),t},adapterProps:()=>({...t(),config:e.rendererConfig})}}).views(e=>{const{trackMenuItems:t}=e;return{trackMenuItems:()=>[...t(),{label:"Show...",icon:Y.A,type:"subMenu",subMenu:[{label:"Show sidebar labels",type:"checkbox",checked:e.showSidebarLabelsSetting,onClick:()=>{e.setShowSidebarLabels(!e.showSidebarLabelsSetting)}},{label:"Show tree"+(e.clusterTree?"":" (run clustering first)"),type:"checkbox",checked:e.showTree,disabled:!e.clusterTree,onClick:()=>{e.setShowTree(!e.showTree)}},{label:"Show reference alleles",helpText:"When this setting is off, the background is colored solid grey and only ALT alleles are colored on top of it. This makes it easier to see potentially overlapping structural variants",type:"checkbox",checked:"skip"!==e.referenceDrawingMode,onClick:()=>{e.setReferenceDrawingMode("skip"===e.referenceDrawingMode?"draw":"skip")}},{label:"Show legend",type:"checkbox",checked:e.showLegend,onClick:()=>{e.setShowLegend(!e.showLegend)}}]},{label:"Row height",icon:Ds.A,subMenu:[{label:"Manually set row height",disabled:e.autoHeight,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Ys,{model:e,handleClose:t}])}},{label:"Auto-adjust to display height",type:"checkbox",checked:e.autoHeight,onClick:()=>{e.setAutoHeight(!e.autoHeight)}}]},{label:"Rendering mode",icon:Ns.A,subMenu:[{label:"Allele count (dosage)",helpText:"Draws the color darker the more times this allele exists, so homozygous variants are darker than heterozygous. Works on polyploid also",type:"radio",checked:"alleleCount"===e.renderingMode,onClick:()=>{e.setPhasedMode("alleleCount")}},{label:"Phased"+(e.hasPhased?"":e.featuresVolatile?" (disabled, no phased variants found)":" (checking for phased variants...)"),helpText:"Phased mode splits each sample into multiple rows representing each haplotype, and the phasing of the variants is used to color the variant in the individual haplotype rows. For example, a diploid sample SAMPLE1 will generate two rows SAMPLE1-HP0 and SAMPLE1 HP1 and a variant 1|0 will draw a box in the top row but not the bottom row",disabled:!e.hasPhased,checked:"phased"===e.renderingMode,type:"radio",onClick:()=>{e.setPhasedMode("phased")}}]},{label:"Filter by",icon:Ye.A,subMenu:[{label:"Minor allele frequency",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Xs,{model:e,handleClose:t}])}},{label:"Edit filters",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Ks,{model:e,handleClose:t}])}}]},{label:"Cluster by genotype",icon:Fs.A,onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Qs,{model:e,handleClose:t}])}},{label:"Edit group colors/arrangement...",onClick:()=>{(0,x.getSession)(e).queueDialog(t=>[Js,{model:e,handleClose:t}])}}]}}).views(e=>({get canDisplayLabels(){return e.rowHeight>=6&&e.showSidebarLabelsSetting},get totalHeight(){return e.rowHeight*(e.sources?.length||1)},get featuresReady(){return!!e.featuresVolatile},getPortableSettings:()=>({minorAlleleFrequencyFilter:e.minorAlleleFrequencyFilter,showSidebarLabelsSetting:e.showSidebarLabelsSetting,showTree:e.showTree,renderingMode:e.renderingMode,lengthCutoffFilter:e.lengthCutoffFilter,jexlFilters:e.jexlFilters,referenceDrawingMode:e.referenceDrawingMode,clusterTree:e.clusterTree,treeAreaWidth:e.treeAreaWidth,layout:e.layout,height:e.height})})).views(e=>({renderProps(){const t=e.adapterProps();return{...t,notReady:t.notReady||!e.sources||!e.featuresReady,height:e.height,totalHeight:e.totalHeight,renderingMode:e.renderingMode,minorAlleleFrequencyFilter:e.minorAlleleFrequencyFilter,lengthCutoffFilter:e.lengthCutoffFilter,rowHeight:e.rowHeight,sources:e.sources,scrollTop:e.scrollTop,referenceDrawingMode:e.referenceDrawingMode,filters:new W.A({filters:e.activeFilters})}},legendItems(){if("phased"===e.renderingMode){let t=1;const n=e.featuresVolatile;if(n)for(const e of n){const n=e.get("ALT");n&&n.length>t&&(t=n.length)}const r=[{color:Es.Us,label:"Reference"},{color:Et.set1[0],label:"Alt allele 1"}];return t>=2&&r.push({color:Et.set1[1],label:"Alt allele 2"}),t>=3&&r.push({color:Et.set1[2],label:"Alt allele 3"}),r.push({color:Es.lh,label:"Unphased"}),r}return[{color:Es.Us,label:"Homozygous reference"},{color:(0,Es.fb)(.5),label:"Heterozygous alt"},{color:(0,Es.fb)(1),label:"Homozygous alt"},{color:Es.Vg,label:"Other alt allele"},{color:Es.FX,label:"No call"}]}})).actions(e=>({afterAttach(){(async()=>{try{const{setupMultiVariantAutoruns:t}=await n.e(2429).then(n.bind(n,62429));t(e)}catch(t){(0,c.isAlive)(e)&&(console.error(t),(0,x.getSession)(e).notifyError(`${t}`,t))}})()}})).postProcessSnapshot(e=>{if(!e)return e;const{layout:t,minorAlleleFrequencyFilter:n,showSidebarLabelsSetting:r,showTree:a,renderingMode:o,rowHeightMode:i,lengthCutoffFilter:s,jexlFilters:l,referenceDrawingMode:c,clusterTree:d,treeAreaWidth:u,lineZoneHeight:p,...h}=e;return{...h,...t.length?{layout:t}:{},...n?{minorAlleleFrequencyFilter:n}:{},...r?{}:{showSidebarLabelsSetting:r},...a?{}:{showTree:a},..."alleleCount"!==o?{renderingMode:o}:{},..."auto"!==i?{rowHeightMode:i}:{},...s!==Number.MAX_SAFE_INTEGER?{lengthCutoffFilter:s}:{},...l?.length?{jexlFilters:l}:{},..."skip"!==c?{referenceDrawingMode:c}:{},...void 0!==d?{clusterTree:d}:{},...80!==u?{treeAreaWidth:u}:{},...p?{lineZoneHeight:p}:{}}})}const el=function(e){return c.types.compose("MultiLinearVariantDisplay",Zs(e),c.types.model({type:c.types.literal("MultiLinearVariantDisplay")})).views(()=>({get rendererTypeName(){return"MultiVariantRenderer"}})).actions(e=>{const{renderSvg:t}=e;return{async renderSvg(r){const{renderSvg:a}=await n.e(5828).then(n.bind(n,95828));return a(e,r,t)}}})};const tl=(0,i.S7)("LinearVariantMatrixRenderer",{},{explicitlyTyped:!0});function nl(e){return c.types.compose("LinearVariantMatrixDisplay",Zs(e),c.types.model({type:c.types.literal("LinearVariantMatrixDisplay"),lineZoneHeight:c.types.optional(c.types.number,20)})).views(()=>({get blockType(){return"dynamicBlocks"},get prefersOffset(){return!0}})).views(e=>({renderProps(){const t=e.adapterProps();return{...t,notReady:t.notReady||!e.sources||!e.featuresReady,renderingMode:e.renderingMode,minorAlleleFrequencyFilter:e.minorAlleleFrequencyFilter,lengthCutoffFilter:e.lengthCutoffFilter,height:e.autoHeight?e.totalHeight:e.availableHeight,totalHeight:e.totalHeight,rowHeight:e.rowHeight,scrollTop:e.scrollTop,sources:e.sources}}})).actions(e=>({setLineZoneHeight:t=>(e.lineZoneHeight=(0,x.clamp)(t,10,1e3),e.lineZoneHeight)})).actions(e=>{const{renderSvg:t}=e;return{async renderSvg(r){const{renderSvg:a}=await n.e(6897).then(n.bind(n,76897));return a(e,r,t)}}}).postProcessSnapshot(e=>{if(!e)return e;const{lineZoneHeight:t,...n}=e;return{...n,...20!==t?{lineZoneHeight:t}:{}}})}class rl extends Lt.default{supportsSVG=!0;async render(e){const t=await this.getFeatures(e),{height:r,regions:a,bpPerPx:o,scrollTop:i,rowHeight:s}=e,l=a[0],c=(l.end-l.start)/o,{makeImageData:d}=await n.e(7761).then(n.bind(n,27761)),{mafs:u,...p}=await(0,qn.u)(c,r,e,n=>d({ctx:n,canvasWidth:c,canvasHeight:r,renderArgs:{...e,features:t}})),h={...p,simplifiedFeatures:u.map(({feature:e})=>({uniqueId:e.id(),start:e.get("start"),end:e.get("end"),refName:e.get("refName")})),height:r,width:c,origScrollTop:i,rowHeight:s};return(0,yt.lk)(h,(0,bt.X)(p))}}class al extends Lt.default{supportsSVG=!0;async render(e){const t=await this.getFeatures(e),{height:r,referenceDrawingMode:a,regions:o,bpPerPx:i,scrollTop:s}=e,l=o[0],c=(l.end-l.start)/i,{makeImageData:d}=await n.e(4144).then(n.bind(n,84144)),u=await(0,qn.u)(c,r,e,n=>("skip"===a&&(n.fillStyle="#ccc",n.fillRect(0,0,c,r)),d(n,{...e,features:t}))),p={...u,height:r,width:c,origScrollTop:s};return(0,yt.lk)(p,(0,bt.X)(u))}}const ol=(0,i.S7)("MultiVariantRenderer",{},{explicitlyTyped:!0}),il=(0,i.S7)("SplitVcfTabixAdapter",{vcfGzLocationMap:{type:"frozen",defaultValue:{}},indexLocationMap:{type:"frozen",defaultValue:{}},indexType:{type:"string",defaultValue:"TBI"},samplesTsvLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/samples.tsv",description:'tsv with header like "name\tpopulation\tetc" where the first column is required, and corresponds to the sample names in the VCF files',locationType:"UriLocation"}}},{explicitlyTyped:!0});var sl=n(45912);const ll=(0,i.S7)("StructuralVariantChordRenderer",{strokeColor:{type:"color",description:"the line color of each arc",defaultValue:"rgba(255,133,0,0.32)",contextVariable:["feature"]},strokeColorSelected:{type:"color",description:"the line color of an arc that has been selected",defaultValue:"black",contextVariable:["feature"]},strokeColorHover:{type:"color",description:"the line color of an arc that is being hovered over with the mouse",defaultValue:"#555",contextVariable:["feature"]}},{explicitlyTyped:!0}),cl=(0,i.S7)("VariantFeatureWidget",{});function dl(e){const t=(0,l.n)(e);return c.types.compose(t,c.types.model("VariantFeatureWidget",{type:c.types.literal("VariantFeatureWidget"),descriptions:c.types.frozen()}))}class ul extends Fa.A{name="MultiVariantClusterGenotypeMatrix";async execute(e,t){const r=await this.deserializeArguments(e,t),{executeClusterGenotypeMatrix:a}=await Promise.all([n.e(3678),n.e(6736)]).then(n.bind(n,96736));return a({pluginManager:this.pluginManager,args:r})}}var pl=n(21455);class hl extends Fa.A{name="MultiVariantGetGenotypeMatrix";async execute(e,t){return(0,pl.v)({pluginManager:this.pluginManager,args:await this.deserializeArguments(e,t)})}}var gl=n(95067);class ml extends Fa.A{name="MultiVariantGetSimplifiedFeatures";async execute(e,t){const n=await this.deserializeArguments(e,t),{lengthCutoffFilter:r,minorAlleleFrequencyFilter:a,regions:o,adapterConfig:i,stopToken:s,sessionId:l}=n,{dataAdapter:c}=await(0,ot.cK)(this.pluginManager,l,i),d=await(0,it._)(c.getFeaturesInMultipleRegions(o,n).pipe((0,st.$)())),u={},p=new Map;let h=!1;const g=(0,He.jL)(s),m=(0,gl.Cg)({minorAlleleFrequencyFilter:a,lengthCutoffFilter:r,lastCheck:g,features:d,genotypesCache:p});for(const{feature:e}of m){const t=e.id();let n=p.get(t);n||(n=e.get("genotypes"),p.set(t,n));for(const[e,t]of Object.entries(n)){const n=t.includes("|");h||=n;let r=1;if(n)for(const e of t)"|"===e&&r++;const a=u[e];u[e]={maxPloidy:Math.max(a?.maxPloidy??0,r),isPhased:a?.isPhased||n}}(0,He.As)(g)}return{hasPhased:h,sampleInfo:u,features:m.map(({feature:e})=>({id:e.id(),data:{start:e.get("start"),end:e.get("end"),refName:e.get("refName"),name:e.get("name")}}))}}}class fl extends Fa.A{name="MultiVariantGetSources";async execute(e,t){const n=await this.deserializeArguments(e,t),{regions:r,adapterConfig:a,sessionId:o}=n,{dataAdapter:i}=await(0,ot.cK)(this.pluginManager,o,a);return i.getSources(r,n)}}function yl({features:e}){const t=["refName","start","name","REF","ALT","QUAL","FILTER"];return e.map(e=>`${t.map(t=>e.get(t)||".").join("\t")}\t${function(e){return Object.entries(e.get("INFO")).map(([e,t])=>`${e}=${t}`).join(";")}(e)}`).join("\n")}const bl=(0,i.S7)("VcfAdapter",{vcfLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf",locationType:"UriLocation"}},samplesTsvLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/samples.tsv",description:"tsv with header like name\tpopulation\tetc. where the first column is required, and is the sample names",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,vcfLocation:{uri:e.uri,baseUri:e.baseUri}}:e}),wl=(0,i.S7)("VcfTabixAdapter",{vcfGzLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf.gz",locationType:"UriLocation"}},index:(0,i.S7)("VcfIndex",{indexType:{model:c.types.enumeration("IndexType",["TBI","CSI"]),type:"stringEnum",defaultValue:"TBI"},location:{type:"fileLocation",defaultValue:{uri:"/path/to/my.vcf.gz.tbi",locationType:"UriLocation"}}}),samplesTsvLocation:{type:"fileLocation",defaultValue:{uri:"/path/to/samples.tsv",description:"tsv with header like name\tpopulation\tetc. where the first column is required, and is the sample names",locationType:"UriLocation"}}},{explicitlyTyped:!0,preProcessSnapshot:e=>e.uri?{...e,vcfGzLocation:{uri:e.uri,baseUri:e.baseUri},index:{location:{uri:`${e.uri}.tbi`,baseUri:e.baseUri}}}:e});class vl extends r.A{name="VariantsPlugin";install(e){var t;!function(e){e.addAdapterType(()=>new b.A({name:"VcfAdapter",displayName:"VCF adapter",configSchema:bl,adapterCapabilities:["exportData"],getAdapterClass:()=>Promise.all([n.e(3750),n.e(7710),n.e(8938)]).then(n.bind(n,78938)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"VcfTabixAdapter",displayName:"VCF tabix adapter",configSchema:wl,adapterCapabilities:["exportData"],getAdapterClass:()=>Promise.all([n.e(3750),n.e(9272),n.e(3859)]).then(n.bind(n,63859)).then(e=>e.default)}))}(e),function(e){e.addAdapterType(()=>new b.A({name:"SplitVcfTabixAdapter",displayName:"VCF tabix adapter (split across multiple files)",configSchema:il,getAdapterClass:()=>Promise.all([n.e(3750),n.e(9272),n.e(5833)]).then(n.bind(n,85833)).then(e=>e.default)}))}(e),function(e){e.addWidgetType(()=>new o.A({name:"VariantFeatureWidget",heading:"Feature details",configSchema:cl,stateModel:dl(e),ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(9916),n.e(4138),n.e(6961),n.e(3750),n.e(2687),n.e(8507),n.e(8769),n.e(9764),n.e(450)]).then(n.bind(n,20450)))}))}(e),(t=e).addTrackType(()=>{const e=(n=t,(0,i.S7)("VariantTrack",{},{baseConfiguration:(0,g.J)(n)}));var n;return new p.A({name:"VariantTrack",displayName:"Variant track",configSchema:e,stateModel:(0,h.E)(t,"VariantTrack",e).views(()=>({saveTrackFileFormatOptions:()=>({vcf:{name:"VCF",extension:"vcf",callback:yl}})}))})}),function(e){e.addToExtensionPoint("Core-guessAdapterForLocation",e=>(t,n,r)=>{const a=(0,C.getFileName)(t),o=n&&(0,C.getFileName)(n);return(0,x.testAdapter)(a,/\.vcf\.b?gz$/i,r,"VcfTabixAdapter")?{type:"VcfTabixAdapter",vcfGzLocation:t,index:{location:n||(0,C.makeIndex)(t,".tbi"),indexType:(0,C.makeIndexType)(o,"CSI","TBI")}}:(0,x.testAdapter)(a,/\.vcf(\.gz)?$/i,r,"VcfAdapter")?{type:"VcfAdapter",vcfLocation:t}:e(t,n,r)}),e.addToExtensionPoint("Core-guessTrackTypeForLocation",e=>t=>["VcfTabixAdapter","VcfAdapter"].includes(t)?"VariantTrack":e(t))}(e),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearVariantDisplay",{},{baseConfiguration:Ms(e),explicitlyTyped:!0})}(e);return new P.A({name:"LinearVariantDisplay",displayName:"Variant display",configSchema:t,stateModel:Is(t),trackType:"VariantTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>Promise.resolve().then(n.bind(n,93646)).then(e=>({default:e.LinearBasicDisplayComponent})))})})}(e),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("LinearVariantMatrixDisplay",{renderer:tl,height:{type:"number",defaultValue:250}},{baseConfiguration:(0,j.A)(e),explicitlyTyped:!0})}(e);return new P.A({name:"LinearVariantMatrixDisplay",displayName:"Multi-sample variant display (matrix)",helpText:'Draws multi-sample variant using a "matrix" where the visualization does not correspond to actual base pair coordinates, but uses lines to connect the columns of the matrix to their base pair coordinates',configSchema:t,stateModel:nl(t),trackType:"VariantTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>n.e(2174).then(n.bind(n,2174)))})})}(e),function(e){e.addDisplayType(()=>{const t=function(e){const t=e.getRendererType("MultiVariantRenderer").configSchema;return(0,i.S7)("MultiLinearVariantDisplay",{defaultRendering:{type:"stringEnum",model:c.types.enumeration("Rendering",["multivariant"]),defaultValue:"multivariant"},renderers:(0,i.S7)("RenderersConfiguration",{MultiVariantRenderer:t}),height:{type:"number",defaultValue:200}},{baseConfiguration:(0,i.S7)("SharedVariantDisplay",{},{baseConfiguration:I.A,explicitlyTyped:!0}),explicitlyTyped:!0})}(e);return new P.A({name:"MultiLinearVariantDisplay",displayName:"Multi-sample variant display (regular)",helpText:'Draws multi-sample variant data using a row for each sample in your dataset. The term "regular" is unfortunately vague but it just means drawing the variants at their actual base pair coordinates. The "regular" mode is notable for also being able to draw structural variants (SVs), including overlapping SVs. It will specifically skip drawing the "reference" alleles by default, allowing overlapping SVs to not cover each other up',configSchema:t,stateModel:el(t),trackType:"VariantTrack",viewType:"LinearGenomeView",ReactComponent:(0,a.lazy)(()=>n.e(625).then(n.bind(n,90625)))})})}(e),function(e){e.addRendererType(()=>new al({name:"MultiVariantRenderer",ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(9260)]).then(n.bind(n,89260))),configSchema:ol,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new rl({name:"LinearVariantMatrixRenderer",displayName:"Linear variant matrix renderer",ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(8701)]).then(n.bind(n,78701))),configSchema:tl,pluginManager:e}))}(e),function(e){e.addRendererType(()=>new sl.A({name:"StructuralVariantChordRenderer",displayName:"SV chord renderer",ReactComponent:(0,a.lazy)(()=>Promise.all([n.e(3750),n.e(5829)]).then(n.bind(n,45829))),configSchema:ll,pluginManager:e}))}(e),function(e){e.addDisplayType(()=>{const t=function(e){return(0,i.S7)("ChordVariantDisplay",{onChordClick:{type:"boolean",description:"callback that should be run when a chord in the track is clicked",defaultValue:!1,contextVariable:["feature","track","pluginManager"]},renderer:c.types.optional(e.pluggableConfigSchemaType("renderer"),{type:"StructuralVariantChordRenderer"})},{explicitIdentifier:"displayId",explicitlyTyped:!0})}(e),r=As(t);return new P.A({name:"ChordVariantDisplay",displayName:"Chord variant display",configSchema:t,stateModel:r,trackType:"VariantTrack",viewType:"CircularView",ReactComponent:(0,a.lazy)(()=>n.e(593).then(n.bind(n,40593)))})})}(e),e.addRpcMethod(()=>new fl(e)),e.addRpcMethod(()=>new hl(e)),e.addRpcMethod(()=>new ul(e)),e.addRpcMethod(()=>new ml(e))}}var Sl=n(36565);const kl=[na,Ri.Ay,Bt,Cn,Ln,ha,Pa.A,Ia.A,fo,Go,Co,Yo,si,Ii,Ni,Wi,qi,as,vl,Sl.Ay,So,bs,ks,Un,Xo,Cs,Oo,Ma,_t]},97892(e,t,n){function r(e,t){return e.clientX-(t?.getBoundingClientRect().left||0)}function a(e,t){return e?.cytobands?.map(t=>({refName:e.getCanonicalRefName(t.get("refName"))||t.get("refName"),start:t.get("start"),end:t.get("end"),type:t.get("gieStain"),name:t.get("name")})).filter(e=>e.refName===t)||[]}function o(e,t,n){return void 0===e||n&&t>e+30||!n&&t<e-30}n.d(t,{D7:()=>o,Pn:()=>r,S5:()=>a})},98445(e,t,n){n.d(t,{A:()=>k,s:()=>x});var r=n(11259),a=n(77251),o=n(58836),i=n(52901),s=n(70203),l=n(10525),c=n(99226),d=n(42918),u=n(64074),p=n(82947),h=n(30936),g=n(65045),m=n(6432),f=n(51800),y=n(32118);const b=(0,g.n)()({container:{position:"relative",width:"100%",height:"100%",minHeight:20},overlay:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.15)",backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.05) 8px, rgba(0, 0, 0, 0.05) 16px)",pointerEvents:"none",zIndex:1,display:"flex",justifyContent:"center",alignItems:"center",opacity:0},visible:{opacity:1},dots:{fontSize:"0.8rem",fontWeight:300,"&::after":{display:"inline-block",content:'""',width:"1em",textAlign:"left",animation:`${m.i7`
        0% { content: ''; }
        25% { content: '.'; }
        50% { content: '..'; }
        75% { content: '...'; }
      `} 1.2s infinite ease-in-out`}}});function w(e){const t=(0,h.c)(14),{statusMessage:n,children:r}=e,{classes:a}=b(),o=!!n,i=a.container,s=o&&a.visible;let l;t[0]!==a.overlay||t[1]!==s?(l=(0,f.cx)(a.overlay,s),t[0]=a.overlay,t[1]=s,t[2]=l):l=t[2];const c=o?"loading-overlay":void 0,d=n||"Loading";let u,p,g;return t[3]!==a.dots||t[4]!==d?(u=(0,y.jsx)("span",{className:a.dots,children:d}),t[3]=a.dots,t[4]=d,t[5]=u):u=t[5],t[6]!==l||t[7]!==c||t[8]!==u?(p=(0,y.jsx)("span",{className:l,"data-testid":c,children:u}),t[6]=l,t[7]=c,t[8]=u,t[9]=p):p=t[9],t[10]!==r||t[11]!==a.container||t[12]!==p?(g=(0,y.jsxs)("div",{className:i,children:[r,p]}),t[10]=r,t[11]=a.container,t[12]=p,t[13]=g):g=t[13],g}const v=(0,d.lazy)(()=>Promise.all([n.e(9011),n.e(1853)]).then(n.bind(n,91853))),S=(0,u.observer)(function({model:e}){return e.error?(0,y.jsx)(d.Suspense,{fallback:null,children:(0,y.jsx)(v,{model:e})}):e.message?(0,d.isValidElement)(e.message)?e.message:(0,y.jsx)(p.A,{message:`${e.message}`,severity:"info"}):(0,y.jsx)(w,{statusMessage:e.statusMessage,children:e.reactElement})}),k=c.types.model("BlockState",{key:c.types.string,region:c.types.frozen(),reloadFlag:0,isLeftEndOfDisplayedRegion:!1,isRightEndOfDisplayedRegion:!1}).volatile(()=>({stopToken:void 0,filled:!1,reactElement:void 0,features:void 0,layout:void 0,blockStatusMessage:"",error:void 0,message:void 0,maxHeightReached:!1,ReactComponent:S,renderProps:void 0,renderArgs:void 0,isRenderingPending:!0,cachedDisplay:void 0})).actions(e=>{function t(){void 0!==e.stopToken&&((0,i.CF)(e.stopToken),e.stopToken=void 0)}function n(){e.filled=!1,e.reactElement=void 0,e.features=void 0,e.layout=void 0,e.maxHeightReached=!1,e.renderProps=void 0,e.renderArgs=void 0}return{doReload(){e.reloadFlag=e.reloadFlag+1},setStatusMessage(t){e.blockStatusMessage=t},setLoading(n){t(),e.isRenderingPending=!0,e.error=void 0,e.message=void 0,e.stopToken=n},setMessage(r){t(),e.isRenderingPending=!1,e.message=r,e.error=void 0,n()},setRendered(t){if(!t)return;const{reactElement:n,features:r,layout:a,maxHeightReached:o,renderProps:i,renderArgs:s}=t;e.filled=!0,e.isRenderingPending=!1,e.message=void 0,e.reactElement=n,e.features=r,e.layout=a,e.error=void 0,e.maxHeightReached=o,e.renderProps=i,e.renderArgs=s,e.stopToken=void 0},setError(r){console.error(r),t(),e.isRenderingPending=!1,e.message=void 0,e.error=r,n(),(0,l.yH)(r)&&this.reload()},reload(){e.stopToken=void 0,e.isRenderingPending=!1,e.error=void 0,e.message=void 0,e.ReactComponent=S,n(),(0,c.getParent)(e,2).reload()},setCachedDisplay(t){e.cachedDisplay=t},beforeDestroy(){(async()=>{try{if(t(),e.renderArgs&&e.cachedDisplay){const{rpcManager:t}=(0,a.getSession)(e),{rendererType:n}=e.cachedDisplay;await n.freeResourcesInClient(t,JSON.parse(JSON.stringify(e.renderArgs)))}}catch(e){console.error("Error while destroying block",e)}})()}}}).views(e=>({get statusMessage(){return e.isRenderingPending?e.blockStatusMessage||e.cachedDisplay?.statusMessage||"Loading":void 0}})).actions(e=>({afterAttach(){const t=e.cachedDisplay||(0,a.getContainingDisplay)(e);setTimeout(()=>{(0,c.isAlive)(e)&&(0,o.I)(e,x,C,{name:`${t.id}/${(0,a.assembleLocString)(e.region)} rendering`,delay:t.renderDelay,fireImmediately:!0},e.setLoading,e.setRendered,e.setError)},t.renderDelay)}}));function x(e,t){try{const n=t||e.cachedDisplay||(0,a.getContainingDisplay)(e),{assemblyManager:o,rpcManager:i}=(0,a.getSession)(n),{adapterConfig:l,rendererType:d,error:u,parentTrack:p}=n,h=(0,s.getTrackAssemblyNames)(p),g=e.region.assemblyName;if(!h.includes(g)&&!h.some(e=>o.get(e)?.hasName(g)))throw new Error(`region assembly (${g}) does not match track assemblies (${h})`);const m=n.renderProps(),f=n.renderingProps?.(),{config:y}=m;(0,r.QZ)(y);const b=(0,s.getRpcSessionId)(n),w=p.id,v=n.regionCannotBeRendered(e.region),S=o.get(e.region.assemblyName),k=S?.getSeqAdapterRefName(e.region.refName);return{rendererType:d,rpcManager:i,renderProps:m,renderingProps:f,cannotBeRenderedReason:v,displayError:u,renderArgs:{statusCallback:t=>{(0,c.isAlive)(e)&&e.setStatusMessage(t)},assemblyName:e.region.assemblyName,regions:[{...e.region,seqAdapterRefName:k}],adapterConfig:l,rendererType:d.name,sessionId:b,trackInstanceId:w,blockKey:e.key,reloadFlag:e.reloadFlag,timeout:1e6}}}catch(e){return{displayError:e}}}async function C(e,t,n){if(!e||!(0,c.isAlive)(n))return;const{rendererType:r,renderProps:a,renderingProps:o,rpcManager:i,renderArgs:s,cannotBeRenderedReason:l,displayError:d}=e;if(d)return void n.setError(d);if(l)return void n.setMessage(l);if(a.notReady||!s)return;const{reactElement:u,features:p,layout:h,maxHeightReached:g}=await r.renderInClient(i,{...s,...a,renderingProps:o,stopToken:t});return{reactElement:u,features:p,layout:h,maxHeightReached:g,renderProps:a,renderArgs:s}}},98612(e,t,n){n.d(t,{A:()=>r});const r=(0,n(87877).S7)("BaseLinearDisplay",{maxFeatureScreenDensity:{type:"number",description:"maximum features per pixel that is displayed in the view, used if byte size estimates not available",defaultValue:.3},fetchSizeLimit:{type:"number",defaultValue:1e6,description:"maximum data to attempt to download for a given track, used if adapter doesn't specify one"},height:{type:"number",defaultValue:100,description:"default height for the track"},mouseover:{type:"string",description:"text to display when the cursor hovers over a feature",defaultValue:"jexl:mouseoverExtraInformation||get(feature,'_mouseOver')||get(feature,'name')||get(feature,'id')",contextVariable:["feature","mouseoverExtraInformation"]},jexlFilters:{type:"stringArray",description:"default set of jexl filters to apply to a track. note: these do not use the jexl prefix because they have a deferred evaluation system",defaultValue:[]}},{explicitIdentifier:"displayId"})},99697(e,t,n){n.d(t,{A:()=>a});var r=n(92035);class a extends r.A{constructor(e){super(e),this.stateModel=e.stateModel,this.configSchema=e.configSchema}}}}]);
//# sourceMappingURL=5808.d4082395.chunk.js.map