"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[1853,2231,7258],{10070(e,t,n){n.d(t,{A:()=>x}),n(42918);var o=n(87574),r=n(77251),s=n(65045),i=n(64074),a=n(91853),l=n(85376),c=n(32118);const d=(0,s.n)()({loading:{position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.15)",backgroundImage:"repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.05) 8px, rgba(0, 0, 0, 0.05) 16px)",pointerEvents:"none",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1},loadingMessage:{zIndex:2,pointerEvents:"none"}}),u=(0,i.observer)(function({model:e,children:t}){const{error:n,regionTooLarge:o}=e;return n?(0,c.jsx)(a.default,{model:e}):o?e.regionCannotBeRendered():(0,c.jsx)(h,{model:e,children:t})}),h=(0,i.observer)(function({model:e,children:t}){const{drawn:n,loading:o,showLegend:s,legendItems:i}=e,a=(0,r.getContainingView)(e),d=i?.()??[],u=(e.lastDrawnOffsetPx??0)-a.offsetPx;return(0,c.jsxs)("div",{"data-testid":`drawn-${n}`,children:[(0,c.jsx)("div",{style:{position:"absolute",left:u},children:t}),s&&d.length>0?(0,c.jsx)(l.A,{items:d}):null,0!==u||o?(0,c.jsx)(g,{model:e}):null]})}),g=(0,i.observer)(function({model:e}){const{classes:t}=d(),{statusMessage:n}=e;return(0,c.jsx)("div",{className:t.loading,children:(0,c.jsx)("div",{className:t.loadingMessage,children:(0,c.jsx)(o.A,{message:n})})})}),x=u},42231(e,t,n){n.r(t),n.d(t,{default:()=>w});var o=n(30936),r=n(42918),s=n(71547),i=n(77251),a=n(57141),l=n(64074),c=n(10070),d=n(65045),u=n(36790),h=n(85512),g=n(32118);const x=(0,d.n)()({legend:{position:"absolute",right:10,top:10,background:"rgba(255,255,255,0.9)",border:"1px solid #ccc",borderRadius:4,padding:8,fontSize:11,pointerEvents:"none",zIndex:100},gradientBar:{width:100,height:12,marginBottom:4,borderRadius:2},labels:{display:"flex",justifyContent:"space-between",fontSize:10}}),b={juicebox:"linear-gradient(to right, rgba(0,0,0,0), red)",fall:"linear-gradient(to right, rgb(255,255,255), rgb(255,255,204), rgb(255,237,160), rgb(254,217,118), rgb(254,178,76), rgb(253,141,60), rgb(252,78,42), rgb(227,26,28), rgb(189,0,38), rgb(128,0,38), rgb(0,0,0))",viridis:"linear-gradient(to right, #440154, #482878, #3e4a89, #31688e, #26828e, #1f9e89, #35b779, #6ece58, #b5de2b, #fde725)"},f=(0,l.observer)(function({maxScore:e,colorScheme:t="juicebox",useLogScale:n}){const{classes:o}=x(),r=b[t]||b.juicebox,{min:s,max:a}=function(e,t){if(t){const t=(0,u.A)().base(2).domain([1,e]).nice(),[n,o]=t.domain();return{min:n,max:o}}const n=(0,h.A)().domain([0,e]).nice(),[o,r]=n.domain();return{min:o,max:r}}(e,n);return(0,g.jsxs)("div",{className:o.legend,children:[(0,g.jsx)("div",{className:o.gradientBar,style:{background:r}}),(0,g.jsxs)("div",{className:o.labels,children:[(0,g.jsx)("span",{children:void 0!==s?(0,i.toLocale)(s):""}),(0,g.jsxs)("span",{children:[void 0!==a?(0,i.toLocale)(a):"",n?" (log)":""]})]})]})}),m=Math.sqrt(2);function j(e){const t=(0,o.c)(10),{item:n,x:r,y:a}=e,l=r+15;let c,d,u,h;return t[0]!==l||t[1]!==a?(c={x:l,y:a},t[0]=l,t[1]=a,t[2]=c):c=t[2],t[3]!==n.counts?(d=(0,i.reducePrecision)(n.counts),t[3]=n.counts,t[4]=d):d=t[4],t[5]!==d?(u=(0,g.jsxs)("div",{children:["Score: ",d]}),t[5]=d,t[6]=u):u=t[6],t[7]!==c||t[8]!==u?(h=(0,g.jsx)(s.A,{clientPoint:c,children:u}),t[7]=c,t[8]=u,t[9]=h):h=t[9],h}function p(e){const t=(0,o.c)(9),{x:n,y:r,yScalar:s,left:i,width:a,height:l}=e,c=r/s;let d;t[0]!==l||t[1]!==i||t[2]!==a?(d={position:"absolute",left:i,top:0,width:a,height:l,pointerEvents:"none"},t[0]=l,t[1]=i,t[2]=a,t[3]=d):d=t[3];const u=`M ${n-c} 0 L ${n} ${r} L ${n+c} 0`;let h,x;return t[4]!==u?(h=(0,g.jsx)("g",{stroke:"#000",strokeWidth:"1",fill:"none",children:(0,g.jsx)("path",{d:u})}),t[4]=u,t[5]=h):h=t[5],t[6]!==d||t[7]!==h?(x=(0,g.jsx)("svg",{style:d,children:h}),t[6]=d,t[7]=h,t[8]=x):x=t[8],x}const v=(0,l.observer)(function({model:e}){const t=(0,i.getContainingView)(e),n=Math.round(t.dynamicBlocks.totalWidthPx),{height:o,drawn:s,loading:l,flatbush:c,flatbushItems:d,yScalar:u,showLegend:h,maxScore:x,colorScheme:b,useLogScale:v}=e,w=(0,r.useRef)(null),[y,k]=(0,r.useState)(),[S,A]=(0,r.useState)(),[C,$]=(0,r.useState)(),L=(0,r.useMemo)(()=>c?a.A.from(c):null,[c]),B=(0,r.useCallback)(t=>{e.setRef(t)},[e,n,o]),M=(0,r.useCallback)(e=>{if(!w.current||!L||!d.length)return k(void 0),void A(void 0);const t=w.current.getBoundingClientRect(),n=e.clientX-t.left,o=e.clientY-t.top;A({x:e.clientX,y:e.clientY}),$({x:n,y:o});const{x:r,y:s}=function(e,t,n){const o=t/n;return{x:(e-o)/m,y:(e+o)/m}}(n,o,u),i=L.search(r-1,s-1,r+1,s+1);if(i.length>0){const e=d[i[0]];k(e)}else k(void 0)},[L,d,u]),R=(0,r.useCallback)(()=>{k(void 0),A(void 0),$(void 0)},[]);return(0,g.jsxs)("div",{ref:w,style:{cursor:y&&S?"crosshair":void 0,position:"relative",width:n,height:o},onMouseMove:M,onMouseLeave:R,children:[(0,g.jsx)("canvas",{"data-testid":"hic_canvas"+(s&&!l?"_done":""),ref:B,style:{width:n,height:o,position:"absolute",left:0},width:2*n,height:2*o}),y&&C?(0,g.jsx)(p,{x:C.x,y:C.y,yScalar:u,left:0,width:n,height:o}):null,y&&S?(0,g.jsx)(j,{item:y,x:S.x,y:S.y}):null,h&&x>0?(0,g.jsx)(f,{maxScore:x,colorScheme:b,useLogScale:v}):null]})}),w=(0,l.observer)(function({model:e}){return(0,g.jsx)(c.A,{model:e,children:(0,g.jsx)(v,{model:e})})})},87258(e,t,n){n.r(t),n.d(t,{default:()=>$});var o=n(42918),r=n(6773),s=n(87861),i=n(37815),a=n(74919),l=n(24215),c=n(11543),d=n(65525),u=n(29011),h=n(30936),g=n(15943),x=n(1591),b=n(84830),f=n(65045),m=n(32118);const j="jbrowse2@berkeley.edu",p=(0,f.n)()(e=>({pre:{background:(0,g.X4)(e.palette.error.main,.2),border:`1px solid ${e.palette.divider}`,overflow:"auto",margin:20,maxHeight:300}}));function v(e){const t=(0,h.c)(18),{text:n,extra:o}=e,{classes:r}=p();let s;t[0]!==o?(s=o?`supporting data: ${JSON.stringify(o,null,2)}`:"",t[0]=o,t[1]=s):s=t[1];const i=s;let a;t[2]!==i||t[3]!==n?(a=[n,i].filter(Boolean),t[2]=i,t[3]=n,t[4]=a):a=t[4];const l=a.join("\n"),c=encodeURIComponent(`I got this error from JBrowse, here is the stack trace:\n\n\`\`\`\n${n}\n\`\`\`\n${i}\n`),d=`https://github.com/GMOD/jbrowse-components/issues/new?labels=bug&title=JBrowse+issue&body=${c}`,u=`mailto:${j}?subject=JBrowse%202%20error&body=${c}`;let g,f,v,w,y;return t[5]!==d?(g=(0,m.jsx)(b.A,{href:d,children:"GitHub"}),t[5]=d,t[6]=g):g=t[6],t[7]!==u?(f=(0,m.jsx)(b.A,{href:u,children:j}),t[7]=u,t[8]=f):f=t[8],t[9]!==g||t[10]!==f?(v=(0,m.jsxs)(x.A,{children:["Post a new issue at"," ",g," or send an email to ",f]}),t[9]=g,t[10]=f,t[11]=v):v=t[11],t[12]!==r.pre||t[13]!==l?(w=(0,m.jsx)("pre",{className:r.pre,children:l}),t[12]=r.pre,t[13]=l,t[14]=w):w=t[14],t[15]!==v||t[16]!==w?(y=(0,m.jsxs)(m.Fragment,{children:[v,w]}),t[15]=v,t[16]=w,t[17]=y):y=t[17],y}var w=n(87574);async function y(e){const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status} fetching ${e}: ${await t.text()}`);return t.text()}const k={},S=/\/\/# sourceMappingURL=(.*)/,A=/(.*)((?:https?|file):\/\/.*):(\d+):(\d+)/;async function C(e){if(k[e])return k[e];const t=new URL(e).search,n=await y(e),o=S.exec(n)?.[1]??"",r=await async function(e){return JSON.parse(await y(e))}(new URL(o,e).href+t),s=new u.SourceMapConsumer(r);return k[e]=s,s}function $({error:e,onClose:t,extra:u}){const[h,g]=(0,o.useState)(),[x,b]=(0,o.useState)(),[f,j]=(0,o.useState)(!1),p=e?`${e}`:"",y=function(e,t){return e.startsWith("Error:")?e.slice(`${t}`.length):e}(function(e){return"object"==typeof e&&null!==e&&"stack"in e?`${e.stack}`:""}(e),p);(0,o.useEffect)(()=>{(async()=>{try{g(await async function(e){const t=[];for(const n of e.split("\n")){const e=A.exec(n);if(!e){t.push(n);continue}const o=e[2],r=(await C(o)).originalPositionFor({line:+e[3],column:+e[4]});r.source&&r.line&&r.column?t.push(`${r.source}:${r.line}:${r.column+1} (${e[1].trim()})`):t.push(n)}return t.join("\n")}(y))}catch(e){console.error(e),g(y),b(e)}})()},[y]);const k=window.JBrowseSession?.version,S=[x?"Error loading source map, showing raw stack trace below:":"",p.length>1e4?`${p.slice(0,1e4)}...`:p,h||"No stack trace available",k?`JBrowse ${k}`:""].filter(Boolean).join("\n");return(0,m.jsxs)(s.A,{open:!0,onClose:t,maxWidth:"xl",children:[(0,m.jsxs)(i.A,{children:["Stack trace",(0,m.jsx)(a.A,{onClick:t,sx:{position:"absolute",right:8,top:8},children:(0,m.jsx)(r.A,{})})]}),(0,m.jsx)(l.A,{children:void 0===h?(0,m.jsx)(w.A,{variant:"h6"}):(0,m.jsx)(v,{text:S,extra:u})}),(0,m.jsxs)(c.A,{children:[(0,m.jsx)(d.A,{variant:"contained",color:"secondary",onClick:async()=>{const{default:e}=await n.e(8284).then(n.t.bind(n,88284,23));e(S),j(!0),setTimeout(()=>{j(!1)},1e3)},children:f?"Copied!":"Copy stack trace to clipboard"}),(0,m.jsx)(d.A,{variant:"contained",color:"primary",onClick:t,children:"Close"})]})]})}},91853(e,t,n){n.r(t),n.d(t,{default:()=>h});var o=n(87258),r=n(77251),s=n(2462),i=n(13363),a=n(27607),l=n(74919),c=n(64074),d=n(82947),u=n(32118);const h=(0,c.observer)(function({model:e}){return(0,u.jsx)(d.A,{message:`${e.error}`,severity:"error",action:(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a.A,{title:"Reload track",children:(0,u.jsx)(l.A,{"data-testid":"reload_button",onClick:()=>{e.reload()},children:(0,u.jsx)(s.A,{})})}),(0,u.jsx)(a.A,{title:"Show stack trace",children:(0,u.jsx)(l.A,{onClick:()=>{(0,r.getSession)(e).queueDialog(t=>[o.default,{onClose:t,error:e.error}])},children:(0,u.jsx)(i.A,{})})})]})})})}}]);
//# sourceMappingURL=2231.df7d7d04.chunk.js.map