"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2143],{20101(e,t,o){o.d(t,{A:()=>g});var n=o(30128),r=o(23886),s=o(46625),i=o(69566),l=o(55614),a=o(7201),c=o(49583),d=o(44460);const h=(0,s.n)()(e=>({tooltip:{position:"fixed",top:0,left:0,pointerEvents:"none",backgroundColor:(0,a.X4)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.fontSize,maxWidth:300,wordWrap:"break-word",zIndex:1e5},row:{whiteSpace:"nowrap"},colorBox:{width:10,height:10,display:"inline-block",marginRight:4}})),u=new Set(["color","HP","name","baseName","id"]),p=(0,n.memo)(function(e){const t=(0,l.c)(17),{source:o,x:n,y:r}=e,{classes:s}=h(),i=s.tooltip,a=`translate(${n+10}px, ${r+10}px)`;let p,x,g,m,f;return t[0]!==a?(p={transform:a},t[0]=a,t[1]=p):p=t[1],t[2]!==s.colorBox||t[3]!==o.color?(x=o.color?(0,d.jsx)("div",{className:s.colorBox,style:{backgroundColor:o.color}}):null,t[2]=s.colorBox,t[3]=o.color,t[4]=x):x=t[4],t[5]!==s.row||t[6]!==o.name?(g=o.name?(0,d.jsx)("div",{className:s.row,children:o.name}):null,t[5]=s.row,t[6]=o.name,t[7]=g):g=t[7],t[8]!==s.row||t[9]!==o?(m=Object.entries(o).map(e=>{const[t,o]=e;return u.has(t)||void 0===o?null:(0,d.jsxs)("div",{className:s.row,children:[t,": ",String(o)]},t)}),t[8]=s.row,t[9]=o,t[10]=m):m=t[10],t[11]!==s.tooltip||t[12]!==p||t[13]!==x||t[14]!==g||t[15]!==m?(f=(0,d.jsx)(c.A,{children:(0,d.jsxs)("div",{className:i,style:p,children:[x,g,m]})}),t[11]=s.tooltip,t[12]=p,t[13]=x,t[14]=g,t[15]=m,t[16]=f):f=t[16],f}),x=(0,s.n)()(e=>({container:{position:"absolute",top:0,left:0,pointerEvents:"none",zIndex:800},horizontalLine:{position:"absolute",left:0,height:1,backgroundColor:e.palette.text.primary,pointerEvents:"none"},verticalLine:{position:"absolute",top:0,width:1,backgroundColor:e.palette.text.primary,pointerEvents:"none"}})),g=(0,i.observer)(function({mouseX:e,mouseY:t,model:o,offsetX:s,offsetY:i}){const{classes:l}=x(),{hoveredGenotype:a,height:c,sourceMap:h}=o,{width:u}=(0,r.getContainingView)(o),g=(0,n.useMemo)(()=>{if(!a)return;const e=h?.[a.name];return e?{...e,...a}:void 0},[a,h]);return(0,d.jsxs)("div",{className:l.container,style:{width:u,height:c},children:[(0,d.jsx)("div",{className:l.horizontalLine,style:{transform:`translateY(${t}px)`,width:u}}),(0,d.jsx)("div",{className:l.verticalLine,style:{transform:`translateX(${e}px)`,height:c}}),g?(0,d.jsx)(p,{source:g,x:s+e,y:i+t}):null]})})},17165(e,t,o){o.d(t,{A:()=>x});var n=o(30128),r=o(23886),s=o(69566),i=o(55614),l=o(87377),a=o(76621),c=o(44460);const d=function(e){const t=(0,i.c)(4),{source:o,idx:n,rowHeight:r}=e,{color:s}=o;let l;return t[0]!==s||t[1]!==n||t[2]!==r?(l=s?(0,c.jsx)(a.A,{y:n*r,x:0,width:15.5,height:r+.5,color:s}):null,t[0]=s,t[1]=n,t[2]=r,t[3]=l):l=t[3],l},h=function(e){const t=(0,i.c)(6),{source:o,idx:n,rowHeight:r,textFillProps:s}=e,{color:l,name:a}=o,d=Math.min(r,12),h=(n+.5)*r,u=l?17:0;let p;return t[0]!==a||t[1]!==d||t[2]!==h||t[3]!==u||t[4]!==s?(p=(0,c.jsx)("text",{y:h,x:u,fontSize:d,dominantBaseline:"central",...s,children:a}),t[0]=a,t[1]=d,t[2]=h,t[3]=u,t[4]=s,t[5]=p):p=t[5],p},u=(0,s.observer)(function({model:e,labelWidth:t}){const{canDisplayLabels:o,rowHeight:s,sources:i}=e,u=(0,l.A)(),p=t+((0,n.useMemo)(()=>i?.some(e=>e.color)??!1,[i])?20:0),x=(0,n.useMemo)(()=>(0,r.getFillProps)(u.palette.text.primary),[u.palette.text.primary]);return i?(0,c.jsxs)(c.Fragment,{children:[o?(0,c.jsx)(a.A,{y:0,x:0,width:p,height:(i.length+.25)*s}):null,i.map((e,t)=>(0,c.jsx)(d,{source:e,idx:t,rowHeight:s},`${e.name}-${t}`)),o?i.map((e,t)=>(0,c.jsx)(h,{source:e,idx:t,rowHeight:s,textFillProps:x},`${e.name}-text-${t}`)):null]}):null}),p=(0,s.observer)(function({children:e,model:t,exportSVG:o}){const{id:n,scrollTop:s,height:i,hierarchy:l,treeAreaWidth:a,showTree:d}=t,h=`legend-${"undefined"==typeof jest?n:"test"}`,u=l&&d?a:0;return o?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("defs",{children:(0,c.jsx)("clipPath",{id:h,children:(0,c.jsx)("rect",{x:0,y:0,width:1e3,height:i})})}),(0,c.jsx)("g",{clipPath:`url(#${h})`,children:(0,c.jsx)("g",{transform:`translate(0,${-s})`,children:e})})]}):(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:u,zIndex:100,pointerEvents:"none",height:t.totalHeight,width:(0,r.getContainingView)(t).width},children:e})}),x=(0,s.observer)(function(e){const{model:t}=e,{canDisplayLabels:o,rowHeight:s,sources:i}=t,l=Math.min(s,12),a=(0,n.useMemo)(()=>{if(!i)return 0;let e=0;for(const t of i){const n=o?(0,r.measureText)(t.name,l)+10:20;n>e&&(e=n)}return e},[i,l,o]);return i?(0,c.jsx)(p,{...e,children:(0,c.jsx)(u,{model:t,labelWidth:a})}):null})},76621(e,t,o){o.d(t,{A:()=>c});var n=o(55614),r=o(23886),s=o(7201),i=o(87377),l=o(24154),a=o(44460);const c=e=>{const t=(0,n.c)(11),{x:o,y:c,width:d,height:h,color:u}=e,p=(0,i.A)();let x,g,m;return t[0]!==u||t[1]!==p?(x=u||(0,s.X4)(p.palette.background.paper,l.U0),t[0]=u,t[1]=p,t[2]=x):x=t[2],t[3]!==x?(g=(0,r.getFillProps)(x),t[3]=x,t[4]=g):g=t[4],t[5]!==h||t[6]!==g||t[7]!==d||t[8]!==o||t[9]!==c?(m=(0,a.jsx)("rect",{pointerEvents:"auto",x:o,y:c,width:d,height:h,...g}),t[5]=h,t[6]=g,t[7]=d,t[8]=o,t[9]=c,t[10]=m):m=t[10],m}},32647(e,t,o){o.d(t,{A:()=>w});var n=o(83826),r=o(69566),s=o(17165),i=o(30128),l=o(35864),a=o(23886),c=o(61425),d=o(46625),h=o(7201),u=o(68673),p=o(79291),x=o(44934),g=o(24154),m=o(44460);const f=(0,d.n)()(e=>({resizeHandle:{position:"absolute",top:0,height:"100%",width:4,zIndex:101,background:"transparent","&:hover":{background:e.palette.divider}},treeBackground:{position:"absolute",top:0,left:0,background:(0,h.X4)(e.palette.background.paper,g.U0)}}));function v(e){return e.children?.length?e.children.flatMap(e=>v(e)):[e.data.name]}const b=(0,r.observer)(function({model:e}){const{classes:t}=f(),{width:o}=(0,a.getContainingView)(e),[n,r]=(0,i.useState)(null),[s,d]=(0,i.useState)([]),[h,g]=(0,i.useState)(null),{hierarchy:b,treeAreaWidth:w,height:y,scrollTop:j,showTree:k,sources:C}=e,A=(0,i.useCallback)(t=>{e.setTreeCanvasRef(t)},[e,w,y]),S=(0,i.useCallback)(t=>{e.setMouseoverCanvasRef(t)},[e,o,y]);(0,i.useEffect)(()=>(0,x.autorun)(function(){const{treeAreaWidth:t,hierarchy:o,totalHeight:n}=e;if(!o)return r(null),void d([]);const s=o.descendants().filter(e=>e.children?.length),i=new c.A(s.length);for(const e of s){const t=e.y,o=e.x;i.add(t-8,o-8,t+8,o+8)}i.finish(),r(i),d(s)},{name:"TreeSpatialIndex"}),[e]);const T=(0,i.useCallback)(t=>{if(!b||!n)return;const o=t.currentTarget.getBoundingClientRect(),r=t.clientX-o.left,i=t.clientY-o.top+j,l=n.search(r,i,r,i),a=l.length>0?s[l[0]]:void 0;a?e.setHoveredTreeNode({node:a,descendantNames:v(a)}):e.setHoveredTreeNode(void 0)},[b,n,s,j,e]),H=(0,i.useCallback)(()=>{e.setHoveredTreeNode(void 0)},[e]),M=(0,i.useCallback)(e=>{if(!b||!n)return;const t=e.currentTarget.getBoundingClientRect(),o=e.clientX-t.left,r=e.clientY-t.top+j,i=n.search(o,r,o,r),l=i.length>0?s[i[0]]:void 0;if(l){const t=v(l);g({x:e.clientX,y:e.clientY,names:t})}},[b,n,s,j]),F=(0,i.useCallback)(()=>{g(null)},[]);return b&&k&&C?.length?(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)("div",{style:{position:"sticky",top:0,left:0,height:0,zIndex:100},children:[(0,m.jsx)("div",{className:t.treeBackground,style:{width:w,height:y}}),(0,m.jsx)("canvas",{ref:A,width:2*w,height:2*y,style:{width:w,height:y,position:"absolute",top:0,left:0,pointerEvents:"none"}}),(0,m.jsx)("canvas",{ref:S,width:o,height:y,style:{width:o,height:y,position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}}),(0,m.jsx)("div",{onMouseMove:T,onMouseLeave:H,onClick:M,style:{position:"absolute",top:0,left:0,width:w,height:y,zIndex:2,cursor:"pointer"}})]}),(0,m.jsx)(l.A,{onDrag:t=>{e.setTreeAreaWidth(Math.max(50,w+t))},className:t.resizeHandle,style:{left:w},vertical:!0}),(0,m.jsxs)(u.A,{open:!!h,onClose:F,anchorReference:"anchorPosition",anchorPosition:h?{top:h.y,left:h.x}:void 0,children:[e.subtreeFilter?.length?(0,m.jsx)(p.A,{onClick:()=>{e.setSubtreeFilter(void 0),F()},children:"Clear subtree filter"}):null,(0,m.jsxs)(p.A,{onClick:()=>{h&&e.setSubtreeFilter(h.names),F()},children:["Show only subtree (",h?.names.length," samples)"]})]})]}):null}),w=(0,r.observer)(function({model:e,topOffset:t=0,testId:o}){const{setScrollTop:r,autoHeight:i,availableHeight:l}=e;return(0,m.jsxs)("div",{"data-testid":o,style:{position:"absolute",top:t,height:l,width:"100%",overflowY:i?"hidden":"auto",overflowX:"hidden"},onScroll:e=>{r(e.currentTarget.scrollTop)},children:[(0,m.jsx)(b,{model:e}),(0,m.jsx)(s.A,{model:e}),(0,m.jsx)("div",{style:{position:"absolute",left:0,width:"100%"},children:(0,m.jsx)(n.Ay,{model:e})})]})})},78341(e,t,o){o.d(t,{A:()=>s});var n=o(55614),r=o(30128);function s(e){const t=(0,n.c)(6),o=(0,r.useRef)(void 0),[s,i]=(0,r.useState)();let l;t[0]!==e?(l=t=>{o.current&&cancelAnimationFrame(o.current);const n=t.clientX,r=t.clientY;o.current=requestAnimationFrame(()=>{const t=e.current?.getBoundingClientRect();t&&i({x:n-t.left,y:r-t.top,offsetX:t.left,offsetY:t.top})})},t[0]=e,t[1]=l):l=t[1];const a=l;let c;t[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{o.current&&cancelAnimationFrame(o.current),i(void 0)},t[2]=c):c=t[2];const d=c;let h;return t[3]!==a||t[4]!==s?(h={mouseState:s,handleMouseMove:a,handleMouseLeave:d},t[3]=a,t[4]=s,t[5]=h):h=t[5],h}}}]);
//# sourceMappingURL=2143.51873d8c.chunk.js.map