"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5252],{1832(e,t,s){s.d(t,{P:()=>r});var n=s(23886);function r(e,t,s=()=>{}){const r=new TextDecoder("utf8");let a=0,i=0;for(;a<e.length;){const o=e.indexOf(10,a),d=-1===o?e.length:o,c=e.subarray(a,d),l=r.decode(c).trim();if(l&&!1===t(l,i))break;i++%1e4==0&&s(`Loading ${(0,n.getProgressDisplayStr)(a,e.length)}`),a=d+1}}},55252(e,t,s){s.d(t,{default:()=>u});var n=s(17378),r=s(90946),a=s(23886),i=s(49303),o=s(11931),d=s(1832),c=s(25529),l=s(64738);class u extends r.L{static capabilities=["getFeatures","getRefNames"];getData(e){return this.data||(this.data=this.setup(e).catch(e=>{throw this.data=void 0,e})),this.data}async setup(e){const t=(0,n.QZ)(this.config,"columns"),s=[],r=function(e){const t=e.trim().split(" "),s=t.indexOf("qseqid");if(-1===s)throw new Error('Missing required column "qseqid"');const n=t.indexOf("sseqid");if(-1===n)throw new Error('Missing required column "sseqid"');const r=t.indexOf("qstart");if(-1===r)throw new Error('Missing required column "qstart"');const a=t.indexOf("qend");if(-1===a)throw new Error('Missing required column "qend"');const i=t.indexOf("sstart");if(-1===i)throw new Error('Missing required column "sstart"');const o=t.indexOf("send");if(-1===o)throw new Error('Missing required column "send"');const d=new Map(t.map((e,t)=>[e,t]).filter(e=>!["qseqid","sseqid","qstart","qend","sstart","send"].includes(e[0])));return e=>{if(e.startsWith("#"))return;const t=e.split("\t"),c=t[s],l=t[n],u=t[r],m=t[a],f=t[i],h=t[o];if(!(c&&l&&u&&m&&f&&h))return console.warn("Invalid BLAST line"),void console.warn(e);const g={qseqid:c,sseqid:l,qstart:Number.parseInt(u),qend:Number.parseInt(m),sstart:Number.parseInt(f),send:Number.parseInt(h)};for(const[e,s]of d.entries()){const n=t[s];n&&(g[e]=n)}return g}}(t);return(0,d.P)(await(0,a.fetchAndMaybeUnzip)((0,o.openLocation)((0,n.QZ)(this.config,"blastTableLocation"),this.pluginManager),e),e=>{const t=r(e);return t&&s.push(t),!0},e?.statusCallback),s}async hasDataForRefName(){return!0}getAssemblyNames(){const e=this.getConf("assemblyNames");return 0===e.length?[this.getConf("queryAssembly"),this.getConf("targetAssembly")]:e}async getRefNames(e={}){const t=e.regions?.[0].assemblyName,s=await this.getData(e),n=this.getAssemblyNames().indexOf(t);if(-1!==n){const e=new Set;for(const t of s)e.add(0===n?t.qseqid:t.sseqid);return[...e]}return console.warn("Unable to do ref renaming on adapter"),[]}getFeatures(e,t={}){return(0,c.ObservableCreate)(async s=>{const n=await this.getData(t),[r,a]=this.getAssemblyNames(),{refName:o,assemblyName:d,start:c,end:u}=e;if(d!==a&&d!==r)return console.warn(`${d} not found in this adapter`),void s.complete();for(let e=0;e<n.length;e++){const t=n[e];let m,f,h,g,q,b,w,p;const{qseqid:y,sseqid:N,qstart:x,qend:A,sstart:M,send:O,...v}=t;d===r?(m=x,f=A,h=y,g=r,q=M,b=O,w=N,p=a):(m=M,f=O,h=N,g=a,q=x,b=A,w=y,p=r);let C=1,I=1;m>f&&([m,f]=[f,m],C=-1),q>b&&([q,b]=[b,q],I=-1),m-=1,q-=1,h===o&&(0,i.R6)(c,u,m,f)&&s.next(new l.A({uniqueId:e+d,assemblyName:g,start:m,end:f,type:"match",refName:h,strand:C*I,syntenyId:e,...v,mate:{start:q,end:b,refName:w,assemblyName:p}}))}s.complete()})}}},64738(e,t,s){s.d(t,{A:()=>i});var n=s(43102),r=s(153);const{DQ:a}=r;class i extends n.A{get(e){return"mismatches"===e?a(this.get("CIGAR")):super.get(e)}}}}]);
//# sourceMappingURL=5252.0e6ad1ae.chunk.js.map