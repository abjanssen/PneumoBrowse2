{"version":3,"file":"static/js/3477.ed8387cc.chunk.js","mappings":"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","sources":["webpack://@jbrowse/web/../../plugins/arc/src/ArcRenderer/ArcRendering.tsx"],"sourcesContent":["import { Suspense, lazy, useState } from 'react'\n\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { bpSpanPx, getStrokeProps } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature, Region } from '@jbrowse/core/util'\n\nconst ArcTooltip = lazy(() => import('../ArcTooltip.tsx'))\n\nfunction polarToCartesian(\n  centerX: number,\n  centerY: number,\n  radius: number,\n  angleInDegrees: number,\n) {\n  const angleInRadians = ((angleInDegrees - 90) * Math.PI) / 180\n  return {\n    x: centerX + radius * Math.cos(angleInRadians),\n    y: centerY + radius * Math.sin(angleInRadians),\n  }\n}\n\nfunction getSemicirclePath(centerX: number, radius: number) {\n  const start = polarToCartesian(centerX, 0, radius, 270)\n  const end = polarToCartesian(centerX, 0, radius, 90)\n  return {\n    d: `M ${start.x} ${start.y} A ${radius} ${radius} 0 0 0 ${end.x} ${end.y}`,\n    textYCoord: radius,\n  }\n}\n\nfunction getBezierPath(\n  left: number,\n  right: number,\n  config: AnyConfigurationModel,\n  feature: Feature,\n  displayHeight: number,\n) {\n  const height = Math.min(\n    readConfObject(config, 'height', { feature }) || 100,\n    displayHeight,\n  )\n  // formula: https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Cubic_B%C3%A9zier_curves\n  const t = 0.5\n  const t1 = 1 - t\n  return {\n    d: `M ${left} 0 C ${left} ${height}, ${right} ${height}, ${right} 0`,\n    textYCoord: 3 * (t1 * t1) * (t * height) + 3 * t1 * (t * t) * height,\n  }\n}\n\nfunction ArcFeature({\n  selectedFeatureId,\n  region,\n  bpPerPx,\n  config,\n  displayHeight,\n  feature,\n  semicircle,\n  onFeatureClick,\n}: {\n  selectedFeatureId?: string\n  region: Region\n  config: AnyConfigurationModel\n  bpPerPx: number\n  displayHeight: number\n  feature: Feature\n  semicircle: boolean\n  onFeatureClick: (event: React.MouseEvent, featureId: string) => void\n}) {\n  const [isMouseOvered, setIsMouseOvered] = useState(false)\n  const [left, right] = bpSpanPx(\n    feature.get('start'),\n    feature.get('end'),\n    region,\n    bpPerPx,\n  )\n\n  const featureId = feature.id()\n  const selected = selectedFeatureId === featureId\n  const stroke = selected ? 'red' : readConfObject(config, 'color', { feature })\n  const textStroke = selected ? 'red' : 'black'\n  const label = readConfObject(config, 'label', { feature })\n  const caption = readConfObject(config, 'caption', { feature })\n  const strokeWidth = readConfObject(config, 'thickness', { feature }) || 2\n\n  const centerX = left + (right - left) / 2\n  const radius = (right - left) / 2\n  const { d, textYCoord } = semicircle\n    ? getSemicirclePath(centerX, radius)\n    : getBezierPath(left, right, config, feature, displayHeight)\n\n  return (\n    <g>\n      <path\n        {...getStrokeProps(stroke)}\n        d={d}\n        strokeWidth={strokeWidth}\n        fill=\"transparent\"\n        style={{ cursor: 'pointer' }}\n        onClick={e => {\n          onFeatureClick(e, featureId)\n        }}\n        onMouseOver={() => {\n          setIsMouseOvered(true)\n        }}\n        onMouseLeave={() => {\n          setIsMouseOvered(false)\n        }}\n        pointerEvents=\"stroke\"\n      />\n      {isMouseOvered ? (\n        <Suspense fallback={null}>\n          <ArcTooltip contents={caption} />\n        </Suspense>\n      ) : null}\n      <text x={centerX} y={textYCoord + 3} stroke=\"white\" strokeWidth=\"0.6em\">\n        {label}\n      </text>\n      <text x={centerX} y={textYCoord + 3} stroke={textStroke}>\n        {label}\n      </text>\n    </g>\n  )\n}\n\nconst ArcRendering = observer(function ArcRendering({\n  features,\n  config,\n  regions,\n  bpPerPx,\n  height,\n  exportSVG,\n  displayModel,\n  onFeatureClick,\n}: {\n  features: Map<string, Feature>\n  config: AnyConfigurationModel\n  regions: Region[]\n  bpPerPx: number\n  height: number\n  displayModel?: { selectedFeatureId: string }\n  onFeatureClick: (event: React.MouseEvent, featureId: string) => void\n  exportSVG: boolean\n}) {\n  const region = regions[0]!\n  const width = (region.end - region.start) / bpPerPx\n  const semicircle = readConfObject(config, 'displayMode') === 'semicircles'\n  const { selectedFeatureId } = displayModel || {}\n\n  const children = [...features.values()].map(f => (\n    <ArcFeature\n      key={f.id()}\n      displayHeight={height}\n      config={config}\n      region={region}\n      bpPerPx={bpPerPx}\n      selectedFeatureId={selectedFeatureId}\n      onFeatureClick={onFeatureClick}\n      feature={f}\n      semicircle={semicircle}\n    />\n  ))\n\n  return exportSVG ? (\n    children\n  ) : (\n    <svg width={width} height={height}>\n      {children}\n    </svg>\n  )\n})\n\nexport default ArcRendering\n"],"names":["ArcTooltip","lazy","polarToCartesian","centerX","centerY","radius","angleInDegrees","angleInRadians","Math","PI","x","cos","y","sin","ArcFeature","t0","$","_c","selectedFeatureId","region","bpPerPx","config","displayHeight","feature","semicircle","onFeatureClick","isMouseOvered","setIsMouseOvered","useState","t1","bpSpanPx","get","left","right","t2","id","featureId","selected","caption","d","label","strokeWidth","t3","textStroke","textYCoord","t4","t5","t6","t7","t8","t9","stroke","readConfObject","start","end","getSemicirclePath","height","min","getBezierPath","getStrokeProps","Symbol","for","cursor","e","_jsx","fill","style","onClick","onMouseOver","onMouseLeave","pointerEvents","Suspense","fallback","children","t10","t11","t12","t13","t14","_jsxs","observer","features","regions","exportSVG","displayModel","width","values","map","f"],"sourceRoot":""}