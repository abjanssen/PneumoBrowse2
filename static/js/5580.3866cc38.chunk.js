"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5580],{53199:(e,l,s)=>{s.r(l),s.d(l,{default:()=>G});var a=s(7552),t=s(23758),o=s(99546),n=s(25762),i=s(91194),r=s(922),c=s(53794),d=s(550),m=s(22168),b=s(37702),h=s(9937),u=s(68446),k=s(75785),f=s(48171),g=s(17125),w=s(98360),y=s(28172),p=s(29629),x=s(32808),A=s(81453),v=s(69500);const j=(0,u.observer)((function({model:e}){const{validAssemblies:l,selectedAssemblies:s}=e,a=0===l.size,t="Select assemblies",o="select-assemblies-label",n=new Set(s),i=[...l].every((e=>n.has(e)));return(0,v.jsxs)(f.A,{disabled:a,fullWidth:!0,children:[(0,v.jsx)(g.A,{id:o,children:t}),(0,v.jsxs)(w.A,{labelId:o,multiple:!0,value:s,onChange:l=>{e.setSelectedAssemblies("string"==typeof l.target.value?[l.target.value]:l.target.value)},input:(0,v.jsx)(y.A,{label:t}),renderValue:e=>e.join(", "),children:[(0,v.jsxs)(p.A,{onClickCapture:l=>{e.setSelectedAssemblies(i?[]:void 0),l.preventDefault()},children:[(0,v.jsx)(x.A,{checked:i,indeterminate:!i&&s.length>0}),(0,v.jsx)(A.A,{primary:"Select all"})]}),[...l].map((e=>(0,v.jsxs)(p.A,{value:e,children:[(0,v.jsx)(x.A,{checked:s.includes(e)}),(0,v.jsx)(A.A,{primary:e})]},e)))]})]})}));var S=s(66395),C=s(87731),N=s(36793),$=s(92179),_=s(84495);const D=(0,k.n9)()((()=>({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}}))),B=(0,u.observer)((function({model:e}){const{classes:l}=D(),{bookmarks:s,bookmarksWithValidAssemblies:a,selectedAssemblies:t,selectedBookmarks:n}=e,i=(0,o.getSession)(e),r=new Set(t),c=s.filter((e=>r.has(e.assemblyName))).map(((e,l)=>{const{assemblyName:s,...a}=e;return{...e,id:l,assemblyName:s,locString:(0,o.assembleLocString)(a),correspondingObj:e}})),d=[50,Math.max((0,o.measureText)("Bookmark link",12)+30,(0,o.measureGridWidth)(c.map((e=>e.locString)))),Math.max((0,o.measureText)("Label",12)+30,(0,o.measureGridWidth)(c.map((e=>e.label)))),Math.max((0,o.measureText)("Assembly",12)+30,(0,o.measureGridWidth)(c.map((e=>e.assemblyName)))),100];return(0,v.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,v.jsx)(N.z,{density:"compact",rows:c,columns:[{...$.f,width:d[0]},{field:"locString",headerName:"Bookmark link",width:d[1],renderCell:({value:s,row:a})=>(0,v.jsx)(C.A,{className:l.cell,href:"#",onClick:async l=>{l.preventDefault();const{views:t}=i;await(0,_.Jn)(s,a.assemblyName,t,e)},children:s})},{field:"label",headerName:"Label",width:d[2],editable:!0},{field:"assemblyName",headerName:"Assembly",width:d[3]},{field:"highlight",headerName:"Highlight",width:d[4],renderCell:({value:l,row:s})=>(0,v.jsx)(S.Ay,{color:l||"black",onChange:l=>{e.updateBookmarkHighlight(s,l)}})}],processRowUpdate:l=>{const s=c[l.id];return e.updateBookmarkLabel(s,l.label),l},onProcessRowUpdateError:e=>{i.notifyError(`${e}`,e)},checkboxSelection:!0,onRowSelectionModelChange:l=>{a.length>0&&e.setSelectedBookmarks(l.map((e=>({...c[e]}))))},rowSelectionModel:n.map((e=>e.id)),disableRowSelectionOnClick:!0})})})),L=(0,a.lazy)((()=>s.e(5746).then(s.bind(s,5746)))),z=(0,a.lazy)((()=>Promise.all([s.e(3011),s.e(3425)]).then(s.bind(s,23425)))),E=(0,a.lazy)((()=>s.e(419).then(s.bind(s,20419)))),T=(0,a.lazy)((()=>s.e(772).then(s.bind(s,70772)))),V=(0,a.lazy)((()=>s.e(1326).then(s.bind(s,11326)))),W=(0,a.lazy)((()=>s.e(1811).then(s.bind(s,71811)))),q=(0,k.n9)()({flex:{display:"flex"}}),G=(0,u.observer)((function({model:e}){const{classes:l}=q();return(0,v.jsxs)("div",{children:[(0,v.jsxs)(h.A,{severity:"info",children:["Click and type within the ",(0,v.jsx)("strong",{children:"label"})," field to annotate your bookmark. Double click the ",(0,v.jsx)("strong",{children:"label"})," field to do so within a dialog."]}),(0,v.jsxs)("div",{className:l.flex,children:[(0,v.jsx)(t.A,{"data-testid":"grid_bookmark_menu",menuItems:[{label:"Export",icon:i.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[L,{onClose:l,model:e}]))}},{label:"Import",icon:d.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[z,{model:e,onClose:l}]))}},{label:"Delete",icon:n.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[W,{model:e,onClose:l}]))}},{label:"Share",icon:b.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[E,{model:e,onClose:l}]))}},{label:"Edit colors",icon:c.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[V,{model:e,onClose:l}]))}},{label:"Settings",icon:m.A,onClick:()=>{(0,o.getSession)(e).queueDialog((l=>[T,{model:e,onClose:l}]))}}],children:(0,v.jsx)(r.A,{})}),(0,v.jsx)(j,{model:e})]}),(0,v.jsx)(B,{model:e})]})}))},84495:(e,l,s)=>{s.d(l,{Jn:()=>o,LP:()=>i,eW:()=>r,fU:()=>n});var a=s(99546),t=s(45465);async function o(e,l,s,t){const o=(0,a.getSession)(t);try{let a=s.find((e=>e.id===o.focusedViewId));if(a?.assemblyNames[0]!==l&&(a=s.find((e=>"LinearGenomeView"===e.type&&e.assemblyNames[0]===l))),!a){const e=`${t.id}_${l}`;a=o.addView("LinearGenomeView",{id:e})}await a.navToLocString(e,l)}catch(e){console.error(e),o.notifyError(`${e}`,e)}}function n(e,l){const{selectedBookmarks:s,bookmarksWithValidAssemblies:o}=l,n=0===s.length?o:s;if("BED"===e){const e="",l={};for(const e of n){const{label:s}=e,a=""===s?".":s,t=`${e.refName}\t${e.start}\t${e.end}\t${a}\n`;l[e.assemblyName]?l[e.assemblyName].push(t):l[e.assemblyName]=[t]}for(const s in l){const a=l[s].reduce(((e,l)=>e+l),e),o=new Blob([a||""],{type:"text/x-bed;charset=utf-8"}),n=`jbrowse_bookmarks_${s}.bed`;(0,t.saveAs)(o,n)}}else{const e="chrom\tstart\tend\tlabel\tassembly_name\tcoord_range\n",l=n.map((e=>{const{label:l}=e,s=""===l?".":l,t=(0,a.assembleLocString)(e);return`${e.refName}\t${e.start+1}\t${e.end}\t${s}\t${e.assemblyName}\t${t}\n`})).reduce(((e,l)=>e+l),e),s=new Blob([l||""],{type:"text/tab-separated-values;charset=utf-8"}),o="jbrowse_bookmarks.tsv";(0,t.saveAs)(s,o)}}async function i(e){const l=function(e){let l=0;switch(e.length%4){case 3:l=1;break;case 2:l=2;break;case 0:l=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(l)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:a}=await s.e(7130).then(s.t.bind(s,47130,19)),{inflate:t}=await Promise.resolve().then(s.t.bind(s,57864,23)),o=t(a(l));return(new TextDecoder).decode(o)}async function r(e){const l=(new TextEncoder).encode(e),{deflate:a}=await Promise.resolve().then(s.t.bind(s,57864,23)),{fromByteArray:t}=await s.e(7130).then(s.t.bind(s,47130,19)),o=t(a(l)),n=o.indexOf("=");return n>0?o.slice(0,n).replaceAll("+","-").replaceAll("/","_"):o.replaceAll("+","-").replaceAll("/","_")}}}]);
//# sourceMappingURL=5580.3866cc38.chunk.js.map