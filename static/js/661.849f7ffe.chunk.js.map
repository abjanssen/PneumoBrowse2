{"version":3,"file":"static/js/661.849f7ffe.chunk.js","mappings":"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","sources":["../../../plugins/wiggle/src/MultiLinearWiggleDisplay/renderSvg.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/util.ts","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/RectBg.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/LegendItem.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/LegendItemText.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/ColorLegend.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/FullHeightScaleBar.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/ScoreLegend.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/IndividualScaleBars.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/YScaleBarsWrapper.tsx","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/components/YScaleBars.tsx","../../../plugins/wiggle/src/svgExportUtil.ts"],"sourcesContent":["import { getContainingView } from '@jbrowse/core/util'\nimport { when } from 'mobx'\n\nimport { isReadyOrHasError } from '../svgExportUtil.ts'\nimport YScaleBars from './components/YScaleBars.tsx'\n\nimport type { WiggleDisplayModel } from './model.ts'\nimport type {\n  ExportSvgDisplayOptions,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\n\nexport async function renderSvg(\n  self: WiggleDisplayModel,\n  opts: ExportSvgDisplayOptions,\n  superRenderSvg: (opts: ExportSvgDisplayOptions) => Promise<React.ReactNode>,\n) {\n  await when(() => isReadyOrHasError(self))\n  const { offsetPx } = getContainingView(self) as LinearGenomeViewModel\n  return (\n    <>\n      <g>{await superRenderSvg(opts)}</g>\n      <g transform={`translate(${Math.max(-offsetPx, 0)})`}>\n        <YScaleBars model={self} orientation=\"left\" exportSVG />\n      </g>\n    </>\n  )\n}\n","import { getConf } from '@jbrowse/core/configuration'\nimport {\n  getContainingTrack,\n  getContainingView,\n  measureText,\n} from '@jbrowse/core/util'\n\nimport type { WiggleDisplayModel } from '../model.ts'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\nimport type { GridRowId } from '@mui/x-data-grid'\n\nexport function moveUp<T extends { name: string }>(\n  arr: T[],\n  sel: GridRowId[],\n  by = 1,\n) {\n  const idxs = sel\n    .map(l => arr.findIndex(v => v.name === l))\n    .sort((a, b) => a - b)\n  let lastIdx = 0\n  for (const old of idxs) {\n    const idx = Math.max(lastIdx, old - by)\n    if (idx >= lastIdx) {\n      arr.splice(idx, 0, arr.splice(old, 1)[0]!)\n    }\n    lastIdx = lastIdx + 1\n  }\n\n  return arr\n}\n\nexport function moveDown<T extends { name: string }>(\n  arr: T[],\n  sel: GridRowId[],\n  by = 1,\n) {\n  const idxs = sel\n    .map(l => arr.findIndex(v => v.name === l))\n    .sort((a, b) => b - a)\n  let lastIdx = arr.length - 1\n  for (const old of idxs) {\n    const idx = Math.min(lastIdx, old + by)\n    if (idx <= lastIdx) {\n      arr.splice(idx, 0, arr.splice(old, 1)[0]!)\n    }\n    lastIdx = lastIdx - 1\n  }\n\n  return arr\n}\n\nconst trackLabelFontSize = 12.8\n\nexport function getOffset(model: WiggleDisplayModel) {\n  const { prefersOffset } = model\n  const { trackLabels } = getContainingView(model) as LinearGenomeViewModel\n  const track = getContainingTrack(model)\n  const trackName = getConf(track, 'name')\n  return trackLabels === 'overlapping' && !prefersOffset\n    ? measureText(trackName, trackLabelFontSize) + 100\n    : 10\n}\n","import { getFillProps } from '@jbrowse/core/util'\nimport { alpha, useTheme } from '@mui/material'\n\nconst RectBg = ({\n  x,\n  y,\n  width,\n  height,\n  color,\n}: {\n  x: number\n  y: number\n  width: number\n  height: number\n  color?: string\n}) => {\n  const theme = useTheme()\n  return (\n    <rect\n      pointerEvents=\"auto\"\n      x={x}\n      y={y}\n      width={width}\n      height={height}\n      {...getFillProps(color || alpha(theme.palette.background.paper, 0.3))}\n    />\n  )\n}\n\nexport default RectBg\n","import RectBg from './RectBg.tsx'\n\nimport type { MinimalModel } from './types.ts'\nimport type { Source } from '../../util.ts'\n\nconst LegendItem = function ({\n  source,\n  idx,\n  rowHeight,\n  labelWidth,\n  model,\n  exportSVG,\n}: {\n  source: Source\n  idx: number\n  rowHeight: number\n  labelWidth: number\n  model: MinimalModel\n  exportSVG?: boolean\n}) {\n  const boxHeight = Math.min(20, rowHeight)\n  const {\n    needsCustomLegend,\n    graphType,\n    needsFullHeightScalebar,\n    rowHeightTooSmallForScalebar,\n    renderColorBoxes,\n  } = model\n  const colorBoxWidth = renderColorBoxes ? 15 : 0\n  const legendWidth = labelWidth + colorBoxWidth + 5\n  const svgOffset = exportSVG ? 10 : 0\n  const extraOffset =\n    svgOffset || (graphType && !rowHeightTooSmallForScalebar ? 50 : 0)\n  return (\n    <>\n      {needsFullHeightScalebar ? null : (\n        <RectBg\n          y={idx * rowHeight + 1}\n          x={extraOffset}\n          width={legendWidth}\n          height={boxHeight}\n        />\n      )}\n      {source.color ? (\n        <RectBg\n          y={idx * rowHeight + 1}\n          x={extraOffset}\n          width={colorBoxWidth}\n          height={needsCustomLegend ? rowHeight : boxHeight}\n          color={source.color}\n        />\n      ) : null}\n    </>\n  )\n}\n\nexport default LegendItem\n","import type { MinimalModel } from './types.ts'\nimport type { Source } from '../../util.ts'\nimport type { getFillProps } from '@jbrowse/core/util'\n\nconst LegendItemText = function ({\n  source,\n  idx,\n  rowHeight,\n  model,\n  exportSVG,\n  textFillProps,\n}: {\n  source: Source\n  idx: number\n  rowHeight: number\n  model: MinimalModel\n  exportSVG?: boolean\n  textFillProps: ReturnType<typeof getFillProps>\n}) {\n  const { graphType, rowHeightTooSmallForScalebar, renderColorBoxes } = model\n  const svgFontSize = Math.min(rowHeight, 12)\n  const canDisplayLabel = rowHeight >= 6\n  const colorBoxWidth = renderColorBoxes ? 15 : 0\n  const svgOffset = exportSVG ? 10 : 0\n  const extraOffset =\n    svgOffset || (graphType && !rowHeightTooSmallForScalebar ? 50 : 0)\n\n  return canDisplayLabel ? (\n    <text\n      y={idx * rowHeight + svgFontSize}\n      x={extraOffset + colorBoxWidth + 2}\n      fontSize={svgFontSize}\n      {...textFillProps}\n    >\n      {source.name}\n    </text>\n  ) : null\n}\n\nexport default LegendItemText\n","import { useMemo } from 'react'\n\nimport { getFillProps } from '@jbrowse/core/util'\nimport { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport LegendItem from './LegendItem.tsx'\nimport LegendItemText from './LegendItemText.tsx'\nimport RectBg from './RectBg.tsx'\n\nimport type { MinimalModel } from './types.ts'\n\nconst ColorLegend = observer(function ColorLegend({\n  model,\n  rowHeight,\n  exportSVG,\n}: {\n  model: MinimalModel\n  rowHeight: number\n  exportSVG?: boolean\n}) {\n  const {\n    graphType,\n    needsFullHeightScalebar,\n    rowHeightTooSmallForScalebar,\n    renderColorBoxes,\n    sources,\n    labelWidth,\n  } = model\n  const colorBoxWidth = renderColorBoxes ? 20 : 0\n  const legendWidth = labelWidth + colorBoxWidth + 5\n  const svgOffset = exportSVG ? 10 : 0\n  const extraOffset =\n    svgOffset || (graphType && !rowHeightTooSmallForScalebar ? 50 : 0)\n  const theme = useTheme()\n\n  const textFillProps = useMemo(\n    () => getFillProps(theme.palette.text.primary),\n    [theme.palette.text.primary],\n  )\n\n  return sources ? (\n    <>\n      {\n        /* 0.25 for hanging letters like g */\n        needsFullHeightScalebar ? (\n          <RectBg\n            y={0}\n            x={extraOffset}\n            width={legendWidth}\n            height={(sources.length + 0.25) * rowHeight}\n          />\n        ) : null\n      }\n      {/* Render all background rectangles first */}\n      {sources.map((source, idx) => (\n        <LegendItem\n          key={`${source.name}-${idx}`}\n          source={source}\n          idx={idx}\n          model={model}\n          rowHeight={rowHeight}\n          exportSVG={exportSVG}\n          labelWidth={legendWidth}\n        />\n      ))}\n      {/* Then render all text elements on top */}\n      {sources.map((source, idx) => (\n        <LegendItemText\n          key={`${source.name}-text-${idx}`}\n          source={source}\n          idx={idx}\n          model={model}\n          rowHeight={rowHeight}\n          exportSVG={exportSVG}\n          textFillProps={textFillProps}\n        />\n      ))}\n    </>\n  ) : null\n})\n\nexport default ColorLegend\n","import { getContainingView } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport ColorLegend from './ColorLegend.tsx'\nimport { getOffset } from './util.ts'\nimport YScaleBar from '../../shared/YScaleBar.tsx'\n\nimport type { WiggleDisplayModel } from '../model.ts'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nconst FullHeightScaleBar = observer(function FullHeightScaleBar({\n  model,\n  orientation,\n  exportSVG,\n}: {\n  model: WiggleDisplayModel\n  orientation?: string\n  exportSVG?: boolean\n}) {\n  const { labelWidth } = model\n  const { width: viewWidth } = getContainingView(model) as LinearGenomeViewModel\n  return (\n    <>\n      <g transform={`translate(${!exportSVG ? getOffset(model) : 0},0)`}>\n        <YScaleBar model={model} orientation={orientation} />\n      </g>\n      <g transform={`translate(${viewWidth - labelWidth - 100},0)`}>\n        <ColorLegend exportSVG={exportSVG} model={model} rowHeight={12} />\n      </g>\n    </>\n  )\n})\n\nexport default FullHeightScaleBar\n","import { getContainingView, measureText } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport RectBg from './RectBg.tsx'\n\nimport type { WiggleDisplayModel } from '../model.ts'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\nconst ScoreLegend = observer(function ScoreLegend({\n  model,\n}: {\n  model: WiggleDisplayModel\n}) {\n  const { ticks, scaleType } = model\n  const { width } = getContainingView(model) as LGV\n  const legend = `[${ticks?.values[0]}-${ticks?.values[1]}]${scaleType === 'log' ? ' (log scale)' : ''}`\n  const len = measureText(legend, 14)\n  const padding = 25\n  const xpos = width - len - padding\n  return (\n    <>\n      <RectBg y={0} x={xpos} width={len + 6} height={16} />\n      <text y={13} x={xpos}>\n        {legend}\n      </text>\n    </>\n  )\n})\n\nexport default ScoreLegend\n","import { observer } from 'mobx-react'\n\nimport ColorLegend from './ColorLegend.tsx'\nimport ScoreLegend from './ScoreLegend.tsx'\nimport YScaleBar from '../../shared/YScaleBar.tsx'\n\nimport type { WiggleDisplayModel } from '../model.ts'\n\nconst IndividualScaleBars = observer(function IndividualScaleBars({\n  model,\n  orientation,\n  exportSVG,\n}: {\n  model: WiggleDisplayModel\n  orientation?: string\n  exportSVG?: boolean\n}) {\n  const {\n    sources,\n    rowHeight,\n    rowHeightTooSmallForScalebar,\n    needsCustomLegend,\n    ticks,\n  } = model\n\n  return sources?.length ? (\n    <>\n      <ColorLegend\n        exportSVG={exportSVG}\n        model={model}\n        rowHeight={model.rowHeight}\n      />\n\n      {rowHeightTooSmallForScalebar || needsCustomLegend ? (\n        <ScoreLegend model={model} />\n      ) : (\n        sources.map((_source, idx) => (\n          <g\n            transform={`translate(0 ${rowHeight * idx})`}\n            key={`${JSON.stringify(ticks)}-${idx}`}\n          >\n            <YScaleBar model={model} orientation={orientation} />\n          </g>\n        ))\n      )}\n    </>\n  ) : null\n})\n\nexport default IndividualScaleBars\n","import { getContainingView } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport type { WiggleDisplayModel } from '../model.ts'\n\nconst YScaleBarsWrapper = observer(function YScaleBarsWrapper({\n  children,\n  model,\n  exportSVG,\n}: {\n  model: WiggleDisplayModel\n  children: React.ReactNode\n  exportSVG?: boolean\n}) {\n  const { height } = model\n  return exportSVG ? (\n    children\n  ) : (\n    <svg\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        pointerEvents: 'none',\n        height,\n        width: getContainingView(model).width,\n      }}\n    >\n      {children}\n    </svg>\n  )\n})\n\nexport default YScaleBarsWrapper\n","import { observer } from 'mobx-react'\n\nimport FullHeightScaleBar from './FullHeightScaleBar.tsx'\nimport IndividualScaleBars from './IndividualScaleBars.tsx'\nimport YScaleBarsWrapper from './YScaleBarsWrapper.tsx'\n\nimport type { WiggleDisplayModel } from '../model.ts'\n\nconst YScaleBars = observer(function YScaleBars(props: {\n  model: WiggleDisplayModel\n  orientation?: string\n  exportSVG?: boolean\n}) {\n  const { model, orientation, exportSVG } = props\n  const { showSidebar, stats, needsFullHeightScalebar, sources } = model\n  return stats && sources ? (\n    <YScaleBarsWrapper {...props}>\n      {showSidebar ? (\n        needsFullHeightScalebar ? (\n          <FullHeightScaleBar\n            model={model}\n            orientation={orientation}\n            exportSVG={exportSVG}\n          />\n        ) : (\n          <IndividualScaleBars\n            model={model}\n            orientation={orientation}\n            exportSVG={exportSVG}\n          />\n        )\n      ) : null}\n    </YScaleBarsWrapper>\n  ) : null\n})\n\nexport default YScaleBars\n","export function isReadyOrHasError(display: {\n  renderProps(): { notReady?: boolean }\n  error?: unknown\n}) {\n  return !display.renderProps().notReady || !!display.error\n}\n\nexport function hasAnySubDisplayError(displays: { error?: unknown }[]) {\n  return displays.some(d => !!d.error)\n}\n"],"names":["async","renderSvg","self","opts","superRenderSvg","when","isReadyOrHasError","offsetPx","getContainingView","_jsxs","_Fragment","children","_jsx","transform","Math","max","YScaleBars","model","orientation","exportSVG","moveUp","arr","sel","by","idxs","map","l","findIndex","v","name","sort","a","b","lastIdx","old","idx","splice","moveDown","length","min","getOffset","prefersOffset","trackLabels","track","getContainingTrack","trackName","getConf","measureText","t0","$","_c","x","y","width","height","color","theme","useTheme","t1","t2","t3","alpha","palette","background","paper","getFillProps","pointerEvents","source","rowHeight","labelWidth","boxHeight","needsCustomLegend","graphType","needsFullHeightScalebar","rowHeightTooSmallForScalebar","renderColorBoxes","colorBoxWidth","legendWidth","extraOffset","RectBg","textFillProps","svgFontSize","canDisplayLabel","observer","sources","useMemo","text","primary","LegendItem","LegendItemText","viewWidth","YScaleBar","ColorLegend","ticks","scaleType","legend","values","len","xpos","ScoreLegend","_source","JSON","stringify","style","position","top","left","props","showSidebar","stats","YScaleBarsWrapper","FullHeightScaleBar","IndividualScaleBars","display","renderProps","notReady","error"],"ignoreList":[],"sourceRoot":""}