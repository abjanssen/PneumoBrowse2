"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5483],{27108(e,t,s){s.d(t,{TA:()=>r,fY:()=>n,gJ:()=>c,qm:()=>i,xI:()=>o});var a=s(77251);function n(e){return new Map(e.split(/\n|\r\n|\r/).filter(e=>!!e&&!e.startsWith("#")).map(e=>{const[t,s,a,n,r,o]=e.split("\t");return[n,{refName:t,start:+s,end:+a,score:+r,name:n,strand:"-"===o?-1:1}]}))}async function r(e,t){return(0,a.fetchAndMaybeUnzipText)(e,t)}function o(e){const t=e.split("\t"),s=t.slice(12),a={numMatches:+t[9],blockLen:+t[10],mappingQual:+t[11]};if(s.length)for(const e of s){const t=e.indexOf(":");a[e.slice(0,t)]=e.slice(t+3)}return{tname:t[5],tstart:+t[7],tend:+t[8],qname:t[0],qstart:+t[2],qend:+t[3],strand:"-"===t[4]?-1:1,extra:a}}function i(e){const t=[];for(let s=e.length-2;s>=0;s-=2){t.push(e[s]);const a=e[s+1];"D"===a?t.push("I"):"I"===a?t.push("D"):t.push(a)}return t}function c(e){return e.replaceAll("D","K").replaceAll("I","D").replaceAll("K","I")}},75483(e,t,s){s.d(t,{default:()=>u});var a=s(48455),n=s(77251),r=s(25978),o=s(53155),i=s(33624),c=s(86618),l=s(27108);class u extends a.L{static capabilities=["getFeatures","getRefNames"];async setup(e){return this.setupP||(this.setupP=this.setupPre(e).catch(e=>{throw this.setupP=void 0,e})),this.setupP}async setupPre(e){const{statusCallback:t=()=>{}}=e,s=this.getConf("assemblyNames"),a=this.pluginManager,r=(0,i.openLocation)(this.getConf("bed1Location"),a),o=(0,i.openLocation)(this.getConf("bed2Location"),a),c=(0,i.openLocation)(this.getConf("mcscanAnchorsLocation"),a),[u,f,m]=await(0,n.updateStatus)("Downloading data",t,()=>Promise.all([r,o,c].map(t=>(0,l.TA)(t,e)))),p=(0,l.fY)(u),h=(0,l.fY)(f);return{assemblyNames:s,feats:m.split(/\n|\r\n|\r/).filter(e=>!!e&&"###"!==e).map((e,t)=>{const[s,a,n]=e.split("\t"),r=p.get(s),o=h.get(a);if(!r||!o)throw new Error(`feature not found, ${s} ${a} ${r} ${o}`);return[r,o,+n,t]})}}async hasDataForRefName(){return!0}getAssemblyNames(){return this.getConf("assemblyNames")}async getRefNames(e={}){const t=e.regions?.[0].assemblyName,{feats:s}=await this.setup(e),a=this.getAssemblyNames().indexOf(t);if(-1!==a){const e=new Set;for(const t of s)e.add(0===a?t[0].refName:t[1].refName);return[...e]}return console.warn("Unable to do ref renaming on adapter"),[]}getFeatures(e,t={}){return(0,c.ObservableCreate)(async s=>{const{assemblyNames:a,feats:n}=await this.setup(t),i=a.indexOf(e.assemblyName);if(-1!==i){const t=0===i;for(const c of n){const[n,l,u,f]=c,[m,p]=t?[n,l]:[l,n];m.refName===e.refName&&(0,r.R6)(e.start,e.end,m.start,m.end)&&s.next(new o.A({...m,uniqueId:`${i}-${f}`,syntenyId:f,strand:m.strand*p.strand,assemblyName:a[+!t],score:u,mate:{...p,assemblyName:a[+t]}}))}}s.complete()})}}}}]);
//# sourceMappingURL=5483.6cd633d3.chunk.js.map