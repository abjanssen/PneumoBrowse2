"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8585],{88585:(e,t,n)=>{n.r(t),n.d(t,{default:()=>D});var l=n(7552),a=n(99546),o=n(29499),r=n(5401),c=n(58507),s=n(75785),i=n(30157),m=n(943),u=n(40985),d=n(2187),h=n(43163),p=n(61723),E=n(24387),f=n(68446),g=n(21254),C=n.n(g);function w(){return w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)({}).hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},w.apply(null,arguments)}const b=(0,s.n9)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function v(e){const t=(0,l.useRef)(null);return l.createElement(C(),{nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',onStart:e=>e.target?.className?.includes("MuiDialogTitle")},l.createElement(m.A,w({ref:t},e)))}const A=(0,f.observer)((function(e){const{classes:t}=b(),{title:n,children:a,onClose:o}=e;return l.createElement(u.A,w({},e,{PaperComponent:v}),l.createElement(d.A,null,l.createElement(h.A,{style:{cursor:"move"}},n,o?l.createElement(p.A,{className:t.closeButton,onClick:()=>{o()}},l.createElement(i.A,null)):null),l.createElement(E.A,null),a))}));var k=n(49823),y=n(66395),S=n(66195),M=n(21430),x=n(91388),L=n(42281),O=n(28237);function N(e,t,n=1){const l=t.map((t=>e.findIndex((e=>e.name===t)))).sort(((e,t)=>e-t));let a=0;for(const t of l){const l=Math.max(a,t-n);l>=a&&e.splice(l,0,e.splice(t,1)[0]),a+=1}return e}function T(e,t,n=1){const l=t.map((t=>e.findIndex((e=>e.name===t)))).sort(((e,t)=>t-e));let a=e.length-1;for(const t of l){const l=Math.min(a,t+n);l<=a&&e.splice(l,0,e.splice(t,1)[0]),a-=1}return e}const j=(0,s.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function H({selected:e,onChange:t,rows:n,showTips:a}){const[o,c]=(0,l.useState)(null),[s,i]=(0,l.useState)("blue");return l.createElement(l.Fragment,null,l.createElement(r.A,{disabled:!e.length,onClick:e=>{c(e.currentTarget)}},"Change color of selected items"),l.createElement(r.A,{onClick:()=>{t(N([...n],e))},disabled:!e.length},l.createElement(M.A,null),a?"Move selected items up":null),l.createElement(r.A,{onClick:()=>{t(T([...n],e))},disabled:!e.length},l.createElement(S.A,null),a?"Move selected items down":null),l.createElement(r.A,{onClick:()=>{t(N([...n],e,n.length))},disabled:!e.length},l.createElement(L.A,null),a?"Move selected items to top":null),l.createElement(r.A,{onClick:()=>{t(T([...n],e,n.length))},disabled:!e.length},l.createElement(x.A,null),a?"Move selected items to bottom":null),l.createElement(y.FO,{anchorEl:o,color:s,onChange:l=>{i(l),e.forEach((e=>{const t=n.find((t=>t.name===e));t&&(t.color=l)})),t([...n])},onClose:()=>{c(null)}}))}const R=function({rows:e,onChange:t,showTips:n}){const{classes:o}=j(),[r,c]=(0,l.useState)([]),{name:s,color:i,baseUri:m,...u}=e[0],[d,h]=(0,l.useState)({idx:0,field:null});return l.createElement("div",null,l.createElement(H,{selected:r,rows:e,showTips:n,onChange:t}),l.createElement("div",{style:{height:400,width:"100%"}},l.createElement(O.z,{getRowId:e=>e.name,checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:e=>{c(e)},rows:e,rowHeight:25,columnHeaderHeight:33,columns:[{field:"color",headerName:"Color",renderCell:n=>{const{value:a,id:o}=n;return l.createElement(y.Ay,{color:a||"blue",onChange:n=>{const l=e.find((e=>e.name===o));l&&(l.color=n),t([...e])}})}},{field:"name",headerName:"Name",width:(0,a.measureGridWidth)(e.map((e=>e.name)))},...Object.keys(u).map((t=>({field:t,renderCell:({value:e})=>l.createElement("div",{className:o.cell},l.createElement(k.SanitizedHTML,{html:(0,a.getStr)(e)})),width:(0,a.measureGridWidth)(e.map((e=>`${e[t]}`)))})))],sortModel:[],onSortModelChange:n=>{const l=n[0],o=(d.idx+1)%2,r=l.field||d.field;h({idx:o,field:r}),t(r?[...e].sort(((e,t)=>{const n=(0,a.getStr)(e[r]),l=(0,a.getStr)(t[r]);return 1===o?n.localeCompare(l):l.localeCompare(n)})):e)}})))};var F=n(36715),G=n(1343);const I=(0,s.n9)()({textAreaFont:{fontFamily:"Courier New"}});function B({setCurrLayout:e,currLayout:t}){const{classes:n}=I(),[a,o]=(0,l.useState)(""),[c,s]=(0,l.useState)();return l.createElement("div",null,l.createElement(F.A,null,'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'),l.createElement(G.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:a,onChange:e=>{o(e.target.value)},slotProps:{input:{classes:{input:n.textAreaFont}}}}),l.createElement(r.A,{variant:"contained",onClick:()=>{const n=a.split("\n").map((e=>e.trim())).filter((e=>!!e)),l=n[0].split(/[,\t]/gm);if(l.includes("name")){s("");const a=t.map((e=>[e.name,e])),o=Object.fromEntries(n.slice(1).map((e=>{const t=e.split(/[,\t]/gm),n=Object.fromEntries(t.map(((e,t)=>[l[t],e])));return[n.name,{...n,...a[n.name]}]})));e(t.map((e=>({...e,...o[e.name]}))))}else s(new Error('No "name" column found on line 1'))}},"Update rows"),l.createElement(r.A,{variant:"contained",onClick:()=>{const n=a.split("\n").map((e=>e.trim())).filter((e=>!!e)),l=n[0].split(/[,\t]/gm);if(l.includes("name")){s("");const a=t.map((e=>[e.name,e])),o=Object.fromEntries(n.slice(1).map((e=>{const t=e.split(/[,\t]/gm),n=Object.fromEntries(t.map(((e,t)=>[l[t],e])));return[n.name,{...n,...a[n.name]}]})));e(t.map((e=>({...o[e.name]}))))}else s(new Error('No "name" column found on line 1'))}},"Replace rows"),c?l.createElement(k.ErrorMessage,{error:c}):null)}var P=n(40898),W=n(7080);function _({setCurrLayout:e,currLayout:t}){return l.createElement("div",null,Object.keys(t[0]??[]).filter((e=>"name"!==e&&"color"!==e)).map((n=>l.createElement(r.A,{key:n,onClick:()=>{const l=new Map;for(const e of t){const t=l.get(e[n]);t?l.set(e[n],t+1):l.set(e[n],1)}const a=Object.fromEntries([...l.entries()].sort(((e,t)=>e[1]-t[1])).map(((e,t)=>[e[0],P.set1[t]||(0,W.XL)(e[0])])));e(t.map((e=>({...e,color:a[e[n]]}))))}},"Palettize ",n))))}const z=(0,s.n9)()({content:{minWidth:800},fr:{float:"right"},textAreaFont:{fontFamily:"Courier New"}});function D({model:e,handleClose:t}){const{classes:n}=z(),{sources:s}=e,[i,m]=(0,l.useState)(!1),[u,d]=(0,l.useState)(s||[]),[h,p]=(0,a.useLocalStorage)("multivariant-showTips",!1);return l.createElement(A,{open:!0,onClose:t,maxWidth:"xl",title:"Multi-variant color/arrangement editor"},l.createElement(o.A,{className:n.content},l.createElement("div",{className:n.fr},l.createElement(r.A,{variant:"contained",onClick:()=>{p(!h)}},h?"Hide tips":"Show tips"),l.createElement(r.A,{color:"secondary",variant:"contained",onClick:()=>{m(!i)}},i?"Hide bulk row editor":"Show Bulk row editor")),l.createElement("br",null),h?l.createElement(U,null):null,i?l.createElement(B,{currLayout:u,setCurrLayout:d}):null,l.createElement(_,{currLayout:u,setCurrLayout:d}),l.createElement(R,{rows:u,onChange:d,showTips:h})),l.createElement(c.A,null,l.createElement(r.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{e.clearLayout(),d(e.sources||[])}},"Clear custom settings"),l.createElement(r.A,{variant:"contained",color:"secondary",onClick:()=>{t(),d([...e.sources||[]])}},"Cancel"),l.createElement(r.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{e.setLayout(u),t()}},"Submit")))}function U(){return l.createElement(l.Fragment,null,"Helpful tips",l.createElement("ul",null,l.createElement("li",null,"You can select rows in the table with the checkboxes"),l.createElement("li",null,"Multi-select is enabled with shift-click and control-click"),l.createElement("li",null,'The "Move selected items up/down" can re-arrange subtracks'),l.createElement("li",null,"Sorting the data grid itself can also re-arrange subtracks"),l.createElement("li",null,"Changes are applied when you hit Submit"),l.createElement("li",null,"You can click and drag the dialog box to move it on the screen"),l.createElement("li",null,"Columns in the table can be hidden using a vertical '...' menu on the right side of each column")))}}}]);
//# sourceMappingURL=8585.a4e7ce7d.chunk.js.map