"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3474],{91392:(e,t,n)=>{n.d(t,{KM:()=>h,en:()=>f,kb:()=>y,se:()=>p});var l=n(7552),r=n(99546),a=n(95095),o=n(48231),s=n(68446),c=n(36422),i=n(75785),m=n(90257);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)({}).hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},d.apply(null,arguments)}const u=(0,i.n9)()((()=>({vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}}))),h=(0,s.observer)((function({model:e}){const{viewWidth:t,borderY:n}=e,{classes:r}=u();return l.createElement("svg",{width:t,height:n,className:r.htext},l.createElement(p,{model:e}))})),p=(0,s.observer)((function({model:e}){const{viewWidth:t,borderX:n,borderY:s,hview:i,htextRotation:u,hticks:h}=e,{offsetPx:p,width:f,dynamicBlocks:y,bpPerPx:E}=i,b=y.contentBlocks,g=(0,m.rQ)(b,t,p),v=(0,o.A)(),k={...(0,c.getSnapshot)(i),width:f,staticBlocks:i.staticBlocks},w=h.map((e=>[e,(0,a.eB)({refName:e.refName,coord:e.base,self:k})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-p]));return l.createElement(l.Fragment,null,b.filter((e=>!g.has(e.key))).map((e=>{const t=e.offsetPx,n=Math.floor(t-i.offsetPx);return l.createElement("text",d({transform:`rotate(${u},${n},0)`,key:JSON.stringify(e),x:n,y:1,fontSize:11,dominantBaseline:"hanging",textAnchor:"end"},(0,r.getFillProps)(v.palette.text.primary)),e.refName)})),w.map((([e,t])=>t>0&&t<f?l.createElement("line",d({key:`line-${JSON.stringify(e)}`,x1:t,x2:t,y1:0,y2:"major"===e.type?6:4,strokeWidth:1},(0,r.getFillProps)(v.palette.text.primary))):null)),w.filter((e=>"major"===e[0].type)).map((([e,t])=>t>10&&t<f?l.createElement("text",d({x:t-7,y:0,transform:`rotate(${u},${t},0)`,key:`text-${JSON.stringify(e)}`,fontSize:11,dominantBaseline:"middle",textAnchor:"end"},(0,r.getFillProps)(v.palette.text.primary)),(0,r.getTickDisplayStr)(e.base+1,E)):null)),l.createElement("text",d({y:s-12,x:(t-n)/2,textAnchor:"middle",fontSize:11,dominantBaseline:"hanging"},(0,r.getFillProps)(v.palette.text.primary)),i.assemblyNames.join(",")))})),f=(0,s.observer)((function({model:e}){const{borderX:t,viewHeight:n}=e,{classes:r}=u();return l.createElement("svg",{className:r.vtext,width:t,height:n},l.createElement(y,{model:e}))})),y=(0,s.observer)((function({model:e}){const{viewHeight:t,borderX:n,borderY:s,vview:i,vtextRotation:u,vticks:h}=e,{offsetPx:p,width:f,dynamicBlocks:y,bpPerPx:E}=i,b=y.contentBlocks,g=(0,m.rQ)(b,t,p),v=(0,o.A)(),k={...(0,c.getSnapshot)(i),width:f,staticBlocks:i.staticBlocks},w=h.map((e=>[e,(0,a.eB)({refName:e.refName,coord:e.base,self:k})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-p]));return l.createElement(l.Fragment,null,b.filter((e=>!g.has(e.key))).map((e=>{const a=e.offsetPx,o=n,s=Math.floor(t-a+p);return l.createElement("text",d({transform:`rotate(${u},${o},${a})`,key:JSON.stringify(e),x:o,y:s,fontSize:11,textAnchor:"end"},(0,r.getFillProps)(v.palette.text.primary)),e.refName)})),w.map((([e,a])=>a>0?l.createElement("line",d({key:`line-${JSON.stringify(e)}`,y1:t-a,y2:t-a,x1:n,x2:n-("major"===e.type?6:4),strokeWidth:1},(0,r.getStrokeProps)(v.palette.grey[400]))):null)),w.filter((e=>"major"===e[0].type)).map((([e,a])=>a>10&&a<t?l.createElement("text",d({y:t-a-3,x:n-7,key:`text-${JSON.stringify(e)}`,textAnchor:"end",dominantBaseline:"hanging",fontSize:11},(0,r.getFillProps)(v.palette.text.primary)),(0,r.getTickDisplayStr)(e.base+1,E)):null)),l.createElement("text",d({y:(t-s)/2,x:12,transform:`rotate(-90,12,${(t-s)/2})`,textAnchor:"middle",fontSize:11},(0,r.getFillProps)(v.palette.text.primary)),i.assemblyNames.join(",")))}))},63474:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ae});var l=n(7552),r=n(49823),a=n(42489),o=n(68446),s=n(75785),c=n(91392),i=n(86495),m=n(99546),d=n(36715),u=n(23758),h=n(90542),p=n(17307),f=n(87809),y=n(91404),E=n(61723),b=n(2859);function g(e){return l.createElement(b.A,e,l.createElement("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"}))}function v(e){return l.createElement(b.A,e,l.createElement("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"}))}const k=(0,o.observer)((function({model:e}){return l.createElement("div",null,l.createElement(E.A,{onClick:()=>{e.zoomOut()}},l.createElement(y.A,null)),l.createElement(E.A,{onClick:()=>{e.zoomIn()}},l.createElement(f.A,null)),l.createElement(E.A,{onClick:()=>e.activateTrackSelector(),title:"Open track selector"},l.createElement(h.xU,null)),l.createElement(u.A,{menuItems:[{onClick:()=>{e.squareView()},label:"Square view - same base pairs per pixel"},{onClick:()=>{e.squareViewProportional()},label:"Rectanglularize view - same total bp"},{onClick:()=>{e.showAllRegions()},label:"Show all regions"},{onClick:()=>{e.setDrawCigar(!e.drawCigar)},type:"checkbox",label:"Draw CIGAR",checked:e.drawCigar},{onClick:()=>{e.setShowPanButtons(!e.showPanButtons)},label:"Show pan buttons",type:"checkbox",checked:e.showPanButtons},{label:"Click and drag mode",subMenu:[{onClick:()=>{e.setCursorMode("move")},label:"Pan by default, select region when ctrl/cmd key is held",icon:g,type:"radio",checked:"move"===e.cursorMode},{onClick:()=>{e.setCursorMode("crosshair")},label:"Select region by default, pan when ctrl/cmd key is held",icon:v,type:"radio",checked:"crosshair"===e.cursorMode}]},{label:"Wheel scroll mode",subMenu:[{onClick:()=>{e.setWheelMode("pan")},label:"Pans view",type:"radio",checked:"pan"===e.wheelMode},{onClick:()=>{e.setWheelMode("zoom")},label:"Zooms view",type:"radio",checked:"zoom"===e.wheelMode},{onClick:()=>{e.setWheelMode("none")},label:"Disable",type:"radio",checked:"none"===e.wheelMode}]}]},l.createElement(p.A,null)))}));var w=n(9937),A=n(5401);const x=(0,l.lazy)((()=>Promise.all([n.e(8565),n.e(8237),n.e(4863)]).then(n.bind(n,97464)))),S=(0,o.observer)((function({model:e}){const t=e.tracks.filter((e=>e.displays[0].warnings?.length)),[n,r]=(0,l.useState)(!1),[a,o]=(0,l.useState)(!1);return t.length&&!a?l.createElement(w.A,{severity:"warning"},"Warnings during render"," ",l.createElement(A.A,{onClick:()=>{r(!0)}},"More info"),n?l.createElement(x,{trackWarnings:t,handleClose:()=>{r(!1)}}):null,l.createElement(A.A,{variant:"contained",onClick:()=>{o(!0)}},"Dismiss")):null}));var C=n(32813),P=n(6500),L=n(99829),M=n(12756),N=n(943);const T=(0,s.n9)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:1e3,top:50},icon:{padding:0,margin:0}}),z=(0,o.observer)((function({model:e}){const{classes:t}=T();return l.createElement(N.A,{className:t.dpad,elevation:6},l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.vview.scroll(100)}},l.createElement(P.A,null)),l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.hview.scroll(-100)}},l.createElement(L.A,null)),l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.hview.scroll(100)}},l.createElement(M.A,null)),l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.vview.scroll(-100)}},l.createElement(C.A,null)),l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.zoomIn()}},l.createElement(f.A,null)),l.createElement("div",null),l.createElement(E.A,{className:t.icon,onClick:()=>{e.zoomOut()}},l.createElement(y.A,null)))})),B=(0,s.n9)()({bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),I=(0,o.observer)((function({model:e,selection:t}){const{classes:n}=B(),{hview:r,vview:a,showPanButtons:o}=e;return l.createElement("div",{className:n.headerBar},l.createElement(k,{model:e}),l.createElement(d.A,{className:n.bp,variant:"body2",color:"textSecondary"},"x: ",r.assemblyNames.join(",")," ",(0,m.getBpDisplayStr)(r.currBp),l.createElement("br",null),"y: ",a.assemblyNames.join(",")," ",(0,m.getBpDisplayStr)(a.currBp)),t?l.createElement(d.A,{className:n.bp,variant:"body2",color:"textSecondary"},`width:${(0,m.getBpDisplayStr)(r.bpPerPx*t.width)}`," ",l.createElement("br",null),`height:${(0,m.getBpDisplayStr)(a.bpPerPx*t.height)}`):null,l.createElement("div",{className:n.spacer}),l.createElement(S,{model:e}),o?l.createElement(z,{model:e}):null)}));var F=n(48171),O=n(22679),D=n(56089),$=n(33371),R=n(33248),j=n(63896),V=n(67314);function H({radioOption:e,assembly1:t,assembly2:n,fileLocation:l,indexFileLocation:r,bed1Location:a,bed2Location:o}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:l,queryAssembly:t,targetAssembly:n};if(".out"===e)return{type:"MashMapAdapter",outLocation:l,queryAssembly:t,targetAssembly:n};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:l,queryAssembly:t,targetAssembly:n};if(".chain"===e)return{type:"ChainAdapter",chainLocation:l,queryAssembly:t,targetAssembly:n};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:l,bed1Location:a,bed2Location:o,assemblyNames:[t,n]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:l,bed1Location:a,bed2Location:o,assemblyNames:[t,n]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:l,index:{location:r},assemblyNames:[t,n]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}const W=(0,o.observer)((function({assembly1:e,assembly2:t,setSessionTrackData:n}){const[a,o]=(0,l.useState)(),[s,c]=(0,l.useState)(),[i,m]=(0,l.useState)(),[u,h]=(0,l.useState)(),[p,f]=(0,l.useState)(""),[y,E]=(0,l.useState)(),b=(g=i)?g.uri||g.localPath||g.name:void 0;var g;const v=p||(b?function(e){const t=e.split(".").pop();return t?`.${t}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(b)):"");return(0,l.useEffect)((()=>{try{if(i){const l=b?b.split("#")[0].split("?")[0].split("/").pop():"MyTrack",r=`${l}-${Date.now()}`;E(void 0),n({trackId:r,name:l,assemblyNames:[t,e],type:"SyntenyTrack",adapter:H({radioOption:v,assembly1:e,assembly2:t,fileLocation:i,indexFileLocation:u,bed1Location:s,bed2Location:a})})}}catch(e){console.error(e),E(e)}}),[b,e,t,s,a,i,u,v,n]),l.createElement(N.A,{style:{padding:12}},y?l.createElement(r.ErrorMessage,{error:y}):null,l.createElement(d.A,{style:{textAlign:"center"}},"Add a .paf, .out (MashMap), .delta (Mummer), .chain, .anchors or .anchors.simple (MCScan) file to view. These file types can also be gzipped. The first assembly should be the query sequence (e.g. left column of the PAF) and the second assembly should be the target sequence (e.g. right column of the PAF)"),l.createElement(D.A,{value:v,onChange:e=>{f(e.target.value)}},l.createElement(V.Ay,{container:!0,justifyContent:"center"},l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".paf",control:l.createElement(R.A,null),label:".paf"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".out",control:l.createElement(R.A,null),label:".out"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".delta",control:l.createElement(R.A,null),label:".delta"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".chain",control:l.createElement(R.A,null),label:".chain"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".anchors",control:l.createElement(R.A,null),label:".anchors"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".anchors.simple",control:l.createElement(R.A,null),label:".anchors.simple"})),l.createElement(V.Ay,{item:!0},l.createElement($.A,{value:".pif.gz",control:l.createElement(R.A,null),label:".pif.gz"})))),l.createElement(V.Ay,{container:!0,justifyContent:"center"},l.createElement(V.Ay,{item:!0},".anchors"===p||".anchors.simple"===p?l.createElement("div",null,l.createElement("div",{style:{margin:20}},"Open the ",p," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",l.createElement("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)"},"(more info)")),l.createElement("div",{style:{display:"flex"}},l.createElement("div",null,l.createElement(r.FileSelector,{name:".anchors file",description:"",location:i,setLocation:e=>{m(e)}})),l.createElement("div",null,l.createElement(r.FileSelector,{name:"genome 1 .bed (left column of anchors file)",description:"",location:s,setLocation:e=>{c(e)}})),l.createElement("div",null,l.createElement(r.FileSelector,{name:"genome 2 .bed (right column of anchors file)",description:"",location:a,setLocation:e=>{o(e)}})))):".pif.gz"===p?l.createElement("div",{style:{display:"flex"}},l.createElement("div",null,l.createElement(r.FileSelector,{name:`${p} location`,description:"",location:i,setLocation:e=>{m(e)}})),l.createElement("div",null,l.createElement(r.FileSelector,{name:`${p} index location`,description:"",location:u,setLocation:e=>{h(e)}}))):l.createElement(r.FileSelector,{name:p?`${p} location`:"",description:"",location:i,setLocation:e=>{m(e)}}))))}));var q=n(68584),Y=n(91468),J=n(98360),X=n(29629);const K=(0,o.observer)((({model:e,assembly1:t,assembly2:n,setShowTrackId:a})=>{const o=(0,m.getSession)(e),{tracks:s,sessionTracks:c}=o,i=[...s,...c||[]].filter((e=>function(e,t,n){const l=(0,q.readConfObject)(e,"assemblyNames");return l.includes(t)&&l.includes(n)&&e.type.includes("Synteny")}(e,n,t))),u=i[0]?.trackId||"",[p,f]=(0,l.useState)(u);return(0,l.useEffect)((()=>{f(u)}),[u]),(0,l.useEffect)((()=>{a(p)}),[p,a]),l.createElement(N.A,{style:{padding:12}},l.createElement(d.A,{paragraph:!0},'Select a track from the select box below, the track will be shown when you hit "Launch".'),l.createElement(d.A,{paragraph:!0},"Note: there is a track selector ",l.createElement("i",null,"inside")," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon ",l.createElement(h.xU,null)),i.length?l.createElement(J.A,{value:p,onChange:e=>{f(e.target.value)}},i.map((e=>l.createElement(X.A,{key:e.trackId,value:e.trackId},(0,Y.getTrackName)(e,o))))):l.createElement(r.ErrorMessage,{error:`No synteny tracks found for ${t},${n}`}))})),_=(0,s.n9)()((e=>({importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}})));function Z({setSessionTrackData:e,setShowTrackId:t,sessionTrackData:n,assembly1:r,assembly2:a,model:o}){const[s,c]=(0,l.useState)("tracklist");return(0,l.useEffect)((()=>{"none"===s&&(e(void 0),t(void 0))}),[s,e,t]),l.createElement(l.Fragment,null,l.createElement(F.A,null,l.createElement(O.A,{id:"group-label"},"(Optional) Select or add a synteny track"),l.createElement(D.A,{row:!0,value:s,onChange:e=>{c(e.target.value)},"aria-labelledby":"group-label"},l.createElement($.A,{value:"none",control:l.createElement(R.A,null),label:"None"}),l.createElement($.A,{value:"tracklist",control:l.createElement(R.A,null),label:"Existing track"}),l.createElement($.A,{value:"custom",control:l.createElement(R.A,null),label:"New track"}))),"custom"===s?l.createElement(W,{setSessionTrackData:e,sessionTrackData:n,assembly2:a,assembly1:r}):null,"tracklist"===s?l.createElement(K,{model:o,assembly1:r,assembly2:a,setShowTrackId:t}):null)}const G=(0,o.observer)((({model:e})=>{const{classes:t}=_(),n=(0,m.getSession)(e),{assemblyNames:o}=n,[s,c]=(0,l.useState)(o[0]||""),[i,u]=(0,l.useState)(o[0]||""),[h,p]=(0,l.useState)(),[f,y]=(0,l.useState)(),[E,b]=(0,l.useState)(),g=h||e.error;return l.createElement(j.A,{className:t.importFormContainer},g?l.createElement(r.ErrorMessage,{error:g}):null,l.createElement(V.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",className:t.assemblySelector},l.createElement(V.Ay,{item:!0},l.createElement(N.A,{style:{padding:12}},l.createElement(d.A,{style:{textAlign:"center"}},"Select assemblies for dotplot view"),l.createElement(V.Ay,{container:!0,spacing:1,justifyContent:"center",alignItems:"center"},l.createElement(V.Ay,{item:!0},l.createElement(r.AssemblySelector,{selected:i,onChange:e=>{u(e)},session:n})),l.createElement(V.Ay,{item:!0},l.createElement(r.AssemblySelector,{selected:s,onChange:e=>{c(e)},session:n})),l.createElement(V.Ay,{item:!0},l.createElement(F.A,null,l.createElement(A.A,{onClick:function(){try{if(!(0,m.isSessionWithAddTracks)(n))return;p(void 0),e.setError(void 0),(0,a.transaction)((()=>{f?(n.addTrackConf(f),e.toggleTrack(f.trackId)):E&&e.showTrack(E),e.setViews([{bpPerPx:.1,offsetPx:0},{bpPerPx:.1,offsetPx:0}]),e.setAssemblyNames(s,i)}))}catch(e){console.error(e),p(e)}},variant:"contained",color:"primary"},"Launch"))))),l.createElement(Z,{setShowTrackId:b,assembly2:s,assembly1:i,setSessionTrackData:y,sessionTrackData:f,model:e}))))})),U=(0,l.lazy)((()=>n.e(1304).then(n.bind(n,81304)))),Q=(0,l.lazy)((()=>n.e(1051).then(n.bind(n,21051)))),ee={left:0,top:0,width:0,height:0},te=(0,s.n9)()((e=>({spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})));function ne(e,t){return e&&[e[0]-t.left,e[1]-t.top]}const le=(0,o.observer)((({model:e})=>{const{classes:t}=te();return l.createElement("div",{className:t.overlay},e.tracks.map((e=>{const[t]=e.displays,{RenderingComponent:n}=t;return n?l.createElement(n,{key:e.configuration.trackId,model:t}):null})))})),re=(0,o.observer)((function({model:e}){const{classes:t}=te(),[n,o]=(0,l.useState)(),[s,m]=(0,l.useState)(),[d,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)(),f=(0,l.useRef)(null),y=(0,l.useRef)(null),E=(0,l.useRef)(0),b=(0,l.useRef)(0),g=(0,l.useRef)(!1),[v,k]=(0,l.useState)(!1),[w,A]=(0,l.useState)(!1),x=f.current?.getBoundingClientRect()||ee,S=f.current?.getBoundingClientRect()||ee,C=ne(s,x),P=ne(n,x),L=ne(h,x),M=L||P,N=h||n,T=C&&M?M[0]-C[0]:0,z=C&&M?M[1]-C[1]:0,{hview:B,vview:F,wheelMode:O,cursorMode:D}=e,$="move"===D&&!v||"crosshair"===D&&v,R="move"===D&&v||"crosshair"===D&&!v;return(0,l.useEffect)((()=>{function e(e){e.preventDefault(),E.current+=e.deltaX,b.current-=e.deltaY,g.current||(g.current=!0,window.requestAnimationFrame((()=>{(0,a.transaction)((()=>{if("pan"===O)B.scroll(E.current/3),F.scroll(b.current/10);else if("zoom"===O&&Math.abs(b.current)>2*Math.abs(E.current)&&P){const e=b.current<0?1.1:.9;B.zoomTo(B.bpPerPx*e,P[0]),F.zoomTo(F.bpPerPx*e,S.height-P[1])}})),g.current=!1,E.current=0,b.current=0})))}if(f.current){const t=f.current;return t.addEventListener("wheel",e),()=>{t.removeEventListener("wheel",e)}}return()=>{}}),[B,F,O,P,S.height]),(0,l.useEffect)((()=>{function e(e){o([e.clientX,e.clientY]),n&&s&&$&&!h&&(B.scroll(-e.clientX+n[0]),F.scroll(e.clientY-n[1]))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[$,n,s,h,B,F]),(0,l.useEffect)((()=>{function e(e){(e.metaKey||e.ctrlKey)&&A(!0)}function t(e){e.metaKey||e.ctrlKey||A(!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.addEventListener("keyup",t)}}),[]),(0,l.useEffect)((()=>{function e(e){Math.abs(T)>3&&Math.abs(z)>3&&R?p([e.clientX,e.clientY]):m(void 0)}return C&&!L?(window.addEventListener("mouseup",e,!0),()=>{window.removeEventListener("mouseup",e,!0)}):()=>{}}),[R,C,L,T,z]),l.createElement("div",null,l.createElement(I,{model:e,selection:R&&C&&M?{width:Math.abs(T),height:Math.abs(z)}:void 0}),l.createElement("div",{ref:y,className:t.root,onMouseLeave:()=>{u(!1)},onMouseEnter:()=>{u(!0)}},l.createElement("div",{className:t.container},l.createElement(c.en,{model:e}),l.createElement(c.KM,{model:e}),l.createElement("div",{ref:f,className:t.content},d&&R?l.createElement(l.Suspense,{fallback:null},l.createElement(Q,{model:e,mouserect:M,mouserectClient:N,xdistance:T})):null,R?l.createElement(l.Suspense,{fallback:null},l.createElement(U,{model:e,mousedown:C,mousedownClient:s,xdistance:T,ydistance:z})):null,l.createElement("div",{style:{cursor:w?"pointer":D},onMouseDown:e=>{if(0===e.button){const{clientX:t,clientY:n}=e;m([t,n]),o([t,n]),k(w)}}},l.createElement(i.A,{model:e},R&&C&&M?l.createElement("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(M[0],C[0]),y:Math.min(M[1],C[1]),width:Math.abs(T),height:Math.abs(z)}):null)),l.createElement("div",{className:t.spacer})),l.createElement(le,{model:e}),l.createElement(r.Menu,{open:Boolean(L),onMenuItemClick:(e,t)=>{t(),p(void 0),m(void 0)},onClose:()=>{p(void 0),m(void 0)},anchorReference:"anchorPosition",anchorPosition:h?{top:h[1]+50,left:h[0]+50}:void 0,style:{zIndex:1e4},menuItems:[{label:"Zoom in",onClick:()=>{C&&L&&e.zoomInToMouseCoords(C,L),u(!1)}},{label:"Open linear synteny view",onClick:()=>{C&&L&&e.onDotplotView(C,L),u(!1)}}]})),l.createElement(r.ResizeHandle,{onDrag:t=>e.setHeight(e.height+t),className:t.resizeHandle})))})),ae=(0,o.observer)((function({model:e}){const{initialized:t,loading:n,error:a}=e;return!t&&!n||a?l.createElement(G,{model:e}):n?l.createElement(r.LoadingEllipses,{variant:"h6"}):l.createElement(re,{model:e})}))},86495:(e,t,n)=>{n.d(t,{A:()=>c,z:()=>s});var l=n(7552),r=n(99546),a=n(48231);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)({}).hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},o.apply(null,arguments)}const s=(0,n(68446).observer)((function({model:e,children:t}){const{viewWidth:n,viewHeight:s,hview:c,vview:i}=e,m=c.dynamicBlocks.contentBlocks,d=i.dynamicBlocks.contentBlocks;if(!m.length||!d.length)return null;const u=c.displayedRegionsTotalPx-c.offsetPx,h=i.displayedRegionsTotalPx-i.offsetPx,p=m[0].offsetPx-c.offsetPx,f=d[0].offsetPx-i.offsetPx,y=(0,a.A)(),E=y.palette.divider,b=Math.max(p,0),g=Math.max(s-h,0),v=Math.min(u-p,n),k=Math.min(s-f-g,s);let w=Number.POSITIVE_INFINITY,A=Number.POSITIVE_INFINITY;return l.createElement(l.Fragment,null,l.createElement("rect",o({x:b,y:g,width:v,height:k},(0,r.getFillProps)(y.palette.background.default))),l.createElement("g",null,m.map((e=>{const t=e.offsetPx-c.offsetPx,n=Math.floor(t)!==Math.floor(w);return n&&(w=t),n?l.createElement("line",o({key:JSON.stringify(e),x1:t,y1:0,x2:t,y2:s},(0,r.getStrokeProps)(E))):null})),d.map((e=>{const t=s-(e.offsetPx-i.offsetPx),a=Math.floor(t)!==Math.floor(A);return a&&(A=t),a?l.createElement("line",o({key:JSON.stringify(e),x1:0,y1:t,x2:n,y2:t},(0,r.getStrokeProps)(E))):null})),l.createElement("line",o({x1:u,y1:0,x2:u,y2:s},(0,r.getStrokeProps)(E))),l.createElement("line",o({x1:0,y1:s-h,x2:n,y2:s-h},(0,r.getStrokeProps)(E)))),t)}));function c({model:e,children:t}){const{viewWidth:n,viewHeight:r}=e;return l.createElement("svg",{width:n,height:r,style:{background:"rgba(0,0,0,0.12)"}},l.createElement(s,{model:e},t))}}}]);
//# sourceMappingURL=3474.795fb354.chunk.js.map