{"version":3,"file":"static/js/5423.eecba592.chunk.js","mappings":"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","sources":["../../../packages/sv-core/src/util.ts","../../../plugins/alignments/src/AlignmentsFeatureDetail/LaunchPairedEndBreakpointSplitViewPanel.tsx","../../../plugins/alignments/src/AlignmentsFeatureDetail/LinkedPairedAlignments.tsx"],"sourcesContent":["import { parseBreakend } from '@gmod/vcf'\n\nimport type { Track } from './types.ts'\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport function getBreakendCoveringRegions({\n  feature,\n  assembly,\n}: {\n  feature: Feature\n  assembly: Assembly\n}) {\n  const alt = feature.get('ALT')?.[0]\n  const bnd = alt ? parseBreakend(alt) : undefined\n  const startPos = feature.get('start')\n  const refName = feature.get('refName')\n  const f = (ref: string) => assembly.getCanonicalRefName(ref) || ref\n\n  if (alt === '<TRA>') {\n    const INFO = feature.get('INFO')\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(INFO.CHR2[0]),\n      matePos: INFO.END[0] - 1,\n    }\n  } else if (bnd?.MatePosition) {\n    const matePosition = bnd.MatePosition.split(':')\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(matePosition[0]!),\n      matePos: +matePosition[1]! - 1,\n    }\n  } else if (feature.get('mate')) {\n    const mate = feature.get('mate')\n    const strand = feature.get('strand')\n    const mateStrand = mate.strand\n    // Use the correct \"side\" of the feature based on strand:\n    // Forward strand (1): use end position (right side)\n    // Reverse strand (-1): use start position (left side)\n    const pos = strand === 1 ? feature.get('end') : startPos\n    const matePos = mateStrand === 1 ? mate.start : (mate.end ?? mate.start)\n    return {\n      pos,\n      refName: f(refName),\n      mateRefName: f(mate.refName),\n      matePos,\n    }\n  } else {\n    return {\n      pos: startPos,\n      refName: f(refName),\n      mateRefName: f(refName),\n      matePos: feature.get('end'),\n    }\n  }\n}\n\nexport function stripIds(arr: Track[]) {\n  return arr.map(({ id, displays, ...rest }) => ({\n    ...rest,\n    displays: displays.map(({ id, ...rest }) => rest),\n  }))\n}\n\nexport function makeTitle(f: Feature) {\n  return `${f.get('name') || f.get('id') || 'breakend'} split detail`\n}\n\nexport interface Region {\n  refName: string\n  start: number\n  end: number\n  assemblyName?: string\n}\n\nexport interface ViewWithAssemblyNames {\n  assemblyNames: string[]\n}\n\n/**\n * Safely extracts the first assemblyName from a view's assemblyNames getter.\n * Returns undefined if the view or assemblyNames are not available.\n */\nexport function getAssemblyName(view?: ViewWithAssemblyNames) {\n  return view?.assemblyNames[0]\n}\n\n/**\n * Splits a region at a breakend position into two overlapping regions.\n *\n * JBrowse uses 0-based, half-open coordinates where `end` is exclusive.\n * To ensure the breakend position is visible in both regions:\n * - Left region: ends at pos + 1 (includes position pos)\n * - Right region: starts at pos (includes position pos)\n *\n * This intentional overlap ensures features at the breakend are displayed.\n */\nexport function splitRegionAtPosition<\n  T extends { refName: string; start: number; end: number },\n>(\n  region: T,\n  pos: number,\n  assemblyName?: string,\n): [T & { assemblyName?: string }, T & { assemblyName?: string }] {\n  return [\n    {\n      ...region,\n      end: pos + 1,\n      ...(assemblyName !== undefined && { assemblyName }),\n    },\n    {\n      ...region,\n      start: pos,\n      ...(assemblyName !== undefined && { assemblyName }),\n    },\n  ]\n}\n","import { lazy } from 'react'\n\nimport { SimpleFeature, getSession, toLocale } from '@jbrowse/core/util'\nimport { getAssemblyName } from '@jbrowse/sv-core'\nimport { Link, Typography } from '@mui/material'\n\nimport type { AlignmentFeatureWidgetModel } from './stateModelFactory.ts'\nimport type { SimpleFeatureSerialized } from '@jbrowse/core/util'\n\nconst BreakpointSplitViewChoiceDialog = lazy(\n  () => import('./BreakpointSplitViewChoiceDialog.tsx'),\n)\n\nexport default function LaunchPairedEndBreakpointSplitViewPanel({\n  model,\n  feature,\n}: {\n  model: AlignmentFeatureWidgetModel\n  feature: SimpleFeatureSerialized\n}) {\n  const session = getSession(model)\n  const f1 = {\n    uniqueId: feature.uniqueId,\n    refName: feature.refName,\n    start: feature.start,\n    end: feature.end,\n    strand: feature.strand,\n  }\n  const f2 = {\n    uniqueId: `${feature.id}-mate`,\n    refName: feature.next_ref as string,\n    start: feature.next_pos as number,\n    end: (feature.next_pos as number) + 1,\n    strand: feature.strand as number,\n  }\n  const assemblyName = getAssemblyName(model.view)\n  return assemblyName ? (\n    <div>\n      <Typography>Launch split view</Typography>\n      <ul>\n        <li>\n          {f1.refName}:{toLocale(f1.start)} -&gt; {f2.refName}:\n          {toLocale(f2.start)}{' '}\n          <Link\n            href=\"#\"\n            onClick={event => {\n              event.preventDefault()\n              session.queueDialog(handleClose => [\n                BreakpointSplitViewChoiceDialog,\n                {\n                  handleClose,\n                  session,\n                  feature: new SimpleFeature({ ...f1, mate: f2 }),\n                  view: model.view,\n                  assemblyName,\n                },\n              ])\n            }}\n          >\n            (breakpoint split view)\n          </Link>\n        </li>\n      </ul>\n    </div>\n  ) : null\n}\n","import BaseCard from '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail/BaseCard'\nimport { getEnv, getSession } from '@jbrowse/core/util'\n\nimport LaunchPairedEndBreakpointSplitViewPanel from './LaunchPairedEndBreakpointSplitViewPanel.tsx'\n\nimport type { AlignmentFeatureWidgetModel } from './stateModelFactory.ts'\nimport type { SimpleFeatureSerialized } from '@jbrowse/core/util'\n\nexport default function SuppAlignments(props: {\n  model: AlignmentFeatureWidgetModel\n  feature: SimpleFeatureSerialized\n}) {\n  const { model, feature } = props\n  const session = getSession(model)\n  const { pluginManager } = getEnv(session)\n  let hasBreakendSplitView = false\n\n  try {\n    hasBreakendSplitView = !!pluginManager.getViewType('BreakpointSplitView')\n  } catch (e) {\n    // ignore\n  }\n  return hasBreakendSplitView ? (\n    <BaseCard {...props} title=\"Paired alignments\">\n      <LaunchPairedEndBreakpointSplitViewPanel\n        model={model}\n        feature={feature}\n      />\n    </BaseCard>\n  ) : null\n}\n"],"names":["getBreakendCoveringRegions","feature","assembly","alt","get","bnd","parseBreakend","undefined","startPos","refName","f","ref","getCanonicalRefName","INFO","pos","mateRefName","CHR2","matePos","END","MatePosition","matePosition","split","mate","strand","mateStrand","start","end","stripIds","arr","map","id","displays","rest","makeTitle","getAssemblyName","view","assemblyNames","splitRegionAtPosition","region","assemblyName","BreakpointSplitViewChoiceDialog","lazy","LaunchPairedEndBreakpointSplitViewPanel","t0","$","_c","model","t1","getSession","session","t2","next_pos","next_ref","uniqueId","f1","f2","t3","_jsxs","children","_jsx","Typography","toLocale","Link","href","onClick","event","preventDefault","queueDialog","handleClose","SimpleFeature","SuppAlignments","props","hasBreakendSplitView","pluginManager","getEnv","getViewType","BaseCard","title"],"ignoreList":[],"sourceRoot":""}