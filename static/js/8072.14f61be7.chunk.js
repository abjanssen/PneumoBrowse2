"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8072],{18072:(e,t,n)=>{n.r(t),n.d(t,{default:()=>he});var s=n(7552),o=n(67112),r=n(42489),i=n(68446),l=n(75785),a=n(91392),c=n(86495),d=n(99546),m=n(61282),h=n(23758),u=n(90542),x=n(41545),p=n(29743),f=n(2020),y=n(24e3),g=n(17914),b=n(1485),j=n(89870),v=n(67758),w=n(94874),k=n(69500);function A(e){const t=(0,v.c)(3);let n,s;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,k.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"}),t[0]=n):n=t[0],t[1]!==e?(s=(0,k.jsx)(w.A,{...e,children:n}),t[1]=e,t[2]=s):s=t[2],s}function S(e){const t=(0,v.c)(3);let n,s;return t[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,k.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"}),t[0]=n):n=t[0],t[1]!==e?(s=(0,k.jsx)(w.A,{...e,children:n}),t[1]=e,t[2]=s):s=t[2],s}const C=(0,i.observer)((function({model:e}){return(0,k.jsxs)("div",{children:[(0,k.jsx)(j.A,{onClick:()=>{e.zoomOut()},children:(0,k.jsx)(b.A,{})}),(0,k.jsx)(j.A,{onClick:()=>{e.zoomIn()},children:(0,k.jsx)(g.A,{})}),(0,k.jsx)(j.A,{onClick:()=>e.activateTrackSelector(),title:"Open track selector",children:(0,k.jsx)(u.xU,{})}),(0,k.jsx)(h.A,{menuItems:[{label:"Square view - same bp per pixel",icon:x.A,onClick:()=>{e.squareView()}},{label:"Rectangular view - same total bp",icon:p.A,onClick:()=>{e.squareViewProportional()}},{label:"Show all regions",icon:y.A,onClick:()=>{e.showAllRegions()}},{type:"checkbox",label:"Draw CIGAR",checked:e.drawCigar,onClick:()=>{e.setDrawCigar(!e.drawCigar)}},{label:"Show pan buttons",type:"checkbox",checked:e.showPanButtons,onClick:()=>{e.setShowPanButtons(!e.showPanButtons)}},{label:"Click and drag mode",subMenu:[{label:"Pan by default, select region when ctrl/cmd key is held",icon:A,type:"radio",checked:"move"===e.cursorMode,onClick:()=>{e.setCursorMode("move")}},{label:"Select region by default, pan when ctrl/cmd key is held",icon:S,type:"radio",checked:"crosshair"===e.cursorMode,onClick:()=>{e.setCursorMode("crosshair")}}]},{label:"Wheel scroll mode",subMenu:[{label:"Pans view",type:"radio",checked:"pan"===e.wheelMode,onClick:()=>{e.setWheelMode("pan")}},{label:"Zooms view",type:"radio",checked:"zoom"===e.wheelMode,onClick:()=>{e.setWheelMode("zoom")}},{label:"Disable",type:"radio",checked:"none"===e.wheelMode,onClick:()=>{e.setWheelMode("none")}}]}],children:(0,k.jsx)(f.A,{})})]})}));var L=n(28194),P=n(69092);const M=(0,s.lazy)((()=>Promise.all([n.e(2407),n.e(6275),n.e(7884)]).then(n.bind(n,75083)))),N=(0,i.observer)((function({model:e}){const t=e.tracks.filter((e=>e.displays[0].warnings?.length)),[n,o]=(0,s.useState)(!1),[r,i]=(0,s.useState)(!1);return t.length&&!r?(0,k.jsxs)(L.A,{severity:"warning",children:["Warnings during render"," ",(0,k.jsx)(P.A,{onClick:()=>{o(!0)},children:"More info"}),n?(0,k.jsx)(M,{trackWarnings:t,handleClose:()=>{o(!1)}}):null,(0,k.jsx)(P.A,{variant:"contained",onClick:()=>{i(!0)},children:"Dismiss"})]}):null}));var z=n(61968),T=n(25237),I=n(34836),B=n(68527),F=n(95054);const E=(0,l.n9)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:500,top:50},icon:{padding:0,margin:0}}),$=(0,i.observer)((function({model:e}){const{classes:t}=E();return(0,k.jsxs)(F.A,{className:t.dpad,elevation:6,children:[(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.vview.scroll(100)},children:(0,k.jsx)(T.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.hview.scroll(-100)},children:(0,k.jsx)(I.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.hview.scroll(100)},children:(0,k.jsx)(B.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.vview.scroll(-100)},children:(0,k.jsx)(z.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.zoomIn()},children:(0,k.jsx)(g.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.zoomOut()},children:(0,k.jsx)(b.A,{})})]})})),R=(0,l.n9)()({bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),O=(0,i.observer)((function({model:e,selection:t}){const{classes:n}=R(),{hview:s,vview:o,showPanButtons:r}=e;return(0,k.jsxs)("div",{className:n.headerBar,children:[(0,k.jsx)(C,{model:e}),(0,k.jsxs)(m.A,{className:n.bp,variant:"body2",color:"textSecondary",children:["x: ",s.assemblyNames.join(",")," ",(0,d.getBpDisplayStr)(s.currBp),(0,k.jsx)("br",{}),"y: ",o.assemblyNames.join(",")," ",(0,d.getBpDisplayStr)(o.currBp)]}),t?(0,k.jsxs)(m.A,{className:n.bp,variant:"body2",color:"textSecondary",children:[`width:${(0,d.getBpDisplayStr)(s.bpPerPx*t.width)}`," ",(0,k.jsx)("br",{}),`height:${(0,d.getBpDisplayStr)(o.bpPerPx*t.height)}`]}):null,(0,k.jsx)("div",{className:n.spacer}),(0,k.jsx)(N,{model:e}),r?(0,k.jsx)($,{model:e}):null]})}));var D=n(59570),V=n(92826),H=n(91818),q=n(51870),W=n(94540),_=n(7946),Y=n(94332),J=n(15897),X=n(37962);function K({radioOption:e,assembly1:t,assembly2:n,fileLocation:s,indexFileLocation:o,bed1Location:r,bed2Location:i}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:s,queryAssembly:t,targetAssembly:n};if(".out"===e)return{type:"MashMapAdapter",outLocation:s,queryAssembly:t,targetAssembly:n};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:s,queryAssembly:t,targetAssembly:n};if(".chain"===e)return{type:"ChainAdapter",chainLocation:s,queryAssembly:t,targetAssembly:n};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:s,bed1Location:r,bed2Location:i,assemblyNames:[t,n]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:s,bed1Location:r,bed2Location:i,assemblyNames:[t,n]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:s,index:{location:o},assemblyNames:[t,n]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}const U=(0,i.observer)((function({model:e,assembly1:t,assembly2:n}){const[r,i]=(0,s.useState)(!1),[l,a]=(0,s.useState)(),[c,d]=(0,s.useState)(),[h,u]=(0,s.useState)(),[x,p]=(0,s.useState)(),[f,y]=(0,s.useState)(""),[g,b]=(0,s.useState)(),j=(v=h)?v.uri||v.localPath||v.name:void 0;var v;const w=f||(j?function(e){const t=e.split(".").pop();return t?`.${t}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(j)):"");return(0,s.useEffect)((()=>{try{if(h){const s=j?j.split("#")[0].split("?")[0].split("/").pop():"MyTrack",o=`${s}-${Date.now()}-sessionTrack`;b(void 0),e.setImportFormSyntenyTrack(0,{type:"userOpened",value:{trackId:o,name:s,assemblyNames:[n,t],type:"SyntenyTrack",adapter:K({radioOption:w,assembly1:r?n:t,assembly2:r?t:n,fileLocation:h,indexFileLocation:x,bed1Location:c,bed2Location:l})}})}}catch(e){console.error(e),b(e)}}),[r,e,j,t,n,c,l,h,x,w]),(0,k.jsxs)(F.A,{style:{padding:12},children:[g?(0,k.jsx)(o.ErrorMessage,{error:g}):null,(0,k.jsx)(m.A,{style:{textAlign:"center"},children:"Add a .paf (minimap2), .delta (Mummer), .chain (UCSC liftover), .anchors or .anchors.simple (MCScan), or .pif.gz (jbrowse CLI make-pif) file to view. These file types can also be gzipped."}),(0,k.jsx)(W.A,{value:w,onChange:e=>{y(e.target.value)},children:(0,k.jsx)(V.A,{container:!0,justifyContent:"center",children:[".paf",".delta",".out",".chain",".anchors",".anchors.simple",".pif.gz"].map((e=>(0,k.jsx)(_.A,{value:e,control:(0,k.jsx)(Y.A,{}),label:e},e)))})}),(0,k.jsx)(V.A,{container:!0,justifyContent:"center",children:".paf"===w||".out"===w||".delta"===w||".chain"===w||".pif.gz"===w?(0,k.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,k.jsx)(o.FileSelector,{name:`${w} location`,inline:!0,description:"",location:h,setLocation:e=>{u(e)}}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{children:["Verify or click swap",(0,k.jsx)(X.A,{title:(0,k.jsx)("code",{children:{".paf":"minimap2 target.fa query.fa",".pif.gz":"minimap2 target.fa query.fa",".out":"mashmap target.fa query.fa",".delta":"mummer target.fa query.fa",".chain":"e.g. queryToTarget.chain"}[w]}),children:(0,k.jsx)(J.A,{})})]}),(0,k.jsxs)("div",{style:{display:"flex",gap:20},children:[(0,k.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"},children:[(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:r?n:t})}),(0,k.jsx)("div",{children:"query assembly"}),(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:r?t:n})}),(0,k.jsx)("div",{children:"target assembly"})]}),(0,k.jsx)(P.A,{variant:"contained",onClick:()=>{i(!r)},children:"Swap?"})]})]})]}):".anchors"===f||".anchors.simple"===f?(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{style:{margin:20},children:["Open the ",f," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,k.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)(o.FileSelector,{inline:!0,name:f,location:h,setLocation:e=>{u(e)}}),(0,k.jsx)(o.FileSelector,{inline:!0,name:"genome 1 .bed (left column of anchors file)",description:"",location:c,setLocation:e=>{d(e)}}),(0,k.jsx)(o.FileSelector,{inline:!0,name:"genome 2 .bed (right column of anchors file)",description:"",location:l,setLocation:e=>{a(e)}})]}),(0,k.jsxs)("div",{style:{margin:"auto",display:"flex",justifyContent:"center",gap:20},children:[(0,k.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"},children:[(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:r?n:t})}),(0,k.jsx)("div",{children:"bed1 assembly"}),(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:r?t:n})}),(0,k.jsx)("div",{children:"bed2 assembly"})]}),(0,k.jsx)(P.A,{variant:"contained",onClick:()=>{i(!r)},children:"Swap?"})]})]}):".pif.gz"===f?(0,k.jsxs)("div",{style:{display:"flex"},children:[(0,k.jsx)("div",{children:(0,k.jsx)(o.FileSelector,{name:`${f} location`,description:"",location:h,setLocation:e=>{u(e)}})}),(0,k.jsx)("div",{children:(0,k.jsx)(o.FileSelector,{name:`${f} index location`,description:"",location:x,setLocation:e=>{p(e)}})})]}):(0,k.jsx)(o.FileSelector,{name:f?`${f} location`:"",description:"",location:h,setLocation:e=>{u(e)}})})]})}));var Z=n(68584),G=n(91468),Q=n(21049),ee=n(10240);const te=(0,i.observer)((function({model:e,assembly1:t,assembly2:n}){const r=(0,d.getSession)(e),{tracks:i,sessionTracks:l}=r,a=[...i,...l||[]].filter((e=>function(e,t,n){const s=(0,Z.readConfObject)(e,"assemblyNames");return s.includes(t)&&s.includes(n)&&e.type.includes("Synteny")}(e,n,t))),c=a[0]?.trackId||"",[h,x]=(0,s.useState)(c);return(0,s.useEffect)((()=>{x(c)}),[c]),(0,s.useEffect)((()=>{e.setImportFormSyntenyTrack(0,{type:"preConfigured",value:h})}),[e,h]),(0,k.jsxs)(F.A,{style:{padding:12},children:[(0,k.jsxs)(m.A,{children:['Select a track from the select box below, the track will be shown when you hit "Launch". Note: there is a track selector ',(0,k.jsx)("i",{children:"inside"})," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon"," ",(0,k.jsx)(u.xU,{})]}),a.length?(0,k.jsx)(Q.A,{value:h,onChange:e=>{x(e.target.value)},children:a.map((e=>(0,k.jsx)(ee.A,{value:e.trackId,children:(0,G.getTrackName)(e,r)},e.trackId)))}):(0,k.jsx)(o.ErrorMessage,{error:`No synteny tracks found for ${t},${n}`})]})})),ne=(0,i.observer)((function({assembly1:e,assembly2:t,model:n}){const[o,r]=(0,s.useState)("tracklist");return(0,s.useEffect)((()=>{"none"===o&&n.setImportFormSyntenyTrack(0,{type:"none"})}),[n,o]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(H.A,{children:[(0,k.jsx)(q.A,{id:"group-label",children:"(Optional) Select or add a synteny track"}),(0,k.jsxs)(W.A,{row:!0,value:o,onChange:e=>{r(e.target.value)},"aria-labelledby":"group-label",children:[(0,k.jsx)(_.A,{value:"none",control:(0,k.jsx)(Y.A,{}),label:"None"}),(0,k.jsx)(_.A,{value:"tracklist",control:(0,k.jsx)(Y.A,{}),label:"Existing track"}),(0,k.jsx)(_.A,{value:"custom",control:(0,k.jsx)(Y.A,{}),label:"New track"})]})]}),"custom"===o?(0,k.jsx)(U,{model:n,assembly2:t,assembly1:e}):null,"tracklist"===o?(0,k.jsx)(te,{model:n,assembly1:e,assembly2:t}):null]})})),se=(0,l.n9)()((e=>({importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}}))),oe=(0,i.observer)((function({model:e}){const{classes:t}=se(),n=(0,d.getSession)(e),{assemblyNames:i}=n,[l,a]=(0,s.useState)(i[0]||""),[c,h]=(0,s.useState)(i[0]||""),[u,x]=(0,s.useState)(),p=u||e.error;return(0,k.jsxs)(D.A,{className:t.importFormContainer,children:[p?(0,k.jsx)(o.ErrorMessage,{error:p}):null,(0,k.jsxs)(F.A,{style:{padding:12},children:[(0,k.jsx)(m.A,{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,k.jsxs)(V.A,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,k.jsx)(o.AssemblySelector,{helperText:"x-axis assembly",selected:l,session:n,onChange:e=>{a(e)}}),(0,k.jsx)(o.AssemblySelector,{helperText:"y-axis assembly",selected:c,session:n,onChange:e=>{h(e)}}),(0,k.jsx)(H.A,{children:(0,k.jsx)(P.A,{onClick:()=>{(async()=>{try{x(void 0),function({model:e,assembly1:t,assembly2:n}){const s=(0,d.getSession)(e),{importFormSyntenyTrackSelections:o}=e;e.setError(void 0),(0,r.transaction)((()=>{(0,d.isSessionWithAddTracks)(s)&&(0,r.toJS)(o).map(((t,n)=>{"userOpened"===t.type?(s.addTrackConf(t.value),e.toggleTrack(t.value?.trackId)):"preConfigured"===t.type&&e.showTrack(t.value,n)})),e.showAllRegions(),e.setAssemblyNames(n,t)}))}({assembly1:c,assembly2:l,model:e})}catch(e){console.error(e),x(e)}})()},variant:"contained",color:"primary",children:"Launch"})})]}),(0,k.jsx)(ne,{assembly2:l,assembly1:c,model:e})]})]})})),re=(0,s.lazy)((()=>n.e(1304).then(n.bind(n,81304)))),ie=(0,s.lazy)((()=>n.e(1051).then(n.bind(n,21051)))),le={left:0,top:0,width:0,height:0},ae=(0,l.n9)()((e=>({spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}})));function ce(e,t){return e&&[e[0]-t.left,e[1]-t.top]}const de=(0,i.observer)((({model:e})=>{const{classes:t}=ae();return(0,k.jsx)("div",{className:t.overlay,children:e.tracks.map((e=>{const[t]=e.displays,{RenderingComponent:n}=t;return n?(0,k.jsx)(n,{model:t},e.configuration.trackId):null}))})})),me=(0,i.observer)((function({model:e}){const{classes:t}=ae(),[n,i]=(0,s.useState)(),[l,d]=(0,s.useState)(),[m,h]=(0,s.useState)(!1),[u,x]=(0,s.useState)(),p=(0,s.useRef)(null),f=(0,s.useRef)(null),y=(0,s.useRef)(0),g=(0,s.useRef)(0),b=(0,s.useRef)(!1),[j,v]=(0,s.useState)(!1),[w,A]=(0,s.useState)(!1),S=p.current?.getBoundingClientRect()||le,C=p.current?.getBoundingClientRect()||le,L=ce(l,S),P=ce(n,S),M=ce(u,S),N=M||P,z=u||n,T=L&&N?N[0]-L[0]:0,I=L&&N?N[1]-L[1]:0,{hview:B,vview:F,wheelMode:E,cursorMode:$}=e,R="move"===$&&!j||"crosshair"===$&&j,D="move"===$&&j||"crosshair"===$&&!j;return(0,s.useEffect)((()=>{function e(e){e.preventDefault(),y.current+=e.deltaX,g.current-=e.deltaY,b.current||(b.current=!0,window.requestAnimationFrame((()=>{(0,r.transaction)((()=>{if("pan"===E)B.scroll(y.current/3),F.scroll(g.current/10);else if("zoom"===E&&Math.abs(g.current)>2*Math.abs(y.current)&&P){const e=g.current<0?1.1:.9;B.zoomTo(B.bpPerPx*e,P[0]),F.zoomTo(F.bpPerPx*e,C.height-P[1])}})),b.current=!1,y.current=0,g.current=0})))}if(p.current){const t=p.current;return t.addEventListener("wheel",e),()=>{t.removeEventListener("wheel",e)}}return()=>{}}),[B,F,E,P,C.height]),(0,s.useEffect)((()=>{function e(e){i([e.clientX,e.clientY]),n&&l&&R&&!u&&(B.scroll(-e.clientX+n[0]),F.scroll(e.clientY-n[1]))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[R,n,l,u,B,F]),(0,s.useEffect)((()=>{function e(e){(e.metaKey||e.ctrlKey)&&A(!0)}function t(e){e.metaKey||e.ctrlKey||A(!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.addEventListener("keyup",t)}}),[]),(0,s.useEffect)((()=>{function e(e){Math.abs(T)>3&&Math.abs(I)>3&&D?x([e.clientX,e.clientY]):d(void 0)}return L&&!M?(window.addEventListener("mouseup",e,!0),()=>{window.removeEventListener("mouseup",e,!0)}):()=>{}}),[D,L,M,T,I]),(0,k.jsxs)("div",{children:[(0,k.jsx)(O,{model:e,selection:D&&L&&N?{width:Math.abs(T),height:Math.abs(I)}:void 0}),(0,k.jsxs)("div",{ref:f,className:t.root,onMouseLeave:()=>{h(!1)},onMouseEnter:()=>{h(!0)},children:[(0,k.jsxs)("div",{className:t.container,children:[(0,k.jsx)(a.en,{model:e}),(0,k.jsx)(a.KM,{model:e}),(0,k.jsxs)("div",{ref:p,className:t.content,children:[m&&D?(0,k.jsx)(s.Suspense,{fallback:null,children:(0,k.jsx)(ie,{model:e,mouserect:N,mouserectClient:z,xdistance:T})}):null,D?(0,k.jsx)(s.Suspense,{fallback:null,children:(0,k.jsx)(re,{model:e,mousedown:L,mousedownClient:l,xdistance:T,ydistance:I})}):null,(0,k.jsx)("div",{style:{cursor:w?"pointer":$},onMouseDown:e=>{if(0===e.button){const{clientX:t,clientY:n}=e;d([t,n]),i([t,n]),v(w)}},children:(0,k.jsx)(c.A,{model:e,children:D&&L&&N?(0,k.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(N[0],L[0]),y:Math.min(N[1],L[1]),width:Math.abs(T),height:Math.abs(I)}):null})}),(0,k.jsx)("div",{className:t.spacer})]}),(0,k.jsx)(de,{model:e}),(0,k.jsx)(o.Menu,{open:Boolean(M),onMenuItemClick:(e,t)=>{t(),x(void 0),d(void 0)},onClose:()=>{x(void 0),d(void 0)},anchorReference:"anchorPosition",anchorPosition:u?{top:u[1]+50,left:u[0]+50}:void 0,style:{zIndex:800},menuItems:[{label:"Zoom in",onClick:()=>{L&&M&&e.zoomInToMouseCoords(L,M),h(!1)}},{label:"Open linear synteny view",onClick:()=>{L&&M&&e.onDotplotView(L,M),h(!1)}}]})]}),(0,k.jsx)(o.ResizeHandle,{onDrag:t=>e.setHeight(e.height+t),className:t.resizeHandle})]})]})})),he=(0,i.observer)((function({model:e}){const{initialized:t,loading:n,error:s}=e;return!t&&!n||s?(0,k.jsx)(oe,{model:e}):n?(0,k.jsx)(o.LoadingEllipses,{variant:"h6"}):(0,k.jsx)(me,{model:e})}))},86495:(e,t,n)=>{n.d(t,{A:()=>c,z:()=>a});var s=n(67758),o=n(99546),r=n(51414),i=n(68446),l=n(69500);const a=(0,i.observer)((function({model:e,children:t}){const{viewWidth:n,viewHeight:s,hview:i,vview:a}=e,c=i.dynamicBlocks.contentBlocks,d=a.dynamicBlocks.contentBlocks;if(!c.length||!d.length)return null;const m=i.displayedRegionsTotalPx-i.offsetPx,h=a.displayedRegionsTotalPx-a.offsetPx,u=c[0].offsetPx-i.offsetPx,x=d[0].offsetPx-a.offsetPx,p=(0,r.A)(),f=p.palette.divider,y=Math.max(u,0),g=Math.max(s-h,0),b=Math.min(m-u,n),j=Math.min(s-x-g,s);let v=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("rect",{x:y,y:g,width:b,height:j,...(0,o.getFillProps)(p.palette.background.default)}),(0,l.jsxs)("g",{children:[c.map((e=>{const t=e.offsetPx-i.offsetPx,n=Math.floor(t)!==Math.floor(v);return n&&(v=t),n?(0,l.jsx)("line",{x1:t,y1:0,x2:t,y2:s,...(0,o.getStrokeProps)(f)},JSON.stringify(e)):null})),d.map((e=>{const t=s-(e.offsetPx-a.offsetPx),r=Math.floor(t)!==Math.floor(w);return r&&(w=t),r?(0,l.jsx)("line",{x1:0,y1:t,x2:n,y2:t,...(0,o.getStrokeProps)(f)},JSON.stringify(e)):null})),(0,l.jsx)("line",{x1:m,y1:0,x2:m,y2:s,...(0,o.getStrokeProps)(f)}),(0,l.jsx)("line",{x1:0,y1:s-h,x2:n,y2:s-h,...(0,o.getStrokeProps)(f)})]}),t]})}));function c(e){const t=(0,s.c)(8),{model:n,children:o}=e,{viewWidth:r,viewHeight:i}=n;let c,d,m;return t[0]===Symbol.for("react.memo_cache_sentinel")?(c={background:"rgba(0,0,0,0.12)"},t[0]=c):c=t[0],t[1]!==o||t[2]!==n?(d=(0,l.jsx)(a,{model:n,children:o}),t[1]=o,t[2]=n,t[3]=d):d=t[3],t[4]!==d||t[5]!==i||t[6]!==r?(m=(0,l.jsx)("svg",{width:r,height:i,style:c,children:d}),t[4]=d,t[5]=i,t[6]=r,t[7]=m):m=t[7],m}},91392:(e,t,n)=>{n.d(t,{KM:()=>h,en:()=>x,kb:()=>p,se:()=>u});var s=n(99546),o=n(95095),r=n(51414),i=n(68446),l=n(36422),a=n(75785),c=n(90257),d=n(69500);const m=(0,a.n9)()((()=>({vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}}))),h=(0,i.observer)((function({model:e}){const{viewWidth:t,borderY:n}=e,{classes:s}=m();return(0,d.jsx)("svg",{width:t,height:n,className:s.htext,children:(0,d.jsx)(u,{model:e})})})),u=(0,i.observer)((function({model:e}){const{viewWidth:t,borderX:n,borderY:i,hview:a,htextRotation:m,hticks:h}=e,{offsetPx:u,width:x,dynamicBlocks:p,bpPerPx:f}=a,y=p.contentBlocks,g=(0,c.rQ)(y,t,u),b=(0,r.A)(),j={...(0,l.getSnapshot)(a),width:x,staticBlocks:a.staticBlocks},v=h.map((e=>[e,(0,o.eB)({refName:e.refName,coord:e.base,self:j})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-u]));return(0,d.jsxs)(d.Fragment,{children:[y.filter((e=>!g.has(e.key))).map((e=>{const t=e.offsetPx,n=Math.floor(t-a.offsetPx);return(0,d.jsx)("text",{transform:`rotate(${m},${n},0)`,x:n,y:1,fontSize:11,dominantBaseline:"hanging",textAnchor:"end",...(0,s.getFillProps)(b.palette.text.primary),children:e.refName},JSON.stringify(e))})),v.map((([e,t])=>t>0&&t<x?(0,d.jsx)("line",{x1:t,x2:t,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,...(0,s.getFillProps)(b.palette.text.primary)},`line-${JSON.stringify(e)}`):null)),v.filter((e=>"major"===e[0].type)).map((([e,t])=>t>10&&t<x?(0,d.jsx)("text",{x:t-7,y:0,transform:`rotate(${m},${t},0)`,fontSize:11,dominantBaseline:"middle",textAnchor:"end",...(0,s.getFillProps)(b.palette.text.primary),children:(0,s.getTickDisplayStr)(e.base+1,f)},`text-${JSON.stringify(e)}`):null)),(0,d.jsx)("text",{y:i-12,x:(t-n)/2,textAnchor:"middle",fontSize:11,dominantBaseline:"hanging",...(0,s.getFillProps)(b.palette.text.primary),children:a.assemblyNames.join(",")})]})})),x=(0,i.observer)((function({model:e}){const{borderX:t,viewHeight:n}=e,{classes:s}=m();return(0,d.jsx)("svg",{className:s.vtext,width:t,height:n,children:(0,d.jsx)(p,{model:e})})})),p=(0,i.observer)((function({model:e}){const{viewHeight:t,borderX:n,borderY:i,vview:a,vtextRotation:m,vticks:h}=e,{offsetPx:u,width:x,dynamicBlocks:p,bpPerPx:f}=a,y=p.contentBlocks,g=(0,c.rQ)(y,t,u),b=(0,r.A)(),j={...(0,l.getSnapshot)(a),width:x,staticBlocks:a.staticBlocks},v=h.map((e=>[e,(0,o.eB)({refName:e.refName,coord:e.base,self:j})?.offsetPx])).filter((e=>void 0!==e[1])).map((e=>[e[0],e[1]-u]));return(0,d.jsxs)(d.Fragment,{children:[y.filter((e=>!g.has(e.key))).map((e=>{const o=e.offsetPx,r=n,i=Math.floor(t-o+u);return(0,d.jsx)("text",{transform:`rotate(${m},${r},${o})`,x:r,y:i,fontSize:11,textAnchor:"end",...(0,s.getFillProps)(b.palette.text.primary),children:e.refName},JSON.stringify(e))})),v.map((([e,o])=>o>0?(0,d.jsx)("line",{y1:t-o,y2:t-o,x1:n,x2:n-("major"===e.type?6:4),strokeWidth:1,...(0,s.getStrokeProps)(b.palette.grey[400])},`line-${JSON.stringify(e)}`):null)),v.filter((e=>"major"===e[0].type)).map((([e,o])=>o>10&&o<t?(0,d.jsx)("text",{y:t-o-3,x:n-7,textAnchor:"end",dominantBaseline:"hanging",fontSize:11,...(0,s.getFillProps)(b.palette.text.primary),children:(0,s.getTickDisplayStr)(e.base+1,f)},`text-${JSON.stringify(e)}`):null)),(0,d.jsx)("text",{y:(t-i)/2,x:12,transform:`rotate(-90,12,${(t-i)/2})`,textAnchor:"middle",fontSize:11,...(0,s.getFillProps)(b.palette.text.primary),children:a.assemblyNames.join(",")})]})}))}}]);
//# sourceMappingURL=8072.14f61be7.chunk.js.map