"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[450],{80450:(e,s,t)=>{t.r(s),t.d(s,{default:()=>G});var a=t(7552),n=t(67112),o=t(99546),i=t(59570),l=t(68446),r=t(75785),c=t(67758),d=t(7946),m=t(94332),p=t(91818),y=t(94540),b=t(95054),u=t(61282),h=t(92826);function f({radioOption:e,assembly1:s,assembly2:t,fileLocation:a,indexFileLocation:n,bed1Location:o,bed2Location:i}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:a,queryAssembly:s,targetAssembly:t};if(".out"===e)return{type:"MashMapAdapter",outLocation:a,queryAssembly:s,targetAssembly:t};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:a,queryAssembly:s,targetAssembly:t};if(".chain"===e)return{type:"ChainAdapter",chainLocation:a,queryAssembly:s,targetAssembly:t};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:a,bed1Location:o,bed2Location:i,assemblyNames:[s,t]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:a,bed1Location:o,bed2Location:i,assemblyNames:[s,t]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:a,index:{location:n},assemblyNames:[s,t]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}var x=t(15897),j=t(37962);const g={".paf":"minimap2 target.fa query.fa",".pif.gz":"minimap2 target.fa query.fa",".out":"mashmap target.fa query.fa",".delta":"mummer target.fa query.fa",".chain":"e.g. queryToTarget.chain"};var w=t(69092),v=t(69500);const A=(0,r.n9)()({row:{display:"flex",gap:20},swap:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"}}),S=(0,l.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:a,radioOption:n,helpContent:o,text1:i,text2:l}){const{classes:r}=A();return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{children:["Verify or click swap",(0,v.jsx)(j.A,{title:o||(0,v.jsx)("code",{children:g[n]}),children:(0,v.jsx)(x.A,{})})]}),(0,v.jsxs)("div",{className:r.row,children:[(0,v.jsxs)("div",{className:r.swap,children:[(0,v.jsx)("div",{children:(0,v.jsx)("i",{children:t?s:e})}),(0,v.jsx)("div",{children:i}),(0,v.jsx)("div",{children:(0,v.jsx)("i",{children:t?e:s})}),(0,v.jsx)("div",{children:l})]}),(0,v.jsx)(w.A,{variant:"contained",onClick:()=>{a&&a(!t)},children:"Swap?"})]})]})}),L=(0,l.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:a,fileLocation:o,setFileLocation:i,radioOption:l}){return(0,v.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,v.jsx)(n.FileSelector,{name:`${l} location`,inline:!0,description:"",location:o,setLocation:i}),(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{children:["Verify or click swap",(0,v.jsx)(j.A,{title:(0,v.jsx)("code",{children:g[l]}),children:(0,v.jsx)(x.A,{})})]}),(0,v.jsx)(S,{swap:t,radioOption:l,assembly1:e,assembly2:s,setSwap:a,text1:"query assembly",text2:"target assembly"})]})]})}),k=(0,l.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:a,fileLocation:o,setFileLocation:i,indexFileLocation:l,setIndexFileLocation:r=()=>{},radioOption:c}){return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{style:{margin:20},children:["Open the ",c," and .pif.gz and index file (.pif.gz.tbi or .pif.gz.csi) files for created by `jbrowse make-pif`"]}),(0,v.jsxs)("div",{style:{maxWidth:400,margin:"0 auto"},children:[(0,v.jsx)(n.FileSelector,{name:`${c} location`,inline:!0,description:"",location:o,setLocation:i}),(0,v.jsx)(n.FileSelector,{name:`${c} index location`,inline:!0,description:"",location:l,setLocation:r}),(0,v.jsx)(S,{swap:t,radioOption:c,assembly1:e,assembly2:s,setSwap:a,text1:"query assembly",text2:"target assembly"})]})]})}),C=(0,l.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:a,fileLocation:o,setFileLocation:i,bed1Location:l,setBed1Location:r=()=>{},bed2Location:c,setBed2Location:d=()=>{},radioOption:m}){return(0,v.jsxs)("div",{children:[(0,v.jsxs)("div",{style:{margin:20},children:["Open the ",m," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,v.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,v.jsxs)("div",{style:{maxWidth:400,margin:"0 auto"},children:[(0,v.jsx)(n.FileSelector,{inline:!0,name:m,location:o,setLocation:i}),(0,v.jsx)(n.FileSelector,{inline:!0,name:"genome 1 .bed (left column of anchors file)",description:"",location:l,setLocation:r}),(0,v.jsx)(n.FileSelector,{inline:!0,name:"genome 2 .bed (right column of anchors file)",description:"",location:c,setLocation:d}),(0,v.jsx)(S,{swap:t,radioOption:m,assembly1:e,assembly2:s,setSwap:a,text1:"bed 1 assembly",text2:"bed 2 assembly"})]})]})}),F=(0,l.observer)(function({model:e,assembly1:s,assembly2:t,selectedRow:o}){const[i,l]=(0,a.useState)(!1),[r,c]=(0,a.useState)(),[p,x]=(0,a.useState)(),[j,g]=(0,a.useState)(),[w,A]=(0,a.useState)(),[S,F]=(0,a.useState)(""),[N,T]=(0,a.useState)(),R=(O=j)?O.uri||O.localPath||O.name:void 0;var O;const I=S||(R?function(e){const s=e.split(".").pop();return s?`.${s}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(R)):"");return(0,a.useEffect)(()=>{try{if(j){const a=R?R.split("#")[0].split("?")[0].split("/").pop():"MyTrack",n=`${a}-${Date.now()}-sessionTrack`;T(void 0),e.setImportFormSyntenyTrack(o,{type:"userOpened",value:{trackId:n,name:a,assemblyNames:[t,s],type:"SyntenyTrack",adapter:f({radioOption:I,assembly1:i?t:s,assembly2:i?s:t,fileLocation:j,indexFileLocation:w,bed1Location:p,bed2Location:r})}})}}catch(e){console.error(e),T(e)}},[i,e,o,R,s,t,p,r,j,w,I]),(0,v.jsxs)(b.A,{style:{padding:12},children:[N?(0,v.jsx)(n.ErrorMessage,{error:N}):null,(0,v.jsx)(u.A,{style:{textAlign:"center"},children:"Add a .paf (minimap2), .delta (Mummer), .chain (UCSC liftover), .anchors or .anchors.simple (MCScan), or .pif.gz (jbrowse CLI make-pif) file to view. These file types can also be gzipped."}),(0,v.jsx)(y.A,{value:I,onChange:e=>{F(e.target.value)},children:(0,v.jsx)(h.A,{container:!0,justifyContent:"center",children:[".paf",".delta",".out",".chain",".anchors",".anchors.simple",".pif.gz"].map(e=>(0,v.jsx)(d.A,{value:e,control:(0,v.jsx)(m.A,{}),label:e},e))})}),(0,v.jsx)(h.A,{container:!0,justifyContent:"center",children:".paf"===I||".out"===I||".delta"===I||".chain"===I?(0,v.jsx)(L,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:j,setFileLocation:g,radioOption:I}):".pif.gz"===I?(0,v.jsx)(k,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:j,setFileLocation:g,indexFileLocation:w,setIndexFileLocation:A,radioOption:I}):".anchors"===S||".anchors.simple"===S?(0,v.jsx)(C,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:j,setFileLocation:g,bed1Location:p,setBed1Location:x,bed2Location:r,setBed2Location:c,radioOption:S}):(0,v.jsx)(n.FileSelector,{name:S?`${S} location`:"",description:"",location:j,setLocation:e=>{g(e)}})})]})});var N=t(68584),T=t(91468),R=t(21049),O=t(10240);const I=(0,l.observer)(function({model:e,selectedRow:s,assembly1:t,assembly2:i}){const l=(0,o.getSession)(e),{importFormSyntenyTrackSelections:r}=e,{tracks:c=[],sessionTracks:d=[]}=l,m=[...c,...d].filter(e=>{const s=(0,N.readConfObject)(e,"assemblyNames");return s.includes(t)&&s.includes(i)&&e.type.includes("Synteny")}),p=m[0]?.trackId||"",y=r[s],h="preConfigured"===y?.type?y.value:void 0;return(0,a.useEffect)(()=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:p})},[i,t,p,s,e]),(0,v.jsxs)(b.A,{style:{padding:12},children:[(0,v.jsx)(u.A,{children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),h&&m.map(e=>e.trackId).includes(h)?(0,v.jsx)(R.A,{value:h,onChange:t=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:t.target.value})},children:m.map(e=>(0,v.jsx)(O.A,{value:e.trackId,children:(0,T.getTrackName)(e,l)},e.trackId))}):(0,v.jsx)(n.ErrorMessage,{error:`No synteny tracks found for ${t},${i}`})]})});function P(e){const s=(0,c.c)(27),{model:t,assembly1:n,assembly2:o,selectedRow:i}=e,[l,r]=(0,a.useState)("tracklist");let b,u,h,f,x,j,g,w,A,S;return s[0]!==l||s[1]!==t||s[2]!==i?(b=()=>{"none"===l&&t.setImportFormSyntenyTrack(i,{type:"none"})},u=[l,t,i],s[0]=l,s[1]=t,s[2]=i,s[3]=b,s[4]=u):(b=s[3],u=s[4]),(0,a.useEffect)(b,u),s[5]===Symbol.for("react.memo_cache_sentinel")?(h=e=>{r(e.target.value)},s[5]=h):h=s[5],s[6]===Symbol.for("react.memo_cache_sentinel")?(f=(0,v.jsx)(d.A,{value:"none",control:(0,v.jsx)(m.A,{}),label:"None"}),s[6]=f):f=s[6],s[7]===Symbol.for("react.memo_cache_sentinel")?(x=(0,v.jsx)(d.A,{value:"tracklist",control:(0,v.jsx)(m.A,{}),label:"Existing track"}),s[7]=x):x=s[7],s[8]===Symbol.for("react.memo_cache_sentinel")?(j=(0,v.jsx)(d.A,{value:"custom",control:(0,v.jsx)(m.A,{}),label:"New track"}),s[8]=j):j=s[8],s[9]!==l?(g=(0,v.jsx)(p.A,{children:(0,v.jsxs)(y.A,{row:!0,value:l,"aria-labelledby":"group-label",onChange:h,children:[f,x,j]})}),s[9]=l,s[10]=g):g=s[10],s[11]!==n||s[12]!==o||s[13]!==l||s[14]!==t||s[15]!==i?(w="custom"===l?(0,v.jsx)(F,{model:t,selectedRow:i,assembly2:o,assembly1:n}):null,s[11]=n,s[12]=o,s[13]=l,s[14]=t,s[15]=i,s[16]=w):w=s[16],s[17]!==n||s[18]!==o||s[19]!==l||s[20]!==t||s[21]!==i?(A="tracklist"===l?(0,v.jsx)(I,{model:t,selectedRow:i,assembly1:n,assembly2:o}):null,s[17]=n,s[18]=o,s[19]=l,s[20]=t,s[21]=i,s[22]=A):A=s[22],s[23]!==g||s[24]!==w||s[25]!==A?(S=(0,v.jsxs)("div",{children:[g,w,A]}),s[23]=g,s[24]=w,s[25]=A,s[26]=S):S=s[26],S}var M=t(93459),$=t(84340),_=t(89870);const q=(0,r.n9)()(e=>({mb:{marginBottom:10},button:{margin:e.spacing(2)},rel:{position:"relative"},synbutton:{position:"absolute",top:30},bg:{background:e.palette.divider}})),z=(0,l.observer)(function({selectedRow:e,selectedAssemblyNames:s,setSelectedRow:t,setSelectedAssemblyNames:a,model:i}){const{classes:l,cx:r}=q(),c=(0,o.getSession)(i);return s.map((d,m)=>(0,v.jsxs)("div",{className:l.rel,children:[(0,v.jsxs)("span",{children:["Row ",m+1,": "]}),(0,v.jsx)(_.A,{disabled:s.length<=2,onClick:()=>{i.importFormRemoveRow(m),a(s.map((e,s)=>s===m?void 0:e).filter(o.notEmpty)),e>=s.length-2&&t(0)},children:(0,v.jsx)($.A,{})}),(0,v.jsx)(n.AssemblySelector,{helperText:"",selected:d,onChange:e=>{a(s.map((s,t)=>t===m?e:s))},session:c}),m!==s.length-1?(0,v.jsx)(_.A,{"data-testid":"synbutton",className:r(l.synbutton,m===e?l.bg:void 0),onClick:()=>{t(m)},children:(0,v.jsx)(M.A,{})}):null]},`${d}-${m}`))}),E=(0,l.observer)(function({model:e,selectedAssemblyNames:s,setSelectedAssemblyNames:t,selectedRow:a,setSelectedRow:n,defaultAssemblyName:o,onLaunch:i}){const{classes:l}=q();return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:l.mb,children:"Select assemblies for linear synteny view"}),(0,v.jsx)(z,{model:e,selectedAssemblyNames:s,setSelectedAssemblyNames:t,selectedRow:a,setSelectedRow:n}),(0,v.jsxs)("div",{children:[(0,v.jsx)(w.A,{className:l.button,variant:"contained",color:"secondary",onClick:()=>{t([...s,o])},children:"Add row"}),(0,v.jsx)(w.A,{className:l.button,onClick:i,variant:"contained",color:"primary",children:"Launch"})]})]})});var B=t(42489);const W=(0,r.n9)()(e=>({importFormContainer:{padding:e.spacing(4)},flex:{display:"flex",gap:90},rightPanel:{flexGrow:11},leftPanel:{flexGrow:4,flexShrink:0}})),G=(0,l.observer)(function({model:e}){const{classes:s}=W(),t=(0,o.getSession)(e),{assemblyNames:l}=t,r=l[0]||"",[c,d]=(0,a.useState)(0),[m,p]=(0,a.useState)([r,r]),[y,b]=(0,a.useState)();return(0,v.jsxs)(i.A,{className:s.importFormContainer,children:[y?(0,v.jsx)(n.ErrorMessage,{error:y}):null,(0,v.jsxs)("div",{className:s.flex,children:[(0,v.jsx)("div",{className:s.leftPanel,children:(0,v.jsx)(E,{model:e,selectedAssemblyNames:m,setSelectedAssemblyNames:p,selectedRow:c,setSelectedRow:d,defaultAssemblyName:r,onLaunch:()=>{(async()=>{try{b(void 0),await async function({selectedAssemblyNames:e,model:s}){const t=(0,o.getSession)(s),{assemblyManager:a}=t,{importFormSyntenyTrackSelections:n}=s;s.setViews(await Promise.all(e.map(async e=>{const s=await a.waitForAssembly(e);if(!s)throw new Error(`Assembly "${e}" failed to load`);return{type:"LinearGenomeView",bpPerPx:1,offsetPx:0,hideHeader:!0,displayedRegions:s.regions}})));for(const e of s.views)e.setWidth(s.width),e.showAllRegions();(0,o.isSessionWithAddTracks)(t)?(0,B.toJS)(n).map((e,a)=>{"userOpened"===e.type?(t.addTrackConf(e.value),s.toggleTrack(e.value?.trackId,a)):"preConfigured"===e.type&&s.showTrack(e.value,a)}):t.notify("Can't add tracks","warning"),s.clearImportFormSyntenyTracks()}({selectedAssemblyNames:m,model:e})}catch(e){console.error(e),b(e)}})()}})}),(0,v.jsxs)("div",{className:s.rightPanel,children:[(0,v.jsxs)("div",{children:["Synteny dataset to display between row ",c+1," and"," ",c+2]}),(0,v.jsx)(P,{model:e,selectedRow:c,assembly1:m[c],assembly2:m[c+1]})]})]})]})})}}]);
//# sourceMappingURL=450.7e87ae20.chunk.js.map