{"version":3,"file":"static/js/5959.030d279c.chunk.js","mappings":"yMAYO,SAASA,EAAoBC,IAQlCC,EAAAA,EAAAA,IACED,EACAE,UACE,IAAKF,EAAKG,aACR,OAEF,MAAMC,GAAOC,EAAAA,EAAAA,mBAAkBL,IACzB,QAAEM,EAAO,UAAEC,GAAcP,GACzB,aAAEQ,GAAiBJ,EACzB,GAAIE,GAASG,MAAQF,EAAW,CAC9B,MAAMG,QAAaC,EAAAA,EAAAA,GAAc,CAC/BX,OACAS,IAAKH,EAAQG,IACbG,OAAQJ,KAENK,EAAAA,EAAAA,SAAQb,KACVA,EAAKc,kBAAkBJ,GACvBV,EAAKe,cAAa,GAEtB,MACEf,EAAKe,cAAa,IAGtB,CAAEC,KAAM,aAAcC,MAAO,KAEjC,C,0DCvCOf,eAAeS,GAAc,KAClCX,EAAI,IACJS,EAAG,OACHG,EAAM,KACNM,IAcA,MAAM,WAAEC,IAAeC,EAAAA,EAAAA,YAAWpB,IAC5B,cAAEqB,EAAa,uBAAEC,GAA2BtB,EAC5CuB,GAAYC,EAAAA,EAAAA,iBAAgBxB,GAalC,aAZqBmB,EAAWM,MAC9BD,EAAAA,EAAAA,iBAAgBxB,GAChB,6BACA,CACEqB,gBACAZ,MACAc,YACAG,cAAeJ,EACfK,QAASf,EAAOgB,iBACbV,GAIT,C","sources":["webpack://@jbrowse/web/../../plugins/alignments/src/LinearPileupDisplay/sharedDoAfterAttach.ts","webpack://@jbrowse/web/../../plugins/alignments/src/shared/getUniqueTags.ts"],"sourcesContent":["import { getContainingView } from '@jbrowse/core/util'\nimport { isAlive } from '@jbrowse/mobx-state-tree'\n\nimport { getUniqueTags } from '../shared/getUniqueTags.ts'\nimport { createAutorun } from '../util.ts'\n\nimport type { ColorBy } from '../shared/types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\nexport function sharedDoAfterAttach(self: {\n  autorunReady: boolean\n  adapterConfig: AnyConfigurationModel\n  colorBy?: ColorBy\n  tagsReady: boolean\n  updateColorTagMap: (arg: string[]) => void\n  setTagsReady: (arg: boolean) => void\n}) {\n  createAutorun(\n    self,\n    async () => {\n      if (!self.autorunReady) {\n        return\n      }\n      const view = getContainingView(self) as LGV\n      const { colorBy, tagsReady } = self\n      const { staticBlocks } = view\n      if (colorBy?.tag && !tagsReady) {\n        const vals = await getUniqueTags({\n          self,\n          tag: colorBy.tag,\n          blocks: staticBlocks,\n        })\n        if (isAlive(self)) {\n          self.updateColorTagMap(vals)\n          self.setTagsReady(true)\n        }\n      } else {\n        self.setTagsReady(true)\n      }\n    },\n    { name: 'ColorReady', delay: 1000 },\n  )\n}\n","import { getSession } from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { BlockSet } from '@jbrowse/core/util/blockTypes'\n\nexport async function getUniqueTags({\n  self,\n  tag,\n  blocks,\n  opts,\n}: {\n  self: {\n    adapterConfig: AnyConfigurationModel\n    effectiveRpcDriverName?: string\n  }\n  tag: string\n  blocks: BlockSet\n  opts?: {\n    headers?: Record<string, string>\n    stopToken?: string\n    filters: string[]\n  }\n}) {\n  const { rpcManager } = getSession(self)\n  const { adapterConfig, effectiveRpcDriverName } = self\n  const sessionId = getRpcSessionId(self)\n  const values = await rpcManager.call(\n    getRpcSessionId(self),\n    'PileupGetGlobalValueForTag',\n    {\n      adapterConfig,\n      tag,\n      sessionId,\n      rpcDriverName: effectiveRpcDriverName,\n      regions: blocks.contentBlocks,\n      ...opts,\n    },\n  )\n  return values as string[]\n}\n"],"names":["sharedDoAfterAttach","self","createAutorun","async","autorunReady","view","getContainingView","colorBy","tagsReady","staticBlocks","tag","vals","getUniqueTags","blocks","isAlive","updateColorTagMap","setTagsReady","name","delay","opts","rpcManager","getSession","adapterConfig","effectiveRpcDriverName","sessionId","getRpcSessionId","call","rpcDriverName","regions","contentBlocks"],"sourceRoot":""}