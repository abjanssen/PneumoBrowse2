"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[9756],{49756:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var s=a(46377),n=a(99546),r=a(66885),o=a(37347),c=a(44728),i=a(82088);class l extends s.BaseFeatureDataAdapter{gcMode="content";static capabilities=["hasLocalStats"];async configure(){const e=await(this.getSubAdapter?.(this.getConf("sequenceAdapter")));if(!e)throw new Error("Error getting subadapter");return e.dataAdapter}async getRefNames(e){return(await this.configure()).getRefNames(e)}getFeatures(e,t){const{statusCallback:a=()=>{},stopToken:s}=t||{};return(0,r.ObservableCreate)(async r=>{const l=await this.configure(),g=this.getConf("windowSize"),f=this.getConf("windowDelta"),h=1===g?1:Math.ceil(g/2),u=1===g,w=Math.max(0,Math.floor((e.start-h)/g)*g),d=Math.ceil((e.end+h)/g)*g;if(d<0||w>d)return void r.complete();const p=await(0,c._)(l.getFeatures({...e,start:w,end:d},t).pipe((0,i.$)())),b=p[0]?.get("seq")||"";await(0,n.updateStatus)("Calculating GC",a,()=>{let t=0,a=0,c=0,i=performance.now();const l=h;for(let e=l-h;e<l+h;e++){const s=b[e];"c"===s||"C"===s?t++:"g"!==s&&"G"!==s||a++,"N"!==s&&c++}for(let l=h;l<b.length-h;l+=f){if(performance.now()-i>400&&((0,o.SW)(s),i=performance.now()),u){const e=b[l];t="c"===e||"C"===e?1:0,a="g"===e||"G"===e?1:0,c="N"!==e?1:0}else if(l>h){const e=l-f+h,s=l-h,n=l+h;for(let n=l-f-h;n<Math.min(e,s);n++)if(n>=0&&n<b.length){const e=b[n];"c"===e||"C"===e?t--:"g"!==e&&"G"!==e||a--,"N"!==e&&c--}for(let r=Math.max(e,s);r<n;r++)if(r>=0&&r<b.length){const e=b[r];"c"===e||"C"===e?t++:"g"!==e&&"G"!==e||a++,"N"!==e&&c++}}const g=w,d="content"===this.gcMode?(a+t)/(c||1):"skew"===this.gcMode?(a-t)/(a+t||1):0;r.next(new n.SimpleFeature({uniqueId:`${this.id}_${g+l}`,refName:e.refName,start:g+l,end:g+l+f,score:d}))}}),r.complete()})}}}}]);
//# sourceMappingURL=9756.ced70c76.chunk.js.map