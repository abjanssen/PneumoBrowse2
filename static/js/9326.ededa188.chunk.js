"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[9326],{1832(e,t,n){n.d(t,{P:()=>a});var s=n(23886);function a(e,t,n=()=>{}){const a=new TextDecoder("utf8");let r=0,o=0;for(;r<e.length;){const c=e.indexOf(10,r),i=-1===c?e.length:c,l=e.subarray(r,i),u=a.decode(l).trim();if(u&&!1===t(u,o))break;o++%1e4==0&&n(`Loading ${(0,s.getProgressDisplayStr)(r,e.length)}`),r=i+1}}},79326(e,t,n){n.d(t,{default:()=>g});var s=n(90946),a=n(23886),r=n(11931),o=n(1832),c=n(49303),i=n(25529),l=n(153),u=n(64738),m=n(5843),h=n(75780);const{eL:f}=l;class g extends s.L{static capabilities=["getFeatures","getRefNames"];async setup(e){return this.setupP||(this.setupP=this.setupPre(e).catch(e=>{throw this.setupP=void 0,e})),this.setupP}async setupPre(e){const t=[];return(0,o.P)(await(0,a.fetchAndMaybeUnzip)((0,r.openLocation)(this.getConf("pafLocation"),this.pluginManager),e),e=>(t.push((0,m.xI)(e)),!0),e?.statusCallback),(0,h.W)(t)}async hasDataForRefName(){return!0}getAssemblyNames(){const e=this.getConf("assemblyNames");return 0===e.length?[this.getConf("queryAssembly"),this.getConf("targetAssembly")]:e}async getRefNames(e={}){const t=e.regions?.[0].assemblyName,n=await this.setup(e),s=this.getAssemblyNames().indexOf(t);if(-1!==s){const e=new Set;for(const t of n)e.add(0===s?t.qname:t.tname);return[...e]}return console.warn("Unable to do ref renaming on adapter"),[]}getFeatures(e,t={}){return(0,i.ObservableCreate)(async n=>{const s=await this.setup(t),a=this.getAssemblyNames(),{start:r,end:o,refName:i,assemblyName:l}=e,h=a.indexOf(l),g=0===h;-1===h&&(console.warn(`${l} not found in this adapter`),n.complete());for(let e=0;e<s.length;e++){const t=s[e];let h=0,d=0,p="",b="",y=0,w=0;g?(h=t.qstart,d=t.qend,p=t.qname,b=t.tname,y=t.tstart,w=t.tend):(h=t.tstart,d=t.tend,p=t.tname,b=t.qname,y=t.qstart,w=t.qend);const{extra:x,strand:q}=t;if(p===i&&(0,c.R6)(r,o,h,d)){const{numMatches:t=0,blockLen:s=1,cg:r,...o}=x;let c=x.cg;x.cg&&(g&&-1===q?c=(0,m.qm)(f(x.cg)).join(""):g&&(c=(0,m.gJ)(x.cg))),n.next(new u.A({uniqueId:e+l,assemblyName:l,start:h,end:d,type:"match",refName:p,strand:q,...o,CIGAR:c,syntenyId:e,identity:t/s,numMatches:t,blockLen:s,mate:{start:y,end:w,refName:b,assemblyName:a[+g]}}))}}n.complete()})}}},75780(e,t,n){function s(e){const t={};for(const n of e){const e=`${n.qname}-${n.tname}`,s=n.extra.mappingQual||1,a=n.extra.blockLen||1,r=t[e];r?(r.valueSum+=s*a,r.weightSum+=a):t[e]={valueSum:s*a,weightSum:a}}const n={};let s=1/0,a=-1/0;for(const[e,{valueSum:r,weightSum:o}]of Object.entries(t)){const t=r/o;n[e]=t,s=Math.min(t,s),a=Math.max(t,a)}const r=a-s;for(const t of e){const e=n[`${t.qname}-${t.tname}`];t.extra.meanScore=r>0?(e-s)/r:1}return e}n.d(t,{W:()=>s})},64738(e,t,n){n.d(t,{A:()=>o});var s=n(43102),a=n(153);const{DQ:r}=a;class o extends s.A{get(e){return"mismatches"===e?r(this.get("CIGAR")):super.get(e)}}},5843(e,t,n){n.d(t,{TA:()=>r,fY:()=>a,gJ:()=>i,qm:()=>c,xI:()=>o});var s=n(23886);function a(e){return new Map(e.split(/\n|\r\n|\r/).filter(e=>!!e&&!e.startsWith("#")).map(e=>{const[t,n,s,a,r,o]=e.split("\t");return[a,{refName:t,start:+n,end:+s,score:+r,name:a,strand:"-"===o?-1:1}]}))}async function r(e,t){return(0,s.fetchAndMaybeUnzipText)(e,t)}function o(e){const t=e.split("\t"),n=t.slice(12),s={numMatches:+t[9],blockLen:+t[10],mappingQual:+t[11]};if(n.length)for(const e of n){const t=e.indexOf(":");s[e.slice(0,t)]=e.slice(t+3)}return{tname:t[5],tstart:+t[7],tend:+t[8],qname:t[0],qstart:+t[2],qend:+t[3],strand:"-"===t[4]?-1:1,extra:s}}function c(e){const t=[];for(let n=e.length-2;n>=0;n-=2){t.push(e[n]);const s=e[n+1];"D"===s?t.push("I"):"I"===s?t.push("D"):t.push(s)}return t}function i(e){return e.replaceAll("D","K").replaceAll("I","D").replaceAll("K","I")}}}]);
//# sourceMappingURL=9326.ededa188.chunk.js.map