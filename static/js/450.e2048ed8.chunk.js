"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[450],{20450(e,t,n){n.r(t),n.d(t,{default:()=>U});var r=n(30936),l=n(42918),s=n(89718),i=n(59650),o=n(45371),a=n(64074),c=n(96960),u=n(32118);function d(e){const t=(0,r.c)(7),{value:n,refString:s}=e,[i,o]=(0,l.useState)(!1);let a;t[0]!==s||t[1]!==n?(a=(0,c.bC)(s,n),t[0]=s,t[1]=n,t[2]=a):a=t[2];const d=a;let h;return t[3]!==d||t[4]!==i||t[5]!==n?(h=d!==n?(0,u.jsxs)("div",{children:[(0,u.jsx)("button",{onClick:()=>{o(!i)},children:i?"Show simplified ALT":"Show raw ALT"})," ",i?n:d]}):n,t[3]=d,t[4]=i,t[5]=n,t[6]=h):h=t[6],h}function h({value:e}){const[t,r]=(0,l.useState)(!1),[s,i]=(0,l.useState)(!1),o=String(e);return o.length>100?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("button",{type:"button",onClick:async()=>{const{default:e}=await n.e(8284).then(n.t.bind(n,88284,23));e(o),i(!0),setTimeout(()=>{i(!1)},700)},children:s?"Copied to clipboard":"Copy"}),(0,u.jsx)("button",{type:"button",onClick:()=>{r(e=>!e)},children:t?"Show less":"Show more"}),(0,u.jsx)("div",{children:t?o:`${o.slice(0,100)}...`})]}):(0,u.jsx)("div",{children:o})}var f=n(34456),p=n(27351),m=n(35913),g=n(10537),y=n(90975),j=n(77251),b=n(72407),x=n(41031),v=n(77335),S=n(233),w=n(43637),T=n(76143);function A(e){const t=(0,r.c)(38),{rows:n,selectedGenotypes:l,setSelectedGenotypes:s,showToolbar:i}=e;let o,a,c,d,h,f,p,m,g,y,b,x,v,S,A,F;if(t[0]!==n||t[1]!==l||t[2]!==s||t[3]!==i){const e={};for(const t of n){const n=t.GT;e[n]||(e[n]={count:0,GT:t.GT,genotype:t.genotype}),e[n].count=e[n].count+1}const r=Object.entries(e).map(e=>{const[t,r]=e;return{id:t,...r,count:`${r.count} / ${n.length}`,frequency:`${l=r.count/n.length*100,l.toPrecision(3)}%`};var l}),v=null===l||r.every(e=>l.has(e.GT)),S=25+25*r.length+15+(i?40:0);t[16]!==S?(d={height:S},t[16]=S,t[17]=d):d=t[17],o=w.z,y=r,b=!0,x=25,c=25,f={field:"select",headerName:"",width:27,sortable:!1,disableColumnMenu:!0,renderHeader:()=>(0,u.jsx)(T.A,{checked:v,indeterminate:null!==l&&l.size>0&&l.size<r.length,onChange:(e,t)=>{s(t?null:new Set)},size:"small"}),renderCell:e=>{const t=null===l||l.has(e.row.GT);return(0,u.jsx)(T.A,{checked:t,onChange:(t,n)=>{const i=new Set(null===l?r.map(G):l);n?i.add(e.row.GT):i.delete(e.row.GT),i.size===r.length?s(null):s(i)},size:"small"})}},p={field:"GT",width:(0,j.measureGridWidth)(r.map(C))},m={field:"count",width:(0,j.measureGridWidth)(r.map(N))},g={field:"frequency",width:(0,j.measureGridWidth)(r.map(k))},a="genotype",h=(0,j.measureGridWidth)(r.map($)),t[0]=n,t[1]=l,t[2]=s,t[3]=i,t[4]=o,t[5]=a,t[6]=c,t[7]=d,t[8]=h,t[9]=f,t[10]=p,t[11]=m,t[12]=g,t[13]=y,t[14]=b,t[15]=x}else o=t[4],a=t[5],c=t[6],d=t[7],h=t[8],f=t[9],p=t[10],m=t[11],g=t[12],y=t[13],b=t[14],x=t[15];return t[18]!==a||t[19]!==h?(v={field:a,width:h},t[18]=a,t[19]=h,t[20]=v):v=t[20],t[21]!==v||t[22]!==f||t[23]!==p||t[24]!==m||t[25]!==g?(S=[f,p,m,g,v],t[21]=v,t[22]=f,t[23]=p,t[24]=m,t[25]=g,t[26]=S):S=t[26],t[27]!==o||t[28]!==i||t[29]!==c||t[30]!==S||t[31]!==y||t[32]!==b||t[33]!==x?(A=(0,u.jsx)(o,{rows:y,hideFooter:b,rowHeight:x,columnHeaderHeight:c,columns:S,showToolbar:i}),t[27]=o,t[28]=i,t[29]=c,t[30]=S,t[31]=y,t[32]=b,t[33]=x,t[34]=A):A=t[34],t[35]!==d||t[36]!==A?(F=(0,u.jsx)("div",{style:d,children:A}),t[35]=d,t[36]=A,t[37]=F):F=t[37],F}function $(e){return e.genotype}function k(e){return e.frequency}function N(e){return e.count}function C(e){return e.GT}function G(e){return e.GT}var F=n(43787);function O(e){const t=(0,r.c)(15),{columns:n,filter:s,setFilter:i}=e,[o,a]=(0,l.useState)(s),[,c]=(0,l.useTransition)();let d,h,f,p,m;if(t[0]!==s?(d=()=>{a(s)},h=[s],t[0]=s,t[1]=d,t[2]=h):(d=t[1],h=t[2]),(0,l.useEffect)(d,h),t[3]===Symbol.for("react.memo_cache_sentinel")?(f=(0,u.jsx)(x.A,{children:"These filters can use a plain text search or regex style query, e.g. in the genotype field, entering 1 will query for all genotypes that include the first alternate allele e.g. 0|1 or 1|1, entering [1-9]\\d* will find any non-zero allele e.g. 0|2 or 2/33"}),t[3]=f):f=t[3],t[4]!==n||t[5]!==o||t[6]!==i||t[7]!==c){let e;t[9]!==o||t[10]!==i||t[11]!==c?(e=e=>{const{field:t}=e;return(0,u.jsx)(F.A,{placeholder:`Filter ${t}`,value:o[t]||"",onChange:e=>{const n=e.target.value,r={...o,[t]:n};a(r),c(()=>{i(r)})}},`filter-${t}`)},t[9]=o,t[10]=i,t[11]=c,t[12]=e):e=t[12],p=n.map(e),t[4]=n,t[5]=o,t[6]=i,t[7]=c,t[8]=p}else p=t[8];return t[13]!==p?(m=(0,u.jsxs)(u.Fragment,{children:[f,p]}),t[13]=p,t[14]=m):m=t[14],m}const _=new Set(["sample","GT"]),D=new Set(["sample","GT","genotype"]);function q(e){const t=(0,r.c)(33),{feature:n,descriptions:s}=e;let i;t[0]!==s?(i=void 0===s?{}:s,t[0]=s,t[1]=i):i=t[1];const o=i;let a;t[2]===Symbol.for("react.memo_cache_sentinel")?(a={},t[2]=a):a=t[2];const[d,h]=(0,l.useState)(a),[T,$]=(0,l.useState)("all"),[k,N]=(0,l.useState)(!1),[C,G]=(0,l.useState)(!0),[F,_]=(0,l.useState)(!1),[D,q]=(0,l.useState)(!1),[R,E]=(0,l.useState)(null);let M;t[3]!==n.samples?(M=n.samples||{},t[3]=n.samples,t[4]=M):M=t[4];const H=M,W=n.ALT,P=n.REF;let B;t[5]!==W||t[6]!==P||t[7]!==d||t[8]!==H||t[9]!==D?(B=function(e,t,n,r,l){let s,i=[];const o=Object.keys(r);try{i=Object.entries(e).map(([e,r])=>{const s=r.GT?.[0],i=s?`${s}`:void 0,o=i?l?function(e){const t={},n=e.split(/[/|]/);for(const e of n)t[e]=(t[e]||0)+1;return Object.entries(t).map(([e,t])=>`${e}:${t}`).join(";")}(i):i:void 0,a=i?l?function(e,t,n){const r={},l=e.split(/[/|]/);for(const e of l)if("."===e)r["."]=(r["."]||0)+1;else{const l=0===+e?`ref(${t.length<10?t:(0,j.getBpDisplayStr)(t.length)})`:(0,c.bC)(t,n[+e-1]||"");r[l]=(r[l]||0)+1}return Object.entries(r).map(([e,t])=>`${e}:${t}`).join(";")}(i,t,n):(0,c.Fm)(i,t,n):void 0;return{...r,...i?{GT:o,genotype:a}:{},sample:e,id:e}}).filter(e=>!o.length||o.every(t=>{const n=r[t];return!n||new RegExp(n,"i").exec(e[t])}))}catch(e){console.error(e),s=e}return{rows:i,error:s}}(H,P,W,d,D),t[5]=W,t[6]=P,t[7]=d,t[8]=H,t[9]=D,t[10]=B):B=t[10];const{rows:V,error:U}=B;let K;t[11]!==V||t[12]!==R?(K=null===R?V:V.filter(e=>R.has(e.GT)),t[11]=V,t[12]=R,t[13]=K):K=t[13];const Q=K;let J;t[14]!==V[0]?(J=["sample",...Object.keys(V[0]||{}).filter(z)],t[14]=V[0],t[15]=J):J=t[15];const X=J;let Y;t[16]!==o?.FORMAT||t[17]!==Q||t[18]!==X?(Y=X.map(e=>({field:e,description:o?.FORMAT?.[e]?.Description,width:(0,j.measureGridWidth)(Q.map(t=>t[e]))})),t[16]=o?.FORMAT,t[17]=Q,t[18]=X,t[19]=Y):Y=t[19];const Z=Y;let ee;return t[20]!==T||t[21]!==Z||t[22]!==U||t[23]!==d||t[24]!==Q||t[25]!==e||t[26]!==V||t[27]!==R||t[28]!==k||t[29]!==C||t[30]!==F||t[31]!==D?(ee=V.length?(0,u.jsxs)(f.default,{...e,title:"Samples",children:[U?(0,u.jsx)(x.A,{color:"error",children:`${U}`}):null,(0,u.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,u.jsx)(m.A,{menuItems:[{label:'Show allele counts ("dosage")',helpText:"This converts a genotype like 1/1 into 1:2 which says there were two occurrences of the ALT allele 1 in the genotype",type:"checkbox",checked:D,onClick:()=>{q(!D),E(null)}},{label:"Show frequency table",type:"checkbox",checked:C,onClick:()=>{G(!C)}},{label:"Show filters",type:"checkbox",checked:k,onClick:()=>{N(!k)}},{label:"Show toolbar",type:"checkbox",checked:F,onClick:()=>{_(!F)}}],children:(0,u.jsx)(b.A,{})}),(0,u.jsxs)(v.A,{value:T,exclusive:!0,size:"small",onChange:(e,t)=>{null!==t&&$(t)},children:[(0,u.jsx)(S.A,{value:"all",children:"All"}),(0,u.jsx)(S.A,{value:"gtOnly",children:"GT only"}),(0,u.jsx)(S.A,{value:"genotypeOnly",children:"GT+resolved genotype"})]})]}),k?(0,u.jsx)(O,{setFilter:h,columns:Z,filter:d}):null,C?(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(x.A,{variant:"subtitle2",style:{marginTop:8},children:"Genotype frequencies (click to filter)"}),(0,u.jsx)(y.t,{FallbackComponent:p.A,children:(0,u.jsx)(A,{rows:V,selectedGenotypes:R,setSelectedGenotypes:E,showToolbar:F})})]}):null,(0,u.jsxs)(x.A,{variant:"subtitle2",style:{marginTop:16},children:["Samples"," ",null!==R?`(${Q.length} of ${V.length})`:`(${V.length})`]}),(0,u.jsx)(g.A,{children:(0,u.jsx)(w.z,{rows:Q,hideFooter:Q.length<100,columns:"gtOnly"===T?Z.filter(L):"genotypeOnly"===T?Z.filter(I):Z,rowHeight:25,columnHeaderHeight:25,showToolbar:F})})]}):null,t[20]=T,t[21]=Z,t[22]=U,t[23]=d,t[24]=Q,t[25]=e,t[26]=V,t[27]=R,t[28]=k,t[29]=C,t[30]=F,t[31]=D,t[32]=ee):ee=t[32],ee}function I(e){return D.has(e.field)}function L(e){return _.has(e.field)}function z(e){return"id"!==e&&"sample"!==e}const R={CHROM:"chromosome: An identifier from the reference genome",POS:"position: The reference position, with the 1st base having position 1",ID:"identifier: Semi-colon separated list of unique identifiers where available",REF:"reference base(s): Each base must be one of A,C,G,T,N (case insensitive).",ALT:"alternate base(s): Comma-separated list of alternate non-reference alleles",QUAL:"quality: Phred-scaled quality score for the assertion made in ALT",FILTER:"filter status: PASS if this position has passed all filters, otherwise a semicolon-separated list of codes for filters that fail"},E=(0,l.lazy)(()=>n.e(4733).then(n.bind(n,74733))),M=(0,l.lazy)(()=>n.e(3541).then(n.bind(n,53541)));function H(e){const t=(0,r.c)(10),{descriptions:n,feature:l,fieldKey:s,title:i,regex:o}=e,a=n?.INFO?.[s]?.Description;let c;t[0]!==a||t[1]!==o?(c=a?.match(o)?.[1]?.split("|")||[],t[0]=a,t[1]=o,t[2]=c):c=t[2];const d=c;let h;t[3]!==l.INFO||t[4]!==s?(h=l.INFO?.[s]||[],t[3]=l.INFO,t[4]=s,t[5]=h):h=t[5];const f=h;let p;return t[6]!==f||t[7]!==d||t[8]!==i?(p=(0,u.jsx)(M,{fields:d,data:f,title:i}),t[6]=f,t[7]=d,t[8]=i,t[9]=p):p=t[9],p}const W=["inversion","deletion","duplication","cnv","sv"];function P(e){const t=(0,r.c)(3),{model:n}=e,{featureData:l}=n;let s;if(t[0]!==l||t[1]!==n){const e=JSON.parse(JSON.stringify(l)),{type:r}=e,i=void 0===r?"":r;s="breakend"===i?(0,u.jsx)(E,{feature:e,locStrings:e.ALT.map(B),model:n}):"translocation"===i?(0,u.jsx)(E,{feature:e,model:n,locStrings:[`${e.INFO.CHR2[0]}:${e.INFO.END}`]}):"paired_feature"===i?(0,u.jsx)(E,{feature:e,model:n,locStrings:[`${e.mate.refName}:${e.mate.start}`]}):W.some(e=>i.includes(e))?(0,u.jsx)(E,{feature:{uniqueId:"random",refName:e.refName,start:e.start,end:e.start+1,mate:{refName:e.refName,start:e.end,end:e.end+1}},model:n,locStrings:[`${e.refName}:${e.end}`]}):null,t[0]=l,t[1]=n,t[2]=s}else s=t[2];return s}function B(e){return(0,s.An)(e)?.MatePosition||""}const V=(0,a.observer)(function(e){const{feat:t,model:n}=e,{descriptions:r}=n,{samples:s,...a}=t,{REF:c}=a;return(0,u.jsxs)(o.A,{"data-testid":"variant-side-drawer",children:[(0,u.jsx)(i.default,{feature:a,descriptions:{...R,...r},formatter:(e,t)=>"ALT"===t?(0,u.jsx)(d,{value:`${e}`,refString:c}):(0,u.jsx)(h,{value:e}),...e}),(0,u.jsxs)(l.Suspense,{fallback:null,children:[(0,u.jsx)(H,{feature:a,descriptions:r,fieldKey:"CSQ",title:"Variant CSQ field",regex:/.*Format: (.*)/}),(0,u.jsx)(H,{feature:a,descriptions:r,fieldKey:"ANN",title:"Variant ANN field",regex:/.*Functional annotations:'(.*)'$/}),(0,u.jsx)(P,{model:n})]}),(0,u.jsx)(q,{feature:t,...e,descriptions:r})]})}),U=(0,a.observer)(function(e){const{model:t}=e,{featureData:n}=t,r=structuredClone(n);return r?(0,u.jsx)(V,{feat:r,...e}):(0,u.jsx)("div",{children:"No feature loaded, may not be available after page refresh because it was too large for localStorage"})})},72407(e,t,n){n.d(t,{A:()=>s});var r=n(2425),l=n(32118);const s=(0,r.A)((0,l.jsx)("path",{d:"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6"}),"Settings")},96960(e,t,n){n.d(t,{Fm:()=>h,M_:()=>c,bC:()=>d});var r=n(89718),l=n(77251);const s=/[/|]/;function i(e){return e.includes("[")||e.includes("]")||e.startsWith(".")||e.endsWith(".")}function o(e){return e.startsWith("<")||i(e)}const a={"<DEL>":"deletion","<INS>":"insertion","<DUP>":"duplication","<INV>":"inversion","<INVDUP>":"inverted_duplication","<CNV>":"copy_number_variation","<TRA>":"translocation","<DUP:TANDEM>":"tandem_duplication","<NON_REF>":"sequence_variant","<*>":"sequence_variant"};function c(e,t,n){if(!t||0===t.length)return["remark","no alternative alleles"];const s=t.map(t=>function(e,t,n){if(e.startsWith("<"))return u(e,n)??"variant";if(i(e)&&(0,r.An)(e))return"breakend";const l=t.length,s=e.length;return 1===l&&1===s?"SNV":l===s?function(e,t){return e.split("").reverse().join("")===t}(t,e)?"inversion":"substitution":l<s?"insertion":"deletion"}(t,e,n)),a=[...new Set(s)],c=function(e,t){if(t.every(o))return t.join(",");const n=e.length;return`${e.length>10?(0,l.getBpDisplayStr)(n):e} -> ${t.map(e=>e.length>10?(0,l.getBpDisplayStr)(e.length):e).join(",")}`}(e,t);return[a.join(","),c]}function u(e,t){if(a[e])return a[e];if(t.getMetadata("ALT",e))return"sequence_variant";const n=e.slice(1,-1).split(":");return n.length>1?u(`<${n.slice(0,-1).join(":")}>`,t):void 0}function d(e,t){if(o(t)||1===e.length&&1===t.length)return t;const n=e.length,r=t.length;return n>5||r>5?`${(0,l.getBpDisplayStr)(n)} -> ${(0,l.getBpDisplayStr)(r)}`:`${e} -> ${t}`}function h(e,t,n){return e.split(s).map(e=>"."===e?".":0===+e?`ref(${t.length<10?t:(0,l.getBpDisplayStr)(t.length)})`:d(t,n[+e-1]||"")).join(e.includes("|")?"|":"/")}}}]);
//# sourceMappingURL=450.e2048ed8.chunk.js.map