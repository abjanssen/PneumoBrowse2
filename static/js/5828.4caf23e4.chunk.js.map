{"version":3,"file":"static/js/5828.4caf23e4.chunk.js","mappings":"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","sources":["../../../plugins/variants/src/shared/components/RectBg.tsx","../../../plugins/variants/src/shared/components/MultiVariantColorLegend.tsx","../../../plugins/variants/src/shared/components/MultiVariantLegendBarWrapper.tsx","../../../plugins/variants/src/shared/components/MultiVariantLegendBar.tsx","../../../plugins/variants/src/shared/components/SvgTree.tsx","../../../plugins/variants/src/shared/makeSidebarSvg.tsx","../../../plugins/variants/src/MultiLinearVariantDisplay/renderSvg.tsx"],"sourcesContent":["import { getFillProps } from '@jbrowse/core/util'\nimport { alpha, useTheme } from '@mui/material'\n\nconst RectBg = ({\n  x,\n  y,\n  width,\n  height,\n  color,\n}: {\n  x: number\n  y: number\n  width: number\n  height: number\n  color?: string\n}) => {\n  const theme = useTheme()\n  return (\n    <rect\n      pointerEvents=\"auto\"\n      x={x}\n      y={y}\n      width={width}\n      height={height}\n      {...getFillProps(color || alpha(theme.palette.background.paper, 0.8))}\n    />\n  )\n}\n\nexport default RectBg\n","import { useMemo } from 'react'\n\nimport { getFillProps } from '@jbrowse/core/util'\nimport { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport RectBg from './RectBg.tsx'\n\nimport type { Source } from '../types.ts'\n\nconst LegendItem = function ({\n  source,\n  idx,\n  rowHeight,\n}: {\n  source: Source\n  idx: number\n  rowHeight: number\n}) {\n  const { color } = source\n  const colorBoxWidth = 15\n  return color ? (\n    <RectBg\n      y={idx * rowHeight}\n      x={0}\n      width={colorBoxWidth + 0.5}\n      height={rowHeight + 0.5}\n      color={color}\n    />\n  ) : null\n}\n\nconst LegendItemText = function ({\n  source,\n  idx,\n  rowHeight,\n  textFillProps,\n}: {\n  source: Source\n  idx: number\n  rowHeight: number\n  textFillProps: ReturnType<typeof getFillProps>\n}) {\n  const { color, name } = source\n  const svgFontSize = Math.min(rowHeight, 12)\n  const colorBoxWidth = 15\n  return (\n    <text\n      y={(idx + 0.5) * rowHeight}\n      x={color ? colorBoxWidth + 2 : 0}\n      fontSize={svgFontSize}\n      dominantBaseline=\"central\"\n      {...textFillProps}\n    >\n      {name}\n    </text>\n  )\n}\n\nconst MultiVariantColorLegend = observer(function MultiVariantColorLegend({\n  model,\n  labelWidth,\n}: {\n  model: {\n    canDisplayLabels: boolean\n    rowHeight: number\n    sources?: Source[]\n  }\n  labelWidth: number\n}) {\n  const { canDisplayLabels, rowHeight, sources } = model\n  const colorBoxWidth = 15\n  const theme = useTheme()\n\n  const hasColors = useMemo(\n    () => sources?.some(s => s.color) ?? false,\n    [sources],\n  )\n  const legendWidth = labelWidth + (hasColors ? colorBoxWidth + 5 : 0)\n\n  const textFillProps = useMemo(\n    () => getFillProps(theme.palette.text.primary),\n    [theme.palette.text.primary],\n  )\n\n  return sources ? (\n    <>\n      {canDisplayLabels ? (\n        <RectBg\n          y={0}\n          x={0}\n          width={legendWidth}\n          height={(sources.length + 0.25) * rowHeight}\n        />\n      ) : null}\n      {/* Render all background rectangles first */}\n      {sources.map((source, idx) => (\n        <LegendItem\n          key={`${source.name}-${idx}`}\n          source={source}\n          idx={idx}\n          rowHeight={rowHeight}\n        />\n      ))}\n      {/* Then render all text elements on top */}\n      {canDisplayLabels\n        ? sources.map((source, idx) => (\n            <LegendItemText\n              key={`${source.name}-text-${idx}`}\n              source={source}\n              idx={idx}\n              rowHeight={rowHeight}\n              textFillProps={textFillProps}\n            />\n          ))\n        : null}\n    </>\n  ) : null\n})\n\nexport default MultiVariantColorLegend\n","import { getContainingView } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport type { LegendBarModel } from './types.ts'\n\nconst MultiVariantLegendBarWrapper = observer(\n  function MultiVariantLegendBarWrapper({\n    children,\n    model,\n    exportSVG,\n  }: {\n    model: LegendBarModel\n    children: React.ReactNode\n    exportSVG?: boolean\n  }) {\n    const { id, scrollTop, height, hierarchy, treeAreaWidth, showTree } = model\n    const clipid = `legend-${typeof jest === 'undefined' ? id : 'test'}`\n    const leftOffset = hierarchy && showTree ? treeAreaWidth : 0\n    return exportSVG ? (\n      <>\n        <defs>\n          <clipPath id={clipid}>\n            <rect x={0} y={0} width={1000} height={height} />\n          </clipPath>\n        </defs>\n        <g clipPath={`url(#${clipid})`}>\n          <g transform={`translate(0,${-scrollTop})`}>{children}</g>\n        </g>\n      </>\n    ) : (\n      <svg\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: leftOffset,\n          zIndex: 100,\n          pointerEvents: 'none',\n          height: model.totalHeight,\n          width: getContainingView(model).width,\n        }}\n      >\n        {children}\n      </svg>\n    )\n  },\n)\n\nexport default MultiVariantLegendBarWrapper\n","import { useMemo } from 'react'\n\nimport { measureText } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport ColorLegend from './MultiVariantColorLegend.tsx'\nimport MultiVariantLegendBarWrapper from './MultiVariantLegendBarWrapper.tsx'\n\nimport type { LegendBarModel } from './types.ts'\n\nconst MultiVariantLegendBar = observer(function MultiVariantLegendBar(props: {\n  model: LegendBarModel\n  orientation?: string\n  exportSVG?: boolean\n}) {\n  const { model } = props\n  const { canDisplayLabels, rowHeight, sources } = model\n  const svgFontSize = Math.min(rowHeight, 12)\n\n  const labelWidth = useMemo(() => {\n    if (!sources) {\n      return 0\n    }\n    let maxWidth = 0\n    for (const s of sources) {\n      const width = canDisplayLabels\n        ? measureText(s.name, svgFontSize) + 10\n        : 20\n      if (width > maxWidth) {\n        maxWidth = width\n      }\n    }\n    return maxWidth\n  }, [sources, svgFontSize, canDisplayLabels])\n\n  return sources ? (\n    <MultiVariantLegendBarWrapper {...props}>\n      <ColorLegend model={model} labelWidth={labelWidth} />\n    </MultiVariantLegendBarWrapper>\n  ) : null\n})\n\nexport default MultiVariantLegendBar\n","import { observer } from 'mobx-react'\n\nimport type { LegendBarModel } from './types.ts'\n\nconst SvgTree = observer(function SvgTree({\n  model,\n}: {\n  model: LegendBarModel\n}) {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const { treeAreaWidth: _treeAreaWidth, hierarchy } = model\n  const svg = []\n  let idx = 0\n  if (hierarchy) {\n    for (const link of hierarchy.links()) {\n      const { source, target } = link\n      const sy = source.x!\n      const ty = target.x!\n      const tx = target.y!\n      const sx = source.y!\n\n      // Vertical line\n      svg.push(\n        <line\n          key={`${sx}-${sy}-${tx}-${ty}-${idx++}`}\n          x1={sx}\n          y1={sy}\n          x2={sx}\n          y2={ty}\n          stroke=\"black\"\n          opacity=\"0.4\"\n        />,\n        <line\n          key={`${sx}-${sy}-${tx}-${ty}-${idx++}`}\n          x1={sx}\n          y1={ty}\n          x2={tx}\n          y2={ty}\n          stroke=\"black\"\n          opacity=\"0.4\"\n        />,\n      )\n    }\n  }\n  return svg\n})\n\nexport default SvgTree\n","import { getContainingView } from '@jbrowse/core/util'\n\nimport SvgTree from './components/SvgTree.tsx'\nimport LegendBar from '../shared/components/MultiVariantLegendBar.tsx'\n\nimport type { LegendBarModel } from './components/types.ts'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ninterface Model extends LegendBarModel {\n  hierarchy: any\n  availableHeight: number\n  totalHeight: number\n  treeAreaWidth: number\n}\n\nexport async function makeSidebarSvg(self: Model) {\n  const { offsetPx } = getContainingView(self) as LinearGenomeViewModel\n  const { hierarchy, showTree, treeAreaWidth, availableHeight } = self\n\n  return (\n    <g\n      id=\"tree-layer\"\n      data-testid=\"tree-layer\"\n      transform={`translate(${Math.max(-offsetPx, 0)})`}\n      clipPath=\"url(#sidebarClip)\"\n    >\n      <clipPath id=\"sidebarClip\">\n        <rect x=\"0\" y=\"0\" width=\"100%\" height={availableHeight} />\n      </clipPath>\n      <g\n        id=\"legend-layer\"\n        transform={`translate(${showTree && hierarchy ? treeAreaWidth : 0})`}\n      >\n        <LegendBar model={self} orientation=\"left\" exportSVG />\n      </g>\n      {showTree ? <SvgTree model={self} /> : null}\n    </g>\n  )\n}\n","import { when } from 'mobx'\n\nimport { makeSidebarSvg } from '../shared/makeSidebarSvg.tsx'\n\nimport type { LegendBarModel } from '../shared/components/types.ts'\nimport type { ExportSvgDisplayOptions } from '@jbrowse/plugin-linear-genome-view'\n\ninterface Model extends LegendBarModel {\n  regionCannotBeRenderedText?: any\n  hierarchy: any\n  availableHeight: number\n  totalHeight: number\n  treeAreaWidth: number\n}\n\nexport async function renderSvg(\n  self: Model,\n  opts: ExportSvgDisplayOptions,\n  superRenderSvg: (opts: ExportSvgDisplayOptions) => Promise<React.ReactNode>,\n) {\n  await when(() => !!self.regionCannotBeRenderedText)\n  const dataSvg = await superRenderSvg(opts)\n  const legendSvg = await makeSidebarSvg(self)\n\n  return (\n    <>\n      <g id=\"data-layer\">{dataSvg}</g>\n      {legendSvg}\n    </>\n  )\n}\n"],"names":["t0","$","_c","x","y","width","height","color","theme","useTheme","t1","t2","t3","alpha","palette","background","paper","getFillProps","_jsx","pointerEvents","LegendItem","source","idx","rowHeight","RectBg","LegendItemText","textFillProps","name","svgFontSize","Math","min","dominantBaseline","children","observer","model","labelWidth","canDisplayLabels","sources","legendWidth","useMemo","some","s","colorBoxWidth","text","primary","_jsxs","_Fragment","length","map","exportSVG","id","scrollTop","hierarchy","treeAreaWidth","showTree","clipid","jest","leftOffset","clipPath","transform","style","position","top","left","zIndex","totalHeight","getContainingView","props","maxWidth","measureText","MultiVariantLegendBarWrapper","ColorLegend","_treeAreaWidth","svg","link","links","target","sy","ty","tx","sx","push","x1","y1","x2","y2","stroke","opacity","async","makeSidebarSvg","self","offsetPx","availableHeight","max","LegendBar","orientation","SvgTree","renderSvg","opts","superRenderSvg","when","regionCannotBeRenderedText","dataSvg","legendSvg"],"ignoreList":[],"sourceRoot":""}