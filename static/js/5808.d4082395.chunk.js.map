{"version":3,"file":"static/js/5808.d4082395.chunk.js","mappings":"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ACA,8BACA,qCACA,6BACA,sCACA,yBACA,6BACA,8BACA,2BACA,kCACA,gCACA,kCACA,sCACA,4BACA,2BACA,wBACA,yBACA,gCACA,8BACA,gCACA,qCACA,mCACA,8BACA,yBACA,0BACA,yBACA,yBACA,+BACA,0BACA,8BACA,+BACA,mCACA,yBACA,mCACA,yBACA,6BACA,mCACA,mCACA,4CACA,iCACA,kCACA,iCACA,yBACA,6BACA,6BACA,0BACA,iCACA,kCACA,+BACA,mCACA,0BACA,4BACA,2BACA,2BACA,0BACA,+BACA,2BACA,sCACA,2BACA,6BACA,2BACA,6BACA,oCACA,8BACA,oCACA,kCACA,0BACA,yBACA,+BACA,kCACA,8BACA,6BACA,4BACA,4BACA,2BACA,wBACA,0BACA,8BACA,8BACA,mCACA,gCACA,8BACA,oCACA,6BACA,mCACA,yBACA,8BACA,qCACA,iCACA,sCACA,4BACA,4BACA,+BAEA,0BACA,iCACA,iCACA,iCACA,sBACA,2BACA,6BACA,uBACA,4BACA,yBACA,sBACA,oBACA,4BACA,uBACA,4BACA,qBACA,4BACA,+BACA,4BACA,2BACA,0BACA,iCACA,yBACA,kCACA,qBACA,yBACA,0BACA,uBACA,8BACA,4BACA,8BACA,kCACA,wBACA,uBACA,oBACA,qBACA,4BACA,0BACA,4BACA,iCACA,+BACA,0BACA,qBACA,sBACA,qBACA,qBACA,2BACA,sBACA,0BACA,2BACA,+BACA,qBACA,+BACA,qBACA,yBACA,+BACA,+BACA,wCACA,6BACA,8BACA,6BACA,qBACA,yBACA,yBACA,sBACA,6BACA,8BACA,2BACA,+BACA,sBACA,wBACA,uBACA,uBACA,sBACA,2BACA,uBACA,kCACA,uBACA,yBACA,uBACA,yBACA,gCACA,0BACA,gCACA,8BACA,sBACA,qBACA,2BACA,8BACA,0BACA,yBACA,wBACA,wBACA,uBACA,oBACA,sBACA,0BACA,0BACA,+BACA,4BACA,0BACA,gCACA,yBACA,+BACA,qBACA,0BACA,iCACA,6B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","sources":["../../../packages/core/src/pluggableElementTypes/models/InternetAccountModel.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/Block.tsx","../../../packages/core/src/ui/index.ts","../../../plugins/wiggle/src/shared/axisPropsFromTickScale.ts","../../../plugins/linear-genome-view/src/LinearBasicDisplay/configSchema.ts","../../../packages/core/src/pluggableElementTypes/TrackType.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/calculateSvgLegendWidth.ts","../../../plugins/wiggle/src/WiggleRendering.tsx","../../../plugins/alignments/src/shared/samFlags.ts","../../../packages/core/src/pluggableElementTypes/models/baseTrackConfig.ts","../../../plugins/data-management/src/JB2TrackHubConnection/configSchema.ts","../../../plugins/data-management/src/JB2TrackHubConnection/model.ts","../../../plugins/data-management/src/JB2TrackHubConnection/index.ts","../../../packages/core/src/util/aborting.ts","../../../packages/core/src/util/io/RemoteFileWithRangeCache.ts","../../../plugins/wiggle/src/shared/SharedWiggleMixin.ts","../../../plugins/dotplot-view/src/DotplotView/components/util.ts","../../../packages/core/src/util/types/index.ts","../../../plugins/data-management/src/AddTrackWidget/model.ts","../../../plugins/data-management/src/AddTrackWidget/index.ts","../../../packages/core/src/configuration/util.ts","../../../packages/core/src/util/jexl.ts","../../../packages/core/src/pluggableElementTypes/models/baseInternetAccountConfig.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/Gridlines.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackLabelDragHandle.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackLabelMenu.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackLabel.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackLabelContainer.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackRenderingContainer.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TrackContainer.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/VerticalGuide.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/useRangeSelect.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/Rubberband.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/ScalebarCoordinateLabels.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/ScalebarRefNameLabels.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/Scalebar.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/useSideScroll.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/useWheelScroll.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/TracksContainer.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/LinearGenomeViewContainer.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/LinearGenomeView.tsx","../../../packages/core/src/util/stats.ts","../../../packages/core/src/pluggableElementTypes/models/baseConnectionConfig.ts","../../../plugins/alignments/src/RenderLinearReadCloudDisplayRPC/drawFeatsCloud.ts","../../../packages/core/src/ui/colors.ts","../../../packages/core/src/util/coarseStripHTML.ts","../../../packages/core/src/pluggableElementTypes/ConnectionType.ts","../../../packages/core/src/ui/CascadingMenuHelpDialog.tsx","../../../packages/core/src/ui/CascadingMenuHelpIconButton.tsx","../../../packages/core/src/ui/HoverMenu.tsx","../../../packages/core/src/ui/MenuItems.tsx","../../../packages/core/src/ui/CascadingMenu.tsx","../../../plugins/breakpoint-split-view/src/BreakpointSplitView/util.ts","../../../packages/core/src/pluggableElementTypes/WidgetType.ts","../../../packages/core/src/util/layouts/MultiLayout.ts","../../../plugins/alignments/src/shared/color.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/util.ts","../../../packages/core/src/ui/theme.ts","../../../packages/core/src/pluggableElementTypes/renderers/FeatureRendererType.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/MaxHeightReachedIndicator.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/RenderedBlocks.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/LinearBlocks.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/MenuPage.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/BaseLinearDisplay.tsx","../../../packages/core/src/util/jexlStrings.ts","../../../packages/core/src/util/colord.ts","../../../packages/core/src/BaseFeatureWidget/configSchema.ts","../../../packages/core/src/data_adapters/CytobandAdapter/configSchema.ts","../../../packages/core/src/rpc/methods/CoreGetRefNames.ts","../../../packages/core/src/rpc/methods/CoreGetFeatureDetails.ts","../../../packages/core/src/rpc/methods/CoreGetMetadata.ts","../../../packages/core/src/rpc/methods/CoreGetFileInfo.ts","../../../packages/core/src/rpc/methods/CoreGetFeatures.ts","../../../packages/core/src/rpc/methods/CoreGetSequence.ts","../../../packages/core/src/rpc/methods/util.ts","../../../packages/core/src/rpc/methods/CoreRender.ts","../../../packages/core/src/rpc/methods/CoreFreeResources.ts","../../../packages/core/src/rpc/methods/CoreGetFeatureDensityStats.ts","../../../packages/core/src/rpc/methods/CoreGetRegions.ts","../../../packages/core/src/rpc/methods/CoreGetExportData.ts","../../../packages/core/src/CorePlugin.ts","../../../packages/core/src/data_adapters/CytobandAdapter/index.ts","../../../packages/core/src/PhasedScheduler.ts","../../../packages/core/src/PluginManager.ts","../../../packages/core/src/BaseFeatureWidget/SequenceFeatureDetails/model.ts","../../../packages/core/src/BaseFeatureWidget/stateModelFactory.ts","../../../packages/core/src/pluggableElementTypes/models/BaseViewModel.ts","../../../packages/core/src/pluggableElementTypes/renderers/RendererType.tsx","../../../plugins/variants/src/VariantRPC/getGenotypeMatrix.ts","../../../packages/core/src/pluggableElementTypes/ViewType.ts","../../../plugins/variants/src/shared/getSources.ts","../../../packages/core/src/data_adapters/util.ts","../../../packages/core/src/data_adapters/BaseAdapter/stats.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewScalebarPolygon.tsx","../../../packages/core/src/util/range.ts","../../../packages/core/src/TextSearch/TextSearchManager.ts","../../../plugins/data-management/src/PluginStoreWidget/model.ts","../../../plugins/data-management/src/PluginStoreWidget/index.ts","../../../packages/core/src/util/transferables.ts","../../../packages/core/src/ui/RedErrorMessageBox.tsx","../../../packages/core/src/ui/ErrorMessage.tsx","../../../plugins/wiggle/src/util.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/TooLargeMessage.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/FeatureDensityMixin.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/autorunFeatureDensityStats.ts","../../../packages/core/src/util/types/ElementId.ts","../../../packages/core/src/ui/ResizeHandle.tsx","../../../packages/core/src/util/offscreenCanvasUtils.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RubberbandTooltip.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RubberbandSpan.tsx","../../../packages/core/src/ReExports/lazify.tsx","../../../packages/core/src/ReExports/BaseFeatureDetails.tsx","../../../packages/core/src/ReExports/MuiDataGridReExports.ts","../../../packages/core/src/ReExports/MuiReExports.ts","../../../packages/core/src/ReExports/list.ts","../../../packages/core/src/util/layouts/SceneGraph.ts","../../../packages/core/src/ReExports/modules.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/util.ts","../../../plugins/linear-genome-view/src/LinearBareDisplay/model.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/drawSyntenyUtils.ts","../../../packages/core/src/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions.ts","../../../packages/core/src/util/offscreenCanvasGetSerializingSvg.ts","../../../packages/core/src/util/io/index.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/TrackHeightMixin.tsx","../../../packages/core/src/ui/AssemblySelector.tsx","../../../plugins/alignments/src/MismatchParser/index.ts","../../../plugins/alignments/src/MismatchParser/cigarToMismatches.ts","../../../plugins/alignments/src/MismatchParser/mdToMismatches.ts","../../../packages/core/src/ui/CascadingMenuButton.tsx","../../../plugins/data-management/src/UCSCTrackHubConnection/configSchema.ts","../../../plugins/data-management/src/UCSCTrackHubConnection/model.ts","../../../plugins/data-management/src/UCSCTrackHubConnection/index.ts","../../../plugins/alignments/src/ModificationParser/consts.ts","../../../plugins/wiggle/src/BigWigAdapter/configSchema.ts","../../../plugins/wiggle/src/CreateMultiWiggleExtension/index.ts","../../../plugins/wiggle/src/DensityRenderer/DensityRenderer.ts","../../../plugins/wiggle/src/configSchema.ts","../../../plugins/wiggle/src/DensityRenderer/configSchema.ts","../../../plugins/wiggle/src/LinePlotRenderer/LinePlotRenderer.ts","../../../plugins/wiggle/src/LinePlotRenderer/configSchema.ts","../../../plugins/wiggle/src/shared/SharedWiggleConfigSchema.ts","../../../plugins/wiggle/src/MultiDensityRenderer/MultiDensityRenderer.ts","../../../plugins/wiggle/src/MultiDensityRenderer/configSchema.ts","../../../plugins/wiggle/src/MultiLineRenderer/MultiLineRenderer.ts","../../../plugins/wiggle/src/MultiLineRenderer/configSchema.ts","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/model.ts","../../../plugins/wiggle/src/saveTrackFormats/bedGraph.ts","../../../plugins/wiggle/src/MultiRowLineRenderer/MultiRowLineRenderer.ts","../../../plugins/wiggle/src/MultiRowLineRenderer/configSchema.ts","../../../plugins/wiggle/src/MultiRowXYPlotRenderer/MultiRowXYPlotRenderer.ts","../../../plugins/wiggle/src/MultiRowXYPlotRenderer/configSchema.ts","../../../plugins/wiggle/src/MultiWiggleAdapter/configSchema.ts","../../../plugins/wiggle/src/MultiXYPlotRenderer/MultiXYPlotRenderer.ts","../../../plugins/wiggle/src/MultiXYPlotRenderer/configSchema.ts","../../../plugins/wiggle/src/WiggleRPC/WiggleGetGlobalQuantitativeStats.ts","../../../plugins/wiggle/src/WiggleRPC/WiggleGetMultiRegionQuantitativeStats.ts","../../../plugins/wiggle/src/WiggleRPC/MultiWiggleGetSources.ts","../../../plugins/wiggle/src/WiggleRPC/MultiWiggleGetScoreMatrix.ts","../../../plugins/wiggle/src/WiggleRPC/MultiWiggleClusterScoreMatrix.ts","../../../plugins/wiggle/src/XYPlotRenderer/XYPlotRenderer.ts","../../../plugins/wiggle/src/XYPlotRenderer/configSchema.ts","../../../plugins/wiggle/src/index.ts","../../../plugins/wiggle/src/MultiWiggleAdapter/index.ts","../../../plugins/wiggle/src/BigWigAdapter/index.ts","../../../plugins/wiggle/src/QuantitativeTrack/index.ts","../../../plugins/wiggle/src/QuantitativeTrack/configSchema.ts","../../../plugins/wiggle/src/MultiQuantitativeTrack/index.ts","../../../plugins/wiggle/src/MultiQuantitativeTrack/configSchema.ts","../../../plugins/wiggle/src/LinearWiggleDisplay/index.ts","../../../plugins/wiggle/src/LinearWiggleDisplay/configSchema.ts","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/index.ts","../../../plugins/wiggle/src/MultiLinearWiggleDisplay/configSchema.ts","../../../plugins/wiggle/src/LinePlotRenderer/index.ts","../../../plugins/wiggle/src/XYPlotRenderer/index.ts","../../../plugins/wiggle/src/DensityRenderer/index.ts","../../../plugins/wiggle/src/MultiXYPlotRenderer/index.ts","../../../plugins/wiggle/src/MultiRowXYPlotRenderer/index.ts","../../../plugins/wiggle/src/MultiDensityRenderer/index.ts","../../../plugins/wiggle/src/MultiLineRenderer/index.ts","../../../plugins/wiggle/src/MultiRowLineRenderer/index.ts","../../../plugins/wiggle/src/MultiWiggleAddTrackWorkflow/index.ts","../../../plugins/wiggle/src/GuessAdapter/index.ts","../../../packages/core/src/data_adapters/BaseAdapter/BaseSequenceAdapter.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/util.ts","../../../packages/core/src/util/useMeasure.ts","../../../packages/core/src/data_adapters/dataAdapterCache.ts","../../../plugins/variants/src/ChordVariantDisplay/models/renderReaction.ts","../../../packages/core/src/pluggableElementTypes/AddTrackWorkflowType.ts","../../../packages/core/src/pluggableElementTypes/renderers/util.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/util.ts","../../../plugins/linear-genome-view/src/LinearFeatureDisplay/model.ts","../../../packages/core/src/util/nanoid.ts","../../../packages/core/src/pluggableElementTypes/renderers/ServerSideRendererType.tsx","../../../packages/core/src/util/layouts/intervalUtils.ts","../../../packages/core/src/util/layouts/PileupLayout.ts","../../../packages/core/src/util/tss-react/tools/classnames.ts","../../../packages/core/src/pluggableElementTypes/renderers/CircularChordRendererType.tsx","../../../packages/core/src/pluggableElementTypes/renderers/util/serializableFilterChain.ts","../../../packages/core/src/pluggableElementTypes/TextSearchAdapterType.ts","../../../plugins/wiggle/src/LinearWiggleDisplay/components/WiggleDisplayComponent.tsx","../../../plugins/alignments/src/shared/util.ts","../../../packages/core/src/util/mst-reflection.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RefNameAutocomplete/EndAdornment.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/SearchBox.tsx","../../../packages/core/src/data_adapters/BaseAdapter/BaseFeatureDataAdapter.ts","../../../packages/core/src/pluggableElementTypes/GlyphType.ts","../../../packages/core/src/util/layouts/GranularRectLayout.ts","../../../packages/core/src/ui/SanitizedHTML.tsx","../../../packages/core/src/util/tss-react/index.ts","../../../packages/core/src/util/stopToken.ts","../../../packages/core/src/util/isWebWorker.ts","../../../packages/core/src/util/simpleFeature.ts","../../../packages/core/src/util/offscreenCanvasPonyfill.tsx","../../../packages/core/src/util/locString.ts","../../../packages/core/src/util/blockTypes.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/components/faceted/util.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RefNameAutocomplete/AutocompleteTextField.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RefNameAutocomplete/index.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/RefNameAutocomplete/util.ts","../../../plugins/alignments/src/shared/forEachMismatchTypes.ts","../../../packages/core/src/Plugin.ts","../../../packages/core/src/data_adapters/BaseAdapter/BaseAdapter.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/consts.ts","../../../packages/core/src/util/flatqueue/index.ts","../../../packages/core/src/util/flatbush/index.ts","../../../packages/core/src/util/compositeMap.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/model.ts","../../../packages/core/src/util/makeAbortableReaction.ts","../../../packages/core/src/pluggableElementTypes/AdapterType.ts","../../../plugins/alignments/src/shared/modificationData.ts","../../../packages/core/src/util/dedupe.ts","../../../packages/core/src/pluggableElementTypes/DisplayType.ts","../../../packages/core/src/pluggableElementTypes/models/BaseDisplayModel.tsx","../../../packages/core/src/util/rpc.ts","../../../packages/core/src/pluggableElementTypes/renderers/LayoutSession.ts","../../../packages/core/src/pluggableElementTypes/renderers/BoxRendererType.ts","../../../packages/core/src/ui/FactoryResetDialog.tsx","../../../packages/core/src/ui/FatalErrorDialog.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/Cytobands.tsx","../../../packages/core/src/util/tss-react/cssAndCx.ts","../../../packages/core/src/util/tss-react/types.ts","../../../packages/core/src/util/tss-react/makeStyles.tsx","../../../packages/core/src/util/tss-react/mui/mui.ts","../../../packages/core/src/util/tss-react/tools/getDependencyArrayRef.ts","../../../packages/core/src/util/tss-react/mergeClasses.ts","../../../packages/core/src/util/convertCodingSequenceToPeptides.ts","../../../packages/core/src/util/types/mst.ts","../../../plugins/data-management/src/AddConnectionWidget/model.ts","../../../plugins/data-management/src/AddConnectionWidget/index.ts","../../../packages/core/src/util/Base1DViewModel.ts","../../../packages/core/src/ui/Logo.tsx","../../../packages/core/src/util/tracks.ts","../../../packages/core/src/util/idMaker.ts","../../../packages/core/src/util/color/cssColorsLevel4.ts","../../../packages/core/src/util/color/index.ts","../../../packages/core/src/ui/BaseTooltip.tsx","../../../plugins/wiggle/src/WiggleRPC/getScoreMatrix.ts","../../../packages/core/src/util/map-obj/index.ts","../../../packages/core/src/pluggableElementTypes/RpcMethodType.ts","../../../plugins/wiggle/src/LinearWiggleDisplay/model.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/FloatingLabels.tsx","../../../plugins/linear-genome-view/src/LinearBasicDisplay/components/LinearBasicDisplayComponent.tsx","../../../packages/core/src/pluggableElementTypes/models/saveTrackFileTypes/bed.ts","../../../packages/core/src/pluggableElementTypes/models/saveTrackFileTypes/genbank.ts","../../../packages/core/src/pluggableElementTypes/models/saveTrackFileTypes/fetchSequence.ts","../../../packages/core/src/pluggableElementTypes/models/saveTrackFileTypes/gff3.ts","../../../packages/core/src/pluggableElementTypes/models/BaseTrackModel.ts","../../../plugins/alignments/src/shared/getUniqueModifications.ts","../../../plugins/wiggle/src/shared/YScaleBar.tsx","../../../plugins/config/src/ConfigurationEditorWidget/components/HeadingComponent.tsx","../../../plugins/config/src/ConfigurationEditorWidget/index.ts","../../../plugins/config/src/FromConfigAdapter/configSchema.ts","../../../plugins/config/src/FromConfigRegionsAdapter/configSchema.ts","../../../plugins/config/src/FromConfigSequenceAdapter/configSchema.ts","../../../plugins/config/src/NcbiSequenceReportAliasAdapter/configSchema.ts","../../../plugins/config/src/RefNameAliasAdapter/configSchema.ts","../../../plugins/config/src/index.ts","../../../plugins/config/src/FromConfigAdapter/index.ts","../../../plugins/config/src/FromConfigRegionsAdapter/index.ts","../../../plugins/config/src/FromConfigSequenceAdapter/index.ts","../../../plugins/config/src/RefNameAliasAdapter/index.ts","../../../plugins/config/src/ConfigurationEditorWidget/model.ts","../../../plugins/config/src/NcbiSequenceReportAliasAdapter/index.ts","../../../packages/core/src/data_adapters/BaseAdapter/util.ts","../../../packages/core/src/TextSearch/BaseResults.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/facetedUtil.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/util.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/facetedModel.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/filterTracks.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/generateHierarchy.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/sortUtils.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/model.ts","../../../packages/core/src/util/calculateDynamicBlocks.ts","../../../plugins/variants/src/shared/constants.ts","../../../packages/core/src/ui/FileSelector/LocalFileChooser.tsx","../../../packages/core/src/ui/FileSelector/UrlChooser.tsx","../../../packages/core/src/ui/FileSelector/LocationInput.tsx","../../../packages/core/src/ui/FileSelector/SourceTypeSelector.tsx","../../../packages/core/src/ui/FileSelector/useInternetAccounts.ts","../../../packages/core/src/ui/FileSelector/FileSelector.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/BlockMsg.tsx","../../../packages/core/src/util/Base1DUtils.ts","../../../packages/core/src/util/renderToAbstractCanvas.ts","../../../plugins/linear-genome-view/src/searchUtils.ts","../../../packages/core/src/util/blobToDataURL.ts","../../../packages/core/src/ui/ExternalLink.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/FloatingLegend.tsx","../../../packages/core/src/ui/Dialog.tsx","../../../plugins/alignments/src/util.ts","../../../packages/core/src/ui/EditableTypography.tsx","../../../packages/core/src/util/rxjs.ts","../../../packages/core/src/ui/LoadingEllipses.tsx","../../../packages/core/src/util/layouts/PrecomputedLayout.ts","../../../packages/core/src/configuration/configurationSlot.ts","../../../packages/core/src/configuration/configurationSchema.ts","../../../packages/core/src/pluggableElementTypes/models/BaseConnectionModelFactory.ts","../../../packages/core/src/util/calculateStaticBlocks.ts","../../../packages/core/src/ui/ErrorBoundary.tsx","../../../packages/core/src/BaseFeatureWidget/util.tsx","../../../packages/core/src/pluggableElementTypes/PluggableElementBase.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/configSchema.ts","../../../plugins/data-management/src/HierarchicalTrackSelectorWidget/index.ts","../../../packages/core/src/ui/PrerenderedCanvas.tsx","../../../plugins/linear-genome-view/src/LinearBareDisplay/configSchema.ts","../../../plugins/linear-genome-view/src/LinearBasicDisplay/model.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/HeaderZoomControls.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/HeaderPanControls.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/HeaderRegionWidth.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/HeaderTrackSelectorButton.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewHighlight.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewRubberbandHoverTooltip.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewRubberband.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewScalebarTickLabels.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/OverviewScalebar.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/Header.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/components/MiniControls.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/menuItems.tsx","../../../plugins/linear-genome-view/src/LinearGenomeView/model.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/keyboardHandler.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/afterAttach.ts","../../../plugins/linear-genome-view/src/index.ts","../../../plugins/linear-genome-view/src/FeatureTrack/index.ts","../../../plugins/linear-genome-view/src/FeatureTrack/configSchema.ts","../../../plugins/linear-genome-view/src/BasicTrack/index.ts","../../../plugins/linear-genome-view/src/BasicTrack/configSchema.ts","../../../plugins/linear-genome-view/src/LinearBasicDisplay/index.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/index.ts","../../../plugins/linear-genome-view/src/LinearBareDisplay/index.ts","../../../plugins/linear-genome-view/src/LaunchLinearGenomeView/index.ts","../../../plugins/variants/src/shared/minorAlleleFrequencyUtils.ts","../../../plugins/alignments/src/AlignmentsFeatureDetail/configSchema.ts","../../../plugins/alignments/src/AlignmentsFeatureDetail/stateModelFactory.ts","../../../plugins/alignments/src/AlignmentsFeatureDetail/index.ts","../../../plugins/alignments/src/saveTrackFormats/sam.ts","../../../plugins/alignments/src/AlignmentsTrack/index.ts","../../../plugins/alignments/src/AlignmentsTrack/configSchemaF.ts","../../../plugins/alignments/src/BamAdapter/configSchema.ts","../../../plugins/alignments/src/BamAdapter/index.ts","../../../plugins/alignments/src/CramAdapter/configSchema.ts","../../../plugins/alignments/src/CramAdapter/index.ts","../../../plugins/alignments/src/GuessAlignmentsTypes/index.ts","../../../plugins/alignments/src/HtsgetBamAdapter/configSchema.ts","../../../plugins/alignments/src/HtsgetBamAdapter/index.ts","../../../plugins/alignments/src/LinearAlignmentsDisplay/util.ts","../../../plugins/alignments/src/LinearAlignmentsDisplay/model.ts","../../../plugins/alignments/src/LinearAlignmentsDisplay/alignmentsModel.tsx","../../../plugins/alignments/src/LinearAlignmentsDisplay/index.ts","../../../plugins/alignments/src/LinearAlignmentsDisplay/configSchema.ts","../../../plugins/alignments/src/LinearPileupDisplay/configSchema.ts","../../../plugins/alignments/src/LinearPileupDisplay/components/LinearPileupDisplayBlurb.tsx","../../../plugins/alignments/src/shared/legendUtils.ts","../../../plugins/alignments/src/shared/menuItems.ts","../../../plugins/alignments/src/LinearPileupDisplay/SharedLinearPileupDisplayMixin.ts","../../../plugins/alignments/src/shared/SharedModificationsMixin.ts","../../../plugins/alignments/src/LinearPileupDisplay/model.ts","../../../plugins/alignments/src/LinearPileupDisplay/index.ts","../../../plugins/alignments/src/LinearReadArcsDisplay/configSchema.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/NonBlockCanvasDisplayMixin.tsx","../../../plugins/alignments/src/shared/LinearReadDisplayBaseMixin.ts","../../../plugins/alignments/src/LinearReadArcsDisplay/model.ts","../../../plugins/alignments/src/shared/LinearReadArcsDisplaySettingsMixin.ts","../../../plugins/alignments/src/LinearReadArcsDisplay/index.ts","../../../plugins/alignments/src/LinearReadCloudDisplay/configSchema.ts","../../../plugins/alignments/src/LinearReadCloudDisplay/model.ts","../../../plugins/alignments/src/shared/LinearReadDisplayWithLayoutMixin.ts","../../../plugins/alignments/src/shared/LinearReadDisplayWithPairFiltersMixin.ts","../../../plugins/alignments/src/LinearReadArcsDisplay/chainToSimpleFeature.ts","../../../plugins/alignments/src/LinearReadCloudDisplay/index.ts","../../../plugins/alignments/src/LinearSNPCoverageDisplay/model.ts","../../../plugins/alignments/src/LinearSNPCoverageDisplay/index.ts","../../../plugins/alignments/src/LinearSNPCoverageDisplay/configSchema.ts","../../../plugins/alignments/src/PileupRPC/base.ts","../../../plugins/alignments/src/PileupRPC/methods/GetGlobalValueForTag.ts","../../../plugins/alignments/src/ModificationParser/getModTypes.ts","../../../plugins/alignments/src/PileupRPC/methods/GetVisibleModifications.ts","../../../plugins/alignments/src/ModificationParser/detectSimplexModifications.ts","../../../plugins/alignments/src/PileupRPC/index.ts","../../../plugins/alignments/src/PileupRenderer/PileupLayoutSession.ts","../../../plugins/alignments/src/PileupRenderer/PileupRenderer.ts","../../../plugins/alignments/src/PileupRenderer/configSchema.ts","../../../plugins/alignments/src/PileupRenderer/index.ts","../../../plugins/alignments/src/RenderLinearReadArcsDisplayRPC/RenderLinearReadArcsDisplay.ts","../../../plugins/alignments/src/RenderLinearReadArcsDisplayRPC/index.ts","../../../plugins/alignments/src/RenderLinearReadCloudDisplayRPC/RenderLinearReadCloudDisplay.ts","../../../plugins/alignments/src/RenderLinearReadCloudDisplayRPC/index.ts","../../../plugins/alignments/src/SNPCoverageAdapter/configSchema.ts","../../../plugins/alignments/src/SNPCoverageAdapter/index.ts","../../../plugins/alignments/src/SNPCoverageRenderer/SNPCoverageRenderer.ts","../../../plugins/alignments/src/SNPCoverageRenderer/configSchema.ts","../../../plugins/alignments/src/SNPCoverageRenderer/index.ts","../../../plugins/alignments/src/index.ts","../../../plugins/arc/src/ArcRenderer/ArcRenderer.ts","../../../plugins/arc/src/ArcRenderer/configSchema.ts","../../../plugins/arc/src/LinearArcDisplay/model.ts","../../../plugins/arc/src/LinearPairedArcDisplay/model.ts","../../../plugins/arc/src/index.ts","../../../plugins/arc/src/ArcRenderer/index.ts","../../../plugins/arc/src/LinearArcDisplay/index.ts","../../../plugins/arc/src/LinearArcDisplay/configSchema.ts","../../../plugins/arc/src/LinearPairedArcDisplay/index.ts","../../../plugins/arc/src/LinearPairedArcDisplay/configSchema.ts","../../../plugins/authentication/src/OAuthModel/configSchema.ts","../../../plugins/authentication/src/DropboxOAuthModel/configSchema.ts","../../../plugins/authentication/src/DropboxOAuthModel/DropboxIcon.tsx","../../../plugins/authentication/src/util.ts","../../../plugins/authentication/src/DropboxOAuthModel/util.ts","../../../plugins/authentication/src/OAuthModel/util.ts","../../../plugins/authentication/src/OAuthModel/model.tsx","../../../plugins/authentication/src/DropboxOAuthModel/model.tsx","../../../plugins/authentication/src/ExternalTokenModel/configSchema.ts","../../../plugins/authentication/src/ExternalTokenModel/ExternalTokenEntryForm.tsx","../../../plugins/authentication/src/ExternalTokenModel/model.tsx","../../../plugins/authentication/src/GoogleDriveOAuthModel/configSchema.ts","../../../plugins/authentication/src/GoogleDriveOAuthModel/GoogleDriveFilehandle.ts","../../../plugins/authentication/src/GoogleDriveOAuthModel/GoogleDriveIcon.tsx","../../../plugins/authentication/src/GoogleDriveOAuthModel/util.ts","../../../plugins/authentication/src/GoogleDriveOAuthModel/model.tsx","../../../plugins/authentication/src/HTTPBasicModel/configSchema.ts","../../../plugins/authentication/src/HTTPBasicModel/HTTPBasicLoginForm.tsx","../../../plugins/authentication/src/HTTPBasicModel/model.tsx","../../../plugins/authentication/src/index.ts","../../../plugins/bed/src/BedAdapter/configSchema.ts","../../../plugins/bed/src/BedGraphAdapter/configSchema.ts","../../../plugins/bed/src/BedGraphTabixAdapter/configSchema.ts","../../../plugins/bed/src/BedTabixAdapter/configSchema.ts","../../../plugins/bed/src/BedpeAdapter/configSchema.ts","../../../plugins/bed/src/BigBedAdapter/configSchema.ts","../../../plugins/bed/src/index.ts","../../../plugins/bed/src/BigBedAdapter/index.ts","../../../plugins/bed/src/BedAdapter/index.ts","../../../plugins/bed/src/BedpeAdapter/index.ts","../../../plugins/bed/src/BedTabixAdapter/index.ts","../../../plugins/bed/src/BedGraphAdapter/index.ts","../../../plugins/bed/src/BedGraphTabixAdapter/index.ts","../../../plugins/bed/src/GuessAdapter/index.ts","../../../plugins/breakpoint-split-view/src/BreakpointAlignmentsFeatureDetail/index.ts","../../../plugins/breakpoint-split-view/src/BreakpointGetFeatures/BreakpointGetFeatures.ts","../../../plugins/breakpoint-split-view/src/BreakpointSplitView/model.ts","../../../plugins/breakpoint-split-view/src/index.ts","../../../plugins/breakpoint-split-view/src/BreakpointSplitView/index.ts","../../../plugins/breakpoint-split-view/src/LaunchBreakpointSplitView/index.ts","../../../plugins/breakpoint-split-view/src/BreakpointGetFeatures/index.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/renderConfig.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/util.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/floatingLabels.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/glyphUtils.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/drawChevrons.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/box.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/zoomThresholds.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/cds.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/peptides/prepareAminoAcidData.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/peptides/aggregateAminoAcids.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/peptides/drawCDSBackground.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/peptides/drawPeptidesOnCDS.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/matureProteinRegion.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/filterSubparts.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/processed.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/repeatRegion.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/segments.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/labelUtils.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/childGlyphs.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/subfeatures.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/glyphs/index.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/layout/layoutFeature.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/drawFeature.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/types.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/layout/layoutUtils.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/makeImageData.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/peptides/peptideUtils.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/doAll.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/layout/layoutFeatures.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/CanvasFeatureRenderer.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/configSchema.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/configSchema2.ts","../../../plugins/canvas/src/index.ts","../../../plugins/canvas/src/CanvasFeatureRenderer/index.ts","../../../plugins/circular-view/src/CircularView/viewportVisibleRegion.ts","../../../plugins/circular-view/src/CircularView/slices.ts","../../../plugins/circular-view/src/CircularView/model.ts","../../../plugins/circular-view/src/index.ts","../../../plugins/circular-view/src/CircularView/index.ts","../../../plugins/circular-view/src/LaunchCircularView/index.ts","../../../plugins/comparative-adapters/src/BlastTabularAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/ChainAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/syntenyTypes.ts","../../../plugins/comparative-adapters/src/ComparativeAddTrackComponent/index.tsx","../../../plugins/comparative-adapters/src/DeltaAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/MCScanAddTrackComponent/index.tsx","../../../plugins/comparative-adapters/src/MCScanAnchorsAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/MCScanSimpleAnchorsAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/MashMapAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/PAFAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/PairwiseIndexedPAFAdapter/configSchema.ts","../../../plugins/comparative-adapters/src/index.ts","../../../plugins/comparative-adapters/src/PAFAdapter/index.ts","../../../plugins/comparative-adapters/src/PairwiseIndexedPAFAdapter/index.ts","../../../plugins/comparative-adapters/src/DeltaAdapter/index.ts","../../../plugins/comparative-adapters/src/ChainAdapter/index.ts","../../../plugins/comparative-adapters/src/MCScanAnchorsAdapter/index.ts","../../../plugins/comparative-adapters/src/MCScanSimpleAnchorsAdapter/index.ts","../../../plugins/comparative-adapters/src/MashMapAdapter/index.ts","../../../plugins/comparative-adapters/src/BlastTabularAdapter/index.ts","../../../plugins/comparative-adapters/src/GuessAdapter/index.ts","../../../plugins/dotplot-view/src/ComparativeRenderer/index.ts","../../../plugins/dotplot-view/src/DotplotView/1dview.ts","../../../plugins/dotplot-view/src/DiagonalizeDotplotRpc.ts","../../../plugins/dotplot-view/src/ServerSideRenderedBlockContent.tsx","../../../plugins/dotplot-view/src/DotplotDisplay/renderDotplotBlock.ts","../../../plugins/dotplot-view/src/DotplotDisplay/stateModelFactory.tsx","../../../plugins/dotplot-view/src/DotplotReadVsRef/DotplotReadVsRef.ts","../../../plugins/dotplot-view/src/DotplotRenderer/DotplotRenderer.ts","../../../plugins/dotplot-view/src/DotplotRenderer/configSchema.ts","../../../plugins/dotplot-view/src/DotplotView/model.ts","../../../plugins/dotplot-view/src/index.ts","../../../plugins/dotplot-view/src/DotplotDisplay/index.ts","../../../plugins/dotplot-view/src/DotplotView/index.ts","../../../plugins/dotplot-view/src/DotplotRenderer/index.ts","../../../plugins/dotplot-view/src/LaunchDotplotView.ts","../../../plugins/dotplot-view/src/DotplotReadVsRef/index.ts","../../../plugins/gccontent/src/GCContentTrack/index.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/shared.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/index.ts","../../../plugins/gccontent/src/index.ts","../../../plugins/gccontent/src/GCContentAdapter/index.ts","../../../plugins/gccontent/src/GCContentAdapter/configSchema.ts","../../../plugins/gccontent/src/GCContentTrack/configSchema.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/config1.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/stateModel1.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/config2.ts","../../../plugins/gccontent/src/LinearGCContentDisplay/stateModel2.ts","../../../plugins/gff3/src/Gff3Adapter/configSchema.ts","../../../plugins/gff3/src/Gff3TabixAdapter/configSchema.ts","../../../plugins/gff3/src/index.ts","../../../plugins/gff3/src/Gff3TabixAdapter/index.ts","../../../plugins/gff3/src/Gff3Adapter/index.ts","../../../plugins/gff3/src/GuessGff3/index.ts","../../../plugins/grid-bookmark/src/GridBookmarkWidget/components/Highlight/Highlight.tsx","../../../plugins/grid-bookmark/src/GridBookmarkWidget/components/Highlight/OverviewHighlight.tsx","../../../plugins/grid-bookmark/src/GridBookmarkWidget/model.ts","../../../plugins/grid-bookmark/src/GridBookmarkWidget/index.ts","../../../plugins/grid-bookmark/src/index.ts","../../../plugins/grid-bookmark/src/GridBookmarkWidget/components/Highlight/index.tsx","../../../plugins/gtf/src/GtfAdapter/configSchema.ts","../../../plugins/gtf/src/index.ts","../../../plugins/gtf/src/GtfAdapter/index.ts","../../../plugins/gtf/src/GuessAdapter/index.ts","../../../plugins/hic/src/HicAdapter/configSchema.ts","../../../plugins/hic/src/HicRenderer/HicRenderer.tsx","../../../plugins/hic/src/HicRenderer/configSchema.ts","../../../plugins/hic/src/LinearHicDisplay/model.ts","../../../plugins/hic/src/index.ts","../../../plugins/hic/src/HicAdapter/index.ts","../../../plugins/hic/src/HicRenderer/index.ts","../../../plugins/hic/src/HicTrack/index.ts","../../../plugins/hic/src/HicTrack/configSchema.ts","../../../plugins/hic/src/LinearHicDisplay/index.ts","../../../plugins/hic/src/LinearHicDisplay/configSchema.ts","../../../plugins/hic/src/GuessAdapter/index.ts","../../../plugins/jobs-management/src/JobsListWidget/jobModel.ts","../../../plugins/jobs-management/src/JobsListWidget/index.ts","../../../plugins/jobs-management/src/index.ts","../../../plugins/jobs-management/src/JobsListWidget/model.ts","../../../plugins/legacy-jbrowse/src/JBrowse1Connection/configSchema.ts","../../../plugins/legacy-jbrowse/src/JBrowse1Connection/model.ts","../../../plugins/legacy-jbrowse/src/JBrowse1TextSearchAdapter/configSchema.ts","../../../plugins/legacy-jbrowse/src/NCListAdapter/configSchema.ts","../../../plugins/legacy-jbrowse/src/index.ts","../../../plugins/legacy-jbrowse/src/NCListAdapter/index.ts","../../../plugins/legacy-jbrowse/src/GuessNCList/index.ts","../../../plugins/legacy-jbrowse/src/JBrowse1TextSearchAdapter/index.ts","../../../plugins/legacy-jbrowse/src/JBrowse1Connection/index.ts","../../../plugins/linear-comparative-view/src/LGVSyntenyDisplay/configSchemaF.ts","../../../plugins/linear-comparative-view/src/LGVSyntenyDisplay/model.ts","../../../plugins/linear-comparative-view/src/LinearComparativeDisplay/configSchemaF.ts","../../../plugins/linear-comparative-view/src/LinearComparativeDisplay/stateModelFactory.ts","../../../plugins/linear-comparative-view/src/LinearComparativeView/model.ts","../../../plugins/linear-comparative-view/src/LinearReadVsRef/index.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/model.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyView/components/Icons.tsx","../../../plugins/linear-comparative-view/src/LinearSyntenyView/model.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyViewHelper/stateModelFactory.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyViewHelper/index.tsx","../../../plugins/linear-comparative-view/src/SyntenyFeatureDetail/index.ts","../../../plugins/linear-comparative-view/src/index.ts","../../../plugins/linear-comparative-view/src/LinearComparativeView/index.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyView/index.ts","../../../plugins/linear-comparative-view/src/LinearComparativeDisplay/index.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/index.ts","../../../plugins/linear-comparative-view/src/LinearSyntenyDisplay/configSchemaF.ts","../../../plugins/linear-comparative-view/src/LGVSyntenyDisplay/index.ts","../../../plugins/linear-comparative-view/src/LaunchLinearSyntenyView.ts","../../../plugins/linear-comparative-view/src/SyntenyTrack/index.tsx","../../../plugins/linear-comparative-view/src/SyntenyTrack/configSchema.ts","../../../plugins/lollipop/src/LinearLollipopDisplay/model.ts","../../../plugins/lollipop/src/LollipopRenderer/LollipopRenderer.ts","../../../plugins/lollipop/src/LollipopRenderer/configSchema.ts","../../../plugins/lollipop/src/index.ts","../../../plugins/lollipop/src/LollipopRenderer/index.ts","../../../plugins/lollipop/src/LinearLollipopDisplay/index.ts","../../../plugins/lollipop/src/LinearLollipopDisplay/configSchema.ts","../../../plugins/menus/src/AboutWidget/index.ts","../../../plugins/menus/src/HelpWidget/index.ts","../../../plugins/menus/src/ImportSessionWidget/index.ts","../../../plugins/menus/src/SessionManager/index.ts","../../../plugins/menus/src/index.ts","../../../plugins/rdf/src/SPARQLAdapter/configSchema.ts","../../../plugins/rdf/src/index.ts","../../../plugins/rdf/src/SPARQLAdapter/index.ts","../../../plugins/sequence/src/BgzipFastaAdapter/configSchema.ts","../../../plugins/sequence/src/ChromSizesAdapter/configSchema.ts","../../../plugins/sequence/src/DivSequenceRenderer/configSchema.ts","../../../plugins/sequence/src/DivSequenceRenderer/index.ts","../../../plugins/sequence/src/IndexedFastaAdapter/configSchema.ts","../../../plugins/sequence/src/LinearReferenceSequenceDisplay/configSchema.ts","../../../plugins/sequence/src/saveTrackFormats/fasta.ts","../../../plugins/sequence/src/SequenceSearchAdapter/configSchema.ts","../../../plugins/sequence/src/TwoBitAdapter/configSchema.ts","../../../plugins/sequence/src/UnindexedFastaAdapter/configSchema.ts","../../../plugins/sequence/src/index.ts","../../../plugins/sequence/src/TwoBitAdapter/index.ts","../../../plugins/sequence/src/BgzipFastaAdapter/index.ts","../../../plugins/sequence/src/ChromSizesAdapter/index.ts","../../../plugins/sequence/src/IndexedFastaAdapter/index.ts","../../../plugins/sequence/src/UnindexedFastaAdapter/index.ts","../../../plugins/sequence/src/SequenceSearchAdapter/index.ts","../../../plugins/sequence/src/ReferenceSequenceTrack/index.ts","../../../plugins/sequence/src/ReferenceSequenceTrack/configSchema.ts","../../../plugins/sequence/src/LinearReferenceSequenceDisplay/index.ts","../../../plugins/sequence/src/LinearReferenceSequenceDisplay/model.ts","../../../plugins/sequence/src/createExtensionPoints.ts","../../../plugins/spreadsheet-view/src/SpreadsheetView/ImportWizard.ts","../../../plugins/spreadsheet-view/src/SpreadsheetView/util.ts","../../../plugins/spreadsheet-view/src/SpreadsheetView/components/FeatureMenu.tsx","../../../plugins/spreadsheet-view/src/SpreadsheetView/components/LocationCell.tsx","../../../plugins/spreadsheet-view/src/SpreadsheetView/SpreadsheetViewModel.ts","../../../plugins/spreadsheet-view/src/SpreadsheetView/SpreadsheetModel.tsx","../../../plugins/spreadsheet-view/src/index.ts","../../../plugins/spreadsheet-view/src/SpreadsheetView/index.ts","../../../plugins/spreadsheet-view/src/LaunchSpreadsheetView/index.ts","../../../plugins/sv-inspector/src/SvInspectorView/model.ts","../../../plugins/sv-inspector/src/SvInspectorView/index.ts","../../../plugins/sv-inspector/src/index.ts","../../../plugins/sv-inspector/src/LaunchSvInspectorView/index.ts","../../../plugins/trix/src/TrixTextSearchAdapter/configSchema.ts","../../../plugins/trix/src/index.ts","../../../plugins/variants/src/ChordVariantDisplay/models/stateModelFactory.ts","../../../plugins/linear-genome-view/src/LinearFeatureDisplay/configSchema.ts","../../../plugins/variants/src/LinearVariantDisplay/model.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/count.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/index.ts","../../../plugins/variants/src/d3-hierarchy2/cluster.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/each.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/eachAfter.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/eachBefore.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/find.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/sum.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/sort.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/path.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/ancestors.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/descendants.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/leaves.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/links.ts","../../../plugins/variants/src/d3-hierarchy2/hierarchy/iterator.ts","../../../plugins/variants/src/shared/MultiVariantBaseModel.ts","../../../plugins/variants/src/MultiLinearVariantDisplay/model.ts","../../../plugins/variants/src/MultiLinearVariantMatrixRenderer/configSchema.ts","../../../plugins/variants/src/MultiLinearVariantMatrixDisplay/model.ts","../../../plugins/variants/src/MultiLinearVariantMatrixRenderer/MultiLinearVariantMatrixRenderer.ts","../../../plugins/variants/src/MultiLinearVariantRenderer/MultiVariantRenderer.ts","../../../plugins/variants/src/MultiLinearVariantRenderer/configSchema.ts","../../../plugins/variants/src/SplitVcfTabixAdapter/configSchema.ts","../../../plugins/variants/src/StructuralVariantChordRenderer/configSchema.ts","../../../plugins/variants/src/VariantFeatureWidget/configSchema.ts","../../../plugins/variants/src/VariantFeatureWidget/stateModelFactory.ts","../../../plugins/variants/src/VariantRPC/MultiVariantClusterGenotypeMatrix.ts","../../../plugins/variants/src/VariantRPC/MultiVariantGetGenotypeMatrix.ts","../../../plugins/variants/src/VariantRPC/MultiVariantGetSimplifiedFeatures.ts","../../../plugins/variants/src/VariantRPC/MultiVariantGetSources.ts","../../../plugins/variants/src/VariantTrack/saveTrackFormats/vcf.ts","../../../plugins/variants/src/VcfAdapter/configSchema.ts","../../../plugins/variants/src/VcfTabixAdapter/configSchema.ts","../../../plugins/variants/src/index.ts","../../../plugins/variants/src/VariantTrack/index.ts","../../../plugins/variants/src/VcfAdapter/index.ts","../../../plugins/variants/src/VcfTabixAdapter/index.ts","../../../plugins/variants/src/SplitVcfTabixAdapter/index.ts","../../../plugins/variants/src/VariantFeatureWidget/index.ts","../../../plugins/variants/src/VariantTrack/configSchema.ts","../../../plugins/variants/src/VcfExtensionPoints/index.ts","../../../plugins/variants/src/LinearVariantDisplay/index.ts","../../../plugins/variants/src/LinearVariantDisplay/configSchema.ts","../../../plugins/variants/src/MultiLinearVariantMatrixDisplay/index.ts","../../../plugins/variants/src/MultiLinearVariantMatrixDisplay/configSchema.ts","../../../plugins/variants/src/MultiLinearVariantDisplay/index.ts","../../../plugins/variants/src/MultiLinearVariantDisplay/configSchema.ts","../../../plugins/variants/src/shared/SharedVariantConfigSchema.ts","../../../plugins/variants/src/MultiLinearVariantRenderer/index.ts","../../../plugins/variants/src/MultiLinearVariantMatrixRenderer/index.ts","../../../plugins/variants/src/StructuralVariantChordRenderer/index.ts","../../../plugins/variants/src/ChordVariantDisplay/index.ts","../../../plugins/variants/src/ChordVariantDisplay/models/configSchema.ts","corePlugins.ts","../../../plugins/linear-genome-view/src/LinearGenomeView/components/util.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/LoadingOverlay.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/components/ServerSideRenderedBlockContent.tsx","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/serverSideRenderedBlock.ts","../../../plugins/linear-genome-view/src/BaseLinearDisplay/models/configSchema.ts","../../../packages/core/src/pluggableElementTypes/InternetAccountType.ts"],"sourcesContent":["import type React from 'react'\n\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { BaseInternetAccountConfig } from './baseInternetAccountConfig.ts'\nimport { ConfigurationReference, getConf } from '../../configuration/index.ts'\nimport { RemoteFileWithRangeCache } from '../../util/io/index.ts'\nimport { ElementId } from '../../util/types/mst.ts'\n\nimport type {\n  AnyReactComponentType,\n  UriLocation,\n} from '../../util/types/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nconst inWebWorker = typeof sessionStorage === 'undefined'\n\n/**\n * #stateModel BaseInternetAccountModel\n * #category internetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport const InternetAccount = types\n  .model('InternetAccount', {\n    /**\n     * #property\n     */\n    id: ElementId,\n    /**\n     * #property\n     */\n    type: types.string,\n    /**\n     * #property\n     */\n    configuration: ConfigurationReference(BaseInternetAccountConfig),\n  })\n  .views(self => ({\n    /**\n     * #getter\n     */\n    get name(): string {\n      return getConf(self, 'name')\n    },\n    /**\n     * #getter\n     */\n    get description(): string {\n      return getConf(self, 'description')\n    },\n    /**\n     * #getter\n     */\n    get internetAccountId(): string {\n      return getConf(self, 'internetAccountId') // NOTE: this is the explicitIdentifier of the config schema\n    },\n    /**\n     * #getter\n     */\n    get authHeader(): string {\n      return getConf(self, 'authHeader')\n    },\n    /**\n     * #getter\n     */\n    get tokenType(): string {\n      return getConf(self, 'tokenType')\n    },\n    /**\n     * #getter\n     */\n    get domains(): string[] {\n      return getConf(self, 'domains')\n    },\n    /**\n     * #getter\n     * Can use this to customize what is displayed in fileSelector's toggle box\n     */\n    get toggleContents(): React.ReactNode {\n      return null\n    },\n    /**\n     * #getter\n     * Can use this to customize what the fileSelector. It takes a prop called\n     * `setLocation` that should be used to set a UriLocation\n     */\n    get SelectorComponent(): AnyReactComponentType | undefined {\n      return undefined\n    },\n    /**\n     * #getter\n     * Can use this to add a label to the UrlChooser. Has no effect if a custom\n     * SelectorComponent is supplied\n     */\n    get selectorLabel(): string | undefined {\n      return undefined\n    },\n  }))\n  .views(self => ({\n    /**\n     * #method\n     * Determine whether this internetAccount provides credentials for a URL\n     * @param location  - UriLocation of resource\n     * @returns true or false\n     */\n    handlesLocation(location: UriLocation) {\n      return self.domains.some(domain => location.uri.includes(domain))\n    },\n    /**\n     * #getter\n     * The key used to store this internetAccount's token in sessionStorage\n     */\n    get tokenKey() {\n      return `${self.internetAccountId}-token`\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     * Must be implemented by a model extending or composing this one. Pass the\n     * user's token to `resolve`.\n     * @param resolve - Pass the token to this function\n     * @param reject - If there is an error getting the token, call this function\n     */\n    getTokenFromUser(\n      _resolve: (token: string) => void,\n      _reject: (error: Error) => void,\n    ): void {\n      throw new Error('getTokenFromUser must be implemented by extending model')\n    },\n    /**\n     * #action\n     */\n    storeToken(token: string) {\n      sessionStorage.setItem(self.tokenKey, token)\n    },\n    /**\n     * #action\n     */\n    removeToken() {\n      sessionStorage.removeItem(self.tokenKey)\n    },\n    /**\n     * #action\n     */\n    retrieveToken() {\n      return sessionStorage.getItem(self.tokenKey)\n    },\n    /**\n     * #action\n     * This can be used by an internetAccount to validate a token works before\n     * it is used. This is run when preAuthorizationInformation is requested,\n     * so it can be used to check that a token is valid before sending it to a\n     * worker thread. It expects the token to be returned so that this action\n     * can also be used to generate a new token (e.g. by using a refresh token)\n     * if the original one was invalid. Should throw an error if a token is\n     * invalid.\n     *\n     * @param token - Auth token\n     * @param loc - UriLocation of the resource\n     * @returns - Valid auth token\n     */\n    async validateToken(token: string, _loc: UriLocation) {\n      return token\n    },\n  }))\n  .actions(self => {\n    let tokenPromise: Promise<string> | undefined = undefined\n    return {\n      /**\n       * #action\n       * Try to get the token from the location pre-auth, from local storage,\n       * or from a previously cached promise. If token is not available, uses\n       * `getTokenFromUser`.\n       *\n       * @param location - UriLocation of the resource\n       * @returns A promise for the token\n       */\n      async getToken(location?: UriLocation): Promise<string> {\n        if (tokenPromise) {\n          return tokenPromise\n        }\n        let token = location?.internetAccountPreAuthorization?.authInfo?.token\n        if (token) {\n          tokenPromise = Promise.resolve(token)\n          return tokenPromise\n        }\n        if (inWebWorker) {\n          throw new Error(\n            'Did not get internet account pre-authorization info in worker',\n          )\n        }\n        token = self.retrieveToken()\n        if (token) {\n          tokenPromise = Promise.resolve(token)\n          return tokenPromise\n        }\n        tokenPromise = new Promise((resolve, reject) => {\n          self.getTokenFromUser(\n            token => {\n              self.storeToken(token)\n              resolve(token)\n            },\n            error => {\n              self.removeToken()\n              reject(error)\n            },\n          )\n        })\n        return tokenPromise\n      },\n    }\n  })\n  .actions(self => ({\n    /**\n     * #action\n     */\n    addAuthHeaderToInit(init?: RequestInit, token?: string) {\n      return {\n        ...init,\n        headers: new Headers({\n          // eslint-disable-next-line @typescript-eslint/no-misused-spread\n          ...init?.headers,\n          ...(token\n            ? {\n                [self.authHeader]: self.tokenType\n                  ? `${self.tokenType} ${token}`\n                  : token,\n              }\n            : {}),\n        }),\n      }\n    },\n    /**\n     * #action\n     * Gets the token and returns it along with the information needed to\n     * create a new internetAccount.\n     *\n     * @param location - UriLocation of the resource\n     * @returns\n     */\n    async getPreAuthorizationInformation(location: UriLocation) {\n      const authToken = await self.getToken(location)\n      let validatedToken: string | undefined\n      try {\n        validatedToken = await self.validateToken(authToken, location)\n      } catch (error) {\n        self.removeToken()\n        throw error\n      }\n      return {\n        internetAccountType: self.type,\n        authInfo: {\n          token: validatedToken,\n          configuration: getConf(self),\n        },\n      }\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     * Get a fetch method that will add any needed authentication headers to\n     * the request before sending it. If location is provided, it will be\n     * checked to see if it includes a token in it pre-auth information.\n     *\n     * @param loc - UriLocation of the resource\n     * @returns A function that can be used to fetch\n     */\n    getFetcher(loc?: UriLocation) {\n      return async (input: RequestInfo, init?: RequestInit) => {\n        const authToken = await self.getToken(loc)\n        const newInit = self.addAuthHeaderToInit(init, authToken)\n        return fetch(input, newInit)\n      }\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     * Gets a filehandle that uses a fetch that adds auth headers\n     * @param location - UriLocation of the resource\n     * @returns A filehandle\n     */\n    openLocation(location: UriLocation) {\n      return new RemoteFileWithRangeCache(location.uri, {\n        fetch: self.getFetcher(location),\n      })\n    },\n  }))\n\nexport type BaseInternetAccountStateModel = typeof InternetAccount\nexport type BaseInternetAccountModel = Instance<BaseInternetAccountStateModel>\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport type { BaseBlock } from '@jbrowse/core/util/blockTypes'\n\n// Warning: block widths use fractional pixels (block.widthPx) intentionally.\n// Do not round these values - rounding causes 1px gaps between blocks.\n// The parent flex container handles subpixel layout correctly.\nconst useStyles = makeStyles()(theme => ({\n  contentBlock: {\n    position: 'relative',\n    minHeight: '100%',\n    boxSizing: 'border-box',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n  },\n  elidedBlock: {\n    minHeight: '100%',\n    boxSizing: 'border-box',\n    backgroundColor: '#999',\n    backgroundImage:\n      'repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)',\n  },\n  interRegionPaddingBlock: {\n    minHeight: '100%',\n    backgroundColor: theme.palette.text.disabled,\n  },\n  boundaryPaddingBlock: {\n    minHeight: '100%',\n    backgroundColor: theme.palette.action.disabledBackground,\n  },\n}))\n\nconst ContentBlock = observer(function ContentBlock({\n  block,\n  children,\n}: {\n  block: BaseBlock\n  children: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  const { widthPx } = block\n  return (\n    <div style={{ width: widthPx }} className={classes.contentBlock}>\n      {children}\n    </div>\n  )\n})\n\nfunction ElidedBlock({ width }: { width: number }) {\n  const { classes } = useStyles()\n  return <div className={classes.elidedBlock} style={{ width }} />\n}\n\nfunction InterRegionPaddingBlock({\n  boundary,\n  width,\n  style = {},\n}: {\n  boundary: boolean\n  width: number\n  style?: React.CSSProperties\n}) {\n  const { classes } = useStyles()\n  return (\n    <div\n      style={{\n        ...style,\n        width,\n      }}\n      className={\n        boundary\n          ? classes.boundaryPaddingBlock\n          : classes.interRegionPaddingBlock\n      }\n    />\n  )\n}\n\nexport { ContentBlock, ElidedBlock, InterRegionPaddingBlock }\n","export * from './theme.ts'\nexport { LogoFull, Logomark } from './Logo.tsx'\nexport { default as AssemblySelector } from './AssemblySelector.tsx'\nexport { default as CascadingMenu } from './CascadingMenu.tsx'\nexport { default as CascadingMenuButton } from './CascadingMenuButton.tsx'\nexport { default as Dialog } from './Dialog.tsx'\nexport { default as EditableTypography } from './EditableTypography.tsx'\nexport { default as ErrorMessage } from './ErrorMessage.tsx'\nexport { default as FatalErrorDialog } from './FatalErrorDialog.tsx'\nexport { default as FileSelector } from './FileSelector/index.ts'\nexport { default as LoadingEllipses } from './LoadingEllipses.tsx'\nexport { default as Menu } from './Menu.tsx'\nexport { default as PrerenderedCanvas } from './PrerenderedCanvas.tsx'\nexport { default as ResizeHandle } from './ResizeHandle.tsx'\nexport { default as ExternalLink } from './ExternalLink.tsx'\nexport { default as SanitizedHTML } from './SanitizedHTML.tsx'\nexport { default as BaseTooltip } from './BaseTooltip.tsx'\nexport * from './Menu.tsx'\nexport * from './MenuTypes.ts'\nexport const VIEW_HEADER_HEIGHT = 28\n","import type { ScaleLinear, ScaleQuantize } from '@mui/x-charts-vendor/d3-scale'\n\nexport default function axisPropsFromTickScale(\n  scale: ScaleLinear<number, number> | ScaleQuantize<number>,\n  tickCount: number,\n) {\n  const range = scale.range()\n  const values = scale.ticks(tickCount)\n  const format = scale.tickFormat(tickCount)\n  const position = scale.copy()\n\n  return {\n    range,\n    values,\n    format,\n    position,\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport { baseLinearDisplayConfigSchema } from '../BaseLinearDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearBasicDisplay\n * #category display\n */\nfunction configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearBasicDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: pluginManager.pluggableConfigSchemaType('renderer'),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaFactory\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type DisplayType from './DisplayType.ts'\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { IAnyModelType } from '@jbrowse/mobx-state-tree'\n\nexport default class TrackType extends PluggableElementBase {\n  stateModel: IAnyModelType\n\n  configSchema: AnyConfigurationSchemaType\n\n  displayTypes: DisplayType[] = []\n\n  constructor(stuff: {\n    name: string\n    stateModel: IAnyModelType\n    displayName?: string\n    configSchema: AnyConfigurationSchemaType\n  }) {\n    super(stuff)\n    this.stateModel = stuff.stateModel\n    this.configSchema = stuff.configSchema\n  }\n\n  addDisplayType(display: DisplayType) {\n    this.displayTypes.push(display)\n  }\n}\n","import { measureText } from '@jbrowse/core/util'\n\nimport type { LegendItem } from './components/FloatingLegend.tsx'\n\nconst LEGEND_FONT_SIZE = 10\nconst LEGEND_BOX_SIZE = 12\nconst LEGEND_PADDING = 3\n\n/**\n * Calculate the width needed for an SVG legend based on the legend items.\n * Used by SVG export to add extra width for the legend area.\n */\nexport function calculateSvgLegendWidth(items: LegendItem[]): number {\n  if (items.length === 0) {\n    return 0\n  }\n  const maxLabelWidth = Math.max(\n    ...items.map(item => measureText(item.label, LEGEND_FONT_SIZE)),\n  )\n  return LEGEND_BOX_SIZE + 8 + maxLabelWidth + LEGEND_PADDING * 2 + 20\n}\n","import { useRef } from 'react'\n\nimport { PrerenderedCanvas } from '@jbrowse/core/ui'\nimport { getSession } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Region } from '@jbrowse/core/util/types'\nimport type { BaseLinearDisplayModel } from '@jbrowse/plugin-linear-genome-view'\n\nconst WiggleRendering = observer(function WiggleRendering(props: {\n  regions: Region[]\n  features: Map<string, Feature>\n  bpPerPx: number\n  width: number\n  height: number\n  blockKey: string\n  displayModel: BaseLinearDisplayModel\n}) {\n  const { regions, features, bpPerPx, width, height, displayModel } = props\n  const region = regions[0]!\n  const ref = useRef<HTMLDivElement>(null)\n\n  function getFeatureUnderMouse(eventClientX: number) {\n    // calculates feature under mouse\n    let offset = 0\n    if (ref.current) {\n      offset = ref.current.getBoundingClientRect().left\n    }\n    const offsetX = eventClientX - offset\n    const px = region.reversed ? width - offsetX : offsetX\n    const clientBp = region.start + bpPerPx * px\n    let featureUnderMouse: Feature | undefined\n    for (const feature of features.values()) {\n      // bpPerPx added to the end to accommodate \"reduced features\" (one feature per px)\n      if (\n        clientBp <= feature.get('end') + bpPerPx &&\n        clientBp >= feature.get('start')\n      ) {\n        featureUnderMouse = feature\n        break\n      }\n    }\n    return featureUnderMouse\n  }\n  return (\n    <div\n      ref={ref}\n      data-testid=\"wiggle-rendering-test\"\n      onMouseMove={e => {\n        displayModel.setFeatureIdUnderMouse(\n          getFeatureUnderMouse(e.clientX)?.id(),\n        )\n      }}\n      onClick={e => {\n        const featureId = getFeatureUnderMouse(e.clientX)?.id()\n        if (featureId) {\n          displayModel.selectFeatureById(featureId).catch((err: unknown) => {\n            console.error(err)\n            getSession(displayModel).notifyError(`${err}`, err)\n          })\n        }\n      }}\n      onMouseLeave={() => {\n        displayModel.setFeatureIdUnderMouse(undefined)\n      }}\n      style={{\n        overflow: 'visible',\n        position: 'relative',\n        height,\n      }}\n    >\n      <PrerenderedCanvas {...props} />\n    </div>\n  )\n})\n\nexport default WiggleRendering\n","/**\n * SAM flag bit constants for alignment records.\n * See SAM specification: https://samtools.github.io/hts-specs/SAMv1.pdf\n */\n\n/** Read is paired in sequencing */\nexport const SAM_FLAG_PAIRED = 1\n\n/** Read is mapped in a proper pair */\nexport const SAM_FLAG_PROPER_PAIR = 2\n\n/** Read is unmapped */\nexport const SAM_FLAG_UNMAPPED = 4\n\n/** Mate is unmapped */\nexport const SAM_FLAG_MATE_UNMAPPED = 8\n\n/** Read is on reverse strand */\nexport const SAM_FLAG_REVERSE = 16\n\n/** Mate is on reverse strand */\nexport const SAM_FLAG_MATE_REVERSE = 32\n\n/** Read is first in pair */\nexport const SAM_FLAG_FIRST_IN_PAIR = 64\n\n/** Read is second in pair */\nexport const SAM_FLAG_SECOND_IN_PAIR = 128\n\n/** Secondary alignment (not primary) */\nexport const SAM_FLAG_SECONDARY = 256\n\n/** Read fails platform/vendor quality checks */\nexport const SAM_FLAG_FAILS_QC = 512\n\n/** Read is PCR or optical duplicate */\nexport const SAM_FLAG_DUPLICATE = 1024\n\n/** Supplementary alignment (chimeric/split read) */\nexport const SAM_FLAG_SUPPLEMENTARY = 2048\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport { ConfigurationSchema } from '../../configuration/index.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\ninterface BasicTrack {\n  trackId: string\n  name: string\n  type: string\n  displays?: {\n    type: string\n    displayId?: string\n  }[]\n}\n\n/**\n * #config BaseTrack\n */\nexport function createBaseTrackConfig(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'BaseTrack',\n    {\n      /**\n       * #slot\n       */\n      name: {\n        description: 'descriptive name of the track',\n        type: 'string',\n        defaultValue: 'Track',\n      },\n      /**\n       * #slot\n       */\n      assemblyNames: {\n        description: 'name of the assembly (or assemblies) track belongs to',\n        type: 'stringArray',\n        defaultValue: ['assemblyName'],\n      },\n      /**\n       * #slot\n       */\n      description: {\n        description: 'a description of the track',\n        type: 'string',\n        defaultValue: '',\n      },\n      /**\n       * #slot\n       */\n      category: {\n        description: 'the category and sub-categories of a track',\n        type: 'stringArray',\n        defaultValue: [],\n      },\n      /**\n       * #slot\n       */\n      metadata: {\n        type: 'frozen',\n        description: 'anything to add about this track',\n        defaultValue: {},\n      },\n      /**\n       * #slot\n       */\n      rpcDriverName: {\n        type: 'string',\n        description:\n          'RPC driver to use for this track. Leave empty to use the display-level or global default.',\n        defaultValue: '',\n      },\n      /**\n       * #slot\n       */\n      adapter: pluginManager.pluggableConfigSchemaType('adapter'),\n\n      textSearching: ConfigurationSchema('textSearching', {\n        /**\n         * #slot textSearching.indexedAttributes\n         */\n        indexingAttributes: {\n          type: 'stringArray',\n          description:\n            'list of which feature attributes to index for text searching',\n          defaultValue: ['Name', 'ID'],\n        },\n        /**\n         * #slot textSearching.indexingFeatureTypesToExclude\n         */\n        indexingFeatureTypesToExclude: {\n          type: 'stringArray',\n          description: 'list of feature types to exclude in text search index',\n          defaultValue: ['CDS', 'exon'],\n        },\n\n        /**\n         * #slot textSearching.textSearchAdapter\n         */\n        textSearchAdapter: pluginManager.pluggableConfigSchemaType(\n          'text search adapter',\n        ),\n      }),\n\n      /**\n       * #slot\n       */\n      displays: types.array(pluginManager.pluggableConfigSchemaType('display')),\n\n      formatDetails: ConfigurationSchema('FormatDetails', {\n        /**\n         * #slot formatDetails.feature\n         */\n        feature: {\n          type: 'frozen',\n          description: 'adds extra fields to the feature details',\n          defaultValue: {},\n          contextVariable: ['feature'],\n        },\n        /**\n         * #slot formatDetails.subfeatures\n         */\n        subfeatures: {\n          type: 'frozen',\n          description: 'adds extra fields to the subfeatures of a feature',\n          defaultValue: {},\n          contextVariable: ['feature'],\n        },\n        /**\n         * #slot formatDetails.depth\n         */\n        depth: {\n          type: 'number',\n          defaultValue: 2,\n          description:\n            'depth of subfeatures to iterate the formatter on formatDetails.subfeatures (e.g. you may not want to format the exon/cds subfeatures, so limited to 2',\n        },\n        /**\n         * #slot formatDetails.maxDepth\n         */\n        maxDepth: {\n          type: 'number',\n          defaultValue: 99999,\n          description: 'Maximum depth to render subfeatures',\n        },\n      }),\n      formatAbout: ConfigurationSchema('FormatAbout', {\n        /**\n         * #slot formatAbout.config\n         */\n        config: {\n          type: 'frozen',\n          description: 'formats configuration object in about dialog',\n          defaultValue: {},\n          contextVariable: ['config'],\n        },\n\n        /**\n         * #slot formatAbout.hideUris\n         */\n        hideUris: {\n          type: 'boolean',\n          defaultValue: false,\n        },\n      }),\n    },\n    {\n      preProcessSnapshot: s2 => {\n        const snap = pluginManager.evaluateExtensionPoint(\n          'Core-preProcessTrackConfig',\n          structuredClone(s2),\n        ) as BasicTrack\n        const { displays = [] } = snap\n        if (snap.trackId !== 'placeholderId') {\n          // Gets the displays on the track snapshot and the possible displays\n          // from the track type and adds any missing possible displays to the\n          // snapshot\n          try {\n            const configDisplayTypes = new Set(displays.map(d => d.type))\n            for (const d of pluginManager.getTrackType(snap.type)!\n              .displayTypes) {\n              if (!configDisplayTypes.has(d.name)) {\n                displays.push({\n                  displayId: `${snap.trackId}-${d.name}`,\n                  type: d.name,\n                })\n              }\n            }\n          } catch (e) {\n            throw new Error(\n              `Unknown track type \"${snap.type}\" in ${JSON.stringify(snap)}`,\n              {\n                cause: e,\n              },\n            )\n          }\n        }\n        return {\n          ...snap,\n          displays: displays.map(d => ({\n            ...d,\n            // synthesize displayId if none provided\n            displayId: d.displayId ?? `${snap.trackId}-${d.type}`,\n          })),\n        }\n      },\n      /**\n       * #identifier\n       */\n      explicitIdentifier: 'trackId',\n      explicitlyTyped: true,\n\n      actions: (self: any) => ({\n        addDisplayConf(conf: { type: string; displayId: string }) {\n          const { type } = conf\n          if (!type) {\n            throw new Error(`unknown display type ${type}`)\n          }\n          const display = self.displays.find(\n            (d: any) => d?.displayId === conf.displayId,\n          )\n          if (display) {\n            return display\n          }\n          const length = self.displays.push(conf)\n          return self.displays[length - 1]\n        },\n      }),\n    },\n  )\n}\n\nexport type BaseTrackConfigSchema = ReturnType<typeof createBaseTrackConfig>\nexport type BaseTrackConfig = Instance<BaseTrackConfigSchema>\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseConnectionConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\n/**\n * #config JB2TrackHubConnection\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst JB2TrackHubConnection = ConfigurationSchema(\n  'JB2TrackHubConnection',\n  {\n    /**\n     * #slot\n     */\n    configJsonLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'http://mysite.com/path/to/config.json',\n        locationType: 'UriLocation',\n      },\n      description:\n        'location of the jb2 config file (usually called config.json)',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'optional list of genomes to import from this config.json, if empty all genomes will be imported',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseConnectionConfig,\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            configJsonLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default JB2TrackHubConnection\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { BaseConnectionModelFactory } from '@jbrowse/core/pluggableElementTypes/models'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #stateModel JB2TrackHubConnection\n * extends BaseConnectionModel\n */\nexport default function JB2TrackHubConnection(pluginManager: PluginManager) {\n  return types\n    .compose(\n      'JB2TrackHubConnection',\n      BaseConnectionModelFactory(pluginManager),\n      types.model({\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        type: types.literal('JB2TrackHubConnection'),\n      }),\n    )\n    .actions(self => ({\n      /**\n       * #action\n       */\n      async connect() {\n        const { doConnect } = await import('./doConnect.ts')\n\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        doConnect(self)\n      },\n    }))\n}\n","import { ConnectionType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function JB2TrackHubConnectionF(pluginManager: PluginManager) {\n  pluginManager.addConnectionType(() => {\n    return new ConnectionType({\n      name: 'JB2TrackHubConnection',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      displayName: 'JB2 Track Hub',\n      description: 'A JBrowse 2 config file based trackhub',\n      url: 'https://jbrowse.org/jb2/',\n    })\n  })\n}\n","import { Observable, fromEvent } from 'rxjs'\n\nclass AbortError extends Error {\n  public code: string | undefined\n}\n\n/**\n * properly check if the given AbortSignal is aborted. per the standard, if the\n * signal reads as aborted, this function throws either a DOMException\n * AbortError, or a regular error with a `code` attribute set to `ERR_ABORTED`.\n *\n * for convenience, passing `undefined` is a no-op\n *\n * @param signal -\n * @returns nothing\n */\nexport function checkAbortSignal(signal?: AbortSignal): void {\n  if (!signal) {\n    return\n  }\n\n  if (!(signal instanceof AbortSignal)) {\n    throw new TypeError('must pass an AbortSignal')\n  }\n\n  if (signal.aborted) {\n    throw makeAbortError()\n  }\n}\n\nfunction timeout(ms: number) {\n  return new Promise(resolve => setTimeout(resolve, ms))\n}\n/**\n * Skips to the next tick, then runs `checkAbortSignal`.\n * Await this to inside an otherwise synchronous loop to\n * provide a place to break when an abort signal is received.\n */\nexport async function abortBreakPoint(signal?: AbortSignal) {\n  // it was observed that an actual timeout is needed to get the aborting (wrap\n  // hicrenderer in a try catch, console.error the error, and rethrow the error\n  // to see). using await Promise.resolve() did not appear to allow aborting to\n  // occur\n  await timeout(1)\n  checkAbortSignal(signal)\n}\n\nexport function makeAbortError() {\n  if (typeof DOMException !== 'undefined') {\n    return new DOMException('aborted', 'AbortError')\n  }\n  const e = new AbortError('aborted')\n  e.code = 'ERR_ABORTED'\n  return e\n}\n\nexport function observeAbortSignal(signal?: AbortSignal): Observable<Event> {\n  if (!signal) {\n    return new Observable()\n  }\n  return fromEvent(signal, 'abort')\n}\n\n/**\n * check if the given exception was caused by an operation being intentionally aborted\n * @param exception -\n */\nexport function isAbortException(exception: unknown): boolean {\n  return (\n    exception instanceof Error &&\n    // DOMException\n    (exception.name === 'AbortError' ||\n      // standard-ish non-DOM abort exception\n      (exception as AbortError).code === 'ERR_ABORTED' ||\n      // message contains aborted for bubbling through RPC\n      // things we have seen that we want to catch here\n      // Error: aborted\n      // AbortError: aborted\n      // AbortError: The user aborted a request.\n      /\\b(aborted|aborterror)\\b/i.test(exception.message))\n  )\n}\n","import { HttpRangeFetcher } from '@gmod/http-range-fetcher'\nimport { RemoteFile } from 'generic-filehandle2'\n\ntype BinaryRangeFetch = (\n  url: string,\n  start: number,\n  end: number,\n  options?: { headers?: HeadersInit; stopToken?: string },\n) => Promise<BinaryRangeResponse>\n\nexport interface BinaryRangeResponse {\n  headers: Record<string, string>\n  requestDate: Date\n  responseDate: Date\n  buffer: Uint8Array\n}\n\nconst fetchers: Record<string, BinaryRangeFetch> = {}\n\nfunction binaryRangeFetch(\n  url: string,\n  start: number,\n  end: number,\n  options: { headers?: HeadersInit; stopToken?: string } = {},\n): Promise<BinaryRangeResponse> {\n  const fetcher = fetchers[url]\n  if (!fetcher) {\n    throw new Error(`fetch not registered for ${url}`)\n  }\n  return fetcher(url, start, end, options)\n}\n\nconst globalRangeCache = new HttpRangeFetcher({\n  // @ts-expect-error\n  fetch: binaryRangeFetch,\n  size: 500 * 1024 ** 2, // 500MiB\n  chunkSize: 128 * 1024, // 128KiB\n  maxFetchSize: 100 * 1024 ** 2, // 100MiB\n  minimumTTL: 24 * 60 * 60 * 1000, // 1 day\n})\n\nexport function clearCache() {\n  globalRangeCache.reset()\n}\n\nexport class RemoteFileWithRangeCache extends RemoteFile {\n  public async fetch(\n    url: string | RequestInfo,\n    init?: RequestInit,\n  ): Promise<Response> {\n    const str = String(url)\n    if (!fetchers[str]) {\n      fetchers[str] = this.fetchBinaryRange.bind(this)\n    }\n    // if it is a range request, route it through the range cache\n    const range = new Headers(init?.headers).get('range')\n    if (range) {\n      const rangeParse = /bytes=(\\d+)-(\\d+)/.exec(range)\n      if (rangeParse) {\n        const [, start, end] = rangeParse\n        const s = Number.parseInt(start!, 10)\n        const e = Number.parseInt(end!, 10)\n        const len = e - s\n        const { buffer, headers } = (await globalRangeCache.getRange(\n          `${url}`,\n          s,\n          len + 1,\n        )) as BinaryRangeResponse\n        return new Response(buffer as BodyInit, {\n          status: 206,\n          headers,\n        })\n      }\n    }\n    return super.fetch(url, init)\n  }\n\n  public async fetchBinaryRange(\n    url: string,\n    start: number,\n    end: number,\n    options: { headers?: HeadersInit; stopToken?: string } = {},\n  ): Promise<BinaryRangeResponse> {\n    const requestDate = new Date()\n    const res = await super.fetch(url, {\n      ...options,\n      headers: {\n        // eslint-disable-next-line @typescript-eslint/no-misused-spread\n        ...options.headers,\n        range: `bytes=${start}-${end}`,\n      },\n    })\n    const responseDate = new Date()\n    if (!res.ok) {\n      const errorMessage = `HTTP ${res.status} fetching ${url} bytes ${start}-${end}`\n      const hint = ' (should be 206 for range requests)'\n      throw new Error(`${errorMessage}${res.status === 200 ? hint : ''}`)\n    }\n\n    // translate the Headers object into a regular key -> value object.\n    // will miss duplicate headers of course\n\n    const headers: Record<string, any> = {}\n    for (const [k, v] of res.headers.entries()) {\n      headers[k] = v\n    }\n\n    // return the response headers, and the data buffer\n    const arrayBuffer = await res.arrayBuffer()\n    return {\n      headers,\n      requestDate,\n      responseDate,\n      buffer: new Uint8Array(arrayBuffer),\n    }\n  }\n}\n","import { lazy } from 'react'\n\nimport {\n  ConfigurationReference,\n  getConf,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport { getEnv, getSession, isSelectionContainer } from '@jbrowse/core/util'\nimport { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { BaseLinearDisplay } from '@jbrowse/plugin-linear-genome-view'\n\nimport { getNiceDomain } from '../util.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\n\n// lazies\nconst SetMinMaxDialog = lazy(() => import('./SetMinMaxDialog.tsx'))\n\n/**\n * #stateModel SharedWiggleMixin\n */\nexport default function SharedWiggleMixin(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        selectedRendering: types.optional(types.string, ''),\n        /**\n         * #property\n         */\n        resolution: types.optional(types.number, 1),\n        /**\n         * #property\n         */\n        fill: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        minSize: types.maybe(types.number),\n        /**\n         * #property\n         */\n        color: types.maybe(types.string),\n        /**\n         * #property\n         */\n        posColor: types.maybe(types.string),\n        /**\n         * #property\n         */\n        negColor: types.maybe(types.string),\n        /**\n         * #property\n         */\n        summaryScoreMode: types.maybe(types.string),\n        /**\n         * #property\n         */\n        rendererTypeNameState: types.maybe(types.string),\n        /**\n         * #property\n         */\n        scale: types.maybe(types.string),\n        /**\n         * #property\n         */\n        autoscale: types.maybe(types.string),\n        /**\n         * #property\n         */\n        displayCrossHatches: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        constraints: types.optional(\n          types.model({\n            max: types.maybe(types.number),\n            min: types.maybe(types.number),\n          }),\n          {},\n        ),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      message: undefined as undefined | string,\n      /**\n       * #volatile\n       * statsRegion is a serialized snapshot of view.dynamicBlocks at the time\n       * stats were fetched. since stats are fetched asynchronously, the view\n       * may have panned by the time they return. renderProps compares this to\n       * the current dynamicBlocks to detect stale stats and show a loading\n       * state until fresh stats arrive\n       */\n      stats: undefined as\n        | {\n            currStatsBpPerPx: number\n            scoreMin: number\n            scoreMax: number\n            statsRegion?: string\n          }\n        | undefined,\n      /**\n       * #volatile\n       */\n      statsFetchInProgress: undefined as undefined | StopToken,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      updateQuantitativeStats(\n        stats: {\n          currStatsBpPerPx: number\n          scoreMin: number\n          scoreMax: number\n        },\n        statsRegion?: string,\n      ) {\n        const { currStatsBpPerPx, scoreMin, scoreMax } = stats\n        const EPSILON = 0.000001\n        if (\n          !self.stats ||\n          Math.abs(self.stats.scoreMax - scoreMax) > EPSILON ||\n          Math.abs(self.stats.scoreMin - scoreMin) > EPSILON ||\n          self.stats.statsRegion !== statsRegion\n        ) {\n          self.stats = {\n            currStatsBpPerPx,\n            scoreMin,\n            scoreMax,\n            statsRegion,\n          }\n        }\n      },\n      /**\n       * #action\n       */\n      setColor(color?: string) {\n        self.color = color\n      },\n      /**\n       * #action\n       */\n      setPosColor(color?: string) {\n        self.posColor = color\n      },\n      /**\n       * #action\n       */\n      setNegColor(color?: string) {\n        self.negColor = color\n      },\n\n      /**\n       * #action\n       */\n      setStatsLoading(arg?: StopToken) {\n        if (self.statsFetchInProgress) {\n          stopStopToken(self.statsFetchInProgress)\n        }\n        self.statsFetchInProgress = arg\n      },\n\n      /**\n       * #action\n       * this overrides the BaseLinearDisplayModel to avoid popping up a\n       * feature detail display, but still sets the feature selection on the\n       * model so listeners can detect a click\n       */\n      selectFeature(feature: Feature) {\n        const session = getSession(self)\n        if (isSelectionContainer(session)) {\n          session.setSelection(feature)\n        }\n      },\n\n      /**\n       * #action\n       */\n      setResolution(res: number) {\n        self.resolution = res\n      },\n\n      /**\n       * #action\n       */\n      setFill(fill: number) {\n        if (fill === 0) {\n          self.fill = true\n          self.minSize = 0\n        } else if (fill === 1) {\n          self.fill = false\n          self.minSize = 1\n        } else if (fill === 2) {\n          self.fill = false\n          self.minSize = 2\n        }\n      },\n\n      /**\n       * #action\n       */\n      toggleLogScale() {\n        self.scale = self.scale === 'log' ? 'linear' : 'log'\n      },\n\n      /**\n       * #action\n       */\n      setScaleType(scale?: string) {\n        self.scale = scale\n      },\n\n      /**\n       * #action\n       */\n      setSummaryScoreMode(val: string) {\n        self.summaryScoreMode = val\n      },\n\n      /**\n       * #action\n       */\n      setAutoscale(val: string) {\n        self.autoscale = val\n      },\n\n      /**\n       * #action\n       */\n      setMaxScore(val?: number) {\n        self.constraints.max = val\n      },\n\n      /**\n       * #action\n       */\n      setRendererType(val: string) {\n        self.rendererTypeNameState = val\n      },\n\n      /**\n       * #action\n       */\n      setMinScore(val?: number) {\n        self.constraints.min = val\n      },\n\n      /**\n       * #action\n       */\n      toggleCrossHatches() {\n        self.displayCrossHatches = !self.displayCrossHatches\n      },\n\n      /**\n       * #action\n       */\n      setCrossHatches(cross: boolean) {\n        self.displayCrossHatches = cross\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get adapterTypeName() {\n        return self.adapterConfig.type\n      },\n\n      /**\n       * #getter\n       */\n      get rendererTypeNameSimple() {\n        return (\n          self.rendererTypeNameState ??\n          (getConf(self, 'defaultRendering') as string)\n        )\n      },\n\n      /**\n       * #getter\n       * subclasses can define these, as snpcoverage track does\n       */\n      get filters() {\n        return undefined\n      },\n\n      /**\n       * #getter\n       */\n      get scaleType() {\n        return self.scale ?? (getConf(self, 'scaleType') as string)\n      },\n\n      /**\n       * #getter\n       */\n      get maxScore() {\n        return self.constraints.max ?? (getConf(self, 'maxScore') as number)\n      },\n\n      /**\n       * #getter\n       */\n      get minScore() {\n        return self.constraints.min ?? (getConf(self, 'minScore') as number)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get adapterCapabilities() {\n        const type = self.adapterTypeName\n        const { pluginManager } = getEnv(self)\n        return pluginManager.getAdapterType(type)!.adapterCapabilities\n      },\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const {\n          color,\n          displayCrossHatches,\n          fill,\n          minSize,\n          negColor,\n          posColor,\n          summaryScoreMode,\n          scaleType,\n          rendererTypeName,\n        } = self\n        // @ts-ignore\n        const conf = self.configuration.renderers?.[rendererTypeName]\n        return {\n          // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n          scaleType: scaleType ?? readConfObject(conf, 'scaleType'),\n          filled: fill ?? readConfObject(conf, 'filled'),\n          displayCrossHatches:\n            displayCrossHatches ?? readConfObject(conf, 'displayCrossHatches'),\n          summaryScoreMode:\n            summaryScoreMode ?? readConfObject(conf, 'summaryScoreMode'),\n          color: color ?? readConfObject(conf, 'color'),\n          negColor: negColor ?? readConfObject(conf, 'negColor'),\n          posColor: posColor ?? readConfObject(conf, 'posColor'),\n          minSize: minSize ?? readConfObject(conf, 'minSize'),\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get autoscaleType() {\n        return self.autoscale ?? (getConf(self, 'autoscale') as string)\n      },\n    }))\n    .views(self => {\n      let oldDomain: [number, number] = [0, 0]\n      return {\n        /**\n         * #getter\n         */\n        get domain() {\n          const { stats, scaleType, minScore, maxScore } = self\n          if (!stats) {\n            return undefined\n          }\n\n          const ret = getNiceDomain({\n            domain: [stats.scoreMin, stats.scoreMax],\n            bounds: [minScore, maxScore],\n            scaleType,\n          })\n\n          // avoid weird scalebar if log value and empty region displayed\n          if (scaleType === 'log' && ret[1] === Number.MIN_VALUE) {\n            return [0, Number.MIN_VALUE]\n          }\n\n          // avoid returning a new object if it matches the old value\n          if (JSON.stringify(oldDomain) !== JSON.stringify(ret)) {\n            oldDomain = ret\n          }\n\n          return oldDomain\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get filled() {\n        return self.rendererConfig.filled\n      },\n      /**\n       * #getter\n       */\n      get summaryScoreModeSetting() {\n        return self.rendererConfig.summaryScoreMode\n      },\n\n      /**\n       * #getter\n       */\n      get scaleOpts() {\n        return {\n          domain: self.domain,\n          stats: self.stats,\n          autoscaleType: self.autoscaleType,\n          scaleType: self.scaleType,\n          inverted: getConf(self, 'inverted') as boolean,\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get canHaveFill() {\n        return self.rendererTypeName === 'XYPlotRenderer'\n      },\n\n      /**\n       * #getter\n       */\n      get displayCrossHatchesSetting() {\n        return self.rendererConfig.displayCrossHatches\n      },\n      /**\n       * #getter\n       */\n      get hasResolution() {\n        return self.adapterCapabilities.includes('hasResolution')\n      },\n\n      /**\n       * #getter\n       */\n      get hasGlobalStats() {\n        return self.adapterCapabilities.includes('hasGlobalStats')\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      scoreTrackMenuItems() {\n        return [\n          ...(self.hasResolution\n            ? [\n                {\n                  label: 'Resolution',\n                  subMenu: [\n                    {\n                      label: 'Finer resolution',\n                      onClick: () => {\n                        self.setResolution(self.resolution * 5)\n                      },\n                    },\n                    {\n                      label: 'Coarser resolution',\n                      onClick: () => {\n                        self.setResolution(self.resolution / 5)\n                      },\n                    },\n                  ],\n                },\n                {\n                  label: 'Summary score mode',\n                  subMenu: ['min', 'max', 'avg', 'whiskers'].map(elt => ({\n                    label: elt,\n                    type: 'radio',\n                    checked: self.summaryScoreModeSetting === elt,\n                    onClick: () => {\n                      self.setSummaryScoreMode(elt)\n                    },\n                  })),\n                },\n              ]\n            : []),\n          {\n            label: 'Scale type',\n            subMenu: [\n              {\n                label: 'Linear scale',\n                type: 'radio',\n                checked: self.scaleType === 'linear',\n                onClick: () => {\n                  self.setScaleType('linear')\n                },\n              },\n              {\n                label: 'Log scale',\n                type: 'radio',\n                checked: self.scaleType === 'log',\n                onClick: () => {\n                  self.setScaleType('log')\n                },\n              },\n            ],\n          },\n          {\n            label: 'Autoscale type',\n            subMenu: [\n              ['local', 'Local'],\n              ...(self.hasGlobalStats\n                ? ([\n                    ['global', 'Global'],\n                    ['globalsd', 'Global  3'],\n                  ] as const)\n                : []),\n              ['localsd', 'Local  3'],\n            ].map(([val, label]) => ({\n              label,\n              type: 'radio',\n              checked: self.autoscaleType === val,\n              onClick: () => {\n                self.setAutoscale(val)\n              },\n            })),\n          },\n          {\n            label: 'Set min/max score',\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                SetMinMaxDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n        ]\n      },\n    }))\n    .actions(self => {\n      const { reload: superReload } = self\n      return {\n        /**\n         * #action\n         */\n        async reload() {\n          self.setError()\n          superReload()\n        },\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        selectedRendering,\n        resolution,\n        fill,\n        minSize,\n        color,\n        posColor,\n        negColor,\n        summaryScoreMode,\n        rendererTypeNameState,\n        scale,\n        autoscale,\n        displayCrossHatches,\n        constraints,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(selectedRendering ? { selectedRendering } : {}),\n        ...(resolution !== 1 ? { resolution } : {}),\n        ...(fill !== undefined ? { fill } : {}),\n        ...(minSize !== undefined ? { minSize } : {}),\n        ...(color !== undefined ? { color } : {}),\n        ...(posColor !== undefined ? { posColor } : {}),\n        ...(negColor !== undefined ? { negColor } : {}),\n        ...(summaryScoreMode !== undefined ? { summaryScoreMode } : {}),\n        ...(rendererTypeNameState !== undefined\n          ? { rendererTypeNameState }\n          : {}),\n        ...(scale !== undefined ? { scale } : {}),\n        ...(autoscale !== undefined ? { autoscale } : {}),\n        ...(displayCrossHatches !== undefined ? { displayCrossHatches } : {}),\n        ...(constraints.min !== undefined || constraints.max !== undefined\n          ? { constraints }\n          : {}),\n      } as typeof snap\n    })\n}\n","import { toLocale } from '@jbrowse/core/util'\n\nimport type { Dotplot1DViewModel } from '../model.ts'\nimport type { BaseBlock } from '@jbrowse/core/util/blockTypes'\n\nexport function locstr(\n  px: number,\n  view: Dotplot1DViewModel,\n  includeAsm = true,\n) {\n  const { assemblyName, refName, start, offset, oob } = view.pxToBp(px)\n  const coord = Math.floor(start + offset)\n  return oob\n    ? 'out of bounds'\n    : `${includeAsm ? `{${assemblyName}}` : ''}${refName}:${toLocale(coord)}`\n}\n\nexport function getBlockLabelKeysToHide(\n  blocks: BaseBlock[],\n  length: number,\n  viewOffsetPx: number,\n) {\n  const blockLabelKeysToHide = new Set<string>()\n  const sortedBlocks = [...blocks].sort((a, b) => {\n    const alen = a.end - a.start\n    const blen = b.end - b.start\n    return blen - alen\n  })\n  const occupiedPositions = new Set<number>()\n  for (const { key, offsetPx } of sortedBlocks) {\n    const y = Math.round(length - offsetPx + viewOffsetPx)\n    const labelStart = Math.max(y - 12, 0)\n    let hasOverlap = y === 0\n    if (!hasOverlap) {\n      for (let i = labelStart; i < y; i++) {\n        if (occupiedPositions.has(i)) {\n          hasOverlap = true\n          break\n        }\n      }\n    }\n    if (hasOverlap) {\n      blockLabelKeysToHide.add(key)\n    } else {\n      for (let i = labelStart; i < y; i++) {\n        occupiedPositions.add(i)\n      }\n    }\n  }\n  return blockLabelKeysToHide\n}\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(\n  scale: number,\n  minMajorPitchPx: number,\n  minMinorPitchPx: number,\n) {\n  scale = Math.abs(scale)\n  const minMajorPitchBp = minMajorPitchPx * scale\n  const majorMagnitude = +minMajorPitchBp.toExponential().split(/e/i)[1]!\n\n  let majorPitch = 10 ** majorMagnitude\n  while (majorPitch < minMajorPitchBp) {\n    majorPitch *= 2\n    if (majorPitch >= minMajorPitchBp) {\n      break\n    }\n    majorPitch *= 2.5\n  }\n\n  majorPitch = Math.max(majorPitch, 5)\n\n  const majorPitchPx = majorPitch / scale\n\n  let minorPitch = 0\n  if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 10\n  } else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 5\n  } else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 2\n  }\n\n  return { majorPitch, minorPitch }\n}\n\nexport function makeTicks(\n  regions: BaseBlock[],\n  bpPerPx: number,\n  emitMajor = true,\n  emitMinor = true,\n) {\n  const ticks = []\n  const gridPitch = chooseGridPitch(bpPerPx, 60, 15)\n  const iterPitch = gridPitch.minorPitch || gridPitch.majorPitch\n  for (const { start, end, refName } of regions) {\n    let index = 0\n\n    const minBase = start\n    const maxBase = end\n\n    for (\n      let base = Math.floor(minBase / iterPitch) * iterPitch;\n      base < Math.ceil(maxBase / iterPitch) * iterPitch + 1;\n      base += iterPitch\n    ) {\n      if (emitMinor && base % gridPitch.majorPitch) {\n        ticks.push({ type: 'minor', base: base - 1, index, refName })\n        index += 1\n      } else if (emitMajor && Math.abs(base - start) > gridPitch.minorPitch) {\n        ticks.push({ type: 'major', base: base - 1, index, refName })\n        index += 1\n      }\n    }\n  }\n  return ticks\n}\n","/* eslint-disable @typescript-eslint/no-unsafe-function-type */\nimport type React from 'react'\n\nimport { isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport type {\n  BlobLocation as MUBlobLocation,\n  LocalPathLocation as MULocalPathLocation,\n  NoAssemblyRegion as MUNoAssemblyRegion,\n  Region as MUIRegion,\n  UriLocation as MUUriLocation,\n} from './mst.ts'\nimport type TextSearchManager from '../../TextSearch/TextSearchManager.ts'\nimport type assemblyManager from '../../assemblyManager/index.ts'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\nimport type { BaseInternetAccountModel } from '../../pluggableElementTypes/models/index.ts'\nimport type RpcManager from '../../rpc/RpcManager.ts'\nimport type { MenuItem } from '../../ui/index.ts'\nimport type { Feature } from '../simpleFeature.ts'\nimport type {\n  IAnyStateTreeNode,\n  IStateTreeNode,\n  IType,\n  Instance,\n  SnapshotIn,\n} from '@jbrowse/mobx-state-tree'\nimport type { ThemeOptions } from '@mui/material'\n\nexport * from './util.ts'\n\n/** abstract type for a model that contains multiple views */\nexport interface AbstractViewContainer extends IStateTreeNode<\n  IType<any, any, any>\n> {\n  views: AbstractViewModel[]\n  removeView(view: AbstractViewModel): void\n  addView(\n    typeName: string,\n    initialState?: Record<string, unknown>,\n  ): AbstractViewModel\n}\nexport function isViewContainer(\n  thing: unknown,\n): thing is AbstractViewContainer {\n  return (\n    isStateTreeNode(thing) &&\n    'removeView' in thing &&\n    'addView' in thing &&\n    'views' in thing\n  )\n}\n\nexport type NotificationLevel = 'error' | 'info' | 'warning' | 'success'\nexport interface SnackAction {\n  name: React.ReactElement | string\n  onClick: () => void\n}\n\nexport type AssemblyManager = Instance<ReturnType<typeof assemblyManager>>\n\nexport interface BasePlugin {\n  version?: string\n  name: string\n  url?: string\n}\n\nexport interface JBrowsePlugin {\n  name: string\n  authors: string[]\n  description: string\n  location: string\n  url?: string\n  umdUrl?: string\n  esmUrl?: string\n  cjsUrl?: string\n  license: string\n  image?: string\n}\n\nexport type DialogComponentType =\n  | React.LazyExoticComponent<React.FC<any>>\n  | React.FC<any>\n\n/** minimum interface that all session state models must implement */\nexport interface AbstractSessionModel extends AbstractViewContainer {\n  getTracksById: () => Record<string, AnyConfigurationModel>\n  jbrowse: IAnyStateTreeNode\n  drawerPosition?: string\n  configuration: AnyConfigurationModel\n  rpcManager: RpcManager\n  assemblyNames: string[]\n  assemblies: AnyConfigurationModel[]\n  selection?: unknown\n  focusedViewId?: string\n  themeName?: string\n  theme?: ThemeOptions\n  hovered: unknown\n  setHovered: (arg: unknown) => void\n  setFocusedViewId?: (id: string) => void\n  allThemes?: () => Record<string, ThemeOptions>\n  setSelection: (feature: Feature) => void\n  setSession?: (arg: { name: string; [key: string]: unknown }) => void\n  clearSelection: () => void\n  duplicateCurrentSession?: () => void\n  notify: (\n    message: string,\n    level?: NotificationLevel,\n    action?: SnackAction,\n  ) => void\n  notifyError: (message: string, error?: unknown, extra?: unknown) => void\n  assemblyManager: AssemblyManager\n  version: string\n  getTrackActionMenuItems?: (\n    config: AnyConfigurationModel,\n    extraTrackActions?: MenuItem[],\n  ) => MenuItem[]\n  getTrackActions?: (arg: AnyConfigurationModel) => MenuItem[]\n  getTrackListMenuItems?: (arg: AnyConfigurationModel) => MenuItem[]\n  addAssembly?: Function\n  removeAssembly?: Function\n  textSearchManager?: TextSearchManager\n  connections: AnyConfigurationModel[]\n  deleteConnection?: Function\n  temporaryAssemblies?: unknown[]\n  addTemporaryAssembly?: (arg: Record<string, unknown>) => void\n  removeTemporaryAssembly?: (arg: string) => void\n  sessionConnections?: AnyConfigurationModel[]\n  sessionTracks?: AnyConfigurationModel[]\n  connectionInstances?: {\n    name: string\n    tracks: AnyConfigurationModel[]\n    configuration: AnyConfigurationModel\n  }[]\n  makeConnection?: Function\n  breakConnection?: Function\n\n  prepareToBreakConnection?: (arg: AnyConfigurationModel) => any\n  adminMode?: boolean\n  showWidget?: Function\n  addWidget?: Function\n\n  DialogComponent?: DialogComponentType\n\n  DialogProps: any\n  queueDialog<T extends DialogComponentType>(\n    callback: (doneCallback: () => void) => [T, React.ComponentProps<T>],\n  ): void\n  name: string\n  id?: string\n  tracks: AnyConfigurationModel[]\n}\nexport function isSessionModel(thing: unknown): thing is AbstractSessionModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'rpcManager' in thing &&\n    'configuration' in thing\n  )\n}\n\n/** abstract interface for a session allows editing configurations */\nexport interface SessionWithConfigEditing extends AbstractSessionModel {\n  editConfiguration(configuration: AnyConfigurationModel): void\n}\nexport function isSessionModelWithConfigEditing(\n  t: unknown,\n): t is SessionWithConfigEditing {\n  return isSessionModel(t) && 'editConfiguration' in t\n}\n\n/** abstract interface for a session allows adding tracks */\nexport interface SessionWithAddTracks extends AbstractSessionModel {\n  addTrackConf(\n    configuration: AnyConfigurationModel | SnapshotIn<AnyConfigurationModel>,\n  ): void\n}\nexport function isSessionWithAddTracks(t: unknown): t is SessionWithAddTracks {\n  return (\n    // @ts-expect-error\n    isSessionModel(t) && 'addTrackConf' in t && !t.disableAddTracks\n  )\n}\n\n/** abstract interface for a session allows adding tracks */\nexport interface SessionWithShareURL extends AbstractSessionModel {\n  shareURL: string\n}\nexport function isSessionWithShareURL(\n  thing: unknown,\n): thing is SessionWithShareURL {\n  return isSessionModel(thing) && 'shareURL' in thing && !!thing.shareURL\n}\n\nexport interface Widget {\n  type: string\n  id: string\n}\n\n/** Minimal map interface compatible with both native Map and MST IMSTMap */\nexport interface WidgetMap<K, V> {\n  size: number\n  has(key: K): boolean\n  get(key: K): V | undefined\n  keys(): IterableIterator<K>\n  values(): IterableIterator<V>\n  entries(): IterableIterator<[K, V]>\n  forEach(callbackfn: (value: V, key: K) => void): void\n  [Symbol.iterator](): IterableIterator<[K, V]>\n}\n\n/** abstract interface for a session that manages widgets */\nexport interface SessionWithWidgets extends AbstractSessionModel {\n  minimized: boolean\n  visibleWidget?: Widget\n  widgets: WidgetMap<string, Widget>\n  activeWidgets: WidgetMap<string, Widget>\n  hideAllWidgets: () => void\n  addWidget(\n    typeName: string,\n    id: string,\n    initialState?: Record<string, unknown>,\n    configuration?: { type: string },\n  ): Widget\n  showWidget(widget: unknown): void\n  hideWidget(widget: unknown): void\n}\n\n/* only some sessions with widgets use a drawer widget */\nexport interface SessionWithDrawerWidgets extends SessionWithWidgets {\n  drawerWidth: number\n  resizeDrawer(arg: number): number\n  minimizeWidgetDrawer(): void\n  showWidgetDrawer: () => void\n  drawerPosition: string\n  setDrawerPosition(arg: string): void\n}\n\nexport function isSessionModelWithWidgets(\n  thing: unknown,\n): thing is SessionWithWidgets {\n  return isSessionModel(thing) && 'widgets' in thing\n}\nexport interface SessionWithConnections {\n  makeConnection: (arg: AnyConfigurationModel) => void\n}\nexport function isSessionModelWithConnections(\n  thing: unknown,\n): thing is SessionWithConnections {\n  return isSessionModel(thing) && 'makeConnection' in thing\n}\n\nexport interface SessionWithConnectionEditing {\n  addConnectionConf: (arg: AnyConfigurationModel) => void\n}\n\nexport function isSessionModelWithConnectionEditing(\n  thing: unknown,\n): thing is SessionWithConnectionEditing {\n  return isSessionModel(thing) && 'addConnectionConf' in thing\n}\n\nexport interface SessionWithSessionPlugins extends AbstractSessionModel {\n  sessionPlugins: JBrowsePlugin[]\n  addSessionPlugin: Function\n  removeSessionPlugin: Function\n}\nexport function isSessionWithSessionPlugins(\n  thing: unknown,\n): thing is SessionWithSessionPlugins {\n  return isSessionModel(thing) && 'sessionPlugins' in thing\n}\n\n/** abstract interface for a session that manages a global selection */\nexport interface SelectionContainer extends AbstractSessionModel {\n  selection?: unknown\n  setSelection(thing: unknown): void\n}\nexport function isSelectionContainer(\n  thing: unknown,\n): thing is SelectionContainer {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'selection' in thing &&\n    'setSelection' in thing\n  )\n}\n\n/** abstract interface for a session allows applying focus to views and widgets */\nexport interface SessionWithFocusedViewAndDrawerWidgets extends SessionWithDrawerWidgets {\n  focusedViewId: string | undefined\n  setFocusedViewId(id: string): void\n}\n\n/** minimum interface that all view state models must implement */\nexport interface AbstractViewModel {\n  id: string\n  type: string\n  width: number\n  minimized: boolean\n  setWidth(width: number): void\n  setMinimized(flag: boolean): void\n  displayName: string | undefined\n  setDisplayName: (arg: string) => void\n  menuItems: () => MenuItem[]\n}\nexport function isViewModel(thing: unknown): thing is AbstractViewModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'width' in thing &&\n    'setWidth' in thing\n  )\n}\n\ntype Display = { displayId: string } & AnyConfigurationModel\n\nexport interface AbstractTrackModel {\n  id: string\n  displays: AbstractDisplayModel[]\n  configuration: AnyConfigurationModel & { displays: Display[] }\n  minimized: boolean\n}\n\nexport function isTrackModel(thing: unknown): thing is AbstractTrackModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'configuration' in thing &&\n    // @ts-expect-error\n    thing.configuration.trackId\n  )\n}\n\nexport interface AbstractDisplayModel {\n  id: string\n  parentTrack: AbstractTrackModel\n  renderDelay: number\n  rendererType: any\n  cannotBeRenderedReason?: string\n}\nexport function isDisplayModel(thing: unknown): thing is AbstractDisplayModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'configuration' in thing &&\n    // @ts-expect-error\n    thing.configuration.displayId\n  )\n}\n\nexport interface TrackViewModel extends AbstractViewModel {\n  showTrack(trackId: string): void\n  hideTrack(trackId: string): void\n}\nexport function isTrackViewModel(thing: unknown): thing is TrackViewModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'showTrack' in thing &&\n    'hideTrack' in thing\n  )\n}\n\n/** minimum interface for the root MST model of a JBrowse app */\nexport interface AbstractRootModel {\n  jbrowse: IAnyStateTreeNode\n  session?: AbstractSessionModel\n  setDefaultSession?(): void\n  adminMode?: boolean\n  error?: unknown\n}\n\n/** root model with more included for the heavier JBrowse web and desktop app */\nexport interface AppRootModel extends AbstractRootModel {\n  internetAccounts: BaseInternetAccountModel[]\n  findAppropriateInternetAccount(\n    location: UriLocation,\n  ): BaseInternetAccountModel | undefined\n}\n\nexport function isAppRootModel(thing: unknown): thing is AppRootModel {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'findAppropriateInternetAccount' in thing\n  )\n}\n\nexport interface RootModelWithInternetAccounts extends AbstractRootModel {\n  internetAccounts: BaseInternetAccountModel[]\n  findAppropriateInternetAccount(\n    location: UriLocation,\n  ): BaseInternetAccountModel | undefined\n}\n\nexport function isRootModelWithInternetAccounts(\n  thing: unknown,\n): thing is RootModelWithInternetAccounts {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'internetAccounts' in thing &&\n    'findAppropriateInternetAccount' in thing\n  )\n}\n\n/** a root model that manages global menus */\nexport interface AbstractMenuManager {\n  appendMenu(menuName: string): void\n  insertMenu(menuName: string, position: number): number\n  insertInMenu(menuName: string, menuItem: MenuItem, position: number): number\n  appendToMenu(menuName: string, menuItem: MenuItem): number\n  appendToSubMenu(menuPath: string[], menuItem: MenuItem): number\n  insertInSubMenu(\n    menuPath: string[],\n    menuItem: MenuItem,\n    position: number,\n  ): number\n}\nexport function isAbstractMenuManager(\n  thing: unknown,\n): thing is AbstractMenuManager {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'appendMenu' in thing &&\n    'appendToSubMenu' in thing\n  )\n}\n\n// Empty interfaces required by @jbrowse/mobx-state-tree\n// See https://@jbrowse/mobx-state-tree.js.org/tips/typescript#using-a-mst-type-at-design-time\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface NoAssemblyRegion extends SnapshotIn<\n  typeof MUNoAssemblyRegion\n> {}\n\n/**\n * a description of a specific genomic region. assemblyName, refName, start,\n * end, and reversed\n */\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface Region extends SnapshotIn<typeof MUIRegion> {}\n\nexport interface AugmentedRegion extends Region {\n  originalRefName?: string\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface LocalPathLocation extends SnapshotIn<\n  typeof MULocalPathLocation\n> {}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UriLocation extends SnapshotIn<typeof MUUriLocation> {}\n\nexport function isUriLocation(location: unknown): location is UriLocation {\n  return (\n    typeof location === 'object' &&\n    location !== null &&\n    'uri' in location &&\n    !!location.uri\n  )\n}\nexport function isLocalPathLocation(\n  location: unknown,\n): location is LocalPathLocation {\n  return (\n    typeof location === 'object' &&\n    location !== null &&\n    'localPath' in location &&\n    !!location.localPath\n  )\n}\n\nexport function isBlobLocation(location: unknown): location is BlobLocation {\n  return (\n    typeof location === 'object' &&\n    location !== null &&\n    'blobId' in location &&\n    !!location.blobId\n  )\n}\nexport class AuthNeededError extends Error {\n  constructor(\n    public message: string,\n    public url: string,\n  ) {\n    super(message)\n    this.name = 'AuthNeededError'\n\n    Object.setPrototypeOf(this, AuthNeededError.prototype)\n  }\n}\n\nexport class RetryError extends Error {\n  constructor(\n    public message: string,\n    public internetAccountId: string,\n  ) {\n    super(message)\n    this.name = 'RetryError'\n  }\n}\n\nexport function isAuthNeededException(\n  exception: unknown,\n): exception is AuthNeededError {\n  return (\n    exception instanceof Error &&\n    // DOMException\n    (exception.name === 'AuthNeededError' ||\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      (exception as AuthNeededError).url !== undefined)\n  )\n}\n\nexport function isRetryException(exception: Error): boolean {\n  return (\n    // DOMException\n    exception.name === 'RetryError' ||\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    (exception as RetryError).internetAccountId !== undefined\n  )\n}\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface BlobLocation extends SnapshotIn<typeof MUBlobLocation> {}\n\nexport type FileLocation = LocalPathLocation | UriLocation | BlobLocation\n\n// These types are slightly different than the MST models representing a\n// location because a blob cannot be stored in a MST, so this is the\n// pre-processed file location\nexport interface PreUriLocation {\n  uri: string\n}\nexport interface PreLocalPathLocation {\n  localPath: string\n}\nexport interface PreBlobLocation {\n  blob: File\n}\nexport type PreFileLocation =\n  | PreUriLocation\n  | PreLocalPathLocation\n  | PreBlobLocation\n\nexport { default as TextSearchManager } from '../../TextSearch/TextSearchManager.ts'\n","import { getSession, isUriLocation } from '@jbrowse/core/util'\nimport {\n  UNSUPPORTED,\n  getFileName,\n  guessAdapter,\n  guessTrackType,\n} from '@jbrowse/core/util/tracks'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport deepmerge from 'deepmerge'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { FileLocation } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nfunction getUri(location: FileLocation | undefined) {\n  return isUriLocation(location) ? location.uri : undefined\n}\n\nfunction isRelativeUrl(url = '') {\n  try {\n    new URL(url)\n    return false\n  } catch {\n    return !url.startsWith('/')\n  }\n}\n\ninterface IndexingAttr {\n  attributes: string[]\n  exclude: string[]\n}\n\nconst defaultVolatileState = {\n  trackData: undefined as FileLocation | undefined,\n  indexTrackData: undefined as FileLocation | undefined,\n  altAssemblyName: '',\n  altTrackName: '',\n  altTrackType: '',\n  adapterHint: '',\n  textIndexTrack: true,\n  textIndexingConf: undefined as IndexingAttr | undefined,\n  mixinData: {} as Record<string, unknown>,\n}\n\n/**\n * #stateModel AddTrackModel\n */\nexport default function f(pluginManager: PluginManager) {\n  return types\n    .model('AddTrackModel', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal('AddTrackWidget'),\n      /**\n       * #property\n       */\n      view: types.safeReference(\n        pluginManager.pluggableMstType('view', 'stateModel'),\n      ),\n    })\n    .volatile(() => ({ ...defaultVolatileState }))\n    .actions(self => ({\n      setMixinData(arg: Record<string, unknown>) {\n        self.mixinData = arg\n      },\n      /**\n       * #action\n       */\n      setAdapterHint(obj: string) {\n        self.adapterHint = obj\n      },\n      /**\n       * #action\n       */\n      setTextIndexingConf(conf: IndexingAttr) {\n        self.textIndexingConf = conf\n      },\n      /**\n       * #action\n       */\n      setTextIndexTrack(flag: boolean) {\n        self.textIndexTrack = flag\n      },\n      /**\n       * #action\n       */\n      setTrackData(obj: FileLocation) {\n        self.trackData = obj\n        // Clear adapter hint when track data changes to force re-evaluation\n        self.adapterHint = ''\n      },\n      /**\n       * #action\n       */\n      setIndexTrackData(obj: FileLocation) {\n        self.indexTrackData = obj\n        // Clear adapter hint when index data changes to force re-evaluation\n        self.adapterHint = ''\n      },\n      /**\n       * #action\n       */\n      setAssembly(str: string) {\n        self.altAssemblyName = str\n      },\n      /**\n       * #action\n       */\n      setTrackName(str: string) {\n        self.altTrackName = str\n      },\n      /**\n       * #action\n       */\n      setTrackType(str: string) {\n        self.altTrackType = str\n      },\n      /**\n       * #action\n       */\n      clearData() {\n        self.altTrackName = defaultVolatileState.altTrackName\n        self.altTrackType = defaultVolatileState.altTrackType\n        self.altAssemblyName = defaultVolatileState.altAssemblyName\n        self.adapterHint = defaultVolatileState.adapterHint\n        self.indexTrackData = defaultVolatileState.indexTrackData\n        self.trackData = defaultVolatileState.trackData\n        self.textIndexingConf = defaultVolatileState.textIndexingConf\n        self.textIndexTrack = defaultVolatileState.textIndexTrack\n        self.mixinData = {}\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get trackAdapter() {\n        const { trackData, indexTrackData, adapterHint } = self\n\n        return trackData\n          ? guessAdapter(trackData, indexTrackData, adapterHint, self)\n          : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get trackName() {\n        return (\n          self.altTrackName ||\n          (self.trackData ? getFileName(self.trackData) : '')\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get isFtp() {\n        const trackUri = getUri(self.trackData)\n        const indexUri = getUri(self.indexTrackData)\n        return !!(\n          indexUri?.startsWith('ftp://') || trackUri?.startsWith('ftp://')\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get isRelativeTrackUrl() {\n        const uri = getUri(self.trackData)\n        return uri ? isRelativeUrl(uri) : false\n      },\n      /**\n       * #getter\n       */\n      get isRelativeIndexUrl() {\n        const uri = getUri(self.indexTrackData)\n        return uri ? isRelativeUrl(uri) : false\n      },\n      /**\n       * #getter\n       */\n      get isRelativeUrl() {\n        return this.isRelativeIndexUrl || this.isRelativeTrackUrl\n      },\n\n      /**\n       * #getter\n       */\n      get trackHttp() {\n        return getUri(self.trackData)?.startsWith('http://')\n      },\n      /**\n       * #getter\n       */\n      get indexHttp() {\n        return getUri(self.indexTrackData)?.startsWith('http://')\n      },\n\n      /**\n       * #getter\n       */\n      get wrongProtocol() {\n        return (\n          window.location.protocol === 'https:' &&\n          (this.trackHttp || this.indexHttp)\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get unsupported() {\n        return this.trackAdapter?.type === UNSUPPORTED\n      },\n\n      /**\n       * #getter\n       */\n      get assembly() {\n        return self.altAssemblyName || self.view?.assemblyNames?.[0]\n      },\n\n      /**\n       * #getter\n       */\n      get trackAdapterType() {\n        return this.trackAdapter?.type\n      },\n      /**\n       * #getter\n       */\n      get trackType() {\n        return (\n          self.altTrackType ||\n          (this.trackAdapterType\n            ? guessTrackType(this.trackAdapterType, self)\n            : '')\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      getTrackConfig(timestamp: number) {\n        const session = getSession(self)\n        const assemblyInstance = session.assemblyManager.get(self.assembly)\n\n        return assemblyInstance &&\n          self.trackAdapter &&\n          self.trackAdapter.type !== 'UNKNOWN'\n          ? deepmerge(\n              {\n                trackId: [\n                  `${self.trackName.toLowerCase().replaceAll(' ', '_')}-${timestamp}`,\n                  session.adminMode ? '' : '-sessionTrack',\n                ].join(''),\n                type: self.trackType,\n                name: self.trackName,\n                assemblyNames: [self.assembly],\n                adapter: self.trackAdapter,\n              },\n              self.mixinData,\n            )\n          : undefined\n      },\n      /**\n       * #getter\n       */\n      get warningMessage() {\n        if (self.isFtp) {\n          return 'Warning: JBrowse cannot access files using the ftp protocol'\n        } else if (self.isRelativeUrl) {\n          return `Warning: one or more of your files do not provide the protocol e.g.\n          https://, please provide an absolute URL unless you are sure a\n          relative URL is intended.`\n        } else if (self.wrongProtocol) {\n          return `Warning: You entered a http:// resources but we cannot access HTTP\n          resources from JBrowse when it is running on https. Please use an\n          https URL for your track, or access the JBrowse app from the http\n          protocol`\n        } else {\n          return ''\n        }\n      },\n    }))\n}\n\nexport type AddTrackStateModel = ReturnType<typeof f>\nexport type AddTrackModel = Instance<AddTrackStateModel>\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('AddTrackWidget', {})\n\nexport default function AddTrackWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'AddTrackWidget',\n      heading: 'Add a track',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/AddTrackWidget.tsx')),\n    })\n  })\n}\n","import {\n  getSnapshot,\n  getType,\n  isArrayType,\n  isLateType,\n  isMapType,\n  isModelType,\n  isOptionalType,\n  isStateTreeNode,\n  isType,\n  isUnionType,\n} from '@jbrowse/mobx-state-tree'\n\ninterface ConfigSlot {\n  getValue: (args: Record<string, unknown>) => unknown\n}\n\n// confObject[slotPath] can return:\n// - a config slot model (has getValue method)\n// - a sub-configuration object (nested config schema)\n// - a primitive value (string, number, etc.)\n// - undefined/null\nfunction isConfigSlot(slot: unknown): slot is ConfigSlot {\n  return typeof (slot as ConfigSlot | undefined)?.getValue === 'function'\n}\n\nimport {\n  getDefaultValue,\n  getSubType,\n  getUnionSubTypes,\n  resolveLateType,\n} from '../util/mst-reflection.ts'\n\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n  ConfigurationSchemaForModel,\n  ConfigurationSlotName,\n} from './types.ts'\n\n/**\n * given a configuration model (an instance of a ConfigurationSchema),\n * read the configuration variable at the given path\n *\n * @param model - instance of ConfigurationSchema\n * @param slotPaths - array of paths to read\n * @param args - extra arguments e.g. for a feature callback,\n *  will be sent to each of the slotNames\n */\nexport function readConfObject<CONFMODEL extends AnyConfigurationModel>(\n  confObject: CONFMODEL,\n  slotPath?:\n    | ConfigurationSlotName<ConfigurationSchemaForModel<CONFMODEL>>\n    | string[],\n  args: Record<string, unknown> = {},\n): any {\n  if (!slotPath) {\n    // Handle both MST nodes and plain objects\n    return isStateTreeNode(confObject)\n      ? structuredClone(getSnapshot(confObject))\n      : structuredClone(confObject)\n  } else if (typeof slotPath === 'string') {\n    // slot can be a config slot model, sub-configuration, primitive, or undefined\n    let slot: unknown = confObject[slotPath]\n    // check for the subconf being a map if we don't find it immediately\n    // (only do expensive type check if slot is falsy)\n    if (!slot) {\n      if (isStateTreeNode(confObject) && isMapType(getType(confObject))) {\n        slot = confObject.get(slotPath)\n      }\n      if (!slot) {\n        return undefined\n      }\n    }\n    const val = isConfigSlot(slot) ? slot.getValue(args) : slot\n    // Fast path for primitives (most common case)\n    if (val === null || typeof val !== 'object') {\n      return val\n    }\n    // For objects, clone to prevent mutation of config state\n    // Use structuredClone for MST snapshots (faster than JSON.parse/stringify)\n    return isStateTreeNode(val) ? structuredClone(getSnapshot(val)) : val\n  } else if (Array.isArray(slotPath)) {\n    const slotName = slotPath[0]!\n    if (slotPath.length > 1) {\n      const newPath = slotPath.slice(1)\n      let subConf = confObject[slotName]\n      // check for the subconf being a map if we don't find it immediately\n      if (\n        !subConf &&\n        isStateTreeNode(confObject) &&\n        isMapType(getType(confObject))\n      ) {\n        subConf = confObject.get(slotName)\n      }\n      return subConf ? readConfObject(subConf, newPath, args) : undefined\n    }\n    return readConfObject(\n      confObject,\n      slotName as ConfigurationSlotName<ConfigurationSchemaForModel<CONFMODEL>>,\n      args,\n    )\n  }\n  throw new TypeError('slotPath must be a string or array')\n}\n\n/**\n * helper method for readConfObject, reads the config from a mst model\n *\n * @param model - object containing a 'configuration' member\n * @param slotPaths - array of paths to read\n * @param args - extra arguments e.g. for a feature callback,\n *   will be sent to each of the slotNames\n */\nexport function getConf<CONFMODEL extends AnyConfigurationModel>(\n  model: { configuration: CONFMODEL },\n  slotPath?: Parameters<typeof readConfObject<CONFMODEL>>[1],\n  args?: Parameters<typeof readConfObject<CONFMODEL>>[2],\n) {\n  // Trust TypeScript types - the generic constraint ensures configuration is valid\n  return readConfObject<CONFMODEL>(model.configuration, slotPath, args)\n}\n\n/**\n * given a union of explicitly typed configuration schema types,\n * extract an array of the type names contained in the union\n *\n * @param unionType -\n * @returns Array of type names contained in the union\n */\nexport function getTypeNamesFromExplicitlyTypedUnion(maybeUnionType: unknown) {\n  if (isType(maybeUnionType)) {\n    maybeUnionType = resolveLateType(maybeUnionType)\n    // @ts-expect-error\n    if (isUnionType(maybeUnionType)) {\n      const typeNames: string[] = []\n      for (let type of getUnionSubTypes(maybeUnionType)) {\n        type = resolveLateType(type)\n        let typeName = getTypeNamesFromExplicitlyTypedUnion(type)\n        if (!typeName.length) {\n          const def = getDefaultValue(type)\n          typeName = [def.type]\n        }\n        if (!typeName[0]) {\n          // debugger\n          throw new Error(`invalid config schema type ${type}`)\n        }\n        typeNames.push(...typeName)\n      }\n      return typeNames\n    }\n  }\n  return []\n}\n\nexport function isBareConfigurationSchemaType(\n  thing: unknown,\n): thing is AnyConfigurationSchemaType {\n  if (isType(thing)) {\n    if (\n      isModelType(thing) &&\n      ('isJBrowseConfigurationSchema' in thing ||\n        thing.name.includes('ConfigurationSchema'))\n    ) {\n      return true\n    }\n    // if it's a late type, assume its a config schema\n    if (isLateType(thing)) {\n      return true\n    }\n  }\n  return false\n}\n\nexport function isConfigurationSchemaType(\n  thing: unknown,\n): thing is AnyConfigurationSchemaType {\n  // written as a series of if-statements instead of a big logical because this\n  // construction gives much better debugging backtraces.\n\n  // also, note that the order of these statements matters, because for example\n  // some union types are also optional types\n\n  if (!isType(thing)) {\n    return false\n  } else if (isBareConfigurationSchemaType(thing)) {\n    return true\n  } else if (isUnionType(thing)) {\n    return getUnionSubTypes(thing).every(\n      t => isConfigurationSchemaType(t) || t.name === 'undefined',\n    )\n  } else if (\n    isOptionalType(thing) &&\n    isConfigurationSchemaType(getSubType(thing))\n  ) {\n    return true\n  } else if (\n    isArrayType(thing) &&\n    isConfigurationSchemaType(getSubType(thing))\n  ) {\n    return true\n  } else if (isMapType(thing) && isConfigurationSchemaType(getSubType(thing))) {\n    return true\n  } else {\n    return false\n  }\n}\n\n// Cache for isConfigurationModel results to avoid expensive repeated type checks\nconst configurationModelCache = new WeakMap<object, boolean>()\n\nexport function isConfigurationModel(\n  thing: unknown,\n): thing is AnyConfigurationModel {\n  if (!thing || typeof thing !== 'object') {\n    return false\n  }\n  let cached = configurationModelCache.get(thing)\n  if (cached === undefined) {\n    cached = isStateTreeNode(thing) && isConfigurationSchemaType(getType(thing))\n    configurationModelCache.set(thing, cached)\n  }\n  return cached\n}\n\nexport function isConfigurationSlotType(thing: unknown) {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'isJBrowseConfigurationSlot' in thing\n  )\n}\n","import { Jexl } from '@jbrowse/jexl'\n\nimport type { Feature } from './simpleFeature.ts'\n\nexport default function JexlF(/* config?: any*/) {\n  const j = new Jexl()\n  // someday will make sure all of configs callbacks are added in, including\n  // ones passed in\n\n  // below are core functions\n  j.addFunction('get', (feature: Feature, data: string) => feature.get(data))\n  j.addFunction('parent', (feature: Feature) => feature.parent?.())\n\n  j.addFunction('id', (feature: Feature) => feature.id())\n\n  // let user cast a jexl type into a javascript type\n  j.addFunction('cast', (arg: unknown) => arg)\n\n  // logging\n  j.addFunction('log', (thing: unknown) => {\n    console.log(thing) // eslint-disable-line no-console\n    return thing\n  })\n\n  // math\n  // addfunction added in jexl 2.3 but types/jexl still on 2.2\n  j.addFunction('max', Math.max)\n  j.addFunction('min', Math.min)\n  j.addFunction('sqrt', Math.sqrt)\n  j.addFunction('ceil', Math.ceil)\n  j.addFunction('floor', Math.floor)\n  j.addFunction('round', Math.round)\n  j.addFunction('abs', Math.abs)\n  j.addFunction('log10', Math.log10)\n  j.addFunction('parseInt', Number.parseInt)\n  j.addFunction('parseFloat', Number.parseFloat)\n\n  // string\n  j.addFunction('split', (s: string, char: string) => s.split(char))\n  j.addFunction('join', (k: string, ...args: string[]) =>\n    [...args].filter(f => !!f).join(k),\n  )\n  j.addFunction('charAt', (s: string, index: number) => s.charAt(index))\n  j.addFunction('charCodeAt', (s: string, index: number) => s.charCodeAt(index))\n  j.addFunction('codePointAt', (s: string, pos: number) => s.codePointAt(pos))\n  j.addFunction('startsWith', (s: string, search: string, len?: number) =>\n    s.startsWith(search, len),\n  )\n  j.addFunction('endsWith', (s: string, search: string, len?: number) =>\n    s.endsWith(search, len),\n  )\n  j.addFunction('padEnd', (s: string, len: number, pad?: string) =>\n    s.padEnd(len, pad),\n  )\n  j.addFunction('padStart', (s: string, len: number, fill?: string) =>\n    s.padStart(len, fill),\n  )\n  j.addFunction('repeat', (s: string, count: number) => s.repeat(count))\n  j.addFunction('replace', (s: string, match: string, sub: string) =>\n    s.replace(match, sub),\n  )\n  j.addFunction('replaceAll', (s: string, match: string, sub: string) =>\n    s.replaceAll(match, sub),\n  )\n  j.addFunction('slice', (s: string, start: number, end?: number) =>\n    s.slice(start, end),\n  )\n  j.addFunction('startsWith', (s: string, search: string, pos?: number) =>\n    s.startsWith(search, pos),\n  )\n  j.addFunction('substring', (s: string, start: number, end?: number) =>\n    // eslint-disable-next-line unicorn/prefer-string-slice\n    s.substring(start, end),\n  )\n  j.addFunction('toLowerCase', (s: string) => s.toLowerCase())\n  j.addFunction('toUpperCase', (s: string) => s.toUpperCase())\n  j.addFunction('jsonParse', (s: string) => JSON.parse(s))\n  j.addFunction('trim', (s: string) => s.trim())\n  j.addFunction('trimEnd', (s: string) => s.trimEnd())\n  j.addFunction('trimStart', (s: string) => s.trimStart())\n\n  j.addFunction('getTag', (feature: Feature, s: string) => {\n    const tags = feature.get('tags')\n    return tags ? tags[s] : feature.get(s)\n  })\n\n  j.addBinaryOp('&', 15, (a: number, b: number) => a & b)\n\n  return j\n}\n","import { ConfigurationSchema } from '../../configuration/index.ts'\n\n/**\n * #config BaseInternetAccount\n * the \"base\" internet account type\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport const BaseInternetAccountConfig = ConfigurationSchema(\n  'InternetAccount',\n  {\n    /**\n     * #slot\n     */\n    name: {\n      description: 'descriptive name of the internet account',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    description: {\n      description: 'a description of the internet account',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    authHeader: {\n      description: 'request header for credentials',\n      type: 'string',\n      defaultValue: 'Authorization',\n    },\n    /**\n     * #slot\n     */\n    tokenType: {\n      description: 'a custom name for a token to include in the header',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    domains: {\n      description:\n        'array of valid domains the url can contain to use this account',\n      type: 'stringArray',\n      defaultValue: [],\n    },\n  },\n  {\n    /**\n     * #identifier\n     */\n    explicitIdentifier: 'internetAccountId',\n    explicitlyTyped: true,\n  },\n)\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport {\n  ContentBlock as ContentBlockComponent,\n  ElidedBlock as ElidedBlockComponent,\n  InterRegionPaddingBlock as InterRegionPaddingBlockComponent,\n} from '../../BaseLinearDisplay/components/Block.tsx'\nimport { makeTicks } from '../util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { ContentBlock } from '@jbrowse/core/util/blockTypes'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()(theme => ({\n  // Outer container that handles zoom scaling via CSS transform\n  verticalGuidesZoomContainer: {\n    position: 'absolute',\n    top: 0,\n    height: '100%',\n    width: '100%',\n    pointerEvents: 'none',\n  },\n  // Inner container positioned using CSS calc() with --offset-px variable\n  verticalGuidesContainer: {\n    position: 'absolute',\n    height: '100%',\n    pointerEvents: 'none',\n    display: 'flex',\n  },\n  tick: {\n    position: 'absolute',\n    height: '100%',\n    width: 1,\n  },\n  majorTick: {\n    background: theme.palette.action.disabled,\n  },\n  minorTick: {\n    background: theme.palette.divider,\n  },\n}))\n\nfunction RenderedBlockLines({\n  block,\n  bpPerPx,\n}: {\n  block: ContentBlock\n  bpPerPx: number\n}) {\n  const { classes } = useStyles()\n  const { start, end, reversed } = block\n  const ticks = makeTicks(start, end, bpPerPx)\n  const majorTickClass = `${classes.tick} ${classes.majorTick}`\n  const minorTickClass = `${classes.tick} ${classes.minorTick}`\n\n  return (\n    <ContentBlockComponent block={block}>\n      {ticks.map(({ type, base }) => {\n        const x = (reversed ? end - base : base - start) / bpPerPx\n        return (\n          <div\n            key={base}\n            className={\n              type === 'major' || type === 'labeledMajor'\n                ? majorTickClass\n                : minorTickClass\n            }\n            style={{ left: x }}\n          />\n        )\n      })}\n    </ContentBlockComponent>\n  )\n}\n\nconst RenderedVerticalGuides = observer(function RenderedVerticalGuides({\n  model,\n}: {\n  model: LGV\n}) {\n  const { staticBlocks, bpPerPx } = model\n  return (\n    <>\n      {staticBlocks.map((block, index) => {\n        const k = `${block.key}-${index}`\n        if (block.type === 'ContentBlock') {\n          return <RenderedBlockLines key={k} block={block} bpPerPx={bpPerPx} />\n        } else if (block.type === 'ElidedBlock') {\n          return <ElidedBlockComponent key={k} width={block.widthPx} />\n        } else if (block.type === 'InterRegionPaddingBlock') {\n          return (\n            <InterRegionPaddingBlockComponent\n              key={k}\n              width={block.widthPx}\n              boundary={block.variant === 'boundary'}\n            />\n          )\n        }\n        return null\n      })}\n    </>\n  )\n})\n\nconst Gridlines = observer(function Gridlines({\n  model,\n  offset = 0,\n}: {\n  model: LGV\n  offset?: number\n}) {\n  const { classes } = useStyles()\n  const { staticBlocks, scaleFactor } = model\n  return (\n    <div\n      className={classes.verticalGuidesZoomContainer}\n      style={{\n        transform: scaleFactor !== 1 ? `scaleX(${scaleFactor})` : undefined,\n      }}\n    >\n      <div\n        className={classes.verticalGuidesContainer}\n        style={{\n          // Uses --offset-px CSS variable from parent (TracksContainer or Scalebar)\n          left: `calc(${staticBlocks.offsetPx}px - var(--offset-px) - ${offset}px)`,\n          width: staticBlocks.totalWidthPx,\n        }}\n      >\n        <RenderedVerticalGuides model={model} />\n      </div>\n    </div>\n  )\n})\n\nexport default Gridlines\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport DragIcon from '@mui/icons-material/DragIndicator'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nconst useStyles = makeStyles()({\n  dragHandle: {\n    cursor: 'grab',\n  },\n  dragHandleIcon: {\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    pointerEvents: 'none',\n  },\n})\n\nfunction TrackLabelDragHandle({\n  trackId,\n  view,\n  track,\n}: {\n  trackId: string\n  track: BaseTrackModel\n  view: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  return (\n    <span\n      draggable\n      className={classes.dragHandle}\n      onDragStart={event => {\n        const target = event.currentTarget\n        if (target.parentNode) {\n          const parent = target.parentNode as HTMLElement\n          event.dataTransfer.setDragImage(parent, 20, 20)\n          view.setDraggingTrackId(track.id)\n        }\n      }}\n      onDragEnd={() => {\n        view.setDraggingTrackId(undefined)\n      }}\n      data-testid={`dragHandle-${view.id}-${trackId}`}\n    >\n      <DragIcon className={classes.dragHandleIcon} fontSize=\"small\" />\n    </span>\n  )\n}\n\nexport default TrackLabelDragHandle\n","import { useCallback } from 'react'\n\nimport CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport AddIcon from '@mui/icons-material/Add'\nimport KeyboardArrowDownIcon from '@mui/icons-material/KeyboardArrowDown'\nimport KeyboardArrowUpIcon from '@mui/icons-material/KeyboardArrowUp'\nimport KeyboardDoubleArrowDownIcon from '@mui/icons-material/KeyboardDoubleArrowDown'\nimport KeyboardDoubleArrowUpIcon from '@mui/icons-material/KeyboardDoubleArrowUp'\nimport LowPriorityIcon from '@mui/icons-material/LowPriority'\nimport MinimizeIcon from '@mui/icons-material/Minimize'\nimport MoreVertIcon from '@mui/icons-material/MoreVert'\nimport PushPinIcon from '@mui/icons-material/PushPin'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '../model.ts'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport type { MenuItem } from '@jbrowse/core/ui'\n\nconst TrackLabelMenu = observer(function TrackLabelMenu({\n  track,\n}: {\n  track: BaseTrackModel\n}) {\n  const view = getContainingView(track) as LinearGenomeViewModel\n  const session = getSession(track)\n\n  const getMenuItems = useCallback((): MenuItem[] => {\n    const trackConf = track.configuration\n    const minimized = track.minimized\n    const pinned = track.pinned\n    const { isTopLevelView } = view\n\n    const trackMenuItems = track.trackMenuItems()\n    const saveTrackData = trackMenuItems.find(\n      item => 'label' in item && item.label === 'Save track data',\n    )\n    const remainingTrackMenuItems = trackMenuItems.filter(\n      item => !('label' in item) || item.label !== 'Save track data',\n    )\n\n    const sessionItems =\n      session.getTrackActionMenuItems?.(\n        trackConf,\n        saveTrackData ? [saveTrackData] : [],\n      ) || []\n\n    return [\n      {\n        label: 'Track order',\n        icon: LowPriorityIcon,\n        type: 'subMenu' as const,\n        priority: 1000,\n        subMenu: [\n          ...(!isTopLevelView\n            ? []\n            : [\n                {\n                  label: pinned ? 'Unpin track' : 'Pin track',\n                  icon: PushPinIcon,\n                  onClick: () => {\n                    track.setPinned(!pinned)\n                  },\n                },\n              ]),\n          {\n            label: minimized ? 'Restore track' : 'Minimize track',\n            icon: minimized ? AddIcon : MinimizeIcon,\n            onClick: () => {\n              track.setMinimized(!minimized)\n            },\n          },\n          ...(view.tracks.length > 2\n            ? [\n                {\n                  label: 'Move track to top',\n                  icon: KeyboardDoubleArrowUpIcon,\n                  onClick: () => {\n                    view.moveTrackToTop(track.id)\n                  },\n                },\n              ]\n            : []),\n          ...(view.tracks.length > 1\n            ? [\n                {\n                  label: 'Move track up',\n                  icon: KeyboardArrowUpIcon,\n                  onClick: () => {\n                    view.moveTrackUp(track.id)\n                  },\n                },\n                {\n                  label: 'Move track down',\n                  icon: KeyboardArrowDownIcon,\n                  onClick: () => {\n                    view.moveTrackDown(track.id)\n                  },\n                },\n              ]\n            : []),\n          ...(view.tracks.length > 2\n            ? [\n                {\n                  label: 'Move track to bottom',\n                  icon: KeyboardDoubleArrowDownIcon,\n                  onClick: () => {\n                    view.moveTrackToBottom(track.id)\n                  },\n                },\n              ]\n            : []),\n        ],\n      },\n      ...sessionItems,\n      ...remainingTrackMenuItems,\n    ].sort((a, b) => (b.priority || 0) - (a.priority || 0))\n  }, [track, view, session])\n\n  return (\n    <CascadingMenuButton menuItems={getMenuItems} data-testid=\"track_menu_icon\">\n      <MoreVertIcon fontSize=\"small\" />\n    </CascadingMenuButton>\n  )\n})\n\nexport default TrackLabelMenu\n","import { SanitizedHTML } from '@jbrowse/core/ui'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\nimport { cx, makeStyles } from '@jbrowse/core/util/tss-react'\nimport CloseIcon from '@mui/icons-material/Close'\nimport { IconButton, Paper, Typography, alpha } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport TrackLabelDragHandle from './TrackLabelDragHandle.tsx'\nimport TrackLabelMenu from './TrackLabelMenu.tsx'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nconst useStyles = makeStyles()(theme => ({\n  root: {\n    // above breakpoint split view\n    zIndex: 200,\n    background: alpha(theme.palette.background.paper, 0.8),\n    '&:hover': {\n      background: theme.palette.background.paper,\n    },\n  },\n  trackName: {\n    margin: '0 auto',\n    width: '90%',\n    fontSize: '0.8rem',\n    pointerEvents: 'none',\n  },\n  iconButton: {\n    padding: theme.spacing(1),\n  },\n}))\n\ntype LGV = LinearGenomeViewModel\n\ninterface Props {\n  track: BaseTrackModel\n  className?: string\n}\n\nconst TrackLabel = observer(function TrackLabel({ track, className }: Props) {\n  const { classes } = useStyles()\n  const view = getContainingView(track) as LGV\n  const session = getSession(track)\n  const { minimized } = track\n  const trackId = track.trackId\n  const trackName = getTrackName(track.configuration, session)\n\n  return (\n    <Paper\n      className={cx(className, classes.root)}\n      onClick={event => {\n        // avoid clicks on track label from turning into double-click zoom\n        event.stopPropagation()\n      }}\n    >\n      <TrackLabelDragHandle track={track} trackId={trackId} view={view} />\n      <IconButton\n        onClick={() => view.hideTrack(trackId)}\n        className={classes.iconButton}\n        title=\"close this track\"\n      >\n        <CloseIcon fontSize=\"small\" />\n      </IconButton>\n\n      <Typography\n        variant=\"body1\"\n        component=\"span\"\n        className={classes.trackName}\n      >\n        <SanitizedHTML\n          html={[trackName, minimized ? '(minimized)' : '']\n            .filter(f => !!f)\n            .join(' ')}\n        />\n      </Typography>\n      <TrackLabelMenu track={track} />\n    </Paper>\n  )\n})\n\nexport default TrackLabel\n","import { cx, makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport TrackLabel from './TrackLabel.tsx'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nconst useStyles = makeStyles()({\n  trackLabel: {\n    zIndex: 2,\n  },\n\n  trackLabelOffset: {\n    position: 'relative',\n    display: 'inline-block',\n  },\n  trackLabelOverlap: {\n    position: 'absolute',\n  },\n})\n\ntype LGV = LinearGenomeViewModel\n\nconst TrackLabelContainer = observer(function TrackLabelContainer({\n  track,\n  view,\n}: {\n  track: BaseTrackModel\n  view: LGV\n}) {\n  const { classes } = useStyles()\n  const display = track.displays[0]\n  const labelStyle =\n    view.trackLabelsSetting !== 'overlapping' || display.prefersOffset\n      ? classes.trackLabelOffset\n      : classes.trackLabelOverlap\n\n  return view.trackLabelsSetting !== 'hidden' ? (\n    <TrackLabel track={track} className={cx(classes.trackLabel, labelStyle)} />\n  ) : null\n})\n\nexport default TrackLabelContainer\n","import { Suspense, useEffect, useRef } from 'react'\n\nimport { LoadingEllipses } from '@jbrowse/core/ui'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nconst useStyles = makeStyles()({\n  // aligns with block boundaries. check for example the breakpoint split view\n  // demo to see if features align if wanting to change things\n  renderingComponentContainer: {\n    position: 'absolute',\n    // -1 offset because of the 1px border of the Paper\n    left: -1,\n    height: '100%',\n    width: '100%',\n  },\n\n  trackRenderingContainer: {\n    overflowY: 'auto',\n    overflowX: 'hidden',\n    whiteSpace: 'nowrap',\n    position: 'relative',\n    background: 'none',\n    contain: 'strict',\n  },\n})\n\ntype LGV = LinearGenomeViewModel\n\nconst TrackRenderingContainer = observer(function TrackRenderingContainer({\n  model,\n  track,\n}: {\n  model: LGV\n  track: BaseTrackModel\n}) {\n  const { classes } = useStyles()\n  const display = track.displays[0]\n  const { height, RenderingComponent, DisplayBlurb } = display\n  const { trackRefs, id, scaleFactor } = model\n  const trackId = track.trackId\n  const ref = useRef<HTMLDivElement>(null)\n  const minimized = track.minimized\n\n  useEffect(() => {\n    if (ref.current) {\n      trackRefs[trackId] = ref.current\n    }\n    return () => {\n      delete trackRefs[trackId]\n    }\n  }, [trackRefs, trackId])\n\n  return (\n    <div\n      className={classes.trackRenderingContainer}\n      style={{\n        height: minimized ? 20 : height,\n      }}\n      onScroll={evt => display.setScrollTop(evt.currentTarget.scrollTop)}\n      data-testid={`trackRenderingContainer-${id}-${trackId}`}\n    >\n      {!minimized ? (\n        <>\n          <div\n            ref={ref}\n            className={classes.renderingComponentContainer}\n            style={{\n              transform:\n                scaleFactor !== 1 ? `scaleX(${scaleFactor})` : undefined,\n            }}\n          >\n            <Suspense fallback={<LoadingEllipses />}>\n              <RenderingComponent\n                model={display}\n                onHorizontalScroll={model.horizontalScroll}\n              />\n            </Suspense>\n          </div>\n\n          {DisplayBlurb ? (\n            <div\n              style={{\n                position: 'absolute',\n                left: 0,\n                top: display.height - 20,\n              }}\n            >\n              <DisplayBlurb model={display} />\n            </div>\n          ) : null}\n        </>\n      ) : null}\n    </div>\n  )\n})\n\nexport default TrackRenderingContainer\n","import { useRef } from 'react'\n\nimport { ErrorMessage, ResizeHandle } from '@jbrowse/core/ui'\nimport { ErrorBoundary } from '@jbrowse/core/ui/ErrorBoundary'\nimport { cx, makeStyles } from '@jbrowse/core/util/tss-react'\nimport { isAlive } from '@jbrowse/mobx-state-tree'\nimport { Paper } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport Gridlines from './Gridlines.tsx'\nimport TrackLabelContainer from './TrackLabelContainer.tsx'\nimport TrackRenderingContainer from './TrackRenderingContainer.tsx'\nimport { shouldSwapTracks } from './util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { BaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nconst useStyles = makeStyles()(theme => ({\n  root: {\n    marginTop: 2,\n    overflow: 'hidden',\n    position: 'relative',\n    contain: 'layout style paint',\n  },\n  unpinnedTrack: {\n    background: 'none',\n  },\n  resizeHandle: {\n    height: 4,\n    boxSizing: 'border-box',\n    position: 'relative',\n    background: 'transparent',\n    '&:hover': {\n      background: theme.palette.divider,\n    },\n  },\n}))\n\ntype LGV = LinearGenomeViewModel\n\nconst TrackContainer = observer(function TrackContainer({\n  model,\n  track,\n}: {\n  model: LGV\n  track: BaseTrackModel\n}) {\n  const { classes } = useStyles()\n  const display = track.displays[0]\n  const { draggingTrackId, showTrackOutlines } = model\n  const ref = useRef<HTMLDivElement>(null)\n\n  return (\n    <Paper\n      ref={ref}\n      className={cx(classes.root, track.pinned ? null : classes.unpinnedTrack)}\n      variant={showTrackOutlines ? 'outlined' : undefined}\n      elevation={showTrackOutlines ? undefined : 0}\n      onClick={event => {\n        if (event.detail === 2 && !display.featureIdUnderMouse) {\n          const left = ref.current?.getBoundingClientRect().left || 0\n          model.zoomTo(model.bpPerPx / 2, event.clientX - left, true)\n        }\n      }}\n      onDragOver={event => {\n        if (\n          isAlive(display) &&\n          draggingTrackId !== undefined &&\n          draggingTrackId !== display.id\n        ) {\n          const draggingIdx = model.tracks.findIndex(\n            t => t.id === draggingTrackId,\n          )\n          const targetIdx = model.tracks.findIndex(t => t.id === track.id)\n          const movingDown = targetIdx > draggingIdx\n          const currentY = event.clientY\n\n          if (shouldSwapTracks(model.lastTrackDragY, currentY, movingDown)) {\n            model.setLastTrackDragY(currentY)\n            model.moveTrack(draggingTrackId, track.id)\n          }\n        }\n      }}\n    >\n      {/* offset 1px since for left track border */}\n      {track.pinned ? <Gridlines model={model} offset={1} /> : null}\n      <TrackLabelContainer track={track} view={model} />\n      <ErrorBoundary FallbackComponent={e => <ErrorMessage error={e.error} />}>\n        <TrackRenderingContainer model={model} track={track} />\n      </ErrorBoundary>\n      <ResizeHandle\n        onDrag={display.resizeHeight}\n        className={classes.resizeHandle}\n      />\n    </Paper>\n  )\n})\n\nexport default TrackContainer\n","import { stringify } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Tooltip } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()({\n  guide: {\n    pointerEvents: 'none',\n    height: '100%',\n    width: 1,\n    position: 'absolute',\n    left: 0,\n    background: 'red',\n    zIndex: 1001,\n  },\n  tooltipTarget: {\n    position: 'sticky',\n    left: 0,\n    width: 1,\n  },\n})\n\nconst VerticalGuide = observer(function VerticalGuide({\n  model,\n  coordX,\n}: {\n  model: LGV\n  coordX: number\n}) {\n  const { classes } = useStyles()\n  const { stickyViewHeaders, rubberbandTop } = model\n\n  return (\n    <>\n      <Tooltip\n        open\n        placement=\"top\"\n        title={stringify(model.pxToBp(coordX))}\n        arrow\n      >\n        <div\n          className={classes.tooltipTarget}\n          style={{\n            transform: `translateX(${coordX + 6}px)`,\n            top: rubberbandTop,\n            position: stickyViewHeaders ? 'sticky' : undefined,\n          }}\n        />\n      </Tooltip>\n      <div\n        className={classes.guide}\n        style={{ transform: `translateX(${coordX}px)` }}\n      />\n    </>\n  )\n})\n\nexport default VerticalGuide\n","import type React from 'react'\nimport { useCallback, useEffect, useState } from 'react'\n\nimport { getRelativeX } from './util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\n\ninterface AnchorPosition {\n  offsetX: number\n  clientX: number\n  clientY: number\n  isClick?: boolean\n}\n\nexport function useRangeSelect(\n  ref: React.RefObject<HTMLDivElement | null>,\n  model: LinearGenomeViewModel,\n  shiftOnly?: boolean,\n) {\n  const [startX, setStartX] = useState<number>()\n  const [currentX, setCurrentX] = useState<number>()\n\n  // clientX and clientY used for anchorPosition for menu\n  // offsetX used for calculations about width of selection\n  const [anchorPosition, setAnchorPosition] = useState<AnchorPosition>()\n  const [guideX, setGuideX] = useState<number>()\n  const mouseDragging = startX !== undefined && anchorPosition === undefined\n\n  const handleClose = useCallback(() => {\n    setAnchorPosition(undefined)\n    setStartX(undefined)\n    setCurrentX(undefined)\n    setGuideX(undefined)\n  }, [])\n\n  useEffect(() => {\n    function computeOffsets(offsetX: number) {\n      if (startX === undefined) {\n        return\n      }\n      const leftPx = Math.min(startX, offsetX)\n      const rightPx = Math.max(startX, offsetX)\n      return {\n        leftOffset: model.pxToBp(leftPx),\n        rightOffset: model.pxToBp(rightPx),\n      }\n    }\n\n    function globalMouseMove(event: MouseEvent) {\n      if (ref.current && mouseDragging) {\n        const relativeX = getRelativeX(event, ref.current)\n        setCurrentX(relativeX)\n      }\n    }\n\n    function globalMouseUp(event: MouseEvent) {\n      if (startX !== undefined && ref.current) {\n        const { clientX, clientY } = event\n        const offsetX = getRelativeX(event, ref.current)\n        const isClick = Math.abs(offsetX - startX) <= 3\n\n        // If click started on a scalebar refname label, let that component\n        // handle it instead of showing the rubberband menu\n        if (isClick && model.scalebarRefNameClickPending) {\n          setStartX(undefined)\n          setCurrentX(undefined)\n          return\n        }\n\n        // Clear the pending flag if it was a drag (not a click)\n        if (!isClick && model.scalebarRefNameClickPending) {\n          model.setScalebarRefNameClickPending(false)\n        }\n\n        // store both clientX/Y and offsetX for different purposes\n        setAnchorPosition({\n          offsetX,\n          clientX,\n          clientY,\n          isClick,\n        })\n        if (isClick) {\n          setGuideX(offsetX)\n        } else {\n          const args = computeOffsets(offsetX)\n          if (args) {\n            model.setOffsets(args.leftOffset, args.rightOffset)\n          }\n          setGuideX(undefined)\n        }\n      }\n    }\n    if (mouseDragging) {\n      window.addEventListener('mousemove', globalMouseMove)\n      window.addEventListener('mouseup', globalMouseUp)\n      return () => {\n        window.removeEventListener('mousemove', globalMouseMove)\n        window.removeEventListener('mouseup', globalMouseUp)\n      }\n    }\n    return () => {}\n  }, [startX, mouseDragging, model, ref, handleClose])\n\n  function mouseDown(event: React.MouseEvent<HTMLDivElement>) {\n    if (shiftOnly && !event.shiftKey) {\n      return\n    }\n    if (model.isScalebarRefNameMenuOpen) {\n      return\n    }\n\n    event.preventDefault()\n    event.stopPropagation()\n    const relativeX = getRelativeX(event, ref.current)\n    setStartX(relativeX)\n    setCurrentX(relativeX)\n  }\n\n  function mouseMove(event: React.MouseEvent<HTMLDivElement>) {\n    // If we have a rubberband selection active (menu is open from a drag, not a click),\n    // don't update guideX - let the rubberband stay visible\n    if (anchorPosition?.isClick === false) {\n      return\n    }\n    if (mouseDragging) {\n      setGuideX(undefined)\n    } else if (shiftOnly) {\n      if (event.shiftKey) {\n        setGuideX(getRelativeX(event, ref.current))\n      } else {\n        setGuideX(undefined)\n      }\n    } else {\n      setGuideX(getRelativeX(event, ref.current))\n    }\n  }\n\n  function mouseOut() {\n    if (!anchorPosition?.isClick) {\n      setGuideX(undefined)\n    }\n  }\n\n  function handleMenuItemClick(_: unknown, callback: () => void) {\n    callback()\n    handleClose()\n  }\n\n  const open = Boolean(anchorPosition)\n  const isClick = anchorPosition?.isClick\n  const clickBpOffset = isClick\n    ? model.pxToBp(anchorPosition.offsetX)\n    : undefined\n\n  if (startX === undefined) {\n    return {\n      open,\n      isClick,\n      clickBpOffset,\n      guideX,\n      mouseDown,\n      mouseMove,\n      mouseOut,\n      handleClose,\n      handleMenuItemClick,\n      anchorPosition,\n    }\n  }\n  const right = anchorPosition ? anchorPosition.offsetX : currentX || 0\n  const left = Math.min(right, startX)\n  const width = Math.abs(right - startX)\n  const leftBpOffset = model.pxToBp(left)\n  const rightBpOffset = model.pxToBp(left + width)\n  const numOfBpSelected = Math.ceil(width * model.bpPerPx)\n\n  return {\n    open,\n    isClick,\n    clickBpOffset,\n    guideX,\n    rubberbandOn: !isClick,\n    mouseDown,\n    mouseMove,\n    mouseOut,\n    handleClose,\n    handleMenuItemClick,\n    leftBpOffset,\n    rightBpOffset,\n    anchorPosition,\n    numOfBpSelected,\n    width,\n    left,\n  }\n}\n","import { useRef } from 'react'\n\nimport { Menu } from '@jbrowse/core/ui'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport RubberbandSpan from './RubberbandSpan.tsx'\nimport VerticalGuide from './VerticalGuide.tsx'\nimport { useRangeSelect } from './useRangeSelect.ts'\n\nimport type { LinearGenomeViewModel } from '..'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()({\n  rubberbandControl: {\n    cursor: 'crosshair',\n    width: '100%',\n    minHeight: 8,\n    zIndex: 825,\n  },\n})\n\nconst Rubberband = observer(function Rubberband({\n  model,\n  ControlComponent = <div />,\n}: {\n  model: LGV\n  ControlComponent?: React.ReactElement\n}) {\n  const ref = useRef<HTMLDivElement>(null)\n  const { classes } = useStyles()\n  const { stickyViewHeaders, rubberbandTop, isScalebarRefNameMenuOpen } = model\n\n  const {\n    guideX,\n    rubberbandOn,\n    leftBpOffset,\n    rightBpOffset,\n    numOfBpSelected,\n    width,\n    left,\n    anchorPosition,\n    open,\n    isClick,\n    clickBpOffset,\n    handleMenuItemClick,\n    handleClose,\n    mouseMove,\n    mouseDown,\n    mouseOut,\n  } = useRangeSelect(ref, model)\n\n  return (\n    <>\n      {guideX !== undefined && !isScalebarRefNameMenuOpen ? (\n        <VerticalGuide model={model} coordX={guideX} />\n      ) : rubberbandOn ? (\n        <RubberbandSpan\n          leftBpOffset={leftBpOffset}\n          rightBpOffset={rightBpOffset}\n          numOfBpSelected={numOfBpSelected}\n          width={width}\n          left={left}\n          top={rubberbandTop}\n          sticky={stickyViewHeaders}\n        />\n      ) : null}\n      {anchorPosition ? (\n        <Menu\n          anchorReference=\"anchorPosition\"\n          anchorPosition={{\n            left: anchorPosition.clientX + 10,\n            top: anchorPosition.clientY,\n          }}\n          onMenuItemClick={handleMenuItemClick}\n          open={open}\n          onClose={handleClose}\n          menuItems={\n            isClick && clickBpOffset\n              ? model.rubberbandClickMenuItems(clickBpOffset)\n              : model.rubberBandMenuItems()\n          }\n        />\n      ) : null}\n      <div\n        data-testid=\"rubberband_controls\"\n        className={classes.rubberbandControl}\n        style={{\n          top: rubberbandTop,\n          position: stickyViewHeaders ? 'sticky' : undefined,\n        }}\n        ref={ref}\n        onMouseDown={mouseDown}\n        onMouseMove={mouseMove}\n        onMouseOut={mouseOut}\n      >\n        {ControlComponent}\n      </div>\n    </>\n  )\n})\n\nexport default Rubberband\n","import { getTickDisplayStr } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport { makeTicks } from '../util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { ContentBlock } from '@jbrowse/core/util/blockTypes'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()(theme => ({\n  block: {\n    position: 'relative',\n    flexShrink: 0,\n    overflow: 'hidden',\n    height: 13,\n  },\n  elidedBlock: {\n    backgroundColor: '#999',\n    backgroundImage:\n      'repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)',\n  },\n  tick: {\n    position: 'absolute',\n    width: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    pointerEvents: 'none',\n  },\n  label: {\n    fontSize: 11,\n    zIndex: 1,\n    background: theme.palette.background.paper,\n    lineHeight: 'normal',\n    pointerEvents: 'none',\n  },\n}))\n\nfunction ContentBlockLabels({\n  block,\n  bpPerPx,\n}: {\n  block: ContentBlock\n  bpPerPx: number\n}) {\n  const { classes } = useStyles()\n  const ticks = makeTicks(block.start, block.end, bpPerPx, true, false)\n\n  return (\n    <div className={classes.block} style={{ width: block.widthPx }}>\n      {ticks.map(({ type, base }) => {\n        if (type !== 'major') {\n          return null\n        }\n        const x =\n          (block.reversed ? block.end - base : base - block.start) / bpPerPx\n        return (\n          <div key={base} className={classes.tick} style={{ left: x }}>\n            <div className={classes.label}>\n              {getTickDisplayStr(base + 1, bpPerPx)}\n            </div>\n          </div>\n        )\n      })}\n    </div>\n  )\n}\n\nconst ScalebarCoordinateLabels = observer(function ScalebarCoordinateLabels({\n  model,\n}: {\n  model: LGV\n}) {\n  const { classes, cx } = useStyles()\n  const { staticBlocks, bpPerPx } = model\n\n  return (\n    <div style={{ display: 'flex' }}>\n      {staticBlocks.map((block, index) => {\n        const key = `${block.key}-${index}`\n        if (block.type === 'ContentBlock') {\n          return (\n            <ContentBlockLabels key={key} block={block} bpPerPx={bpPerPx} />\n          )\n        } else if (block.type === 'ElidedBlock') {\n          return (\n            <div\n              key={key}\n              className={cx(classes.block, classes.elidedBlock)}\n              style={{ width: block.widthPx }}\n            />\n          )\n        }\n        // InterRegionPaddingBlock renders as empty div\n        return (\n          <div\n            key={key}\n            className={classes.block}\n            style={{ width: block.widthPx }}\n          />\n        )\n      })}\n    </div>\n  )\n})\n\nexport default ScalebarCoordinateLabels\n","import { useEffect, useState } from 'react'\n\nimport { Menu } from '@jbrowse/core/ui'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\n\ntype LGV = LinearGenomeViewModel\n\ninterface MenuState {\n  anchorEl: HTMLElement\n  refName: string\n  regionNumber: number\n}\n\nconst useStyles = makeStyles()(theme => ({\n  // Base styles for ref name labels (chromosome names in scalebar)\n  // Uses --offset-px CSS variable from parent Scalebar component\n  refLabel: {\n    fontSize: 11,\n    position: 'absolute',\n    left: 2,\n    top: -1,\n    fontWeight: 'bold',\n    lineHeight: 'normal',\n    zIndex: 1,\n    background: theme.palette.background.paper,\n    cursor: 'pointer',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n    '&:hover': {\n      background: theme.palette.grey[300],\n    },\n  },\n  // First block label when it's not a ContentBlock\n  b0: {\n    left: 0,\n    zIndex: 100,\n  },\n}))\n\nconst ScalebarRefNameLabels = observer(function ScalebarRefNameLabels({\n  model,\n}: {\n  model: LGV\n}) {\n  const { classes, cx } = useStyles()\n  const { staticBlocks, offsetPx, scalebarDisplayPrefix } = model\n  const [menuState, setMenuState] = useState<MenuState>()\n\n  useEffect(() => {\n    model.setIsScalebarRefNameMenuOpen(!!menuState)\n  }, [model, menuState])\n\n  // find the block that needs pinning to the left side for context\n  // default to first ContentBlock if nothing is scrolled left\n  let lastLeftBlock = staticBlocks.blocks.findIndex(\n    b => b.type === 'ContentBlock',\n  )\n  if (lastLeftBlock < 0) {\n    lastLeftBlock = 0\n  }\n\n  // eslint-disable-next-line unicorn/no-array-for-each\n  staticBlocks.forEach((block, i) => {\n    if (block.type === 'ContentBlock' && block.offsetPx - offsetPx < 0) {\n      lastLeftBlock = i\n    }\n  })\n  const val = scalebarDisplayPrefix()\n  const b0 = staticBlocks.blocks[0]\n\n  // Calculate the end position (in pixels) of each displayed region\n  const regionEndPx = new Map<number, number>()\n  for (const block of staticBlocks.blocks) {\n    if (block.type === 'ContentBlock' && block.regionNumber !== undefined) {\n      const endPx = block.offsetPx + block.widthPx\n      const current = regionEndPx.get(block.regionNumber)\n      if (current === undefined || endPx > current) {\n        regionEndPx.set(block.regionNumber, endPx)\n      }\n    }\n  }\n\n  return (\n    <>\n      {b0?.type !== 'ContentBlock' && val ? (\n        <span className={cx(classes.b0, classes.refLabel)}>{val}</span>\n      ) : null}\n      {staticBlocks.map((block, index) => {\n        const {\n          offsetPx: blockOffsetPx,\n          isLeftEndOfDisplayedRegion,\n          key,\n          type,\n          refName,\n          regionNumber,\n        } = block\n        const last = index === lastLeftBlock\n        // Calculate max width to clip label at the displayed region boundary\n        const regEndPx =\n          regionNumber !== undefined ? regionEndPx.get(regionNumber) : undefined\n        const labelStartPx = last ? offsetPx : blockOffsetPx\n        const maxWidth =\n          regEndPx !== undefined ? regEndPx - labelStartPx - 2 : undefined\n        // Don't render label if available width is too small (avoids overlap slivers)\n        const minLabelWidth = 20\n        const hasEnoughSpace =\n          maxWidth === undefined || maxWidth >= minLabelWidth\n        return type === 'ContentBlock' &&\n          (isLeftEndOfDisplayedRegion || last) &&\n          hasEnoughSpace ? (\n          <span\n            key={`refLabel-${key}-${index}`}\n            style={{\n              left: last\n                ? 'max(0px, calc(-1 * var(--offset-px)))'\n                : `calc(${blockOffsetPx}px - var(--offset-px) - 1px)`,\n              paddingLeft: last ? 0 : 1,\n              maxWidth:\n                maxWidth !== undefined && maxWidth > 0 ? maxWidth : undefined,\n            }}\n            className={classes.refLabel}\n            data-testid={`refLabel-${refName}`}\n            onMouseDown={() => {\n              model.setScalebarRefNameClickPending(true)\n            }}\n            onClick={event => {\n              model.setScalebarRefNameClickPending(false)\n              setMenuState({\n                anchorEl: event.currentTarget,\n                refName,\n                regionNumber: regionNumber!,\n              })\n            }}\n          >\n            {last && val ? `${val}:` : ''}\n            {refName}\n          </span>\n        ) : null\n      })}\n      {menuState ? (\n        <RefNameMenu\n          model={model}\n          menuState={menuState}\n          onClose={() => {\n            setMenuState(undefined)\n          }}\n        />\n      ) : null}\n    </>\n  )\n})\n\nfunction RefNameMenu({\n  model,\n  menuState,\n  onClose,\n}: {\n  model: LGV\n  menuState: MenuState\n  onClose: () => void\n}) {\n  const { displayedRegions } = model\n  const { refName, regionNumber } = menuState\n  const numRegions = displayedRegions.length\n\n  function moveRegion(fromIndex: number, toIndex: number) {\n    const regions = [...displayedRegions]\n    const [removed] = regions.splice(fromIndex, 1)\n    regions.splice(toIndex, 0, removed!)\n    model.setDisplayedRegions(regions)\n  }\n\n  function removeRegion(index: number) {\n    const regions = displayedRegions.filter((_, i) => i !== index)\n    model.setDisplayedRegions(regions)\n  }\n\n  const actionItems = [\n    ...(regionNumber > 0\n      ? [\n          {\n            label: 'Move left',\n            onClick: () => {\n              moveRegion(regionNumber, regionNumber - 1)\n            },\n          },\n        ]\n      : []),\n    ...(regionNumber < numRegions - 1\n      ? [\n          {\n            label: 'Move right',\n            onClick: () => {\n              moveRegion(regionNumber, regionNumber + 1)\n            },\n          },\n        ]\n      : []),\n    ...(numRegions > 2 && regionNumber > 0\n      ? [\n          {\n            label: 'Move to far left',\n            onClick: () => {\n              moveRegion(regionNumber, 0)\n            },\n          },\n        ]\n      : []),\n    ...(numRegions > 2 && regionNumber < numRegions - 1\n      ? [\n          {\n            label: 'Move to far right',\n            onClick: () => {\n              moveRegion(regionNumber, numRegions - 1)\n            },\n          },\n        ]\n      : []),\n    {\n      label: 'Remove this region from view',\n      onClick: () => {\n        removeRegion(regionNumber)\n      },\n    },\n  ]\n\n  return (\n    <Menu\n      anchorEl={menuState.anchorEl}\n      open\n      onClose={onClose}\n      onMenuItemClick={(_, callback) => {\n        callback()\n        onClose()\n      }}\n      menuItems={[\n        {\n          label: `Focus on ${refName}`,\n          onClick: () => {\n            model.navTo({ refName })\n          },\n        },\n        ...(numRegions > 1\n          ? [\n              {\n                label: 'Actions',\n                subMenu: actionItems,\n              },\n            ]\n          : []),\n      ]}\n    />\n  )\n}\n\nexport default ScalebarRefNameLabels\n","import type React from 'react'\n\nimport { cx, makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Paper } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport Gridlines from './Gridlines.tsx'\nimport ScalebarCoordinateLabels from './ScalebarCoordinateLabels.tsx'\nimport ScalebarRefNameLabels from './ScalebarRefNameLabels.tsx'\n\nimport type { LinearGenomeViewModel } from '..'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()({\n  container: {\n    overflow: 'hidden',\n    position: 'relative',\n  },\n  zoomContainer: {\n    position: 'relative',\n  },\n  // Scalebar positioned using CSS calc() with --offset-px variable\n  // Uses translateX for smooth positioning (subpixel gaps less visible here)\n  scalebar: {\n    position: 'absolute',\n    display: 'flex',\n    pointerEvents: 'none',\n  },\n})\n\ninterface ScalebarProps {\n  model: LGV\n  style?: React.CSSProperties\n  className?: string\n}\n\nconst Scalebar = observer(function Scalebar({\n  model,\n  style,\n  className,\n  ...other\n}: ScalebarProps) {\n  const { classes } = useStyles()\n  const { scaleFactor, staticBlocks, offsetPx } = model\n\n  return (\n    <Paper\n      data-resizer=\"true\" // used to avoid click-and-drag scrolls on trackscontainer\n      className={cx(classes.container, className)}\n      variant=\"outlined\"\n      style={\n        { ...style, '--offset-px': `${offsetPx}px` } as React.CSSProperties\n      }\n      {...other}\n    >\n      {/* offset 1px for left track border */}\n      <Gridlines model={model} offset={1} />\n      <div\n        className={classes.zoomContainer}\n        style={{\n          transform: scaleFactor !== 1 ? `scaleX(${scaleFactor})` : undefined,\n        }}\n      >\n        <div\n          className={classes.scalebar}\n          style={{\n            transform: `translateX(calc(${staticBlocks.offsetPx}px - var(--offset-px) - 1px))`,\n            width: staticBlocks.totalWidthPx,\n          }}\n        >\n          <ScalebarCoordinateLabels model={model} />\n        </div>\n      </div>\n      <ScalebarRefNameLabels model={model} />\n    </Paper>\n  )\n})\n\nexport default Scalebar\n","import type React from 'react'\nimport { useEffect, useRef, useState } from 'react'\n\nimport type { LinearGenomeViewModel } from '..'\n\nexport function useSideScroll(model: LinearGenomeViewModel) {\n  const [mouseDragging, setMouseDragging] = useState(false)\n  // refs are to store these variables to avoid repeated rerenders associated\n  // with useState/setState\n  const scheduled = useRef(false)\n\n  const prevX = useRef<number>(0)\n\n  useEffect(() => {\n    let cleanup = () => {}\n\n    function globalMouseMove(event: MouseEvent) {\n      event.preventDefault()\n      const currX = event.clientX\n      const distance = currX - prevX.current\n      if (distance) {\n        // use rAF to make it so multiple event handlers aren't fired per-frame\n        // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n        if (!scheduled.current) {\n          scheduled.current = true\n          window.requestAnimationFrame(() => {\n            model.horizontalScroll(-distance)\n            scheduled.current = false\n            prevX.current = event.clientX\n          })\n        }\n      }\n    }\n\n    function globalMouseUp() {\n      prevX.current = 0\n      if (mouseDragging) {\n        setMouseDragging(false)\n      }\n    }\n\n    if (mouseDragging) {\n      window.addEventListener('mousemove', globalMouseMove, true)\n      window.addEventListener('mouseup', globalMouseUp, true)\n      cleanup = () => {\n        window.removeEventListener('mousemove', globalMouseMove, true)\n        window.removeEventListener('mouseup', globalMouseUp, true)\n      }\n    }\n    return cleanup\n  }, [model, mouseDragging])\n\n  function mouseDown(event: React.MouseEvent) {\n    if (event.shiftKey) {\n      return\n    }\n    // check if clicking a draggable element or a resize handle\n    const target = event.target as HTMLElement\n    if (target.draggable || target.dataset.resizer) {\n      return\n    }\n\n    // otherwise do click and drag scroll\n    if (event.button === 0) {\n      prevX.current = event.clientX\n      setMouseDragging(true)\n    }\n  }\n\n  // this local mouseup is used in addition to the global because sometimes\n  // the global add/remove are not called in time, resulting in issue #533\n  function mouseUp(event: React.MouseEvent) {\n    event.preventDefault()\n    setMouseDragging(false)\n  }\n  return { mouseDown, mouseUp }\n}\n","import type React from 'react'\nimport { useEffect, useRef } from 'react'\n\nimport { sum } from '@jbrowse/core/util'\n\ntype Timer = ReturnType<typeof setTimeout>\n\nexport function useWheelScroll(\n  ref: React.RefObject<HTMLDivElement | null>,\n  model: {\n    bpPerPx: number\n    zoomTo: (arg: number, arg2?: number) => void\n    setScaleFactor: (arg: number) => void\n    horizontalScroll: (arg: number) => void\n  },\n) {\n  const zoomDelta = useRef(0)\n  const scrollDelta = useRef(0)\n  const timeout = useRef<Timer>(null)\n  const rafId = useRef(0)\n  const scheduled = useRef(false)\n\n  useEffect(() => {\n    let samples = [] as number[]\n    const curr = ref.current\n\n    // if ctrl is held down, zoom in with y-scroll, else scroll horizontally\n    // with x-scroll\n    function onWheel(event: WheelEvent) {\n      if (event.ctrlKey) {\n        event.preventDefault()\n        // there is no way to truly detect this, but it attempts to dynamically\n        // toggle between normalization scheme depending on strength of deltaY,\n        // particular due to the fact that this code path is triggered for both\n        // normal ctrl+wheel scroll and pinch to zoom. for these two cases\n        // - true wheel scroll has larger deltaY\n        // - pinch-to-zoom has much smaller deltaY\n        // though there is variation depending on platform\n        samples.push(event.deltaY)\n        const averageDeltaY = Math.abs(sum(samples)) / samples.length\n        const normalizer =\n          averageDeltaY < 6\n            ? 25\n            : averageDeltaY > 30\n              ? averageDeltaY > 150\n                ? 500\n                : 150\n              : 75\n        zoomDelta.current += event.deltaY / normalizer\n        model.setScaleFactor(\n          zoomDelta.current < 0\n            ? 1 - zoomDelta.current\n            : 1 / (1 + zoomDelta.current),\n        )\n        if (timeout.current) {\n          clearTimeout(timeout.current)\n        }\n        timeout.current = setTimeout(() => {\n          model.setScaleFactor(1)\n          model.zoomTo(\n            zoomDelta.current > 0\n              ? model.bpPerPx * (1 + zoomDelta.current)\n              : model.bpPerPx / (1 - zoomDelta.current),\n            event.clientX - (curr?.getBoundingClientRect().left || 0),\n          )\n          zoomDelta.current = 0\n          samples = []\n        }, 300)\n      } else {\n        // this is needed to stop the event from triggering \"back button\n        // action\" on MacOSX etc.  but is a heuristic to avoid preventing the\n        // inner-track scroll behavior\n        if (Math.abs(event.deltaX) > Math.abs(2 * event.deltaY)) {\n          event.preventDefault()\n        }\n        scrollDelta.current += event.deltaX\n        if (!scheduled.current) {\n          // use rAF to make it so multiple event handlers aren't fired per-frame\n          // see https://calendar.perfplanet.com/2013/the-runtime-performance-checklist/\n          scheduled.current = true\n          rafId.current = window.requestAnimationFrame(() => {\n            model.horizontalScroll(scrollDelta.current)\n            scrollDelta.current = 0\n            scheduled.current = false\n          })\n        }\n      }\n    }\n    if (curr) {\n      curr.addEventListener('wheel', onWheel, { passive: false })\n      return () => {\n        curr.removeEventListener('wheel', onWheel)\n        if (timeout.current) {\n          clearTimeout(timeout.current)\n        }\n        if (rafId.current) {\n          cancelAnimationFrame(rafId.current)\n        }\n      }\n    }\n    return () => {}\n  }, [model, ref])\n}\n","import { Suspense, lazy, useRef } from 'react'\n\nimport { Menu } from '@jbrowse/core/ui'\nimport { getEnv } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport Gridlines from './Gridlines.tsx'\nimport Rubberband from './Rubberband.tsx'\nimport Scalebar from './Scalebar.tsx'\nimport VerticalGuide from './VerticalGuide.tsx'\nimport { SCALE_BAR_HEIGHT } from '../consts.ts'\nimport { useRangeSelect } from './useRangeSelect.ts'\nimport { useSideScroll } from './useSideScroll.ts'\nimport { useWheelScroll } from './useWheelScroll.ts'\n\nimport type { LinearGenomeViewModel } from '..'\n\nconst CenterLine = lazy(() => import('./CenterLine.tsx'))\nconst Highlight = lazy(() => import('./Highlight.tsx'))\nconst RubberbandSpan = lazy(() => import('./RubberbandSpan.tsx'))\n\nconst useStyles = makeStyles()({\n  // Main container for all tracks\n  // Sets --offset-px CSS variable so children can use calc() for positioning\n  // instead of each observing offsetPx and recalculating in JS\n  tracksContainer: {\n    position: 'relative',\n    contain: 'layout style',\n  },\n})\n\ntype LGV = LinearGenomeViewModel\n\nconst TracksContainer = observer(function TracksContainer({\n  children,\n  model,\n}: {\n  children: React.ReactNode\n  model: LGV\n}) {\n  const { classes } = useStyles()\n  const { pluginManager } = getEnv(model)\n  const { mouseDown: mouseDown1, mouseUp } = useSideScroll(model)\n  const {\n    stickyViewHeaders,\n    rubberbandTop,\n    showGridlines,\n    showCenterLine,\n    isScalebarRefNameMenuOpen,\n  } = model\n  const ref = useRef<HTMLDivElement>(null)\n  const {\n    guideX,\n    rubberbandOn,\n    leftBpOffset,\n    rightBpOffset,\n    numOfBpSelected,\n    width,\n    left,\n    anchorPosition,\n    open,\n    isClick,\n    clickBpOffset,\n    handleMenuItemClick,\n    handleClose,\n    mouseMove,\n    mouseDown: mouseDown2,\n  } = useRangeSelect(ref, model, true)\n  useWheelScroll(ref, model)\n\n  const additional = pluginManager.evaluateExtensionPoint(\n    'LinearGenomeView-TracksContainerComponent',\n    undefined,\n    { model },\n  ) as React.ReactNode\n\n  return (\n    <div\n      ref={ref}\n      data-testid=\"tracksContainer\"\n      className={classes.tracksContainer}\n      style={{ '--offset-px': `${model.offsetPx}px` } as React.CSSProperties}\n      onMouseDown={event => {\n        mouseDown1(event)\n        mouseDown2(event)\n      }}\n      onMouseMove={mouseMove}\n      onMouseUp={mouseUp}\n    >\n      {showGridlines ? <Gridlines model={model} /> : null}\n      <Suspense fallback={null}>\n        {showCenterLine ? <CenterLine model={model} /> : null}\n      </Suspense>\n      {guideX !== undefined && !isScalebarRefNameMenuOpen ? (\n        <VerticalGuide model={model} coordX={guideX} />\n      ) : rubberbandOn ? (\n        <Suspense fallback={null}>\n          <RubberbandSpan\n            leftBpOffset={leftBpOffset}\n            rightBpOffset={rightBpOffset}\n            numOfBpSelected={numOfBpSelected}\n            width={width}\n            left={left}\n            top={rubberbandTop}\n            sticky={stickyViewHeaders}\n          />\n        </Suspense>\n      ) : null}\n      {anchorPosition ? (\n        <Menu\n          anchorReference=\"anchorPosition\"\n          anchorPosition={{\n            left: anchorPosition.clientX,\n            top: anchorPosition.clientY,\n          }}\n          onMenuItemClick={handleMenuItemClick}\n          open={open}\n          onClose={handleClose}\n          menuItems={\n            isClick && clickBpOffset\n              ? model.rubberbandClickMenuItems(clickBpOffset)\n              : model.rubberBandMenuItems()\n          }\n        />\n      ) : null}\n\n      <Rubberband\n        model={model}\n        ControlComponent={\n          <Scalebar\n            model={model}\n            style={{\n              height: SCALE_BAR_HEIGHT,\n              boxSizing: 'border-box',\n            }}\n          />\n        }\n      />\n      <HighlightGroup model={model} />\n      {additional}\n      {children}\n    </div>\n  )\n})\n\nconst HighlightGroup = observer(function HighlightGroup({\n  model,\n}: {\n  model: LGV\n}) {\n  return model.highlight.length ? (\n    <Suspense fallback={null}>\n      {model.highlight.map((highlight, idx) => (\n        <Highlight\n          key={`${JSON.stringify(highlight)}-${idx}`}\n          model={model}\n          highlight={highlight}\n        />\n      ))}\n    </Suspense>\n  ) : null\n})\n\nexport default TracksContainer\n","import { Suspense, lazy, useEffect, useRef } from 'react'\n\nimport { VIEW_HEADER_HEIGHT } from '@jbrowse/core/ui'\nimport { getSession } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport Paper from '@mui/material/Paper'\nimport { observer } from 'mobx-react'\n\nimport TrackContainer from './TrackContainer.tsx'\nimport TracksContainer from './TracksContainer.tsx'\n\nimport type { LinearGenomeViewModel } from '..'\n\n// lazies\nconst NoTracksActiveButton = lazy(() => import('./NoTracksActiveButton.tsx'))\n\nconst useStyles = makeStyles()(theme => ({\n  header: {\n    background: theme.palette.background.paper,\n    top: VIEW_HEADER_HEIGHT,\n    zIndex: 850,\n  },\n  pinnedTracks: {\n    position: 'sticky',\n    zIndex: 3,\n  },\n  rel: {\n    position: 'relative',\n  },\n}))\n\nconst LinearGenomeViewContainer = observer(function LinearGenomeViewContainer({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const {\n    pinnedTracks,\n    stickyViewHeaders,\n    pinnedTracksTop,\n    tracks,\n    unpinnedTracks,\n  } = model\n  const { classes } = useStyles()\n  const session = getSession(model)\n  const ref = useRef<HTMLDivElement>(null)\n  const MiniControlsComponent = model.MiniControlsComponent()\n  const HeaderComponent = model.HeaderComponent()\n  useEffect(() => {\n    // sets the focused view id based on a click within the LGV;\n    // necessary for subviews to be focused properly\n    function handleSelectView(e: Event) {\n      if (e.target instanceof Element && ref.current?.contains(e.target)) {\n        session.setFocusedViewId?.(model.id)\n      }\n    }\n\n    document.addEventListener('mousedown', handleSelectView)\n    document.addEventListener('keydown', handleSelectView)\n    return () => {\n      document.removeEventListener('mousedown', handleSelectView)\n      document.removeEventListener('keydown', handleSelectView)\n    }\n  }, [session, model])\n\n  return (\n    <div\n      className={classes.rel}\n      ref={ref}\n      onMouseLeave={() => {\n        session.setHovered(undefined)\n      }}\n      onMouseMove={event => {\n        const c = ref.current\n        if (!c) {\n          return\n        }\n        const { tracks } = model\n        const leftPx = event.clientX - c.getBoundingClientRect().left\n        const hoverPosition = model.pxToBp(leftPx)\n        const hoverFeature = tracks.find(t => t.displays[0].featureUnderMouse)\n        session.setHovered({ hoverPosition, hoverFeature })\n      }}\n    >\n      <div\n        className={classes.header}\n        style={{ position: stickyViewHeaders ? 'sticky' : undefined }}\n      >\n        <HeaderComponent model={model} />\n        <MiniControlsComponent model={model} />\n      </div>\n      <TracksContainer model={model}>\n        {!tracks.length ? (\n          <Suspense fallback={null}>\n            <NoTracksActiveButton model={model} />\n          </Suspense>\n        ) : (\n          <>\n            {pinnedTracks.length ? (\n              <Paper\n                elevation={6}\n                className={classes.pinnedTracks}\n                style={{ top: pinnedTracksTop }}\n              >\n                {pinnedTracks.map(track => (\n                  <TrackContainer key={track.id} model={model} track={track} />\n                ))}\n              </Paper>\n            ) : null}\n            {unpinnedTracks.map(track => (\n              <TrackContainer key={track.id} model={model} track={track} />\n            ))}\n          </>\n        )}\n      </TracksContainer>\n    </div>\n  )\n})\n\nexport default LinearGenomeViewContainer\n","import { lazy } from 'react'\n\nimport { LoadingEllipses } from '@jbrowse/core/ui'\nimport { observer } from 'mobx-react'\n\nimport LinearGenomeViewContainer from './LinearGenomeViewContainer.tsx'\n\nimport type { LinearGenomeViewModel } from '..'\n\n// lazies\nconst ImportForm = lazy(() => import('./ImportForm.tsx'))\n\nconst LinearGenomeView = observer(function LinearGenomeView({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { showLoading, showImportForm, loadingMessage } = model\n\n  if (showLoading) {\n    return <LoadingEllipses variant=\"h6\" message={loadingMessage} />\n  } else if (showImportForm) {\n    return <ImportForm model={model} />\n  } else {\n    return <LinearGenomeViewContainer model={model} />\n  }\n})\n\nexport default LinearGenomeView\n","import { firstValueFrom } from 'rxjs'\nimport { reduce } from 'rxjs/operators'\n\nimport type { Feature } from './simpleFeature.ts'\nimport type { NoAssemblyRegion } from './types/index.ts'\nimport type { Observable } from 'rxjs'\n\nexport interface UnrectifiedQuantitativeStats {\n  scoreMin: number\n  scoreMax: number\n  scoreSum: number\n  scoreSumSquares: number\n  featureCount: number\n  basesCovered: number\n}\n\n// What adapters return (without view-specific context)\nexport interface RectifiedQuantitativeStats extends UnrectifiedQuantitativeStats {\n  featureDensity: number\n  scoreMean: number\n  scoreStdDev: number\n}\n\n// Full type with view context (what display models use)\nexport interface QuantitativeStats extends RectifiedQuantitativeStats {\n  currStatsBpPerPx: number\n}\n\n/**\n * calculate standard deviation using the 'shortcut method' that accepts\n * the sum and the sum squares of the elements\n *\n * @param sum - sum(i, 1..n)\n * @param sumSquares - sum(i^2, 1..n)\n * @param n - number of elements\n * @param population - boolean: use population instead of sample correction\n * @returns - the estimated std deviation\n */\nexport function calcStdFromSums(\n  sum: number,\n  sumSquares: number,\n  n: number,\n  population = false,\n): number {\n  if (n === 0) {\n    return 0\n  }\n  let variance: number\n  if (population) {\n    variance = sumSquares / n - (sum * sum) / (n * n)\n  } else {\n    // sample correction is n-1\n    variance = sumSquares - (sum * sum) / n\n    if (n > 1) {\n      variance /= n - 1\n    }\n  }\n\n  return variance < 0 ? 0 : Math.sqrt(variance)\n}\n\n/**\n * @param stats - a summary stats object with scoreSum, featureCount,\n * scoreSumSquares, and basesCovered\n * @returns - a summary stats object with\n * scoreMean, scoreStdDev, and featureDensity added\n */\nexport function rectifyStats(\n  s: UnrectifiedQuantitativeStats,\n): RectifiedQuantitativeStats {\n  return {\n    ...s,\n    scoreMean: (s.scoreSum || 0) / (s.featureCount || s.basesCovered || 1),\n    scoreStdDev: calcStdFromSums(\n      s.scoreSum,\n      s.scoreSumSquares,\n      s.featureCount || s.basesCovered,\n    ),\n    featureDensity: (s.featureCount || 1) / s.basesCovered,\n  }\n}\n\n/**\n * transform a list of scores to summary statistics\n *\n * @param region - object with start, end\n * @param features - array of features which are possibly summary features\n * @returns - object with scoreMax, scoreMin, scoreSum, scoreSumSquares, etc\n */\nexport async function scoresToStats(\n  region: NoAssemblyRegion,\n  feats: Observable<Feature>,\n) {\n  const { start, end } = region\n  const seed = {\n    scoreMin: Number.MAX_VALUE,\n    scoreMax: Number.MIN_VALUE,\n    scoreSum: 0,\n    scoreSumSquares: 0,\n    featureCount: 0,\n  }\n  let found = false\n\n  const { scoreMin, scoreMax, scoreSum, scoreSumSquares, featureCount } =\n    await firstValueFrom(\n      feats.pipe(\n        reduce((acc, f) => {\n          const s = f.get('score')\n          const summary = f.get('summary')\n          const { scoreMax, scoreMin } = acc\n          acc.scoreMax = Math.max(scoreMax, summary ? f.get('maxScore') : s)\n          acc.scoreMin = Math.min(scoreMin, summary ? f.get('minScore') : s)\n          acc.scoreSum += s\n          acc.scoreSumSquares += s * s\n          acc.featureCount += 1\n          found = true\n\n          return acc\n        }, seed),\n      ),\n    )\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  return found\n    ? rectifyStats({\n        scoreMax,\n        scoreMin,\n        scoreSum,\n        scoreSumSquares,\n        featureCount,\n        basesCovered: end - start + 1,\n      })\n    : blankStats()\n}\n\nexport function blankStats(): RectifiedQuantitativeStats {\n  return {\n    scoreMin: 0,\n    scoreMax: 0,\n    scoreMean: 0,\n    scoreStdDev: 0,\n    scoreSum: 0,\n    scoreSumSquares: 0,\n    featureCount: 0,\n    featureDensity: 0,\n    basesCovered: 0,\n  }\n}\n","import { ConfigurationSchema } from '../../configuration/index.ts'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config BaseConnection\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BaseConnectionConfig = ConfigurationSchema(\n  'BaseConnection',\n  {\n    /**\n     * #slot\n     */\n    name: {\n      type: 'string',\n      defaultValue: 'nameOfConnection',\n      description: 'a unique name for this connection',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'optional list of names of assemblies in this connection',\n    },\n  },\n  {\n    explicitlyTyped: true,\n    /**\n     * #identifier\n     */\n    explicitIdentifier: 'connectionId',\n  },\n)\n\nexport default BaseConnectionConfig\nexport type BaseConnectionConfigSchema = typeof BaseConnectionConfig\nexport type BaseConnectionConfigModel = Instance<BaseConnectionConfigSchema>\n","import { scaleLog } from '@mui/x-charts-vendor/d3-scale'\n\nimport type { ComputedChain } from './drawFeatsCommon.ts'\n\n// Padding at top/bottom of cloud display\nexport const CLOUD_HEIGHT_PADDING = 20\n\n// Default max distance when all chains are singletons\nconst DEFAULT_MAX_DISTANCE = 1000\n\nexport interface CloudTicks {\n  ticks: { value: number; y: number }[]\n  height: number\n  minDistance: number\n  maxDistance: number\n}\n\n/**\n * Create a d3 log scale for cloud mode y-positioning\n * Used consistently for both read positions and tick marks\n */\nexport function createCloudScale(\n  minDistance: number,\n  maxDistance: number,\n  height: number,\n) {\n  return scaleLog()\n    .base(2)\n    .domain([Math.max(1, minDistance), Math.max(2, maxDistance)])\n    .range([0, height - CLOUD_HEIGHT_PADDING])\n    .clamp(true)\n}\n\n/**\n * Calculate tick marks for the cloud mode y-axis scalebar\n * Uses d3 scaleLog for nice tick generation (similar to LinearWiggleDisplay)\n */\nexport function calculateCloudTicks(\n  domain: [number, number],\n  height: number,\n): CloudTicks {\n  const [minDistance, maxDistance] = domain\n  const scale = createCloudScale(minDistance, maxDistance, height)\n\n  const tickValues = scale.ticks(6)\n  const ticks = tickValues.map(value => ({\n    value,\n    y: scale(value),\n  }))\n\n  return { ticks, height, minDistance, maxDistance }\n}\n\n/**\n * Calculate Y-offsets using logarithmic scaling for cloud mode\n * @param computedChains - Pre-computed chain data with distances\n * @param height - Canvas height\n * @param cloudDomain - Optional [min, max] domain. If provided, use it; otherwise compute from data\n */\nexport function calculateCloudYOffsetsUtil(\n  computedChains: ComputedChain[],\n  height: number,\n  cloudDomain?: [number, number],\n) {\n  // Calculate Y-offsets for each chain using the d3 scale\n  const chainYOffsets = new Map<string, number>()\n\n  // If cloudDomain is provided, use it directly\n  if (cloudDomain) {\n    const [, maxDistance] = cloudDomain\n    const scale = createCloudScale(1, maxDistance, height)\n\n    for (const { id, distance } of computedChains) {\n      const top = distance > 0 ? scale(distance) : 0\n      chainYOffsets.set(id, top)\n    }\n\n    return {\n      chainYOffsets,\n      cloudMaxDistance: maxDistance,\n    }\n  }\n\n  // Otherwise, compute maxDistance from data\n  let maxDistance = Number.MIN_VALUE\n\n  for (const { distance } of computedChains) {\n    if (distance > 0) {\n      maxDistance = Math.max(maxDistance, distance)\n    }\n  }\n\n  // If all chains are singletons, use default max distance\n  if (maxDistance === Number.MIN_VALUE) {\n    maxDistance = DEFAULT_MAX_DISTANCE\n  }\n\n  const scale = createCloudScale(1, maxDistance, height)\n\n  for (const { id, distance } of computedChains) {\n    const top = distance > 0 ? scale(distance) : 0\n    chainYOffsets.set(id, top)\n  }\n\n  return {\n    chainYOffsets,\n    cloudMaxDistance: maxDistance,\n  }\n}\n","const category10 = [\n  '#1f77b4',\n  '#ff7f0e',\n  '#2ca02c',\n  '#d62728',\n  '#9467bd',\n  '#8c564b',\n  '#e377c2',\n  '#7f7f7f',\n  '#bcbd22',\n  '#17becf',\n]\nconst dark2 = [\n  '#1b9e77',\n  '#d95f02',\n  '#7570b3',\n  '#e7298a',\n  '#66a61e',\n  '#e6ab02',\n  '#a6761d',\n  '#666666',\n]\nconst set1 = [\n  '#377eb8',\n  '#e41a1c',\n  '#4daf4a',\n  '#984ea3',\n  '#ff7f00',\n  '#ffff33',\n  '#a65628',\n  '#f781bf',\n  '#999999',\n]\nconst set2 = [\n  '#66c2a5',\n  '#fc8d62',\n  '#8da0cb',\n  '#e78ac3',\n  '#a6d854',\n  '#ffd92f',\n  '#e5c494',\n  '#b3b3b3',\n]\nconst tableau10 = [\n  '#4e79a7',\n  '#f28e2c',\n  '#e15759',\n  '#76b7b2',\n  '#59a14f',\n  '#edc949',\n  '#af7aa1',\n  '#ff9da7',\n  '#9c755f',\n  '#bab0ab',\n]\n\nconst ggplot2Colors6 = [\n  '#F8766D',\n  '#B79F00',\n  '#00BA38',\n  '#00BFC4',\n  '#619CFF',\n  '#F564E3',\n]\n\nconst ggplot2Colors5 = ['#F8766D', '#A3A500', '#00BF7D', '#00B0F6', '#E76BF3']\nconst ggplot2Colors4 = ['#F8766D', '#7CAE00', '#00BFC4', '#C77CFF']\nconst ggplot2Colors3 = ['#F8766D', '#00BA38', '#619CFF']\n\nexport {\n  category10,\n  dark2,\n  ggplot2Colors3,\n  ggplot2Colors4,\n  ggplot2Colors5,\n  ggplot2Colors6,\n  set1,\n  set2,\n  tableau10,\n}\n","// not a sanitizer, this just removes html tags for use in measureText-based\n// element width calculations\nexport function coarseStripHTML(s: string) {\n  let result = ''\n  let inTag = false\n\n  for (let i = 0, l = s.length; i < l; i++) {\n    const char = s[i]!\n    if (char === '<') {\n      inTag = true\n    } else if (char === '>') {\n      inTag = false\n    } else if (!inTag) {\n      result += char\n    }\n  }\n\n  return result\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { AnyReactComponentType } from '../util/index.ts'\nimport type { IAnyModelType } from '@jbrowse/mobx-state-tree'\n\nexport default class ConnectionType extends PluggableElementBase {\n  stateModel: IAnyModelType\n\n  configSchema: AnyConfigurationSchemaType\n\n  description: string\n\n  url: string\n\n  configEditorComponent?: AnyReactComponentType\n\n  constructor(stuff: {\n    name: string\n    stateModel: IAnyModelType\n    configSchema: AnyConfigurationSchemaType\n    displayName: string\n    description: string\n    configEditorComponent?: AnyReactComponentType\n    url: string\n  }) {\n    super(stuff)\n    this.stateModel = stuff.stateModel\n    this.configSchema = stuff.configSchema\n    this.description = stuff.description\n    this.url = stuff.url\n    this.configEditorComponent = stuff.configEditorComponent\n  }\n}\n","import { DialogContent } from '@mui/material'\n\nimport Dialog from './Dialog.tsx'\n\nexport default function CascadingMenuHelpDialog({\n  onClose,\n  helpText,\n  label,\n}: {\n  onClose: (event: React.MouseEvent | React.KeyboardEvent) => void\n  helpText: React.ReactNode\n  label?: React.ReactNode\n}) {\n  return (\n    <Dialog\n      open\n      onClose={onClose}\n      title=\"Help\"\n      titleNode={label ? <>Help: {label}</> : undefined}\n      onClick={e => {\n        e.stopPropagation()\n      }}\n      onMouseDown={e => {\n        e.stopPropagation()\n      }}\n    >\n      <DialogContent>{helpText}</DialogContent>\n    </Dialog>\n  )\n}\n","import type React from 'react'\nimport { Suspense, useState } from 'react'\n\nimport HelpOutline from '@mui/icons-material/HelpOutline'\nimport { IconButton } from '@mui/material'\n\nimport CascadingMenuHelpDialog from './CascadingMenuHelpDialog.tsx'\n\nexport default function CascadingMenuHelpIconButton({\n  helpText,\n  label,\n}: {\n  helpText: string\n  label?: React.ReactNode\n}) {\n  const [helpDialogOpen, setHelpDialogOpen] = useState(false)\n\n  return (\n    <>\n      <IconButton\n        size=\"small\"\n        onClick={event => {\n          event.stopPropagation()\n          setHelpDialogOpen(true)\n        }}\n        style={{ marginLeft: 4, padding: 4 }}\n      >\n        <HelpOutline fontSize=\"small\" />\n      </IconButton>\n      {helpDialogOpen ? (\n        <Suspense fallback={null}>\n          <CascadingMenuHelpDialog\n            helpText={helpText}\n            label={label}\n            onClose={event => {\n              event.stopPropagation()\n              setHelpDialogOpen(false)\n            }}\n          />{' '}\n        </Suspense>\n      ) : null}\n    </>\n  )\n}\n","//  this code adapted from material-ui-popup-state by Andy Edwards, MIT license\n//  https://github.com/jcoreio/material-ui-popup-state/blob/9dba66241a0c25b172c93ae7d9e45a9745f138e8/LICENSE.md\n\nimport * as React from 'react'\n\nimport { Menu } from '@mui/material'\n\nimport type { MenuProps } from '@mui/material'\n\nconst HoverMenu = React.forwardRef<HTMLDivElement, MenuProps>(\n  function HoverMenu(props, ref) {\n    return (\n      <Menu\n        {...props}\n        ref={ref}\n        style={{\n          pointerEvents: 'none',\n          ...props.style,\n        }}\n        slotProps={{\n          ...props.slotProps,\n          paper: {\n            style: { pointerEvents: 'auto' },\n          },\n        }}\n      />\n    )\n  },\n)\n\nexport default HoverMenu\n","import ArrowRightIcon from '@mui/icons-material/ArrowRight'\nimport CheckBoxIcon from '@mui/icons-material/CheckBox'\nimport CheckBoxOutlineBlankIcon from '@mui/icons-material/CheckBoxOutlineBlank'\nimport RadioButtonCheckedIcon from '@mui/icons-material/RadioButtonChecked'\nimport RadioButtonUncheckedIcon from '@mui/icons-material/RadioButtonUnchecked'\nimport {\n  CircularProgress,\n  ListItemIcon,\n  ListItemText,\n  MenuItem,\n} from '@mui/material'\n\nimport { makeStyles } from '../util/tss-react/index.ts'\n\nconst useStyles = makeStyles()({\n  menuItemEndDecoration: {\n    padding: 0,\n    margin: 0,\n    height: 16,\n  },\n})\n\ninterface MenuItemEndDecorationSubMenuProps {\n  type: 'subMenu'\n}\n\ninterface MenuItemEndDecorationSelectorProps {\n  type: 'checkbox' | 'radio'\n  checked: boolean\n  disabled?: boolean\n}\n\ntype MenuItemEndDecorationProps =\n  | MenuItemEndDecorationSubMenuProps\n  | MenuItemEndDecorationSelectorProps\n\nexport function MenuItemEndDecoration(props: MenuItemEndDecorationProps) {\n  const { classes } = useStyles()\n  const { type } = props\n  let checked: boolean | undefined\n  let disabled: boolean | undefined\n  if ('checked' in props) {\n    ;({ checked, disabled } = props)\n  }\n  let icon: React.ReactElement\n  switch (type) {\n    case 'subMenu': {\n      icon = <ArrowRightIcon color=\"action\" />\n      break\n    }\n    case 'checkbox': {\n      if (checked) {\n        const color = disabled ? 'inherit' : undefined\n        icon = <CheckBoxIcon color={color} />\n      } else {\n        icon = <CheckBoxOutlineBlankIcon color=\"action\" />\n      }\n      break\n    }\n    case 'radio': {\n      if (checked) {\n        const color = disabled ? 'inherit' : undefined\n        icon = <RadioButtonCheckedIcon color={color} />\n      } else {\n        icon = <RadioButtonUncheckedIcon color=\"action\" />\n      }\n      break\n    }\n  }\n  return <div className={classes.menuItemEndDecoration}>{icon}</div>\n}\n\nexport function LoadingMenuItem() {\n  return (\n    <MenuItem disabled>\n      <ListItemIcon>\n        <CircularProgress size={20} />\n      </ListItemIcon>\n      <ListItemText primary=\"Loading...\" />\n    </MenuItem>\n  )\n}\n\nexport function ErrorMenuItem({ error }: { error: unknown }) {\n  return (\n    <MenuItem disabled>\n      <ListItemText\n        primary=\"Error loading menu\"\n        secondary={error instanceof Error ? error.message : String(error)}\n      />\n    </MenuItem>\n  )\n}\n","/* eslint-disable @typescript-eslint/no-unsafe-function-type */\nimport { useState } from 'react'\n\nimport ChevronRight from '@mui/icons-material/ChevronRight'\nimport {\n  Divider,\n  ListItemIcon,\n  ListItemText,\n  ListSubheader,\n  Menu,\n  MenuItem,\n} from '@mui/material'\n\nimport CascadingMenuHelpIconButton from './CascadingMenuHelpIconButton.tsx'\nimport HoverMenu from './HoverMenu.tsx'\nimport { MenuItemEndDecoration } from './MenuItems.tsx'\n\nimport type {\n  CheckboxMenuItem,\n  MenuItem as JBMenuItem,\n  MenuItemsGetter,\n  NormalMenuItem,\n  RadioMenuItem,\n} from './MenuTypes.ts'\nimport type { SvgIconProps } from '@mui/material'\n\nexport type { MenuItemsGetter } from './MenuTypes.ts'\ntype ActionableMenuItem = NormalMenuItem | CheckboxMenuItem | RadioMenuItem\n\n// Helper to create a data-testid from a label\nfunction labelToTestId(label: React.ReactNode) {\n  if (typeof label === 'string') {\n    return label.toLowerCase().replace(/\\s+/g, '_')\n  }\n  return undefined\n}\n\nfunction CascadingSubmenu({\n  title,\n  Icon,\n  inset,\n  menuItems,\n  onMenuItemClick,\n  closeAfterItemClick,\n  onCloseRoot,\n  isOpen,\n  onOpen,\n  onClose,\n}: {\n  title: React.ReactNode\n  onMenuItemClick: Function\n  Icon: React.ComponentType<SvgIconProps> | undefined\n  inset: boolean\n  menuItems: JBMenuItem[]\n  closeAfterItemClick: boolean\n  onCloseRoot: () => void\n  isOpen: boolean\n  onOpen: () => void\n  onClose: () => void\n}) {\n  const [anchorEl, setAnchorEl] = useState<HTMLLIElement | null>(null)\n  const testId = labelToTestId(title)\n\n  return (\n    <>\n      <MenuItem\n        ref={setAnchorEl}\n        data-testid={testId ? `cascading-submenu-${testId}` : undefined}\n        onMouseOver={onOpen}\n        onFocus={onOpen}\n        onClick={onOpen}\n      >\n        {Icon ? (\n          <ListItemIcon>\n            <Icon />\n          </ListItemIcon>\n        ) : null}\n        <ListItemText primary={title} inset={inset} />\n        <ChevronRight />\n      </MenuItem>\n      <HoverMenu\n        open={isOpen}\n        anchorEl={anchorEl}\n        onClose={onClose}\n        anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\n        transformOrigin={{ vertical: 'top', horizontal: 'left' }}\n      >\n        <CascadingMenuList\n          closeAfterItemClick={closeAfterItemClick}\n          onMenuItemClick={onMenuItemClick}\n          menuItems={menuItems}\n          onCloseRoot={onCloseRoot}\n        />\n      </HoverMenu>\n    </>\n  )\n}\n\nfunction CascadingMenuList({\n  onMenuItemClick,\n  closeAfterItemClick,\n  menuItems,\n  onCloseRoot,\n}: {\n  menuItems: JBMenuItem[]\n  closeAfterItemClick: boolean\n  onMenuItemClick: Function\n  onCloseRoot: () => void\n}) {\n  const [openSubmenuIdx, setOpenSubmenuIdx] = useState<number | undefined>()\n  const closeSubmenu = () => {\n    setOpenSubmenuIdx(undefined)\n  }\n\n  const hasIcon = menuItems.some(m => 'icon' in m && m.icon)\n  const hasCheckboxOrRadioWithHelp = menuItems.some(\n    m =>\n      (m.type === 'checkbox' || m.type === 'radio') &&\n      'helpText' in m &&\n      m.helpText,\n  )\n\n  const sortedItems = menuItems.toSorted(\n    (a, b) => (b.priority || 0) - (a.priority || 0),\n  )\n\n  return (\n    <>\n      {sortedItems.map((item, idx) => {\n        if ('subMenu' in item) {\n          return (\n            <CascadingSubmenu\n              key={`subMenu-${item.label}-${idx}`}\n              title={item.label}\n              Icon={item.icon}\n              inset={hasIcon && !item.icon}\n              onMenuItemClick={onMenuItemClick}\n              menuItems={item.subMenu}\n              closeAfterItemClick={closeAfterItemClick}\n              onCloseRoot={onCloseRoot}\n              isOpen={openSubmenuIdx === idx}\n              onOpen={() => {\n                setOpenSubmenuIdx(idx)\n              }}\n              onClose={closeSubmenu}\n            />\n          )\n        }\n        if (item.type === 'divider') {\n          return <Divider key={`divider-${idx}`} component=\"li\" />\n        }\n        if (item.type === 'subHeader') {\n          return (\n            <ListSubheader key={`subHeader-${item.label}-${idx}`}>\n              {item.label}\n            </ListSubheader>\n          )\n        }\n\n        const actionItem = item as ActionableMenuItem\n        const helpText = actionItem.helpText\n        const isCheckOrRadio =\n          actionItem.type === 'checkbox' || actionItem.type === 'radio'\n        const itemTestId = labelToTestId(actionItem.label)\n\n        return (\n          <MenuItem\n            key={`${actionItem.label}-${idx}`}\n            data-testid={\n              itemTestId ? `cascading-menuitem-${itemTestId}` : undefined\n            }\n            disabled={Boolean(actionItem.disabled)}\n            onClick={event => {\n              if (closeAfterItemClick) {\n                onCloseRoot()\n              }\n              onMenuItemClick(event, actionItem.onClick)\n            }}\n            onMouseOver={closeSubmenu}\n          >\n            {actionItem.icon ? (\n              <ListItemIcon>\n                <actionItem.icon />\n              </ListItemIcon>\n            ) : null}\n            <ListItemText\n              primary={actionItem.label}\n              secondary={actionItem.subLabel}\n              inset={hasIcon && !actionItem.icon}\n            />\n            <div style={{ flexGrow: 1, minWidth: 10 }} />\n            {isCheckOrRadio ? (\n              <MenuItemEndDecoration\n                type={actionItem.type}\n                checked={actionItem.checked}\n                disabled={actionItem.disabled}\n              />\n            ) : null}\n            {helpText ? (\n              <CascadingMenuHelpIconButton\n                helpText={helpText}\n                label={actionItem.label}\n              />\n            ) : isCheckOrRadio && hasCheckboxOrRadioWithHelp ? (\n              <div\n                style={{ marginLeft: 4, padding: 4, width: 28, height: 28 }}\n              />\n            ) : null}\n          </MenuItem>\n        )\n      })}\n    </>\n  )\n}\n\nexport default function CascadingMenu({\n  onMenuItemClick,\n  closeAfterItemClick = true,\n  menuItems,\n  open,\n  onClose,\n  anchorEl,\n  anchorOrigin,\n  transformOrigin,\n  anchorReference,\n  anchorPosition,\n  slotProps,\n  marginThreshold,\n  style,\n}: {\n  onMenuItemClick: (event: unknown, callback: () => void) => void\n  closeAfterItemClick?: boolean\n  menuItems: MenuItemsGetter\n  open: boolean\n  onClose: () => void\n  anchorEl?: Element | null\n  anchorOrigin?: {\n    vertical: 'top' | 'center' | 'bottom'\n    horizontal: 'left' | 'center' | 'right'\n  }\n  transformOrigin?: {\n    vertical: 'top' | 'center' | 'bottom'\n    horizontal: 'left' | 'center' | 'right'\n  }\n  anchorReference?: 'anchorEl' | 'anchorPosition' | 'none'\n  anchorPosition?: { top: number; left: number }\n  slotProps?: { transition?: { onExit?: () => void } }\n  marginThreshold?: number | null\n  style?: React.CSSProperties\n}) {\n  const items = Array.isArray(menuItems) ? menuItems : menuItems()\n\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={open}\n      onClose={onClose}\n      anchorOrigin={anchorOrigin}\n      transformOrigin={transformOrigin}\n      anchorReference={anchorReference}\n      anchorPosition={anchorPosition}\n      slotProps={slotProps}\n      marginThreshold={marginThreshold ?? undefined}\n      style={style}\n    >\n      <CascadingMenuList\n        menuItems={items}\n        closeAfterItemClick={closeAfterItemClick}\n        onMenuItemClick={onMenuItemClick}\n        onCloseRoot={onClose}\n      />\n    </Menu>\n  )\n}\n","import { useEffect, useState } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { clamp, getSession } from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\n\nimport type { LayoutRecord } from './types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\ninterface Display {\n  height: number\n  scrollTop: number\n  SNPCoverageDisplay?: { height: number }\n  notReady?: () => boolean\n  searchFeatureByID?: (str: string) => LayoutRecord\n}\n\ninterface Track {\n  displays: Display[]\n  configuration: AnyConfigurationModel\n}\n\nconst [, TOP, , BOTTOM] = [0, 1, 2, 3] as const\n\nfunction cheight(chunk: LayoutRecord) {\n  return chunk[BOTTOM] - chunk[TOP]\n}\n\nexport function heightFromSpecificLevel(\n  views: LGV[],\n  trackId: string,\n  level: number,\n  getYPosOverride?: (trackId: string, level: number) => number,\n) {\n  return getYPosOverride\n    ? getYPosOverride(trackId, level)\n    : views[level]!.trackRefs[trackId]?.getBoundingClientRect().top || 0\n}\n\nexport function getPxFromCoordinate(view: LGV, refName: string, coord: number) {\n  return (view.bpToPx({ refName, coord })?.offsetPx || 0) - view.offsetPx\n}\n\n// gets the y-position of a layout record in a track\nexport function yPos(\n  trackId: string,\n  level: number,\n  views: LGV[],\n  tracks: Track[],\n  c: LayoutRecord,\n  getYPosOverride?: (trackId: string, level: number) => number,\n) {\n  const display = tracks[level]!.displays[0]!\n  const max = display.height\n  const offset = display.SNPCoverageDisplay?.height ?? 0\n  const scrollTop = getYPosOverride ? 0 : display.scrollTop\n  return (\n    clamp(c[TOP] - scrollTop + cheight(c) / 2 + offset, offset, max) +\n    heightFromSpecificLevel(views, trackId, level, getYPosOverride)\n  )\n}\n\n// forces a re-render on the next frame when the variable changes\nexport const useNextFrame = (variable: unknown) => {\n  const [, setNextFrameState] = useState<unknown>()\n  useEffect(() => {\n    setNextFrameState(variable)\n  }, [variable])\n}\n\n// https://stackoverflow.com/a/49186706/2129219 the array-intersection package\n// on npm has a large kb size, and we are just intersecting open track ids so\n// simple is better\nexport function intersect<T>(\n  cb: (l: T) => string,\n  a1: T[] = [],\n  a2: T[] = [],\n  ...rest: T[][]\n): T[] {\n  const ids = new Set(a2.map(elt => cb(elt)))\n  const a12 = a1.filter(value => ids.has(cb(value)))\n  return rest.length === 0 ? a12 : intersect(cb, a12, ...rest)\n}\n\nexport function calc(track: Track, f: Feature) {\n  return track.displays[0]!.searchFeatureByID?.(f.id())\n}\n\nexport async function getBlockFeatures(\n  model: { views: LinearGenomeViewModel[] },\n  track: Track,\n) {\n  const { views } = model\n  const { rpcManager } = getSession(model)\n  const sessionId = getRpcSessionId(track)\n\n  return Promise.all(\n    views.flatMap(\n      async view =>\n        (await rpcManager.call(sessionId, 'BreakpointGetFeatures', {\n          adapterConfig: getConf(track, ['adapter']),\n          sessionId,\n          regions: view.staticBlocks.contentBlocks,\n        })) as Feature[][],\n    ),\n  )\n}\n","import type { ComponentType, LazyExoticComponent } from 'react'\nimport type React from 'react'\n\nimport PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { IAnyModelType, IAnyStateTreeNode } from '@jbrowse/mobx-state-tree'\n\ntype WidgetComponentType = LazyExoticComponent<React.FC<any>> | React.FC<any>\n\ntype HeadingComponentType = ComponentType<{ model: IAnyStateTreeNode }>\n\nexport default class WidgetType extends PluggableElementBase {\n  heading?: string\n\n  configSchema: AnyConfigurationSchemaType\n\n  HeadingComponent?: HeadingComponentType\n\n  ReactComponent: WidgetComponentType\n\n  stateModel: IAnyModelType\n\n  helpText?: React.ReactNode\n\n  constructor(stuff: {\n    name: string\n    heading?: string\n    HeadingComponent?: HeadingComponentType\n    configSchema: AnyConfigurationSchemaType\n    stateModel: IAnyModelType\n    ReactComponent: WidgetComponentType\n    helpText?: React.ReactNode\n  }) {\n    super(stuff)\n    this.heading = stuff.heading\n    this.HeadingComponent = stuff.HeadingComponent\n    this.configSchema = stuff.configSchema\n    this.stateModel = stuff.stateModel\n    this.ReactComponent = stuff.ReactComponent\n    this.helpText = stuff.helpText\n  }\n}\n","import type { BaseLayout, SerializedLayout } from './BaseLayout.ts'\n\nexport default class MultiLayout<SUB_LAYOUT_CLASS extends BaseLayout<T>, T> {\n  subLayouts = new Map<string, SUB_LAYOUT_CLASS>()\n\n  /**\n   * layout class that just keeps a number of named sub-layouts.\n   * basically just a fancier\n   * `{ layout1: new GranularRectLayout(), layout2: new GranularRectLayout() ...}`\n   */\n  constructor(\n    public SubLayoutClass: new (...args: any[]) => SUB_LAYOUT_CLASS,\n    public subLayoutConstructorArgs: Record<string, any> = {},\n  ) {}\n\n  getDataByID(id: string): unknown {\n    for (const layout of this.subLayouts.values()) {\n      // @ts-expect-error\n      const r = layout.getDataByID(id)\n      if (r) {\n        return r\n      }\n    }\n    return undefined\n  }\n\n  getSublayout(layoutName: string): SUB_LAYOUT_CLASS {\n    let subLayout = this.subLayouts.get(layoutName)\n    if (subLayout === undefined) {\n      subLayout = new this.SubLayoutClass(this.subLayoutConstructorArgs)\n      this.subLayouts.set(layoutName, subLayout)\n      return subLayout\n    }\n\n    return subLayout\n  }\n\n  addRect(\n    layoutName: string,\n    id: string,\n    left: number,\n    right: number,\n    height: number,\n    data: Record<string, T> = {},\n    serializableData?: Record<string, T>,\n  ) {\n    return this.getSublayout(layoutName).addRect(\n      id,\n      left,\n      right,\n      height,\n      data,\n      serializableData,\n    )\n  }\n\n  discardRange(layoutName: string, left: number, right: number) {\n    return this.subLayouts.get(layoutName)?.discardRange(left, right)\n  }\n\n  toJSON() {\n    const data: Record<string, SerializedLayout> = {}\n    for (const [layoutName, sublayout] of this.subLayouts.entries()) {\n      data[layoutName] = sublayout.toJSON()\n    }\n    return data\n  }\n}\n","import { orientationTypes, pairMap } from '../util.ts'\n\nimport type { ChainStats } from './types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\n/**\n * Numeric codes for pair types\n * Used to classify paired-end reads without relying on color string comparisons\n */\nexport const PairType = {\n  /** Proper pair: correct orientation (LR) and normal insert size */\n  PROPER_PAIR: 0,\n  /** Long insert: same chromosome but insert size exceeds upper threshold */\n  LONG_INSERT: 1,\n  /** Short insert: same chromosome but insert size below lower threshold */\n  SHORT_INSERT: 2,\n  /** Inter-chromosome: mates on different chromosomes */\n  INTER_CHROM: 3,\n  /** Abnormal orientation: RR, RL, LL, etc. (not LR) */\n  ABNORMAL_ORIENTATION: 4,\n  /** Unmapped mate: mate is unmapped */\n  UNMAPPED_MATE: 5,\n} as const\n\nexport type PairTypeValue = (typeof PairType)[keyof typeof PairType]\n\nexport const fillColor = {\n  color_fwd_strand_not_proper: '#ECC8C8',\n  color_rev_strand_not_proper: '#BEBED8',\n  color_fwd_strand: '#EC8B8B',\n  color_rev_strand: '#8F8FD8',\n  color_fwd_missing_mate: '#D11919',\n  color_rev_missing_mate: '#1919D1',\n  color_fwd_diff_chr: '#000',\n  color_rev_diff_chr: '#969696',\n  color_pair_lr: 'lightgrey',\n  color_pair_rr: '#3a3a9d',\n  color_pair_rl: 'teal',\n  color_pair_ll: 'green',\n  color_nostrand: '#c8c8c8',\n  color_interchrom: 'purple',\n  color_longinsert: 'red',\n  color_shortinsert: 'pink',\n  color_unmapped_mate: '#8B4513',\n  color_unknown: 'grey',\n  // Long-read split alignment orientation colors\n  color_longread_rev_fwd: 'navy',\n  color_longread_fwd_rev: 'green',\n  color_longread_same: 'grey',\n  // Supplementary/split alignment color (light orange)\n  color_supplementary: '#f0b878',\n}\n\n// manually calculated by running\n// const color = require('color')\n// Object.fromEntries(Object.entries(fillColor).map(([key,val])=>{\n//   return [key, color(val).darken('0.3').hex()]\n// }))\n// this avoids (expensive) use of Color module at runtime\nexport const strokeColor = {\n  color_fwd_strand_not_proper: '#CA6767',\n  color_rev_strand_not_proper: '#7272AA',\n  color_fwd_strand: '#DC2A2A',\n  color_rev_strand: '#4141BA',\n  color_fwd_missing_mate: '#921111',\n  color_rev_missing_mate: '#111192',\n  color_fwd_diff_chr: '#000000',\n  color_rev_diff_chr: '#696969',\n  color_pair_lr: '#8C8C8C',\n  color_pair_rr: '#00002A',\n  color_pair_rl: '#005A5A',\n  color_pair_ll: '#005A00',\n  color_nostrand: '#8C8C8C',\n  color_interchrom: '#5A005A',\n  color_longinsert: '#B30000',\n  color_shortinsert: '#FF3A5C',\n  color_unmapped_mate: '#5D2E0D',\n  color_unknown: '#444',\n  // Long-read split alignment orientation stroke colors\n  color_longread_rev_fwd: '#00004D',\n  color_longread_fwd_rev: '#005A00',\n  color_longread_same: '#444',\n  // Supplementary/split alignment stroke color\n  color_supplementary: '#c88030',\n}\n\nconst defaultColor = [\n  fillColor.color_pair_lr,\n  strokeColor.color_pair_lr,\n] as const\n\n/**\n * Get the pair type classification for a paired-end read\n * Used internally by color functions and externally for filtering logic\n *\n * @param type - Color scheme type (insertSizeAndOrientation, orientation, insertSize)\n * @param f - Feature with pair_orientation, tlen, flags, refName, and next_ref\n * @param stats - Optional statistics for insert size thresholds\n * @returns Numeric code representing the pair type\n */\nexport function getPairedType({\n  type,\n  f,\n  stats,\n}: {\n  type: string\n  f: {\n    refName: string\n    next_ref?: string\n    pair_orientation?: string\n    tlen?: number\n    flags?: number\n  }\n  stats?: ChainStats\n}): PairTypeValue {\n  // Check for unmapped mate first (highest priority)\n  if (f.flags !== undefined && f.flags & 8) {\n    return PairType.UNMAPPED_MATE\n  }\n\n  // Check orientation first (if applicable)\n  if (type === 'insertSizeAndOrientation' || type === 'orientation') {\n    const orientationType = orientationTypes.fr\n    const r = orientationType[f.pair_orientation || ''] as\n      | keyof typeof pairMap\n      | undefined\n    // If orientation is not LR (proper), it's abnormal\n    if (r && r !== 'LR') {\n      return PairType.ABNORMAL_ORIENTATION\n    }\n  }\n\n  // Check insert size (if applicable)\n  if (type === 'insertSizeAndOrientation' || type === 'insertSize') {\n    const sameRef = f.refName === f.next_ref\n    const tlen = Math.abs(f.tlen || 0)\n\n    if (!sameRef) {\n      return PairType.INTER_CHROM\n    }\n\n    if (stats) {\n      if (tlen > stats.upper) {\n        return PairType.LONG_INSERT\n      }\n      if (tlen < stats.lower) {\n        return PairType.SHORT_INSERT\n      }\n    }\n  }\n\n  // If all checks pass, it's a proper pair\n  return PairType.PROPER_PAIR\n}\n\n/**\n * Get color for a paired-end read based on insert size only\n * Uses getPairedType() internally to determine classification\n */\nexport function getPairedInsertSizeColor(\n  f: { refName: string; next_ref?: string; tlen?: number; flags?: number },\n  stats?: ChainStats,\n) {\n  const pairType = getPairedType({\n    type: 'insertSize',\n    f,\n    stats,\n  })\n\n  switch (pairType) {\n    case PairType.UNMAPPED_MATE:\n      return [\n        fillColor.color_unmapped_mate,\n        strokeColor.color_unmapped_mate,\n      ] as const\n    case PairType.LONG_INSERT:\n      return [fillColor.color_longinsert, strokeColor.color_longinsert] as const\n    case PairType.SHORT_INSERT:\n      return [\n        fillColor.color_shortinsert,\n        strokeColor.color_shortinsert,\n      ] as const\n    case PairType.INTER_CHROM:\n      return [fillColor.color_interchrom, strokeColor.color_interchrom] as const\n    case PairType.PROPER_PAIR:\n      return undefined\n    default:\n      return undefined\n  }\n}\n\n/**\n * Get color for a paired-end read based on orientation only\n * Returns undefined for proper pairs (LR orientation)\n */\nexport function getPairedOrientationColorOrDefault(f: {\n  pair_orientation?: string\n  flags?: number\n}) {\n  // Check for unmapped mate first\n  if (f.flags !== undefined && f.flags & 8) {\n    return [\n      fillColor.color_unmapped_mate,\n      strokeColor.color_unmapped_mate,\n    ] as const\n  }\n\n  const type = orientationTypes.fr\n  const r = type[f.pair_orientation || ''] as keyof typeof pairMap | undefined\n  // Return undefined if orientation is LR (proper) or unrecognized\n  // This allows fallthrough to insert size checks (e.g., inter-chromosomal)\n  if (!r || r === 'LR') {\n    return undefined\n  }\n  const type2 = pairMap[r] as keyof typeof fillColor\n  return [fillColor[type2], strokeColor[type2]] as const\n}\n\n/**\n * Get color for a paired-end read based on orientation only\n * Returns default color for proper pairs\n */\nexport function getPairedOrientationColor(f: {\n  pair_orientation?: string\n  flags?: number\n}) {\n  return getPairedOrientationColorOrDefault(f) || defaultColor\n}\n\n/**\n * Get color for a paired-end read based on both insert size and orientation\n * Prioritizes orientation coloring over insert size coloring\n * Uses getPairedType() internally to determine classification\n */\nexport function getPairedInsertSizeAndOrientationColor(\n  f: {\n    refName: string\n    next_ref?: string\n    pair_orientation?: string\n    tlen?: number\n    flags?: number\n  },\n  stats?: ChainStats,\n) {\n  return (\n    getPairedOrientationColorOrDefault(f) ||\n    getPairedInsertSizeColor(f, stats) ||\n    defaultColor\n  )\n}\n\nexport function getSingletonColor(\n  f: { tlen?: number; pair_orientation?: string; flags?: number },\n  stats?: ChainStats,\n) {\n  // Check insert size\n  const tlen = Math.abs(f.tlen || 0)\n  // If TLEN is abnormally large, color it dark red\n  if (stats && tlen > stats.upper) {\n    return [\n      fillColor.color_fwd_missing_mate,\n      strokeColor.color_fwd_missing_mate,\n    ] as const\n  }\n  // Otherwise use properly paired coloring for normal-looking singletons\n  return defaultColor // [fillColor.color_pair_lr, strokeColor.color_pair_lr] as const\n}\n\nexport function getPairedColor({\n  type,\n  v0,\n  stats,\n}: {\n  type: string\n  v0: Feature\n  stats?: ChainStats\n}) {\n  // Extract properties from Feature objects\n  const f0 = {\n    refName: v0.get('refName'),\n    next_ref: v0.get('next_ref'),\n    pair_orientation: v0.get('pair_orientation'),\n    tlen: v0.get('template_length'),\n    flags: v0.get('flags'),\n  }\n\n  if (type === 'insertSizeAndOrientation') {\n    return getPairedInsertSizeAndOrientationColor(f0, stats)\n  }\n  if (type === 'orientation') {\n    return getPairedOrientationColor(f0)\n  }\n  if (type === 'insertSize') {\n    return getPairedInsertSizeColor(f0, stats)\n  }\n  return undefined\n}\n","import { getContainingView, getSession } from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport { isAlive } from '@jbrowse/mobx-state-tree'\n\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView/index.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { FeatureDensityStats } from '@jbrowse/core/data_adapters/BaseAdapter'\n\nexport interface RenderProps {\n  rendererType: any\n  renderArgs: Record<string, any>\n  renderProps: Record<string, any>\n  displayError: unknown\n  rpcManager: { call: (...args: unknown[]) => void }\n  cannotBeRenderedReason: string\n}\n\nexport interface ErrorProps {\n  displayError: string\n}\n\nexport function getDisplayStr(totalBytes: number) {\n  if (Math.floor(totalBytes / 1000000) > 0) {\n    return `${Number.parseFloat((totalBytes / 1000000).toPrecision(3))} Mb`\n  } else if (Math.floor(totalBytes / 1000) > 0) {\n    return `${Number.parseFloat((totalBytes / 1000).toPrecision(3))} Kb`\n  } else {\n    return `${Math.floor(totalBytes)} bytes`\n  }\n}\n\n// stabilize clipid under test for snapshot\nexport function getId(id: string, index: string | number) {\n  const notJest = typeof jest === 'undefined'\n  return ['clip', notJest ? id : 'jest', index, notJest ? Math.random() : '']\n    .filter(f => !!f)\n    .join('-')\n}\n\nexport async function getFeatureDensityStatsPre(self: {\n  adapterConfig?: AnyConfigurationModel\n  setStatusMessage: (arg: string) => void\n  effectiveRpcDriverName?: string\n}) {\n  const view = getContainingView(self) as LinearGenomeViewModel\n  const regions = view.staticBlocks.contentBlocks\n\n  const { rpcManager } = getSession(self)\n  const { adapterConfig, effectiveRpcDriverName } = self\n  if (!adapterConfig) {\n    // A track extending the base track might not have an adapter config\n    // e.g. Apollo tracks don't use adapters\n    return {}\n  } else {\n    const sessionId = getRpcSessionId(self)\n\n    return rpcManager.call(sessionId, 'CoreGetFeatureDensityStats', {\n      sessionId,\n      regions,\n      adapterConfig,\n      rpcDriverName: effectiveRpcDriverName,\n      statusCallback: (message: string) => {\n        if (isAlive(self)) {\n          self.setStatusMessage(message)\n        }\n      },\n    }) as Promise<FeatureDensityStats>\n  }\n}\n","import { createTheme } from '@mui/material'\nimport { blue, green, grey, orange, red } from '@mui/material/colors'\nimport deepmerge from 'deepmerge'\n\nimport type {\n  PaletteColor,\n  PaletteColorOptions,\n  Theme,\n  ThemeOptions,\n} from '@mui/material/styles'\n\ninterface PaletteAugmentColorOptions {\n  color: PaletteColorOptions\n}\n\ntype MaybePaletteColor = PaletteColor | undefined\ntype Frames = [\n  null,\n  MaybePaletteColor,\n  MaybePaletteColor,\n  MaybePaletteColor,\n  MaybePaletteColor,\n  MaybePaletteColor,\n  MaybePaletteColor,\n]\ndeclare module '@mui/material/styles' {\n  interface Palette {\n    tertiary: PaletteColor\n    quaternary: PaletteColor\n    highlight: PaletteColor\n    stopCodon: string\n    startCodon: string\n    insertion: string\n    softclip: string\n    skip: string\n    hardclip: string\n    deletion: string\n    bases: {\n      A: PaletteColor\n      C: PaletteColor\n      G: PaletteColor\n      T: PaletteColor\n    }\n    frames: Frames\n    framesCDS: Frames\n  }\n  interface PaletteOptions {\n    tertiary?: PaletteColorOptions\n    quaternary?: PaletteColorOptions\n    highlight?: PaletteColorOptions\n    stopCodon?: string\n    startCodon?: string\n    hardclip?: string\n    softclip?: string\n    insertion?: string\n    skip?: string\n    deletion?: string\n    bases?: {\n      A?: PaletteColorOptions\n      C?: PaletteColorOptions\n      G?: PaletteColorOptions\n      T?: PaletteColorOptions\n    }\n    framesCDS?: Frames\n    frames?: Frames\n  }\n}\n\nconst refTheme = createTheme()\nconst midnight = refTheme.palette.augmentColor({ color: { main: '#0D233F' } })\nconst grape = refTheme.palette.augmentColor({ color: { main: '#721E63' } })\nconst forest = refTheme.palette.augmentColor({ color: { main: '#135560' } })\nconst mandarin = refTheme.palette.augmentColor({ color: { main: '#FFB11D' } })\nconst lightgrey = refTheme.palette.augmentColor({ color: { main: '#aaa' } })\nconst bases = {\n  A: refTheme.palette.augmentColor({ color: green }),\n  C: refTheme.palette.augmentColor({ color: blue }),\n  G: refTheme.palette.augmentColor({ color: orange }),\n  T: refTheme.palette.augmentColor({ color: red }),\n}\nconst framesCDS = [\n  null,\n  refTheme.palette.augmentColor({ color: { main: '#FF8080' } }),\n  refTheme.palette.augmentColor({ color: { main: '#80FF80' } }),\n  refTheme.palette.augmentColor({ color: { main: '#8080FF' } }),\n  refTheme.palette.augmentColor({ color: { main: '#8080FF' } }),\n  refTheme.palette.augmentColor({ color: { main: '#80FF80' } }),\n  refTheme.palette.augmentColor({ color: { main: '#FF8080' } }),\n] as Frames\nconst frames = [\n  null,\n  refTheme.palette.augmentColor({ color: { main: '#8f8f8f' } }),\n  refTheme.palette.augmentColor({ color: { main: '#adadad' } }),\n  refTheme.palette.augmentColor({ color: { main: '#d8d8d8' } }),\n  refTheme.palette.augmentColor({ color: { main: '#d8d8d8' } }),\n  refTheme.palette.augmentColor({ color: { main: '#adadad' } }),\n  refTheme.palette.augmentColor({ color: { main: '#8f8f8f' } }),\n] as Frames\nconst stopCodon = '#e22'\nconst startCodon = '#3e3'\nconst insertion = '#800080'\nconst deletion = '#808080'\nconst hardclip = '#f00'\nconst softclip = '#00f'\nconst skip = '#97b8c9'\n\nconst defaults = {\n  primary: midnight,\n  secondary: grape,\n  tertiary: forest,\n  quaternary: mandarin,\n  highlight: mandarin,\n  stopCodon,\n  startCodon,\n  insertion,\n  deletion,\n  softclip,\n  hardclip,\n  bases,\n  frames,\n  framesCDS,\n  skip,\n}\n\nfunction stockTheme() {\n  return {\n    palette: {\n      ...defaults,\n      mode: undefined,\n    },\n    components: {\n      MuiLink: {\n        styleOverrides: {\n          // the default link color uses theme.palette.primary.main which is\n          // very bad with dark mode+midnight primary\n          root: ({ theme }) => ({\n            color: theme.palette.tertiary.main,\n          }),\n        },\n      },\n    },\n  } satisfies ThemeOptions\n}\n\nfunction getDefaultTheme() {\n  return {\n    ...stockTheme(),\n    name: 'Default (from config)',\n  }\n}\n\nfunction getLightStockTheme() {\n  return {\n    ...stockTheme(),\n    name: 'Light (stock)',\n  }\n}\n\nfunction getDarkStockTheme() {\n  return {\n    name: 'Dark (stock)',\n    palette: {\n      ...defaults,\n      mode: 'dark',\n    },\n    components: {\n      MuiAppBar: {\n        defaultProps: {\n          enableColorOnDark: true,\n        },\n        styleOverrides: {\n          root: ({ theme }) => theme.palette.primary.main,\n        },\n      },\n    },\n  } satisfies ThemeOptions & { name: string }\n}\n\nfunction getDarkMinimalTheme() {\n  return {\n    name: 'Dark (minimal)',\n    palette: {\n      ...defaults,\n      mode: 'dark' as const,\n      primary: { main: grey[700] },\n      secondary: { main: grey[800] },\n      tertiary: refTheme.palette.augmentColor({ color: { main: grey[900] } }),\n    },\n  } satisfies ThemeOptions & { name: string }\n}\n\nfunction getMinimalTheme() {\n  return {\n    name: 'Light (minimal)',\n    palette: {\n      ...defaults,\n      primary: { main: grey[900] },\n      secondary: { main: grey[800] },\n      tertiary: refTheme.palette.augmentColor({ color: { main: grey[900] } }),\n    },\n  } satisfies ThemeOptions & { name: string }\n}\n\nexport const defaultThemes = {\n  default: getDefaultTheme(),\n  lightStock: getLightStockTheme(),\n  lightMinimal: getMinimalTheme(),\n  darkMinimal: getDarkMinimalTheme(),\n  darkStock: getDarkStockTheme(),\n} as ThemeMap\n\nfunction overwriteArrayMerge(_: unknown, sourceArray: unknown[]) {\n  return sourceArray\n}\n\nexport function createJBrowseBaseTheme(theme?: ThemeOptions): ThemeOptions {\n  const themeP: ThemeOptions = {\n    palette: theme?.palette,\n    typography: {\n      fontSize: 12,\n    },\n    spacing: 4,\n    components: {\n      MuiTooltip: {\n        styleOverrides: {\n          tooltip: {\n            fontSize: 12,\n          },\n        },\n      },\n      MuiButton: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n        styleOverrides: {\n          // the default button, especially when not using variant=contained,\n          // uses theme.palette.primary.main for text which is very bad with\n          // dark mode+midnight primary\n          //\n          // keeps text secondary for darkmode, uses\n          // a text-like coloring to ensure contrast\n          // xref https://stackoverflow.com/a/72546130/2129219\n          root: ({ theme }) =>\n            theme.palette.mode === 'dark'\n              ? {\n                  color: theme.palette.text.primary,\n                }\n              : undefined,\n        },\n      },\n      MuiAccordion: {\n        defaultProps: {\n          disableGutters: true,\n          slotProps: {\n            transition: {\n              timeout: 150,\n              unmountOnExit: true,\n            },\n          },\n        },\n      },\n      MuiFilledInput: {\n        defaultProps: {\n          margin: 'dense' as const,\n        },\n      },\n      MuiFormControl: {\n        defaultProps: {\n          margin: 'dense' as const,\n          size: 'small' as const,\n        },\n      },\n      MuiFormHelperText: {\n        defaultProps: {\n          margin: 'dense' as const,\n        },\n      },\n\n      MuiIconButton: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n      },\n      MuiInputBase: {\n        defaultProps: {\n          margin: 'dense' as const,\n        },\n      },\n      MuiAutocomplete: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n      },\n      MuiInputLabel: {\n        defaultProps: {\n          margin: 'dense' as const,\n        },\n      },\n      MuiToolbar: {\n        defaultProps: {\n          variant: 'dense' as const,\n        },\n      },\n      MuiListItem: {\n        defaultProps: {\n          dense: true,\n        },\n      },\n      MuiOutlinedInput: {\n        defaultProps: {\n          margin: 'dense' as const,\n        },\n      },\n      MuiFab: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n        styleOverrides: {\n          secondary: {\n            // @ts-expect-error\n            backgroundColor: theme?.palette?.quaternary?.main,\n          },\n        },\n      },\n      MuiTable: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n      },\n      MuiPopover: {\n        defaultProps: {\n          transitionDuration: 0,\n        },\n      },\n      MuiMenu: {\n        defaultProps: {\n          transitionDuration: 0,\n        },\n      },\n      MuiMenuItem: {\n        defaultProps: {\n          dense: true,\n        },\n      },\n\n      MuiTextField: {\n        defaultProps: {\n          margin: 'dense' as const,\n          variant: 'standard' as const,\n        },\n      },\n      MuiLink: {\n        styleOverrides: {\n          // the default link color uses theme.palette.primary.main which is\n          // very bad with dark mode+midnight primary\n          root: ({ theme }) => ({\n            color: theme.palette.text.secondary,\n          }),\n        },\n      },\n      MuiCheckbox: {\n        styleOverrides: {\n          // the default checkbox-when-checked color uses\n          // theme.palette.primary.main which is very bad with dark\n          // mode+midnight primary\n          //\n          // keeps the forest-green checkbox by default but for darkmode, uses\n          // a text-like coloring to ensure contrast xref\n          // https://stackoverflow.com/a/72546130/2129219\n          root: ({ theme }) =>\n            theme.palette.mode === 'dark'\n              ? {\n                  color: theme.palette.text.secondary,\n                  '&.Mui-checked': {\n                    color: theme.palette.text.secondary,\n                  },\n                }\n              : undefined,\n        },\n      },\n      MuiRadio: {\n        styleOverrides: {\n          // the default checkbox-when-checked color uses\n          // theme.palette.primary.main which is very bad with dark\n          // mode+midnight primary\n          //\n          // keeps the forest-green checkbox by default but for darkmode, uses\n          // a text-like coloring to ensure contrast\n          // xref https://stackoverflow.com/a/72546130/2129219\n          root: ({ theme }) =>\n            theme.palette.mode === 'dark'\n              ? {\n                  color: theme.palette.text.secondary,\n                  '&.Mui-checked': {\n                    color: theme.palette.text.secondary,\n                  },\n                }\n              : undefined,\n        },\n      },\n      MuiFormLabel: {\n        styleOverrides: {\n          // the default checkbox-when-checked color uses\n          // theme.palette.primary.main which is very bad with dark\n          // mode+midnight primary\n          //\n          // keeps the forest-green checkbox by default but for darkmode, uses\n          // a text-like coloring to ensure contrast\n          // xref https://stackoverflow.com/a/72546130/2129219\n          //\n\n          root: ({ theme }) =>\n            theme.palette.mode === 'dark'\n              ? {\n                  color: theme.palette.text.secondary,\n                  '&.Mui-focused': {\n                    color: theme.palette.text.secondary,\n                  },\n                }\n              : undefined,\n        },\n      },\n      MuiAccordionSummary: {\n        styleOverrides: {\n          root: {\n            // @ts-expect-error\n            backgroundColor: theme?.palette?.tertiary?.main,\n          },\n          content: {\n            // @ts-expect-error\n            color: theme?.palette?.tertiary?.contrastText,\n          },\n        },\n      },\n      MuiToggleButtonGroup: {\n        defaultProps: {\n          size: 'small' as const,\n        },\n      },\n      // Speed up ripple animations for snappier feel (default is 550ms)\n      // See https://mui.com/material-ui/api/button-base/\n      // and https://github.com/mui/material-ui/blob/master/packages/mui-material/src/ButtonBase/TouchRipple.js\n      MuiButtonBase: {\n        styleOverrides: {\n          root: {\n            '& .MuiTouchRipple-ripple': {\n              animationDuration: '50ms !important',\n            },\n            '& .MuiTouchRipple-child': {\n              animationDuration: '50ms !important',\n            },\n          },\n        },\n      },\n    },\n  }\n  return deepmerge(themeP, theme || {}, { arrayMerge: overwriteArrayMerge })\n}\n\ntype ThemeMap = Record<string, ThemeOptions>\n\nconst themeCache = new Map<string, Theme>()\n\nfunction getThemeCacheKey(\n  configTheme: ThemeOptions,\n  themeName: string,\n): string {\n  return JSON.stringify({ configTheme, themeName })\n}\n\nexport function createJBrowseTheme(\n  configTheme: ThemeOptions = {},\n  themes = defaultThemes,\n  themeName = 'default',\n) {\n  const cacheKey = getThemeCacheKey(configTheme, themeName)\n  const cached = themeCache.get(cacheKey)\n  if (cached) {\n    return cached\n  }\n\n  const theme = createTheme(\n    createJBrowseBaseTheme(\n      themeName === 'default'\n        ? deepmerge(themes.default!, augmentThemeColors(configTheme), {\n            arrayMerge: overwriteArrayMerge,\n          })\n        : addMissingColors(themes[themeName]),\n    ),\n  )\n\n  themeCache.set(cacheKey, theme)\n  return theme\n}\n\n// MUI by default allows strings like '#f00' for primary and secondary and\n// augments them to have light and dark variants but not for anything else, so\n// we augment them here\nfunction augmentThemeColors(theme: ThemeOptions = {}) {\n  const augmentedPalette: Record<string, PaletteColor> = Object.create(null)\n  for (const entry of [\n    'primary',\n    'secondary',\n    'tertiary',\n    'quaternary',\n    'highlight',\n  ] as const) {\n    const paletteEntry = theme.palette?.[entry]\n    if (paletteEntry) {\n      augmentedPalette[entry] = refTheme.palette.augmentColor(\n        'color' in paletteEntry\n          ? (paletteEntry as PaletteAugmentColorOptions)\n          : { color: paletteEntry },\n      )\n    }\n  }\n  return Object.keys(augmentedPalette).length > 0\n    ? deepmerge(theme, { palette: augmentedPalette })\n    : theme\n}\n\n// adds missing colors to users theme\nfunction addMissingColors(theme: ThemeOptions = {}) {\n  const { palette } = theme\n  return augmentThemeColors(\n    deepmerge(theme, {\n      palette: {\n        quaternary: palette?.quaternary || lightgrey,\n        tertiary: palette?.tertiary || lightgrey,\n        highlight: palette?.highlight || mandarin,\n        insertion: palette?.insertion || insertion,\n        softclip: palette?.softclip || softclip,\n        skip: palette?.skip || skip,\n        hardclip: palette?.hardclip || hardclip,\n        deletion: palette?.deletion || deletion,\n        startCodon: palette?.startCodon || startCodon,\n        stopCodon: palette?.stopCodon || stopCodon,\n      },\n    }),\n  )\n}\n","import { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport ServerSideRendererType from './ServerSideRendererType.tsx'\nimport { normalizeRegion } from './util.ts'\nimport { isFeatureAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport { iterMap } from '../../util/index.ts'\nimport SimpleFeature from '../../util/simpleFeature.ts'\n\nimport type {\n  RenderArgs as ServerSideRenderArgs,\n  RenderArgsDeserialized as ServerSideRenderArgsDeserialized,\n  RenderArgsSerialized as ServerSideRenderArgsSerialized,\n  RenderResults as ServerSideRenderResults,\n  RenderReturn,\n  ResultsDeserialized as ServerSideResultsDeserialized,\n  ResultsSerialized as ServerSideResultsSerialized,\n} from './ServerSideRendererType.tsx'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\nimport type {\n  Feature,\n  SimpleFeatureSerialized,\n} from '../../util/simpleFeature.ts'\nimport type { AugmentedRegion as Region } from '../../util/types/index.ts'\n\nexport interface RenderArgs extends ServerSideRenderArgs {\n  displayModel?: {\n    id: string\n    selectedFeatureId?: string\n  }\n  regions: Region[]\n  blockKey: string\n}\n\nexport interface RenderArgsSerialized extends ServerSideRenderArgsSerialized {\n  displayModel?: {\n    id: string\n    selectedFeatureId?: string\n  }\n  regions: Region[]\n  blockKey: string\n}\n\nexport interface RenderArgsDeserialized extends ServerSideRenderArgsDeserialized {\n  displayModel: { id: string; selectedFeatureId?: string }\n  regions: Region[]\n  blockKey: string\n  adapterConfig: AnyConfigurationModel\n}\n\nexport interface RenderResults extends ServerSideRenderResults {\n  features?: Map<string, Feature>\n}\n\nexport interface ResultsSerialized extends ServerSideResultsSerialized {\n  features?: SimpleFeatureSerialized[]\n}\n\nexport interface ResultsDeserialized extends ServerSideResultsDeserialized {\n  features: Map<string, Feature>\n  blockKey: string\n}\n\n/**\n * FeatureRendererType provides feature fetching and serialization for renderers\n * that need to return features to the client (e.g., SvgFeatureRenderer for click handling).\n *\n * Canvas-based renderers that return rpcResult() with ImageBitmap bypass the feature\n * serialization and can use getFeatures() directly without going through render().\n */\nexport default class FeatureRendererType extends ServerSideRendererType {\n  async renderDirect(args: RenderArgs) {\n    const result = await super.renderDirect(args)\n    return {\n      ...result,\n      blockKey: args.blockKey,\n    }\n  }\n\n  serializeArgsInClient(args: RenderArgs) {\n    return super.serializeArgsInClient({\n      ...args,\n      displayModel: undefined,\n      regions: structuredClone(args.regions),\n    })\n  }\n\n  deserializeResultsInClient(\n    result: ResultsSerialized,\n    args: RenderArgs,\n  ): ResultsDeserialized {\n    const deserializedFeatures = new Map<string, SimpleFeature>(\n      result.features\n        ?.map(f => SimpleFeature.fromJSON(f))\n        .map(f => [f.id(), f]),\n    )\n\n    const deserialized = super.deserializeResultsInClient(\n      {\n        ...result,\n        features: deserializedFeatures,\n      } as ServerSideResultsSerialized,\n      args,\n    )\n    return {\n      ...deserialized,\n      blockKey: args.blockKey,\n      features: deserializedFeatures,\n    }\n  }\n\n  serializeResultsInWorker(\n    result: RenderResults,\n    args: RenderArgsDeserialized,\n  ): ResultsSerialized {\n    const serialized = super.serializeResultsInWorker(result, args)\n    const { features } = result\n\n    return {\n      ...serialized,\n      features:\n        features instanceof Map\n          ? iterMap(features.values(), f => f.toJSON(), features.size)\n          : undefined,\n    }\n  }\n\n  getExpandedRegion(region: Region, _renderArgs: RenderArgsDeserialized) {\n    return region\n  }\n\n  async getFeatures(\n    renderArgs: RenderArgsDeserialized,\n  ): Promise<Map<string, Feature>> {\n    const pm = this.pluginManager\n    const { regions, sessionId, adapterConfig } = renderArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n\n    if (!isFeatureAdapter(dataAdapter)) {\n      throw new Error('Adapter does not support retrieving features')\n    }\n\n    const requestRegions = regions.map(r => normalizeRegion(r))\n    const featureObservable =\n      requestRegions.length === 1\n        ? dataAdapter.getFeatures(\n            this.getExpandedRegion(requestRegions[0]!, renderArgs),\n            renderArgs,\n          )\n        : dataAdapter.getFeaturesInMultipleRegions(requestRegions, renderArgs)\n\n    const feats = await firstValueFrom(featureObservable.pipe(toArray()))\n    return new Map<string, Feature>(\n      feats\n        .filter(feat => this.featurePassesFilters(renderArgs, feat))\n        .map(feat => [feat.id(), feat] as const),\n    )\n  }\n\n  featurePassesFilters(renderArgs: RenderArgsDeserialized, feature: Feature) {\n    return renderArgs.filters\n      ? renderArgs.filters.passes(feature, renderArgs)\n      : true\n  }\n\n  /**\n   * Default render method that fetches features and passes them to the React component.\n   * Canvas-based renderers override this and return rpcResult() directly.\n   */\n  async render(renderArgs: RenderArgsDeserialized): Promise<RenderReturn> {\n    const features = await this.getFeatures(renderArgs)\n    const result = await super.render({ ...renderArgs, features })\n    return { ...result, features }\n  }\n}\n","import { memo } from 'react'\n\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\n\nconst useStyles = makeStyles()({\n  heightOverflowed: {\n    position: 'absolute',\n    color: 'rgb(77,77,77)',\n    borderBottom: '2px solid rgb(77,77,77)',\n    textShadow: 'white 0px 0px 1px',\n    whiteSpace: 'nowrap',\n    width: '100%',\n    fontWeight: 'bold',\n    textAlign: 'center',\n    zIndex: 999,\n    boxSizing: 'border-box',\n  },\n})\n\nconst MaxHeightReached = memo(function MaxHeightReached({\n  top,\n}: {\n  top: number\n}) {\n  const { classes } = useStyles()\n  return (\n    <div\n      className={classes.heightOverflowed}\n      style={{\n        top,\n        pointerEvents: 'none',\n        height: 16,\n      }}\n    >\n      Max height reached\n    </div>\n  )\n})\n\nexport default MaxHeightReached\n","import { observer } from 'mobx-react'\n\nimport {\n  ContentBlock as ContentBlockComponent,\n  ElidedBlock as ElidedBlockComponent,\n  InterRegionPaddingBlock as InterRegionPaddingBlockComponent,\n} from './Block.tsx'\nimport MaxHeightReached from './MaxHeightReachedIndicator.tsx'\n\nimport type { BlockModel } from '../models/serverSideRenderedBlock.ts'\nimport type { BlockSet } from '@jbrowse/core/util/blockTypes'\n\nconst RenderedBlocks = observer(function RenderedBlocks({\n  model,\n}: {\n  model: {\n    id: string\n    blockDefinitions: BlockSet\n    blockState: { get: (key: string) => BlockModel | undefined }\n  }\n}) {\n  const { blockDefinitions, blockState } = model\n  return blockDefinitions.map(block => {\n    const key = `${model.id}-${block.key}`\n    if (block.type === 'ContentBlock') {\n      const state = blockState.get(block.key)\n      return (\n        <ContentBlockComponent block={block} key={key}>\n          {state?.ReactComponent ? (\n            <state.ReactComponent model={state} />\n          ) : null}\n          {state?.maxHeightReached ? (\n            <MaxHeightReached top={state.layout.getTotalHeight() - 16} />\n          ) : null}\n        </ContentBlockComponent>\n      )\n    } else if (block.type === 'ElidedBlock') {\n      return <ElidedBlockComponent key={key} width={block.widthPx} />\n    } else if (block.type === 'InterRegionPaddingBlock') {\n      return (\n        <InterRegionPaddingBlockComponent\n          key={key}\n          width={block.widthPx}\n          style={{ background: 'none' }}\n          boundary={block.variant === 'boundary'}\n        />\n      )\n    }\n    throw new Error(`invalid block type ${JSON.stringify(block)}`)\n  })\n})\n\nexport default RenderedBlocks\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport RenderedBlocks from './RenderedBlocks.tsx'\n\nimport type { BaseLinearDisplayModel } from '../model.ts'\n\n// Warning: these styles are sensitive to causing 1px gaps between blocks.\n// Using display:flex with fractional widths and style.left positioning works.\n// Avoid using transform:translateX or inline-block as they cause subpixel\n// rounding issues that result in visible gaps between track blocks.\nconst useStyles = makeStyles()({\n  // Block container positioned using CSS calc() with --offset-px variable\n  // set by parent TracksContainer - avoids JS recalculation per track\n  linearBlocks: {\n    whiteSpace: 'nowrap',\n    textAlign: 'left',\n    position: 'absolute',\n    minHeight: '100%',\n    display: 'flex',\n  },\n})\n\nconst LinearBlocks = observer(function LinearBlocks({\n  model,\n}: {\n  model: BaseLinearDisplayModel\n}) {\n  const { classes } = useStyles()\n  const { blockDefinitions } = model\n  // Uses --offset-px CSS variable from TracksContainer parent\n  // Warning: use style.left here, not transform:translateX, to avoid 1px gaps\n  return (\n    <div\n      className={classes.linearBlocks}\n      style={{\n        left: `calc(${blockDefinitions.offsetPx}px - var(--offset-px))`,\n      }}\n    >\n      <RenderedBlocks model={model} />\n    </div>\n  )\n})\n\nexport default LinearBlocks\n","import { Menu } from '@jbrowse/core/ui'\nimport { observer } from 'mobx-react'\n\nimport type { Coord } from './types.ts'\nimport type { BaseLinearDisplayModel } from '../model.ts'\n\nconst MenuPage = observer(function MenuPage({\n  onClose,\n  contextCoord,\n  model,\n}: {\n  model: BaseLinearDisplayModel\n  contextCoord: Coord\n  onClose: () => void\n}) {\n  const items = model.contextMenuItems()\n  return (\n    <Menu\n      open={items.length > 0}\n      onMenuItemClick={(_, callback) => {\n        callback()\n        onClose()\n      }}\n      onClose={() => {\n        onClose()\n        model.setContextMenuFeature(undefined)\n      }}\n      slotProps={{\n        transition: {\n          onExit: () => {\n            onClose()\n            model.setContextMenuFeature(undefined)\n          },\n        },\n      }}\n      anchorReference=\"anchorPosition\"\n      anchorPosition={{\n        top: contextCoord[1],\n        left: contextCoord[0],\n      }}\n      menuItems={items}\n    />\n  )\n})\n\nexport default MenuPage\n","import { Suspense, useRef, useState } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport FloatingLegend from './FloatingLegend.tsx'\nimport LinearBlocks from './LinearBlocks.tsx'\nimport MenuPage from './MenuPage.tsx'\n\nimport type { Coord } from './types.ts'\nimport type { BaseLinearDisplayModel } from '../model.ts'\n\nconst useStyles = makeStyles()({\n  display: {\n    position: 'relative',\n    whiteSpace: 'nowrap',\n    textAlign: 'left',\n    width: '100%',\n    minHeight: '100%',\n  },\n})\n\nconst BaseLinearDisplay = observer(function BaseLinearDisplay(props: {\n  model: BaseLinearDisplayModel\n  children?: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  const ref = useRef<HTMLDivElement>(null)\n  const [clientRect, setClientRect] = useState<DOMRect>()\n  const [offsetMouseCoord, setOffsetMouseCoord] = useState<Coord>([0, 0])\n  const [clientMouseCoord, setClientMouseCoord] = useState<Coord>([0, 0])\n  const [contextCoord, setContextCoord] = useState<Coord>()\n  const { model, children } = props\n  const {\n    TooltipComponent,\n    DisplayMessageComponent,\n    height,\n    showLegend,\n    showTooltipsEnabled,\n  } = model\n  const theme = useTheme()\n  const legendItems = model.legendItems(theme)\n  return (\n    <div\n      ref={ref}\n      data-testid={`display-${getConf(model, 'displayId')}`}\n      className={classes.display}\n      onContextMenu={event => {\n        event.preventDefault()\n        if (contextCoord) {\n          // There's already a context menu open, so close it\n          setContextCoord(undefined)\n        } else if (ref.current) {\n          setContextCoord([event.clientX, event.clientY])\n        }\n      }}\n      onMouseMove={event => {\n        if (!ref.current) {\n          return\n        }\n        const rect = ref.current.getBoundingClientRect()\n        const { left, top } = rect\n        setOffsetMouseCoord([event.clientX - left, event.clientY - top])\n        setClientMouseCoord([event.clientX, event.clientY])\n        setClientRect(rect)\n      }}\n    >\n      {DisplayMessageComponent ? (\n        <DisplayMessageComponent model={model} />\n      ) : (\n        <LinearBlocks {...props} />\n      )}\n      {children}\n\n      {showLegend && legendItems.length > 0 ? (\n        <FloatingLegend items={legendItems} />\n      ) : null}\n\n      {showTooltipsEnabled ? (\n        <Suspense fallback={null}>\n          <TooltipComponent\n            model={model}\n            height={height}\n            offsetMouseCoord={offsetMouseCoord}\n            clientMouseCoord={clientMouseCoord}\n            clientRect={clientRect}\n            mouseCoord={offsetMouseCoord}\n          />\n        </Suspense>\n      ) : null}\n      {contextCoord ? (\n        <MenuPage\n          contextCoord={contextCoord}\n          model={model}\n          onClose={() => {\n            setContextCoord(undefined)\n          }}\n        />\n      ) : null}\n    </div>\n  )\n})\n\nexport default BaseLinearDisplay\n\nexport { default as Tooltip } from './Tooltip.tsx'\nexport { default as BlockMsg } from './BlockMsg.tsx'\n","import createJexlInstance from './jexl.ts'\n\nconst compilationCache: Record<string, any> = {}\n\n// revert function strings back to main, create a different file for\n// jexlStrings.ts pass the jexl property of the pluginManager as a param\n\n/**\n * compile a jexlExpression to a string\n *\n * @param str - string of code like `jexl:...`\n * @param options -\n */\nexport function stringToJexlExpression(str: string, jexl?: any) {\n  const cacheKey = `nosig|${str}`\n  if (!compilationCache[cacheKey]) {\n    const match = str.startsWith('jexl:')\n    if (!match) {\n      throw new Error('string does not appear to be in jexl format')\n    }\n    const code = str.split('jexl:')[1]!\n    const compiled = jexl\n      ? jexl.compile(code)\n      : createJexlInstance().compile(code)\n    compilationCache[cacheKey] = compiled\n  }\n\n  return compilationCache[cacheKey]\n}\n","import { colord as colordOriginal, extend } from 'colord'\nimport mix from 'colord/plugins/mix'\nimport names from 'colord/plugins/names'\n\nimport type { AnyColor, Colord as ColordBase } from 'colord'\n\n// Extend Colord interface with mix plugin methods\nexport interface Colord extends ColordBase {\n  mix(color2: AnyColor | Colord, ratio?: number): Colord\n  tints(count?: number): Colord[]\n  shades(count?: number): Colord[]\n  tones(count?: number): Colord[]\n}\n\nlet initialized = false\n\nfunction ensurePlugins() {\n  if (!initialized) {\n    extend([mix, names])\n    initialized = true\n  }\n}\n\nexport function colord(input: Parameters<typeof colordOriginal>[0]): Colord {\n  ensurePlugins()\n  return colordOriginal(input) as Colord\n}\n","import { ConfigurationSchema } from '../configuration/index.ts'\n\nconst configSchema = ConfigurationSchema('BaseFeatureWidget', {})\nexport { configSchema }\n","import { ConfigurationSchema } from '../../configuration/index.ts'\n\n/**\n * #config CytobandAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'CytobandAdapter',\n  {\n    /**\n     * #slot\n     */\n    cytobandLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/cytoband.txt.gz',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"CytobandAdapter\",\n     *   \"uri\": \"yourfile.bed\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            cytobandLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default configSchema\n","import { isFeatureAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\n\nexport default class CoreGetRefNames extends RpcMethodType {\n  name = 'CoreGetRefNames'\n\n  async execute(\n    args: {\n      sessionId: string\n      stopToken?: string\n      adapterConfig: Record<string, unknown>\n      sequenceAdapter?: Record<string, unknown>\n    },\n    rpcDriver: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, adapterConfig, sequenceAdapter } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n    if (!isFeatureAdapter(dataAdapter)) {\n      return []\n    }\n\n    // Set sequenceAdapterConfig on the adapter for BAM/CRAM adapters that need\n    // reference sequence data. Wrapper adapters like SNPCoverageAdapter override\n    // setSequenceAdapterConfig to propagate to their subadapters.\n    if (sequenceAdapter && !dataAdapter.sequenceAdapterConfig) {\n      dataAdapter.setSequenceAdapterConfig(sequenceAdapter)\n    }\n\n    return dataAdapter.getRefNames(deserializedArgs)\n  }\n}\n","import RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\n\nimport type { RenderArgs, RenderArgsSerialized } from './util.ts'\nimport type { BoxRendererType } from '../../pluggableElementTypes/index.ts'\n\n/**\n * fetches feature details from the layout cache (uses WeakRef)\n */\nexport default class CoreGetFeatureDetails extends RpcMethodType {\n  name = 'CoreGetFeatureDetails'\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    const superArgs = (await super.serializeArguments(\n      renamedArgs,\n      rpcDriver,\n    )) as RenderArgs\n    const { rendererType } = args\n    const RendererType = this.pluginManager.getRendererType(rendererType)!\n    // @ts-expect-error\n    return RendererType.serializeArgsInClient(superArgs)\n  }\n\n  async execute(\n    args: RenderArgsSerialized & { stopToken?: string },\n    rpcDriver: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { rendererType, featureId } = deserializedArgs\n    const RendererType = this.pluginManager.getRendererType(\n      rendererType,\n    )! as BoxRendererType\n\n    return {\n      feature: RendererType.getLayoutSession(args)\n        // @ts-expect-error\n        ?.cachedLayout.layout.getDataByID(featureId)\n        ?.toJSON(),\n    }\n  }\n}\n","import { isFeatureAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\n\nexport default class CoreGetMetadata extends RpcMethodType {\n  name = 'CoreGetMetadata'\n\n  async execute(\n    args: {\n      sessionId: string\n      stopToken?: string\n      adapterConfig: Record<string, unknown>\n    },\n    rpcDriver: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, adapterConfig } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n    return isFeatureAdapter(dataAdapter)\n      ? dataAdapter.getMetadata(deserializedArgs)\n      : null\n  }\n}\n","import { isFeatureAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\n\nexport default class CoreGetFileInfo extends RpcMethodType {\n  name = 'CoreGetInfo'\n\n  async execute(\n    args: {\n      sessionId: string\n      stopToken?: string\n      adapterConfig: Record<string, unknown>\n    },\n    rpcDriver: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, adapterConfig } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n    return isFeatureAdapter(dataAdapter)\n      ? dataAdapter.getHeader(deserializedArgs)\n      : null\n  }\n}\n","import { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\nimport SimpleFeature from '../../util/simpleFeature.ts'\n\nimport type { RenderArgs } from './util.ts'\nimport type { BaseFeatureDataAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport type { Region } from '../../util/index.ts'\nimport type { SimpleFeatureSerialized } from '../../util/simpleFeature.ts'\n\nexport default class CoreGetFeatures extends RpcMethodType {\n  name = 'CoreGetFeatures'\n\n  async deserializeReturn(\n    feats: SimpleFeatureSerialized[],\n    args: unknown,\n    rpcDriver: string,\n  ) {\n    const superDeserialized = (await super.deserializeReturn(\n      feats,\n      args,\n      rpcDriver,\n    )) as SimpleFeatureSerialized[]\n    return superDeserialized.map(feat => new SimpleFeature(feat))\n  }\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    return super.serializeArguments(\n      renamedArgs,\n      rpcDriver,\n    ) as Promise<RenderArgs>\n  }\n\n  async execute(\n    args: {\n      sessionId: string\n      regions: Region[]\n      adapterConfig: Record<string, unknown>\n      statusCallback: (arg: string) => void\n      stopToken?: string\n      opts?: any\n    },\n    rpcDriver: string,\n  ) {\n    const {\n      stopToken,\n      statusCallback,\n      sessionId,\n      adapterConfig,\n      regions,\n      opts,\n    } = await this.deserializeArguments(args, rpcDriver)\n\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseFeatureDataAdapter\n\n    const r = await firstValueFrom(\n      dataAdapter\n        .getFeaturesInMultipleRegions(regions, {\n          ...opts,\n          statusCallback,\n          stopToken,\n        })\n        .pipe(toArray()),\n    )\n    return r.map(f => f.toJSON())\n  }\n}\n","import { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\n\nimport type { RenderArgs } from './util.ts'\nimport type { BaseSequenceAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport type { Region } from '../../util/index.ts'\n\nexport default class CoreGetSequence extends RpcMethodType {\n  name = 'CoreGetSequence'\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    return super.serializeArguments(\n      renamedArgs,\n      rpcDriver,\n    ) as Promise<RenderArgs>\n  }\n\n  async execute(\n    args: {\n      sessionId: string\n      region: Region\n      adapterConfig: Record<string, unknown>\n      stopToken?: string\n    },\n    rpcDriver: string,\n  ) {\n    const { stopToken, sessionId, adapterConfig, region } =\n      await this.deserializeArguments(args, rpcDriver)\n\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseSequenceAdapter\n\n    return dataAdapter.getSequence(region, { stopToken })\n  }\n}\n","import type { ServerSideRendererType } from '../../pluggableElementTypes/index.ts'\nimport type {\n  RenderArgs as ServerSideRenderArgs,\n  RenderArgsSerialized as ServerSideRenderArgsSerialized,\n} from '../../pluggableElementTypes/renderers/ServerSideRendererType.tsx'\nimport type { Region } from '../../util/index.ts'\n\nexport interface RenderArgs extends ServerSideRenderArgs {\n  adapterConfig: Record<string, unknown>\n  rendererType: string\n}\n\nexport interface RenderArgsSerialized extends ServerSideRenderArgsSerialized {\n  assemblyName: string\n  regions: Region[]\n  adapterConfig: Record<string, unknown>\n  rendererType: string\n}\n\nexport function validateRendererType<T>(\n  rendererType: string,\n  RendererType: T,\n): ServerSideRendererType {\n  // @ts-expect-error\n  if (!RendererType.ReactComponent) {\n    throw new Error(\n      `renderer ${rendererType} has no ReactComponent, it may not be completely implemented yet`,\n    )\n  }\n  return RendererType as unknown as ServerSideRendererType\n}\n\nexport {\n  type RenderResults,\n  type ResultsSerialized,\n} from '../../pluggableElementTypes/renderers/ServerSideRendererType.tsx'\n","import { validateRendererType } from './util.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\n\nimport type {\n  RenderArgs,\n  RenderArgsSerialized,\n  RenderResults,\n  ResultsSerialized,\n} from './util.ts'\n\nexport default class CoreRender extends RpcMethodType {\n  name = 'CoreRender'\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n\n    const superArgs = (await super.serializeArguments(\n      renamedArgs,\n      rpcDriver,\n    )) as RenderArgs\n\n    return validateRendererType(\n      args.rendererType,\n      this.pluginManager.getRendererType(args.rendererType),\n    ).serializeArgsInClient(superArgs)\n  }\n\n  /**\n   * Execute directly without serialization. Used by MainThreadRpcDriver\n   * to bypass the serialize/deserialize overhead.\n   */\n  async executeDirect(args: RenderArgs) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    const { sessionId, rendererType } = renamedArgs\n    if (!sessionId) {\n      throw new Error('must pass a unique session id')\n    }\n\n    return validateRendererType(\n      rendererType,\n      this.pluginManager.getRendererType(rendererType),\n    ).renderDirect(renamedArgs)\n  }\n\n  async execute(\n    args: RenderArgsSerialized & { stopToken?: string },\n    rpcDriver: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, rendererType } = deserializedArgs\n    if (!sessionId) {\n      throw new Error('must pass a unique session id')\n    }\n\n    return validateRendererType(\n      rendererType,\n      this.pluginManager.getRendererType(rendererType),\n    ).renderInWorker(deserializedArgs)\n  }\n\n  async deserializeReturn(\n    serializedReturn: RenderResults | ResultsSerialized,\n    args: RenderArgs,\n    rpcDriver: string,\n  ): Promise<unknown> {\n    const des = await super.deserializeReturn(serializedReturn, args, rpcDriver)\n    // always call deserializeResultsInClient to ensure renderingProps are\n    // properly spread into the React component props\n    return validateRendererType(\n      args.rendererType,\n      this.pluginManager.getRendererType(args.rendererType),\n    ).deserializeResultsInClient(des as ResultsSerialized, args)\n  }\n}\n","import { freeAdapterResources } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\n\n/**\n * free up any resources (e.g. cached adapter objects)\n * that are only associated with the given track ID.\n *\n * returns number of objects deleted\n */\nexport default class CoreFreeResources extends RpcMethodType {\n  name = 'CoreFreeResources'\n\n  async execute(args: Record<string, unknown>) {\n    await freeAdapterResources(args)\n    for (const renderer of this.pluginManager.getRendererTypes()) {\n      renderer.freeResources(args)\n    }\n  }\n\n  async serializeArguments(args: Record<string, unknown>, _rpcDriver: string) {\n    return args\n  }\n}\n","import { isFeatureAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\n\nimport type { RenderArgs } from './util.ts'\nimport type { Region } from '../../util/index.ts'\n\nexport default class CoreGetFeatureDensityStats extends RpcMethodType {\n  name = 'CoreGetFeatureDensityStats'\n\n  async serializeArguments(\n    args: RenderArgs & {\n      stopToken?: string\n      statusCallback?: (arg: string) => void\n    },\n    rpcDriver: string,\n  ) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, {\n      ...args,\n      filters: args.filters?.toJSON().filters,\n    })\n\n    return super.serializeArguments(renamedArgs, rpcDriver)\n  }\n\n  async execute(\n    args: {\n      adapterConfig: Record<string, unknown>\n      regions: Region[]\n      stopToken?: string\n      headers?: Record<string, string>\n      sessionId: string\n    },\n    rpcDriver: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { adapterConfig, sessionId, regions } = deserializedArgs\n    const { dataAdapter } = await getAdapter(\n      this.pluginManager,\n      sessionId,\n      adapterConfig,\n    )\n\n    if (!isFeatureAdapter(dataAdapter)) {\n      throw new Error('Adapter does not support retrieving features')\n    }\n    return dataAdapter.getMultiRegionFeatureDensityStats(\n      regions,\n      deserializedArgs,\n    )\n  }\n}\n","import { isRegionsAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\n\nexport default class CoreGetRegions extends RpcMethodType {\n  name = 'CoreGetRegions'\n\n  async execute(\n    args: {\n      sessionId: string\n      adapterConfig: Record<string, unknown>\n    },\n    rpcDriver: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, adapterConfig } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n    return isRegionsAdapter(dataAdapter)\n      ? dataAdapter.getRegions(deserializedArgs)\n      : []\n  }\n}\n","import { getAdapter } from '../../data_adapters/dataAdapterCache.ts'\nimport RpcMethodType from '../../pluggableElementTypes/RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../../util/index.ts'\n\nimport type { BaseFeatureDataAdapter } from '../../data_adapters/BaseAdapter/index.ts'\nimport type { Region } from '../../util/index.ts'\n\nexport default class CoreGetExportData extends RpcMethodType {\n  name = 'CoreGetExportData'\n\n  async serializeArguments(\n    args: {\n      sessionId: string\n      regions: Region[]\n      adapterConfig: Record<string, unknown>\n      formatType: string\n      opts?: any\n    },\n    rpcDriver: string,\n  ) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    return super.serializeArguments(renamedArgs, rpcDriver)\n  }\n\n  async execute(\n    args: {\n      sessionId: string\n      regions: Region[]\n      adapterConfig: Record<string, unknown>\n      formatType: string\n      opts?: any\n    },\n    rpcDriver: string,\n  ) {\n    const { sessionId, adapterConfig, regions, formatType, opts } =\n      await this.deserializeArguments(args, rpcDriver)\n\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseFeatureDataAdapter\n\n    const result = await dataAdapter.getExportData(regions, formatType, opts)\n    return result || ''\n  }\n}\n","import { lazy } from 'react'\n\nimport { configSchema, stateModelFactory } from './BaseFeatureWidget/index.ts'\nimport Plugin from './Plugin.ts'\nimport CytobandAdapterF from './data_adapters/CytobandAdapter/index.ts'\nimport WidgetType from './pluggableElementTypes/WidgetType.ts'\nimport * as coreRpcMethods from './rpc/coreRpcMethods.ts'\n\nimport type PluginManager from './PluginManager.ts'\n\n// the core plugin, which registers types that ALL JBrowse applications are\n// expected to need.\nexport default class CorePlugin extends Plugin {\n  name = 'CorePlugin'\n\n  install(pluginManager: PluginManager) {\n    // register all our core rpc methods\n    for (const RpcMethod of Object.values(coreRpcMethods)) {\n      pluginManager.addRpcMethod(() => new RpcMethod(pluginManager))\n    }\n\n    CytobandAdapterF(pluginManager)\n\n    pluginManager.addWidgetType(() => {\n      return new WidgetType({\n        name: 'BaseFeatureWidget',\n        heading: 'Feature details',\n        configSchema,\n        stateModel: stateModelFactory(pluginManager),\n        ReactComponent: lazy(\n          () => import('./BaseFeatureWidget/BaseFeatureDetail/index.tsx'),\n        ),\n      })\n    })\n  }\n}\n","import configSchema from './configSchema.ts'\nimport { AdapterType } from '../../pluggableElementTypes/index.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\n\nexport default function CytobandAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'CytobandAdapter',\n        configSchema,\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n        getAdapterClass: () =>\n          import('./CytobandAdapter.ts').then(f => f.default),\n      }),\n  )\n}\n","/* eslint-disable @typescript-eslint/no-unsafe-function-type */\n\n// helper class that keeps groups of callbacks that are then run in a specified\n// order by group\nexport default class PhasedScheduler<PhaseName extends string> {\n  phaseCallbacks = new Map<PhaseName, Function[]>()\n\n  phaseOrder: PhaseName[] = []\n\n  constructor(...phaseOrder: PhaseName[]) {\n    this.phaseOrder = phaseOrder\n  }\n\n  add(phase: PhaseName, callback: Function) {\n    if (!this.phaseOrder.includes(phase)) {\n      throw new Error(`unknown phase ${phase}`)\n    }\n    let phaseCallbacks = this.phaseCallbacks.get(phase)\n    if (!phaseCallbacks) {\n      phaseCallbacks = []\n      this.phaseCallbacks.set(phase, phaseCallbacks)\n    }\n    phaseCallbacks.push(callback)\n  }\n\n  run() {\n    for (const phaseName of this.phaseOrder) {\n      for (const callback of this.phaseCallbacks.get(phaseName) || []) {\n        callback()\n      }\n    }\n  }\n}\n","/* eslint-disable @typescript-eslint/no-unsafe-function-type */\nimport { isModelType, isType, types } from '@jbrowse/mobx-state-tree'\n\nimport CorePlugin from './CorePlugin.ts'\nimport PhasedScheduler from './PhasedScheduler.ts'\nimport ReExports from './ReExports/index.ts'\nimport {\n  ConfigurationSchema,\n  isBareConfigurationSchemaType,\n} from './configuration/index.ts'\nimport AdapterType from './pluggableElementTypes/AdapterType.ts'\nimport AddTrackWorkflowType from './pluggableElementTypes/AddTrackWorkflowType.ts'\nimport ConnectionType from './pluggableElementTypes/ConnectionType.ts'\nimport DisplayType from './pluggableElementTypes/DisplayType.ts'\nimport GlyphType from './pluggableElementTypes/GlyphType.ts'\nimport InternetAccountType from './pluggableElementTypes/InternetAccountType.ts'\nimport RpcMethodType from './pluggableElementTypes/RpcMethodType.ts'\nimport TextSearchAdapterType from './pluggableElementTypes/TextSearchAdapterType.ts'\nimport TrackType from './pluggableElementTypes/TrackType.ts'\nimport ViewType from './pluggableElementTypes/ViewType.ts'\nimport WidgetType from './pluggableElementTypes/WidgetType.ts'\nimport RendererType from './pluggableElementTypes/renderers/RendererType.tsx'\nimport createJexlInstance from './util/jexl.ts'\n\nimport type Plugin from './Plugin.ts'\nimport type { PluginDefinition } from './PluginLoader.ts'\nimport type PluggableElementBase from './pluggableElementTypes/PluggableElementBase.ts'\nimport type { PluggableElementType } from './pluggableElementTypes/index.ts'\nimport type { AbstractRootModel } from './util/index.ts'\nimport type { IAnyModelType, IAnyType } from '@jbrowse/mobx-state-tree'\n\ntype PluggableElementTypeGroup =\n  | 'renderer'\n  | 'adapter'\n  | 'display'\n  | 'track'\n  | 'connection'\n  | 'view'\n  | 'widget'\n  | 'rpc method'\n  | 'internet account'\n  | 'text search adapter'\n  | 'add track workflow'\n  | 'glyph'\n\n/** internal class that holds the info for a certain element type */\nclass TypeRecord<ElementClass extends PluggableElementBase> {\n  registeredTypes: Record<string, ElementClass> = {}\n\n  constructor(\n    public typeName: string,\n    public baseClass:\n      | (new (...args: unknown[]) => ElementClass)\n      // covers abstract class case\n      | (Function & {\n          prototype: ElementClass\n        }),\n  ) {}\n\n  add(name: string, t: ElementClass) {\n    this.registeredTypes[name] = t\n  }\n\n  has(name: string) {\n    return name in this.registeredTypes\n  }\n\n  get(name: string) {\n    if (!this.has(name)) {\n      throw new Error(\n        `${this.typeName} '${name}' not found, perhaps its plugin is not loaded or its plugin has not added it.`,\n      )\n    }\n    return this.registeredTypes[name]\n  }\n\n  all() {\n    return Object.values(this.registeredTypes)\n  }\n}\n\ntype AnyFunction = (...args: any) => any\n\n/**\n * free-form string-to-unknown mapping of metadata related to the instance of\n * this plugin. `isCore` is typically set to `Boolean(true)` if the plugin was\n * loaded as part of the \"core\" set of plugins for this application. Can also\n * use this metadata to stash other things about why the plugin is loaded, such\n * as where it came from, what plugin depends on it, etc.\n */\nexport type PluginMetadata = Record<string, unknown>\n\nexport interface PluginLoadRecord {\n  metadata?: PluginMetadata\n  plugin: Plugin\n}\nexport interface RuntimePluginLoadRecord extends PluginLoadRecord {\n  definition: PluginDefinition\n}\n\nexport default class PluginManager {\n  plugins: Plugin[] = []\n\n  jexl = createJexlInstance()\n\n  pluginMetadata: Record<string, PluginMetadata> = {}\n\n  runtimePluginDefinitions: PluginDefinition[] = []\n\n  elementCreationSchedule = new PhasedScheduler<PluggableElementTypeGroup>(\n    'glyph',\n    'renderer',\n    'adapter',\n    'text search adapter',\n    'display',\n    'track',\n    'connection',\n    'view',\n    'widget',\n    'rpc method',\n    'internet account',\n    'add track workflow',\n  ) as PhasedScheduler<PluggableElementTypeGroup> | undefined\n\n  glyphTypes = new TypeRecord('GlyphType', GlyphType)\n\n  rendererTypes = new TypeRecord('RendererType', RendererType)\n\n  adapterTypes = new TypeRecord('AdapterType', AdapterType)\n\n  textSearchAdapterTypes = new TypeRecord(\n    'TextSearchAdapterType',\n    TextSearchAdapterType,\n  )\n\n  trackTypes = new TypeRecord('TrackType', TrackType)\n\n  displayTypes = new TypeRecord('DisplayType', DisplayType)\n\n  connectionTypes = new TypeRecord('ConnectionType', ConnectionType)\n\n  viewTypes = new TypeRecord('ViewType', ViewType)\n\n  widgetTypes = new TypeRecord('WidgetType', WidgetType)\n\n  rpcMethods = new TypeRecord('RpcMethodType', RpcMethodType)\n\n  addTrackWidgets = new TypeRecord('AddTrackWorkflow', AddTrackWorkflowType)\n\n  internetAccountTypes = new TypeRecord(\n    'InternetAccountType',\n    InternetAccountType,\n  )\n\n  configured = false\n\n  rootModel?: AbstractRootModel\n\n  extensionPoints = new Map<string, Function[]>()\n\n  constructor(initialPlugins: (Plugin | PluginLoadRecord)[] = []) {\n    // add the core plugin\n    this.addPlugin({\n      plugin: new CorePlugin(),\n      metadata: {\n        isCore: true,\n      },\n    })\n\n    // add all the initial plugins\n    for (const plugin of initialPlugins) {\n      this.addPlugin(plugin)\n    }\n  }\n\n  pluginConfigurationNamespacedSchemas() {\n    const configurationSchemas: Record<string, unknown> = {}\n    for (const plugin of this.plugins) {\n      if (plugin.configurationSchema) {\n        configurationSchemas[plugin.name] = plugin.configurationSchema\n      }\n    }\n    return configurationSchemas\n  }\n\n  pluginConfigurationUnnamespacedSchemas() {\n    let configurationSchemas: Record<string, unknown> = {}\n    for (const plugin of this.plugins) {\n      if (plugin.configurationSchemaUnnamespaced) {\n        configurationSchemas = {\n          ...configurationSchemas,\n          ...plugin.configurationSchemaUnnamespaced,\n        }\n      }\n    }\n    return configurationSchemas\n  }\n\n  pluginConfigurationRootSchemas() {\n    let configurationSchemas: Record<string, unknown> = {}\n    for (const plugin of this.plugins) {\n      if (plugin.rootConfigurationSchema) {\n        configurationSchemas = {\n          ...configurationSchemas,\n          ...plugin.rootConfigurationSchema(this),\n        }\n      }\n    }\n    return configurationSchemas\n  }\n\n  addPlugin(load: Plugin | PluginLoadRecord | RuntimePluginLoadRecord) {\n    if (this.configured) {\n      throw new Error('JBrowse already configured, cannot add plugins')\n    }\n\n    // check for availability of 'install' and 'configure' as a proxy for being\n    // an 'instanceof Plugin'\n    const [plugin, metadata = {}] =\n      'install' in load && 'configure' in load\n        ? [load, {}]\n        : [load.plugin, load.metadata]\n\n    if (this.plugins.includes(plugin)) {\n      throw new Error('plugin already installed')\n    }\n\n    this.pluginMetadata[plugin.name] = metadata\n    if ('definition' in load) {\n      this.runtimePluginDefinitions.push(load.definition)\n    }\n    plugin.install(this)\n    this.plugins.push(plugin)\n    return this\n  }\n\n  getPlugin(name: string) {\n    return this.plugins.find(p => p.name === name)\n  }\n\n  hasPlugin(name: string) {\n    return this.getPlugin(name) !== undefined\n  }\n\n  createPluggableElements() {\n    // run the creation callbacks for each element type in order.\n    // see elementCreationSchedule above for the creation order\n    if (this.elementCreationSchedule) {\n      this.elementCreationSchedule.run()\n      this.elementCreationSchedule = undefined\n    }\n    return this\n  }\n\n  setRootModel(rootModel: AbstractRootModel) {\n    this.rootModel = rootModel\n    return this\n  }\n\n  configure() {\n    if (this.configured) {\n      throw new Error('already configured')\n    }\n\n    for (const plugin of this.plugins) {\n      plugin.configure(this)\n    }\n\n    this.configured = true\n\n    return this\n  }\n\n  getElementTypeRecord(\n    groupName: PluggableElementTypeGroup,\n  ): TypeRecord<PluggableElementBase> {\n    switch (groupName) {\n      case 'adapter':\n        return this.adapterTypes\n      case 'text search adapter':\n        return this.textSearchAdapterTypes\n      case 'connection':\n        return this.connectionTypes\n      case 'widget':\n        return this.widgetTypes\n      case 'renderer':\n        return this.rendererTypes\n      case 'display':\n        return this.displayTypes\n      case 'track':\n        return this.trackTypes\n      case 'view':\n        return this.viewTypes\n      case 'rpc method':\n        return this.rpcMethods\n      case 'internet account':\n        return this.internetAccountTypes\n      case 'add track workflow':\n        return this.addTrackWidgets\n      case 'glyph':\n        return this.glyphTypes\n      default:\n        throw new Error(`invalid element type '${groupName}'`)\n    }\n  }\n\n  addElementType(\n    groupName: PluggableElementTypeGroup,\n    creationCallback: (pluginManager: PluginManager) => PluggableElementType,\n  ) {\n    if (typeof creationCallback !== 'function') {\n      throw new Error(\n        'must provide a callback function that returns the new type object',\n      )\n    }\n    const typeRecord = this.getElementTypeRecord(groupName)\n\n    this.elementCreationSchedule?.add(groupName, () => {\n      const newElement = creationCallback(this)\n      if (!newElement.name) {\n        throw new Error(`cannot add a ${groupName} with no name`)\n      }\n\n      if (typeRecord.has(newElement.name)) {\n        console.warn(\n          `${groupName} ${newElement.name} already registered, cannot register it again`,\n        )\n      } else {\n        typeRecord.add(\n          newElement.name,\n          this.evaluateExtensionPoint(\n            'Core-extendPluggableElement',\n            newElement,\n          ) as PluggableElementType,\n        )\n      }\n    })\n\n    return this\n  }\n\n  getElementType(groupName: PluggableElementTypeGroup, typeName: string) {\n    return this.getElementTypeRecord(groupName).get(typeName)\n  }\n\n  getElementTypesInGroup(groupName: PluggableElementTypeGroup) {\n    return this.getElementTypeRecord(groupName).all()\n  }\n\n  getViewElements() {\n    return this.getElementTypesInGroup('view') as ViewType[]\n  }\n\n  getTrackElements() {\n    return this.getElementTypesInGroup('track') as TrackType[]\n  }\n\n  getConnectionElements() {\n    return this.getElementTypesInGroup('connection') as ConnectionType[]\n  }\n\n  getAddTrackWorkflowElements() {\n    return this.getElementTypesInGroup(\n      'add track workflow',\n    ) as AddTrackWorkflowType[]\n  }\n\n  getRpcElements() {\n    return this.getElementTypesInGroup('rpc method') as RpcMethodType[]\n  }\n\n  getDisplayElements() {\n    return this.getElementTypesInGroup('display') as DisplayType[]\n  }\n\n  getAdapterElements() {\n    return this.getElementTypesInGroup('adapter') as AdapterType[]\n  }\n\n  /** get a MST type for the union of all specified pluggable MST types */\n  pluggableMstType(\n    groupName: PluggableElementTypeGroup,\n    fieldName: string,\n    fallback: IAnyType = types.maybe(types.null),\n  ) {\n    const pluggableTypes = this.getElementTypeRecord(groupName)\n      .all()\n      // @ts-expect-error\n      .map(t => t[fieldName])\n      .filter(t => isType(t) && isModelType(t)) as IAnyType[]\n\n    // try to smooth over the case when no types are registered, mostly\n    // encountered in tests\n    if (pluggableTypes.length === 0 && typeof jest === 'undefined') {\n      console.warn(\n        `No pluggable types found matching ('${groupName}','${fieldName}')`,\n      )\n      return fallback\n    }\n    return types.union(...pluggableTypes)\n  }\n\n  /** get a MST type for the union of all specified pluggable config schemas */\n  pluggableConfigSchemaType(\n    typeGroup: PluggableElementTypeGroup,\n    fieldName = 'configSchema',\n  ) {\n    const pluggableTypes = this.getElementTypeRecord(typeGroup)\n      .all()\n      // @ts-expect-error\n      .map(t => t[fieldName])\n      .filter(t => isBareConfigurationSchemaType(t)) as IAnyType[]\n\n    if (pluggableTypes.length === 0) {\n      pluggableTypes.push(ConfigurationSchema('Null', {}))\n    }\n    return types.union(...pluggableTypes) as IAnyModelType\n  }\n\n  jbrequireCache = new Map()\n\n  lib = ReExports\n\n  load = <FTYPE extends AnyFunction>(lib: FTYPE): ReturnType<FTYPE> => {\n    if (!this.jbrequireCache.has(lib)) {\n      this.jbrequireCache.set(lib, lib(this))\n    }\n    return this.jbrequireCache.get(lib)\n  }\n\n  /**\n   * Get the re-exported version of the given package name.\n   * Throws an error if the package is not re-exported by the plugin manager.\n   *\n   * @returns the library's default export\n   */\n  jbrequire = (\n    lib: keyof typeof ReExports | AnyFunction | { default: AnyFunction },\n  ): any => {\n    if (typeof lib === 'string') {\n      const pack = this.lib[lib]\n\n      if (!pack) {\n        throw new TypeError(\n          `No jbrequire re-export defined for package '${lib}'. If this package must be shared between plugins, add it to ReExports.js. If it does not need to be shared, just import it normally.`,\n        )\n      }\n      return pack\n    } else if (typeof lib === 'function') {\n      return this.load(lib)\n    }\n\n    // @ts-expect-error\n    else if (lib.default) {\n      console.warn('initiated jbrequire on a {default:Function}')\n      // @ts-expect-error\n      return this.jbrequire(lib.default)\n    }\n\n    throw new TypeError(\n      'lib passed to jbrequire must be either a string or a function',\n    )\n  }\n\n  getRendererType(typeName: string) {\n    return this.rendererTypes.get(typeName)\n  }\n\n  getRendererTypes(): RendererType[] {\n    return this.rendererTypes.all()\n  }\n\n  getAdapterType(typeName: string) {\n    return this.adapterTypes.get(typeName)\n  }\n\n  getTextSearchAdapterType(typeName: string) {\n    return this.textSearchAdapterTypes.get(typeName)\n  }\n\n  getTrackType(typeName: string) {\n    return this.trackTypes.get(typeName)\n  }\n\n  getDisplayType(typeName: string) {\n    return this.displayTypes.get(typeName)\n  }\n\n  getViewType(typeName: string) {\n    return this.viewTypes.get(typeName)\n  }\n\n  getAddTrackWorkflow(typeName: string) {\n    return this.addTrackWidgets.get(typeName)\n  }\n\n  getWidgetType(typeName: string) {\n    return this.widgetTypes.get(typeName)\n  }\n\n  getConnectionType(typeName: string) {\n    return this.connectionTypes.get(typeName)\n  }\n\n  getRpcMethodType(methodName: string) {\n    return this.rpcMethods.get(methodName)\n  }\n\n  getInternetAccountType(name: string) {\n    return this.internetAccountTypes.get(name)\n  }\n\n  addRendererType(cb: (pm: PluginManager) => RendererType) {\n    return this.addElementType('renderer', cb)\n  }\n\n  addAdapterType(cb: (pm: PluginManager) => AdapterType) {\n    return this.addElementType('adapter', cb)\n  }\n\n  addTextSearchAdapterType(cb: (pm: PluginManager) => TextSearchAdapterType) {\n    return this.addElementType('text search adapter', cb)\n  }\n\n  addTrackType(cb: (pm: PluginManager) => TrackType) {\n    // Goes through the already-created displays and registers the ones that\n    // specify this track type\n    const callback = () => {\n      const track = cb(this)\n      const displays = this.getElementTypesInGroup('display') as DisplayType[]\n      for (const display of displays) {\n        // track may have already added the displayType in its cb\n        if (\n          display.trackType === track.name &&\n          !track.displayTypes.includes(display)\n        ) {\n          track.addDisplayType(display)\n        }\n      }\n      return track\n    }\n    return this.addElementType('track', callback)\n  }\n\n  addDisplayType(cb: (pluginManager: PluginManager) => DisplayType) {\n    return this.addElementType('display', cb)\n  }\n\n  addViewType(cb: (pluginManager: PluginManager) => ViewType) {\n    const callback = () => {\n      const newView = cb(this)\n      const displays = this.getElementTypesInGroup('display') as DisplayType[]\n      for (const display of displays) {\n        // view may have already added the displayType in its callback\n        // see ViewType for description of extendedName\n        if (\n          (display.viewType === newView.name ||\n            display.viewType === newView.extendedName) &&\n          !newView.displayTypes.includes(display)\n        ) {\n          newView.addDisplayType(display)\n        }\n      }\n      return newView\n    }\n    return this.addElementType('view', callback)\n  }\n\n  addWidgetType(cb: (pm: PluginManager) => WidgetType) {\n    return this.addElementType('widget', cb)\n  }\n\n  addConnectionType(cb: (pm: PluginManager) => ConnectionType) {\n    return this.addElementType('connection', cb)\n  }\n\n  addRpcMethod(cb: (pm: PluginManager) => RpcMethodType) {\n    return this.addElementType('rpc method', cb)\n  }\n\n  addInternetAccountType(cb: (pm: PluginManager) => InternetAccountType) {\n    return this.addElementType('internet account', cb)\n  }\n\n  addAddTrackWorkflowType(cb: (pm: PluginManager) => AddTrackWorkflowType) {\n    return this.addElementType('add track workflow', cb)\n  }\n\n  addGlyphType(cb: (pm: PluginManager) => GlyphType) {\n    return this.addElementType('glyph', cb)\n  }\n\n  getGlyphType(typeName: string) {\n    return this.glyphTypes.get(typeName)\n  }\n\n  getGlyphTypes(): GlyphType[] {\n    return this.glyphTypes.all()\n  }\n\n  addToExtensionPoint<T>(\n    extensionPointName: string,\n    callback: (extendee: T, props: Record<string, unknown>) => T,\n  ) {\n    let callbacks = this.extensionPoints.get(extensionPointName)\n    if (!callbacks) {\n      callbacks = []\n      this.extensionPoints.set(extensionPointName, callbacks)\n    }\n    callbacks.push(callback)\n  }\n\n  evaluateExtensionPoint(\n    extensionPointName: string,\n    extendee: unknown,\n    props?: Record<string, unknown>,\n  ) {\n    const callbacks = this.extensionPoints.get(extensionPointName)\n    let accumulator = extendee\n    if (callbacks) {\n      for (const callback of callbacks) {\n        try {\n          accumulator = callback(accumulator, props)\n        } catch (error) {\n          console.error(error)\n        }\n      }\n    }\n    return accumulator\n  }\n\n  async evaluateAsyncExtensionPoint(\n    extensionPointName: string,\n    extendee: unknown,\n    props?: Record<string, unknown>,\n  ) {\n    const callbacks = this.extensionPoints.get(extensionPointName)\n    let accumulator = extendee\n    if (callbacks) {\n      for (const callback of callbacks) {\n        try {\n          accumulator = await callback(accumulator, props)\n        } catch (error) {\n          console.error(error)\n        }\n      }\n    }\n    return accumulator\n  }\n}\n","import { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\n\nimport {\n  localStorageGetBoolean,\n  localStorageGetItem,\n  localStorageGetNumber,\n  localStorageSetItem,\n} from '../../util/index.ts'\n\nimport type { SimpleFeatureSerialized } from '../../util/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nfunction localStorageSetNumber(key: string, value: number) {\n  localStorageSetItem(key, JSON.stringify(value))\n}\n\nfunction localStorageSetBoolean(key: string, value: boolean) {\n  localStorageSetItem(key, JSON.stringify(value))\n}\n\ntype ShowCoordinatesMode = 'none' | 'relative' | 'genomic'\ntype SequenceDisplayMode =\n  | ''\n  | 'gene'\n  | 'gene_collapsed_intron'\n  | 'gene_updownstream'\n  | 'cdna'\n  | 'cds'\n  | 'genomic'\n  | 'genomic_sequence_updownstream'\n  | 'protein'\n\nconst p = 'sequenceFeatureDetails'\n\nexport function SequenceFeatureDetailsF() {\n  return types\n    .model('SequenceFeatureDetails')\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      showCoordinatesSetting:\n        localStorageGetItem(`${p}-showCoordinatesSetting`) || 'none',\n      /**\n       * #volatile\n       */\n      intronBp: localStorageGetNumber(`${p}-intronBp`, 10),\n      /**\n       * #volatile\n       */\n      upDownBp: localStorageGetNumber(`${p}-upDownBp`, 100),\n      /**\n       * #volatile\n       */\n      upperCaseCDS: localStorageGetBoolean(`${p}-upperCaseCDS`, true),\n      /**\n       * #volatile\n       */\n      charactersPerRow: 100,\n      /**\n       * #volatile\n       */\n      feature: undefined as SimpleFeatureSerialized | undefined,\n      /**\n       * #volatile\n       */\n      mode: '' as SequenceDisplayMode,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setFeature(f: SimpleFeatureSerialized) {\n        self.feature = f\n      },\n      /**\n       * #action\n       */\n      setUpDownBp(f: number) {\n        self.upDownBp = f\n      },\n      /**\n       * #action\n       */\n      setIntronBp(f: number) {\n        self.intronBp = f\n      },\n      /**\n       * #action\n       */\n      setUpperCaseCDS(f: boolean) {\n        self.upperCaseCDS = f\n      },\n      /**\n       * #action\n       */\n      setShowCoordinates(f: ShowCoordinatesMode) {\n        self.showCoordinatesSetting = f\n      },\n      /**\n       * #action\n       */\n      setMode(mode: SequenceDisplayMode) {\n        self.mode = mode\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get showCoordinates() {\n        return self.showCoordinatesSetting !== 'none'\n      },\n      /**\n       * #getter\n       */\n      get showGenomicCoordsOption() {\n        return (\n          self.mode === 'gene' ||\n          self.mode === 'gene_updownstream' ||\n          self.mode === 'genomic' ||\n          self.mode === 'genomic_sequence_updownstream'\n        )\n      },\n      /**\n       * #getter\n       */\n      get hasCDS() {\n        const featureType = self.feature?.type?.toLowerCase()\n        if (featureType === 'mature_protein_region_of_cds') {\n          return true\n        }\n        return self.feature?.subfeatures?.some(sub => {\n          const type = sub.type?.toLowerCase()\n          return type === 'cds' || type === 'mature_protein_region_of_cds'\n        })\n      },\n      /**\n       * #getter\n       */\n      get hasExon() {\n        return self.feature?.subfeatures?.some(sub => sub.type === 'exon')\n      },\n      /**\n       * #getter\n       */\n      get hasExonOrCDS() {\n        return this.hasExon || this.hasCDS\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function sequenceFeatureLocalStorageAutorun() {\n              localStorageSetNumber(`${p}-upDownBp`, self.upDownBp)\n              localStorageSetNumber(`${p}-intronBp`, self.intronBp)\n              localStorageSetBoolean(`${p}-upperCaseCDS`, self.upperCaseCDS)\n              localStorageSetItem(\n                `${p}-showCoordinatesSetting`,\n                self.showCoordinatesSetting,\n              )\n            },\n            { name: 'SequenceFeatureLocalStorage' },\n          ),\n        )\n        addDisposer(\n          self,\n          autorun(\n            function sequenceFeatureModeAutorun() {\n              self.setMode(\n                self.hasCDS ? 'cds' : self.hasExon ? 'cdna' : 'genomic',\n              )\n            },\n            { name: 'SequenceFeatureMode' },\n          ),\n        )\n      },\n    }))\n}\n\nexport type SequenceFeatureDetailsStateModel = ReturnType<\n  typeof SequenceFeatureDetailsF\n>\nexport type SequenceFeatureDetailsModel =\n  Instance<SequenceFeatureDetailsStateModel>\n","import { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\n\nimport { getConf } from '../configuration/index.ts'\nimport { getSession } from '../util/index.ts'\nimport { SequenceFeatureDetailsF } from './SequenceFeatureDetails/model.ts'\nimport { formatSubfeatures } from './util.tsx'\nimport { ElementId } from '../util/types/mst.ts'\n\nimport type PluginManager from '../PluginManager.ts'\nimport type { MaybeSerializedFeat } from './types.tsx'\nimport type { SimpleFeatureSerialized } from '../util/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel BaseFeatureWidget\n * displays data about features, allowing configuration callbacks to modify the\n * contents of what is displayed\n *\n * see: formatDetails-\\>feature,formatDetails-\\>subfeatures\n */\nexport function stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .model('BaseFeatureWidget', {\n      /**\n       * #property\n       */\n      id: ElementId,\n\n      /**\n       * #property\n       */\n      type: types.literal('BaseFeatureWidget'),\n\n      /**\n       * #property\n       */\n      featureData: types.frozen<MaybeSerializedFeat>(),\n\n      /**\n       * #property\n       */\n      formattedFields: types.frozen(),\n\n      /**\n       * #property\n       */\n      unformattedFeatureData: types.frozen<MaybeSerializedFeat>(),\n\n      /**\n       * #property\n       */\n      view: types.safeReference(\n        pluginManager.pluggableMstType('view', 'stateModel'),\n      ),\n\n      /**\n       * #property\n       */\n      track: types.safeReference(\n        pluginManager.pluggableMstType('track', 'stateModel'),\n      ),\n\n      /**\n       * #property\n       */\n      trackId: types.maybe(types.string),\n\n      /**\n       * #property\n       */\n      trackType: types.maybe(types.string),\n\n      /**\n       * #property\n       */\n      maxDepth: types.maybe(types.number),\n\n      /**\n       * #property\n       */\n      sequenceFeatureDetails: types.optional(SequenceFeatureDetailsF(), {}),\n\n      /**\n       * #property\n       */\n      descriptions: types.frozen<Record<string, unknown> | undefined>(),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      error: undefined as unknown,\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setFeatureData(featureData: SimpleFeatureSerialized) {\n        self.unformattedFeatureData = featureData\n      },\n      /**\n       * #action\n       */\n      clearFeatureData() {\n        self.featureData = undefined\n      },\n      /**\n       * #action\n       */\n      setFormattedData(feat: SimpleFeatureSerialized) {\n        self.featureData = feat\n      },\n      /**\n       * #action\n       */\n      setExtra(type?: string, trackId?: string, maxDepth?: number) {\n        self.trackId = trackId\n        self.trackType = type\n        self.maxDepth = maxDepth\n      },\n      /**\n       * #action\n       */\n      setError(e: unknown) {\n        self.error = e\n      },\n    }))\n    .actions(self => ({\n      afterCreate() {\n        addDisposer(\n          self,\n          autorun(\n            function featureWidgetAutorun() {\n              try {\n                const { unformattedFeatureData, track } = self\n                const session = getSession(self)\n                if (track) {\n                  self.setExtra(\n                    track.type,\n                    track.configuration.trackId,\n                    getConf(track, ['formatDetails', 'maxDepth']),\n                  )\n                }\n                if (unformattedFeatureData) {\n                  const feature = structuredClone(unformattedFeatureData)\n\n                  const combine = (\n                    arg2: string,\n                    feature: Record<string, unknown>,\n                  ) => ({\n                    ...getConf(session, ['formatDetails', arg2], { feature }),\n                    ...getConf(track, ['formatDetails', arg2], { feature }),\n                  })\n\n                  if (track) {\n                    feature.__jbrowsefmt = combine('feature', feature)\n\n                    formatSubfeatures(\n                      feature,\n                      getConf(track, ['formatDetails', 'depth']),\n                      sub => {\n                        sub.__jbrowsefmt = combine('subfeatures', sub)\n                      },\n                    )\n                  }\n\n                  self.setFormattedData(feature)\n                }\n              } catch (e) {\n                console.error(e)\n                self.setError(e)\n              }\n            },\n            { name: 'FeatureWidget' },\n          ),\n        )\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // @ts-expect-error\n      const { featureData, finalizedFeatureData, ...rest } = snap\n      return {\n        unformattedFeatureData: featureData,\n        featureData: finalizedFeatureData,\n        ...rest,\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n      const { unformattedFeatureData, featureData, ...rest } = snap as Omit<\n        typeof snap,\n        symbol\n      >\n\n      const s2 = JSON.stringify(featureData, (_, v) =>\n        v === undefined ? null : v,\n      )\n\n      // JSON.stringify can return empty if too large\n\n      const featureTooLargeToBeSerialized = !s2 || s2.length > 2_000_000\n\n      // The concept of using `finalizedFeatureData` is to avoid running\n      // formatter twice if loading from snapshot\n      return {\n        // We replace undefined with null to help with allowing fields to be\n        // hidden, setting null is not allowed by jexl so we set it to\n        // undefined to hide, but JSON only allows serializing null\n        finalizedFeatureData: featureTooLargeToBeSerialized\n          ? undefined\n          : JSON.parse(s2),\n        ...rest,\n      }\n    })\n}\n\nexport type BaseFeatureWidgetStateModel = ReturnType<typeof stateModelFactory>\nexport type BaseFeatureWidgetModel = Instance<BaseFeatureWidgetStateModel>\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport { ElementId, Region } from '../../util/types/mst.ts'\n\nimport type { MenuItem } from '../../ui/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel BaseViewModel\n * #category view\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BaseViewModel = types\n  .model('BaseView', {\n    /**\n     * #property\n     */\n    id: ElementId,\n\n    /**\n     * #property\n     * displayName is displayed in the header of the view, or assembly names\n     * being used if none is specified\n     */\n    displayName: types.maybe(types.string),\n\n    /**\n     * #property\n     */\n    minimized: false,\n  })\n  .volatile(() => ({\n    width: 800,\n  }))\n  .views(() => ({\n    /**\n     * #getter\n     */\n    menuItems(): MenuItem[] {\n      return []\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     */\n    setDisplayName(name: string) {\n      self.displayName = name\n    },\n\n    /**\n     * #action\n     * width is an important attribute of the view model, when it becomes set,\n     * it often indicates when the app can start drawing to it. certain views\n     * like lgv are strict about this because if it tries to draw before it\n     * knows the width it should draw to, it may start fetching data for\n     * regions it doesn't need to\n     *\n     * setWidth is updated by a ResizeObserver generally, the views often need\n     * to know how wide they are to properly draw genomic regions\n     */\n    setWidth(newWidth: number) {\n      self.width = newWidth\n    },\n\n    /**\n     * #action\n     */\n    setMinimized(flag: boolean) {\n      self.minimized = flag\n    },\n  }))\n  .postProcessSnapshot(snap => {\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (!snap) {\n      return snap\n    }\n    const { minimized, ...rest } = snap as Omit<typeof snap, symbol>\n    return {\n      ...rest,\n      ...(minimized ? { minimized } : {}),\n    } as typeof snap\n  })\n\nexport default BaseViewModel\n\n// the base view does not have type but any derived type needs to add type, so\n// just add it here\nexport type IBaseViewModel = Instance<typeof BaseViewModel> & { type: string }\n\nexport const BaseViewModelWithDisplayedRegions = BaseViewModel.props({\n  displayedRegions: types.array(Region),\n})\nexport type IBaseViewModelWithDisplayedRegions = Instance<\n  typeof BaseViewModelWithDisplayedRegions\n>\n","import type React from 'react'\n\nimport PluggableElementBase from '../PluggableElementBase.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type { AnyConfigurationSchemaType } from '../../configuration/index.ts'\nimport type { AnyReactComponentType } from '../../util/index.ts'\nimport type { RpcResult } from '../../util/librpc.ts'\n\nexport type RenderProps = Record<string, unknown>\n\nexport interface RenderResults {\n  reactElement?: React.ReactElement\n  html?: string\n  [key: string]: unknown\n}\n\nexport type RenderReturn = RenderResults | RpcResult\n\nexport default class RendererType extends PluggableElementBase {\n  ReactComponent: AnyReactComponentType\n\n  supportsSVG = true\n\n  configSchema: AnyConfigurationSchemaType\n\n  pluginManager: PluginManager\n\n  constructor(stuff: {\n    name: string\n    ReactComponent: AnyReactComponentType\n    displayName?: string\n    configSchema: AnyConfigurationSchemaType\n    pluginManager: PluginManager\n  }) {\n    super(stuff)\n    this.ReactComponent = stuff.ReactComponent\n    this.configSchema = stuff.configSchema\n    this.pluginManager = stuff.pluginManager\n  }\n\n  async render(props: RenderProps): Promise<RenderReturn> {\n    return {\n      reactElement: <this.ReactComponent {...props} />,\n    }\n  }\n\n  freeResources(_args: any) {}\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport {\n  checkStopToken2,\n  createStopTokenChecker,\n} from '@jbrowse/core/util/stopToken'\nimport { firstValueFrom, toArray } from 'rxjs'\n\nimport { getFeaturesThatPassMinorAlleleFrequencyFilter } from '../shared/minorAlleleFrequencyUtils.ts'\n\nimport type { Source } from '../shared/types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { Region } from '@jbrowse/core/util'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\n\nconst SPLITTER = /[/|]/\n\nexport async function getGenotypeMatrix({\n  pluginManager,\n  args,\n}: {\n  pluginManager: PluginManager\n  args: {\n    adapterConfig: AnyConfigurationModel\n    stopToken?: StopToken\n    sessionId: string\n    headers?: Record<string, string>\n    regions: Region[]\n    sources: Source[]\n    bpPerPx: number\n    minorAlleleFrequencyFilter: number\n    lengthCutoffFilter: number\n  }\n}) {\n  const {\n    sources,\n    minorAlleleFrequencyFilter,\n    regions,\n    adapterConfig,\n    sessionId,\n    lengthCutoffFilter,\n    stopToken,\n  } = args\n  const lastCheck = createStopTokenChecker(stopToken)\n  const adapter = await getAdapter(pluginManager, sessionId, adapterConfig)\n  const dataAdapter = adapter.dataAdapter as BaseFeatureDataAdapter\n\n  const rows = Object.fromEntries(sources.map(s => [s.name, [] as number[]]))\n  const splitCache = {} as Record<string, string[]>\n\n  const mafs = getFeaturesThatPassMinorAlleleFrequencyFilter({\n    minorAlleleFrequencyFilter,\n    lengthCutoffFilter,\n    lastCheck,\n    splitCache,\n    features: await firstValueFrom(\n      dataAdapter.getFeaturesInMultipleRegions(regions, args).pipe(toArray()),\n    ),\n  })\n  for (const { feature } of mafs) {\n    const genotypes = feature.get('genotypes') as Record<string, string>\n    for (const { name } of sources) {\n      const val = genotypes[name]!\n      const alleles = splitCache[val] ?? (splitCache[val] = val.split(SPLITTER))\n\n      let nonRefCount = 0\n      let uncalledCount = 0\n      for (let i = 0, l = alleles.length; i < l; i++) {\n        const allele = alleles[i]!\n        if (allele === '.') {\n          uncalledCount++\n        } else if (allele !== '0') {\n          nonRefCount++\n        }\n      }\n\n      const genotypeStatus =\n        uncalledCount === alleles.length\n          ? -1\n          : nonRefCount === 0\n            ? 0\n            : nonRefCount === alleles.length\n              ? 2\n              : 1\n\n      rows[name]!.push(genotypeStatus)\n    }\n    checkStopToken2(lastCheck)\n  }\n  return rows\n}\n","import type React from 'react'\n\nimport PluggableElementBase from './PluggableElementBase.ts'\n\nimport type DisplayType from './DisplayType.ts'\nimport type { IAnyModelType, IAnyStateTreeNode } from '@jbrowse/mobx-state-tree'\n\ntype BasicView = React.ComponentType<{\n  // TODO: can we use AbstractViewModel here?\n\n  model: any\n  session?: IAnyStateTreeNode\n}>\n\ntype ViewComponentType = React.LazyExoticComponent<BasicView> | BasicView\n\ninterface ViewMetadata {\n  hiddenFromGUI?: boolean\n}\n\nexport default class ViewType extends PluggableElementBase {\n  ReactComponent: ViewComponentType\n\n  stateModel: IAnyModelType\n\n  displayTypes: DisplayType[] = []\n\n  viewMetadata: ViewMetadata = {}\n\n  // extendedName can be used for when you extend a given view type, and want\n  // to register all of that view types displays to yourself\n  //\n  // e.g. you create a linear-genome-view subtype, and want all the tracks that\n  // are compatible display types for the linear-genome-view to be compatible\n  // with your type also (without this, display types are only registered to a\n  // single view type)\n  extendedName?: string\n\n  constructor(stuff: {\n    name: string\n    displayName?: string\n    stateModel: IAnyModelType\n    extendedName?: string\n    viewMetadata?: ViewMetadata\n    ReactComponent: ViewComponentType\n  }) {\n    super(stuff)\n    this.ReactComponent = stuff.ReactComponent\n    this.viewMetadata = stuff.viewMetadata || {}\n    this.stateModel = stuff.stateModel\n    this.extendedName = stuff.extendedName\n  }\n\n  addDisplayType(display: DisplayType) {\n    this.displayTypes.push(display)\n  }\n}\n","import type { SampleInfo, Source } from './types.ts'\n\nfunction makeHaplotypeSources(source: Source, ploidy: number): Source[] {\n  const results: Source[] = []\n  for (let i = 0; i < ploidy; i++) {\n    const name = `${source.name} HP${i}`\n    results.push({ ...source, name, baseName: source.name, HP: i })\n  }\n  return results\n}\n\nexport function expandSourcesToHaplotypes({\n  sources,\n  sampleInfo,\n}: {\n  sources: Source[]\n  sampleInfo: Record<string, SampleInfo>\n}) {\n  return sources.flatMap(source => {\n    const ploidy = sampleInfo[source.name]?.maxPloidy ?? 2\n    return makeHaplotypeSources(source, ploidy)\n  })\n}\n\nexport function getSources({\n  sources,\n  layout = sources,\n  renderingMode,\n  sampleInfo,\n}: {\n  sources: Source[]\n  layout?: Source[]\n  renderingMode: string\n  sampleInfo?: Record<string, SampleInfo>\n}) {\n  const sourceMap = Object.fromEntries(sources.map(s => [s.name, s]))\n\n  return layout.flatMap(row => {\n    const sampleName = row.baseName ?? row.name\n    const baseSource = sourceMap[sampleName]\n\n    if (!baseSource) {\n      return []\n    }\n\n    const merged = { ...baseSource, ...row }\n\n    if (renderingMode === 'phased') {\n      if (row.HP !== undefined) {\n        // already a haplotype entry (from haplotype clustering)\n        return [{ ...merged, baseName: sampleName }]\n      }\n      // expand sample to haplotypes\n      const ploidy = sampleInfo?.[row.name]?.maxPloidy\n      if (ploidy) {\n        return makeHaplotypeSources(merged, ploidy)\n      }\n      return []\n    }\n    // non-phased mode\n    return [merged]\n  })\n}\n","import idMaker from '../util/idMaker.ts'\n\nexport function adapterConfigCacheKey(conf: Record<string, unknown> = {}) {\n  return `${idMaker(conf)}`\n}\n","import { type Observable, firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { max, min, sum } from '../../util/index.ts'\nimport { rectifyStats } from '../../util/stats.ts'\n\nimport type { BaseOptions } from './BaseOptions.ts'\nimport type { FeatureDensityStats } from './types.ts'\nimport type { Feature } from '../../util/simpleFeature.ts'\nimport type { RectifiedQuantitativeStats } from '../../util/stats.ts'\nimport type { AugmentedRegion as Region } from '../../util/types/index.ts'\n\nconst DENSITY_SAMPLE_INITIAL_INTERVAL = 1000\nconst DENSITY_SAMPLE_MIN_FEATURES = 70\nconst DENSITY_SAMPLE_TIMEOUT_MS = 5000\n\nexport function aggregateQuantitativeStats(\n  stats: RectifiedQuantitativeStats[],\n) {\n  return rectifyStats({\n    scoreMax: max(stats.map(s => s.scoreMax)),\n    scoreMin: min(stats.map(s => s.scoreMin)),\n    scoreSum: sum(stats.map(s => s.scoreSum)),\n    scoreSumSquares: sum(stats.map(s => s.scoreSumSquares)),\n    featureCount: sum(stats.map(s => s.featureCount)),\n    basesCovered: sum(stats.map(s => s.basesCovered)),\n  })\n}\n\nexport function sampleFeaturesForInterval(\n  region: Region,\n  interval: number,\n  getFeatures: (region: Region, opts?: BaseOptions) => Observable<Feature>,\n  opts?: BaseOptions,\n) {\n  const { start, end } = region\n  const sampleCenter = start * 0.75 + end * 0.25\n  return firstValueFrom(\n    getFeatures(\n      {\n        ...region,\n        start: Math.max(0, Math.round(sampleCenter - interval / 2)),\n        end: Math.min(Math.round(sampleCenter + interval / 2), end),\n      },\n      opts,\n    ).pipe(toArray()),\n  )\n}\n\nexport async function calculateFeatureDensityStats(\n  region: Region,\n  getFeatures: (region: Region, opts?: BaseOptions) => Observable<Feature>,\n  opts?: BaseOptions,\n): Promise<FeatureDensityStats> {\n  const refLen = region.end - region.start\n  let interval = DENSITY_SAMPLE_INITIAL_INTERVAL\n  let expansionTime = 0\n  let lastTime = performance.now()\n\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  while (true) {\n    const features = await sampleFeaturesForInterval(\n      region,\n      interval,\n      getFeatures,\n      opts,\n    )\n    const featureCount = features.length\n\n    if (featureCount >= DENSITY_SAMPLE_MIN_FEATURES || interval * 2 > refLen) {\n      return { featureDensity: featureCount / interval }\n    }\n\n    if (expansionTime > DENSITY_SAMPLE_TIMEOUT_MS) {\n      console.warn(\n        \"Stats estimation reached timeout, or didn't get enough features\",\n      )\n      return { featureDensity: Number.POSITIVE_INFINITY }\n    }\n\n    const currTime = performance.now()\n    expansionTime += currTime - lastTime\n    lastTime = currTime\n    interval *= 2\n  }\n}\n\nexport { blankStats } from '../../util/stats.ts'\n","import { getFillProps, getStrokeProps } from '@jbrowse/core/util'\nimport { alpha, useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { HEADER_BAR_HEIGHT } from '../consts.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\nconst OverviewScalebarPolygon = observer(function OverviewScalebarPolygon({\n  model,\n  overview,\n  useOffset = true,\n}: {\n  model: LinearGenomeViewModel\n  overview: Base1DViewModel\n  useOffset?: boolean\n}) {\n  const theme = useTheme()\n  const polygonColor = theme.palette.tertiary.light\n  const multiplier = Number(useOffset)\n\n  const { interRegionPaddingWidth, offsetPx, dynamicBlocks, cytobandOffset } =\n    model\n  const { contentBlocks, totalWidthPxWithoutBorders } = dynamicBlocks\n\n  if (!contentBlocks.length) {\n    return null\n  }\n\n  const first = contentBlocks.at(0)!\n  const last = contentBlocks.at(-1)!\n  const topLeft =\n    (overview.bpToPx({\n      refName: first.refName,\n      coord: first.reversed ? first.end : first.start,\n    }) || 0) +\n    cytobandOffset * multiplier\n  const topRight =\n    (overview.bpToPx({\n      refName: last.refName,\n      coord: last.reversed ? last.start : last.end,\n    }) || 0) +\n    cytobandOffset * multiplier\n\n  const startPx = Math.max(0, -offsetPx)\n  const endPx =\n    startPx +\n    totalWidthPxWithoutBorders +\n    (contentBlocks.length * interRegionPaddingWidth) / 2\n\n  const points = [\n    [startPx, HEADER_BAR_HEIGHT],\n    [endPx, HEADER_BAR_HEIGHT],\n    [topRight, 0],\n    [topLeft, 0],\n  ]\n\n  return (\n    <polygon\n      points={points.toString()}\n      {...getFillProps(alpha(polygonColor, 0.3))}\n      {...getStrokeProps(alpha(polygonColor, 0.8))}\n    />\n  )\n})\n\nexport default OverviewScalebarPolygon\n","/**\n * fast low-level intersection of 2 coordinate ranges. assumes interbase coordinates.\n *\n * assumes `left <= right` for both ranges\n *\n * @returns array of [left, right], or [] if the ranges do not intersect. the choice of [] is because it allows destructuring array assignment without check for undefined return\n */\nexport function intersection2(\n  left1: number,\n  right1: number,\n  left2: number,\n  right2: number,\n): [number, number] | [] {\n  // this code is verbose because \"if\" statements are faster than Math.min and Math.max\n  if (right1 > left2 && left1 < right2 && right2 - left2 && right1 - left1) {\n    if (left1 > left2) {\n      if (right1 < right2) {\n        // 1     |-------|\n        //     |------------|\n        return [left1, right1]\n      }\n      // 2         |----|\n      //      |------|\n      return [left1, right2]\n    }\n    if (right1 < right2) {\n      // 3  |-----|\n      //       |------|\n      return [left2, right1]\n    }\n    // 4     |------------|\n    //         |-------|\n    return [left2, right2]\n  }\n  return []\n}\n\n/**\n * Return whether 2 interbase coordinate ranges intersect.\n *\n * @param left1 -\n * @param right1 -\n * @param left2 -\n * @param right2 -\n *\n * @returns true if the two ranges intersect\n */\nexport function doesIntersect2(\n  left1: number,\n  right1: number,\n  left2: number,\n  right2: number,\n) {\n  return right1 > left2 && left1 < right2\n}\n\n/**\n * Return whether the first region is completely contained within the second region\n *\n * @param left1 - candidate inner region left\n * @param right1 - candidate inner region right\n * @param left2 - candidate outer region left\n * @param right2 - candidate outer region right\n */\nexport function isContainedWithin(\n  left1: number,\n  right1: number,\n  left2: number,\n  right2: number,\n) {\n  return left2 <= left1 && right2 >= right1\n}\n","import uFuzzy from '@leeoniya/ufuzzy'\n\nimport { readConfObject } from '../configuration/index.ts'\nimport QuickLRU from '../util/QuickLRU/index.ts'\n\nimport type BaseResult from './BaseResults.ts'\nimport type PluginManager from '../PluginManager.ts'\nimport type { AnyConfigurationModel } from '../configuration/index.ts'\nimport type {\n  BaseTextSearchAdapter,\n  BaseTextSearchArgs,\n} from '../data_adapters/BaseAdapter/index.ts'\n\nexport interface SearchScope {\n  includeAggregateIndexes: boolean\n  assemblyName: string\n  tracks?: string[]\n}\n\nexport default class TextSearchManager {\n  adapterCache = new QuickLRU<string, BaseTextSearchAdapter>({\n    maxSize: 15,\n  })\n\n  constructor(public pluginManager: PluginManager) {}\n\n  loadTextSearchAdapters(searchScope: SearchScope) {\n    return Promise.all(\n      this.relevantAdapters(searchScope).map(async conf => {\n        const adapterId = readConfObject(conf, 'textSearchAdapterId')\n        const r = this.adapterCache.get(adapterId)\n        if (r) {\n          return r\n        } else {\n          const adapterType = this.pluginManager.getTextSearchAdapterType(\n            conf.type,\n          )!\n          const AdapterClass = await adapterType.getAdapterClass()\n          const adapterInstance = new AdapterClass(\n            conf,\n            undefined,\n            this.pluginManager,\n          ) as BaseTextSearchAdapter\n          this.adapterCache.set(adapterId, adapterInstance)\n          return adapterInstance\n        }\n      }),\n    )\n  }\n\n  relevantAdapters(searchScope: SearchScope) {\n    const rootModel = this.pluginManager.rootModel\n    const { aggregateTextSearchAdapters } = rootModel?.jbrowse as {\n      aggregateTextSearchAdapters: AnyConfigurationModel[]\n    }\n    const { tracks } = rootModel?.session as {\n      tracks: AnyConfigurationModel[]\n    }\n\n    const { assemblyName } = searchScope\n\n    return [\n      ...this.getAdaptersWithAssembly(\n        assemblyName,\n        aggregateTextSearchAdapters,\n      ),\n      ...this.getTrackAdaptersWithAssembly(assemblyName, tracks),\n    ]\n  }\n\n  getAdaptersWithAssembly(\n    assemblyName: string,\n    confs: AnyConfigurationModel[],\n  ) {\n    return confs.filter(c =>\n      readConfObject(c, 'assemblyNames')?.includes(assemblyName),\n    )\n  }\n\n  getTrackAdaptersWithAssembly(\n    assemblyName: string,\n    confs: AnyConfigurationModel[],\n  ) {\n    return confs\n      .filter(conf =>\n        readConfObject(conf, [\n          'textSearching',\n          'textSearchAdapter',\n          'assemblyNames',\n        ])?.includes(assemblyName),\n      )\n      .map(\n        conf => conf.textSearching.textSearchAdapter as AnyConfigurationModel,\n      )\n  }\n\n  /**\n   * legacy API for searching:\n   * Returns list of relevant results given a search query and options\n   */\n  async search(\n    args: BaseTextSearchArgs,\n    searchScope: SearchScope,\n    rankFn: (results: BaseResult[]) => BaseResult[],\n  ) {\n    return this.search2({ args, searchScope, rankFn })\n  }\n\n  /**\n   * modern API for searching:\n   * Returns list of relevant results given a search query and options\n   */\n  async search2({\n    args,\n    searchScope,\n    rankFn,\n  }: {\n    args: BaseTextSearchArgs\n    searchScope: SearchScope\n    rankFn: (results: BaseResult[]) => BaseResult[]\n  }) {\n    const adapters = await this.loadTextSearchAdapters(searchScope)\n    const results = await Promise.all(adapters.map(a => a.searchIndex(args)))\n\n    return this.sortResults2({\n      args,\n      results: results.flat(),\n      rankFn,\n    })\n  }\n\n  /**\n   * Returns array of revelevant and sorted results. Note: renamed to\n   * sortResults2 to accommodate new format\n   *\n   * @param results - array of results from all text search adapters\n   * @param rankFn - function that updates results scores\n   * based on more relevance\n   */\n  sortResults2({\n    results,\n    rankFn,\n    args,\n  }: {\n    results: BaseResult[]\n    args: BaseTextSearchArgs\n    rankFn: (results: BaseResult[]) => BaseResult[]\n  }) {\n    const uf = new uFuzzy({})\n\n    // does fuzzy matching on the 'display string'\n    const haystack = results.map(r => r.getDisplayString())\n\n    // this code sample relatively unmodified from\n    // https://github.com/leeoniya/uFuzzy?tab=readme-ov-file#example\n    const needle = args.queryString\n\n    // false positive, this is not Array.prototype.filter\n    // eslint-disable-next-line unicorn/no-array-method-this-argument\n    const idxs = uf.filter(haystack, needle)\n    const res = []\n\n    // idxs can be null when the needle is non-searchable (has no alpha-numeric chars)\n    if (idxs != null && idxs.length > 0) {\n      const info = uf.info(idxs, haystack, needle)\n\n      // order is a double-indirection array (a re-order of the passed-in idxs)\n      // this allows corresponding info to be grabbed directly by idx, if needed\n      const order = uf.sort(info, haystack, needle)\n\n      // render post-filtered & ordered matches\n      for (const element of order) {\n        // using info.idx here instead of idxs because uf.info() may have\n        // further reduced the initial idxs based on prefix/suffix rules\n        res.push(results[info.idx[element]!]!)\n      }\n    }\n    return rankFn(res)\n  }\n}\n","import { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport default function stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .model('PluginStoreModel', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal('PluginStoreWidget'),\n      /**\n       * #property\n       */\n      filterText: '',\n      /**\n       * #property\n       */\n      view: types.safeReference(\n        pluginManager.pluggableMstType('view', 'stateModel'),\n      ),\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      clearFilterText() {\n        self.filterText = ''\n      },\n      /**\n       * #action\n       */\n      setFilterText(newText: string) {\n        self.filterText = newText\n      },\n    }))\n}\n\nexport type PluginStoreStateModel = ReturnType<typeof stateModelFactory>\nexport type PluginStoreModel = Instance<PluginStoreStateModel>\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('PluginStoreWidget', {})\n\nexport default function PluginStoreWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'PluginStoreWidget',\n      heading: 'Plugin store',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/PluginStoreWidget.tsx')),\n    })\n  })\n}\n","/**\n * Check if an ArrayBuffer has been transferred (detached).\n * Useful for debugging to verify transfers are working.\n */\nexport function isDetachedBuffer(buffer: ArrayBufferLike): boolean {\n  return buffer.byteLength === 0\n}\n\n/**\n * Safely check if a value is an ImageBitmap.\n * Works in both browser and Node.js environments.\n * (Duplicated here to avoid circular dependency with offscreenCanvasPonyfill)\n */\nfunction isImageBitmap(value: unknown): value is ImageBitmap {\n  return typeof ImageBitmap !== 'undefined' && value instanceof ImageBitmap\n}\n\nfunction isArrayBufferLike(value: unknown): value is ArrayBufferLike {\n  return (\n    value !== null &&\n    typeof value === 'object' &&\n    typeof (value as ArrayBufferLike).byteLength === 'number'\n  )\n}\n\n/**\n * Collect transferable objects from a render result for zero-copy transfer.\n * Handles ImageBitmap, ArrayBuffer (flatbush), and other transferables.\n *\n * After transfer, ArrayBuffers become \"detached\" (byteLength = 0) in the sender.\n * This is expected behavior - the data has been moved, not copied.\n */\nexport function collectTransferables(\n  result: Record<string, unknown>,\n): Transferable[] {\n  const transferables: Transferable[] = []\n  const { imageData, flatbush, subfeatureFlatbush } = result\n\n  if (isImageBitmap(imageData)) {\n    transferables.push(imageData)\n  }\n  if (isArrayBufferLike(flatbush)) {\n    if (isDetachedBuffer(flatbush)) {\n      console.warn('flatbush buffer is already detached, cannot transfer')\n    } else {\n      transferables.push(flatbush)\n    }\n  }\n  if (isArrayBufferLike(subfeatureFlatbush)) {\n    if (isDetachedBuffer(subfeatureFlatbush)) {\n      console.warn(\n        'subfeatureFlatbush buffer is already detached, cannot transfer',\n      )\n    } else {\n      transferables.push(subfeatureFlatbush)\n    }\n  }\n  return transferables\n}\n","import { makeStyles } from '../util/tss-react/index.ts'\n\nconst useStyles = makeStyles()(theme => ({\n  bg: {\n    padding: 4,\n    margin: 4,\n    overflow: 'auto',\n    maxHeight: 200,\n    background: theme.palette.mode === 'dark' ? '#833' : '#f88',\n    border: `1px solid ${theme.palette.divider}`,\n  },\n}))\n\nexport default function RedErrorMessageBox({\n  children,\n}: {\n  children: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  return <div className={classes.bg}>{children}</div>\n}\n","import { Suspense, lazy, useState } from 'react'\n\nimport RefreshIcon from '@mui/icons-material/Refresh'\nimport ReportIcon from '@mui/icons-material/Report'\nimport { IconButton, Tooltip } from '@mui/material'\n\nimport RedErrorMessageBox from './RedErrorMessageBox.tsx'\nimport { makeStyles } from '../util/tss-react/index.ts'\n\n// lazies\nconst ErrorMessageStackTraceDialog = lazy(\n  () => import('./ErrorMessageStackTraceDialog.tsx'),\n)\n\nconst useStyles = makeStyles()(theme => ({\n  bg: {\n    background: theme.palette.divider,\n    border: '1px solid black',\n    margin: 20,\n  },\n  iconFloat: {\n    float: 'right',\n    marginLeft: 100,\n  },\n}))\n\nfunction parseError(str: string) {\n  let snapshotError = ''\n  const findStr = 'is not assignable'\n  const idx = str.indexOf(findStr)\n  if (idx !== -1) {\n    const trim = str.slice(0, idx + findStr.length)\n    // best effort to make a better error message than the default\n    // @jbrowse/mobx-state-tree\n\n    // case 1. element has a path\n    const match = /.*at path \"(.*)\" snapshot `(.*)` is not assignable/m.exec(\n      trim,\n    )\n    if (match) {\n      str = `Failed to load element at ${match[1]}...Failed element had snapshot`\n      snapshotError = match[2]!\n    }\n\n    // case 2. element has no path\n    const match2 = /.*snapshot `(.*)` is not assignable/.exec(trim)\n    if (match2) {\n      str = 'Failed to load element...Failed element had snapshot'\n      snapshotError = match2[1]!\n    }\n  }\n  return snapshotError\n}\n\nfunction ErrorButtons({\n  error,\n  onReset,\n}: {\n  error: unknown\n  onReset?: () => void\n}) {\n  const { classes } = useStyles()\n  const [showStack, setShowStack] = useState(false)\n  return (\n    <div className={classes.iconFloat}>\n      {typeof error === 'object' && error && 'stack' in error ? (\n        <Tooltip title=\"Get stack trace\">\n          <IconButton\n            onClick={() => {\n              setShowStack(true)\n            }}\n            color=\"primary\"\n          >\n            <ReportIcon />\n          </IconButton>\n        </Tooltip>\n      ) : null}\n      {onReset ? (\n        <Tooltip title=\"Retry\">\n          <IconButton onClick={onReset} color=\"primary\">\n            <RefreshIcon />\n          </IconButton>\n        </Tooltip>\n      ) : null}\n      {showStack ? (\n        <Suspense fallback={null}>\n          <ErrorMessageStackTraceDialog\n            error={error}\n            onClose={() => {\n              setShowStack(false)\n            }}\n          />\n        </Suspense>\n      ) : null}\n    </div>\n  )\n}\n\nfunction ErrorMessage({\n  error,\n  onReset,\n}: {\n  error: unknown\n  onReset?: () => void\n}) {\n  const { classes } = useStyles()\n  const str = `${error}`\n  const str2 = str.indexOf('expected an instance of')\n  const str3 = str2 !== -1 ? str.slice(0, str2) : str\n  const snapshotError = parseError(str)\n  return (\n    <RedErrorMessageBox>\n      {str3.slice(0, 10000)}\n      <ErrorButtons error={error} onReset={onReset} />\n      {snapshotError ? (\n        <pre className={classes.bg}>\n          {JSON.stringify(JSON.parse(snapshotError), null, 2)}\n        </pre>\n      ) : null}\n    </RedErrorMessageBox>\n  )\n}\n\nexport default ErrorMessage\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport {\n  scaleLinear,\n  scaleLog,\n  scaleQuantize,\n} from '@mui/x-charts-vendor/d3-scale'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport const YSCALEBAR_LABEL_OFFSET = 5\n\n// Default color used by wiggle config schema\nexport const WIGGLE_COLOR_DEFAULT = '#f0f'\n\n/**\n * Determines the appropriate color callback for wiggle plots.\n *\n * Priority:\n * 1. If color is a jexl callback expression, evaluate per feature\n * 2. If color is explicitly set (not default), use static color\n * 3. If defaultColor provided (e.g. 'grey' for line plots), use it\n * 4. Otherwise use bicolor pivot logic (posColor/negColor based on score)\n */\nexport function getColorCallback(\n  config: AnyConfigurationModel,\n  opts?: { defaultColor?: string },\n) {\n  const color = readConfObject(config, 'color')\n  const colorIsCallback = config.color?.isCallback\n  const colorIsDefault = color === WIGGLE_COLOR_DEFAULT\n\n  if (colorIsCallback) {\n    return (feature: Feature) => readConfObject(config, 'color', { feature })\n  }\n  if (!colorIsDefault) {\n    return () => color\n  }\n  if (opts?.defaultColor) {\n    return () => opts.defaultColor!\n  }\n  // Bicolor pivot logic\n  const pivotValue = readConfObject(config, 'bicolorPivotValue')\n  const negColor = readConfObject(config, 'negColor')\n  const posColor = readConfObject(config, 'posColor')\n  return (_feature: Feature, score: number) =>\n    score < pivotValue ? negColor : posColor\n}\n\nexport interface ScaleOpts {\n  domain: number[]\n  range: number[]\n  scaleType: string\n  pivotValue?: number\n  inverted?: boolean\n}\n\n// There was confusion about whether source or name was required, and effort to\n// remove one or the other was thwarted. Adapters like BigWigAdapter, even in\n// the BigWigAdapter configSchema.ts, use a 'source' field though, while the\n// word 'name' still allowed in the config too. To solve, we made name===source\nexport interface Source {\n  baseUri?: string\n  name: string\n  source: string\n  color?: string\n  group?: string\n}\n\n/**\n * produces a d3-scale from arguments. applies a \"nice domain\" adjustment\n *\n * @param object - containing attributes\n *   - domain [min,max]\n *   - range [min,max]\n *   - bounds [min,max]\n *   - scaleType (linear or log)\n *   - pivotValue (number)\n *   - inverted (boolean)\n */\nexport function getScale({\n  domain,\n  range,\n  scaleType,\n  pivotValue,\n  inverted,\n}: ScaleOpts) {\n  let scale:\n    | ReturnType<typeof scaleLinear<number>>\n    | ReturnType<typeof scaleLog<number>>\n    | ReturnType<typeof scaleQuantize<number>>\n  const [min, max] = domain\n  if (min === undefined || max === undefined) {\n    throw new Error('invalid domain')\n  }\n  if (scaleType === 'linear') {\n    scale = scaleLinear()\n  } else if (scaleType === 'log') {\n    scale = scaleLog().base(2)\n  } else if (scaleType === 'quantize') {\n    scale = scaleQuantize()\n  } else {\n    throw new Error('undefined scaleType')\n  }\n  scale.domain(pivotValue !== undefined ? [min, pivotValue, max] : [min, max])\n  scale.nice()\n\n  const [rangeMin, rangeMax] = range\n  if (rangeMin === undefined || rangeMax === undefined) {\n    throw new Error('invalid range')\n  }\n  scale.range(inverted ? range.slice().reverse() : range)\n  return scale\n}\n/**\n * gets the origin for drawing the graph. for linear this is 0, for log this is\n * arbitrarily set to log(1)==0\n *\n * @param scaleType -\n */\nexport function getOrigin(scaleType: string /* , pivot, stats */) {\n  // if (pivot) {\n  //   if (pivot === 'mean') {\n  //     return stats.scoreMean || 0\n  //   }\n  //   if (pivot === 'zero') {\n  //     return 0\n  //   }\n  //   return parseFloat()\n  // }\n  // if (scaleType === 'z_score') {\n  //   return stats.scoreMean || 0\n  // }\n  if (scaleType === 'log') {\n    return 1\n  }\n  return 0\n}\n\n/**\n * produces a \"nice\" domain that actually rounds down to 0 for the min or 0 to\n * the max depending on if all values are positive or negative\n *\n * @param object - containing attributes\n *   - domain [min,max]\n *   - bounds [min,max]\n *   - mean\n *   - stddev\n *   - scaleType (linear or log)\n */\nexport function getNiceDomain({\n  scaleType,\n  domain,\n  bounds,\n}: {\n  scaleType: string\n  domain: readonly [number, number]\n  bounds: readonly [number | undefined, number | undefined]\n}) {\n  const [minScore, maxScore] = bounds\n  let [min, max] = domain\n\n  if (scaleType === 'linear') {\n    if (max < 0) {\n      max = 0\n    }\n    if (min > 0) {\n      min = 0\n    }\n  }\n  if (scaleType === 'log') {\n    // for min>0 and max>1, set log min to 1, which works for most coverage\n    // type tracks. if max is not >1, might be like raw p-values so then it'll\n    // display negative values\n    if (min >= 0 && max > 1) {\n      min = 1\n    }\n  }\n\n  if (minScore !== undefined && minScore !== Number.MIN_VALUE) {\n    min = minScore\n  }\n  if (maxScore !== undefined && maxScore !== Number.MAX_VALUE) {\n    max = maxScore\n  }\n  const getScaleType = (type: string) => {\n    if (type === 'linear') {\n      return scaleLinear()\n    }\n    if (type === 'log') {\n      const scale = scaleLog()\n      scale.base(2)\n      return scale\n    }\n    if (type === 'quantize') {\n      return scaleQuantize()\n    }\n    throw new Error(`undefined scaleType ${type}`)\n  }\n  const scale = getScaleType(scaleType)\n\n  scale.domain([min, max])\n  scale.nice()\n  return scale.domain() as [number, number]\n}\n\nexport function toP(s = 0) {\n  return +s.toPrecision(6)\n}\n\n/**\n * Lightweight feature serialization for wiggle features.\n * Only serializes properties needed for mouse interaction,\n * avoiding the overhead of full toJSON() serialization.\n */\nexport function serializeWiggleFeature(f: {\n  get: (key: string) => unknown\n  id: () => string\n}) {\n  return {\n    uniqueId: f.id(),\n    start: f.get('start'),\n    end: f.get('end'),\n    score: f.get('score'),\n    source: f.get('source'),\n    refName: f.get('refName'),\n    maxScore: f.get('maxScore'),\n    minScore: f.get('minScore'),\n    summary: f.get('summary'),\n  }\n}\n\nexport function round(value: number) {\n  return Math.round(value * 1e5) / 1e5\n}\n\n// Shared constants for wiggle drawing\nexport const WIGGLE_FUDGE_FACTOR = 0.3\nexport const WIGGLE_CLIP_HEIGHT = 2\n\n// Precomputed scale values for fast rendering\nexport interface ScaleValues {\n  niceMin: number\n  niceMax: number\n  height: number\n  linearRatio: number\n  log2: number\n  logMin: number\n  logRatio: number\n  isLog: boolean\n}\n\n// Precompute scale values once for use in hot loops\nexport function getScaleValues(\n  scaleOpts: ScaleOpts,\n  height: number,\n): ScaleValues {\n  const scale = getScale({ ...scaleOpts, range: [0, height] })\n  const domain = scale.domain() as [number, number]\n  const niceMin = domain[0]\n  const niceMax = domain[1]\n  const domainSpan = niceMax - niceMin\n  const isLog = scaleOpts.scaleType === 'log'\n\n  const linearRatio = domainSpan !== 0 ? height / domainSpan : 0\n  const log2 = Math.log(2)\n  const logMin = Math.log(niceMin) / log2\n  const logMax = Math.log(niceMax) / log2\n  const logSpan = logMax - logMin\n  const logRatio = logSpan !== 0 ? height / logSpan : 0\n\n  return {\n    niceMin,\n    niceMax,\n    height,\n    linearRatio,\n    log2,\n    logMin,\n    logRatio,\n    isLog,\n  }\n}\n\n// avoid drawing negative width features for SVG exports\nexport function fillRectCtx(\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  ctx: CanvasRenderingContext2D,\n  color?: string,\n) {\n  if (width < 0) {\n    x += width\n    width = -width\n  }\n  if (height < 0) {\n    y += height\n    height = -height\n  }\n\n  if (color) {\n    ctx.fillStyle = color\n  }\n  ctx.fillRect(x, y, width, height)\n}\n","import { isAlive } from '@jbrowse/mobx-state-tree'\nimport { Button } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport BlockMsg from '../components/BlockMsg.tsx'\n\nimport type { FeatureDensityStats } from '@jbrowse/core/data_adapters/BaseAdapter'\n\nconst TooLargeMessage = observer(function TooLargeMessage({\n  model,\n}: {\n  model: {\n    regionTooLargeReason: string\n    featureDensityStats?: FeatureDensityStats\n    setFeatureDensityStatsLimit: (s?: FeatureDensityStats) => void\n    reload: () => void\n  }\n}) {\n  const { regionTooLargeReason } = model\n  return (\n    <BlockMsg\n      severity=\"warning\"\n      action={\n        <Button\n          onClick={() => {\n            if (isAlive(model)) {\n              model.setFeatureDensityStatsLimit(model.featureDensityStats)\n              model.reload()\n            }\n          }}\n        >\n          Force load\n        </Button>\n      }\n      message={[\n        regionTooLargeReason,\n        'Zoom in to see features or force load (may be slow)',\n      ]\n        .filter(f => !!f)\n        .join('. ')}\n    />\n  )\n})\n\nexport default TooLargeMessage\n","import { getConf } from '@jbrowse/core/configuration'\nimport { getContainingView } from '@jbrowse/core/util'\nimport { addDisposer, isAlive, types } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\n\nimport autorunFeatureDensityStats from './autorunFeatureDensityStats.ts'\nimport { getDisplayStr, getFeatureDensityStatsPre } from './util.ts'\nimport TooLargeMessage from '../components/TooLargeMessage.tsx'\n\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView/index.ts'\nimport type { FeatureDensityStats } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { Region } from '@jbrowse/core/util/types'\n\ntype LGV = LinearGenomeViewModel\n\ntype AutorunSelf = Parameters<typeof autorunFeatureDensityStats>[0]\ntype FeatureDensityStatsSelf = Parameters<typeof getFeatureDensityStatsPre>[0]\n\n/**\n * #stateModel FeatureDensityMixin\n * #category display\n */\nexport default function FeatureDensityMixin() {\n  return types\n    .model({\n      /**\n       * #property\n       */\n      userBpPerPxLimit: types.maybe(types.number),\n      /**\n       * #property\n       */\n\n      userByteSizeLimit: types.maybe(types.number),\n    })\n    .volatile(() => ({\n      featureDensityStatsP: undefined as\n        | undefined\n        | Promise<FeatureDensityStats>,\n      featureDensityStats: undefined as undefined | FeatureDensityStats,\n      currStatsBpPerPx: 0,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get currentBytesRequested() {\n        return self.featureDensityStats?.bytes || 0\n      },\n\n      /**\n       * #getter\n       */\n      get currentFeatureScreenDensity() {\n        const view = getContainingView(self) as LGV\n        return (self.featureDensityStats?.featureDensity || 0) * view.bpPerPx\n      },\n\n      /**\n       * #getter\n       */\n      get maxFeatureScreenDensity() {\n        // @ts-expect-error\n        return getConf(self, 'maxFeatureScreenDensity')\n      },\n      /**\n       * #getter\n       */\n      get featureDensityStatsReady() {\n        const view = getContainingView(self) as LGV\n        return (\n          self.currStatsBpPerPx === view.bpPerPx &&\n          (!!self.featureDensityStats || !!self.userBpPerPxLimit)\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get maxAllowableBytes() {\n        return (\n          self.userByteSizeLimit ||\n          self.featureDensityStats?.fetchSizeLimit ||\n          // @ts-expect-error\n          (getConf(self, 'fetchSizeLimit') as number)\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(() =>\n            autorunFeatureDensityStats(self as unknown as AutorunSelf),\n          ),\n        )\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setCurrStatsBpPerPx(n: number) {\n        self.currStatsBpPerPx = n\n      },\n      /**\n       * #action\n       */\n      setFeatureDensityStatsLimit(stats?: FeatureDensityStats) {\n        const view = getContainingView(self) as LGV\n        if (stats?.bytes) {\n          self.userByteSizeLimit = stats.bytes\n        } else {\n          self.userBpPerPxLimit = view.bpPerPx\n        }\n      },\n      /**\n       * #action\n       */\n      getFeatureDensityStats() {\n        if (!self.featureDensityStatsP) {\n          self.featureDensityStatsP = getFeatureDensityStatsPre(\n            self as unknown as FeatureDensityStatsSelf,\n          ).catch((e: unknown) => {\n            if (isAlive(self)) {\n              this.setFeatureDensityStatsP(undefined)\n            }\n            throw e\n          })\n        }\n        return self.featureDensityStatsP\n      },\n\n      /**\n       * #action\n       */\n      setFeatureDensityStatsP(arg: any) {\n        self.featureDensityStatsP = arg\n      },\n\n      /**\n       * #action\n       */\n      setFeatureDensityStats(featureDensityStats?: FeatureDensityStats) {\n        self.featureDensityStats = featureDensityStats\n      },\n      /**\n       * #action\n       */\n      clearFeatureDensityStats() {\n        self.featureDensityStatsP = undefined\n        self.featureDensityStats = undefined\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * region is too large if:\n       * - stats are ready\n       * - region is greater than 20kb (don't warn when zoomed in less than that)\n       * - and bytes is greater than max allowed bytes or density greater than max\n       *   density\n       */\n      get regionTooLarge() {\n        const view = getContainingView(self) as LGV\n        if (\n          !self.featureDensityStatsReady ||\n          view.dynamicBlocks.totalBp < 20_000\n        ) {\n          return false\n        }\n        return (\n          self.currentBytesRequested > self.maxAllowableBytes ||\n          (self.userBpPerPxLimit\n            ? view.bpPerPx > self.userBpPerPxLimit\n            : self.currentFeatureScreenDensity > self.maxFeatureScreenDensity)\n        )\n      },\n\n      /**\n       * #getter\n       * only shows a message of bytes requested is defined, the feature density\n       * based stats don't produce any helpful message besides to zoom in\n       */\n      get regionTooLargeReason() {\n        const req = self.currentBytesRequested\n        const max = self.maxAllowableBytes\n\n        return req && req > max\n          ? `Requested too much data (${getDisplayStr(req)})`\n          : ''\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get featureDensityStatsReadyAndRegionNotTooLarge() {\n        return self.featureDensityStatsReady && !self.regionTooLarge\n      },\n      /**\n       * #method\n       */\n      regionCannotBeRenderedText(_region: Region) {\n        return self.regionTooLarge ? 'Force load to see features' : ''\n      },\n\n      /**\n       * #method\n       * @param region -\n       * @returns falsy if the region is fine to try rendering. Otherwise,\n       *  return a react node + string of text.\n       *  string of text describes why it cannot be rendered\n       *  react node allows user to force load at current setting\n       */\n      regionCannotBeRendered(_region: Region) {\n        // @ts-expect-error\n        return self.regionTooLarge ? <TooLargeMessage model={self} /> : null\n      },\n    }))\n}\n","import { getContainingView, isAbortException } from '@jbrowse/core/util'\nimport { isAlive } from '@jbrowse/mobx-state-tree'\n\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView/index.ts'\nimport type { BaseLinearDisplayModel } from '../model.ts'\n\n// stats estimation autorun calls getFeatureDensityStats against the data\n// adapter which by default uses featureDensity, but can also respond with a\n// byte size estimate and fetch size limit (data adapter can define what is too\n// much data)\nexport default async function autorunFeatureDensityStats(\n  self: BaseLinearDisplayModel,\n) {\n  try {\n    const view = getContainingView(self) as LinearGenomeViewModel\n\n    // extra check for contentBlocks.length\n    // https://github.com/GMOD/jbrowse-components/issues/2694\n    if (\n      !view.initialized ||\n      !view.staticBlocks.contentBlocks.length ||\n      view.bpPerPx === self.currStatsBpPerPx ||\n      self.error\n    ) {\n      return\n    }\n\n    // don't re-estimate featureDensity even if zoom level changes,\n    // jbrowse 1-style assume it's sort of representative\n    if (self.featureDensityStats?.featureDensity !== undefined) {\n      self.setCurrStatsBpPerPx(view.bpPerPx)\n      return\n    }\n\n    self.clearFeatureDensityStats()\n    self.setCurrStatsBpPerPx(view.bpPerPx)\n    const stats = await self.getFeatureDensityStats()\n    if (isAlive(self)) {\n      self.setFeatureDensityStats(stats)\n    }\n  } catch (e) {\n    console.error(e)\n    if (isAlive(self) && !isAbortException(e)) {\n      self.setError(e)\n    }\n  }\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport { nanoid } from '../nanoid.ts'\n\nexport function createElementId() {\n  return nanoid(10)\n}\n\nexport const ElementId = types.optional(types.identifier, createElementId)\n","import { useCallback, useEffect, useRef, useState } from 'react'\n\nimport { cx, makeStyles } from '../util/tss-react/index.ts'\n\nconst useStyles = makeStyles()({\n  horizontalHandle: {\n    cursor: 'row-resize',\n    width: '100%',\n  },\n  verticalHandle: {\n    cursor: 'col-resize',\n    height: '100%',\n  },\n  flexbox_verticalHandle: {\n    cursor: 'col-resize',\n    alignSelf: 'stretch', // the height: 100% is actually unable to function inside flexbox\n  },\n  flexbox_horizontalHandle: {\n    cursor: 'row-resize',\n    alignSelf: 'stretch', // similar to above\n  },\n})\n\nfunction ResizeHandle({\n  onDrag,\n  vertical = false,\n  flexbox = false,\n  className: originalClassName,\n  onMouseDown,\n  ...props\n}: {\n  onDrag: (\n    lastFrameDistance: number,\n    totalDistance: number,\n  ) => number | undefined\n  onMouseDown?: (event: React.MouseEvent) => void\n  vertical?: boolean\n  flexbox?: boolean\n  className?: string\n  [props: string]: unknown\n}) {\n  const [mouseDragging, setMouseDragging] = useState(false)\n  const initialPosition = useRef(0)\n  const prevPos = useRef(0)\n  const { classes } = useStyles()\n\n  const getPosition = useCallback(\n    (event: MouseEvent | React.MouseEvent) =>\n      vertical ? event.clientX : event.clientY,\n    [vertical],\n  )\n\n  useEffect(() => {\n    if (!mouseDragging) {\n      return\n    }\n\n    function mouseMove(event: MouseEvent) {\n      event.preventDefault()\n      const pos = getPosition(event)\n      const totalDistance = initialPosition.current - pos\n      const lastFrameDistance = pos - prevPos.current\n      prevPos.current = pos\n      onDrag(lastFrameDistance, totalDistance)\n    }\n\n    function mouseUp() {\n      setMouseDragging(false)\n    }\n\n    window.addEventListener('mousemove', mouseMove, true)\n    window.addEventListener('mouseup', mouseUp, true)\n    return () => {\n      window.removeEventListener('mousemove', mouseMove, true)\n      window.removeEventListener('mouseup', mouseUp, true)\n    }\n  }, [mouseDragging, onDrag, getPosition])\n\n  const handleMouseDown = useCallback(\n    (event: React.MouseEvent) => {\n      event.preventDefault()\n      const pos = getPosition(event)\n      initialPosition.current = pos\n      prevPos.current = pos\n      setMouseDragging(true)\n      onMouseDown?.(event)\n    },\n    [getPosition, onMouseDown],\n  )\n\n  const className = flexbox\n    ? vertical\n      ? classes.flexbox_verticalHandle\n      : classes.flexbox_horizontalHandle\n    : vertical\n      ? classes.verticalHandle\n      : classes.horizontalHandle\n\n  return (\n    <div\n      data-resizer=\"true\"\n      onMouseDown={handleMouseDown}\n      className={cx(originalClassName, className)}\n      {...props}\n    />\n  )\n}\n\nexport default ResizeHandle\n","/* eslint-disable react-refresh/only-export-components */\n\nimport { isValidElement } from 'react'\n\nexport { renderToAbstractCanvas } from './renderToAbstractCanvas.ts'\n\nexport function ReactRendering({\n  rendering,\n}: {\n  rendering: {\n    reactElement?: React.ReactNode\n    html?: string\n  }\n}) {\n  return isValidElement(rendering.reactElement) ? (\n    rendering.reactElement\n  ) : (\n    <g dangerouslySetInnerHTML={{ __html: rendering.html || '' }} />\n  )\n}\n\nexport { getSerializedSvg } from './offscreenCanvasGetSerializingSvg.ts'\n\n/**\n * Converts a rendering result with canvasRecordedData to one with html.\n * If the rendering already has html or doesn't have canvasRecordedData,\n * it returns the original rendering unchanged.\n */\nexport async function renderingToSvg<\n  T extends { canvasRecordedData?: unknown; html?: string },\n>(rendering: T, width: number, height: number): Promise<T> {\n  if (rendering.canvasRecordedData && !rendering.html) {\n    const { getSerializedSvg } =\n      await import('./offscreenCanvasGetSerializingSvg.ts')\n    const html = await getSerializedSvg({\n      width,\n      height,\n      canvasRecordedData: rendering.canvasRecordedData,\n    })\n    return { ...rendering, html }\n  }\n  return rendering\n}\n","import { Tooltip } from '@mui/material'\n\nexport default function RubberbandTooltip({\n  anchorEl,\n  side,\n  text,\n}: {\n  anchorEl: HTMLSpanElement\n  side: string\n  text: React.ReactNode\n}) {\n  return (\n    <Tooltip\n      title={text}\n      open\n      placement={side === 'left' ? 'left-start' : 'right-start'}\n      slotProps={{\n        popper: {\n          anchorEl,\n          modifiers: [\n            {\n              name: 'offset',\n              options: {\n                // first number is y-offset (which docs refer to as skid),\n                // second number is x-offset (which docs refer to as distance)\n                offset: [-30, -10],\n              },\n            },\n          ],\n        },\n      }}\n    >\n      <span></span>\n    </Tooltip>\n  )\n}\n","import { useState } from 'react'\n\nimport { getBpDisplayStr, stringify } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Typography, alpha } from '@mui/material'\n\nimport RubberbandTooltip from './RubberbandTooltip.tsx'\n\nconst useStyles = makeStyles()(theme => {\n  const { tertiary } = theme.palette\n  const background = alpha(tertiary.light, 0.7)\n  return {\n    rubberband: {\n      height: '100%',\n      background,\n      position: 'absolute',\n      left: 0,\n      zIndex: 830,\n      textAlign: 'center',\n      cursor: 'crosshair',\n    },\n\n    rubberbandText: {\n      color: theme.palette.tertiary.contrastText,\n    },\n  }\n})\n\ninterface Offset {\n  coord: number\n  refName?: string\n  oob?: boolean\n}\n\nexport default function RubberbandSpan({\n  leftBpOffset,\n  rightBpOffset,\n  numOfBpSelected,\n  left,\n  width,\n  top = 0,\n  sticky = false,\n}: {\n  leftBpOffset: Offset\n  rightBpOffset: Offset\n  numOfBpSelected?: number\n  left: number\n  width: number\n  top?: number\n  sticky?: boolean\n}) {\n  const { classes } = useStyles()\n  const [anchorEl, setAnchorEl] = useState<HTMLSpanElement | null>(null)\n\n  return (\n    <>\n      {anchorEl ? (\n        <>\n          <RubberbandTooltip\n            side=\"left\"\n            anchorEl={anchorEl}\n            text={stringify(leftBpOffset)}\n          />\n          <RubberbandTooltip\n            side=\"right\"\n            anchorEl={anchorEl}\n            text={stringify(rightBpOffset)}\n          />\n        </>\n      ) : null}\n      <div\n        className={classes.rubberband}\n        style={{ transform: `translateX(${left}px)`, width }}\n      >\n        {numOfBpSelected ? (\n          <Typography\n            ref={setAnchorEl}\n            variant=\"h6\"\n            className={classes.rubberbandText}\n            style={{\n              top,\n              position: sticky ? 'sticky' : undefined,\n            }}\n          >\n            {getBpDisplayStr(numOfBpSelected)}\n          </Typography>\n        ) : null}\n      </div>\n    </>\n  )\n}\n","import { Suspense, forwardRef } from 'react'\n\nexport function lazyifyComponent(key: string, ReactComponent: any) {\n  const Component = forwardRef((props: any, ref) => (\n    <Suspense fallback={null}>\n      <ReactComponent {...props} ref={ref} />\n    </Suspense>\n  ))\n  Component.displayName = key\n  return [key, Component]\n}\n\nexport function lazyMap(obj: Record<string, React.FC<any>>, prefix = '') {\n  return Object.fromEntries(\n    Object.entries(obj).map(([key, ReactComponent]) =>\n      lazyifyComponent(`${prefix}${key}`, ReactComponent),\n    ),\n  )\n}\n","import { lazy } from 'react'\n\nimport { lazyMap } from './lazify.tsx'\n\nexport const BaseFeatureDetail = lazyMap(\n  {\n    Attributes: lazy(\n      () => import('../BaseFeatureWidget/BaseFeatureDetail/Attributes.tsx'),\n    ),\n    FeatureDetails: lazy(\n      () => import('../BaseFeatureWidget/BaseFeatureDetail/FeatureDetails.tsx'),\n    ),\n    BaseCard: lazy(\n      () => import('../BaseFeatureWidget/BaseFeatureDetail/BaseCard.tsx'),\n    ),\n    BaseAttributes: lazy(\n      () => import('../BaseFeatureWidget/BaseFeatureDetail/BaseAttributes.tsx'),\n    ),\n    BaseCoreDetails: lazy(\n      () =>\n        import('../BaseFeatureWidget/BaseFeatureDetail/BaseCoreDetails.tsx'),\n    ),\n  },\n  '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail/',\n)\n","import { type LazyExoticComponent, lazy } from 'react'\n\nexport const DataGridEntries: Record<string, LazyExoticComponent<any>> = {\n  DataGrid: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({ default: module.DataGrid })),\n  ),\n  GridActionsCellItem: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridActionsCellItem,\n    })),\n  ),\n  GridAddIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridAddIcon,\n    })),\n  ),\n  GridArrowDownwardIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridArrowDownwardIcon,\n    })),\n  ),\n  GridArrowUpwardIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridArrowUpwardIcon,\n    })),\n  ),\n  GridCellCheckboxForwardRef: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridCellCheckboxForwardRef,\n    })),\n  ),\n  GridCellCheckboxRenderer: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridCellCheckboxRenderer,\n    })),\n  ),\n  GridCheckCircleIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridCheckCircleIcon,\n    })),\n  ),\n  GridCheckIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridCheckIcon,\n    })),\n  ),\n  GridCloseIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridCloseIcon,\n    })),\n  ),\n  GridColumnHeaderSeparator: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridColumnHeaderSeparator,\n    })),\n  ),\n  GridColumnHeaderSortIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridColumnHeaderSortIcon,\n    })),\n  ),\n  GridColumnIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridColumnIcon,\n    })),\n  ),\n  GridColumnMenu: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridColumnMenu,\n    })),\n  ),\n  GridColumnMenuContainer: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridColumnMenuContainer,\n    })),\n  ),\n  GridDragIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridDragIcon,\n    })),\n  ),\n  GridExpandMoreIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridExpandMoreIcon,\n    })),\n  ),\n  GridFilterAltIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridFilterAltIcon,\n    })),\n  ),\n  GridFilterForm: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridFilterForm,\n    })),\n  ),\n  GridFilterListIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridFilterListIcon,\n    })),\n  ),\n  GridFilterPanel: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridFilterPanel,\n    })),\n  ),\n  GridFooter: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({ default: module.GridFooter })),\n  ),\n  GridFooterContainer: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridFooterContainer,\n    })),\n  ),\n  GridHeader: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({ default: module.GridHeader })),\n  ),\n  GridHeaderCheckbox: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridHeaderCheckbox,\n    })),\n  ),\n  GridKeyboardArrowRight: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridKeyboardArrowRight,\n    })),\n  ),\n  GridLoadIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridLoadIcon,\n    })),\n  ),\n  GridLoadingOverlay: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridLoadingOverlay,\n    })),\n  ),\n  GridMenuIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridMenuIcon,\n    })),\n  ),\n  GridMoreVertIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridMoreVertIcon,\n    })),\n  ),\n  GridNoRowsOverlay: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridNoRowsOverlay,\n    })),\n  ),\n  GridOverlay: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridOverlay,\n    })),\n  ),\n  GridPagination: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridPagination,\n    })),\n  ),\n  GridPanel: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({ default: module.GridPanel })),\n  ),\n  GridPanelWrapper: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridPanelWrapper,\n    })),\n  ),\n  GridRemoveIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridRemoveIcon,\n    })),\n  ),\n  GridRoot: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({ default: module.GridRoot })),\n  ),\n  GridRowCount: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridRowCount,\n    })),\n  ),\n  GridSearchIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridSearchIcon,\n    })),\n  ),\n  GridSelectedRowCount: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridSelectedRowCount,\n    })),\n  ),\n  GridSeparatorIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridSeparatorIcon,\n    })),\n  ),\n  GridTableRowsIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridTableRowsIcon,\n    })),\n  ),\n  GridToolbarExportContainer: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridToolbarExportContainer,\n    })),\n  ),\n\n  GridTripleDotsVerticalIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridTripleDotsVerticalIcon,\n    })),\n  ),\n  GridViewHeadlineIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridViewHeadlineIcon,\n    })),\n  ),\n  GridViewStreamIcon: lazy(() =>\n    import('@mui/x-data-grid').then(module => ({\n      default: module.GridViewStreamIcon,\n    })),\n  ),\n}\n","import { lazy } from 'react'\n\nexport const Entries = {\n  Accordion: lazy(() => import('@mui/material/Accordion')),\n  AccordionActions: lazy(() => import('@mui/material/AccordionActions')),\n  AccordionDetails: lazy(() => import('@mui/material/AccordionDetails')),\n  AccordionSummary: lazy(() => import('@mui/material/AccordionSummary')),\n  Alert: lazy(() => import('@mui/material/Alert')),\n  AlertTitle: lazy(() => import('@mui/material/AlertTitle')),\n  Autocomplete: lazy(() => import('@mui/material/Autocomplete')),\n  Avatar: lazy(() => import('@mui/material/Avatar')),\n  AvatarGroup: lazy(() => import('@mui/material/AvatarGroup')),\n  Backdrop: lazy(() => import('@mui/material/Backdrop')),\n  Badge: lazy(() => import('@mui/material/Badge')),\n  Box: lazy(() => import('@mui/material/Box')),\n  Breadcrumbs: lazy(() => import('@mui/material/Breadcrumbs')),\n  Button: lazy(() => import('@mui/material/Button')),\n  ButtonGroup: lazy(() => import('@mui/material/ButtonGroup')),\n  Card: lazy(() => import('@mui/material/Card')),\n  CardActions: lazy(() => import('@mui/material/CardActions')),\n  CardActionArea: lazy(() => import('@mui/material/CardActionArea')),\n  CardContent: lazy(() => import('@mui/material/CardContent')),\n  CardHeader: lazy(() => import('@mui/material/CardHeader')),\n  CardMedia: lazy(() => import('@mui/material/CardMedia')),\n  CircularProgress: lazy(() => import('@mui/material/CircularProgress')),\n  Collapse: lazy(() => import('@mui/material/Collapse')),\n  ClickAwayListener: lazy(() => import('@mui/material/ClickAwayListener')),\n  Chip: lazy(() => import('@mui/material/Chip')),\n  Checkbox: lazy(() => import('@mui/material/Checkbox')),\n  Container: lazy(() => import('@mui/material/Container')),\n  Dialog: lazy(() => import('@mui/material/Dialog')),\n  DialogActions: lazy(() => import('@mui/material/DialogActions')),\n  DialogTitle: lazy(() => import('@mui/material/DialogTitle')),\n  DialogContent: lazy(() => import('@mui/material/DialogContent')),\n  DialogContentText: lazy(() => import('@mui/material/DialogContentText')),\n  Divider: lazy(() => import('@mui/material/Divider')),\n  Drawer: lazy(() => import('@mui/material/Drawer')),\n  Fab: lazy(() => import('@mui/material/Fab')),\n  Fade: lazy(() => import('@mui/material/Fade')),\n  FilledInput: lazy(() => import('@mui/material/FilledInput')),\n  FormLabel: lazy(() => import('@mui/material/FormLabel')),\n  FormControl: lazy(() => import('@mui/material/FormControl')),\n  FormControlLabel: lazy(() => import('@mui/material/FormControlLabel')),\n  FormHelperText: lazy(() => import('@mui/material/FormHelperText')),\n  FormGroup: lazy(() => import('@mui/material/FormGroup')),\n  Grid: lazy(() => import('@mui/material/Grid')),\n  Grid2: lazy(() => import('@mui/material/Grid')),\n  Grow: lazy(() => import('@mui/material/Grow')),\n  Icon: lazy(() => import('@mui/material/Icon')),\n  IconButton: lazy(() => import('@mui/material/IconButton')),\n  Input: lazy(() => import('@mui/material/Input')),\n  InputBase: lazy(() => import('@mui/material/InputBase')),\n  InputLabel: lazy(() => import('@mui/material/InputLabel')),\n  InputAdornment: lazy(() => import('@mui/material/InputAdornment')),\n  Link: lazy(() => import('@mui/material/Link')),\n  LinearProgress: lazy(() => import('@mui/material/LinearProgress')),\n  List: lazy(() => import('@mui/material/List')),\n  ListItem: lazy(() => import('@mui/material/ListItem')),\n  ListItemAvatar: lazy(() => import('@mui/material/ListItemAvatar')),\n  ListItemButton: lazy(() => import('@mui/material/ListItemButton')),\n  ListItemSecondaryAction: lazy(\n    () => import('@mui/material/ListItemSecondaryAction'),\n  ),\n  ListItemIcon: lazy(() => import('@mui/material/ListItemIcon')),\n  ListSubheader: lazy(() => import('@mui/material/ListSubheader')),\n  ListItemText: lazy(() => import('@mui/material/ListItemText')),\n  Menu: lazy(() => import('@mui/material/Menu')),\n  MenuItem: lazy(() => import('@mui/material/MenuItem')),\n  MenuList: lazy(() => import('@mui/material/MenuList')),\n  Modal: lazy(() => import('@mui/material/Modal')),\n  NativeSelect: lazy(() => import('@mui/material/NativeSelect')),\n  OutlinedInput: lazy(() => import('@mui/material/OutlinedInput')),\n  Pagination: lazy(() => import('@mui/material/Pagination')),\n  PaginationItem: lazy(() => import('@mui/material/PaginationItem')),\n  Paper: lazy(() => import('@mui/material/Paper')),\n  Popover: lazy(() => import('@mui/material/Popover')),\n  Popper: lazy(() => import('@mui/material/Popper')),\n  Portal: lazy(() => import('@mui/material/Portal')),\n  Radio: lazy(() => import('@mui/material/Radio')),\n  RadioGroup: lazy(() => import('@mui/material/RadioGroup')),\n  Rating: lazy(() => import('@mui/material/Rating')),\n  ScopedCssBaseline: lazy(() => import('@mui/material/ScopedCssBaseline')),\n  Select: lazy(() => import('@mui/material/Select')),\n  Skeleton: lazy(() => import('@mui/material/Skeleton')),\n  Slider: lazy(() => import('@mui/material/Slider')),\n  Snackbar: lazy(() => import('@mui/material/Snackbar')),\n  SnackbarContent: lazy(() => import('@mui/material/SnackbarContent')),\n  SpeedDial: lazy(() => import('@mui/material/SpeedDial')),\n  SpeedDialAction: lazy(() => import('@mui/material/SpeedDialAction')),\n  SpeedDialIcon: lazy(() => import('@mui/material/SpeedDialIcon')),\n  Stack: lazy(() => import('@mui/material/Stack')),\n  Step: lazy(() => import('@mui/material/Step')),\n  StepButton: lazy(() => import('@mui/material/StepButton')),\n  StepConnector: lazy(() => import('@mui/material/StepConnector')),\n  StepLabel: lazy(() => import('@mui/material/StepLabel')),\n  StepIcon: lazy(() => import('@mui/material/StepIcon')),\n  Stepper: lazy(() => import('@mui/material/Stepper')),\n  SvgIcon: lazy(() => import('@mui/material/SvgIcon')),\n  Switch: lazy(() => import('@mui/material/Switch')),\n  Tab: lazy(() => import('@mui/material/Tab')),\n  Table: lazy(() => import('@mui/material/Table')),\n  TableBody: lazy(() => import('@mui/material/TableBody')),\n  TableCell: lazy(() => import('@mui/material/TableCell')),\n  TableContainer: lazy(() => import('@mui/material/TableContainer')),\n  TableFooter: lazy(() => import('@mui/material/TableFooter')),\n  TableHead: lazy(() => import('@mui/material/TableHead')),\n  TablePagination: lazy(() => import('@mui/material/TablePagination')),\n  TableRow: lazy(() => import('@mui/material/TableRow')),\n  TableSortLabel: lazy(() => import('@mui/material/TableSortLabel')),\n  Tabs: lazy(() => import('@mui/material/Tabs')),\n  TextField: lazy(() => import('@mui/material/TextField')),\n  TextareaAutosize: lazy(() => import('@mui/material/TextareaAutosize')),\n  ToggleButton: lazy(() => import('@mui/material/ToggleButton')),\n  ToggleButtonGroup: lazy(() => import('@mui/material/ToggleButtonGroup')),\n  Toolbar: lazy(() => import('@mui/material/Toolbar')),\n  Tooltip: lazy(() => import('@mui/material/Tooltip')),\n  Typography: lazy(() => import('@mui/material/Typography')),\n}\n","/**\n * Used by plugin build systems to determine if a module is provided by JBrowse\n * globally and thus doesn't need to be bundled. A check in ./modules.tsx makes\n * sure this is in sync with the re-exported modules.\n *\n * Using this instead of just Object.keys(modules) allows this file to be\n * easily used by downstream tooling like simple esbuild scripts, rollup\n * configs, etc. without actually importing all the modules in modules.tsx,\n * which a Object.keys(modules) would do\n */\nexport default [\n  'mobx',\n  '@jbrowse/mobx-state-tree',\n  'mobx-state-tree',\n  'react',\n  'react/jsx-runtime',\n  'react-dom',\n  'react-dom/client',\n  'mobx-react',\n  '@mui/x-data-grid',\n  '@mui/material/utils',\n  '@material-ui/core/utils',\n  'tss-react',\n  'tss-react/mui',\n  '@material-ui/core',\n  '@mui/material',\n\n  '@mui/material/styles',\n  '@material-ui/core/styles',\n  '@material-ui/core/Accordion',\n  '@material-ui/core/AccordionActions',\n  '@material-ui/core/AccordionDetails',\n  '@material-ui/core/AccordionSummary',\n  '@material-ui/core/Alert',\n  '@material-ui/core/AlertTitle',\n  '@material-ui/core/Autocomplete',\n  '@material-ui/core/Avatar',\n  '@material-ui/core/AvatarGroup',\n  '@material-ui/core/Backdrop',\n  '@material-ui/core/Badge',\n  '@material-ui/core/Box',\n  '@material-ui/core/Breadcrumbs',\n  '@material-ui/core/Button',\n  '@material-ui/core/ButtonGroup',\n  '@material-ui/core/Card',\n  '@material-ui/core/CardActions',\n  '@material-ui/core/CardActionArea',\n  '@material-ui/core/CardContent',\n  '@material-ui/core/CardHeader',\n  '@material-ui/core/CardMedia',\n  '@material-ui/core/CircularProgress',\n  '@material-ui/core/Collapse',\n  '@material-ui/core/ClickAwayListener',\n  '@material-ui/core/Chip',\n  '@material-ui/core/Checkbox',\n  '@material-ui/core/Container',\n  '@material-ui/core/Dialog',\n  '@material-ui/core/DialogActions',\n  '@material-ui/core/DialogTitle',\n  '@material-ui/core/DialogContent',\n  '@material-ui/core/DialogContentText',\n  '@material-ui/core/Divider',\n  '@material-ui/core/Drawer',\n  '@material-ui/core/Fab',\n  '@material-ui/core/Fade',\n  '@material-ui/core/FilledInput',\n  '@material-ui/core/FormLabel',\n  '@material-ui/core/FormControl',\n  '@material-ui/core/FormControlLabel',\n  '@material-ui/core/FormHelperText',\n  '@material-ui/core/FormGroup',\n  '@material-ui/core/Grid',\n  '@material-ui/core/Grid2',\n  '@material-ui/core/Grow',\n  '@material-ui/core/Icon',\n  '@material-ui/core/IconButton',\n  '@material-ui/core/Input',\n  '@material-ui/core/InputBase',\n  '@material-ui/core/InputLabel',\n  '@material-ui/core/InputAdornment',\n  '@material-ui/core/Link',\n  '@material-ui/core/LinearProgress',\n  '@material-ui/core/List',\n  '@material-ui/core/ListItem',\n  '@material-ui/core/ListItemAvatar',\n  '@material-ui/core/ListItemButton',\n  '@material-ui/core/ListItemSecondaryAction',\n  '@material-ui/core/ListItemIcon',\n  '@material-ui/core/ListSubheader',\n  '@material-ui/core/ListItemText',\n  '@material-ui/core/Menu',\n  '@material-ui/core/MenuItem',\n  '@material-ui/core/MenuList',\n  '@material-ui/core/Modal',\n  '@material-ui/core/NativeSelect',\n  '@material-ui/core/OutlinedInput',\n  '@material-ui/core/Pagination',\n  '@material-ui/core/PaginationItem',\n  '@material-ui/core/Paper',\n  '@material-ui/core/Popover',\n  '@material-ui/core/Popper',\n  '@material-ui/core/Portal',\n  '@material-ui/core/Radio',\n  '@material-ui/core/RadioGroup',\n  '@material-ui/core/Rating',\n  '@material-ui/core/ScopedCssBaseline',\n  '@material-ui/core/Select',\n  '@material-ui/core/Skeleton',\n  '@material-ui/core/Slider',\n  '@material-ui/core/Snackbar',\n  '@material-ui/core/SnackbarContent',\n  '@material-ui/core/SpeedDial',\n  '@material-ui/core/SpeedDialAction',\n  '@material-ui/core/SpeedDialIcon',\n  '@material-ui/core/Stack',\n  '@material-ui/core/Step',\n  '@material-ui/core/StepButton',\n  '@material-ui/core/StepConnector',\n  '@material-ui/core/StepLabel',\n  '@material-ui/core/StepIcon',\n  '@material-ui/core/Stepper',\n  '@material-ui/core/SvgIcon',\n  '@material-ui/core/Switch',\n  '@material-ui/core/Tab',\n  '@material-ui/core/Table',\n  '@material-ui/core/TableBody',\n  '@material-ui/core/TableCell',\n  '@material-ui/core/TableContainer',\n  '@material-ui/core/TableFooter',\n  '@material-ui/core/TableHead',\n  '@material-ui/core/TablePagination',\n  '@material-ui/core/TableRow',\n  '@material-ui/core/TableSortLabel',\n  '@material-ui/core/Tabs',\n  '@material-ui/core/TextField',\n  '@material-ui/core/TextareaAutosize',\n  '@material-ui/core/ToggleButton',\n  '@material-ui/core/ToggleButtonGroup',\n  '@material-ui/core/Toolbar',\n  '@material-ui/core/Tooltip',\n  '@material-ui/core/Typography',\n\n  '@mui/material/Accordion',\n  '@mui/material/AccordionActions',\n  '@mui/material/AccordionDetails',\n  '@mui/material/AccordionSummary',\n  '@mui/material/Alert',\n  '@mui/material/AlertTitle',\n  '@mui/material/Autocomplete',\n  '@mui/material/Avatar',\n  '@mui/material/AvatarGroup',\n  '@mui/material/Backdrop',\n  '@mui/material/Badge',\n  '@mui/material/Box',\n  '@mui/material/Breadcrumbs',\n  '@mui/material/Button',\n  '@mui/material/ButtonGroup',\n  '@mui/material/Card',\n  '@mui/material/CardActions',\n  '@mui/material/CardActionArea',\n  '@mui/material/CardContent',\n  '@mui/material/CardHeader',\n  '@mui/material/CardMedia',\n  '@mui/material/CircularProgress',\n  '@mui/material/Collapse',\n  '@mui/material/ClickAwayListener',\n  '@mui/material/Chip',\n  '@mui/material/Checkbox',\n  '@mui/material/Container',\n  '@mui/material/Dialog',\n  '@mui/material/DialogActions',\n  '@mui/material/DialogTitle',\n  '@mui/material/DialogContent',\n  '@mui/material/DialogContentText',\n  '@mui/material/Divider',\n  '@mui/material/Drawer',\n  '@mui/material/Fab',\n  '@mui/material/Fade',\n  '@mui/material/FilledInput',\n  '@mui/material/FormLabel',\n  '@mui/material/FormControl',\n  '@mui/material/FormControlLabel',\n  '@mui/material/FormHelperText',\n  '@mui/material/FormGroup',\n  '@mui/material/Grid',\n  '@mui/material/Grid2',\n  '@mui/material/Grow',\n  '@mui/material/Icon',\n  '@mui/material/IconButton',\n  '@mui/material/Input',\n  '@mui/material/InputBase',\n  '@mui/material/InputLabel',\n  '@mui/material/InputAdornment',\n  '@mui/material/Link',\n  '@mui/material/LinearProgress',\n  '@mui/material/List',\n  '@mui/material/ListItem',\n  '@mui/material/ListItemAvatar',\n  '@mui/material/ListItemButton',\n  '@mui/material/ListItemSecondaryAction',\n  '@mui/material/ListItemIcon',\n  '@mui/material/ListSubheader',\n  '@mui/material/ListItemText',\n  '@mui/material/Menu',\n  '@mui/material/MenuItem',\n  '@mui/material/MenuList',\n  '@mui/material/Modal',\n  '@mui/material/NativeSelect',\n  '@mui/material/OutlinedInput',\n  '@mui/material/Pagination',\n  '@mui/material/PaginationItem',\n  '@mui/material/Paper',\n  '@mui/material/Popover',\n  '@mui/material/Popper',\n  '@mui/material/Portal',\n  '@mui/material/Radio',\n  '@mui/material/RadioGroup',\n  '@mui/material/Rating',\n  '@mui/material/ScopedCssBaseline',\n  '@mui/material/Select',\n  '@mui/material/Skeleton',\n  '@mui/material/Slider',\n  '@mui/material/Snackbar',\n  '@mui/material/SnackbarContent',\n  '@mui/material/SpeedDial',\n  '@mui/material/SpeedDialAction',\n  '@mui/material/SpeedDialIcon',\n  '@mui/material/Stack',\n  '@mui/material/Step',\n  '@mui/material/StepButton',\n  '@mui/material/StepConnector',\n  '@mui/material/StepLabel',\n  '@mui/material/StepIcon',\n  '@mui/material/Stepper',\n  '@mui/material/SvgIcon',\n  '@mui/material/Switch',\n  '@mui/material/Tab',\n  '@mui/material/Table',\n  '@mui/material/TableBody',\n  '@mui/material/TableCell',\n  '@mui/material/TableContainer',\n  '@mui/material/TableFooter',\n  '@mui/material/TableHead',\n  '@mui/material/TablePagination',\n  '@mui/material/TableRow',\n  '@mui/material/TableSortLabel',\n  '@mui/material/Tabs',\n  '@mui/material/TextField',\n  '@mui/material/TextareaAutosize',\n  '@mui/material/ToggleButton',\n  '@mui/material/ToggleButtonGroup',\n  '@mui/material/Toolbar',\n  '@mui/material/Tooltip',\n  '@mui/material/Typography',\n\n  '@material-ui/lab/ToggleButton',\n  '@material-ui/lab/ToggleButtonGroup',\n  '@material-ui/lab/Autocomplete',\n  '@material-ui/lab/Alert',\n  '@material-ui/lab',\n\n  '@jbrowse/core/Plugin',\n  '@jbrowse/core/pluggableElementTypes',\n  '@jbrowse/core/pluggableElementTypes/ViewType',\n  '@jbrowse/core/pluggableElementTypes/AdapterType',\n  '@jbrowse/core/pluggableElementTypes/DisplayType',\n  '@jbrowse/core/pluggableElementTypes/TrackType',\n  '@jbrowse/core/pluggableElementTypes/WidgetType',\n  '@jbrowse/core/pluggableElementTypes/models',\n  '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType',\n  '@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType',\n  '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType',\n  '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType',\n  '@jbrowse/core/pluggableElementTypes/renderers/RendererType',\n  '@jbrowse/core/configuration',\n  '@jbrowse/core/util/types/mst',\n  '@jbrowse/core/ui',\n  '@jbrowse/core/ui/theme',\n  '@jbrowse/core/util',\n  '@jbrowse/core/util/color',\n  '@jbrowse/core/util/layouts',\n  '@jbrowse/core/util/tracks',\n  '@jbrowse/core/util/Base1DViewModel',\n  '@jbrowse/core/util/io',\n  '@jbrowse/core/util/mst-reflection',\n  '@jbrowse/core/util/rxjs',\n  '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail',\n  '@jbrowse/core/data_adapters/BaseAdapter',\n]\n","interface AbsoluteCache {\n  dirty: boolean\n  left?: number\n  right?: number\n  top?: number\n  bottom?: number\n  width?: number\n  height?: number\n}\n\nexport default class SceneGraph {\n  private children: Map<string, SceneGraph>\n\n  private absoluteCache: AbsoluteCache\n\n  public parent?: SceneGraph\n\n  /**\n   * note: all coordinates are inter-base or inter-pixel coordinates\n   */\n  constructor(\n    public name: string,\n    public left: number,\n    public top: number,\n    public width: number,\n    public height: number,\n\n    public data?: Record<string, any>,\n  ) {\n    this.children = new Map()\n    this.absoluteCache = { dirty: true }\n  }\n\n  addChild(\n    nameOrSceneGraph: string | SceneGraph,\n    left: number,\n    top: number,\n    width: number,\n    height: number,\n\n    data?: Record<string, any>,\n  ) {\n    const child =\n      nameOrSceneGraph instanceof SceneGraph\n        ? nameOrSceneGraph\n        : new SceneGraph(nameOrSceneGraph, left, top, width, height, data)\n\n    if (!(child instanceof SceneGraph)) {\n      throw new TypeError(\n        'argument to addChild must be an array or a SceneGraph',\n      )\n    }\n\n    if (this.children.has(child.name)) {\n      throw new Error(`child named \"${child.name}\" already exists`)\n    }\n\n    // update the bounds to match the child\n    child.parent = this\n    const {\n      left: childLeft,\n      right: childRight,\n      top: childTop,\n      bottom: childBottom,\n    } = child.absolute\n    if (\n      childLeft !== undefined &&\n      childRight !== undefined &&\n      childTop !== undefined &&\n      childBottom !== undefined\n    ) {\n      this.expand(childLeft, childRight, childTop, childBottom)\n      this.children.set(child.name, child)\n    }\n    return child\n  }\n\n  getSubRecord(name: string) {\n    return this.children.get(name)\n  }\n\n  /**\n   * if the record does not already cover the given absolute extents, extend it\n   * to cover them\n   *\n   * @param left -\n   * @param right -\n   * @param top -\n   * @param bottom -\n   */\n  expand(newLeft: number, newRight: number, newTop: number, newBottom: number) {\n    const { left, right, top, bottom } = this.absolute\n\n    if (left !== undefined && newLeft < left) {\n      const diff = left - newLeft\n      this.width += diff\n      this.left -= diff\n    }\n    if (right !== undefined && newRight > right) {\n      this.width += newRight - right\n    }\n    if (top !== undefined && newTop < top) {\n      const diff = top - newTop\n      this.height += diff\n      this.top -= diff\n    }\n    if (bottom !== undefined && newBottom > bottom) {\n      this.height += newBottom - bottom\n    }\n    if (this.parent) {\n      this.parent.expand(newLeft, newRight, newTop, newBottom)\n    }\n    this.absoluteCache.dirty = true\n  }\n\n  get bottom() {\n    return this.top + this.height\n  }\n\n  get right() {\n    return this.left + this.width\n  }\n\n  walkParents(callback: (arg: SceneGraph) => void) {\n    if (this.parent) {\n      callback(this.parent)\n      this.parent.walkParents(callback)\n    }\n  }\n\n  walkChildren(callback: (c: SceneGraph) => void) {\n    for (const sub of this.children.values()) {\n      callback(sub)\n      sub.walkChildren(callback)\n    }\n  }\n\n  get absolute() {\n    if (this.absoluteCache.dirty) {\n      let xOffset = 0\n      let yOffset = 0\n      this.walkParents((node: SceneGraph) => {\n        xOffset += node.left\n        yOffset += node.top\n      })\n      this.absoluteCache = {\n        dirty: false,\n        left: this.left + xOffset,\n        right: this.right + xOffset,\n        top: this.top + yOffset,\n        bottom: this.bottom + yOffset,\n        width: this.width,\n        height: this.height,\n      }\n    }\n    return this.absoluteCache\n  }\n\n  move(x: number, y: number) {\n    this.left += x\n    this.top += y\n\n    this.absoluteCache.dirty = true\n    this.walkChildren(c => {\n      c.absoluteCache.dirty = true\n    })\n    const { left, right, top, bottom } = this.absolute\n    if (\n      left !== undefined &&\n      right !== undefined &&\n      top !== undefined &&\n      bottom !== undefined\n    ) {\n      this.expand(left, right, top, bottom)\n    }\n  }\n}\n","import * as React from 'react'\n\nimport * as mst from '@jbrowse/mobx-state-tree'\nimport { alpha, createTheme, useTheme } from '@mui/material'\nimport * as MUIStyles from '@mui/material/styles'\nimport * as MUIUtils from '@mui/material/utils'\nimport {\n  useGridApiContext,\n  useGridApiRef,\n  useGridRootProps,\n} from '@mui/x-data-grid'\nimport * as mobx from 'mobx'\nimport * as mxreact from 'mobx-react'\nimport * as ReactJSXRuntime from 'react/jsx-runtime'\nimport * as ReactDom from 'react-dom'\nimport * as ReactDomClient from 'react-dom/client'\n\nimport Plugin from '../Plugin.ts'\nimport { BaseFeatureDetail } from './BaseFeatureDetails.tsx'\nimport { DataGridEntries } from './MuiDataGridReExports.ts'\nimport { Entries } from './MuiReExports.ts'\nimport { lazyMap } from './lazify.tsx'\nimport reExportsList from './list.ts'\nimport * as Configuration from '../configuration/index.ts'\nimport * as BaseAdapterExports from '../data_adapters/BaseAdapter/index.ts'\nimport AdapterType from '../pluggableElementTypes/AdapterType.ts'\nimport DisplayType from '../pluggableElementTypes/DisplayType.ts'\nimport TrackType from '../pluggableElementTypes/TrackType.ts'\nimport ViewType from '../pluggableElementTypes/ViewType.ts'\nimport WidgetType from '../pluggableElementTypes/WidgetType.ts'\nimport * as pluggableElementTypes from '../pluggableElementTypes/index.ts'\nimport * as pluggableElementTypeModels from '../pluggableElementTypes/models/index.ts'\nimport * as BoxRendererType from '../pluggableElementTypes/renderers/BoxRendererType.ts'\nimport CircularChordRendererType from '../pluggableElementTypes/renderers/CircularChordRendererType.tsx'\nimport * as FeatureRendererType from '../pluggableElementTypes/renderers/FeatureRendererType.ts'\nimport * as RendererType from '../pluggableElementTypes/renderers/RendererType.tsx'\nimport * as ServerSideRendererType from '../pluggableElementTypes/renderers/ServerSideRendererType.tsx'\nimport * as coreUi from '../ui/index.ts'\nimport * as coreTheme from '../ui/theme.ts'\nimport Base1DView from '../util/Base1DViewModel.ts'\nimport * as coreColor from '../util/color/index.ts'\nimport * as coreUtil from '../util/index.ts'\nimport * as coreIo from '../util/io/index.ts'\nimport * as coreLayouts from '../util/layouts/index.ts'\nimport * as coreMstReflection from '../util/mst-reflection.ts'\nimport * as rxjs from '../util/rxjs.ts'\nimport * as trackUtils from '../util/tracks.ts'\nimport { cx, keyframes, makeStyles } from '../util/tss-react/index.ts'\nimport * as mstTypes from '../util/types/mst.ts'\n\nconst libs = {\n  mobx,\n  '@jbrowse/mobx-state-tree': mst,\n  'mobx-state-tree': mst,\n  react: React,\n  'react/jsx-runtime': ReactJSXRuntime,\n  'react-dom': ReactDom,\n  'react-dom/client': ReactDomClient,\n  'mobx-react': mxreact,\n  '@mui/x-data-grid': {\n    useGridApiContext,\n    useGridApiRef,\n    useGridRootProps,\n    ...lazyMap(DataGridEntries),\n  },\n\n  // special case so plugins can easily use @mui/icons-material; don't remove\n  '@mui/material/utils': MUIUtils,\n  '@material-ui/core/utils': MUIUtils,\n  'tss-react': {\n    cx,\n    keyframes,\n    makeStyles,\n  },\n  'tss-react/mui': {\n    cx,\n    keyframes,\n    makeStyles,\n  },\n\n  '@material-ui/core': {\n    ...lazyMap(Entries),\n    useTheme,\n    alpha,\n\n    makeStyles: (args: any) => {\n      const useStyles = makeStyles()(args)\n      return () => useStyles().classes\n    },\n  },\n  '@mui/material': {\n    ...lazyMap(Entries),\n    alpha,\n    useTheme,\n    createTheme,\n  },\n  ...lazyMap(Entries, '@mui/material/'),\n  ...lazyMap(Entries, '@material-ui/core/'),\n\n  '@mui/material/styles': {\n    ...MUIStyles,\n\n    makeStyles: (args: any) => {\n      const useStyles = makeStyles()(args)\n      return () => useStyles().classes\n    },\n  },\n  '@material-ui/core/styles': {\n    ...MUIStyles,\n\n    makeStyles: (args: any) => {\n      const useStyles = makeStyles()(args)\n      return () => useStyles().classes\n    },\n  },\n\n  // these are core in @mui/material, but used to be in @material-ui/lab\n  '@material-ui/lab/ToggleButton': Entries.ToggleButton,\n  '@material-ui/lab/ToggleButtonGroup': Entries.ToggleButtonGroup,\n  '@material-ui/lab/Autocomplete': Entries.Autocomplete,\n  '@material-ui/lab/Alert': Entries.Alert,\n  '@material-ui/lab': {\n    Alert: Entries.Alert,\n    Autocomplete: Entries.Autocomplete,\n    ToggleButton: Entries.ToggleButton,\n    ToggleButtonGroup: Entries.ToggleButtonGroup,\n  },\n\n  '@jbrowse/core/Plugin': Plugin,\n  '@jbrowse/core/pluggableElementTypes/renderers/RendererType': RendererType,\n  '@jbrowse/core/configuration': Configuration,\n  '@jbrowse/core/util/types/mst': mstTypes,\n  '@jbrowse/core/ui': coreUi,\n  '@jbrowse/core/ui/theme': coreTheme,\n  '@jbrowse/core/util': coreUtil,\n  '@jbrowse/core/util/color': coreColor,\n  '@jbrowse/core/util/layouts': coreLayouts,\n  '@jbrowse/core/util/tracks': trackUtils,\n  '@jbrowse/core/util/Base1DViewModel': Base1DView,\n  '@jbrowse/core/util/io': coreIo,\n  '@jbrowse/core/util/mst-reflection': coreMstReflection,\n  '@jbrowse/core/util/rxjs': rxjs,\n  '@jbrowse/core/pluggableElementTypes': pluggableElementTypes,\n  '@jbrowse/core/pluggableElementTypes/ViewType': ViewType,\n  '@jbrowse/core/pluggableElementTypes/AdapterType': AdapterType,\n  '@jbrowse/core/pluggableElementTypes/DisplayType': DisplayType,\n  '@jbrowse/core/pluggableElementTypes/TrackType': TrackType,\n  '@jbrowse/core/pluggableElementTypes/WidgetType': WidgetType,\n  '@jbrowse/core/pluggableElementTypes/models': pluggableElementTypeModels,\n  '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType':\n    ServerSideRendererType,\n  '@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType':\n    CircularChordRendererType,\n  '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType':\n    BoxRendererType,\n  '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType':\n    FeatureRendererType,\n\n  '@jbrowse/core/BaseFeatureWidget/BaseFeatureDetail': BaseFeatureDetail,\n  '@jbrowse/core/data_adapters/BaseAdapter': BaseAdapterExports,\n}\n\nconst libsList = Object.keys(libs)\n\n// make sure that all the items in the ReExports/list array (used by build\n// systems and such) are included here, and vice versa\nconst inLibsOnly = libsList.filter(mod => !reExportsList.includes(mod))\nif (inLibsOnly.length > 0) {\n  throw new Error(\n    `The following modules are in the modules libs, but not the re-exports list: ${inLibsOnly.join(\n      ', ',\n    )}`,\n  )\n}\nconst inReExportsOnly = reExportsList.filter(mod => !libsList.includes(mod))\nif (inReExportsOnly.length) {\n  throw new Error(\n    `The following modules are in the re-exports list, but not the modules libs: ${inReExportsOnly.join(\n      ', ',\n    )}`,\n  )\n}\n\nexport default libs\n","import { clamp } from '@jbrowse/core/util'\n\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView/index.ts'\nimport type { FloatingLabelData, LayoutRecord } from '../types.ts'\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\n\ninterface PixelPositions {\n  leftPx: number\n  rightPx: number\n}\n\nexport interface FeatureLabelData {\n  leftPx: number\n  rightPx: number\n  topPx: number\n  totalFeatureHeight: number\n  floatingLabels: FloatingLabelData[]\n  featureWidth: number\n  totalLayoutWidth: number\n}\n\n/**\n * Calculate pixel positions for a feature given its BP coordinates.\n * Handles cases where one or both ends might be off-screen by estimating\n * positions based on feature width and bpPerPx.\n */\nfunction calculateFeaturePixelPositions(\n  view: LinearGenomeViewModel,\n  assembly: Assembly | undefined,\n  refName: string,\n  left: number,\n  right: number,\n  bpPerPx: number,\n): PixelPositions | undefined {\n  const canonicalRefName = assembly?.getCanonicalRefName(refName) || refName\n\n  const leftBpPx = view.bpToPx({\n    refName: canonicalRefName,\n    coord: left,\n  })?.offsetPx\n\n  const rightBpPx = view.bpToPx({\n    refName: canonicalRefName,\n    coord: right,\n  })?.offsetPx\n\n  if (leftBpPx !== undefined) {\n    const rightEstimate =\n      rightBpPx !== undefined ? rightBpPx : leftBpPx + (right - left) / bpPerPx\n    return {\n      leftPx: Math.min(leftBpPx, rightEstimate),\n      rightPx: Math.max(leftBpPx, rightEstimate),\n    }\n  } else if (rightBpPx !== undefined) {\n    const leftEstimate = rightBpPx - (right - left) / bpPerPx\n    return {\n      leftPx: Math.min(leftEstimate, rightBpPx),\n      rightPx: Math.max(leftEstimate, rightBpPx),\n    }\n  }\n  return undefined\n}\n\n/**\n * Calculate pixel positions for features that span multiple regions\n * (e.g., genes with collapsed introns where both ends are off-screen)\n */\nfunction calculateMultiRegionPositions(\n  view: LinearGenomeViewModel,\n  assembly: Assembly | undefined,\n  refName: string,\n  left: number,\n  right: number,\n): PixelPositions | undefined {\n  const canonicalRefName = assembly?.getCanonicalRefName(refName) || refName\n  const visibleRegions = view.displayedRegions.filter(\n    r => r.refName === canonicalRefName && r.start < right && r.end > left,\n  )\n\n  if (visibleRegions.length === 0) {\n    return undefined\n  }\n\n  let minLeftPx = Infinity\n  let maxRightPx = -Infinity\n\n  for (const region of visibleRegions) {\n    const regionStart = Math.max(left, region.start)\n    const regionEnd = Math.min(right, region.end)\n\n    const startPx = view.bpToPx({\n      refName: canonicalRefName,\n      coord: regionStart,\n    })?.offsetPx\n\n    const endPx = view.bpToPx({\n      refName: canonicalRefName,\n      coord: regionEnd,\n    })?.offsetPx\n\n    if (startPx !== undefined && endPx !== undefined) {\n      minLeftPx = Math.min(minLeftPx, startPx, endPx)\n      maxRightPx = Math.max(maxRightPx, startPx, endPx)\n    }\n  }\n\n  if (minLeftPx === Infinity || maxRightPx === -Infinity) {\n    return undefined\n  }\n\n  return { leftPx: minLeftPx, rightPx: maxRightPx }\n}\n\nfunction getFeaturePositions(\n  view: LinearGenomeViewModel,\n  assembly: Assembly | undefined,\n  refName: string,\n  left: number,\n  right: number,\n  bpPerPx: number,\n): PixelPositions | undefined {\n  return (\n    calculateFeaturePixelPositions(\n      view,\n      assembly,\n      refName,\n      left,\n      right,\n      bpPerPx,\n    ) || calculateMultiRegionPositions(view, assembly, refName, left, right)\n  )\n}\n\nexport function deduplicateFeatureLabels(\n  layoutFeatures: {\n    entries(): IterableIterator<readonly [string, LayoutRecord | undefined]>\n  },\n  view: LinearGenomeViewModel,\n  assembly: Assembly | undefined,\n  bpPerPx: number,\n): Map<string, FeatureLabelData> {\n  const featureLabels = new Map<string, FeatureLabelData>()\n\n  for (const [key, val] of layoutFeatures.entries()) {\n    if (!val?.[4]) {\n      continue\n    }\n\n    const [, topPx, , , feature] = val\n    const {\n      refName,\n      floatingLabels,\n      totalFeatureHeight,\n      actualTopPx,\n      featureWidth,\n      totalLayoutWidth,\n      featureStartBp,\n      featureEndBp,\n    } = feature\n    const effectiveTopPx = actualTopPx ?? topPx\n\n    if (\n      !floatingLabels ||\n      floatingLabels.length === 0 ||\n      !totalFeatureHeight ||\n      featureWidth === undefined ||\n      totalLayoutWidth === undefined ||\n      featureStartBp === undefined ||\n      featureEndBp === undefined\n    ) {\n      continue\n    }\n\n    // Use actual feature coordinates, not layout coordinates (which include padding)\n    const positions = getFeaturePositions(\n      view,\n      assembly,\n      refName,\n      featureStartBp,\n      featureEndBp,\n      bpPerPx,\n    )\n\n    if (!positions) {\n      continue\n    }\n\n    const existing = featureLabels.get(key)\n    if (!existing || positions.leftPx < existing.leftPx) {\n      featureLabels.set(key, {\n        leftPx: positions.leftPx,\n        rightPx: positions.rightPx,\n        topPx: effectiveTopPx,\n        totalFeatureHeight,\n        floatingLabels,\n        featureWidth,\n        totalLayoutWidth,\n      })\n    }\n  }\n\n  return featureLabels\n}\n\n/**\n * Get the left edge of the viewport in pixels.\n * When scrolled left (offsetPx < 0), viewport starts at 0.\n * When scrolled right (offsetPx > 0), viewport starts at offsetPx.\n */\nexport function getViewportLeftEdge(offsetPx: number): number {\n  return Math.max(0, offsetPx)\n}\n\n/**\n * Clamp feature positions to be within the visible viewport.\n * Prevents labels from being positioned in off-screen areas.\n */\nexport function clampToViewport(\n  featureLeftPx: number,\n  featureRightPx: number,\n  offsetPx: number,\n): { leftPx: number; rightPx: number } {\n  const viewportLeft = getViewportLeftEdge(offsetPx)\n  return {\n    leftPx: Math.max(featureLeftPx, viewportLeft),\n    rightPx: Math.max(featureRightPx, viewportLeft),\n  }\n}\n\n/**\n * Calculate the x position for a floating label.\n *\n * Floating labels have two modes:\n * 1. If the label is wider than the feature, it uses a fixed position\n *    (doesn't float) and can extend beyond the feature's right edge.\n * 2. If the label fits within the feature, it floats to stay visible\n *    but is constrained to keep its right edge within the feature's right edge.\n *\n * @param featureLeftPx - Left edge of the feature in pixels\n * @param featureRightPx - Right edge of the feature in pixels\n * @param labelWidth - Width of the label text in pixels\n * @param offsetPx - Current viewport offset in pixels\n * @param viewportLeft - Left edge of the viewport in pixels\n * @returns The x position for the label (already offset-adjusted)\n */\nexport function calculateFloatingLabelPosition(\n  featureLeftPx: number,\n  featureRightPx: number,\n  labelWidth: number,\n  offsetPx: number,\n  viewportLeft: number,\n): number {\n  const featureWidth = featureRightPx - featureLeftPx\n\n  if (labelWidth > featureWidth) {\n    // Label doesn't fit within feature - don't float, use fixed position\n    return featureLeftPx - offsetPx\n  }\n\n  // Label fits within feature - apply floating logic\n  const leftPx = Math.max(featureLeftPx, viewportLeft)\n  const naturalX = leftPx - offsetPx\n  const maxX = featureRightPx - offsetPx - labelWidth\n  return clamp(naturalX, 0, maxX)\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { getParentRenderProps } from '@jbrowse/core/util/tracks'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { BaseLinearDisplay } from '../BaseLinearDisplay/index.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearBareDisplay\n * #category display\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearBareDisplay',\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearBareDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const configBlob = getConf(self, ['renderer']) || {}\n        return configBlob as Omit<typeof configBlob, symbol>\n      },\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return getConf(self, ['renderer', 'type'])\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            ...getParentRenderProps(self),\n            config: self.rendererConfig,\n          }\n        },\n      }\n    })\n}\n","import { category10 } from '@jbrowse/core/ui/colors'\nimport { colord } from '@jbrowse/core/util/colord'\n\nexport const MAX_COLOR_RANGE = 255 * 255 * 255 // max color range\n\nexport const lineLimit = 3\n\nexport const oobLimit = 1600\n\nexport function makeColor(idx: number) {\n  const r = Math.floor(idx / (255 * 255)) % 255\n  const g = Math.floor(idx / 255) % 255\n  const b = idx % 255\n  return `rgb(${r},${g},${b})`\n}\n\nexport function getId(r: number, g: number, b: number, unitMultiplier: number) {\n  return Math.floor((r * 255 * 255 + g * 255 + b - 1) / unitMultiplier)\n}\n\n// Simple hash function to generate consistent colors for query names\nfunction hashString(str: string) {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n    hash = hash & hash // Convert to 32bit integer\n  }\n  return Math.abs(hash)\n}\n\n// Generate a color from a query name using the category10 color palette\nexport function getQueryColor(queryName: string) {\n  const hash = hashString(queryName)\n  return category10[hash % category10.length]!\n}\n\n// Default CIGAR operation colors\nexport const defaultCigarColors = {\n  I: '#ff03',\n  N: '#0a03',\n  D: '#00f3',\n  X: 'brown',\n  M: '#f003',\n  '=': '#f003',\n}\n\n// Strand-specific CIGAR operation colors (purple deletion instead of blue)\nexport const strandCigarColors = {\n  I: '#ff03',\n  N: '#a020f0', // Purple for deletion\n  D: '#a020f0', // Purple for deletion\n  X: 'brown',\n  M: '#f003',\n  '=': '#f003',\n}\n\n// Color scheme configuration\nexport const colorSchemes = {\n  default: {\n    cigarColors: defaultCigarColors,\n  },\n  strand: {\n    posColor: 'red',\n    negColor: 'blue',\n    cigarColors: strandCigarColors,\n  },\n  query: {\n    cigarColors: defaultCigarColors,\n  },\n}\n\nexport type ColorScheme = keyof typeof colorSchemes\n\nexport function applyAlpha(color: string, alpha: number) {\n  // Skip colord processing if alpha is 1 (optimization)\n  if (alpha === 1) {\n    return color\n  }\n  return colord(color).alpha(alpha).toHex()\n}\n","import RpcMethodType from './RpcMethodType.ts'\nimport { renameRegionsIfNeeded } from '../util/index.ts'\nimport SerializableFilterChain from './renderers/util/serializableFilterChain.ts'\n\nimport type { RenderArgs } from '@jbrowse/core/rpc/coreRpcMethods'\n\nexport default abstract class RpcMethodTypeWithFiltersAndRenameRegions extends RpcMethodType {\n  async deserializeArguments<T>(\n    args: T & { filters?: any },\n    rpcDriverClassName: string,\n  ): Promise<T> {\n    const l = await super.deserializeArguments(args, rpcDriverClassName)\n    return {\n      ...l,\n      filters: args.filters\n        ? new SerializableFilterChain({\n            filters: args.filters,\n          })\n        : undefined,\n    }\n  }\n\n  async serializeArguments(\n    args: RenderArgs & {\n      stopToken?: string\n      statusCallback?: (arg: string) => void\n    },\n    rpcDriverClassName: string,\n  ) {\n    const pm = this.pluginManager\n    const assemblyManager = pm.rootModel?.session?.assemblyManager\n    if (!assemblyManager) {\n      throw new Error('no assembly manager')\n    }\n\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, {\n      ...args,\n      filters: args.filters?.toJSON().filters,\n    })\n\n    return super.serializeArguments(renamedArgs, rpcDriverClassName)\n  }\n}\n","import { CanvasSequence } from 'canvas-sequencer-ts'\n\nexport async function getSerializedSvg(results: {\n  width: number\n  height: number\n  canvasRecordedData: unknown\n}) {\n  const { width, height, canvasRecordedData } = results\n\n  // @ts-ignore needs to be ignore not expect error, produces error in build step\n  const C2S = await import('canvas2svg')\n  const ctx = new C2S.default(width, height)\n  const seq = new CanvasSequence(canvasRecordedData as any)\n  seq.execute(ctx)\n\n  // innerHTML strips the outer <svg> element from returned data, we add\n  // our own <svg> element in the view's SVG export\n  return ctx.getSvg().innerHTML as string\n}\n","import isNode from 'detect-node'\nimport { BlobFile, LocalFile } from 'generic-filehandle2'\n\nimport { RemoteFileWithRangeCache } from './RemoteFileWithRangeCache.ts'\nimport { isElectron } from '../index.ts'\nimport { getBlob } from '../tracks.ts'\nimport {\n  AuthNeededError,\n  isRootModelWithInternetAccounts,\n  isUriLocation,\n} from '../types/index.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type { BaseInternetAccountModel } from '../../pluggableElementTypes/models/index.ts'\nimport type {\n  BlobLocation,\n  FileLocation,\n  LocalPathLocation,\n  UriLocation,\n} from '../types/index.ts'\nimport type { Fetcher, GenericFilehandle } from 'generic-filehandle2'\n\nfunction isLocalPathLocation(\n  location: FileLocation,\n): location is LocalPathLocation {\n  return 'localPath' in location\n}\n\nfunction isBlobLocation(location: FileLocation): location is BlobLocation {\n  return 'blobId' in location\n}\n\n/** if a UriLocation has a baseUri, resolves its uri with respect to that base */\nexport function resolveUriLocation(location: UriLocation) {\n  return location.baseUri\n    ? { ...location, uri: new URL(location.uri, location.baseUri).href }\n    : location\n}\n\nexport function openLocation(\n  location: FileLocation,\n  pluginManager?: PluginManager,\n): GenericFilehandle {\n  if (isLocalPathLocation(location)) {\n    if (!location.localPath) {\n      throw new Error('No local path provided')\n    }\n\n    if (isNode || isElectron) {\n      return new LocalFile(location.localPath)\n    } else {\n      throw new Error(\"can't use local files in the browser\")\n    }\n  }\n  if (isBlobLocation(location)) {\n    // special case where blob is not directly stored on the model, use a getter\n    const blob = getBlob(location.blobId)\n    if (!blob) {\n      throw new Error(\n        `file (\"${location.name}\") was opened locally from a previous session. To restore it, go to track settings and reopen the file`,\n      )\n    }\n    return new BlobFile(blob)\n  }\n  if (isUriLocation(location)) {\n    // Check for empty string\n    if (!location.uri) {\n      throw new Error('No URI provided')\n    }\n\n    // Resolve any relative URLs to absolute URLs\n    const absoluteLocation = resolveUriLocation(location)\n\n    // If there is a plugin manager, we can try internet accounts\n    if (pluginManager) {\n      const internetAccount = getInternetAccount(location, pluginManager)\n      // If an internetAccount was found, use it to open the location\n      if (internetAccount) {\n        return internetAccount.openLocation(absoluteLocation)\n      }\n    }\n    // Otherwise fall back on usual open\n    return new RemoteFileWithRangeCache(absoluteLocation.uri, {\n      fetch: checkAuthNeededFetch,\n    })\n  }\n  throw new Error('invalid fileLocation')\n}\n\nexport function getFetcher(\n  location: FileLocation,\n  pluginManager?: PluginManager,\n): Fetcher {\n  if (!isUriLocation(location)) {\n    throw new Error(`Not a valid UriLocation: ${JSON.stringify(location)}`)\n  }\n  if (pluginManager) {\n    const internetAccount = getInternetAccount(location, pluginManager)\n    if (internetAccount) {\n      return internetAccount.getFetcher(location)\n    }\n  }\n  return checkAuthNeededFetch\n}\n\nfunction getInternetAccount(\n  location: UriLocation,\n  pluginManager: PluginManager,\n): BaseInternetAccountModel | undefined {\n  const { rootModel } = pluginManager\n  // If there is an appRootModel, use it to find the internetAccount\n  if (rootModel && isRootModelWithInternetAccounts(rootModel)) {\n    return rootModel.findAppropriateInternetAccount(location)\n  }\n  // If there is no appRootModel, but there is pre-auth, create a temporary\n  // internetAccount. This is typical in a worker.\n  if (location.internetAccountPreAuthorization) {\n    if (!location.internetAccountPreAuthorization.authInfo.token) {\n      throw new Error(\n        'Failed to obtain token from internet account. Try reloading the page',\n      )\n    }\n    return pluginManager\n      .getInternetAccountType(\n        location.internetAccountPreAuthorization.internetAccountType,\n      )!\n      .stateModel.create({\n        type: location.internetAccountPreAuthorization.internetAccountType,\n        configuration:\n          location.internetAccountPreAuthorization.authInfo.configuration,\n      })\n  }\n  return undefined\n}\n\n// This fetch throws a special error if the response is \"401\" and includes a\n// \"WWW-Authenticate: Basic\" header. This is so downstream code can retry if\n// needed with HTTP Basic authentication included\nasync function checkAuthNeededFetch(url: RequestInfo, opts?: RequestInit) {\n  const response = await fetch(url, opts)\n  if (\n    response.status === 401 &&\n    response.headers.get('WWW-Authenticate')?.includes('Basic')\n  ) {\n    throw new AuthNeededError(\n      'Accessing HTTPBasic resource without authentication',\n      url.toString(),\n    )\n  }\n  return response\n}\n\nexport { RemoteFileWithRangeCache } from './RemoteFileWithRangeCache.ts'\n","import { getConf } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nconst minDisplayHeight = 20\n\n/**\n * #stateModel TrackHeightMixin\n * #category display\n */\nexport default function TrackHeightMixin() {\n  return types\n    .model({\n      /**\n       * #property\n       */\n      heightPreConfig: types.maybe(\n        types.refinement(\n          'displayHeight',\n          types.number,\n          n => n >= minDisplayHeight,\n        ),\n      ),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      scrollTop: 0,\n    }))\n    .views(self => ({\n      get height() {\n        // @ts-expect-error\n        return self.heightPreConfig ?? (getConf(self, 'height') as number)\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setScrollTop(scrollTop: number) {\n        self.scrollTop = scrollTop\n      },\n      /**\n       * #action\n       */\n      setHeight(displayHeight: number) {\n        self.heightPreConfig = Math.max(displayHeight, minDisplayHeight)\n        return self.height\n      },\n      /**\n       * #action\n       */\n      resizeHeight(distance: number) {\n        const oldHeight = self.height\n        const newHeight = this.setHeight(self.height + distance)\n        return newHeight - oldHeight\n      },\n    }))\n}\n","import { useEffect } from 'react'\n\nimport { MenuItem, TextField } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { useLocalStorage } from '../util/index.ts'\nimport { makeStyles } from '../util/tss-react/index.ts'\n\nimport type { AbstractSessionModel } from '../util/index.ts'\nimport type { InputProps as IIP, TextFieldProps as TFP } from '@mui/material'\n\nconst useStyles = makeStyles()({\n  importFormEntry: {\n    minWidth: 180,\n  },\n})\n\nconst AssemblySelector = observer(function AssemblySelector({\n  session,\n  onChange,\n  label = 'Assembly',\n  selected,\n  InputProps,\n  TextFieldProps,\n  localStorageKey,\n  helperText = 'Select assembly to view',\n}: {\n  session: AbstractSessionModel\n  label?: string\n  helperText?: string\n  onChange: (arg: string) => void\n  selected?: string\n  localStorageKey?: string\n  InputProps?: IIP\n  TextFieldProps?: TFP\n}) {\n  const { classes } = useStyles()\n  const { assemblyNames, assemblyManager } = session\n\n  // constructs a localstorage key based on host/path/config to help\n  // remember. non-config assists usage with e.g. embedded apps\n  const config = new URLSearchParams(window.location.search).get('config')\n  const [lastSelected, setLastSelected] = useLocalStorage(\n    `lastAssembly-${[\n      window.location.host + window.location.pathname,\n      config,\n      localStorageKey,\n    ].join('-')}`,\n    selected,\n    typeof jest === 'undefined' && Boolean(localStorageKey),\n  )\n\n  const selection = assemblyNames.includes(lastSelected || '')\n    ? lastSelected\n    : selected\n\n  useEffect(() => {\n    if (selection && selection !== selected) {\n      onChange(selection)\n    }\n  }, [selection, onChange, selected])\n\n  const error = assemblyNames.length ? '' : 'No configured assemblies'\n  return (\n    <TextField\n      select\n      data-testid=\"assembly-selector-textfield\"\n      label={label}\n      variant=\"outlined\"\n      helperText={error || helperText}\n      value={selection || ''}\n      onChange={event => {\n        setLastSelected(event.target.value)\n      }}\n      error={!!error}\n      disabled={!!error}\n      className={classes.importFormEntry}\n      {...TextFieldProps}\n      slotProps={{\n        input: InputProps,\n        htmlInput: {\n          'data-testid': 'assembly-selector',\n        },\n      }}\n    >\n      {assemblyNames.map(name => (\n        <MenuItem key={name} value={name}>\n          {assemblyManager.get(name)?.displayName || name}\n        </MenuItem>\n      ))}\n    </TextField>\n  )\n})\n\nexport default AssemblySelector\n","import { cigarToMismatches } from './cigarToMismatches.ts'\nimport { cigarToMismatches2 } from './cigarToMismatches2.ts'\nimport { mdToMismatches } from './mdToMismatches.ts'\nimport { mdToMismatches2 } from './mdToMismatches2.ts'\n\nimport type { Mismatch } from '../shared/types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nconst startClip = new RegExp(/(\\d+)[SH]$/)\nconst endClip = new RegExp(/^(\\d+)([SH])/)\n\nexport function parseCigar(s = '') {\n  let currLen = ''\n  const ret = []\n  for (let i = 0, l = s.length; i < l; i++) {\n    const c = s[i]!\n    if (c >= '0' && c <= '9') {\n      currLen = currLen + c\n    } else {\n      ret.push(currLen, c)\n      currLen = ''\n    }\n  }\n  return ret\n}\n\n// CIGAR operation char codes to indices (from BAM spec)\nconst CIGAR_CODE_TO_INDEX: Record<number, number> = {\n  77: 0, // M\n  73: 1, // I\n  68: 2, // D\n  78: 3, // N\n  83: 4, // S\n  72: 5, // H\n  80: 6, // P\n  61: 7, // =\n  88: 8, // X\n}\n\n// Parses CIGAR string to packed Uint32Array format\n// Returns Uint32Array where each value is (length << 4) | opIndex\nexport function parseCigar2(s = ''): Uint32Array {\n  let currLen = 0\n  const ret: number[] = []\n  for (let i = 0, l = s.length; i < l; i++) {\n    const code = s.charCodeAt(i)\n    if (code >= 48 && code <= 57) {\n      // '0' to '9'\n      currLen = currLen * 10 + (code - 48)\n    } else {\n      const opIndex = CIGAR_CODE_TO_INDEX[code]!\n      ret.push((currLen << 4) | opIndex)\n      currLen = 0\n    }\n  }\n  return new Uint32Array(ret)\n}\n\nexport function getMismatches(\n  cigar?: string,\n  md?: string,\n  seq?: string,\n  ref?: string,\n  qual?: Uint8Array,\n) {\n  let mismatches: Mismatch[] = []\n  const ops = parseCigar(cigar)\n  // parse the CIGAR tag if it has one\n  if (cigar) {\n    mismatches = mismatches.concat(cigarToMismatches(ops, seq, ref, qual))\n  }\n\n  // now let's look for CRAM or MD mismatches\n  if (md && seq) {\n    mismatches = mismatches.concat(\n      mdToMismatches(md, ops, mismatches, seq, qual),\n    )\n  }\n\n  return mismatches\n}\n\n// Optimized version using packed NUMERIC_CIGAR from @gmod/bam\nexport function getMismatches2(\n  cigar?: Uint32Array,\n  md?: string,\n  seq?: string,\n  ref?: string,\n  qual?: Uint8Array,\n) {\n  let mismatches: Mismatch[] = []\n  // parse the CIGAR tag if it has one\n  if (cigar && cigar.length > 0) {\n    mismatches = mismatches.concat(cigarToMismatches2(cigar, seq, ref, qual))\n  }\n\n  // now let's look for CRAM or MD mismatches\n  if (md && seq && cigar) {\n    mismatches = mismatches.concat(\n      mdToMismatches2(md, cigar, mismatches, seq, qual),\n    )\n  }\n\n  return mismatches\n}\n\nexport function getOrientedCigar(flip: boolean, cigar: string[]) {\n  if (flip) {\n    const ret = []\n    for (let i = 0; i < cigar.length; i += 2) {\n      const len = cigar[i]!\n      let op = cigar[i + 1]!\n      if (op === 'D') {\n        op = 'I'\n      } else if (op === 'I') {\n        op = 'D'\n      }\n      ret.push(len, op)\n    }\n    return ret\n  }\n  return cigar\n}\n\nexport function getOrientedMismatches(flip: boolean, cigar: string) {\n  const p = parseCigar(cigar)\n  return cigarToMismatches(flip ? getOrientedCigar(flip, p) : p)\n}\n\nexport function getLengthOnRef(cigar: string) {\n  const cigarOps = parseCigar(cigar)\n  let lengthOnRef = 0\n  for (let i = 0; i < cigarOps.length; i += 2) {\n    const len = +cigarOps[i]!\n    const op = cigarOps[i + 1]\n    if (op !== 'H' && op !== 'S' && op !== 'I') {\n      lengthOnRef += len\n    }\n  }\n  return lengthOnRef\n}\n\nexport function getLength(cigar: string) {\n  const cigarOps = parseCigar(cigar)\n  let length = 0\n  for (let i = 0; i < cigarOps.length; i += 2) {\n    const len = +cigarOps[i]!\n    const op = cigarOps[i + 1]\n    if (op !== 'D' && op !== 'N') {\n      length += len\n    }\n  }\n  return length\n}\n\nexport function getLengthSansClipping(cigar: string) {\n  const cigarOps = parseCigar(cigar)\n  let length = 0\n  for (let i = 0; i < cigarOps.length; i += 2) {\n    const len = +cigarOps[i]!\n    const op = cigarOps[i + 1]\n    if (op !== 'H' && op !== 'S' && op !== 'D' && op !== 'N') {\n      length += len\n    }\n  }\n  return length\n}\n\nexport function getClip(cigar: string, strand: number) {\n  return strand === -1\n    ? +(startClip.exec(cigar) || [])[1]! || 0\n    : +(endClip.exec(cigar) || [])[1]! || 0\n}\n\nexport function getTag(feature: Feature, tag: string) {\n  return feature.get('tags')[tag]\n}\n\n// produces a list of \"feature-like\" object from parsing supplementary\n// alignments in the SA tag\n//\n// @param normalize - used specifically in the linear-read-vs-ref context, it\n// flips features around relative to the original feature. other contexts of\n// usage can keep this false\nexport function featurizeSA(\n  SA: string | undefined,\n  id: string,\n  strand: number,\n  readName: string,\n  normalize?: boolean,\n) {\n  return (\n    SA?.split(';')\n      .filter(aln => !!aln)\n      .map((aln, index) => {\n        const ret = aln.split(',')\n        const saRef = ret[0]!\n        const saStart = ret[1]!\n        const saStrand = ret[2]!\n        const saCigar = ret[3]!\n        const saLengthOnRef = getLengthOnRef(saCigar)\n        const saLength = getLength(saCigar)\n        const saLengthSansClipping = getLengthSansClipping(saCigar)\n        const saStrandNormalized = saStrand === '-' ? -1 : 1\n        const saClipPos = getClip(\n          saCigar,\n          (normalize ? strand : 1) * saStrandNormalized,\n        )\n        const saRealStart = +saStart - 1\n        return {\n          refName: saRef,\n          start: saRealStart,\n          end: saRealStart + saLengthOnRef,\n          seqLength: saLength,\n          clipLengthAtStartOfRead: saClipPos,\n          CIGAR: saCigar,\n          strand: (normalize ? strand : 1) * saStrandNormalized,\n          uniqueId: `${id}_SA${index}`,\n          mate: {\n            start: saClipPos,\n            end: saClipPos + saLengthSansClipping,\n            refName: readName,\n          },\n        }\n      }) || []\n  )\n}\n\nexport { getNextRefPos } from './getNextRefPos.ts'\nexport { cigarToMismatches2 } from './cigarToMismatches2.ts'\n","import type { Mismatch } from '../shared/types.ts'\n\nexport function cigarToMismatches(\n  ops: string[],\n  seq?: string,\n  ref?: string,\n  qual?: Uint8Array,\n) {\n  let roffset = 0 // reference offset\n  let soffset = 0 // seq offset\n  const mismatches: Mismatch[] = []\n  const hasRefAndSeq = ref && seq\n  for (let i = 0; i < ops.length; i += 2) {\n    const len = +ops[i]!\n    const op = ops[i + 1]!\n\n    if (op === 'M' || op === '=' || op === 'E') {\n      if (hasRefAndSeq) {\n        for (let j = 0; j < len; j++) {\n          if (\n            (seq.charCodeAt(soffset + j) | 0x20) !==\n            (ref.charCodeAt(roffset + j) | 0x20)\n          ) {\n            mismatches.push({\n              start: roffset + j,\n              type: 'mismatch',\n              base: seq[soffset + j]!,\n              altbase: ref[roffset + j]!,\n              length: 1,\n            })\n          }\n        }\n      }\n      soffset += len\n    }\n    if (op === 'I') {\n      mismatches.push({\n        start: roffset,\n        type: 'insertion',\n        insertlen: len,\n        insertedBases: seq?.slice(soffset, soffset + len),\n        length: 0,\n      })\n      soffset += len\n    } else if (op === 'D') {\n      mismatches.push({\n        start: roffset,\n        type: 'deletion',\n        length: len,\n      })\n    } else if (op === 'N') {\n      mismatches.push({\n        start: roffset,\n        type: 'skip',\n        length: len,\n      })\n    } else if (op === 'X') {\n      const r = seq?.slice(soffset, soffset + len) || []\n      const q = qual?.subarray(soffset, soffset + len) || []\n\n      for (let j = 0; j < len; j++) {\n        mismatches.push({\n          start: roffset + j,\n          type: 'mismatch',\n          base: r[j] || 'X',\n          qual: q[j],\n          length: 1,\n        })\n      }\n      soffset += len\n    } else if (op === 'H') {\n      mismatches.push({\n        start: roffset,\n        type: 'hardclip',\n        cliplen: len,\n        length: 1,\n      })\n    } else if (op === 'S') {\n      mismatches.push({\n        start: roffset,\n        type: 'softclip',\n        cliplen: len,\n        length: 1,\n      })\n      soffset += len\n    }\n\n    if (op !== 'I' && op !== 'S' && op !== 'H') {\n      roffset += len\n    }\n  }\n  return mismatches\n}\n","import type { Mismatch } from '../shared/types.ts'\n\nexport function mdToMismatches(\n  mdstring: string,\n  ops: string[],\n  cigarMismatches: Mismatch[],\n  seq: string,\n  qual?: Uint8Array,\n) {\n  const mismatchRecords: Mismatch[] = []\n  const opsLength = ops.length\n  const seqLength = seq.length\n  const hasQual = qual !== undefined\n\n  // only check for skips if cigarMismatches has any\n  const cigarLength = cigarMismatches.length\n  let hasSkips = false\n  for (let k = 0; k < cigarLength; k++) {\n    if (cigarMismatches[k]!.type === 'skip') {\n      hasSkips = true\n      break\n    }\n  }\n\n  let currStart = 0\n  let lastCigar = 0\n  let lastTemplateOffset = 0\n  let lastRefOffset = 0\n  let lastSkipPos = 0\n\n  // parse the MD string manually for better performance\n  let i = 0\n  const len = mdstring.length\n  while (i < len) {\n    const char = mdstring.charCodeAt(i)\n\n    if (char >= 48 && char <= 57) {\n      // digit (0-9)\n      let num = 0\n      while (i < len) {\n        const c = mdstring.charCodeAt(i)\n        if (c >= 48 && c <= 57) {\n          num = num * 10 + (c - 48)\n          i++\n        } else {\n          break\n        }\n      }\n      currStart += num\n    } else if (char === 94) {\n      // '^' deletion\n      i++\n      let delLen = 0\n      while (i < len) {\n        const c = mdstring.charCodeAt(i)\n        if (c >= 65 && c <= 90) {\n          delLen++\n          i++\n        } else {\n          break\n        }\n      }\n      currStart += delLen\n    } else if (char >= 65 && char <= 90) {\n      // letter (A-Z) - mismatch\n      const letter = mdstring[i]!\n      i++\n\n      if (hasSkips) {\n        while (lastSkipPos < cigarLength) {\n          const mismatch = cigarMismatches[lastSkipPos]!\n          if (mismatch.type === 'skip' && currStart >= mismatch.start) {\n            currStart += mismatch.length\n            lastSkipPos++\n          } else if (mismatch.type === 'skip') {\n            break\n          } else {\n            lastSkipPos++\n          }\n        }\n      }\n\n      // inlined getTemplateCoordLocal for better performance\n      let templateOffset = lastTemplateOffset\n      let refOffset = lastRefOffset\n      for (\n        let j = lastCigar;\n        j < opsLength && refOffset <= currStart;\n        j += 2, lastCigar = j\n      ) {\n        const len = +ops[j]!\n        const op = ops[j + 1]!\n\n        if (op === 'S' || op === 'I') {\n          templateOffset += len\n        } else if (op === 'D' || op === 'P' || op === 'N') {\n          refOffset += len\n        } else if (op !== 'H') {\n          templateOffset += len\n          refOffset += len\n        }\n      }\n      lastTemplateOffset = templateOffset\n      lastRefOffset = refOffset\n      const s = templateOffset - (refOffset - currStart)\n\n      const base = s < seqLength ? seq[s]! : 'X'\n      mismatchRecords.push({\n        start: currStart,\n        base,\n        qual: hasQual ? qual[s] : undefined,\n        altbase: letter,\n        length: 1,\n        type: 'mismatch',\n      })\n\n      currStart++\n    } else {\n      i++\n    }\n  }\n  return mismatchRecords\n}\n","import { useEffect, useState } from 'react'\n\nimport { IconButton } from '@mui/material'\n\nimport CascadingMenu from './CascadingMenu.tsx'\n\nimport type { MenuItemsGetter } from './CascadingMenu.tsx'\n\nfunction CascadingMenuButton({\n  children,\n  menuItems,\n  closeAfterItemClick = true,\n  stopPropagation,\n  disabled,\n  setOpen,\n  ButtonComponent = IconButton,\n  onClick: onClickExtra,\n  anchorOrigin,\n  transformOrigin,\n  marginThreshold,\n  ...rest\n}: {\n  children?: React.ReactNode\n  menuItems: MenuItemsGetter\n  closeAfterItemClick?: boolean\n  stopPropagation?: boolean\n  disabled?: boolean\n  onClick?: (event: React.MouseEvent<HTMLButtonElement>) => void\n  setOpen?: (arg: boolean) => void\n  ButtonComponent?: React.FC<{\n    onClick: (e: React.MouseEvent<HTMLButtonElement>) => void\n    disabled?: boolean\n    children?: React.ReactNode\n  }>\n  anchorOrigin?: {\n    vertical: 'top' | 'center' | 'bottom'\n    horizontal: 'left' | 'center' | 'right'\n  }\n  transformOrigin?: {\n    vertical: 'top' | 'center' | 'bottom'\n    horizontal: 'left' | 'center' | 'right'\n  }\n  marginThreshold?: number | null\n  [key: string]: unknown\n}) {\n  const [anchorEl, setAnchorEl] = useState<Element | null>(null)\n  const open = Boolean(anchorEl)\n\n  useEffect(() => {\n    setOpen?.(open)\n  }, [open, setOpen])\n\n  const isDisabled =\n    disabled ?? (Array.isArray(menuItems) && menuItems.length === 0)\n\n  return (\n    <>\n      <ButtonComponent\n        onClick={event => {\n          if (stopPropagation) {\n            event.stopPropagation()\n          }\n          setAnchorEl(event.currentTarget)\n          onClickExtra?.(event)\n        }}\n        {...rest}\n        disabled={isDisabled}\n      >\n        {children}\n      </ButtonComponent>\n      {open ? (\n        <CascadingMenu\n          open={open}\n          onClose={() => {\n            setAnchorEl(null)\n          }}\n          anchorEl={anchorEl}\n          anchorOrigin={anchorOrigin}\n          transformOrigin={transformOrigin}\n          marginThreshold={marginThreshold}\n          menuItems={menuItems}\n          closeAfterItemClick={closeAfterItemClick}\n          onMenuItemClick={(_: unknown, callback: () => void) => {\n            callback()\n          }}\n        />\n      ) : null}\n    </>\n  )\n}\n\nexport default CascadingMenuButton\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseConnectionConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\n/**\n * #config UCSCTrackHubConnection\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst UCSCTrackHubConnection = ConfigurationSchema(\n  'UCSCTrackHubConnection',\n  {\n    /**\n     * #slot\n     */\n    hubTxtLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'http://mysite.com/path/to/hub.txt',\n        locationType: 'UriLocation',\n      },\n      description: 'location of the hub file (usually called hub.txt)',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'optional list of genomes to import from this track hub, if empty all genomes will be imported',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseConnectionConfig,\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            hubTxtLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default UCSCTrackHubConnection\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { BaseConnectionModelFactory } from '@jbrowse/core/pluggableElementTypes/models'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #stateModel UCSCTrackHubConnection\n * extends BaseConnectionModel\n */\nexport default function UCSCTrackHubConnection(pluginManager: PluginManager) {\n  return types\n    .compose(\n      'UCSCTrackHubConnection',\n      BaseConnectionModelFactory(pluginManager),\n      types.model({\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        type: types.literal('UCSCTrackHubConnection'),\n      }),\n    )\n    .actions(self => ({\n      /**\n       * #action\n       */\n      async connect() {\n        const { doConnect } = await import('./doConnect.ts')\n\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        doConnect(self)\n      },\n    }))\n}\n","import { ConnectionType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function UCSCTrackHubConnectionF(pluginManager: PluginManager) {\n  pluginManager.addConnectionType(() => {\n    return new ConnectionType({\n      name: 'UCSCTrackHubConnection',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      displayName: 'UCSC Track Hub',\n      description: 'A track or assembly hub in the Track Hub format',\n      url: 'https://genome.ucsc.edu/goldenPath/help/hgTrackHubHelp.html#Intro',\n    })\n  })\n}\n","// Regexes based on parse_mm.pl from hts-specs\n// https://github.com/samtools/hts-specs/blob/f907ead164780fdbcce6a0807c551413dbf18ca1/test/SAMtags/parse_mm.pl#L73\n// Modified to not have the ,(.*) because we saw examples with 'C+m,192,445,157,36,12,39,21,30,5,0,2,1,9,29,6,186,109,8,0,66,57,431,168,16,20,0,58,152,333,8,32,54,12,4,147,2,5,0,1,6,4,1,35,3,282,7,24,4,35,3,42,8,4,81,60,50,37,7,529,138,14,106,327,667;C+h;' and C+h does not have a comma\nexport const modificationRegex = new RegExp(\n  /([A-Z])([-+])([a-z]+|[0-9]+)([.?]?)/,\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BigWigAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BigWigAdapter = ConfigurationSchema(\n  'BigWigAdapter',\n  {\n    /**\n     * #slot\n     */\n    bigWigLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bw',\n        locationType: 'UriLocation',\n      },\n    },\n\n    /**\n     * #slot\n     * added as feature.get('source') on all features\n     */\n    source: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Used for multiwiggle',\n    },\n\n    /**\n     * #slot\n     */\n    resolutionMultiplier: {\n      type: 'number',\n      defaultValue: 1,\n      description:\n        'Initial resolution multiplier, <1 is higher resolution, >1 is lower resolution',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"BigWigAdapter\",\n     *   \"uri\": \"yourfile.bw\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            bigWigLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default BigWigAdapter\n","import { lazy } from 'react'\n\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { getSession, isSessionWithAddTracks } from '@jbrowse/core/util'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { HierarchicalTrackSelectorModel } from '@jbrowse/plugin-data-management'\n\n// lazies\nconst ConfirmDialog = lazy(() => import('./ConfirmDialog.tsx'))\n\nfunction makeTrack({\n  model,\n  arg,\n}: {\n  model: HierarchicalTrackSelectorModel\n  arg: {\n    name: string\n  }\n}) {\n  const tracks = model.selection\n  const trackIds = tracks.map(c => readConfObject(c, 'name'))\n  const subadapters = tracks\n    .map(c => readConfObject(c, 'adapter'))\n    .map((c, idx) => ({ ...c, source: trackIds[idx] }))\n  const now = Date.now()\n  const trackId = `multitrack-${now}-sessionTrack`\n\n  const session = getSession(model)\n  if (isSessionWithAddTracks(session)) {\n    session.addTrackConf({\n      type: 'MultiQuantitativeTrack',\n      trackId,\n      name: arg.name,\n      assemblyNames: [\n        ...new Set(tracks.flatMap(c => readConfObject(c, 'assemblyNames'))),\n      ],\n      adapter: {\n        type: 'MultiWiggleAdapter',\n        subadapters,\n      },\n    })\n    model.view.showTrack(trackId)\n  }\n}\n\nexport default function CreateMultiWiggleExtensionF(pm: PluginManager) {\n  pm.addToExtensionPoint(\n    'TrackSelector-multiTrackMenuItems',\n    (items: unknown[], props: Record<string, unknown>) => {\n      const { session } = props\n      return [\n        ...items,\n        ...(isSessionWithAddTracks(session)\n          ? [\n              {\n                label: 'Create multi-wiggle track',\n                onClick: (model: HierarchicalTrackSelectorModel) => {\n                  const tracks = model.selection\n\n                  getSession(model).queueDialog(handleClose => [\n                    ConfirmDialog,\n                    {\n                      tracks,\n                      onClose: (arg: boolean, arg1?: { name: string }) => {\n                        if (arg && arg1) {\n                          makeTrack({ model, arg: arg1 })\n                        }\n                        handleClose()\n                      },\n                    },\n                  ])\n                },\n              },\n            ]\n          : []),\n      ]\n    },\n  )\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { RenderArgsDeserialized } from '../types.ts'\n\nexport default class DensityRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config WiggleRenderer\n * this is the \"base wiggle renderer config schema\"\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst WiggleRenderer = ConfigurationSchema(\n  'WiggleRenderer',\n  {\n    /**\n     * #slot\n     */\n    color: {\n      type: 'color',\n      description: 'the color of track, overrides posColor and negColor',\n      defaultValue: '#f0f',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    posColor: {\n      type: 'color',\n      description: 'the color to use when the score is positive',\n      defaultValue: 'blue',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    negColor: {\n      type: 'color',\n      description: 'the color to use when the score is negative',\n      defaultValue: 'red',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    clipColor: {\n      type: 'color',\n      description: 'the color of the clipping marker',\n      defaultValue: 'red',\n    },\n    /**\n     * #slot\n     */\n    bicolorPivot: {\n      type: 'stringEnum',\n      model: types.enumeration('Scale type', [\n        'numeric',\n        'mean',\n        'z_score',\n        'none',\n      ]),\n      description: 'type of bicolor pivot',\n      defaultValue: 'numeric',\n    },\n    /**\n     * #slot\n     */\n    bicolorPivotValue: {\n      type: 'number',\n      defaultValue: 0,\n      description: 'value to use for bicolor pivot',\n    },\n  },\n  { explicitlyTyped: true },\n)\nexport default WiggleRenderer\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config DensityRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'DensityRenderer',\n  {},\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { RenderArgsDeserialized } from '../types.ts'\n\nexport default class LinePlotRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config LinePlotRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'LinePlotRenderer',\n  {\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #config SharedWiggleDisplay\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport default function sharedWiggleConfigFactory() {\n  return ConfigurationSchema(\n    'SharedWiggleDisplay',\n    {\n      /**\n       * #slot\n       */\n      autoscale: {\n        type: 'stringEnum',\n        defaultValue: 'local',\n        model: types.enumeration('Autoscale type', [\n          'global',\n          'local',\n          'globalsd',\n          'localsd',\n          'zscore',\n        ]),\n        description:\n          'global/local using their min/max values or w/ standard deviations (globalsd/localsd)',\n      },\n\n      /**\n       * #slot\n       */\n      minimalTicks: {\n        type: 'boolean',\n        defaultValue: false,\n        description: 'use the minimal amount of ticks',\n      },\n\n      /**\n       * #slot\n       */\n      minScore: {\n        type: 'number',\n        defaultValue: Number.MIN_VALUE,\n        description: 'minimum value for the y-scale',\n      },\n      /**\n       * #slot\n       */\n      maxScore: {\n        type: 'number',\n        description: 'maximum value for the y-scale',\n        defaultValue: Number.MAX_VALUE,\n      },\n      /**\n       * #slot\n       */\n      numStdDev: {\n        type: 'number',\n        description:\n          'number of standard deviations to use for autoscale types globalsd or localsd',\n        defaultValue: 3,\n      },\n      /**\n       * #slot\n       */\n      scaleType: {\n        type: 'stringEnum',\n        model: types.enumeration('Scale type', ['linear', 'log']), // todo zscale\n        description: 'The type of scale to use',\n        defaultValue: 'linear',\n      },\n\n      /**\n       * #slot\n       */\n      inverted: {\n        type: 'boolean',\n        description: 'draw upside down',\n        defaultValue: false,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { MultiRenderArgsDeserialized } from '../types.ts'\n\nexport default class MultiDensityPlotRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config MultiDensityRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiDensityRenderer',\n  {},\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { MultiRenderArgsDeserialized } from '../types.ts'\n\nexport default class MultiLineRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n/**\n * #config MultiLineRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiLineRenderer',\n  {\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    summaryScoreMode: {\n      type: 'stringEnum',\n      model: types.enumeration('Score type', ['max', 'min', 'avg', 'whiskers']),\n      description:\n        'choose whether to use max/min/average or whiskers which combines all three into the same rendering',\n      defaultValue: 'avg',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\nexport default configSchema\n","import { lazy } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { set1 as colors } from '@jbrowse/core/ui/colors'\nimport {\n  getContainingView,\n  getSession,\n  max,\n  measureText,\n} from '@jbrowse/core/util'\nimport { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport { isAlive, types } from '@jbrowse/mobx-state-tree'\nimport EqualizerIcon from '@mui/icons-material/Equalizer'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport deepEqual from 'fast-deep-equal'\n\nimport SharedWiggleMixin from '../shared/SharedWiggleMixin.ts'\nimport axisPropsFromTickScale from '../shared/axisPropsFromTickScale.ts'\nimport { YSCALEBAR_LABEL_OFFSET, getScale } from '../util.ts'\n\nimport type { Source } from '../util.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { AnyReactComponentType, Feature } from '@jbrowse/core/util'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\n\nconst randomColor = () =>\n  '#000000'.replaceAll('0', () => (~~(Math.random() * 16)).toString(16))\n\n// lazies\nconst Tooltip = lazy(() => import('./components/Tooltip.tsx'))\nconst SetColorDialog = lazy(() => import('./components/SetColorDialog.tsx'))\nconst WiggleClusterDialog = lazy(\n  () => import('./components/WiggleClusterDialog/WiggleClusterDialog.tsx'),\n)\n\n// using a map because it preserves order\nconst rendererTypes = new Map([\n  ['xyplot', 'MultiXYPlotRenderer'],\n  ['multirowxy', 'MultiRowXYPlotRenderer'],\n  ['multirowdensity', 'MultiDensityRenderer'],\n  ['multiline', 'MultiLineRenderer'],\n  ['multirowline', 'MultiRowLineRenderer'],\n])\n\n/**\n * #stateModel MultiLinearWiggleDisplay\n * extends\n * - [SharedWiggleMixin](../sharedwigglemixin)\n */\nexport function stateModelFactory(\n  _pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'MultiLinearWiggleDisplay',\n      SharedWiggleMixin(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('MultiLinearWiggleDisplay'),\n\n        /**\n         * #property\n         */\n        layout: types.optional(types.frozen<Source[]>(), []),\n        /**\n         * #property\n         */\n        showSidebar: true,\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      sourcesLoadingStopToken: undefined as StopToken | undefined,\n      /**\n       * #volatile\n       */\n      featureUnderMouseVolatile: undefined as Feature | undefined,\n      /**\n       * #volatile\n       */\n      sourcesVolatile: undefined as Source[] | undefined,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setShowSidebar(arg: boolean) {\n        self.showSidebar = arg\n      },\n      /**\n       * #action\n       */\n      setSourcesLoading(str: StopToken) {\n        if (self.sourcesLoadingStopToken) {\n          stopStopToken(self.sourcesLoadingStopToken)\n        }\n        self.sourcesLoadingStopToken = str\n      },\n      /**\n       * #action\n       */\n      setLayout(layout: Source[]) {\n        self.layout = layout\n      },\n      /**\n       * #action\n       */\n      clearLayout() {\n        self.layout = []\n      },\n\n      /**\n       * #action\n       */\n      setSources(sources: Source[]) {\n        if (!deepEqual(sources, self.sourcesVolatile)) {\n          self.sourcesVolatile = sources\n        }\n      },\n\n      /**\n       * #action\n       */\n      setFeatureUnderMouse(f?: Feature) {\n        self.featureUnderMouseVolatile = f\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get featureUnderMouse() {\n        return self.featureUnderMouseVolatile\n      },\n      /**\n       * #getter\n       */\n      get TooltipComponent() {\n        return Tooltip as AnyReactComponentType\n      },\n\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        const name = self.rendererTypeNameSimple\n        const rendererType = rendererTypes.get(name)\n        if (!rendererType) {\n          throw new Error(`unknown renderer ${name}`)\n        }\n        return rendererType\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get graphType() {\n        return (\n          self.rendererTypeName === 'MultiXYPlotRenderer' ||\n          self.rendererTypeName === 'MultiRowXYPlotRenderer' ||\n          self.rendererTypeName === 'MultiLineRenderer' ||\n          self.rendererTypeName === 'MultiRowLineRenderer'\n        )\n      },\n      /**\n       * #getter\n       */\n      get needsFullHeightScalebar() {\n        return (\n          self.rendererTypeName === 'MultiXYPlotRenderer' ||\n          self.rendererTypeName === 'MultiLineRenderer'\n        )\n      },\n      /**\n       * #getter\n       */\n      get isMultiRow() {\n        return (\n          self.rendererTypeName === 'MultiRowXYPlotRenderer' ||\n          self.rendererTypeName === 'MultiRowLineRenderer' ||\n          self.rendererTypeName === 'MultiDensityRenderer'\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get canHaveFill() {\n        return (\n          self.rendererTypeName === 'MultiXYPlotRenderer' ||\n          self.rendererTypeName === 'MultiRowXYPlotRenderer'\n        )\n      },\n      /**\n       * #getter\n       * can be used to give it a \"color scale\" like a R heatmap, not\n       * implemented like this yet but flag can be used for this\n       */\n      get needsCustomLegend() {\n        return self.rendererTypeName === 'MultiDensityRenderer'\n      },\n\n      /**\n       * #getter\n       * the multirowxy and multiline don't need to use colors on the legend\n       * boxes since their track is drawn with the color. sort of a stylistic\n       * choice\n       */\n      get renderColorBoxes() {\n        return !(\n          self.rendererTypeName === 'MultiRowLineRenderer' ||\n          self.rendererTypeName === 'MultiRowXYPlotRenderer'\n        )\n      },\n      /**\n       * #getter\n       * positions multi-row below the tracklabel even if using overlap\n       * tracklabels for everything else\n       */\n      get prefersOffset() {\n        return this.isMultiRow\n      },\n\n      /**\n       * #getter\n       */\n      get sourcesWithoutLayout() {\n        const sources = Object.fromEntries(\n          self.sourcesVolatile?.map(s => [s.name, s]) || [],\n        )\n        const iter = self.sourcesVolatile\n        return iter\n          ?.map(s => ({\n            ...sources[s.name],\n            ...s,\n          }))\n          .map((s, i) => ({\n            ...s,\n            color:\n              s.color ||\n              (!this.isMultiRow ? colors[i] || randomColor() : 'blue'),\n          }))\n      },\n\n      /**\n       * #getter\n       */\n      get sources() {\n        const sources = Object.fromEntries(\n          self.sourcesVolatile?.map(s => [s.name, s]) || [],\n        )\n        const iter = self.layout.length ? self.layout : self.sourcesVolatile\n        return iter\n          ?.map(s => ({\n            ...sources[s.name],\n            ...s,\n          }))\n          .map((s, i) => ({\n            ...s,\n            color:\n              s.color ||\n              (!this.isMultiRow ? colors[i] || randomColor() : 'blue'),\n          }))\n      },\n      /**\n       * #getter\n       */\n      get quantitativeStatsReady() {\n        const view = getContainingView(self) as LinearGenomeViewModel\n        return (\n          view.initialized &&\n          self.featureDensityStatsReadyAndRegionNotTooLarge &&\n          !self.error\n        )\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rowHeight() {\n        const { sources, height, isMultiRow } = self\n        return isMultiRow ? height / (sources?.length || 1) : height\n      },\n      /**\n       * #getter\n       */\n      get rowHeightTooSmallForScalebar() {\n        return this.rowHeight < 70\n      },\n\n      /**\n       * #getter\n       */\n      get useMinimalTicks() {\n        return (\n          (getConf(self, 'minimalTicks') as boolean) ||\n          this.rowHeightTooSmallForScalebar\n        )\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        adapterProps() {\n          const superProps = superRenderProps()\n          return {\n            ...superProps,\n            config: self.rendererConfig,\n            filters: self.filters,\n            resolution: self.resolution,\n            sources: self.sources,\n          }\n        },\n        /**\n         * #getter\n         */\n        get ticks() {\n          const { scaleType, domain, isMultiRow, rowHeight, useMinimalTicks } =\n            self\n\n          if (!domain) {\n            return undefined\n          }\n\n          const offset = isMultiRow ? 0 : YSCALEBAR_LABEL_OFFSET\n          const ticks = axisPropsFromTickScale(\n            getScale({\n              scaleType,\n              domain,\n              range: [rowHeight - offset, offset],\n              inverted: getConf(self, 'inverted') as boolean,\n            }),\n            4,\n          )\n          return useMinimalTicks ? { ...ticks, values: domain } : ticks\n        },\n\n        /**\n         * #getter\n         */\n        get colors() {\n          return [\n            'red',\n            'blue',\n            'green',\n            'orange',\n            'purple',\n            'cyan',\n            'pink',\n            'darkblue',\n            'darkred',\n            'pink',\n          ]\n        },\n        /**\n         * #getter\n         * unused currently\n         */\n        get quantitativeStatsRelevantToCurrentZoom() {\n          const view = getContainingView(self) as LinearGenomeViewModel\n          return self.stats?.currStatsBpPerPx === view.bpPerPx\n        },\n      }\n    })\n    .views(self => ({\n      get legendFontSize() {\n        return Math.min(self.rowHeight, 8)\n      },\n\n      get canDisplayLegendLabels() {\n        return self.rowHeight > 7\n      },\n\n      get labelWidth() {\n        const minWidth = 20\n        return max(\n          self.sources\n            ?.map(s => measureText(s.name, this.legendFontSize))\n            .map(width => (this.canDisplayLegendLabels ? width : minWidth)) ||\n            [],\n        )\n      },\n      /**\n       * #method\n       */\n      renderProps() {\n        const superProps = self.adapterProps()\n        return {\n          ...superProps,\n          notReady: superProps.notReady || !self.sources || !self.stats,\n          displayCrossHatches: self.displayCrossHatches,\n          height: self.height,\n          ticks: self.ticks,\n          stats: self.stats,\n          scaleOpts: self.scaleOpts,\n          offset: self.isMultiRow ? 0 : YSCALEBAR_LABEL_OFFSET,\n        }\n      },\n      /**\n       * #method\n       */\n      renderingProps() {\n        return {\n          displayModel: self,\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get hasResolution() {\n        return self.adapterCapabilities.includes('hasResolution')\n      },\n\n      /**\n       * #getter\n       */\n      get hasGlobalStats() {\n        return self.adapterCapabilities.includes('hasGlobalStats')\n      },\n\n      /**\n       * #getter\n       */\n      get fillSetting() {\n        if (self.filled) {\n          return 0\n        } else if (self.minSize === 1) {\n          return 1\n        } else {\n          return 2\n        }\n      },\n    }))\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n      const hasRenderings = getConf(self, 'defaultRendering')\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              subMenu: [\n                {\n                  label: 'Show tooltips',\n                  type: 'checkbox',\n                  checked: self.showTooltipsEnabled,\n                  onClick: () => {\n                    self.setShowTooltips(!self.showTooltipsEnabled)\n                  },\n                },\n                {\n                  label: 'Show sidebar',\n                  type: 'checkbox',\n                  checked: self.showSidebar,\n                  onClick: () => {\n                    self.setShowSidebar(!self.showSidebar)\n                  },\n                },\n                ...(self.graphType\n                  ? [\n                      {\n                        type: 'checkbox',\n                        label: 'Show cross hatches',\n                        checked: self.displayCrossHatchesSetting,\n                        onClick: () => {\n                          self.toggleCrossHatches()\n                        },\n                      },\n                    ]\n                  : []),\n              ],\n            },\n            {\n              label: 'Score',\n              icon: EqualizerIcon,\n              subMenu: self.scoreTrackMenuItems(),\n            },\n\n            ...(self.canHaveFill\n              ? [\n                  {\n                    label: 'Fill mode',\n                    subMenu: ['filled', 'no fill', 'no fill w/ emphasis'].map(\n                      (elt, idx) => ({\n                        label: elt,\n                        type: 'radio',\n                        checked: self.fillSetting === idx,\n                        onClick: () => {\n                          self.setFill(idx)\n                        },\n                      }),\n                    ),\n                  },\n                ]\n              : []),\n            ...(hasRenderings\n              ? [\n                  {\n                    label: 'Renderer type',\n                    subMenu: [\n                      'xyplot',\n                      'multirowxy',\n                      'multirowdensity',\n                      'multiline',\n                      'multirowline',\n                    ].map(key => ({\n                      label: key,\n                      type: 'radio',\n                      checked: self.rendererTypeNameSimple === key,\n                      onClick: () => {\n                        self.setRendererType(key)\n                      },\n                    })),\n                  },\n                ]\n              : []),\n            ...(self.isMultiRow\n              ? [\n                  {\n                    label: 'Cluster rows by score',\n                    onClick: () => {\n                      getSession(self).queueDialog(handleClose => [\n                        WiggleClusterDialog,\n                        {\n                          model: self,\n                          handleClose,\n                        },\n                      ])\n                    },\n                  },\n                ]\n              : []),\n            {\n              label: 'Edit colors/arrangement...',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  SetColorDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n      }\n    })\n    .actions(self => {\n      const { renderSvg: superRenderSvg } = self\n      return {\n        afterAttach() {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises\n          ;(async () => {\n            try {\n              const [\n                { getMultiWiggleSourcesAutorun },\n                { getQuantitativeStatsAutorun },\n              ] = await Promise.all([\n                import('../getMultiWiggleSourcesAutorun.ts'),\n                import('../getQuantitativeStatsAutorun.ts'),\n              ])\n              getQuantitativeStatsAutorun(self)\n              getMultiWiggleSourcesAutorun(self)\n            } catch (e) {\n              if (isAlive(self)) {\n                console.error(e)\n                getSession(self).notifyError(`${e}`, e)\n              }\n            }\n          })()\n        },\n\n        /**\n         * #action\n         */\n        async renderSvg(opts: ExportSvgDisplayOptions) {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self, opts, superRenderSvg)\n        },\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { layout, showSidebar, ...rest } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        // mst types wrong, nullish needed\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        ...(layout?.length ? { layout } : {}),\n        ...(!showSidebar ? { showSidebar } : {}),\n      } as typeof snap\n    })\n}\n\nexport type WiggleDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type WiggleDisplayModel = Instance<WiggleDisplayStateModel>\n\nexport default stateModelFactory\n","import type { Feature } from '@jbrowse/core/util'\n\nexport function stringifyBedGraph({ features }: { features: Feature[] }) {\n  return features\n    .map(feature => {\n      const chrom = feature.get('refName')\n      const start = feature.get('start')\n      const end = feature.get('end')\n      const score = feature.get('score') ?? 0\n      return `${chrom}\\t${start}\\t${end}\\t${score}`\n    })\n    .join('\\n')\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { MultiRenderArgsDeserialized } from '../types.ts'\n\nexport default class MultiRowLineRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config MultiRowLineRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiRowLineRenderer',\n  {\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    summaryScoreMode: {\n      type: 'stringEnum',\n      model: types.enumeration('Score type', ['max', 'min', 'avg', 'whiskers']),\n      description:\n        'choose whether to use max/min/average or whiskers which combines all three into the same rendering',\n      defaultValue: 'avg',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { MultiRenderArgsDeserialized } from '../types.ts'\n\nexport default class MultiRowXYPlotRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config MultiRowXYPlotRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiRowXYPlotRenderer',\n  {\n    /**\n     * #slot\n     */\n    filled: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    summaryScoreMode: {\n      type: 'stringEnum',\n      model: types.enumeration('Score type', ['max', 'min', 'avg', 'whiskers']),\n      description:\n        'choose whether to use max/min/average or whiskers which combines all three into the same rendering',\n      defaultValue: 'whiskers',\n    },\n    /**\n     * #slot\n     */\n    minSize: {\n      type: 'number',\n      defaultValue: 0.7,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config MultiWiggleAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst MultiWiggleAdapter = ConfigurationSchema(\n  'MultiWiggleAdapter',\n  {\n    /**\n     * #slot\n     */\n    subadapters: {\n      type: 'frozen',\n      defaultValue: [],\n      description: 'array of subadapter JSON objects',\n    },\n    /**\n     * #slot\n     */\n    bigWigs: {\n      type: 'frozen',\n      description:\n        'array of bigwig filenames, alternative to the subadapters slot',\n      defaultValue: [],\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default MultiWiggleAdapter\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { MultiRenderArgsDeserialized } from '../types.ts'\n\nexport default class MultiXYPlotRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config MultiXYPlotRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiXYPlotRenderer',\n  {\n    /**\n     * #slot\n     */\n    filled: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    summaryScoreMode: {\n      type: 'stringEnum',\n      model: types.enumeration('Score type', ['max', 'min', 'avg', 'whiskers']),\n      description:\n        'choose whether to use max/min/average or whiskers which combines all three into the same rendering',\n      defaultValue: 'avg',\n    },\n    /**\n     * #slot\n     */\n    minSize: {\n      type: 'number',\n      defaultValue: 0.7,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\nexport default configSchema\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { QuantitativeStats } from '@jbrowse/core/util/stats'\n\nexport class WiggleGetGlobalQuantitativeStats extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'WiggleGetGlobalQuantitativeStats'\n\n  async execute(\n    args: {\n      adapterConfig: AnyConfigurationModel\n      stopToken?: string\n      headers?: Record<string, string>\n      sessionId: string\n    },\n    rpcDriverClassName: string,\n  ): Promise<QuantitativeStats> {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { adapterConfig, sessionId } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n\n    // @ts-expect-error\n    return dataAdapter.getGlobalStats(deserializedArgs)\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\nimport { renameRegionsIfNeeded } from '@jbrowse/core/util'\n\nimport type { RenderArgs } from '@jbrowse/core/rpc/coreRpcMethods'\nimport type { Region } from '@jbrowse/core/util'\n\nexport class WiggleGetMultiRegionQuantitativeStats extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'WiggleGetMultiRegionQuantitativeStats'\n\n  async serializeArguments(\n    args: RenderArgs & {\n      staticBlocks?: Region[]\n      stopToken?: string\n      statusCallback?: (arg: string) => void\n    },\n    rpcDriverClassName: string,\n  ) {\n    const pm = this.pluginManager\n    const assemblyManager = pm.rootModel?.session?.assemblyManager\n    if (!assemblyManager) {\n      throw new Error('no assembly manager')\n    }\n\n    // Also rename staticBlocks if present\n    let renamedStaticBlocks = args.staticBlocks\n    if (args.staticBlocks?.length) {\n      const renamed = await renameRegionsIfNeeded(assemblyManager, {\n        ...args,\n        regions: args.staticBlocks,\n      })\n      renamedStaticBlocks = renamed.regions\n    }\n\n    const baseResult = await super.serializeArguments(args, rpcDriverClassName)\n    return {\n      ...baseResult,\n      staticBlocks: renamedStaticBlocks,\n    }\n  }\n\n  async execute(\n    args: {\n      adapterConfig: Record<string, unknown>\n      stopToken?: string\n      sessionId: string\n      trackInstanceId: string\n      headers?: Record<string, string>\n      regions: Region[]\n      staticBlocks?: Region[]\n      bpPerPx: number\n    },\n    rpcDriverClassName: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { regions, staticBlocks, adapterConfig, sessionId } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n\n    // @ts-expect-error\n    return dataAdapter.getMultiRegionQuantitativeStats(regions, {\n      ...deserializedArgs,\n      staticBlocks,\n    })\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Region } from '@jbrowse/core/util'\n\nexport class MultiWiggleGetSources extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiWiggleGetSources'\n\n  async execute(\n    args: {\n      adapterConfig: AnyConfigurationModel\n      stopToken?: string\n      sessionId: string\n      headers?: Record<string, string>\n      regions: Region[]\n      bpPerPx: number\n    },\n    rpcDriverClassName: string,\n  ) {\n    const pm = this.pluginManager\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { regions, adapterConfig, sessionId } = deserializedArgs\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n\n    // @ts-expect-error\n    return dataAdapter.getSources(regions, deserializedArgs)\n  }\n}\n","import RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport { getScoreMatrix } from './getScoreMatrix.ts'\n\nimport type { GetScoreMatrixArgs } from './types.ts'\n\nexport class MultiWiggleGetScoreMatrix extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiWiggleGetScoreMatrix'\n\n  async execute(args: GetScoreMatrixArgs, rpcDriverClassName: string) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n\n    return getScoreMatrix({\n      args: deserializedArgs,\n      pluginManager: this.pluginManager,\n    })\n  }\n}\n","import RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport type { GetScoreMatrixArgs } from './types.ts'\n\nexport class MultiWiggleClusterScoreMatrix extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiWiggleClusterScoreMatrix'\n\n  async execute(args: GetScoreMatrixArgs, rpcDriverClassName: string) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { executeClusterScoreMatrix } =\n      await import('./executeClusterScoreMatrix.ts')\n    return executeClusterScoreMatrix({\n      pluginManager: this.pluginManager,\n      args: deserializedArgs,\n    })\n  }\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nimport type { RenderArgsDeserialized } from '../types.ts'\n\nexport default class XYPlotRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { makeImageData } = await import('./makeImageData.ts')\n    return makeImageData(renderProps, this.pluginManager)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport baseWiggleRendererConfigSchema from '../configSchema.ts'\n\n/**\n * #config XYPlotRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'XYPlotRenderer',\n  {\n    /**\n     * #slot\n     */\n    filled: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    displayCrossHatches: {\n      type: 'boolean',\n      description: 'choose to draw cross hatches (sideways lines)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    summaryScoreMode: {\n      type: 'stringEnum',\n      model: types.enumeration('Score type', ['max', 'min', 'avg', 'whiskers']),\n      description:\n        'choose whether to use max/min/average or whiskers which combines all three into the same rendering',\n      defaultValue: 'whiskers',\n    },\n    /**\n     * #slot\n     */\n    minSize: {\n      type: 'number',\n      defaultValue: 0.7,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseWiggleRendererConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport BigWigAdapterF from './BigWigAdapter/index.ts'\nimport CreateMultiWiggleExtensionF from './CreateMultiWiggleExtension/index.ts'\nimport DensityRendererF from './DensityRenderer/index.ts'\nimport GuessAdapterF from './GuessAdapter/index.ts'\nimport LinePlotRendererF from './LinePlotRenderer/index.ts'\nimport LinearWiggleDisplayF, {\n  ReactComponent as LinearWiggleDisplayReactComponent,\n  modelFactory as linearWiggleDisplayModelFactory,\n} from './LinearWiggleDisplay/index.ts'\nimport MultiDensityRendererF from './MultiDensityRenderer/index.ts'\nimport MultiLineRendererF from './MultiLineRenderer/index.ts'\nimport MultiLinearWiggleDisplayF from './MultiLinearWiggleDisplay/index.ts'\nimport MultiQuantitativeTrackF from './MultiQuantitativeTrack/index.ts'\nimport MultiRowLineRendererF from './MultiRowLineRenderer/index.ts'\nimport MultiRowXYPlotRendererF from './MultiRowXYPlotRenderer/index.ts'\nimport MultiWiggleAdapterF from './MultiWiggleAdapter/index.ts'\nimport MultiWiggleAddTrackWorkflowF from './MultiWiggleAddTrackWorkflow/index.ts'\nimport MultiXYPlotRendererF from './MultiXYPlotRenderer/index.ts'\nimport QuantitativeTrackF from './QuantitativeTrack/index.ts'\nimport {\n  MultiWiggleClusterScoreMatrix,\n  MultiWiggleGetScoreMatrix,\n  MultiWiggleGetSources,\n  WiggleGetGlobalQuantitativeStats,\n  WiggleGetMultiRegionQuantitativeStats,\n} from './WiggleRPC/rpcMethods.ts'\nimport XYPlotRendererF, {\n  ReactComponent as XYPlotRendererReactComponent,\n  XYPlotRenderer,\n  configSchema as xyPlotRendererConfigSchema,\n} from './XYPlotRenderer/index.ts'\nimport * as utils from './util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class WigglePlugin extends Plugin {\n  name = 'WigglePlugin'\n\n  install(pm: PluginManager) {\n    MultiWiggleAdapterF(pm)\n    BigWigAdapterF(pm)\n    QuantitativeTrackF(pm)\n    MultiQuantitativeTrackF(pm)\n    LinearWiggleDisplayF(pm)\n    MultiLinearWiggleDisplayF(pm)\n    LinePlotRendererF(pm)\n    XYPlotRendererF(pm)\n    DensityRendererF(pm)\n    MultiXYPlotRendererF(pm)\n    MultiRowXYPlotRendererF(pm)\n    MultiDensityRendererF(pm)\n    MultiLineRendererF(pm)\n    MultiRowLineRendererF(pm)\n    MultiWiggleAddTrackWorkflowF(pm)\n    CreateMultiWiggleExtensionF(pm)\n    GuessAdapterF(pm)\n\n    pm.addRpcMethod(() => new WiggleGetGlobalQuantitativeStats(pm))\n    pm.addRpcMethod(() => new WiggleGetMultiRegionQuantitativeStats(pm))\n    pm.addRpcMethod(() => new MultiWiggleGetSources(pm))\n    pm.addRpcMethod(() => new MultiWiggleGetScoreMatrix(pm))\n    pm.addRpcMethod(() => new MultiWiggleClusterScoreMatrix(pm))\n  }\n\n  exports = {\n    LinearWiggleDisplayReactComponent,\n    XYPlotRendererReactComponent,\n    XYPlotRenderer,\n    linearWiggleDisplayModelFactory,\n    xyPlotRendererConfigSchema,\n    utils,\n  }\n}\n\nexport * from './util.ts'\n\nexport { default as WiggleRendering } from './WiggleRendering.tsx'\nexport {\n  ReactComponent as LinearWiggleDisplayReactComponent,\n  Tooltip,\n  modelFactory as linearWiggleDisplayModelFactory,\n} from './LinearWiggleDisplay/index.ts'\nexport type { TooltipContentsComponent } from './Tooltip.tsx'\n\nexport type {\n  MultiRenderArgsDeserialized,\n  RenderArgsDeserialized,\n  RenderArgsDeserializedWithFeatures,\n} from './types.ts'\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiWiggleAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'MultiWiggleAdapter',\n        displayName: 'Multi-wiggle adapter',\n        configSchema,\n        adapterCapabilities: [\n          'hasResolution',\n          'hasLocalStats',\n          'hasGlobalStats',\n        ],\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n        getAdapterClass: () =>\n          import('./MultiWiggleAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BigWigAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BigWigAdapter',\n        displayName: 'BigWig adapter',\n        configSchema,\n        adapterCapabilities: [\n          'hasResolution',\n          'hasLocalStats',\n          'hasGlobalStats',\n        ],\n        getAdapterClass: () =>\n          import('./BigWigAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\nimport { stringifyBedGraph } from '../saveTrackFormats/bedGraph.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function QuantitativeTrackF(pluginManager: PluginManager) {\n  pluginManager.addTrackType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new TrackType({\n      name: 'QuantitativeTrack',\n      displayName: 'Quantitative track',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pluginManager,\n        'QuantitativeTrack',\n        configSchema,\n      ).views(() => ({\n        saveTrackFileFormatOptions() {\n          return {\n            bedGraph: {\n              name: 'BedGraph',\n              extension: 'bedgraph',\n              callback: stringifyBedGraph,\n            },\n          }\n        },\n      })),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config QuantitativeTrack\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nfunction configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'QuantitativeTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n}\n\nexport default configSchemaFactory\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\nimport { stringifyBedGraph } from '../saveTrackFormats/bedGraph.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiQuantitativeTrackF(pluginManager: PluginManager) {\n  pluginManager.addTrackType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new TrackType({\n      name: 'MultiQuantitativeTrack',\n      displayName: 'Multi-quantitative track',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pluginManager,\n        'MultiQuantitativeTrack',\n        configSchema,\n      ).views(() => ({\n        saveTrackFileFormatOptions() {\n          return {\n            bedGraph: {\n              name: 'BedGraph',\n              extension: 'bedgraph',\n              callback: stringifyBedGraph,\n            },\n          }\n        },\n      })),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config MultiQuantitativeTrack\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) => {\n  return ConfigurationSchema(\n    'MultiQuantitativeTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n}\n\nexport default configSchema\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearWiggleDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    const stateModel = modelFactory(pluginManager, configSchema)\n    return new DisplayType({\n      name: 'LinearWiggleDisplay',\n      displayName: 'Wiggle display',\n      configSchema,\n      stateModel,\n      trackType: 'QuantitativeTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/WiggleDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n\nexport { default as Tooltip } from './components/Tooltip.tsx'\nexport { default as ReactComponent } from './components/WiggleDisplayComponent.tsx'\nexport { default as modelFactory } from './model.ts'\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport sharedWiggleConfigFactory from '../shared/SharedWiggleConfigSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearWiggleDisplay\n * extends\n * - [SharedWiggleDisplay](../sharedwiggledisplay)\n */\nexport default function WiggleConfigFactory(pluginManager: PluginManager) {\n  const XYPlotRendererConfigSchema =\n    pluginManager.getRendererType('XYPlotRenderer')!.configSchema\n  const DensityRendererConfigSchema =\n    pluginManager.getRendererType('DensityRenderer')!.configSchema\n  const LinePlotRendererConfigSchema =\n    pluginManager.getRendererType('LinePlotRenderer')!.configSchema\n\n  return ConfigurationSchema(\n    'LinearWiggleDisplay',\n    {\n      /**\n       * #slot\n       */\n      defaultRendering: {\n        type: 'stringEnum',\n        model: types.enumeration('Rendering', ['density', 'xyplot', 'line']),\n        defaultValue: 'xyplot',\n      },\n      /**\n       * #slot\n       */\n      renderers: ConfigurationSchema('RenderersConfiguration', {\n        DensityRenderer: DensityRendererConfigSchema,\n        XYPlotRenderer: XYPlotRendererConfigSchema,\n        LinePlotRenderer: LinePlotRendererConfigSchema,\n      }),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: sharedWiggleConfigFactory(),\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiLinearWiggleDisplayF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'MultiLinearWiggleDisplay',\n      displayName: 'Multi-wiggle display',\n      configSchema,\n      stateModel: modelFactory(pluginManager, configSchema),\n      trackType: 'MultiQuantitativeTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/WiggleDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport sharedWiggleConfigFactory from '../shared/SharedWiggleConfigSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config MultiLinearWiggleDisplay\n * extends\n * - [SharedWiggleDisplay](../sharedwiggledisplay)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function WiggleConfigFactory(pluginManager: PluginManager) {\n  const MultiXYPlotRendererConfigSchema = pluginManager.getRendererType(\n    'MultiXYPlotRenderer',\n  )!.configSchema\n  const MultiDensityRendererConfigSchema = pluginManager.getRendererType(\n    'MultiDensityRenderer',\n  )!.configSchema\n  const MultiRowXYPlotRendererConfigSchema = pluginManager.getRendererType(\n    'MultiRowXYPlotRenderer',\n  )!.configSchema\n  const MultiLineRendererConfigSchema =\n    pluginManager.getRendererType('MultiLineRenderer')!.configSchema\n  const MultiRowLineRendererConfigSchema = pluginManager.getRendererType(\n    'MultiRowLineRenderer',\n  )!.configSchema\n\n  return ConfigurationSchema(\n    'MultiLinearWiggleDisplay',\n    {\n      /**\n       * #slot\n       */\n      defaultRendering: {\n        type: 'stringEnum',\n        model: types.enumeration('Rendering', [\n          'multirowxy',\n          'xyplot',\n          'multirowdensity',\n          'multiline',\n          'multirowline',\n        ]),\n        defaultValue: 'multirowxy',\n      },\n\n      /**\n       * #slot\n       */\n      renderers: ConfigurationSchema('RenderersConfiguration', {\n        MultiXYPlotRenderer: MultiXYPlotRendererConfigSchema,\n        MultiDensityRenderer: MultiDensityRendererConfigSchema,\n        MultiRowXYPlotRenderer: MultiRowXYPlotRendererConfigSchema,\n        MultiLineRenderer: MultiLineRendererConfigSchema,\n        MultiRowLineRenderer: MultiRowLineRendererConfigSchema,\n      }),\n\n      /**\n       * #slot\n       */\n      height: {\n        type: 'number',\n        defaultValue: 200,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: sharedWiggleConfigFactory(),\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport LinePlotRenderer from './LinePlotRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinePlotRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new LinePlotRenderer({\n        name: 'LinePlotRenderer',\n        ReactComponent: lazy(() => import('../WiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport XYPlotRenderer from './XYPlotRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function XYPlotRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(() => {\n    return new XYPlotRenderer({\n      name: 'XYPlotRenderer',\n      ReactComponent: lazy(() => import('../WiggleRendering.tsx')),\n      configSchema,\n      pluginManager,\n    })\n  })\n}\n\nexport { default as XYPlotRenderer } from './XYPlotRenderer.ts'\nexport { default as ReactComponent } from '../WiggleRendering.tsx'\nexport { default as configSchema } from './configSchema.ts'\n","import { lazy } from 'react'\n\nimport DensityRenderer from './DensityRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function DensityRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(() => {\n    return new DensityRenderer({\n      name: 'DensityRenderer',\n      ReactComponent: lazy(() => import('../WiggleRendering.tsx')),\n      configSchema,\n      pluginManager,\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport MultiXYPlotRenderer from './MultiXYPlotRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiXYPlotRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new MultiXYPlotRenderer({\n        name: 'MultiXYPlotRenderer',\n        ReactComponent: lazy(() => import('../MultiWiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport MultiRowXYPlotRenderer from './MultiRowXYPlotRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiRowXYPlotRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new MultiRowXYPlotRenderer({\n        name: 'MultiRowXYPlotRenderer',\n        ReactComponent: lazy(() => import('../MultiWiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport MultiDensityRenderer from './MultiDensityRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiDensityRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new MultiDensityRenderer({\n        name: 'MultiDensityRenderer',\n        ReactComponent: lazy(() => import('../MultiWiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport MultiLineRenderer from './MultiLineRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiLineRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new MultiLineRenderer({\n        name: 'MultiLineRenderer',\n        ReactComponent: lazy(() => import('../MultiWiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport MultiRowLineRenderer from './MultiRowLineRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiRowLineRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new MultiRowLineRenderer({\n        name: 'MultiRowLineRenderer',\n        ReactComponent: lazy(() => import('../MultiWiggleRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport { AddTrackWorkflowType } from '@jbrowse/core/pluggableElementTypes'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiWiggleAddTrackWorkflowF(pm: PluginManager) {\n  pm.addAddTrackWorkflowType(\n    () =>\n      new AddTrackWorkflowType({\n        name: 'Multi-wiggle track',\n        ReactComponent: lazy(() => import('./AddTrackWorkflow.tsx')),\n        stateModel: types.model({}),\n      }),\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport { getFileName } from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAdapterF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (cb: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        return testAdapter(\n          fileName,\n          /\\.(bw|bigwig)$/i,\n          adapterHint,\n          'BigWigAdapter',\n        )\n          ? {\n              type: 'BigWigAdapter',\n              bigWigLocation: file,\n            }\n          : cb(file, index, adapterHint)\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        return adapterName === 'BigWigAdapter'\n          ? 'QuantitativeTrack'\n          : trackTypeGuesser(adapterName)\n      }\n    },\n  )\n}\n","import { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { BaseFeatureDataAdapter } from './BaseFeatureDataAdapter.ts'\n\nimport type { BaseOptions } from './types.ts'\nimport type { NoAssemblyRegion } from '../../util/index.ts'\nimport type { RegionsAdapter } from '../BaseAdapter/index.ts'\n\nexport abstract class BaseSequenceAdapter\n  extends BaseFeatureDataAdapter\n  implements RegionsAdapter\n{\n  async getMultiRegionFeatureDensityStats() {\n    return { featureDensity: 0 }\n  }\n\n  /**\n   * Fetches a list of 'regions' with refName, start, and extends\n   */\n  abstract getRegions(opts: BaseOptions): Promise<NoAssemblyRegion[]>\n\n  /**\n   * Fetches the sequence string for a given region\n   * @param region - Region to fetch sequence for\n   * @param opts - Adapter options\n   * @returns The sequence string for the region\n   */\n  async getSequence(region: NoAssemblyRegion, opts?: BaseOptions) {\n    const features = await firstValueFrom(\n      this.getFeatures({ ...region, assemblyName: '' }, opts).pipe(toArray()),\n    )\n    return features[0]?.get('seq') as string | undefined\n  }\n}\n","import { assembleLocString, parseLocString } from '@jbrowse/core/util'\n\nimport type { AssemblyManager, ParsedLocString } from '@jbrowse/core/util'\nimport type { BaseBlock } from '@jbrowse/core/util/blockTypes'\n\n/**\n * Expand a region by a grow factor, adding padding on each side.\n *\n * @param start - region start coordinate\n * @param end - region end coordinate\n * @param grow - multiplier for expansion (e.g., 0.2 adds 20% padding on each\n * side)\n * @param minBound - minimum bound to clamp start to (default 0)\n * @param maxBound - maximum bound to clamp end to (default Infinity)\n * @returns object with expanded start and end coordinates\n */\nexport function expandRegion(\n  start: number,\n  end: number,\n  grow: number,\n  minBound = 0,\n  maxBound = Infinity,\n) {\n  const len = end - start\n  const margin = len * grow\n  return {\n    start: Math.max(minBound, start - margin),\n    end: Math.min(maxBound, end + margin),\n  }\n}\n\n/**\n * Given a scale ( bp/px ) and minimum distances (px) between major and minor\n * gridlines, return an object like `{ majorPitch: bp, minorPitch: bp }` giving\n * the gridline pitches to use.\n */\nexport function chooseGridPitch(\n  scale: number,\n  minMajorPitchPx: number,\n  minMinorPitchPx: number,\n) {\n  scale = Math.abs(scale)\n  const minMajorPitchBp = minMajorPitchPx * scale\n  const majorMagnitude = +minMajorPitchBp.toExponential().split(/e/i)[1]!\n\n  let majorPitch = 10 ** majorMagnitude\n  while (majorPitch < minMajorPitchBp) {\n    majorPitch *= 2\n    if (majorPitch >= minMajorPitchBp) {\n      break\n    }\n    majorPitch *= 2.5\n  }\n\n  majorPitch = Math.max(majorPitch, 5)\n\n  const majorPitchPx = majorPitch / scale\n\n  let minorPitch = 0\n  if (!(majorPitch % 10) && majorPitchPx / 10 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 10\n  } else if (!(majorPitch % 5) && majorPitchPx / 5 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 5\n  } else if (!(majorPitch % 2) && majorPitchPx / 2 >= minMinorPitchPx) {\n    minorPitch = majorPitch / 2\n  }\n\n  return { majorPitch, minorPitch }\n}\n\nexport function makeTicks(\n  start: number,\n  end: number,\n  bpPerPx: number,\n  emitMajor = true,\n  emitMinor = true,\n) {\n  const gridPitch = chooseGridPitch(bpPerPx, 60, 15)\n\n  let minBase = start\n  let maxBase = end\n\n  if (bpPerPx < 0) {\n    ;[minBase, maxBase] = [maxBase, minBase]\n  }\n\n  // add 20px additional on the right and left to allow us to draw the ends\n  // of labels that lie a little outside our region\n  minBase -= Math.abs(20 * bpPerPx) - 1\n  maxBase += Math.abs(20 * bpPerPx) + 1\n\n  const iterPitch = gridPitch.minorPitch || gridPitch.majorPitch\n  let index = 0\n  const ticks = []\n  for (\n    let base = Math.floor(minBase / iterPitch) * iterPitch;\n    base < Math.ceil(maxBase / iterPitch) * iterPitch + 1;\n    base += iterPitch\n  ) {\n    if (emitMinor && base % (gridPitch.majorPitch * 2)) {\n      ticks.push({ type: 'minor', base: base - 1, index })\n      index += 1\n    } else if (emitMajor && !(base % (gridPitch.majorPitch * 2))) {\n      ticks.push({ type: 'major', base: base - 1, index })\n      index += 1\n    }\n  }\n  return ticks\n}\n\n/**\n * Generate location objects for a set of parsed locstrings, which includes\n * translating the refNames to assembly-canonical refNames and adding the\n * 'parentRegion'\n *\n * Used by navToLocations and navToLocString\n *\n * @param regions - array of parsed location strings to generate locations for\n * @param assemblyManager - the assembly manager instance\n * @param assemblyName - optional assembly name to use for regions that don't\n * specify one\n * @param grow - optional multiplier to expand regions by (e.g., 0.2 adds 20%\n * padding on each side of the region). Useful for adding visual padding when\n * navigating to a feature\n */\nexport async function generateLocations({\n  regions,\n  assemblyManager,\n  assemblyName,\n  grow,\n}: {\n  regions: ParsedLocString[]\n  assemblyManager: AssemblyManager\n  assemblyName?: string\n  grow?: number\n}) {\n  return Promise.all(\n    regions.map(async region => {\n      const asmName = region.assemblyName || assemblyName\n      if (!asmName) {\n        throw new Error('no assembly provided')\n      }\n      const asm = await assemblyManager.waitForAssembly(asmName)\n      const { refName } = region\n      if (!asm) {\n        throw new Error(`assembly ${asmName} not found`)\n      }\n      const { regions } = asm\n      if (!regions) {\n        throw new Error(`regions not loaded yet for ${asmName}`)\n      }\n      const canonicalRefName = asm.getCanonicalRefName(region.refName)\n      if (!canonicalRefName) {\n        throw new Error(`Could not find refName ${refName} in ${asm.name}`)\n      }\n      const parentRegion = regions.find(r => r.refName === canonicalRefName)\n      if (!parentRegion) {\n        throw new Error(`Could not find refName ${refName} in ${asmName}`)\n      }\n\n      const { start, end } = region\n      const expanded =\n        grow && start !== undefined && end !== undefined\n          ? expandRegion(start, end, grow)\n          : undefined\n      return {\n        ...(region as Omit<typeof region, symbol>),\n        ...(expanded ? { start: expanded.start, end: expanded.end } : {}),\n        assemblyName: asmName,\n        parentRegion,\n      }\n    }),\n  )\n}\n\n/**\n * Parses locString or space separated set of locStrings into location objects\n * Example inputs:\n * \"chr1\"\n * \"chr1:1-100\"\n * \"chr1:1..100\"\n * \"chr1 chr2\"\n * \"chr1:1-100 chr2:1-100\"\n * \"chr1 100 200\" equivalent to \"chr1:1-100\"\n *\n * Used by navToLocString\n */\nexport function parseLocStrings(\n  input: string,\n  assemblyName: string,\n  isValidRefName: (str: string, assemblyName: string) => boolean,\n) {\n  const inputs = input\n    .split(/(\\s+)/)\n    .map(f => f.trim())\n    .filter(f => !!f)\n  // first try interpreting as a whitespace-separated sequence of\n  // multiple locstrings\n  try {\n    return inputs.map(loc =>\n      parseLocString(loc, ref => isValidRefName(ref, assemblyName)),\n    )\n  } catch (e) {\n    // if this fails, try interpreting as a whitespace-separated refname,\n    // start, end if start and end are integer inputs\n    const [refName, start, end] = inputs\n    if (\n      /Unknown feature or sequence/.exec(`${e}`) &&\n      Number.isInteger(+start!) &&\n      Number.isInteger(+end!)\n    ) {\n      return [\n        parseLocString(`${refName}:${start}..${end}`, ref =>\n          isValidRefName(ref, assemblyName),\n        ),\n      ]\n    }\n    throw e\n  }\n}\n\nexport function calculateVisibleLocStrings(contentBlocks: BaseBlock[]) {\n  if (!contentBlocks.length) {\n    return ''\n  } else {\n    const isSingleAssemblyName = contentBlocks.every(\n      b => b.assemblyName === contentBlocks[0]!.assemblyName,\n    )\n    return contentBlocks\n      .map(block =>\n        assembleLocString({\n          refName: block.refName,\n          start: Math.round(block.start),\n          end: Math.round(block.end),\n          assemblyName: isSingleAssemblyName ? undefined : block.assemblyName,\n          reversed: block.reversed,\n        }),\n      )\n      .join(' ')\n  }\n}\n","import { useEffect, useRef, useState } from 'react'\n\nexport default function useMeasure() {\n  const ref = useRef<HTMLDivElement>(null)\n  const [dims, setDims] = useState<{ width?: number; height?: number }>({\n    width: undefined,\n    height: undefined,\n  })\n  useEffect(() => {\n    if (!ref.current) {\n      return\n    }\n    const RS =\n      typeof window !== 'undefined' && 'ResizeObserver' in window\n        ? window.ResizeObserver\n        : undefined\n\n    if (!RS) {\n      return\n    }\n    const observer = new RS(entries => {\n      setDims({\n        width: entries[0]!.contentRect.width,\n        height: entries[0]!.contentRect.height,\n      })\n    })\n    observer.observe(ref.current)\n\n    // Callback fired when component is unmounted\n    return () => {\n      observer.disconnect()\n    }\n  }, [])\n\n  return [ref, dims] as const\n}\n","import { adapterConfigCacheKey } from './util.ts'\n\nimport type PluginManager from '../PluginManager.ts'\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { AnyDataAdapter } from './BaseAdapter/index.ts'\nimport type { SnapshotIn } from '@jbrowse/mobx-state-tree'\n\ntype ConfigSnap = SnapshotIn<AnyConfigurationSchemaType>\n\ninterface AdapterCacheEntry {\n  dataAdapter: AnyDataAdapter\n  sessionIds: Set<string>\n}\n\nlet adapterCache: Record<string, Promise<AdapterCacheEntry>> = {}\n\nasync function getAdapterPre(\n  pluginManager: PluginManager,\n  sessionId: string,\n  adapterConfigSnapshot: SnapshotIn<AnyConfigurationSchemaType>,\n) {\n  const adapterType = adapterConfigSnapshot?.type\n\n  if (!adapterType) {\n    throw new Error(\n      `could not determine adapter type from adapter config snapshot ${JSON.stringify(\n        adapterConfigSnapshot,\n      )}`,\n    )\n  }\n  const dataAdapterType = pluginManager.getAdapterType(adapterType)\n  if (!dataAdapterType) {\n    throw new Error(`unknown data adapter type ${adapterType}`)\n  }\n\n  // instantiate the data adapter's config schema so it gets its defaults,\n  // callbacks, etc\n  const adapterConfig = dataAdapterType.configSchema.create(\n    adapterConfigSnapshot,\n    { pluginManager },\n  )\n\n  const getSubAdapter = getAdapter.bind(null, pluginManager, sessionId)\n  const CLASS = await dataAdapterType.getAdapterClass()\n  const dataAdapter = new CLASS(adapterConfig, getSubAdapter, pluginManager)\n\n  return {\n    dataAdapter,\n    sessionIds: new Set([sessionId]),\n  }\n}\n\n/**\n * instantiate a data adapter, or return an already-instantiated one if we have\n * one with the same configuration\n *\n * @param pluginManager\n *\n * @param sessionId - session ID of the associated worker session. used for\n * reference counting\n *\n * @param adapterConfigSnapshot - plain-JS configuration snapshot for the\n * adapter\n */\nexport async function getAdapter(\n  pluginManager: PluginManager,\n  sessionId: string,\n  adapterConfigSnapshot: SnapshotIn<AnyConfigurationSchemaType>,\n): Promise<AdapterCacheEntry> {\n  const cacheKey = adapterConfigCacheKey(adapterConfigSnapshot)\n  adapterCache[cacheKey] ??= getAdapterPre(\n    pluginManager,\n    sessionId,\n    adapterConfigSnapshot,\n  )\n  const ret = await adapterCache[cacheKey]\n  ret.sessionIds.add(sessionId)\n  return ret\n}\n\n/**\n * this is a callback that is passed to adapters that allows them to get any\n * sub-adapters that they need internally, staying with the same worker session\n * ID\n */\nexport type getSubAdapterType = (\n  adapterConfigSnap: ConfigSnap,\n) => ReturnType<typeof getAdapter>\n\nexport async function freeAdapterResources(args: Record<string, any>) {\n  const specKeys = Object.keys(args)\n\n  // TODO: little hacky...should make it an explicit command but:\n  // if we don't specify a range, delete any adapters that are only associated\n  // with that session\n  if (specKeys.length === 1 && specKeys[0] === 'sessionId') {\n    const { sessionId } = args\n    for (const [cacheKey, cacheEntryP] of Object.entries(adapterCache)) {\n      const cacheEntry = await cacheEntryP\n      cacheEntry.sessionIds.delete(sessionId)\n      if (cacheEntry.sessionIds.size === 0) {\n        delete adapterCache[cacheKey]\n      }\n    }\n  } else {\n    // otherwise call freeResources on all the cached data adapters\n    for (const cacheEntryP of Object.values(adapterCache)) {\n      const cacheEntry = await cacheEntryP\n      const regions = args.regions || (args.region ? [args.region] : [])\n      for (const region of regions) {\n        if (region.refName !== undefined) {\n          cacheEntry.dataAdapter.freeResources(region)\n        }\n      }\n    }\n  }\n}\n\nexport function clearAdapterCache() {\n  adapterCache = {}\n}\n","import {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n} from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\n\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\nimport type { CircularViewModel } from '@jbrowse/plugin-circular-view'\n\nexport function renderReactionData(self: any) {\n  const view = getContainingView(self) as CircularViewModel\n  const { rendererType } = self\n  const { rpcManager } = getSession(view)\n\n  return {\n    rendererType,\n    rpcManager,\n    renderProps: self.renderProps(),\n    renderingProps: self.renderingProps?.() as\n      | Record<string, unknown>\n      | undefined,\n    renderArgs: {\n      assemblyName: view.displayedRegions[0]!.assemblyName,\n      adapterConfig: structuredClone(self.adapterConfig),\n      rendererType: rendererType.name,\n      regions: structuredClone(view.displayedRegions),\n      blockDefinitions: self.blockDefinitions,\n      sessionId: getRpcSessionId(self),\n      trackInstanceId: getContainingTrack(self).id,\n      timeout: 1000000,\n    },\n  }\n}\n\nexport async function renderReactionEffect(props?: any, stopToken?: StopToken) {\n  if (!props) {\n    throw new Error('cannot render with no props')\n  }\n\n  const {\n    rendererType,\n    rpcManager,\n    cannotBeRenderedReason,\n    renderArgs,\n    renderProps,\n    renderingProps,\n    exportSVG,\n  } = props\n\n  if (cannotBeRenderedReason) {\n    return { message: cannotBeRenderedReason }\n  }\n\n  // don't try to render 0 or NaN radius or no regions\n  if (!renderProps.radius || !renderArgs.regions?.length) {\n    return { message: 'Skipping render' }\n  }\n\n  const { html, ...data } = await rendererType.renderInClient(rpcManager, {\n    ...renderArgs,\n    ...renderProps,\n    renderingProps,\n    exportSVG,\n    stopToken,\n  })\n\n  return {\n    html,\n    data,\n    reactElement: data.reactElement,\n    renderingComponent: rendererType.ReactComponent,\n  }\n}\n","import type React from 'react'\n\nimport PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { IAnyModelType } from '@jbrowse/mobx-state-tree'\n\ntype BasicComponent = React.ComponentType<{\n  model: any\n}>\ntype AddTrackWorkflowComponentType =\n  | React.LazyExoticComponent<BasicComponent>\n  | BasicComponent\n\nexport default class AddTrackWorkflow extends PluggableElementBase {\n  ReactComponent: AddTrackWorkflowComponentType\n\n  stateModel: IAnyModelType\n\n  constructor(stuff: {\n    name: string\n    ReactComponent: AddTrackWorkflowComponentType\n    stateModel: IAnyModelType\n  }) {\n    super(stuff)\n    this.ReactComponent = stuff.ReactComponent\n    this.stateModel = stuff.stateModel\n  }\n}\n","import type { Region } from '../../util/index.ts'\n\nexport function normalizeRegion(region: Region): Region {\n  return {\n    ...region,\n    start: Math.floor(region.start),\n    end: Math.ceil(region.end),\n  }\n}\n\n/**\n * Expands a region by a given number of base pairs in both directions.\n * Useful for fetching features that may extend beyond the visible region.\n */\nexport function expandRegion(region: Region, bpExpansion: number): Region {\n  return {\n    ...(region as Omit<typeof region, symbol>),\n    start: Math.floor(Math.max(region.start - bpExpansion, 0)),\n    end: Math.ceil(region.end + bpExpansion),\n  }\n}\n","import { SimpleFeature, mergeIntervals } from '@jbrowse/core/util'\n\nimport type RpcManager from '@jbrowse/core/rpc/RpcManager'\nimport type { Feature } from '@jbrowse/core/util'\n\n/**\n * Fetch a feature by ID via RPC from the renderer's layout cache.\n * For subfeatures, fetches the parent and finds the subfeature within it.\n */\nexport async function fetchFeatureByIdRpc({\n  rpcManager,\n  sessionId,\n  trackId,\n  rendererType,\n  featureId,\n  parentFeatureId,\n}: {\n  rpcManager: RpcManager\n  sessionId: string\n  trackId: string\n  rendererType: string\n  featureId: string\n  parentFeatureId?: string\n}): Promise<Feature | undefined> {\n  // Fetch the feature (or parent if looking for subfeature)\n  const lookupId = parentFeatureId || featureId\n  const { feature: featureData } = (await rpcManager.call(\n    sessionId,\n    'CoreGetFeatureDetails',\n    {\n      featureId: lookupId,\n      sessionId,\n      trackInstanceId: trackId,\n      rendererType,\n    },\n  )) as { feature: Record<string, unknown> | undefined }\n\n  if (!featureData) {\n    return undefined\n  }\n\n  const feature = new SimpleFeature(\n    featureData as Parameters<typeof SimpleFeature.fromJSON>[0],\n  )\n\n  // If looking for a subfeature, find it within the parent\n  if (parentFeatureId) {\n    return findSubfeatureById(feature, featureId)\n  }\n\n  return feature\n}\n\n/**\n * Recursively searches a feature's subfeatures for one with the given ID\n */\nexport function findSubfeatureById(\n  feature: Feature,\n  targetId: string,\n): Feature | undefined {\n  const subfeatures = feature.get('subfeatures')\n  if (subfeatures) {\n    for (const sub of subfeatures) {\n      if (sub.id() === targetId) {\n        return sub\n      }\n      const found = findSubfeatureById(sub, targetId)\n      if (found) {\n        return found\n      }\n    }\n  }\n  return undefined\n}\n\nexport function featureHasExonsOrCDS(feature: Feature) {\n  const subs = feature.get('subfeatures') ?? []\n  return subs.some(\n    (f: Feature) => f.get('type') === 'exon' || f.get('type') === 'CDS',\n  )\n}\n\nexport function hasExonsOrCDS(transcripts: Feature[]) {\n  return transcripts.some(t => featureHasExonsOrCDS(t))\n}\n\nexport function hasIntrons(transcripts: Feature[]) {\n  const subs = transcripts.flatMap(\n    transcript =>\n      transcript\n        .get('subfeatures')\n        ?.filter(\n          (f: Feature) => f.get('type') === 'exon' || f.get('type') === 'CDS',\n        ) ?? [],\n  )\n  if (subs.length < 2) {\n    return false\n  }\n  const merged = mergeIntervals(\n    subs.map((f: Feature) => ({ start: f.get('start'), end: f.get('end') })),\n    0,\n  )\n  return merged.length > 1\n}\n\nexport function getTranscripts(feature?: Feature): Feature[] {\n  if (!feature) {\n    return []\n  }\n  return featureHasExonsOrCDS(feature)\n    ? [feature]\n    : (feature.get('subfeatures') ?? [])\n}\n\n/**\n * Draws an ImageBitmap to a canvas element.\n * This is a shared utility for non-block-based displays that render\n * to a single canvas via RPC.\n *\n * @param canvas - The canvas element to draw to\n * @param imageData - The ImageBitmap to draw\n * @returns true if drawing was successful, false otherwise\n */\nexport function drawCanvasImageData(\n  canvas: HTMLCanvasElement | null,\n  imageData: ImageBitmap | undefined,\n): boolean {\n  if (!canvas || !imageData) {\n    return false\n  }\n\n  const ctx = canvas.getContext('2d')\n  if (!ctx) {\n    return false\n  }\n\n  ctx.resetTransform()\n  ctx.clearRect(0, 0, canvas.width, canvas.height)\n  ctx.drawImage(imageData, 0, 0)\n  return true\n}\n","import { lazy } from 'react'\n\nimport {\n  ConfigurationReference,\n  getConf,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport SerializableFilterChain from '@jbrowse/core/pluggableElementTypes/renderers/util/serializableFilterChain'\nimport { SimpleFeature, getSession } from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport {\n  addDisposer,\n  cast,\n  getParent,\n  isAlive,\n  types,\n} from '@jbrowse/mobx-state-tree'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { reaction } from 'mobx'\n\nimport { BaseLinearDisplay } from '../BaseLinearDisplay/index.ts'\n\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n} from '@jbrowse/core/configuration'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { Feature, SimpleFeatureSerialized } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nconst SetMaxHeightDialog = lazy(\n  () => import('./components/SetMaxHeightDialog.tsx'),\n)\nconst AddFiltersDialog = lazy(() => import('./components/AddFiltersDialog.tsx'))\n\n/**\n * #stateModel LinearFeatureDisplay\n * #category display\n * Base model for feature displays. Provides labels, descriptions, display modes,\n * filters, etc. Does not include gene glyph functionality.\n *\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearFeatureDisplay',\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearFeatureDisplay'),\n        /**\n         * #property\n         */\n        trackShowLabels: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        trackShowDescriptions: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        trackDisplayMode: types.maybe(types.string),\n        /**\n         * #property\n         */\n        trackMaxHeight: types.maybe(types.number),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        jexlFilters: types.maybe(types.array(types.string)),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       * Stores the feature under the mouse cursor, fetched asynchronously\n       * via CoreGetFeatureDetails RPC to avoid serializing all features\n       */\n      featureUnderMouseVolatile: undefined as Feature | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get activeFilters(): string[] {\n        // config jexlFilters are deferred evaluated so they are prepended with\n        // jexl at runtime rather than being stored with jexl in the config\n        return (\n          self.jexlFilters ??\n          getConf(self, 'jexlFilters').map((r: string) => `jexl:${r}`)\n        )\n      },\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return getConf(self, ['renderer', 'type'])\n      },\n\n      /**\n       * #getter\n       */\n      get sequenceAdapter() {\n        const { assemblyManager } = getSession(self)\n        const track = getParent<{ configuration: AnyConfigurationModel }>(\n          self,\n          2,\n        )\n        const assemblyNames = readConfObject(\n          track.configuration,\n          'assemblyNames',\n        ) as string[]\n        const assembly = assemblyManager.get(assemblyNames[0]!)\n        return assembly ? getConf(assembly, ['sequence', 'adapter']) : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get showLabels() {\n        return self.trackShowLabels ?? getConf(self, ['renderer', 'showLabels'])\n      },\n\n      /**\n       * #getter\n       */\n      get showDescriptions() {\n        return (\n          self.trackShowDescriptions ??\n          getConf(self, ['renderer', 'showDescriptions'])\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get maxHeight() {\n        return self.trackMaxHeight ?? getConf(self, ['renderer', 'maxHeight'])\n      },\n\n      /**\n       * #getter\n       */\n      get displayMode() {\n        return (\n          self.trackDisplayMode ?? getConf(self, ['renderer', 'displayMode'])\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const configBlob = getConf(self, ['renderer']) || {}\n        const config = configBlob as Omit<typeof configBlob, symbol>\n        return {\n          ...config,\n          // Use track overrides if set, otherwise use what's already in configBlob\n          // This avoids redundant getConf calls for each property\n          showLabels: self.trackShowLabels ?? config.showLabels,\n          showDescriptions:\n            self.trackShowDescriptions ?? config.showDescriptions,\n          displayMode: self.trackDisplayMode ?? config.displayMode,\n          maxHeight: self.trackMaxHeight ?? config.maxHeight,\n        }\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setJexlFilters(f?: string[]) {\n        self.jexlFilters = cast(f)\n      },\n      /**\n       * #action\n       */\n      setFeatureUnderMouse(feat?: Feature) {\n        self.featureUnderMouseVolatile = feat\n      },\n      /**\n       * #action\n       */\n      toggleShowLabels() {\n        self.trackShowLabels = !self.showLabels\n      },\n      /**\n       * #action\n       */\n      toggleShowDescriptions() {\n        self.trackShowDescriptions = !self.showDescriptions\n      },\n      /**\n       * #action\n       */\n      setDisplayMode(val: string) {\n        self.trackDisplayMode = val\n      },\n      /**\n       * #action\n       */\n      setMaxHeight(val?: number) {\n        self.trackMaxHeight = val\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Override featureUnderMouse to return the volatile feature\n       * which is fetched asynchronously via CoreGetFeatureDetails\n       */\n      get featureUnderMouse() {\n        return self.featureUnderMouseVolatile\n      },\n    }))\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        renderProps: superRenderProps,\n        renderingProps: superRenderingProps,\n      } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          const superProps = superRenderProps()\n          return {\n            ...(superProps as Omit<typeof superProps, symbol>),\n            config: self.rendererConfig,\n            filters: new SerializableFilterChain({\n              filters: self.activeFilters,\n            }),\n            sequenceAdapter: self.sequenceAdapter,\n          }\n        },\n\n        /**\n         * #method\n         */\n        renderingProps() {\n          const superProps = superRenderingProps()\n          const session = getSession(self)\n          return {\n            ...superProps,\n            async onFeatureClick(_: unknown, featureId?: string) {\n              const { rpcManager } = session\n              const { parentTrack } = self\n              try {\n                const f = featureId || self.featureIdUnderMouse\n                if (!f) {\n                  self.clearFeatureSelection()\n                } else {\n                  const sessionId = getRpcSessionId(self)\n                  const { feature } = (await rpcManager.call(\n                    sessionId,\n                    'CoreGetFeatureDetails',\n                    {\n                      featureId: f,\n                      sessionId,\n                      trackInstanceId: parentTrack.id,\n                      rendererType: self.rendererTypeName,\n                    },\n                  )) as {\n                    feature: SimpleFeatureSerialized | undefined\n                  }\n\n                  if (isAlive(self) && feature) {\n                    self.selectFeature(new SimpleFeature(feature))\n                  }\n                }\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n              }\n            },\n            async onFeatureContextMenu(_: unknown, featureId?: string) {\n              const { rpcManager } = session\n              const { parentTrack } = self\n              try {\n                const f = featureId || self.featureIdUnderMouse\n                if (!f) {\n                  self.clearFeatureSelection()\n                } else {\n                  const sessionId = getRpcSessionId(self)\n                  const { feature } = (await rpcManager.call(\n                    sessionId,\n                    'CoreGetFeatureDetails',\n                    {\n                      featureId: f,\n                      sessionId,\n                      trackInstanceId: parentTrack.id,\n                      rendererType: self.rendererTypeName,\n                    },\n                  )) as {\n                    feature: SimpleFeatureSerialized | undefined\n                  }\n\n                  if (isAlive(self) && feature) {\n                    self.setContextMenuFeature(new SimpleFeature(feature))\n                  }\n                }\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n              }\n            },\n          }\n        },\n\n        /**\n         * #method\n         */\n        trackMenuItems(): MenuItem[] {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              subMenu: [\n                {\n                  label: 'Show tooltips',\n                  type: 'checkbox',\n                  checked: self.showTooltipsEnabled,\n                  onClick: () => {\n                    self.setShowTooltips(!self.showTooltipsEnabled)\n                  },\n                },\n                {\n                  label: 'Show labels',\n                  type: 'checkbox',\n                  checked: self.showLabels,\n                  onClick: () => {\n                    self.toggleShowLabels()\n                  },\n                },\n                {\n                  label: 'Show descriptions',\n                  type: 'checkbox',\n                  checked: self.showDescriptions,\n                  onClick: () => {\n                    self.toggleShowDescriptions()\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Display mode',\n              icon: VisibilityIcon,\n              subMenu: [\n                'normal',\n                'compact',\n                'reducedRepresentation',\n                'collapse',\n              ].map(val => ({\n                label: val,\n                type: 'radio' as const,\n                checked: self.displayMode === val,\n                onClick: () => {\n                  self.setDisplayMode(val)\n                },\n              })),\n            },\n            {\n              label: 'Set max track height',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  SetMaxHeightDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n            {\n              label: 'Filters',\n              subMenu: [\n                {\n                  label: 'Edit filters...',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      AddFiltersDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n              ],\n            },\n          ]\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        // Set up a reaction to fetch feature details when hovering\n        // This enables custom mouseover jexl expressions that use get(feature, ...)\n        addDisposer(\n          self,\n          reaction(\n            () => self.featureIdUnderMouse,\n            async featureId => {\n              if (!featureId) {\n                self.setFeatureUnderMouse(undefined)\n                return\n              }\n\n              const session = getSession(self)\n              const { rpcManager } = session\n              const { parentTrack } = self\n              try {\n                const sessionId = getRpcSessionId(self)\n                const { feature } = (await rpcManager.call(\n                  sessionId,\n                  'CoreGetFeatureDetails',\n                  {\n                    featureId,\n                    sessionId,\n                    trackInstanceId: parentTrack.id,\n                    rendererType: self.rendererTypeName,\n                  },\n                )) as {\n                  feature: SimpleFeatureSerialized | undefined\n                }\n\n                // Only set if still alive and feature ID hasn't changed\n                if (\n                  isAlive(self) &&\n                  feature &&\n                  self.featureIdUnderMouse === featureId\n                ) {\n                  self.setFeatureUnderMouse(new SimpleFeature(feature))\n                }\n              } catch (e) {\n                // Silently ignore errors for mouseover - don't spam console\n              }\n            },\n            { delay: 50, name: 'LinearFeatureDisplayMouseoverReaction' },\n          ),\n        )\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        trackShowLabels,\n        trackShowDescriptions,\n        trackDisplayMode,\n        trackMaxHeight,\n        jexlFilters,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(trackShowLabels !== undefined ? { trackShowLabels } : {}),\n        ...(trackShowDescriptions !== undefined\n          ? { trackShowDescriptions }\n          : {}),\n        ...(trackDisplayMode !== undefined ? { trackDisplayMode } : {}),\n        ...(trackMaxHeight !== undefined ? { trackMaxHeight } : {}),\n        ...(jexlFilters?.length ? { jexlFilters } : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearFeatureDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearFeatureDisplayModel = Instance<LinearFeatureDisplayStateModel>\n\nexport default stateModelFactory\n","// This file replaces `index.js` in bundlers like webpack or Rollup,\n// according to `browser` config in `package.json`.\n\n// This alphabet uses `A-Za-z0-9_-` symbols.\n// The order of characters is optimized for better gzip and brotli compression.\n// Same as in non-secure/index.js\nexport const urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\n\nexport const random = (bytes: number) =>\n  crypto.getRandomValues(new Uint8Array(bytes))\n\nexport const customRandom = (\n  alphabet: string,\n  defaultSize: number,\n  getRandom: (bytes: number) => Uint8Array,\n) => {\n  // First, a bitmask is necessary to generate the ID. The bitmask makes bytes\n  // values closer to the alphabet size. The bitmask calculates the closest\n  // `2^31 - 1` number, which exceeds the alphabet size.\n  // For example, the bitmask for the alphabet size 30 is 31 (00011111).\n  // `Math.clz32` is not used, because it is not available in browsers.\n  const mask = (2 << (Math.log(alphabet.length - 1) / Math.LN2)) - 1\n  // Though, the bitmask solution is not perfect since the bytes exceeding\n  // the alphabet size are refused. Therefore, to reliably generate the ID,\n  // the random bytes redundancy has to be satisfied.\n\n  // Note: every hardware random generator call is performance expensive,\n  // because the system call for entropy collection takes a lot of time.\n  // So, to avoid additional system calls, extra bytes are requested in advance.\n\n  // Next, a step determines how many random bytes to generate.\n  // The number of random bytes gets decided upon the ID size, mask,\n  // alphabet size, and magic number 1.6 (using 1.6 peaks at performance\n  // according to benchmarks).\n\n  // `-~f => Math.ceil(f)` if f is a float\n  // `-~i => i + 1` if i is an integer\n  const step = -~((1.6 * mask * defaultSize) / alphabet.length)\n\n  return (size = defaultSize) => {\n    let id = ''\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    while (true) {\n      const bytes = getRandom(step)\n      // A compact alternative for `for (var i = 0; i < step; i++)`.\n      let j = step\n      while (j--) {\n        // Adding `|| ''` refuses a random byte that exceeds the alphabet size.\n        id += alphabet[bytes[j]! & mask] || ''\n        if (id.length === size) {\n          return id\n        }\n      }\n    }\n  }\n}\n\nexport const customAlphabet = (alphabet: string, size = 21) =>\n  customRandom(alphabet, size, random)\n\nexport const nanoid = (size = 21) =>\n  crypto.getRandomValues(new Uint8Array(size)).reduce((id, byte) => {\n    // It is incorrect to use bytes exceeding the alphabet size.\n    // The following mask reduces the random byte in the 0-255 value\n    // range to the 0-63 value range. Therefore, adding hacks, such\n    // as empty string fallback or magic numbers, is unnecessary because\n    // the bitmask trims bytes down to the alphabet size.\n    byte &= 63\n    if (byte < 36) {\n      // `0-9a-z`\n      id += byte.toString(36)\n    } else if (byte < 62) {\n      // `A-Z`\n      id += (byte - 26).toString(36).toUpperCase()\n    } else if (byte > 62) {\n      id += '-'\n    } else {\n      id += '_'\n    }\n    return id\n  }, '')\n","import { getSnapshot, isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport RendererType from './RendererType.tsx'\nimport SerializableFilterChain from './util/serializableFilterChain.ts'\nimport { getSerializedSvg, updateStatus } from '../../util/index.ts'\nimport { isRpcResult } from '../../util/rpc.ts'\nimport { checkStopToken } from '../../util/stopToken.ts'\n\nimport type { RenderProps, RenderResults } from './RendererType.tsx'\nimport type { SerializedFilterChain } from './util/serializableFilterChain.ts'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\nimport type RpcManager from '../../rpc/RpcManager.ts'\nimport type { SnapshotIn, SnapshotOrInstance } from '@jbrowse/mobx-state-tree'\nimport type { ThemeOptions } from '@mui/material'\n\ninterface BaseRenderArgs extends RenderProps {\n  sessionId: string\n  trackInstanceId: string\n  stopToken?: string\n  theme: ThemeOptions\n  exportSVG?: {\n    rasterizeLayers?: boolean\n  }\n}\n\nexport interface RenderArgs extends BaseRenderArgs {\n  config: SnapshotOrInstance<AnyConfigurationModel>\n  filters?: SerializableFilterChain\n  /**\n   * Props passed only to the client-side React rendering component.\n   * These are NOT sent to the worker - they stay client-side only.\n   * Typically includes displayModel, event callbacks, etc.\n   */\n  renderingProps?: Record<string, unknown>\n}\n\nexport interface RenderArgsSerialized extends BaseRenderArgs {\n  statusCallback?: (arg: string) => void\n  config: SnapshotIn<AnyConfigurationModel>\n  filters?: SerializedFilterChain\n}\nexport interface RenderArgsDeserialized extends BaseRenderArgs {\n  config: AnyConfigurationModel\n  filters?: SerializableFilterChain\n}\n\nexport type ResultsSerialized = Omit<RenderResults, 'reactElement'> & {\n  imageData?: ImageBitmap\n}\n\nexport interface ResultsSerializedSvgExport extends ResultsSerialized {\n  canvasRecordedData: unknown\n  width: number\n  height: number\n  reactElement: unknown\n}\n\nexport type ResultsDeserialized = RenderResults\n\nfunction isCanvasRecordedSvgExport(\n  e: ResultsSerialized,\n): e is ResultsSerializedSvgExport {\n  return 'canvasRecordedData' in e\n}\n\n/**\n * Determines if results already contain pre-rendered HTML content.\n * When HTML is present, no React element needs to be created.\n */\nfunction hasPreRenderedContent(res: ResultsSerialized) {\n  return !!res.html\n}\n\n/**\n * Creates a React element for SVG export mode.\n * Returns undefined if content is already pre-rendered.\n */\nfunction createSvgExportElement(\n  res: ResultsSerialized,\n  args: RenderArgs,\n  ReactComponent: ServerSideRenderer['ReactComponent'],\n  supportsSVG: boolean,\n) {\n  if (hasPreRenderedContent(res)) {\n    return undefined\n  }\n\n  if (supportsSVG) {\n    return <ReactComponent {...args} {...res} />\n  }\n\n  return (\n    <text y=\"12\" fill=\"black\">\n      SVG export not supported for this track\n    </text>\n  )\n}\n\n/**\n * Creates a React element for normal (non-export) rendering mode.\n */\nfunction createNormalElement(\n  res: ResultsSerialized,\n  args: RenderArgs,\n  ReactComponent: ServerSideRenderer['ReactComponent'],\n  renderingProps?: Record<string, unknown>,\n) {\n  return <ReactComponent {...args} {...res} {...renderingProps} />\n}\n\nexport default class ServerSideRenderer extends RendererType {\n  /**\n   * Renders directly without serialization. Used by MainThreadRpcDriver\n   * to avoid unnecessary serialize/deserialize overhead when no worker\n   * thread boundary is crossed.\n   *\n   * Key differences from renderInWorker + deserializeResultsInClient:\n   * - Config stays as live MST node (no snapshot/create cycle)\n   * - Features stay as Feature objects (no toJSON/fromJSON)\n   * - RpcResult values are unwrapped directly\n   */\n  async renderDirect(args: RenderArgs) {\n    const { renderingProps, ...rest } = args\n\n    // Ensure config is an MST model for render() - it may be a plain object\n    // if rendererConfig returns a plain object for performance\n    const config = isStateTreeNode(args.config)\n      ? args.config\n      : this.configSchema.create(args.config || {}, {\n          pluginManager: this.pluginManager,\n        })\n\n    const results = await this.render({\n      ...rest,\n      config,\n    } as RenderArgsDeserialized)\n\n    // For RpcResult (canvas renderers with transferables), unwrap directly\n    // No need for transfer semantics since we're on the same thread\n    if (isRpcResult(results)) {\n      const unwrapped = (results as { value: ResultsSerialized }).value\n      return this.deserializeResultsInClient(unwrapped, args)\n    }\n\n    // For non-RpcResult, we still need to create the React element\n    // but we can skip feature serialization by passing results directly\n    const { reactElement, ...resultRest } = results\n    return {\n      ...resultRest,\n      reactElement: args.exportSVG\n        ? createSvgExportElement(\n            resultRest as ResultsSerialized,\n            args,\n            this.ReactComponent,\n            this.supportsSVG,\n          )\n        : createNormalElement(\n            resultRest as ResultsSerialized,\n            args,\n            this.ReactComponent,\n            renderingProps,\n          ),\n    }\n  }\n\n  serializeArgsInClient(args: RenderArgs): RenderArgsSerialized {\n    // strip renderingProps - they are client-side only and should not be\n    // serialized to the worker\n    const { renderingProps, ...rest } = args\n    return {\n      ...rest,\n      config: isStateTreeNode(args.config)\n        ? getSnapshot(args.config)\n        : args.config,\n      filters: args.filters?.toJSON().filters,\n    }\n  }\n\n  deserializeResultsInClient(\n    res: ResultsSerialized,\n    args: RenderArgs,\n  ): ResultsDeserialized {\n    const { renderingProps } = args\n    return {\n      ...res,\n      reactElement: args.exportSVG\n        ? createSvgExportElement(\n            res,\n            args,\n            this.ReactComponent,\n            this.supportsSVG,\n          )\n        : createNormalElement(res, args, this.ReactComponent, renderingProps),\n    }\n  }\n\n  deserializeArgsInWorker(args: RenderArgsSerialized): RenderArgsDeserialized {\n    return {\n      ...args,\n      config: this.configSchema.create(args.config || {}, {\n        pluginManager: this.pluginManager,\n      }),\n      filters: args.filters\n        ? new SerializableFilterChain({ filters: args.filters })\n        : undefined,\n    }\n  }\n\n  serializeResultsInWorker(\n    results: RenderResults & { imageData?: ImageBitmap },\n    _args: RenderArgsDeserialized,\n  ): ResultsSerialized {\n    const { reactElement, ...rest } = results\n    return rest\n  }\n\n  async renderInClient(rpcManager: RpcManager, args: RenderArgs) {\n    const results = (await rpcManager.call(\n      args.sessionId,\n      'CoreRender',\n      args,\n    )) as ResultsSerialized\n\n    if (isCanvasRecordedSvgExport(results)) {\n      const { reactElement, ...rest } = results\n      return {\n        ...rest,\n        html: await getSerializedSvg(results),\n      }\n    } else {\n      return results\n    }\n  }\n\n  async renderInWorker(args: RenderArgsSerialized): Promise<ResultsSerialized> {\n    const { stopToken, statusCallback = () => {} } = args\n    const args2 = this.deserializeArgsInWorker(args)\n    const results = await updateStatus('Rendering plot', statusCallback, () =>\n      this.render(args2),\n    )\n    checkStopToken(stopToken)\n\n    // If render() returned an rpcResult, it's already serialized - pass through\n    if (isRpcResult(results)) {\n      return results as unknown as ResultsSerialized\n    }\n\n    return updateStatus('Serializing results', statusCallback, () =>\n      this.serializeResultsInWorker(results, args2),\n    )\n  }\n\n  async freeResourcesInClient(rpcManager: RpcManager, args: RenderArgs) {\n    const serializedArgs = this.serializeArgsInClient(args)\n    const { sessionId } = args\n\n    await rpcManager.call(sessionId, 'CoreFreeResources', serializedArgs)\n  }\n}\n\nexport { type RenderResults, type RenderReturn } from './RendererType.tsx'\n","/**\n * Shared utilities for interval-based layout algorithms.\n * Used by both GranularRectLayout and PileupLayout.\n */\n\n/**\n * Check if a range [left, right) is clear (no overlaps) in a sorted interval array.\n * Intervals are stored as flat array: [start1, end1, start2, end2, ...]\n *\n * Uses linear scan for small arrays (< 40 elements) and binary search for larger.\n */\nexport function isRangeClear(\n  intervals: number[],\n  left: number,\n  right: number,\n): boolean {\n  const len = intervals.length\n\n  if (len === 0) {\n    return true\n  }\n\n  // Linear scan for small arrays (better cache locality)\n  if (len < 40) {\n    for (let i = 0; i < len; i += 2) {\n      if (intervals[i + 1]! > left && intervals[i]! < right) {\n        return false\n      }\n    }\n    return true\n  }\n\n  // Binary search for larger arrays\n  // Find first interval whose end > left (first potential overlap)\n  let low = 0\n  let high = len >> 1\n\n  while (low < high) {\n    const mid = (low + high) >>> 1\n    const midIdx = mid << 1\n    if (intervals[midIdx + 1]! <= left) {\n      low = mid + 1\n    } else {\n      high = mid\n    }\n  }\n\n  const idx = low << 1\n  if (idx >= len) {\n    return true\n  }\n\n  // If the first candidate's start is >= right, no overlap\n  return intervals[idx]! >= right\n}\n\n/**\n * Find insertion point for a new interval in a sorted interval array.\n * Returns the index where [left, right] should be inserted.\n */\nexport function findInsertionPoint(intervals: number[], left: number): number {\n  const len = intervals.length\n\n  if (len < 40) {\n    for (let i = 0; i < len; i += 2) {\n      if (left < intervals[i]!) {\n        return i\n      }\n    }\n    return len\n  }\n\n  // Binary search\n  let low = 0\n  let high = len >> 1\n\n  while (low < high) {\n    const mid = (low + high) >>> 1\n    if (intervals[mid << 1]! < left) {\n      low = mid + 1\n    } else {\n      high = mid\n    }\n  }\n  return low << 1\n}\n\n/**\n * Insert an interval into a sorted interval array using manual shift\n * (avoids splice GC pressure).\n */\nexport function insertInterval(\n  intervals: number[],\n  idx: number,\n  left: number,\n  right: number,\n): void {\n  const len = intervals.length\n  intervals.push(0, 0)\n  for (let i = len + 1; i > idx + 1; i--) {\n    intervals[i] = intervals[i - 2]!\n  }\n  intervals[idx] = left\n  intervals[idx + 1] = right\n}\n","import {\n  findInsertionPoint,\n  insertInterval,\n  isRangeClear,\n} from './intervalUtils.ts'\n\nimport type {\n  BaseLayout,\n  RectTuple,\n  Rectangle,\n  SerializedLayout,\n} from './BaseLayout.ts'\n\n/**\n * Specialized layout for pileup displays where all features have uniform height.\n *\n * Advantages over GranularRectLayout:\n * - Simpler: no multi-row collision checks (each feature = one row)\n * - Explicit spacing parameter instead of pitchY hack\n * - Built-in hint optimization for same-start features\n * - Returns pixel positions directly\n */\n\nexport interface PileupLayoutOptions {\n  /** Height of each feature in pixels */\n  featureHeight?: number\n  /** Spacing between features in pixels (default 0) */\n  spacing?: number\n  /** Maximum layout height in pixels */\n  maxHeight?: number\n  /** Horizontal padding added to right edge for collision detection (default 1) */\n  padding?: number\n}\n\nexport interface PileupRectangle {\n  id: string\n  left: number\n  right: number\n  top: number\n}\n\nexport default class PileupLayout<T> implements BaseLayout<T> {\n  private featureHeight: number\n  private spacing: number\n  private rowHeight: number\n  private padding: number\n  private maxRows: number\n  private rows: number[][] = [] // Each row is a flat interval array [start1, end1, start2, end2, ...]\n  private rowMaxEnd: number[] = [] // Track rightmost end per row for O(1) check\n  private rectangles = new Map<string, Rectangle<T>>()\n\n  // For hint optimization: track last placed feature\n  private lastLeft = -Infinity\n  private lastRow = 0\n\n  public maxHeightReached = false\n\n  constructor(options: PileupLayoutOptions = {}) {\n    this.featureHeight = options.featureHeight ?? 7\n    this.spacing = options.spacing ?? 0\n    this.rowHeight = this.featureHeight + this.spacing\n    this.padding = options.padding ?? 1\n    this.maxRows = options.maxHeight\n      ? Math.floor(options.maxHeight / this.rowHeight)\n      : 100000\n  }\n\n  addRect(\n    id: string,\n    left: number,\n    right: number,\n    height: number,\n    data?: T,\n    serializableData?: T,\n  ): number | null {\n    // Check if already laid out\n    const existing = this.rectangles.get(id)\n    if (existing) {\n      if (existing.top === null) {\n        return null\n      }\n      return existing.top * this.rowHeight\n    }\n\n    // Use hint: if same start as previous feature, start searching from next row\n    let startRow = 0\n    if (left === this.lastLeft) {\n      startRow = this.lastRow + 1\n    }\n\n    // Add padding to right edge for collision detection\n    const paddedRight = right + this.padding\n\n    // Find first row where this feature fits\n    const row = this.findFreeRow(left, paddedRight, startRow)\n    if (row === null) {\n      const rect: Rectangle<T> = {\n        id,\n        l: left,\n        r: right,\n        top: null,\n        h: 1,\n        originalHeight: this.featureHeight,\n        data,\n        serializableData,\n      }\n      this.rectangles.set(id, rect)\n      this.maxHeightReached = true\n      return null\n    }\n\n    // Add to row (with padding for collision detection)\n    this.addToRow(row, left, paddedRight)\n\n    // Store rectangle\n    const rect: Rectangle<T> = {\n      id,\n      l: left,\n      r: right,\n      top: row,\n      h: 1,\n      originalHeight: this.featureHeight,\n      data,\n      serializableData,\n    }\n    this.rectangles.set(id, rect)\n\n    // Update hint state\n    this.lastLeft = left\n    this.lastRow = row\n\n    return row * this.rowHeight\n  }\n\n  private findFreeRow(\n    left: number,\n    right: number,\n    startRow: number,\n  ): number | null {\n    const rows = this.rows\n    const rowMaxEnd = this.rowMaxEnd\n    for (let row = startRow; row < this.maxRows; row++) {\n      const intervals = rows[row]\n\n      // Empty row - it's free\n      if (!intervals) {\n        return row\n      }\n\n      // Fast path: if left >= max end of row, it's clear\n      if (left >= rowMaxEnd[row]!) {\n        return row\n      }\n\n      // Check if range is clear in this row\n      if (isRangeClear(intervals, left, right)) {\n        return row\n      }\n    }\n    return null\n  }\n\n  private addToRow(rowIdx: number, left: number, right: number): void {\n    let intervals = this.rows[rowIdx]\n    if (!intervals) {\n      intervals = []\n      this.rows[rowIdx] = intervals\n      this.rowMaxEnd[rowIdx] = 0\n    }\n\n    const len = intervals.length\n\n    // Fast path: append to end (common case when sorted by start)\n    if (len === 0 || left >= intervals[len - 2]!) {\n      intervals.push(left, right)\n    } else {\n      const idx = findInsertionPoint(intervals, left)\n      insertInterval(intervals, idx, left, right)\n    }\n\n    // Update rowMaxEnd\n    if (right > this.rowMaxEnd[rowIdx]!) {\n      this.rowMaxEnd[rowIdx] = right\n    }\n  }\n\n  collides(_rect: Rectangle<T>, _top: number): boolean {\n    // Not used in pileup - features are always single-row\n    return false\n  }\n\n  addRectToBitmap(_rect: Rectangle<T>): void {\n    // Not needed - we add to bitmap during addRect\n  }\n\n  getTotalHeight(): number {\n    let maxRow = 0\n    for (let i = this.rows.length - 1; i >= 0; i--) {\n      if (this.rows[i]) {\n        maxRow = i + 1\n        break\n      }\n    }\n    return maxRow * this.rowHeight\n  }\n\n  getRectangles(): Map<string, RectTuple> {\n    const result = new Map<string, RectTuple>()\n    const rowHeight = this.rowHeight\n    const featureHeight = this.featureHeight\n    for (const [id, rect] of this.rectangles) {\n      if (rect.top !== null) {\n        const top = rect.top * rowHeight\n        result.set(id, [rect.l, top, rect.r, top + featureHeight])\n      }\n    }\n    return result\n  }\n\n  discardRange(left: number, right: number): void {\n    for (let rowIdx = 0; rowIdx < this.rows.length; rowIdx++) {\n      const intervals = this.rows[rowIdx]\n      if (!intervals) {\n        continue\n      }\n\n      const newIntervals: number[] = []\n      let maxEnd = 0\n\n      for (let i = 0; i < intervals.length; i += 2) {\n        const start = intervals[i]!\n        const end = intervals[i + 1]!\n\n        if (end <= left || start >= right) {\n          newIntervals.push(start, end)\n          if (end > maxEnd) {\n            maxEnd = end\n          }\n        } else if (start < left && end > left && end <= right) {\n          newIntervals.push(start, left)\n          if (left > maxEnd) {\n            maxEnd = left\n          }\n        } else if (start >= left && start < right && end > right) {\n          newIntervals.push(right, end)\n          if (end > maxEnd) {\n            maxEnd = end\n          }\n        } else if (start < left && end > right) {\n          newIntervals.push(start, left, right, end)\n          if (end > maxEnd) {\n            maxEnd = end\n          }\n        }\n      }\n\n      this.rows[rowIdx] = newIntervals\n      this.rowMaxEnd[rowIdx] = maxEnd\n    }\n\n    // Reset hint when discarding\n    this.lastLeft = -Infinity\n    this.lastRow = 0\n  }\n\n  getDataByID(id: string) {\n    return this.rectangles.get(id)?.data\n  }\n\n  serializeRegion(region: { start: number; end: number }): SerializedLayout {\n    const { start: x1, end: x2 } = region\n    const regionRectangles: Record<string, RectTuple> = {}\n\n    for (const [id, rect] of this.rectangles.entries()) {\n      if (rect.top === null) {\n        continue\n      }\n      const { l, r, top } = rect\n      if (x2 >= l && r >= x1) {\n        const topPx = top * this.rowHeight\n        regionRectangles[id] = [l, topPx, r, topPx + this.featureHeight]\n      }\n    }\n\n    return {\n      rectangles: regionRectangles,\n      totalHeight: this.getTotalHeight(),\n      maxHeightReached: this.maxHeightReached,\n    }\n  }\n\n  toJSON(): SerializedLayout {\n    return {\n      rectangles: Object.fromEntries(this.getRectangles()),\n      totalHeight: this.getTotalHeight(),\n      maxHeightReached: this.maxHeightReached,\n    }\n  }\n}\n","export type CxArg =\n  | undefined\n  | null\n  | string\n  | boolean\n  | Record<string, boolean | null | undefined>\n  | readonly CxArg[]\n\n/** Copy pasted from\n * https://github.com/emotion-js/emotion/blob/23f43ab9f24d44219b0b007a00f4ac681fe8712e/packages/react/src/class-names.js#L17-L63\n **/\nexport const classnames = (args: CxArg[]): string => {\n  const len = args.length\n  let i = 0\n  let cls = ''\n  for (; i < len; i++) {\n    const arg = args[i]\n    if (arg == null) {\n      continue\n    }\n\n    let toAdd\n    switch (typeof arg) {\n      case 'boolean':\n        break\n      case 'object': {\n        if (Array.isArray(arg)) {\n          toAdd = classnames(arg)\n        } else {\n          const obj = arg as Record<string, boolean | null | undefined>\n          toAdd = ''\n          for (const k in obj) {\n            if (obj[k] && k) {\n              if (toAdd) {\n                toAdd += ' '\n              }\n              toAdd += k\n            }\n          }\n        }\n        break\n      }\n      default: {\n        toAdd = arg\n      }\n    }\n    if (toAdd) {\n      if (cls) {\n        cls += ' '\n      }\n      cls += toAdd\n    }\n  }\n  return cls\n}\n","import FeatureRenderer from './FeatureRendererType.ts'\n\nexport default class CircularChordRendererType extends FeatureRenderer {\n  supportsSVG = true\n}\n","import { stringToJexlExpression } from '../../../util/jexlStrings.ts'\n\ntype FilterExpression = (...args: Record<string, any>[] | any[]) => boolean\n\ninterface Filter {\n  string: string\n  expr: FilterExpression\n}\n\nexport type SerializedFilterChain = string[]\n\nexport default class SerializableFilterChain {\n  filterChain: Filter[]\n\n  constructor({ filters }: { filters: SerializedFilterChain }) {\n    this.filterChain = filters\n      .map(f => f.trim())\n      .filter(f => !!f)\n      .map(inputFilter => {\n        if (typeof inputFilter === 'string') {\n          const expr = stringToJexlExpression(inputFilter) as FilterExpression\n          return { expr, string: inputFilter }\n        }\n        throw new Error(`invalid inputFilter string \"${inputFilter}\"`)\n      })\n  }\n\n  passes(...args: any[]) {\n    for (const entry of this.filterChain) {\n      if (\n        // @ts-expect-error\n        !entry.expr.eval({ feature: args[0] })\n      ) {\n        return false\n      }\n    }\n    return true\n  }\n\n  toJSON() {\n    return { filters: this.filterChain.map(f => f.string) }\n  }\n\n  static fromJSON(json: { filters: SerializedFilterChain }) {\n    return new SerializableFilterChain(json)\n  }\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { AnyAdapter } from '../data_adapters/BaseAdapter/index.ts'\n\nexport default class TextSearchAdapterType extends PluggableElementBase {\n  getAdapterClass: () => Promise<AnyAdapter>\n\n  configSchema: AnyConfigurationSchemaType\n\n  description?: string\n\n  constructor(\n    stuff: {\n      name: string\n      displayName?: string\n      description?: string\n      configSchema: AnyConfigurationSchemaType\n    } & (\n      | {\n          AdapterClass: AnyAdapter\n        }\n      | {\n          getAdapterClass: () => Promise<AnyAdapter>\n        }\n    ),\n  ) {\n    super(stuff)\n    this.description = stuff.description\n    this.configSchema = stuff.configSchema\n    this.getAdapterClass =\n      'getAdapterClass' in stuff\n        ? stuff.getAdapterClass\n        : async () => stuff.AdapterClass\n  }\n}\n","import { getConf } from '@jbrowse/core/configuration'\nimport {\n  getContainingTrack,\n  getContainingView,\n  measureText,\n} from '@jbrowse/core/util'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\nimport { observer } from 'mobx-react'\n\nimport YScaleBar from '../../shared/YScaleBar.tsx'\n\nimport type { WiggleDisplayModel } from '../model.ts'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\nconst LinearWiggleDisplay = observer(function LinearWiggleDisplay(props: {\n  model: WiggleDisplayModel\n}) {\n  const { model } = props\n  const { stats, height, graphType } = model\n\n  const { trackLabels } = getContainingView(model) as LGV\n  const track = getContainingTrack(model)\n\n  return (\n    <div>\n      <BaseLinearDisplayComponent {...props} />\n      {stats && graphType ? (\n        <svg\n          style={{\n            position: 'absolute',\n            top: 0,\n            left:\n              trackLabels === 'overlapping'\n                ? measureText(getConf(track, 'name'), 12.8) + 100\n                : 50,\n            pointerEvents: 'none',\n            height,\n            width: 50,\n          }}\n        >\n          <YScaleBar model={model} />\n        </svg>\n      ) : null}\n    </div>\n  )\n})\n\nexport default LinearWiggleDisplay\n","import { measureText } from '@jbrowse/core/util'\nimport { colord } from '@jbrowse/core/util/colord'\n\nimport { MISMATCH_TYPE } from './forEachMismatchTypes.ts'\nimport { SAM_FLAG_PAIRED } from './samFlags.ts'\n\nimport type { ChainData, FeatureWithMismatchIterator } from './types.ts'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Theme } from '@mui/material'\n\n/**\n * Check if ChainData contains paired-end reads\n * Note: This checks the data content, not the type.\n * For type-level checking, use hasPairedChainData() from fetchChains.ts\n */\nexport function hasPairedReads(features: ChainData) {\n  for (const f of features.chains.values()) {\n    if (f[0]!.get('flags') & SAM_FLAG_PAIRED) {\n      return true\n    }\n  }\n  return false\n}\n\nexport function alphaColor(baseColor: string, p: number) {\n  return p !== 1\n    ? colord(baseColor)\n        .alpha(Math.min(1, p * p + 0.1))\n        .toHslString()\n    : baseColor\n}\n\nexport const defaultFilterFlags = {\n  flagInclude: 0,\n  flagExclude: 1540,\n}\n\nexport function isDefaultFilterFlags(\n  filterBy:\n    | {\n        flagInclude?: number\n        flagExclude?: number\n        readName?: string\n        tagFilter?: unknown\n      }\n    | undefined,\n) {\n  if (!filterBy) {\n    return true\n  }\n  return (\n    filterBy.flagInclude === 0 &&\n    filterBy.flagExclude === 1540 &&\n    !filterBy.readName &&\n    !filterBy.tagFilter\n  )\n}\nexport const negFlags = {\n  flagInclude: 16,\n  flagExclude: 1540,\n}\nexport const posFlags = {\n  flagInclude: 0,\n  flagExclude: 1556,\n}\n\nexport function cacheGetter<T>(ctor: { prototype: T }, prop: keyof T): void {\n  const desc = Object.getOwnPropertyDescriptor(ctor.prototype, prop)!\n  const getter = desc.get!\n  Object.defineProperty(ctor.prototype, prop, {\n    get() {\n      const ret = getter.call(this)\n      Object.defineProperty(this, prop, { value: ret })\n      return ret\n    },\n  })\n}\n\nexport function filterReadFlag(\n  flags: number,\n  flagInclude: number,\n  flagExclude: number,\n) {\n  if ((flags & flagInclude) !== flagInclude) {\n    return true\n  } else if (flags & flagExclude) {\n    return true\n  } else {\n    return false\n  }\n}\n\nexport function filterTagValue(readVal: unknown, filterVal?: string) {\n  return filterVal === '*'\n    ? readVal === undefined\n    : `${readVal}` !== `${filterVal}`\n}\n\n/**\n * Determine if chevrons should be rendered based on zoom level and feature height\n * @param bpPerPx - base pairs per pixel (zoom level)\n * @param featureHeight - height of the feature in pixels\n * @returns true if chevrons should be rendered\n */\nexport function shouldRenderChevrons(bpPerPx: number, featureHeight: number) {\n  return bpPerPx < 50 && featureHeight >= 3\n}\n\n/**\n * Width of chevron pointer in pixels\n */\nexport const CHEVRON_WIDTH = 5\n\ninterface SamHeaderLine {\n  tag: string\n  data: { tag: string; value: string }[]\n}\n\nexport interface ParsedSamHeader {\n  idToName: string[]\n  nameToId: Record<string, number>\n  readGroups: string[]\n}\n\n/**\n * Parse SAM header lines into idToName, nameToId mappings and readGroups\n */\nexport function parseSamHeader(samHeader: SamHeaderLine[]): ParsedSamHeader {\n  const idToName: string[] = []\n  const nameToId: Record<string, number> = {}\n  const readGroups: string[] = []\n  let refId = 0\n  let rgId = 0\n\n  for (const element of samHeader) {\n    const line = element\n    if (line.tag === 'SQ') {\n      const data = line.data\n      for (const datum of data) {\n        const item = datum\n        if (item.tag === 'SN') {\n          const refName = item.value\n          nameToId[refName] = refId\n          idToName[refId] = refName\n          break\n        }\n      }\n      refId++\n    } else if (line.tag === 'RG') {\n      const data = line.data\n      for (const datum of data) {\n        const item = datum\n        if (item.tag === 'ID') {\n          readGroups[rgId] = item.value\n          break\n        }\n      }\n      rgId++\n    }\n  }\n\n  return { idToName, nameToId, readGroups }\n}\n\nexport function getColorBaseMap(theme: Theme) {\n  const { skip, deletion, insertion, hardclip, softclip, bases } = theme.palette\n  return {\n    A: bases.A.main,\n    C: bases.C.main,\n    G: bases.G.main,\n    T: bases.T.main,\n    deletion,\n    insertion,\n    hardclip,\n    softclip,\n    skip,\n  }\n}\n\nexport function getContrastBaseMap(theme: Theme) {\n  return Object.fromEntries(\n    Object.entries(getColorBaseMap(theme)).map(([key, value]) => [\n      key,\n      theme.palette.getContrastText(value),\n    ]),\n  )\n}\n\nexport function shouldDrawSNPsMuted(type?: string) {\n  return ['methylation', 'modifications'].includes(type || '')\n}\n\nexport function shouldDrawIndels() {\n  return true\n}\n\nexport interface LayoutFeature {\n  heightPx: number\n  topPx: number\n  feature: Feature\n}\n\n/**\n * Sets the standard monospace font used for rendering base letters in alignments\n * @param ctx - Canvas rendering context\n */\nexport function setAlignmentFont(ctx: CanvasRenderingContext2D) {\n  ctx.font = 'bold 10px Courier New,monospace'\n}\n\n// get width and height of chars the height is an approximation: width letter M\n// is approximately the height\nexport function getCharWidthHeight() {\n  const charWidth = measureText('A')\n  const charHeight = measureText('M') - 2\n  return { charWidth, charHeight }\n}\n\n// Cache measureText results for small numbers (0-99)\n// Most deletions are small, so this avoids calling measureText in hot loops\nconst smallNumberWidthCache10 = new Map<number, number>()\nconst smallNumberWidthCache = new Map<number, number>()\n\nexport function measureTextSmallNumber(n: number, fontSize?: number) {\n  const cache =\n    fontSize === 10 ? smallNumberWidthCache10 : smallNumberWidthCache\n  if (n >= 0 && n < 100) {\n    let width = cache.get(n)\n    if (width === undefined) {\n      width = measureText(String(n), fontSize)\n      cache.set(n, width)\n    }\n    return width\n  }\n  return measureText(String(n), fontSize)\n}\n\nfunction isTypedArray(\n  val: unknown,\n): val is\n  | Int8Array\n  | Uint8Array\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Float32Array\n  | Float64Array {\n  return ArrayBuffer.isView(val) && !(val instanceof DataView)\n}\n\n/**\n * Convert TypedArrays in tags object to plain number arrays.\n * This is needed because MobX State Tree cannot freeze TypedArray views.\n */\nexport function convertTagsToPlainArrays(\n  tags: Record<string, unknown>,\n): Record<string, unknown> {\n  const result: Record<string, unknown> = {}\n  for (const [key, value] of Object.entries(tags)) {\n    result[key] = isTypedArray(value) ? [...value] : value\n  }\n  return result\n}\n\n/**\n * Build a map of reference positions to mismatch bases for a feature.\n * Used to detect when a modification occurs at a mismatch position.\n */\nexport function buildMismatchMap(feature: Feature, featureStart: number) {\n  const mismatchMap = new Map<number, string>()\n  if ('forEachMismatch' in feature) {\n    const feat = feature as FeatureWithMismatchIterator\n    feat.forEachMismatch((type, mismatchStart, _len, base) => {\n      if (type === MISMATCH_TYPE) {\n        mismatchMap.set(featureStart + mismatchStart, base)\n      }\n    })\n  }\n  return mismatchMap\n}\n","import {\n  isArrayType,\n  isLateType,\n  isMapType,\n  isOptionalType,\n  isUnionType,\n} from '@jbrowse/mobx-state-tree'\n\nimport type {\n  IAnyComplexType,\n  IAnyType,\n  IModelReflectionPropertiesData,\n  ISimpleType,\n  UnionStringArray,\n} from '@jbrowse/mobx-state-tree'\n\nexport interface ILiteralType<T> extends ISimpleType<T> {\n  value: T\n}\n\n/**\n * get the inner type of an MST optional, array, or late type object\n */\nexport function getSubType(type: IAnyType): IAnyType {\n  let t: IAnyType\n  if (isOptionalType(type)) {\n    // @ts-expect-error\n    t = type._subtype || type.type\n  } else if (isArrayType(type) || isMapType(type)) {\n    // @ts-expect-error\n    t = type._subtype || type._subType || type.subType\n    // @ts-expect-error\n  } else if (typeof type.getSubType === 'function') {\n    // @ts-expect-error\n    return type.getSubType()\n  } else {\n    throw new TypeError('unsupported mst type')\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  if (!t) {\n    throw new Error('failed to get subtype')\n  }\n  return t\n}\n\n/**\n * get the array of the subtypes in a union\n */\nexport function getUnionSubTypes(unionType: IAnyType): IAnyType[] {\n  if (!isUnionType(unionType)) {\n    throw new TypeError('not an MST union type')\n  }\n  const t =\n    // @ts-expect-error\n    unionType._types ||\n    // @ts-expect-error\n    unionType.types ||\n    // @ts-expect-error\n    getSubType(unionType)._types ||\n    // @ts-expect-error\n    getSubType(unionType).types\n  if (!t) {\n    // debugger\n    throw new Error('failed to extract subtypes from mst union')\n  }\n  return t\n}\n\n/**\n * get the type of one of the properties of the given MST model type\n */\nexport function getPropertyType(\n  type: IModelReflectionPropertiesData,\n  propertyName: string,\n) {\n  return type.properties[propertyName]!\n}\n\n/**\n * get the base type from inside an MST optional type\n */\nexport function getDefaultValue(type: IAnyType) {\n  if (!isOptionalType(type)) {\n    throw new TypeError('type must be an optional type')\n  }\n  // @ts-expect-error\n  return type._defaultValue || type.defaultValue\n}\n\nexport type IEnumerationType<T extends string> = ISimpleType<\n  UnionStringArray<T[]>\n>\n\n/** get the string values of an MST enumeration type */\nexport function getEnumerationValues(type: IAnyComplexType) {\n  const subtypes = getUnionSubTypes(type) as ILiteralType<string>[]\n  // the subtypes should all be literals with a value member\n  return subtypes.map(t => t.value)\n}\n\nexport function resolveLateType(maybeLate: IAnyType) {\n  if (\n    !isUnionType(maybeLate) &&\n    !isArrayType(maybeLate) &&\n    isLateType(maybeLate)\n  ) {\n    // @ts-expect-error\n    return maybeLate.getSubType()\n  }\n  return maybeLate\n}\n","import { Suspense, lazy, useState } from 'react'\n\nimport HelpIcon from '@mui/icons-material/Help'\nimport SearchIcon from '@mui/icons-material/Search'\nimport { IconButton, InputAdornment } from '@mui/material'\n\n// lazy\nconst HelpDialog = lazy(() => import('./HelpDialog.tsx'))\n\nfunction HelpAdornment() {\n  const [isHelpDialogDisplayed, setHelpDialogDisplayed] = useState(false)\n  return (\n    <>\n      <IconButton\n        onClick={() => {\n          setHelpDialogDisplayed(true)\n        }}\n        size=\"small\"\n      >\n        <HelpIcon fontSize=\"small\" />\n      </IconButton>\n      {isHelpDialogDisplayed ? (\n        <Suspense fallback={null}>\n          <HelpDialog\n            handleClose={() => {\n              setHelpDialogDisplayed(false)\n            }}\n          />\n        </Suspense>\n      ) : null}\n    </>\n  )\n}\n\nexport default function EndAdornment({ showHelp }: { showHelp?: boolean }) {\n  return (\n    <>\n      <InputAdornment position=\"end\" style={{ marginRight: 7 }}>\n        <SearchIcon fontSize=\"small\" />\n        {showHelp ? <HelpAdornment /> : null}\n      </InputAdornment>\n    </>\n  )\n}\n","import { getSession } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { alpha, useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport EndAdornment from './RefNameAutocomplete/EndAdornment.tsx'\nimport RefNameAutocomplete from './RefNameAutocomplete/index.tsx'\nimport { fetchResults } from './util.ts'\nimport { handleSelectedRegion, navToOption } from '../../searchUtils.ts'\nimport { SPACING, WIDGET_HEIGHT } from '../consts.ts'\n\nimport type { LinearGenomeViewModel } from '../model.ts'\nimport type BaseResult from '@jbrowse/core/TextSearch/BaseResults'\n\nconst useStyles = makeStyles()({\n  headerRefName: {\n    minWidth: 100,\n  },\n})\n\nasync function onSelect({\n  option,\n  model,\n  assemblyName,\n}: {\n  option: BaseResult\n  model: LinearGenomeViewModel\n  assemblyName: string\n}) {\n  const { assemblyManager } = getSession(model)\n  const assembly = assemblyManager.get(assemblyName)\n  if (option.hasLocation()) {\n    await navToOption({\n      option,\n      model,\n      assemblyName,\n    })\n  } else if (option.results?.length) {\n    model.setSearchResults(option.results, option.getLabel())\n  } else if (assembly) {\n    await handleSelectedRegion({\n      input: option.getLabel(),\n      assembly,\n      model,\n    })\n  }\n}\n\nconst SearchBox = observer(function SearchBox({\n  model,\n  showHelp = true,\n}: {\n  showHelp?: boolean\n  model: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  const theme = useTheme()\n  const session = getSession(model)\n\n  const { textSearchManager, assemblyManager } = session\n  const { assemblyNames, rankSearchResults } = model\n  const assemblyName = assemblyNames[0]!\n  const assembly = assemblyManager.get(assemblyName)\n  const searchScope = model.searchScope(assemblyName)\n\n  return (\n    <RefNameAutocomplete\n      onSelect={async option => {\n        try {\n          await onSelect({\n            model,\n            assemblyName,\n            option,\n          })\n        } catch (e) {\n          console.error(e)\n          getSession(model).notify(`${e}`, 'warning')\n        }\n      }}\n      assemblyName={assemblyName}\n      fetchResults={queryString =>\n        fetchResults({\n          queryString,\n          searchScope,\n          rankSearchResults,\n          textSearchManager,\n          assembly,\n        })\n      }\n      model={model}\n      minWidth={175}\n      TextFieldProps={{\n        variant: 'outlined',\n        className: classes.headerRefName,\n        style: {\n          margin: SPACING,\n        },\n        slotProps: {\n          input: {\n            style: {\n              padding: 0,\n              height: WIDGET_HEIGHT,\n              background: alpha(theme.palette.background.paper, 0.8),\n            },\n            endAdornment: <EndAdornment showHelp={showHelp} />,\n          },\n        },\n      }}\n    />\n  )\n})\n\nexport default SearchBox\n","import { type Observable, firstValueFrom, merge } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { BaseAdapter } from './BaseAdapter.ts'\nimport {\n  aggregateQuantitativeStats,\n  calculateFeatureDensityStats,\n} from './stats.ts'\nimport { ObservableCreate } from '../../util/rxjs.ts'\nimport { blankStats, scoresToStats } from '../../util/stats.ts'\n\nimport type { BaseOptions } from './BaseOptions.ts'\nimport type { Feature } from '../../util/simpleFeature.ts'\nimport type { AugmentedRegion as Region } from '../../util/types/index.ts'\n\n/**\n * Base class for feature adapters to extend. Defines some methods that\n * subclasses must implement.\n */\nexport abstract class BaseFeatureDataAdapter extends BaseAdapter {\n  /**\n   * Get all reference sequence names used in the data source\n   * Example:\n   * public async getRefNames(opts?: BaseOptions): Promise\\<string[]\\> \\}\n   *   await this.setup()\n   *   const \\{ refNames \\} = this.metadata\n   *   return refNames\n   * \\}\n   *\n   *\n   * NOTE: If an adapter is unable to determine the reference sequence names,\n   * the array will be empty\n   * @param opts - Feature adapter options\n   */\n  public abstract getRefNames(opts?: BaseOptions): Promise<string[]>\n\n  /**\n   * Get features from the data source that overlap a region\n   * Example:\n   * public getFeatures(\n   *   region: Region,\n   *   opts: BaseOptions,\n   * ): Observable<Feature> \\{\n   *   return ObservableCreate(observer =\\> \\{\n   *     const records = getRecords(assembly, refName, start, end)\n   *     records.forEach(record =\\> \\{\n   *       observer.next(this.recordToFeature(record))\n   *     \\})\n   *     observer.complete()\n   *   \\})\n   * \\}\n   * @param region - Region\n   * @param opts - Feature adapter options\n   * @returns Observable of Feature objects in the region\n   */\n  public abstract getFeatures(\n    region: Region,\n    opts?: BaseOptions,\n  ): Observable<Feature>\n\n  /**\n   * Return \"header info\" that is fetched from the data file, or other info\n   * that would not simply be in the config of the file. The return value can\n   * be `{tag:string, data: any}[]` e.g. list of tags with their values which\n   * is how VCF,BAM,CRAM return values for getInfo or it can be a nested JSON\n   * object\n   */\n  public async getHeader(_opts?: BaseOptions): Promise<unknown> {\n    return null\n  }\n\n  /**\n   * Return info that is primarily used for interpreting the data that is there,\n   * primarily in reference to being used for augmenting feature details panels\n   */\n  public async getMetadata(_opts?: BaseOptions): Promise<unknown> {\n    return null\n  }\n\n  /**\n   * Checks if the store has data for the given assembly and reference\n   * sequence, and then gets the features in the region if it does.\n   */\n  public getFeaturesInRegion(region: Region, opts: BaseOptions = {}) {\n    return ObservableCreate<Feature>(async observer => {\n      const hasData = await this.hasDataForRefName(region.refName, opts)\n      if (!hasData) {\n        observer.complete()\n      } else {\n        this.getFeatures(region, opts).subscribe(observer)\n      }\n    })\n  }\n\n  /**\n   * Checks if the store has data for the given assembly and reference\n   * sequence, and then gets the features in the region if it does.\n   *\n   * Currently this just calls getFeatureInRegion for each region. Adapters that\n   * are frequently called on multiple regions simultaneously may want to\n   * implement a more efficient custom version of this method.\n   *\n   * @param regions - Regions\n   * @param opts - Feature adapter options\n   * @returns Observable of Feature objects in the regions\n   */\n  public getFeaturesInMultipleRegions(\n    regions: Region[],\n    opts: BaseOptions = {},\n  ) {\n    return merge(\n      ...regions.map(region => this.getFeaturesInRegion(region, opts)),\n    )\n  }\n\n  /**\n   * Check if the store has data for the given reference name.\n   * @param refName - Name of the reference sequence\n   * @returns Whether data source has data for the given reference name\n   */\n  public async hasDataForRefName(refName: string, opts: BaseOptions = {}) {\n    const refNames = await this.getRefNames(opts)\n    return refNames.includes(refName)\n  }\n\n  /**\n   * Calculates the minimum score, maximum score, and other statistics from\n   * features over a region, primarily used for quantitative tracks\n   */\n  public async getRegionQuantitativeStats(region: Region, opts?: BaseOptions) {\n    const feats = this.getFeatures(region, {\n      ...opts,\n      statsEstimationMode: true,\n    })\n    return scoresToStats(region, feats)\n  }\n  /**\n   * Calculates the minimum score, maximum score, and other statistics from\n   * features over multiple regions, primarily used for quantitative tracks\n   */\n  public async getMultiRegionQuantitativeStats(\n    regions: Region[] = [],\n    opts?: BaseOptions,\n  ) {\n    if (!regions.length) {\n      return blankStats()\n    }\n    const stats = await Promise.all(\n      regions.map(region => this.getRegionQuantitativeStats(region, opts)),\n    )\n    return aggregateQuantitativeStats(stats)\n  }\n\n  /**\n   * Calculates the \"feature density\" of a region. The primary purpose of this\n   * API is to alert the user if they are going to be downloading too much\n   * information, and give them a hint to zoom in to see more. The default\n   * implementation samples from the regions, downloads feature data with\n   * getFeatures, and returns an object with the form \\{featureDensity:number\\}\n\n   * 1. alternative calculations for featureDensity\n   * 2. they can also return an object containing a byte size calculation with\n   * the format \\{bytes:number, fetchSizeLimit:number\\}\n   *\n   * In 2. the fetchSizeLimit is the adapter-defined limit for what it thinks\n   * is 'too much data' (e.g. CRAM and BAM may vary on what they think too much\n   * data is)\n   */\n  getRegionFeatureDensityStats(region: Region, opts?: BaseOptions) {\n    return calculateFeatureDensityStats(\n      region,\n      (region2, opts2) => this.getFeatures(region2, opts2),\n      opts,\n    )\n  }\n\n  /**\n   * Calculates the \"feature density\" of a set of regions. Note: Currently only\n   * fetches from the first region because it is a heuristic\n   */\n  public async getMultiRegionFeatureDensityStats(\n    regions: Region[],\n    opts?: BaseOptions,\n  ) {\n    if (!regions.length) {\n      throw new Error('No regions supplied')\n    }\n    return this.getRegionFeatureDensityStats(regions[0]!, opts)\n  }\n\n  async getSources(\n    regions: Region[],\n  ): Promise<{ name: string; color?: string; [key: string]: unknown }[]> {\n    const features = await firstValueFrom(\n      this.getFeaturesInMultipleRegions(regions).pipe(toArray()),\n    )\n    const sources = new Set<string>()\n    for (const f of features) {\n      sources.add(f.get('source'))\n    }\n    return [...sources].map(source => ({\n      name: source,\n    }))\n  }\n\n  /**\n   * Export data from the adapter in a specified format for given regions.\n   * Some adapters (like VcfAdapter) can efficiently export raw data directly\n   * from the file without parsing to features.\n   *\n   * @param regions - Regions to export data from\n   * @param formatType - The format to export to (e.g. 'vcf', 'sam', 'bedgraph')\n   * @param opts - Feature adapter options\n   * @returns Promise resolving to the exported data as a string, or undefined\n   *          if the adapter does not support direct export for this format\n   */\n  public async getExportData(\n    _regions: Region[],\n    _formatType: string,\n    _opts?: BaseOptions,\n  ): Promise<string | undefined> {\n    return undefined\n  }\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationModel } from '../configuration/index.ts'\nimport type { Feature, Region } from '../util/index.ts'\nimport type { Theme } from '@mui/material'\n\nexport interface GlyphRenderContext {\n  ctx: CanvasRenderingContext2D\n  feature: Feature\n  featureLayout: GlyphFeatureLayout\n  region: Region\n  bpPerPx: number\n  config: AnyConfigurationModel\n  theme: Theme\n  reversed: boolean\n  topLevel: boolean\n  canvasWidth: number\n}\n\nexport interface GlyphFeatureLayout {\n  feature: Feature\n  x: number\n  y: number\n  width: number\n  height: number\n  children: GlyphFeatureLayout[]\n}\n\nexport interface GlyphArgs {\n  name: string\n  displayName?: string\n  draw: (context: GlyphRenderContext) => void\n  getChildFeatures?: (\n    feature: Feature,\n    config: AnyConfigurationModel,\n  ) => Feature[]\n  /**\n   * Returns a height multiplier for this glyph. The base feature height\n   * will be multiplied by this value. Useful for glyphs that need to\n   * display stacked/tiered content.\n   * @param feature The feature being rendered\n   * @param config The configuration model\n   * @returns A multiplier (e.g., 2 means double height). Default is 1.\n   */\n  getHeightMultiplier?: (\n    feature: Feature,\n    config: AnyConfigurationModel,\n  ) => number\n  /**\n   * Returns custom mouseover text for a child feature.\n   * @param childFeature The child feature being hovered\n   * @returns The mouseover text to display, or undefined to use default\n   */\n  getSubfeatureMouseover?: (childFeature: Feature) => string | undefined\n  match?: (feature: Feature) => boolean\n  /**\n   * Priority for glyph matching. Higher priority glyphs are checked first.\n   * Use this to override built-in glyphs or ensure your glyph takes precedence.\n   * Default is 0. Built-in glyphs use priority 0.\n   */\n  priority?: number\n}\n\nexport default class GlyphType extends PluggableElementBase {\n  draw: (context: GlyphRenderContext) => void\n  getChildFeatures?: (\n    feature: Feature,\n    config: AnyConfigurationModel,\n  ) => Feature[]\n  getHeightMultiplier?: (\n    feature: Feature,\n    config: AnyConfigurationModel,\n  ) => number\n  getSubfeatureMouseover?: (childFeature: Feature) => string | undefined\n  match?: (feature: Feature) => boolean\n  priority: number\n\n  constructor(args: GlyphArgs) {\n    super(args)\n    this.draw = args.draw\n    this.getChildFeatures = args.getChildFeatures\n    this.getHeightMultiplier = args.getHeightMultiplier\n    this.getSubfeatureMouseover = args.getSubfeatureMouseover\n    this.match = args.match\n    this.priority = args.priority ?? 0\n  }\n}\n","import type {\n  BaseLayout,\n  RectTuple,\n  Rectangle,\n  SerializedLayout,\n} from './BaseLayout.ts'\n\n/**\n * See https://github.com/cmdcolin/track_layout_benchmark for information on\n * alternative algorithms and benchmark information\n */\n\n// minimum excess size of the array at which we garbage collect\nconst maxFeaturePitchWidth = 20000\n\n// Optimized row class using flat interval array\nclass LayoutRow<T> {\n  private padding = 1\n\n  public allFilled?: Record<string, T> | string\n\n  // Flat array: [start1, end1, start2, end2, ...]\n  // Kept sorted by start position for binary search\n  private intervals: number[] = []\n\n  // Parallel array storing data for each interval\n  private data: (Record<string, T> | string)[] = []\n\n  setAllFilled(data: Record<string, T> | string): void {\n    this.allFilled = data\n  }\n\n  getIntervals(): number[] {\n    return this.intervals\n  }\n\n  getItemAt(x: number): Record<string, T> | string | undefined {\n    if (this.allFilled) {\n      return this.allFilled\n    }\n\n    const intervals = this.intervals\n    const len = intervals.length\n\n    if (len === 0) {\n      return undefined\n    }\n\n    // Linear scan for small arrays\n    if (len < 40) {\n      for (let i = 0; i < len; i += 2) {\n        if (x >= intervals[i]! && x < intervals[i + 1]!) {\n          return this.data[i >> 1]\n        }\n      }\n      return undefined\n    }\n\n    // Binary search for larger arrays - find interval containing x\n    let low = 0\n    let high = len >> 1\n\n    while (low < high) {\n      const mid = (low + high) >>> 1\n      const midIdx = mid << 1\n      if (intervals[midIdx + 1]! <= x) {\n        low = mid + 1\n      } else {\n        high = mid\n      }\n    }\n\n    const idx = low << 1\n    if (idx < len && x >= intervals[idx]! && x < intervals[idx + 1]!) {\n      return this.data[low]\n    }\n    return undefined\n  }\n\n  isRangeClear(left: number, right: number): boolean {\n    if (this.allFilled) {\n      return false\n    }\n\n    const intervals = this.intervals\n    const len = intervals.length\n\n    // Empty row is always clear\n    if (len === 0) {\n      return true\n    }\n\n    // Linear scan for small arrays (better cache locality)\n    if (len < 40) {\n      for (let i = 0; i < len; i += 2) {\n        const start = intervals[i]!\n        const end = intervals[i + 1]!\n        // Intersection check: end > left && start < right\n        if (end > left && start < right) {\n          return false\n        }\n      }\n      return true\n    }\n\n    // Binary search for larger arrays\n    // Find first interval whose end > left (first potential overlap)\n    let low = 0\n    let high = len >> 1\n\n    while (low < high) {\n      const mid = (low + high) >>> 1\n      const midIdx = mid << 1\n      if (intervals[midIdx + 1]! <= left) {\n        low = mid + 1\n      } else {\n        high = mid\n      }\n    }\n\n    // Check if found interval overlaps\n    const idx = low << 1\n    if (idx >= len) {\n      return true\n    }\n\n    // If the first candidate's start is >= right, no overlap possible\n    const start = intervals[idx]!\n    if (start >= right) {\n      return true\n    }\n\n    // This interval overlaps (we know end > left from binary search, and start < right)\n    return false\n  }\n\n  addRect(rect: Rectangle<T>, data: Record<string, T> | string): void {\n    const left = rect.l\n    const right = rect.r + this.padding\n    const intervals = this.intervals\n    const len = intervals.length\n\n    // Hybrid insertion strategy\n    if (len < 40) {\n      // Linear insertion for small arrays\n      let idx = len\n      for (let i = 0; i < len; i += 2) {\n        if (left < intervals[i]!) {\n          idx = i\n          break\n        }\n      }\n      intervals.splice(idx, 0, left, right)\n      this.data.splice(idx >> 1, 0, data)\n    } else {\n      // Binary search insertion for larger arrays\n      let low = 0\n      let high = len >> 1\n\n      while (low < high) {\n        const mid = (low + high) >>> 1\n        const midIdx = mid << 1\n        if (intervals[midIdx]! < left) {\n          low = mid + 1\n        } else {\n          high = mid\n        }\n      }\n\n      intervals.splice(low << 1, 0, left, right)\n      this.data.splice(low, 0, data)\n    }\n  }\n\n  discardRange(left: number, right: number): void {\n    if (this.allFilled) {\n      return\n    }\n\n    const intervals = this.intervals\n    const data = this.data\n    const oldLen = intervals.length\n    const newIntervals: number[] = []\n    const newData: (Record<string, T> | string)[] = []\n\n    for (let i = 0; i < oldLen; i += 2) {\n      const start = intervals[i]!\n      const end = intervals[i + 1]!\n      const intervalData = data[i >> 1]!\n\n      // If interval is completely within discard range, skip it\n      if (start >= left && end <= right) {\n        continue\n      }\n      // If no overlap, keep it\n      if (end <= left || start >= right) {\n        newIntervals.push(start, end)\n        newData.push(intervalData)\n      }\n      // If interval overlaps left edge\n      else if (start < left && end > left) {\n        if (end <= right) {\n          // Trim from the right\n          newIntervals.push(start, left)\n          newData.push(intervalData)\n        } else {\n          // Interval spans the entire discard range, split it\n          newIntervals.push(start, left, right, end)\n          newData.push(intervalData, intervalData)\n        }\n      }\n      // If interval overlaps right edge only\n      else if (start < right && end > right) {\n        newIntervals.push(right, end)\n        newData.push(intervalData)\n      }\n    }\n\n    this.intervals = newIntervals\n    this.data = newData\n  }\n}\n\nexport default class GranularRectLayout<T> implements BaseLayout<T> {\n  private pitchX: number\n\n  private pitchY: number\n\n  private hardRowLimit: number\n\n  private bitmap: LayoutRow<T>[]\n\n  private rectangles: Map<string, Rectangle<T>>\n\n  public maxHeightReached: boolean\n\n  private maxHeight: number\n\n  private displayMode: string\n\n  private pTotalHeight: number\n\n  /**\n   * pitchX - layout grid pitch in the X direction\n   * pitchY - layout grid pitch in the Y direction\n   * maxHeight - maximum layout height, default Infinity (no max)\n   */\n  constructor({\n    pitchX = 10,\n    pitchY = 10,\n    maxHeight = 10000,\n    hardRowLimit = 10000,\n    displayMode = 'normal',\n  }: {\n    pitchX?: number\n    pitchY?: number\n    maxHeight?: number\n    displayMode?: string\n    hardRowLimit?: number\n  } = {}) {\n    this.pitchX = pitchX\n    this.pitchY = pitchY\n    this.hardRowLimit = hardRowLimit\n    this.maxHeightReached = false\n    this.displayMode = displayMode\n\n    // reduce the pitchY to try and pack the features tighter\n    if (this.displayMode === 'compact') {\n      this.pitchY = Math.round(this.pitchY / 4) || 1\n      this.pitchX = Math.round(this.pitchX / 4) || 1\n    }\n\n    this.bitmap = []\n    this.rectangles = new Map()\n    this.maxHeight = Math.ceil(maxHeight / this.pitchY)\n    this.pTotalHeight = 0 // total height, in units of bitmap squares (px/pitchY)\n  }\n\n  /**\n   * @returns top position for the rect, or Null if laying\n   *  out the rect would exceed maxHeight\n   * @param startingRow - Optional hint (in pixels) for where to start searching for free space.\n   *  Use when you know features overlap (e.g., sorted reads at the same position).\n   *  The hint is only used as a starting point; collision detection still verifies.\n   */\n  addRect(\n    id: string,\n    left: number,\n    right: number,\n    height: number,\n    data?: T,\n    serializableData?: T,\n    startingRow?: number,\n  ): number | null {\n    const pitchX = this.pitchX\n    const pitchY = this.pitchY\n\n    // if we have already laid it out, return its layout\n    const storedRec = this.rectangles.get(id)\n    if (storedRec) {\n      // Update serializableData even if rect already exists\n      // This is needed when config changes (e.g., showSubfeatureLabels toggle)\n      // cause the same rect to be added with different metadata\n      if (serializableData !== undefined) {\n        storedRec.serializableData = serializableData\n      }\n\n      if (storedRec.top === null) {\n        return null\n      }\n\n      // add it to the bitmap again, since that bitmap range may have been\n      // discarded\n      this.addRectToBitmap(storedRec)\n      return storedRec.top * pitchY\n    }\n\n    // Use Math.trunc for fast floor operation that works with large coordinates\n    // (bitwise | 0 overflows above 2^31, causing layout issues with large genomic coordinates)\n    const pLeft = Math.trunc(left / pitchX)\n    const pRight = Math.trunc(right / pitchX)\n    const pHeight = Math.ceil(height / pitchY)\n\n    const rectangle: Rectangle<T> = {\n      id,\n      l: pLeft,\n      r: pRight,\n      top: null,\n      h: pHeight,\n      originalHeight: height,\n      data,\n      serializableData,\n    }\n\n    // Allow features to start at any position up to maxHeight\n    // Features starting at maxHeight or beyond are filtered out, but features\n    // that start below maxHeight and extend past it are allowed\n    const maxTop = this.maxHeight\n    // Use startingRow hint if provided (in pixels), convert to pitch rows\n    let top =\n      startingRow !== undefined\n        ? Math.min(Math.floor(startingRow / pitchY), maxTop)\n        : 0\n\n    if (this.displayMode !== 'collapse') {\n      // OPTIMIZATION: Inline collision checking for hot path\n      // Eliminates function call overhead which is critical at 100k+ features\n      const bitmap = this.bitmap\n\n      outer: for (; top <= maxTop; top += 1) {\n        // Check all rows that this rectangle would occupy\n        const maxY = top + pHeight\n        for (let y = top; y < maxY; y += 1) {\n          const row = bitmap[y]\n\n          // Fast path: no row created yet\n          if (!row) {\n            continue\n          }\n\n          // Fast path: row is all filled\n          if (row.allFilled) {\n            continue outer\n          }\n\n          // Fully inlined isRangeClear for maximum performance\n          const intervals = row.getIntervals()\n          const len = intervals.length\n\n          if (len > 0) {\n            if (len < 40) {\n              // Linear scan for small arrays\n              for (let i = 0; i < len; i += 2) {\n                const start = intervals[i]!\n                const end = intervals[i + 1]!\n                if (end > pLeft && start < pRight) {\n                  continue outer\n                }\n              }\n            } else {\n              // Binary search for larger arrays\n              let low = 0\n              let high = len >> 1\n\n              while (low < high) {\n                const mid = (low + high) >>> 1\n                const midIdx = mid << 1\n                if (intervals[midIdx + 1]! <= pLeft) {\n                  low = mid + 1\n                } else {\n                  high = mid\n                }\n              }\n\n              const idx = low << 1\n              if (idx < len) {\n                const start = intervals[idx]!\n                if (start < pRight) {\n                  continue outer\n                }\n              }\n            }\n          }\n        }\n\n        // No collision found in any row\n        break\n      }\n\n      if (top > maxTop) {\n        rectangle.top = null\n        this.rectangles.set(id, rectangle)\n        this.maxHeightReached = true\n        return null\n      }\n    }\n\n    rectangle.top = top\n    this.addRectToBitmap(rectangle)\n    this.rectangles.set(id, rectangle)\n    this.pTotalHeight = Math.max(this.pTotalHeight || 0, top + pHeight)\n    return top * pitchY\n  }\n\n  collides(rect: Rectangle<T>, top: number) {\n    const { bitmap } = this\n\n    const maxY = top + rect.h\n    for (let y = top; y < maxY; y += 1) {\n      const row = bitmap[y]\n      if (row !== undefined && !row.isRangeClear(rect.l, rect.r)) {\n        return true\n      }\n    }\n\n    return false\n  }\n\n  addRectToBitmap(rect: Rectangle<T>) {\n    if (rect.top === null) {\n      return\n    }\n\n    const data = rect.id\n    const yEnd = rect.top + rect.h\n    const bitmap = this.bitmap\n    const hardRowLimit = this.hardRowLimit\n    const pitchY = this.pitchY\n\n    if (rect.r - rect.l > maxFeaturePitchWidth) {\n      // the rect is very big in relation to the view size, just pretend, for\n      // the purposes of layout, that it extends infinitely.  this will cause\n      // weird layout if a user scrolls manually for a very, very long time\n      // along the genome at the same zoom level.  but most users will not do\n      // that.  hopefully.\n      for (let y = rect.top; y < yEnd; y += 1) {\n        let row = bitmap[y]\n        if (!row) {\n          if (y > hardRowLimit) {\n            throw new Error(\n              `layout hard limit (${hardRowLimit * pitchY}px) exceeded, aborting layout`,\n            )\n          }\n          row = new LayoutRow()\n          bitmap[y] = row\n        }\n        row.setAllFilled(data)\n      }\n    } else {\n      for (let y = rect.top; y < yEnd; y += 1) {\n        let row = bitmap[y]\n        if (!row) {\n          if (y > hardRowLimit) {\n            throw new Error(\n              `layout hard limit (${hardRowLimit * pitchY}px) exceeded, aborting layout`,\n            )\n          }\n          row = new LayoutRow()\n          bitmap[y] = row\n        }\n        row.addRect(rect, data)\n      }\n    }\n  }\n\n  /**\n   *  Given a range of X coordinates, deletes all data dealing with\n   *  the features.\n   */\n  discardRange(left: number, right: number) {\n    const pLeft = Math.trunc(left / this.pitchX)\n    const pRight = Math.trunc(right / this.pitchX)\n    const { bitmap } = this\n    for (const row of bitmap) {\n      row.discardRange(pLeft, pRight)\n    }\n  }\n\n  hasSeen(id: string) {\n    return this.rectangles.has(id)\n  }\n\n  getByCoord(x: number, y: number) {\n    const pY = Math.trunc(y / this.pitchY)\n    const row = this.bitmap[pY]\n    if (!row) {\n      return undefined\n    }\n    const pX = Math.trunc(x / this.pitchX)\n    return row.getItemAt(pX)\n  }\n\n  getByID(id: string) {\n    const r = this.rectangles.get(id)\n    if (r) {\n      const t = r.top! * this.pitchY\n      return [\n        r.l * this.pitchX,\n        t,\n        r.r * this.pitchX,\n        t + r.originalHeight,\n      ] as RectTuple\n    }\n\n    return undefined\n  }\n\n  getDataByID(id: string) {\n    return this.rectangles.get(id)?.data\n  }\n\n  getSerializableDataByID(id: string) {\n    return this.rectangles.get(id)?.serializableData\n  }\n\n  cleanup() {}\n\n  getTotalHeight() {\n    return this.pTotalHeight * this.pitchY\n  }\n\n  get totalHeight() {\n    return this.getTotalHeight()\n  }\n\n  getRectangles(): Map<string, RectTuple> {\n    const pitchX = this.pitchX\n    const pitchY = this.pitchY\n    // @ts-expect-error\n    return new Map(\n      [...this.rectangles.entries()].map(([id, rect]) => {\n        const { l, r, originalHeight, top, serializableData } = rect\n        const t = (top || 0) * pitchY\n        const b = t + originalHeight\n        return [id, [l * pitchX, t, r * pitchX, b, serializableData]] // left, top, right, bottom\n      }),\n    )\n  }\n\n  serializeRegion(region: { start: number; end: number }): SerializedLayout {\n    const pitchX = this.pitchX\n    const pitchY = this.pitchY\n    const x1 = region.start\n    const x2 = region.end\n    const regionRectangles: Record<string, RectTuple> = {}\n    let maxHeightReached = false\n\n    for (const [id, rect] of this.rectangles.entries()) {\n      const { l, r, originalHeight, top } = rect\n      if (top === null) {\n        maxHeightReached = true\n      } else {\n        const t = top * pitchY\n        const b = t + originalHeight\n        const y1 = l * pitchX\n        const y2 = r * pitchX\n        // add +/- pitchX to avoid resolution causing errors\n        if (x2 >= y1 - pitchX && y2 + pitchX >= x1) {\n          // @ts-expect-error\n          regionRectangles[id] = [y1, t, y2, b, rect.serializableData]\n        }\n      }\n    }\n    return {\n      rectangles: regionRectangles,\n      totalHeight: this.getTotalHeight(),\n      maxHeightReached,\n    }\n  }\n\n  toJSON(): SerializedLayout {\n    const rectangles = Object.fromEntries(this.getRectangles())\n    return {\n      rectangles,\n      totalHeight: this.getTotalHeight(),\n      maxHeightReached: this.maxHeightReached,\n    }\n  }\n}\n","import { useEffect } from 'react'\n\nimport dompurify from 'dompurify'\nimport escapeHTML from 'escape-html'\n\nimport { linkify } from '../util/index.ts'\n\n// source https://github.com/sindresorhus/html-tags/blob/master/html-tags.json\n// with some random uncommon ones removed. note: we just use this to run the content\n// through dompurify without escaping if we see an htmlTag from this list\n// otherwise we escape angle brackets and things prematurely because it might be\n// something like <TRA> in VCF. Ref #657\nconst htmlTags = [\n  'a',\n  'b',\n  'br',\n  'code',\n  'div',\n  'em',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'i',\n  'img',\n  'li',\n  'p',\n  'pre',\n  'span',\n  'small',\n  'strong',\n  'table',\n  'tbody',\n  'sup',\n  'sub',\n  'td',\n  'tfoot',\n  'th',\n  'thead',\n  'tr',\n  'u',\n  'ul',\n]\n\nlet added = false\n\n// adapted from is-html\n// https://github.com/sindresorhus/is-html/blob/master/index.js\nconst full = new RegExp(\n  htmlTags.map(tag => String.raw`<${tag}\\b[^>]*>`).join('|'),\n  'i',\n)\nfunction isHTML(str: string) {\n  return full.test(str)\n}\n\n// note this is mocked during testing, see\n// packages/__mocks__/@jbrowse/core/ui/SanitizedHTML something about dompurify\n// behavior causes errors during tests, was seen in\n// products/jbrowse-web/src/tests/Connection.test.tsx test (can delete mock to\n// see)\n//\nexport default function SanitizedHTML({\n  html: pre,\n  className,\n}: {\n  className?: string\n  html: unknown\n}) {\n  // try to add links to the text first\n  const html = linkify(`${pre}`)\n  const value = isHTML(html) ? html : escapeHTML(html)\n  useEffect(() => {\n    if (!added) {\n      added = true\n      // see https://github.com/cure53/DOMPurify/issues/317\n      // only have to add this once, and can't do it globally because dompurify\n      // not yet initialized at global scope\n      dompurify.addHook('afterSanitizeAttributes', node => {\n        if (node.tagName === 'A') {\n          node.setAttribute('rel', 'noopener noreferrer')\n          node.setAttribute('target', '_blank')\n        }\n      })\n    }\n  }, [])\n\n  return (\n    <span\n      className={className}\n      dangerouslySetInnerHTML={{\n        __html: dompurify.sanitize(value),\n      }}\n    />\n  )\n}\n","'use client'\n\nexport { keyframes } from '@emotion/react'\nexport { makeStyles } from './mui/index.ts'\n\n// Export cx as a standalone function (wrapper around classnames)\nimport { type CxArg, classnames } from './tools/classnames.ts'\nexport function cx(...args: CxArg[]): string {\n  return classnames(args)\n}\n","import { isWebWorker } from './isWebWorker.ts'\n\n/**\n * source https://github.com/panstromek/zebra-rs/blob/82d616225930b3ad423a2c6d883c79b94ee08ba6/webzebra/src/stopToken.ts#L34C1-L57C16\n *\n * blogpost https://yoyo-code.com/how-to-stop-synchronous-web-worker/\n *\n * license \"I explicitly added MIT license to the stopToken file to make it more\n * permissive\"\n *\n * Copyright (c) 2022 Maty Racek\n *\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to\n * deal in the Software without restriction, including without limitation the\n * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n * sell copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in\n * all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n * IN THE SOFTWARE.\n */\n\n// export type StopToken = string | SharedArrayBuffer\nexport type StopToken = string\n\n// Check if SharedArrayBuffer is available (requires cross-origin isolation)\n// function isSharedArrayBufferAvailable() {\n//   try {\n//     // Need to actually try to use it, not just check typeof\n//     return (\n//       typeof SharedArrayBuffer !== 'undefined' &&\n//       new SharedArrayBuffer(4).byteLength === 4\n//     )\n//   } catch {\n//     return false\n//   }\n// }\n\n// const useSharedArrayBuffer = isSharedArrayBufferAvailable()\n\nexport function createStopTokenChecker(stopToken: StopToken | undefined) {\n  return {\n    time: Date.now(),\n    iters: 0,\n    stopToken,\n  }\n}\n\nexport function createStopToken(): StopToken {\n  // URL not available in jest and can't properly mock it\n  // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n  return URL.createObjectURL?.(new Blob()) || `${Math.random()}`\n}\n\n// unused SharedArrayBuffer\n// export function createStopToken(): StopToken {\n//   // Prefer SharedArrayBuffer when available (faster, just memory access)\n//   if (useSharedArrayBuffer) {\n//     const buffer = new SharedArrayBuffer(4)\n//     new Int32Array(buffer)[0] = 0 // Initialize to not-aborted\n//     return buffer\n//   } else {\n//     // Fallback to blob URL approach\n//     // URL not available in jest and can't properly mock it\n//     // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n//     return URL.createObjectURL?.(new Blob()) || `${Math.random()}`\n//   }\n// }\n\n// Safely check if a value is a SharedArrayBuffer\nfunction isSharedArrayBuffer(value: unknown): value is SharedArrayBuffer {\n  try {\n    return (\n      typeof SharedArrayBuffer !== 'undefined' &&\n      value instanceof SharedArrayBuffer\n    )\n  } catch {\n    return false\n  }\n}\n\nexport function stopStopToken(stopToken?: StopToken) {\n  if (stopToken !== undefined) {\n    if (isSharedArrayBuffer(stopToken)) {\n      // Set abort flag\n      Atomics.store(new Int32Array(stopToken), 0, 1)\n    } else {\n      // Revoke blob URL\n      // URL not available in jest and can't properly mock it\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      URL.revokeObjectURL?.(stopToken)\n    }\n  }\n}\n\nexport function checkStopToken(stopToken: StopToken | undefined) {\n  if (stopToken === undefined) {\n    return\n  }\n\n  if (isSharedArrayBuffer(stopToken)) {\n    // Fast path: just check memory\n    if (Atomics.load(new Int32Array(stopToken), 0) === 1) {\n      throw new Error('aborted')\n    }\n  } else if (typeof jest === 'undefined' && isWebWorker()) {\n    // Slow path: synchronous XHR (avoid on main thread)\n    const xhr = new XMLHttpRequest()\n    xhr.open('GET', stopToken, false)\n    try {\n      xhr.send(null)\n    } catch {\n      throw new Error('aborted')\n    }\n  }\n}\n\nexport interface LastStopTokenCheck {\n  time: number\n  iters: number\n  backoff?: boolean\n  checkInterval?: number\n  checkIters?: number\n  stopToken?: StopToken\n}\nexport function checkStopToken2(lastCheck?: LastStopTokenCheck) {\n  if (!lastCheck) {\n    return\n  }\n  const {\n    stopToken,\n    backoff = true,\n    checkInterval = 50,\n    checkIters = 100,\n  } = lastCheck\n  lastCheck.iters++\n  if (stopToken === undefined) {\n    return\n  }\n  if (lastCheck.iters % checkIters !== 0) {\n    return\n  }\n\n  // SharedArrayBuffer is cheap, always check\n  if (isSharedArrayBuffer(stopToken)) {\n    checkStopToken(stopToken)\n  }\n\n  // Sync XHR is expensive, throttle to every 10ms\n  const now = Date.now()\n  if (now - lastCheck.time > checkInterval) {\n    lastCheck.time = now\n    checkStopToken(stopToken)\n    if (backoff) {\n      // initialize if not exist\n      lastCheck.checkInterval ??= checkInterval\n      // add backoff\n      lastCheck.checkInterval += checkInterval\n    }\n  }\n}\n\nexport function forEachWithStopTokenCheck<T>(\n  iter: Iterable<T>,\n  stopToken: StopToken | undefined,\n  arg: (arg: T, idx: number) => void,\n  durationMs = 400,\n  checkIters = 100,\n  backoff = true,\n) {\n  const lastCheck = {\n    time: Date.now(),\n    iters: 0,\n    checkInterval: durationMs,\n    backoff,\n    checkIters,\n    stopToken,\n  }\n  let iters = 0\n  for (const t of iter) {\n    arg(t, iters++)\n    checkStopToken2(lastCheck)\n  }\n}\n","export function isWebWorker() {\n  return (\n    // @ts-expect-error\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // @ts-expect-error\n    self instanceof WorkerGlobalScope\n  )\n}\n","/**\n * Abstract feature object\n */\nexport interface Feature {\n  /**\n   * Get a piece of data about the feature.  All features must have\n   * 'start' and 'end', but everything else is optional.\n   */\n  get(name: 'refName'): string\n  get(name: 'start' | 'end'): number\n  get(name: 'subfeatures'): Feature[] | undefined\n\n  get(name: string): any\n  /**\n   * Get the unique ID of this feature.\n   */\n  id(): string\n\n  /**\n   * Get this feature's parent feature, or undefined if none.\n   */\n  parent?: () => Feature | undefined\n\n  /**\n   * Get an array of child features, or undefined if none.\n   */\n  children?: () => Feature[] | undefined\n\n  /**\n   * Convert to JSON\n   */\n  toJSON(): SimpleFeatureSerialized\n}\n\nexport function isFeature(thing: unknown): thing is Feature {\n  return (\n    typeof thing === 'object' &&\n    thing !== null &&\n    typeof (thing as Feature).get === 'function' &&\n    typeof (thing as Feature).id === 'function'\n  )\n}\n\nexport interface SimpleFeatureArgs {\n  /** key-value data, must include 'start' and 'end' */\n  data: Record<string, unknown>\n  /** optional parent feature */\n  parent?: Feature\n  /** unique identifier. can also be in data.uniqueId */\n  id: string | number // thing that can be stringified easily\n}\n\n// subfeatures do not have to have uniqueId\nexport interface SimpleFeatureSerializedNoId {\n  [key: string]: unknown\n  parentId?: string\n  start: number\n  end: number\n  refName: string\n  type?: string\n  subfeatures?: SimpleFeatureSerializedNoId[]\n}\n\n// base serialized feature has to have a uniqueId\nexport interface SimpleFeatureSerialized extends SimpleFeatureSerializedNoId {\n  subfeatures?: SimpleFeatureSerializedNoId[]\n  uniqueId: string\n}\n\nfunction isSimpleFeatureSerialized(\n  args: SimpleFeatureSerialized | SimpleFeatureArgs,\n): args is SimpleFeatureSerialized {\n  return 'uniqueId' in args && typeof args.data !== 'object'\n}\n\n/**\n * Simple implementation of a feature object.\n */\nexport default class SimpleFeature implements Feature {\n  private data: Record<string, any>\n\n  private subfeatures?: SimpleFeature[]\n\n  private parentHandle?: Feature\n\n  private uniqueId: string\n\n  /**\n   * @param args - SimpleFeature args\n   *\n   * Note: args.data.subfeatures can be an array of these same args,\n   * which will be inflated to more instances of this class.\n   */\n  public constructor(args: SimpleFeatureArgs | SimpleFeatureSerialized) {\n    if (isSimpleFeatureSerialized(args)) {\n      this.data = args\n    } else {\n      this.data = args.data\n      // load handle from args.parent (not args.data.parent) this reason is\n      // because if args is an object, it likely isn't properly loaded with\n      // parent as a Feature reference (probably a raw parent ID or something\n      // instead)\n      this.parentHandle = args.parent\n    }\n\n    // the feature id comes from args.id, args.data.uniqueId, or args.uniqueId\n    // due to this initialization\n    const id = isSimpleFeatureSerialized(args) ? args.uniqueId : args.id\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (id === undefined || id === null) {\n      throw new Error(\n        'SimpleFeature requires a unique `id` or `data.uniqueId` attribute',\n      )\n    }\n    this.uniqueId = String(id)\n\n    if (!(this.data.aliases || this.data.end - this.data.start >= 0)) {\n      throw new Error(\n        `invalid feature data, end less than start. end: ${this.data.end} start: ${this.data.start}`,\n      )\n    }\n    if (this.data.subfeatures) {\n      this.subfeatures = this.data.subfeatures?.map((f: any, i: number) =>\n        typeof f.get !== 'function'\n          ? new SimpleFeature({\n              id: f.uniqueId || `${id}-${i}`,\n              data: {\n                strand: this.data.strand,\n                ...f,\n              } as Record<string, any>,\n              parent: this,\n            })\n          : f,\n      )\n    }\n  }\n\n  /**\n   * Get a piece of data about the feature.  All features must have\n   * 'start' and 'end', but everything else is optional.\n   */\n\n  public get(name: string): any {\n    return name === 'subfeatures'\n      ? this.subfeatures\n      : name === 'parent'\n        ? this.parent()\n        : this.data[name]\n  }\n\n  /**\n   * Set an item of data.\n   */\n\n  public set(name: string, val: any): void {\n    this.data[name] = val\n  }\n\n  /**\n   * Get an array listing which data keys are present in this feature.\n   */\n  public tags(): string[] {\n    return Object.keys(this.data)\n  }\n\n  /**\n   * Get the unique ID of this feature.\n   */\n  public id(): string {\n    return this.uniqueId\n  }\n\n  /**\n   * Get this feature's parent feature, or undefined if none.\n   */\n  public parent(): Feature | undefined {\n    return this.parentHandle\n  }\n\n  /**\n   * Get an array of child features, or undefined if none.\n   */\n  public children(): Feature[] | undefined {\n    return this.get('subfeatures')\n  }\n\n  public toJSON(): SimpleFeatureSerialized {\n    const d = { ...this.data, uniqueId: this.id() } as SimpleFeatureSerialized\n    const p = this.parent()\n    if (p) {\n      d.parentId = p.id()\n    }\n    const c = this.children()\n    if (c) {\n      d.subfeatures = c.map(child => child.toJSON())\n    }\n    return d\n  }\n\n  public static fromJSON(json: SimpleFeatureSerialized) {\n    return new SimpleFeature({ ...json })\n  }\n}\n","// This file is a ponyfill for the HTML5 OffscreenCanvas API.\n\nimport { CanvasSequence } from 'canvas-sequencer-ts'\nimport isNode from 'detect-node'\n\n// Re-export transferable utilities for convenience\nexport { collectTransferables, isDetachedBuffer } from './transferables.ts'\n\nexport function isImageBitmap(value: unknown): value is ImageBitmap {\n  return typeof ImageBitmap !== 'undefined' && value instanceof ImageBitmap\n}\n\nexport function drawImageOntoCanvasContext(\n  imageData: any,\n  context: CanvasRenderingContext2D,\n) {\n  if (imageData.serializedCommands) {\n    const seq = new CanvasSequence(imageData.serializedCommands)\n    seq.execute(context)\n  } else {\n    context.drawImage(imageData as CanvasImageSource, 0, 0)\n  }\n}\n\nexport function createCanvas(width: number, height: number) {\n  if (typeof OffscreenCanvas === 'function') {\n    return new OffscreenCanvas(width, height)\n  } else if (isNode) {\n    // @ts-expect-error\n    return nodeCreateCanvas(width, height)\n  } else {\n    const context = new CanvasSequence()\n    return {\n      width,\n      height,\n      getContext() {\n        return context\n      },\n    }\n  }\n}\n\nexport async function createImageBitmap(canvas: any) {\n  if (typeof OffscreenCanvas === 'function') {\n    return (canvas as OffscreenCanvas).transferToImageBitmap()\n  } else if (isNode) {\n    const dataUri = canvas.toDataURL()\n    // @ts-expect-error\n    const img = new nodeImage()\n    return new Promise((resolve, reject) => {\n      img.onload = () => {\n        resolve(img)\n      }\n      img.onerror = reject\n      img.src = dataUri\n    })\n  } else {\n    const ctx = canvas.getContext('2d')\n    return {\n      height: canvas.height,\n      width: canvas.width,\n      serializedCommands: ctx.toJSON(),\n    }\n  }\n}\n","export interface ParsedLocString {\n  assemblyName?: string\n  refName: string\n  start?: number\n  end?: number\n  reversed?: boolean\n}\n\n// matches coordinate strings: \"100\", \"100-200\", \"100..200\", \"100..\" (open-ended)\n// groups: [1]=start [2]=end (if range) [3]=trailing separator (if open-ended)\nconst COORD_REGEX = /^(-?\\d+)(?:(?:\\.\\.|[-])(-?\\d+))?(\\.\\.|[-])?$/\n\n// matches optional \"{assemblyName}\" prefix followed by the rest of the location\n// groups: [1]=assemblyName (without braces) [2]=remainder\nconst ASSEMBLY_REGEX = /^(?:\\{([^}]+)\\})?(.+)/\n\nfunction parseCoords(suffix: string, locString: string) {\n  // strip commas before matching so regex only needs to handle plain digits\n  const match = COORD_REGEX.exec(suffix.replaceAll(',', ''))\n  if (!match) {\n    throw new Error(\n      `could not parse range \"${suffix}\" on location \"${locString}\"`,\n    )\n  }\n  const [, startStr, endStr, trailing] = match\n  const start = +startStr!\n  return { start, end: endStr ? +endStr : trailing ? undefined : start }\n}\n\nexport function parseLocStringOneBased(\n  locString: string,\n  isValidRefName: (refName: string, assemblyName?: string) => boolean,\n): ParsedLocString {\n  if (!locString) {\n    throw new Error('no location string provided, could not parse')\n  }\n\n  // handle reverse strand notation e.g. \"chr1:1-100[rev]\"\n  let reversed = false\n  if (locString.endsWith('[rev]')) {\n    reversed = true\n    locString = locString.slice(0, -5)\n  }\n  locString = locString.replaceAll(/\\s/g, '')\n\n  // extract optional assembly name in braces e.g. \"{hg19}chr1:1-100\"\n  const assemblyMatch = ASSEMBLY_REGEX.exec(locString)\n  if (!assemblyMatch) {\n    throw new Error(`invalid location string: \"${locString}\"`)\n  }\n\n  const [, assemblyName, location] = assemblyMatch\n  // reject empty braces e.g. \"{}chr1:1-100\"\n  if (!assemblyName && location!.startsWith('{}')) {\n    throw new Error(`no assembly name was provided in location \"${location}\"`)\n  }\n\n  // refNames can contain colons (see SAM spec), so find the last colon to split\n  const lastColonIdx = location!.lastIndexOf(':')\n  // no colon means just a refName with no coordinates e.g. \"chr1\"\n  if (lastColonIdx === -1) {\n    if (isValidRefName(location!, assemblyName)) {\n      return { assemblyName, refName: location!, reversed }\n    }\n    throw new Error(`Unknown feature or sequence \"${location}\"`)\n  }\n\n  // split into refName (prefix) and coordinate part (suffix) at the last colon\n  const prefix = location!.slice(0, lastColonIdx)\n  const suffix = location!.slice(lastColonIdx + 1)\n  const prefixValid = isValidRefName(prefix, assemblyName)\n  const locationValid = isValidRefName(location!, assemblyName)\n\n  // both interpretations valid is ambiguous e.g. refName \"chr1:1\" and \"chr1\" both exist\n  if (prefixValid && locationValid) {\n    throw new Error(`ambiguous location string: \"${locString}\"`)\n  }\n  // the colon is part of the refName, not a coordinate separator\n  if (locationValid) {\n    return { assemblyName, refName: location!, reversed }\n  }\n  // standard case: prefix is refName, suffix is coordinates\n  if (prefixValid) {\n    // colon with no suffix means just refName e.g. \"chr1:\"\n    if (!suffix) {\n      return { assemblyName, refName: prefix, reversed }\n    }\n    const coords = parseCoords(suffix, locString)\n    return { assemblyName, refName: prefix, reversed, ...coords }\n  }\n  throw new Error(`unknown reference sequence name in location \"${locString}\"`)\n}\n\nexport function parseLocString(\n  locString: string,\n  isValidRefName: (refName: string, assemblyName?: string) => boolean,\n) {\n  const parsed = parseLocStringOneBased(locString, isValidRefName)\n  if (typeof parsed.start === 'number') {\n    parsed.start -= 1\n  }\n  return parsed\n}\n","type Func<T> = (value: BaseBlock, index: number, array: BaseBlock[]) => T\n\nexport class BlockSet {\n  blocks: BaseBlock[]\n\n  constructor(blocks: BaseBlock[] = []) {\n    this.blocks = blocks\n  }\n\n  *[Symbol.iterator]() {\n    yield* this.blocks\n  }\n\n  push(block: BaseBlock) {\n    if (block.type === 'ElidedBlock' && this.blocks.length > 0) {\n      const lastBlock = this.blocks.at(-1)\n      if (lastBlock?.type === 'ElidedBlock') {\n        ;(lastBlock as ElidedBlock).push(block as ElidedBlock)\n        return\n      }\n    }\n\n    this.blocks.push(block)\n  }\n\n  getBlocks() {\n    return this.blocks\n  }\n\n  getRegions() {\n    return this.blocks.map(block => block.toRegion())\n  }\n\n  map<T, U = this>(func: Func<T>, thisarg?: U) {\n    // eslint-disable-next-line unicorn/no-array-method-this-argument\n    return this.blocks.map(func, thisarg)\n  }\n\n  forEach<T, U = this>(func: Func<T>, thisarg?: U) {\n    // eslint-disable-next-line unicorn/no-array-method-this-argument,unicorn/no-array-for-each\n    this.blocks.forEach(func, thisarg)\n  }\n\n  get length() {\n    return this.blocks.length\n  }\n\n  get totalWidthPx() {\n    let total = 0\n    for (let i = 0, l = this.blocks.length; i < l; i++) {\n      total += this.blocks[i]!.widthPx\n    }\n\n    return total\n  }\n\n  get totalWidthPxWithoutBorders() {\n    let total = 0\n    for (let i = 0, l = this.blocks.length; i < l; i++) {\n      if (this.blocks[i]!.variant !== 'boundary') {\n        total += this.blocks[i]!.widthPx\n      }\n    }\n\n    return total\n  }\n\n  get offsetPx() {\n    return this.blocks.length > 0 ? this.blocks[0]!.offsetPx : 0\n  }\n\n  get contentBlocks() {\n    return this.blocks.filter(block => block.type === 'ContentBlock')\n  }\n\n  get totalBp() {\n    let total = 0\n    for (let i = 0, l = this.contentBlocks.length; i < l; i++) {\n      const b = this.contentBlocks[i]!\n      total += b.end - b.start\n    }\n    return total\n  }\n}\n\nexport class BaseBlock {\n  type = 'BaseBlock'\n\n  public regionNumber?: number\n\n  public reversed?: boolean\n\n  public refName: string\n\n  public start: number\n\n  public end: number\n\n  public assemblyName: string\n\n  public key: string\n\n  public offsetPx: number\n\n  public widthPx = 0\n\n  public variant?: string\n\n  public isLeftEndOfDisplayedRegion?: boolean\n\n  /**\n   * a block that should be shown as filled with data\n   */\n\n  constructor(data: Record<string, any>) {\n    Object.assign(this, data)\n    this.assemblyName = data.assemblyName\n    this.refName = data.refName\n    this.start = data.start\n    this.end = data.end\n    this.key = data.key\n    this.offsetPx = data.offsetPx\n  }\n\n  toRegion() {\n    return {\n      refName: this.refName,\n      start: this.start,\n      end: this.end,\n      assemblyName: this.assemblyName,\n      reversed: this.reversed,\n    }\n  }\n}\n\nexport class ContentBlock extends BaseBlock {\n  type = 'ContentBlock'\n}\n\n/**\n * marker block representing one or more blocks that are\n * too small to be shown at the current zoom level\n */\nexport class ElidedBlock extends BaseBlock {\n  type = 'ElidedBlock'\n\n  public widthPx: number\n\n  public elidedBlockCount = 0\n\n  constructor(data: Record<string, any>) {\n    super(data)\n    this.widthPx = data.widthPx\n  }\n\n  push(otherBlock: ElidedBlock) {\n    this.elidedBlockCount += 1\n    this.refName = ''\n    this.start = 0\n    this.end = 0\n    this.widthPx += otherBlock.widthPx\n  }\n}\n\n/**\n * marker block that sits between two different displayed regions\n * and provides a thick border between them\n */\nexport class InterRegionPaddingBlock extends BaseBlock {\n  type = 'InterRegionPaddingBlock'\n}\n","export interface Row {\n  id: string\n  metadata?: Record<string, unknown>\n  [key: string]: unknown\n}\n\nexport function getRowStr(facet: string, row: Row) {\n  return `${\n    (facet.startsWith('metadata.')\n      ? row.metadata?.[facet.replace('metadata.', '')]\n      : row[facet]) || ''\n  }`\n}\n","import { TextField } from '@mui/material'\n\nimport type {\n  AutocompleteRenderInputParams,\n  TextFieldProps as TFP,\n} from '@mui/material'\n\nexport default function AutocompleteTextField({\n  TextFieldProps,\n  inputBoxVal,\n  params,\n  setInputValue,\n  setCurrentSearch,\n}: {\n  TextFieldProps: TFP\n  inputBoxVal: string\n  params: AutocompleteRenderInputParams\n  setInputValue: (arg: string) => void\n  setCurrentSearch: (arg: string) => void\n}) {\n  const { helperText, slotProps = {} } = TextFieldProps\n  const { ref: inputRef, ...restInputProps } = params.InputProps\n  const { InputProps: _InputProps, ...restParams } = params\n  return (\n    <TextField\n      onBlur={() => {\n        // this is used to restore a refName or the non-user-typed input to the\n        // box on blurring\n        setInputValue(inputBoxVal)\n      }}\n      {...restParams}\n      {...TextFieldProps}\n      inputRef={inputRef}\n      size=\"small\"\n      helperText={helperText}\n      slotProps={{\n        input: {\n          ...restInputProps,\n          // eslint-disable-next-line @typescript-eslint/no-misused-spread\n          ...slotProps.input,\n        },\n      }}\n      placeholder=\"Search for location\"\n      onChange={e => {\n        setCurrentSearch(e.target.value)\n      }}\n    />\n  )\n}\n","import { useEffect, useMemo, useState } from 'react'\n\nimport BaseResult, {\n  RefSequenceResult,\n} from '@jbrowse/core/TextSearch/BaseResults'\nimport { getSession, measureText, useDebounce } from '@jbrowse/core/util'\nimport { Autocomplete } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport AutocompleteTextField from './AutocompleteTextField.tsx'\nimport { getDeduplicatedResult, getFiltered } from './util.ts'\n\nimport type { Option } from './util.ts'\nimport type { LinearGenomeViewModel } from '../../model.ts'\nimport type { TextFieldProps as TFP } from '@mui/material'\n\nconst RefNameAutocomplete = observer(function RefNameAutocomplete({\n  model,\n  onSelect,\n  assemblyName,\n  style,\n  fetchResults,\n  onChange,\n  value,\n  minWidth = 200,\n  maxWidth = 550,\n  TextFieldProps = {},\n}: {\n  model: LinearGenomeViewModel\n  onSelect?: (region: BaseResult) => void\n  onChange?: (val: string) => void\n  assemblyName?: string\n  value?: string\n  fetchResults: (query: string) => Promise<BaseResult[]>\n  style?: React.CSSProperties\n  minWidth?: number\n  maxWidth?: number\n  TextFieldProps?: TFP\n}) {\n  const session = getSession(model)\n  const { assemblyManager } = session\n  const [open, setOpen] = useState(false)\n  const [loaded, setLoaded] = useState(true)\n  const [currentSearch, setCurrentSearch] = useState('')\n  const [inputValue, setInputValue] = useState('')\n  const [searchOptions, setSearchOptions] = useState<Option[]>()\n  const debouncedSearch = useDebounce(currentSearch, 50)\n  const assembly = assemblyName ? assemblyManager.get(assemblyName) : undefined\n  const { coarseVisibleLocStrings, hasDisplayedRegions } = model\n\n  // this callback runs an async search. the typescript code claims that\n  useEffect(() => {\n    const isCurrent = { cancelled: false }\n    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n    ;(async () => {\n      try {\n        if (debouncedSearch === '' || !assemblyName) {\n          return\n        }\n\n        setLoaded(false)\n        const results = await fetchResults(debouncedSearch)\n\n        if (!isCurrent.cancelled) {\n          setSearchOptions(getDeduplicatedResult(results))\n        }\n      } catch (e) {\n        console.error(e)\n        if (!isCurrent.cancelled) {\n          session.notifyError(`${e}`, e)\n        }\n      } finally {\n        if (!isCurrent.cancelled) {\n          setLoaded(true)\n        }\n      }\n    })()\n\n    return () => {\n      isCurrent.cancelled = true\n    }\n  }, [assemblyName, fetchResults, debouncedSearch, session])\n  const inputBoxVal = coarseVisibleLocStrings || value || ''\n\n  const regions = assembly?.regions\n  const regionOptions = useMemo(\n    () =>\n      regions?.map(region => ({\n        result: new RefSequenceResult({\n          refName: region.refName,\n          label: region.refName,\n          displayString: region.refName,\n          matchedAttribute: 'refName',\n        }),\n      })) || [],\n    [regions],\n  )\n\n  // notes on implementation:\n  // The selectOnFocus setting helps highlight the field when clicked\n  return (\n    <Autocomplete\n      data-testid=\"autocomplete\"\n      disableListWrap\n      disableClearable\n      disabled={!assemblyName}\n      freeSolo\n      includeInputInList\n      selectOnFocus\n      style={{\n        ...style,\n        width: Math.min(\n          Math.max(measureText(inputBoxVal, 14) + 100, minWidth),\n          maxWidth,\n        ),\n      }}\n      value={inputBoxVal}\n      loading={!loaded}\n      inputValue={inputValue}\n      onInputChange={(_event, newInputValue) => {\n        setInputValue(newInputValue)\n        onChange?.(newInputValue)\n      }}\n      loadingText=\"loading results\"\n      open={open}\n      onOpen={() => {\n        setOpen(true)\n      }}\n      onClose={() => {\n        setOpen(false)\n        setLoaded(true)\n        if (hasDisplayedRegions) {\n          setCurrentSearch('')\n          setSearchOptions(undefined)\n        }\n      }}\n      onChange={(_event, selectedOption) => {\n        if (!selectedOption || !assemblyName) {\n          return\n        }\n\n        if (typeof selectedOption === 'string') {\n          // handles string inputs on keyPress enter\n          onSelect?.(\n            new BaseResult({\n              label: selectedOption,\n            }),\n          )\n        } else {\n          onSelect?.(selectedOption.result)\n        }\n        setInputValue(inputBoxVal)\n      }}\n      options={searchOptions?.length ? searchOptions : regionOptions}\n      getOptionDisabled={option => option.group === 'limitOption'}\n      filterOptions={(opts, { inputValue }) => getFiltered(opts, inputValue)}\n      renderInput={params => (\n        <AutocompleteTextField\n          params={params}\n          inputBoxVal={inputBoxVal}\n          TextFieldProps={TextFieldProps}\n          setCurrentSearch={setCurrentSearch}\n          setInputValue={setInputValue}\n        />\n      )}\n      getOptionLabel={opt =>\n        typeof opt === 'string' ? opt : opt.result.getDisplayString()\n      }\n    />\n  )\n})\n\nexport default RefNameAutocomplete\n","import BaseResult from '@jbrowse/core/TextSearch/BaseResults'\n\nexport interface Option {\n  group?: string\n  result: BaseResult\n}\n\nfunction filterOptions(options: Option[], searchQuery: string) {\n  return options.filter(\n    ({ result }) =>\n      result.getLabel().toLowerCase().includes(searchQuery) ||\n      result.matchedObject,\n  )\n}\n\n// the logic of this method is to only apply a filter to RefSequenceResults\n// because they do not have a matchedObject. the trix search results already\nexport function getFiltered(opts: Option[], inputValue: string) {\n  const filtered = filterOptions(opts, inputValue.toLocaleLowerCase())\n  return [\n    ...filtered.slice(0, 100),\n    ...(filtered.length > 100\n      ? [\n          {\n            group: 'limitOption',\n            result: new BaseResult({\n              label: 'keep typing for more results',\n            }),\n          },\n        ]\n      : []),\n  ]\n}\n\nexport function aggregateResults(results: BaseResult[]) {\n  const m: Record<string, BaseResult[]> = {}\n\n  for (const result of results) {\n    const displayString = result.getDisplayString()\n    if (!m[displayString]) {\n      m[displayString] = []\n    }\n    m[displayString].push(result)\n  }\n  return m\n}\n\nexport function getDeduplicatedResult(results: BaseResult[]) {\n  return Object.entries(aggregateResults(results)).map(\n    ([displayString, results]) =>\n      results.length === 1\n        ? {\n            result: results[0]!,\n          }\n        : {\n            // deduplicate a \"multi-result\"\n            result: new BaseResult({\n              displayString,\n              results,\n              label: displayString,\n            }),\n          },\n  )\n}\n","// Shared types for callback-based mismatch iteration\n// Each adapter implements forEachMismatch using its optimal internal structure\n\nexport const MISMATCH_TYPE = 0\nexport const INSERTION_TYPE = 1\nexport const DELETION_TYPE = 2\nexport const SKIP_TYPE = 3\nexport const SOFTCLIP_TYPE = 4\nexport const HARDCLIP_TYPE = 5\n\n// Bitmask for interbase types (insertion, softclip, hardclip)\n// These are events that occur between reference positions rather than at a position\n// Computed as: (1 << INSERTION_TYPE) | (1 << SOFTCLIP_TYPE) | (1 << HARDCLIP_TYPE)\n// = (1 << 1) | (1 << 4) | (1 << 5) = 2 | 16 | 32 = 50\nexport const INTERBASE_MASK = 0b110010\n\n// Bitmask for deletion/skip types (deletion, skip)\n// These consume reference positions but not sequence positions\n// (1 << DELETION_TYPE) | (1 << SKIP_TYPE) = (1 << 2) | (1 << 3) = 4 | 8 = 12\nexport const DELSKIP_MASK = 0b1100\n\nexport const MISMATCH_MAP = [\n  'mismatch',\n  'insertion',\n  'deletion',\n  'skip',\n  'softclip',\n  'hardclip',\n] as const\n\nexport const MISMATCH_REV_MAP = {\n  mismatch: 0,\n  insertion: 1,\n  deletion: 2,\n  skip: 3,\n  softclip: 4,\n  hardclip: 5,\n} as const\n\nexport type MismatchCallback = (\n  type: number,\n  start: number,\n  length: number,\n  base: string,\n  qual: number | undefined,\n  altbase: number | undefined,\n  cliplen: number | undefined,\n) => void\n","import type PluginManager from './PluginManager.ts'\nimport type { AnyConfigurationSchemaType } from './configuration/index.ts'\n\n/**\n * base class for a JBrowse plugin\n */\nexport default abstract class Plugin {\n  abstract name: string\n\n  url?: string\n\n  version?: string\n\n  install(_pluginManager: PluginManager): void {}\n\n  configure(_pluginManager: PluginManager): void {}\n\n  // this is put into configuration.YourPluginName.configSlot\n  configurationSchema?: AnyConfigurationSchemaType\n\n  // this is put into configuration.configSlot\n  configurationSchemaUnnamespaced?: AnyConfigurationSchemaType\n\n  // this is spread into the root config, just configSlot\n  rootConfigurationSchema?: (\n    arg: PluginManager,\n  ) => Record<string, AnyConfigurationSchemaType>\n}\n\nexport type PluginConstructor = new (...args: unknown[]) => Plugin\n","import { getSnapshot, isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport {\n  ConfigurationSchema,\n  readConfObject,\n} from '../../configuration/index.ts'\nimport idMaker from '../../util/idMaker.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\nimport type { AugmentedRegion as Region } from '../../util/types/index.ts'\nimport type { getSubAdapterType } from '../dataAdapterCache.ts'\n\nconst EmptyConfig = ConfigurationSchema('empty', {})\n\nexport class BaseAdapter {\n  public id: string\n\n  public sequenceAdapterConfig?: Record<string, unknown>\n\n  static capabilities = [] as string[]\n\n  constructor(\n    public config: AnyConfigurationModel = EmptyConfig.create(),\n    public getSubAdapter?: getSubAdapterType,\n    public pluginManager?: PluginManager,\n  ) {\n    // note: we use switch on jest here for more simple feature IDs\n    // in test environment\n    if (typeof jest === 'undefined') {\n      const data = isStateTreeNode(config) ? getSnapshot(config) : config\n      this.id = `${idMaker(data)}`\n    } else {\n      this.id = 'test'\n    }\n  }\n\n  /**\n   * Sets the sequence adapter configuration for adapters that need reference\n   * sequence data (e.g., CRAM adapters). Wrapper adapters like SNPCoverageAdapter\n   * can override this to propagate to their subadapters.\n   */\n  setSequenceAdapterConfig(config: Record<string, unknown>) {\n    this.sequenceAdapterConfig = config\n  }\n\n  /**\n   * Same as `readConfObject(this.config, arg)`.\n   * Note: Does not offer the same TS type checking as `readConfObject`,\n   * consider using that instead.\n   */\n  getConf(arg: string | string[]) {\n    return readConfObject(this.config, arg)\n  }\n\n  /**\n   * Called to provide a hint that data tied to a certain region will not be\n   * needed for the foreseeable future and can be purged from caches, etc\n   * @param region - Region\n   */\n  freeResources(_region: Region) {}\n}\n","export const HEADER_BAR_HEIGHT = 48\nexport const HEADER_OVERVIEW_HEIGHT = 20\nexport const SCALE_BAR_HEIGHT = 17\nexport const RESIZE_HANDLE_HEIGHT = 3\nexport const INTER_REGION_PADDING_WIDTH = 2\nexport const SPACING = 7\nexport const WIDGET_HEIGHT = 32\n","export default class FlatQueue<T> {\n  ids: T[] = []\n  values: number[] = []\n  length = 0\n\n  clear() {\n    this.length = 0\n  }\n\n  push(item: T, priority: number) {\n    let pos = this.length++\n\n    while (pos > 0) {\n      const parent = (pos - 1) >> 1\n      const parentValue = this.values[parent]!\n      if (priority >= parentValue) {\n        break\n      }\n      this.ids[pos] = this.ids[parent]!\n      this.values[pos] = parentValue\n      pos = parent\n    }\n\n    this.ids[pos] = item\n    this.values[pos] = priority\n  }\n\n  pop() {\n    if (this.length === 0) {\n      return undefined\n    }\n\n    const ids = this.ids\n    const values = this.values\n    const top = ids[0]\n    const last = --this.length\n\n    if (last > 0) {\n      const id = ids[last]!\n      const value = values[last]!\n      let pos = 0\n      const halfLen = last >> 1\n\n      while (pos < halfLen) {\n        const left = (pos << 1) + 1\n        const right = left + 1\n        const child =\n          left + (+(right < last) & +(values[right]! < values[left]!))\n        if (values[child]! >= value) {\n          break\n        }\n        ids[pos] = ids[child]!\n        values[pos] = values[child]!\n        pos = child\n      }\n\n      ids[pos] = id\n      values[pos] = value\n    }\n\n    return top\n  }\n\n  peek() {\n    return this.length > 0 ? this.ids[0] : undefined\n  }\n\n  peekValue() {\n    return this.length > 0 ? this.values[0] : undefined\n  }\n\n  shrink() {\n    this.ids.length = this.values.length = this.length\n  }\n}\n","// adapted from https://github.com/mourner/flatbush (ISC) by Colin Diesh\n//\n// changes to the code include:\n// non-recursive sort implementation\nimport FlatQueue from '../flatqueue/index.ts'\n\ntype TypedArrayConstructor =\n  | Int8ArrayConstructor\n  | Uint8ArrayConstructor\n  | Uint8ClampedArrayConstructor\n  | Int16ArrayConstructor\n  | Uint16ArrayConstructor\n  | Int32ArrayConstructor\n  | Uint32ArrayConstructor\n  | Float32ArrayConstructor\n  | Float64ArrayConstructor\n\ntype TypedArray =\n  | Int8Array\n  | Uint8Array\n  | Uint8ClampedArray\n  | Int16Array\n  | Uint16Array\n  | Int32Array\n  | Uint32Array\n  | Float32Array\n  | Float64Array\n\ntype IndexArray = Uint16Array | Uint32Array\n\nconst ARRAY_TYPES: TypedArrayConstructor[] = [\n  Int8Array,\n  Uint8Array,\n  Uint8ClampedArray,\n  Int16Array,\n  Uint16Array,\n  Int32Array,\n  Uint32Array,\n  Float32Array,\n  Float64Array,\n]\nconst VERSION = 3 // serialized format version\n\nexport default class Flatbush {\n  numItems: number\n  nodeSize: number\n  byteOffset: number\n  ArrayType: TypedArrayConstructor\n  IndexArrayType: Uint16ArrayConstructor | Uint32ArrayConstructor\n  data: ArrayBufferLike\n  minX: number\n  minY: number\n  maxX: number\n  maxY: number\n  private _levelBounds: number[]\n  private _boxes: TypedArray\n  private _indices: IndexArray\n  private _pos: number\n  private _queue: FlatQueue<number>\n\n  /**\n   * Recreate a Flatbush index from raw `ArrayBuffer` or `SharedArrayBuffer` data.\n   */\n  static from(data: ArrayBufferLike, byteOffset = 0): Flatbush {\n    if (byteOffset % 8 !== 0) {\n      throw new Error('byteOffset must be 8-byte aligned.')\n    }\n\n    // Check for detached ArrayBuffer (happens if buffer was transferred)\n    if (data.byteLength === 0) {\n      throw new Error(\n        'Flatbush data buffer is detached (byteLength=0). ' +\n          'This usually means the buffer was transferred and is no longer usable.',\n      )\n    }\n\n    const [magic, versionAndType] = new Uint8Array(data, byteOffset + 0, 2)\n    if (magic !== 0xfb) {\n      throw new Error('Data does not appear to be in a Flatbush format.')\n    }\n    const version = versionAndType! >> 4\n    if (version !== VERSION) {\n      throw new Error(`Got v${version} data when expected v${VERSION}.`)\n    }\n    const ArrayType = ARRAY_TYPES[versionAndType! & 0x0f]\n    if (!ArrayType) {\n      throw new Error('Unrecognized array type.')\n    }\n    const [nodeSize] = new Uint16Array(data, byteOffset + 2, 1)\n    const [numItems] = new Uint32Array(data, byteOffset + 4, 1)\n\n    return new Flatbush(\n      numItems!,\n      nodeSize,\n      ArrayType,\n      undefined,\n      data,\n      byteOffset,\n    )\n  }\n\n  /**\n   * Create a Flatbush index that will hold a given number of items.\n   */\n  constructor(\n    numItems: number,\n    nodeSize = 16,\n    ArrayType: TypedArrayConstructor = Float64Array,\n    ArrayBufferType:\n      | ArrayBufferConstructor\n      | SharedArrayBufferConstructor = ArrayBuffer,\n    data?: ArrayBufferLike,\n    byteOffset = 0,\n  ) {\n    if (isNaN(numItems) || numItems <= 0) {\n      throw new Error(`Unexpected numItems value: ${numItems}.`)\n    }\n\n    this.numItems = +numItems\n    this.nodeSize = Math.min(Math.max(+nodeSize, 2), 65535)\n    this.byteOffset = byteOffset\n\n    // calculate the total number of nodes in the R-tree to allocate space for\n    // and the index of each tree level (used in search later)\n    let n = numItems\n    let numNodes = n\n    this._levelBounds = [n * 4]\n    do {\n      n = Math.ceil(n / this.nodeSize)\n      numNodes += n\n      this._levelBounds.push(numNodes * 4)\n    } while (n !== 1)\n\n    this.ArrayType = ArrayType\n    this.IndexArrayType = numNodes < 16384 ? Uint16Array : Uint32Array\n\n    const arrayTypeIndex = ARRAY_TYPES.indexOf(ArrayType)\n    const nodesByteSize = numNodes * 4 * ArrayType.BYTES_PER_ELEMENT\n\n    if (arrayTypeIndex === -1) {\n      throw new Error(`Unexpected typed array class: ${ArrayType}.`)\n    }\n\n    if (data) {\n      this.data = data\n      this._boxes = new ArrayType(\n        data as ArrayBuffer,\n        byteOffset + 8,\n        numNodes * 4,\n      ) as TypedArray\n      this._indices = new this.IndexArrayType(\n        data as ArrayBuffer,\n        byteOffset + 8 + nodesByteSize,\n        numNodes,\n      )\n\n      this._pos = numNodes * 4\n      this.minX = this._boxes[this._pos - 4]!\n      this.minY = this._boxes[this._pos - 3]!\n      this.maxX = this._boxes[this._pos - 2]!\n      this.maxY = this._boxes[this._pos - 1]!\n    } else {\n      const newData = (this.data = new ArrayBufferType(\n        8 + nodesByteSize + numNodes * this.IndexArrayType.BYTES_PER_ELEMENT,\n      ))\n      this._boxes = new ArrayType(\n        newData as ArrayBuffer,\n        8,\n        numNodes * 4,\n      ) as TypedArray\n      this._indices = new this.IndexArrayType(\n        newData as ArrayBuffer,\n        8 + nodesByteSize,\n        numNodes,\n      )\n      this._pos = 0\n      this.minX = Infinity\n      this.minY = Infinity\n      this.maxX = -Infinity\n      this.maxY = -Infinity\n\n      new Uint8Array(newData, 0, 2).set([0xfb, (VERSION << 4) + arrayTypeIndex])\n      new Uint16Array(newData, 2, 1)[0] = nodeSize\n      new Uint32Array(newData, 4, 1)[0] = numItems\n    }\n\n    // a priority queue for k-nearest-neighbors queries\n    this._queue = new FlatQueue()\n  }\n\n  /**\n   * Add a given rectangle to the index.\n   * @returns A zero-based, incremental number that represents the newly added rectangle.\n   */\n  add(minX: number, minY: number, maxX = minX, maxY = minY): number {\n    const index = this._pos >> 2\n    const boxes = this._boxes\n    this._indices[index] = index\n    boxes[this._pos++] = minX\n    boxes[this._pos++] = minY\n    boxes[this._pos++] = maxX\n    boxes[this._pos++] = maxY\n\n    if (minX < this.minX) {\n      this.minX = minX\n    }\n    if (minY < this.minY) {\n      this.minY = minY\n    }\n    if (maxX > this.maxX) {\n      this.maxX = maxX\n    }\n    if (maxY > this.maxY) {\n      this.maxY = maxY\n    }\n\n    return index\n  }\n\n  /** Perform indexing of the added rectangles. */\n  finish(): void {\n    if (this._pos >> 2 !== this.numItems) {\n      throw new Error(\n        `Added ${this._pos >> 2} items when expected ${this.numItems}.`,\n      )\n    }\n    const boxes = this._boxes\n\n    if (this.numItems <= this.nodeSize) {\n      // only one node, skip sorting and just fill the root box\n      boxes[this._pos++] = this.minX\n      boxes[this._pos++] = this.minY\n      boxes[this._pos++] = this.maxX\n      boxes[this._pos++] = this.maxY\n      return\n    }\n\n    const width = this.maxX - this.minX || 1\n    const height = this.maxY - this.minY || 1\n    const hilbertValues = new Uint32Array(this.numItems)\n    const hilbertMax = (1 << 16) - 1\n\n    const scaleX = hilbertMax / width\n    const scaleY = hilbertMax / height\n    const offsetX = this.minX\n    const offsetY = this.minY\n\n    for (let i = 0, pos = 0; i < this.numItems; i++) {\n      const minX = boxes[pos++]!\n      const minY = boxes[pos++]!\n      const maxX = boxes[pos++]!\n      const maxY = boxes[pos++]!\n      const x = Math.floor(((minX + maxX) * 0.5 - offsetX) * scaleX)\n      const y = Math.floor(((minY + maxY) * 0.5 - offsetY) * scaleY)\n      hilbertValues[i] = hilbert(x, y)\n    }\n\n    // sort items by their Hilbert value (for packing later)\n    sort(\n      hilbertValues,\n      boxes,\n      this._indices,\n      0,\n      this.numItems - 1,\n      this.nodeSize,\n    )\n\n    // generate nodes at each tree level, bottom-up\n    for (let i = 0, pos = 0; i < this._levelBounds.length - 1; i++) {\n      const end = this._levelBounds[i]!\n\n      // generate a parent node for each block of consecutive <nodeSize> nodes\n      while (pos < end) {\n        const nodeIndex = pos\n\n        let nodeMinX = boxes[pos++]!\n        let nodeMinY = boxes[pos++]!\n        let nodeMaxX = boxes[pos++]!\n        let nodeMaxY = boxes[pos++]!\n        for (let j = 1; j < this.nodeSize && pos < end; j++) {\n          const x0 = boxes[pos++]!\n          const y0 = boxes[pos++]!\n          const x1 = boxes[pos++]!\n          const y1 = boxes[pos++]!\n          if (x0 < nodeMinX) {\n            nodeMinX = x0\n          }\n          if (y0 < nodeMinY) {\n            nodeMinY = y0\n          }\n          if (x1 > nodeMaxX) {\n            nodeMaxX = x1\n          }\n          if (y1 > nodeMaxY) {\n            nodeMaxY = y1\n          }\n        }\n\n        // add the new node to the tree data\n        this._indices[this._pos >> 2] = nodeIndex\n        boxes[this._pos++] = nodeMinX\n        boxes[this._pos++] = nodeMinY\n        boxes[this._pos++] = nodeMaxX\n        boxes[this._pos++] = nodeMaxY\n      }\n    }\n  }\n\n  /**\n   * Search the index by a bounding box.\n   * @param filterFn An optional function that is called on every found item; if supplied, only items for which this function returns true will be included in the results array.\n   * @returns An array of indices of items intersecting or touching the given bounding box.\n   */\n  search(\n    minX: number,\n    minY: number,\n    maxX: number,\n    maxY: number,\n    filterFn?: (\n      index: number,\n      x0: number,\n      y0: number,\n      x1: number,\n      y1: number,\n    ) => boolean,\n  ): number[] {\n    if (this._pos !== this._boxes.length) {\n      throw new Error('Data not yet indexed - call index.finish().')\n    }\n\n    let nodeIndex: number | undefined = this._boxes.length - 4\n    const queue: number[] = []\n    const results: number[] = []\n\n    while (nodeIndex !== undefined) {\n      // find the end index of the node\n      const end = Math.min(\n        nodeIndex + this.nodeSize * 4,\n        upperBound(nodeIndex, this._levelBounds),\n      )\n\n      // search through child nodes\n      for (let pos = nodeIndex; pos < end; pos += 4) {\n        // check if node bbox intersects with query bbox\n        const x0 = this._boxes[pos]!\n        if (maxX < x0) {\n          continue\n        }\n        const y0 = this._boxes[pos + 1]!\n        if (maxY < y0) {\n          continue\n        }\n        const x1 = this._boxes[pos + 2]!\n        if (minX > x1) {\n          continue\n        }\n        const y1 = this._boxes[pos + 3]!\n        if (minY > y1) {\n          continue\n        }\n\n        const index = this._indices[pos >> 2]! | 0\n\n        if (nodeIndex >= this.numItems * 4) {\n          queue.push(index) // node; add it to the search queue\n        } else if (filterFn === undefined || filterFn(index, x0, y0, x1, y1)) {\n          results.push(index) // leaf item\n        }\n      }\n\n      nodeIndex = queue.pop()\n    }\n\n    return results\n  }\n\n  /**\n   * Search items in order of distance from the given point.\n   * @param filterFn An optional function for filtering the results.\n   * @returns An array of indices of items found.\n   */\n  neighbors(\n    x: number,\n    y: number,\n    maxResults = Infinity,\n    maxDistance = Infinity,\n    filterFn?: (index: number) => boolean,\n  ): number[] {\n    if (this._pos !== this._boxes.length) {\n      throw new Error('Data not yet indexed - call index.finish().')\n    }\n\n    let nodeIndex: number | undefined = this._boxes.length - 4\n    const q = this._queue\n    const results: number[] = []\n    const maxDistSquared = maxDistance * maxDistance\n\n    outer: while (nodeIndex !== undefined) {\n      // find the end index of the node\n      const end = Math.min(\n        nodeIndex + this.nodeSize * 4,\n        upperBound(nodeIndex, this._levelBounds),\n      )\n\n      // add child nodes to the queue\n      for (let pos = nodeIndex; pos < end; pos += 4) {\n        const index = this._indices[pos >> 2]! | 0\n        const minX = this._boxes[pos]!\n        const minY = this._boxes[pos + 1]!\n        const maxX = this._boxes[pos + 2]!\n        const maxY = this._boxes[pos + 3]!\n        const dx = x < minX ? minX - x : x > maxX ? x - maxX : 0\n        const dy = y < minY ? minY - y : y > maxY ? y - maxY : 0\n        const dist = dx * dx + dy * dy\n        if (dist > maxDistSquared) {\n          continue\n        }\n\n        if (nodeIndex >= this.numItems * 4) {\n          q.push(index << 1, dist) // node (use even id)\n        } else if (filterFn === undefined || filterFn(index)) {\n          q.push((index << 1) + 1, dist) // leaf item (use odd id)\n        }\n      }\n\n      // pop items from the queue\n      while (q.length && q.peek()! & 1) {\n        const dist = q.peekValue()!\n        if (dist > maxDistSquared) {\n          break outer\n        }\n        results.push(q.pop()! >> 1)\n        if (results.length === maxResults) {\n          break outer\n        }\n      }\n\n      nodeIndex = q.length ? q.pop()! >> 1 : undefined\n    }\n\n    q.clear()\n    return results\n  }\n}\n\n/**\n * Binary search for the first value in the array bigger than the given.\n */\nfunction upperBound(value: number, arr: number[]): number {\n  let i = 0\n  let j = arr.length - 1\n  while (i < j) {\n    const m = (i + j) >> 1\n    if (arr[m]! > value) {\n      j = m\n    } else {\n      i = m + 1\n    }\n  }\n  return arr[i]!\n}\n\n/**\n * Custom quicksort that partially sorts bbox data alongside the hilbert values.\n */\nfunction sort(\n  values: Uint32Array,\n  boxes: TypedArray,\n  indices: IndexArray,\n  left: number,\n  right: number,\n  nodeSize: number,\n): void {\n  const stack: number[] = [left, right]\n\n  while (stack.length > 0) {\n    const r = stack.pop()!\n    const l = stack.pop()!\n\n    if (Math.floor(l / nodeSize) >= Math.floor(r / nodeSize)) {\n      continue\n    }\n\n    if (r - l < 10) {\n      insertionSort(values, boxes, indices, l, r)\n      continue\n    }\n\n    const start = values[l]!\n    const mid = values[(l + r) >> 1]!\n    const end = values[r]!\n\n    let pivot = end\n\n    const x = Math.max(start, mid)\n    if (end > x) {\n      pivot = x\n    } else if (x === start) {\n      pivot = Math.max(mid, end)\n    } else if (x === mid) {\n      pivot = Math.max(start, end)\n    }\n\n    let i = l - 1\n    let j = r + 1\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    while (true) {\n      do {\n        i++\n      } while (values[i]! < pivot)\n      do {\n        j--\n      } while (values[j]! > pivot)\n      if (i >= j) {\n        break\n      }\n      swap(values, boxes, indices, i, j)\n    }\n\n    stack.push(l, j, j + 1, r)\n  }\n}\n\nfunction insertionSort(\n  values: Uint32Array,\n  boxes: TypedArray,\n  indices: IndexArray,\n  left: number,\n  right: number,\n): void {\n  for (let i = left + 1; i <= right; i++) {\n    const tempVal = values[i]!\n    const tempIdx = indices[i]!\n    const k = i * 4\n    const tempA = boxes[k]!\n    const tempB = boxes[k + 1]!\n    const tempC = boxes[k + 2]!\n    const tempD = boxes[k + 3]!\n\n    let j = i - 1\n    while (j >= left && values[j]! > tempVal) {\n      values[j + 1] = values[j]!\n      indices[j + 1] = indices[j]!\n      const src = j * 4\n      const dst = (j + 1) * 4\n      boxes[dst] = boxes[src]!\n      boxes[dst + 1] = boxes[src + 1]!\n      boxes[dst + 2] = boxes[src + 2]!\n      boxes[dst + 3] = boxes[src + 3]!\n      j--\n    }\n\n    values[j + 1] = tempVal\n    indices[j + 1] = tempIdx\n    const dst = (j + 1) * 4\n    boxes[dst] = tempA\n    boxes[dst + 1] = tempB\n    boxes[dst + 2] = tempC\n    boxes[dst + 3] = tempD\n  }\n}\n\n/**\n * Swap two values and two corresponding boxes.\n */\nfunction swap(\n  values: Uint32Array,\n  boxes: TypedArray,\n  indices: IndexArray,\n  i: number,\n  j: number,\n): void {\n  const temp = values[i]!\n  values[i] = values[j]!\n  values[j] = temp\n\n  const k = 4 * i\n  const m = 4 * j\n\n  const a = boxes[k]!\n  const b = boxes[k + 1]!\n  const c = boxes[k + 2]!\n  const d = boxes[k + 3]!\n  boxes[k] = boxes[m]!\n  boxes[k + 1] = boxes[m + 1]!\n  boxes[k + 2] = boxes[m + 2]!\n  boxes[k + 3] = boxes[m + 3]!\n  boxes[m] = a\n  boxes[m + 1] = b\n  boxes[m + 2] = c\n  boxes[m + 3] = d\n\n  const e = indices[i]!\n  indices[i] = indices[j]!\n  indices[j] = e\n}\n\n/**\n * Fast Hilbert curve algorithm by http://threadlocalmutex.com/\n * Ported from C++ https://github.com/rawrunprotected/hilbert_curves (public domain)\n */\nfunction hilbert(x: number, y: number): number {\n  let a = x ^ y\n  let b = 0xffff ^ a\n  let c = 0xffff ^ (x | y)\n  let d = x & (y ^ 0xffff)\n\n  let A = a | (b >> 1)\n  let B = (a >> 1) ^ a\n  let C = (c >> 1) ^ (b & (d >> 1)) ^ c\n  let D = (a & (c >> 1)) ^ (d >> 1) ^ d\n\n  a = A\n  b = B\n  c = C\n  d = D\n  A = (a & (a >> 2)) ^ (b & (b >> 2))\n  B = (a & (b >> 2)) ^ (b & ((a ^ b) >> 2))\n  C ^= (a & (c >> 2)) ^ (b & (d >> 2))\n  D ^= (b & (c >> 2)) ^ ((a ^ b) & (d >> 2))\n\n  a = A\n  b = B\n  c = C\n  d = D\n  A = (a & (a >> 4)) ^ (b & (b >> 4))\n  B = (a & (b >> 4)) ^ (b & ((a ^ b) >> 4))\n  C ^= (a & (c >> 4)) ^ (b & (d >> 4))\n  D ^= (b & (c >> 4)) ^ ((a ^ b) & (d >> 4))\n\n  a = A\n  b = B\n  c = C\n  d = D\n  C ^= (a & (c >> 8)) ^ (b & (d >> 8))\n  D ^= (b & (c >> 8)) ^ ((a ^ b) & (d >> 8))\n\n  a = C ^ (C >> 1)\n  b = D ^ (D >> 1)\n\n  let i0 = x ^ y\n  let i1 = b | (0xffff ^ (i0 | a))\n\n  i0 = (i0 | (i0 << 8)) & 0x00ff00ff\n  i0 = (i0 | (i0 << 4)) & 0x0f0f0f0f\n  i0 = (i0 | (i0 << 2)) & 0x33333333\n  i0 = (i0 | (i0 << 1)) & 0x55555555\n\n  i1 = (i1 | (i1 << 8)) & 0x00ff00ff\n  i1 = (i1 | (i1 << 4)) & 0x0f0f0f0f\n  i1 = (i1 | (i1 << 2)) & 0x33333333\n  i1 = (i1 | (i1 << 1)) & 0x55555555\n\n  return ((i1 << 1) | i0) >>> 0\n}\n","// takes an array or Map or Set (anything iterable with values()) of Maps and\n// lets you query them as one Map\nexport default class CompositeMap<T, U> {\n  constructor(private submaps: Map<T, U>[]) {}\n\n  has(id: T) {\n    for (const submap of this.submaps.values()) {\n      if (submap.has(id)) {\n        return true\n      }\n    }\n    return false\n  }\n\n  get(id: T) {\n    for (const submap of this.submaps.values()) {\n      if (submap.has(id)) {\n        return submap.get(id)\n      }\n    }\n    return undefined\n  }\n\n  *values() {\n    for (const key of this.keys()) {\n      yield this.get(key) as U\n    }\n  }\n\n  *keys() {\n    const keys = new Set<T>()\n    for (const submap of this.submaps.values()) {\n      for (const key of submap.keys()) {\n        keys.add(key)\n      }\n    }\n    for (const key of keys) {\n      yield key\n    }\n  }\n\n  find<V>(f: (arg0: U) => V) {\n    for (const submap of this.submaps.values()) {\n      for (const value of submap.values()) {\n        const found = f(value)\n        if (found) {\n          return value\n        }\n      }\n    }\n    return undefined\n  }\n\n  *[Symbol.iterator]() {\n    for (const key of this.keys()) {\n      yield [key, this.get(key)] as const\n    }\n  }\n\n  *entries() {\n    for (const k of this.keys()) {\n      yield [k, this.get(k)] as const\n    }\n  }\n}\n","import type React from 'react'\nimport { lazy } from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isFeature,\n  isSelectionContainer,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport CompositeMap from '@jbrowse/core/util/compositeMap'\nimport {\n  getParentRenderProps,\n  getRpcSessionId,\n} from '@jbrowse/core/util/tracks'\nimport { addDisposer, flow, isAlive, types } from '@jbrowse/mobx-state-tree'\nimport CenterFocusStrongIcon from '@mui/icons-material/CenterFocusStrong'\nimport CloseFullscreenIcon from '@mui/icons-material/CloseFullscreen'\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy'\nimport MenuOpenIcon from '@mui/icons-material/MenuOpen'\nimport { autorun } from 'mobx'\n\nimport { deduplicateFeatureLabels } from './components/util.ts'\nimport { calculateSvgLegendWidth } from './index.ts'\nimport FeatureDensityMixin from './models/FeatureDensityMixin.tsx'\nimport TrackHeightMixin from './models/TrackHeightMixin.tsx'\nimport configSchema from './models/configSchema.ts'\nimport BlockState from './models/serverSideRenderedBlock.ts'\nimport {\n  fetchFeatureByIdRpc,\n  findSubfeatureById,\n  getTranscripts,\n  hasIntrons,\n} from './util.ts'\n\nimport type { LinearGenomeViewModel } from '../LinearGenomeView/index.ts'\nimport type { LegendItem } from './components/FloatingLegend.tsx'\nimport type { ExportSvgDisplayOptions, LayoutRecord } from './types.ts'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { AnyReactComponentType, Feature } from '@jbrowse/core/util'\nimport type { BaseBlock } from '@jbrowse/core/util/blockTypes'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { Theme } from '@mui/material'\n\n// lazies\nconst Tooltip = lazy(() => import('./components/Tooltip.tsx'))\nconst CollapseIntronsDialog = lazy(\n  () => import('./components/CollapseIntronsDialog/CollapseIntronsDialog.tsx'),\n)\n\ntype LGV = LinearGenomeViewModel\n\n/**\n * #stateModel BaseLinearDisplay\n * #category display\n *\n * BaseLinearDisplay is used as the basis for many linear genome view tracks.\n * It is block based, and can use 'static blocks' or 'dynamic blocks'\n *\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [TrackHeightMixin](../trackheightmixin)\n * - [FeatureDensityMixin](../featuredensitymixin)\n */\nfunction stateModelFactory() {\n  return types\n    .compose(\n      'BaseLinearDisplay',\n      BaseDisplay,\n      TrackHeightMixin(),\n      FeatureDensityMixin(),\n      types.model({\n        /**\n         * #property\n         * updated via autorun\n         */\n        blockState: types.map(BlockState),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        showLegend: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        showTooltips: types.maybe(types.boolean),\n      }),\n    )\n    .volatile(() => ({\n      mouseoverExtraInformation: undefined as string | undefined,\n      /**\n       * #volatile\n       */\n      featureIdUnderMouse: undefined as undefined | string,\n      /**\n       * #volatile\n       */\n      subfeatureIdUnderMouse: undefined as undefined | string,\n      /**\n       * #volatile\n       */\n      contextMenuFeature: undefined as undefined | Feature,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * if a display-level message should be displayed instead of the blocks,\n       * make this return a react component\n       */\n      get DisplayMessageComponent(): undefined | React.FC<any> {\n        return undefined\n      },\n      /**\n       * #getter\n       */\n      get blockType(): 'staticBlocks' | 'dynamicBlocks' {\n        return 'staticBlocks'\n      },\n      /**\n       * #getter\n       */\n      get blockDefinitions() {\n        const view = getContainingView(self) as LGV\n        if (!view.initialized) {\n          throw new Error('view not initialized yet')\n        }\n        return view[this.blockType]\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * how many milliseconds to wait for the display to\n       * \"settle\" before re-rendering a block\n       */\n      get renderDelay() {\n        return 50\n      },\n\n      /**\n       * #getter\n       */\n      get TooltipComponent(): AnyReactComponentType {\n        return Tooltip as AnyReactComponentType\n      },\n\n      /**\n       * #method\n       * Override in subclasses to provide legend items for the display\n       * @param _theme - MUI theme for accessing palette colors\n       */\n      legendItems(_theme?: Theme): LegendItem[] {\n        return []\n      },\n\n      /**\n       * #method\n       * Returns the width needed for the SVG legend if showLegend is enabled.\n       * Used by SVG export to add extra width for the legend area.\n       * @param theme - MUI theme for accessing palette colors\n       */\n      svgLegendWidth(theme?: Theme): number {\n        return self.showLegend\n          ? calculateSvgLegendWidth(this.legendItems(theme))\n          : 0\n      },\n\n      /**\n       * #getter\n       * returns a string feature ID if the globally-selected object\n       * is probably a feature\n       */\n      get selectedFeatureId() {\n        if (isAlive(self)) {\n          const { selection } = getSession(self)\n          if (isFeature(selection)) {\n            return selection.id()\n          }\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       * Override in subclasses to use a different feature widget\n       */\n      get featureWidgetType() {\n        return {\n          type: 'BaseFeatureWidget',\n          id: 'baseFeature',\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * whether to show tooltips on mouseover, defaults to true\n       */\n      get showTooltipsEnabled() {\n        return self.showTooltips ?? true\n      },\n\n      /**\n       * #getter\n       * a CompositeMap of `featureId -> feature obj` that\n       * just looks in all the block data for that feature\n       */\n      get features() {\n        const featureMaps = []\n        for (const block of self.blockState.values()) {\n          if (block.features) {\n            featureMaps.push(block.features)\n          }\n        }\n        return new CompositeMap(featureMaps)\n      },\n\n      /**\n       * #getter\n       */\n      get featureUnderMouse() {\n        const feat = self.featureIdUnderMouse\n        return feat ? this.features.get(feat) : undefined\n      },\n\n      /**\n       * #method\n       * Finds a feature by ID, checking both top-level features and\n       * subfeatures if parentFeatureId is provided\n       */\n      getFeatureById(featureId: string, parentFeatureId?: string) {\n        const feature = this.features.get(featureId)\n        if (feature) {\n          return feature\n        }\n        if (parentFeatureId) {\n          const parent = this.features.get(parentFeatureId)\n          if (parent) {\n            return findSubfeatureById(parent, featureId)\n          }\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       */\n      get layoutFeatures() {\n        const featureMaps = []\n        for (const block of self.blockState.values()) {\n          if (block.layout?.getRectangles) {\n            // Use getRectangles() to get consistent tuple format [left, top, right, bottom, data]\n            // This works for both GranularRectLayout (raw) and PrecomputedLayout (serialized)\n            featureMaps.push(block.layout.getRectangles())\n          }\n        }\n        return new CompositeMap<string, LayoutRecord>(featureMaps)\n      },\n\n      /**\n       * #getter\n       */\n      getFeatureOverlapping(\n        blockKey: string,\n        x: number,\n        y: number,\n      ): string | undefined {\n        return self.blockState.get(blockKey)?.layout?.getByCoord(x, y)\n      },\n\n      /**\n       * #getter\n       */\n      getFeatureByID(blockKey: string, id: string): LayoutRecord | undefined {\n        return self.blockState.get(blockKey)?.layout?.getByID(id)\n      },\n\n      /**\n       * #getter\n       */\n      searchFeatureByID(id: string): LayoutRecord | undefined {\n        for (const block of self.blockState.values()) {\n          const val = block.layout?.getByID(id)\n          if (val) {\n            return val\n          }\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       * Deduplicated floating label data, computed and cached by MobX\n       */\n      get floatingLabelData() {\n        const view = getContainingView(self) as LGV\n        const { assemblyManager } = getSession(self)\n        const assemblyName = view.assemblyNames[0]\n        const assembly = assemblyName\n          ? assemblyManager.get(assemblyName)\n          : undefined\n        return deduplicateFeatureLabels(\n          this.layoutFeatures,\n          view,\n          assembly,\n          view.bpPerPx,\n        )\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      addBlock(key: string, block: BaseBlock) {\n        const blockInstance = BlockState.create({\n          key,\n          region: block.toRegion(),\n        })\n        // Set cached display BEFORE adding to map - afterAttach fires when\n        // the block is added, so cachedDisplay must be set first\n        blockInstance.setCachedDisplay(self)\n        self.blockState.set(key, blockInstance)\n      },\n\n      /**\n       * #action\n       */\n      deleteBlock(key: string) {\n        self.blockState.delete(key)\n      },\n      /**\n       * #action\n       */\n      selectFeature(feature: Feature) {\n        const session = getSession(self)\n        if (isSelectionContainer(session)) {\n          session.setSelection(feature)\n        }\n        if (isSessionModelWithWidgets(session)) {\n          const { rpcManager } = session\n          const sessionId = getRpcSessionId(self)\n          const track = getContainingTrack(self)\n          const view = getContainingView(self)\n          const adapterConfig = getConf(track, 'adapter')\n          const { type, id } = self.featureWidgetType\n          rpcManager\n            .call(sessionId, 'CoreGetMetadata', { adapterConfig })\n            .then(descriptions => {\n              if (isAlive(self)) {\n                session.showWidget(\n                  session.addWidget(type, id, {\n                    featureData: feature.toJSON(),\n                    view,\n                    track,\n                    descriptions,\n                  }),\n                )\n              }\n            })\n            .catch((e: unknown) => {\n              console.error(e)\n              getSession(self).notifyError(`${e}`, e)\n            })\n        }\n      },\n\n      /**\n       * #action\n       */\n      navToFeature(feature: Feature) {\n        const view = getContainingView(self) as LGV\n        view.navTo({\n          refName: feature.get('refName'),\n          start: feature.get('start'),\n          end: feature.get('end'),\n        })\n      },\n      /**\n       * #action\n       */\n      clearFeatureSelection() {\n        getSession(self).clearSelection()\n      },\n      /**\n       * #action\n       */\n      setFeatureIdUnderMouse(feature?: string) {\n        self.featureIdUnderMouse = feature\n      },\n\n      /**\n       * #action\n       */\n      setSubfeatureIdUnderMouse(subfeatureId?: string) {\n        self.subfeatureIdUnderMouse = subfeatureId\n      },\n\n      /**\n       * #action\n       */\n      setContextMenuFeature(feature?: Feature) {\n        self.contextMenuFeature = feature\n      },\n      /**\n       * #action\n       */\n      setMouseoverExtraInformation(extra?: string) {\n        self.mouseoverExtraInformation = extra\n      },\n      /**\n       * #action\n       */\n      setShowLegend(s: boolean) {\n        self.showLegend = s\n      },\n      /**\n       * #action\n       */\n      setShowTooltips(arg: boolean) {\n        self.showTooltips = arg\n      },\n    }))\n\n    .actions(self => {\n      const { reload: superReload } = self\n\n      return {\n        /**\n         * #action\n         */\n        async reload() {\n          self.setError()\n          self.setCurrStatsBpPerPx(0)\n          self.clearFeatureDensityStats()\n          for (const val of self.blockState.values()) {\n            val.doReload()\n          }\n          superReload()\n        },\n      }\n    })\n\n    .actions(self => ({\n      /**\n       * #action\n       * Select a feature by ID, looking up in features map and subfeatures.\n       * Falls back to RPC if not found locally (e.g., for canvas renderer).\n       * @param featureId - The ID of the feature to select\n       * @param parentFeatureId - The immediate parent's ID for subfeature lookup\n       * @param topLevelFeatureId - The top-level feature ID for RPC lookup\n       */\n      selectFeatureById: flow(function* (\n        featureId: string,\n        parentFeatureId?: string,\n        topLevelFeatureId?: string,\n      ) {\n        const feature = self.getFeatureById(featureId, parentFeatureId)\n        if (feature) {\n          self.selectFeature(feature)\n          return\n        }\n        const rpcParentId =\n          topLevelFeatureId && topLevelFeatureId !== featureId\n            ? topLevelFeatureId\n            : parentFeatureId\n        try {\n          const session = getSession(self)\n          const f = yield fetchFeatureByIdRpc({\n            rpcManager: session.rpcManager,\n            sessionId: getRpcSessionId(self),\n            trackId: getContainingTrack(self).id,\n            rendererType: self.rendererTypeName,\n            featureId,\n            parentFeatureId: rpcParentId,\n          })\n          if (f && isAlive(self)) {\n            self.selectFeature(f)\n          }\n        } catch (e) {\n          console.error(e)\n          getSession(self).notifyError(`${e}`, e)\n        }\n      }),\n      /**\n       * #action\n       * Set context menu feature by ID, looking up in features map and subfeatures.\n       * Falls back to RPC if not found locally (e.g., for canvas renderer).\n       * @param featureId - The ID of the feature to set\n       * @param parentFeatureId - The immediate parent's ID for subfeature lookup\n       * @param topLevelFeatureId - The top-level feature ID for RPC lookup\n       */\n      setContextMenuFeatureById: flow(function* (\n        featureId: string,\n        parentFeatureId?: string,\n        topLevelFeatureId?: string,\n      ) {\n        const feature = self.getFeatureById(featureId, parentFeatureId)\n        if (feature) {\n          self.setContextMenuFeature(feature)\n          return\n        }\n        const rpcParentId =\n          topLevelFeatureId && topLevelFeatureId !== featureId\n            ? topLevelFeatureId\n            : parentFeatureId\n        try {\n          const session = getSession(self)\n          const f = yield fetchFeatureByIdRpc({\n            rpcManager: session.rpcManager,\n            sessionId: getRpcSessionId(self),\n            trackId: getContainingTrack(self).id,\n            rendererType: self.rendererTypeName,\n            featureId,\n            parentFeatureId: rpcParentId,\n          })\n          if (f && isAlive(self)) {\n            self.setContextMenuFeature(f)\n          }\n        } catch (e) {\n          console.error(e)\n          getSession(self).notifyError(`${e}`, e)\n        }\n      }),\n    }))\n\n    .views(self => ({\n      /**\n       * #method\n       */\n      trackMenuItems(): MenuItem[] {\n        return []\n      },\n\n      /**\n       * #method\n       */\n      contextMenuItems(): MenuItem[] {\n        const feat = self.contextMenuFeature\n        const transcripts = getTranscripts(feat)\n\n        return feat\n          ? [\n              {\n                label: 'Open feature details',\n                icon: MenuOpenIcon,\n                onClick: () => {\n                  self.selectFeature(feat)\n                },\n              },\n              {\n                label: 'Zoom to feature',\n                icon: CenterFocusStrongIcon,\n                onClick: () => {\n                  self.navToFeature(feat)\n                },\n              },\n              {\n                label: 'Copy info to clipboard',\n                icon: ContentCopyIcon,\n                onClick: async () => {\n                  const { uniqueId, ...rest } = feat.toJSON()\n                  const session = getSession(self)\n                  const { default: copy } = await import('copy-to-clipboard')\n                  copy(JSON.stringify(rest, null, 4))\n                  session.notify('Copied to clipboard', 'success')\n                },\n              },\n              ...(hasIntrons(transcripts)\n                ? [\n                    {\n                      label: 'Collapse introns',\n                      icon: CloseFullscreenIcon,\n                      onClick: () => {\n                        const view = getContainingView(self) as LGV\n                        const { assemblyManager } = getSession(self)\n                        const assembly = assemblyManager.get(\n                          view.assemblyNames[0]!,\n                        )\n                        if (assembly) {\n                          getSession(self).queueDialog(handleClose => [\n                            CollapseIntronsDialog,\n                            {\n                              view,\n                              transcripts,\n                              handleClose,\n                              assembly,\n                            },\n                          ])\n                        }\n                      },\n                    },\n                  ]\n                : []),\n            ]\n          : []\n      },\n      /**\n       * #method\n       * props for the renderer's React \"Rendering\" component - client-side\n       * only, never sent to the worker. includes displayModel and callbacks\n       */\n      renderingProps() {\n        return {\n          displayModel: self,\n          // @deprecated - renderers should call displayModel methods directly\n          // e.g. displayModel.setFeatureIdUnderMouse(featureId)\n          onMouseMove(_: unknown, featureId?: string) {\n            self.setFeatureIdUnderMouse(featureId)\n          },\n          // @deprecated - renderers should call displayModel methods directly\n          // e.g. displayModel.setFeatureIdUnderMouse(undefined)\n          onMouseLeave(_: unknown) {\n            self.setFeatureIdUnderMouse(undefined)\n          },\n          // @deprecated - renderers should call displayModel methods directly\n          onContextMenu(_: unknown) {\n            self.setContextMenuFeature(undefined)\n            self.clearFeatureSelection()\n          },\n        }\n      },\n      /**\n       * #method\n       * props sent to the worker for server-side rendering\n       */\n      renderProps() {\n        return {\n          ...getParentRenderProps(self),\n          notReady: !self.featureDensityStatsReady,\n          rpcDriverName: self.effectiveRpcDriverName,\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #method\n       */\n      async renderSvg(opts: ExportSvgDisplayOptions) {\n        const { renderBaseLinearDisplaySvg } = await import('./renderSvg.tsx')\n        return renderBaseLinearDisplaySvg(self as BaseLinearDisplayModel, opts)\n      },\n      afterAttach() {\n        // watch the parent's blocks to update our block state when they\n        // change, then we recreate the blocks on our own model (creating and\n        // deleting to match the parent blocks)\n        addDisposer(\n          self,\n          autorun(\n            function blockDefinitionsAutorun() {\n              try {\n                if (!isAlive(self) || self.isMinimized) {\n                  return\n                }\n                const view = getContainingView(self) as LGV\n                if (!view.initialized) {\n                  return\n                }\n                const contentBlocks = self.blockDefinitions.contentBlocks\n                const newKeys = new Set(contentBlocks.map(b => b.key))\n\n                // Add new blocks\n                for (const block of contentBlocks) {\n                  if (!self.blockState.has(block.key)) {\n                    self.addBlock(block.key, block)\n                  }\n                }\n\n                // Remove old blocks\n                for (const key of self.blockState.keys()) {\n                  if (!newKeys.has(key)) {\n                    self.deleteBlock(key)\n                  }\n                }\n              } catch (e) {\n                // catch errors that may occur during test cleanup or when\n                // the display is not properly attached to a view\n              }\n            },\n            {\n              name: 'BaseLinearDisplayBlockDefinitions',\n              delay: 60,\n            },\n          ),\n        )\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      // rewrite \"height\" from older snapshots to \"heightPreConfig\", this allows\n      // us to maintain a height \"getter\" going forward\n      // @ts-expect-error\n      const { height, ...rest } = snap\n      return { heightPreConfig: height, ...rest }\n    })\n    .postProcessSnapshot(snap => {\n      // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n      const r = snap as Omit<typeof snap, symbol>\n      const { blockState, ...rest } = r\n      return rest\n    })\n}\n\nexport const BaseLinearDisplay = stateModelFactory()\n\nexport type BaseLinearDisplayStateModel = typeof BaseLinearDisplay\nexport type BaseLinearDisplayModel = Instance<BaseLinearDisplayStateModel>\n\nexport { type LegendItem } from './components/FloatingLegend.tsx'\n","import { addDisposer, isAlive } from '@jbrowse/mobx-state-tree'\nimport { reaction } from 'mobx'\n\nimport { isAbortException } from './aborting.ts'\nimport { createStopToken, stopStopToken } from './stopToken.ts'\n\nimport type { StopToken } from './stopToken.ts'\nimport type { IReactionOptions, IReactionPublic } from 'mobx'\n\n/**\n * makes a mobx reaction with the given functions, that calls actions on the\n * model for each stage of execution, and to abort the reaction function when\n * the model is destroyed.\n *\n * Will call startedFunction(stopToken), successFunction(result), and\n * errorFunction(error) when the async reaction function starts, completes, and\n * errors respectively.\n *\n * @param self -\n * @param dataFunction -\n * @param asyncReactionFunction -\n * @param reactionOptions -\n * @param startedFunction -\n * @param successFunction -\n * @param errorFunction -\n */\nexport function makeAbortableReaction<T, U, V>(\n  self: T,\n  dataFunction: (arg: T) => U,\n  asyncReactionFunction: (\n    arg: U | undefined,\n    stopToken: StopToken,\n    model: T,\n    handle: IReactionPublic,\n  ) => Promise<V>,\n  // @ts-expect-error\n  reactionOptions: IReactionOptions,\n  startedFunction: (stopToken: StopToken) => void,\n  successFunction: (arg: V) => void,\n  errorFunction: (err: unknown) => void,\n) {\n  let inProgress: StopToken | undefined\n\n  function handleError(error: unknown) {\n    if (!isAbortException(error)) {\n      if (isAlive(self)) {\n        console.error(error)\n        errorFunction(error)\n      }\n    }\n  }\n\n  addDisposer(\n    self,\n    reaction(\n      () => {\n        try {\n          return dataFunction(self)\n        } catch (e) {\n          handleError(e)\n          return undefined\n        }\n      },\n      async (data, mobxReactionHandle) => {\n        if (inProgress) {\n          stopStopToken(inProgress)\n        }\n\n        if (!isAlive(self)) {\n          return\n        }\n        inProgress = createStopToken()\n\n        startedFunction(inProgress)\n        try {\n          const result = await asyncReactionFunction(\n            data,\n            inProgress,\n            self,\n            // @ts-expect-error\n            mobxReactionHandle,\n          )\n          if (isAlive(self)) {\n            successFunction(result)\n          }\n        } catch (e) {\n          handleError(e)\n        }\n      },\n      reactionOptions,\n    ),\n  )\n  addDisposer(self, () => {\n    if (inProgress) {\n      stopStopToken(inProgress)\n    }\n  })\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { AnyAdapter } from '../data_adapters/BaseAdapter/index.ts'\n\nexport interface AdapterMetadata {\n  category?: string\n  hiddenFromGUI?: boolean\n  description?: string\n}\n\nexport default class AdapterType extends PluggableElementBase {\n  getAdapterClass: () => Promise<AnyAdapter>\n\n  configSchema: AnyConfigurationSchemaType\n\n  adapterCapabilities: string[]\n\n  adapterMetadata?: AdapterMetadata\n\n  constructor(\n    stuff: {\n      name: string\n      configSchema: AnyConfigurationSchemaType\n      displayName?: string\n      adapterCapabilities?: string[]\n      adapterMetadata?: AdapterMetadata\n    } & (\n      | {\n          AdapterClass: AnyAdapter\n        }\n      | {\n          getAdapterClass: () => Promise<AnyAdapter>\n        }\n    ),\n  ) {\n    super(stuff)\n    this.getAdapterClass =\n      'AdapterClass' in stuff\n        ? async () => stuff.AdapterClass\n        : stuff.getAdapterClass\n    this.configSchema = stuff.configSchema\n    this.adapterCapabilities = stuff.adapterCapabilities || []\n    this.adapterMetadata = stuff.adapterMetadata\n  }\n}\n","export interface ModificationData {\n  color: string\n  name: string\n}\n\n// Adapted from IGV\n// https://github.com/igvteam/igv/blob/af07c3b1be8806cfd77343ee04982aeff17d2beb/src/main/resources/org/broad/igv/prefs/preferences.tab#L230-L242\nexport const modificationData: Record<string, ModificationData> = {\n  m: { color: 'rgb(255,0,0)', name: '5mC' },\n  h: { color: 'rgb(255,0,255)', name: '5hmC' },\n  o: { color: 'rgb(111, 78, 129)', name: '8oxoG' },\n  f: { color: 'rgb(246, 200, 95)', name: '5fC' },\n  c: { color: 'rgb(157, 216, 102)', name: '5cac' },\n  g: { color: 'rgb(255, 160, 86)', name: '5hmu' },\n  e: { color: 'rgb(141, 221, 208)', name: '5fU' },\n  b: { color: 'rgb(0,100,47)', name: '5caU' },\n  a: { color: 'rgb(51,0,111)', name: '6mA' },\n  17082: { color: 'rgb(51,153,255)', name: 'pseU' },\n  17596: { color: 'rgb(102,153,0)', name: 'inosine' },\n  21839: { color: 'rgb(153,0,153)', name: '4mC' },\n}\n\nexport function getModificationName(type: string): string {\n  return modificationData[type]?.name || type\n}\n","type Hasher<T> = (input: T) => string\n\n// from https://github.com/seriousManual/dedupe/blob/master/LICENSE\nexport function dedupe<T>(list: T[], hasher: Hasher<T> = JSON.stringify) {\n  const clone: T[] = []\n  const lookup = new Set<string>()\n\n  for (const entry of list) {\n    const hashed = hasher(entry)\n\n    if (!lookup.has(hashed)) {\n      clone.push(entry)\n      lookup.add(hashed)\n    }\n  }\n\n  return clone\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/index.ts'\nimport type { AnyReactComponentType } from '../util/index.ts'\nimport type { IAnyModelType } from '@jbrowse/mobx-state-tree'\n\nexport default class DisplayType extends PluggableElementBase {\n  stateModel: IAnyModelType\n\n  configSchema: AnyConfigurationSchemaType\n\n  ReactComponent: AnyReactComponentType\n\n  /**\n   * The track type the display is associated with\n   */\n  trackType: string\n\n  /*\n   * Indicates that this display type can be a \"sub-display\" of another type of\n   * display, e.g. in AlignmentsDisplay, has Pileup and SNPCoverage subDisplays\n   */\n  subDisplay?: {\n    type: string\n    [key: string]: unknown\n  }\n\n  /**\n   * The view type the display is associated with\n   */\n  viewType: string\n\n  /**\n   * Help text describing the display type\n   */\n  helpText?: string\n\n  constructor(stuff: {\n    name: string\n    stateModel: IAnyModelType\n    trackType: string\n    viewType: string\n    displayName?: string\n    subDisplay?: { type: string; [key: string]: unknown }\n    configSchema: AnyConfigurationSchemaType\n    ReactComponent: AnyReactComponentType\n    helpText?: string\n  }) {\n    super(stuff)\n    this.stateModel = stuff.stateModel\n    this.subDisplay = stuff.subDisplay\n    this.configSchema = stuff.configSchema\n    this.ReactComponent = stuff.ReactComponent\n    this.trackType = stuff.trackType\n    this.viewType = stuff.viewType\n    this.helpText = stuff.helpText\n  }\n}\n","import type React from 'react'\n\nimport { getParent, types } from '@jbrowse/mobx-state-tree'\n\nimport { getConf } from '../../configuration/index.ts'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getEnv,\n} from '../../util/index.ts'\nimport { getParentRenderProps } from '../../util/tracks.ts'\nimport { ElementId } from '../../util/types/mst.ts'\n\nimport type { MenuItem } from '../../ui/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel BaseDisplay\n * #category display\n */\nfunction stateModelFactory() {\n  return types\n    .model('BaseDisplay', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.string,\n      /**\n       * #property\n       */\n      rpcDriverName: types.maybe(types.string),\n    })\n    .volatile(() => ({\n      rendererTypeName: '',\n      error: undefined as unknown,\n      statusMessage: undefined as string | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get RenderingComponent(): React.FC<{\n        model: typeof self\n        onHorizontalScroll?: () => void\n        blockState?: Record<string, any>\n      }> {\n        const { pluginManager } = getEnv(self)\n        return pluginManager.getDisplayType(self.type)!\n          .ReactComponent as React.FC<{\n          model: typeof self\n          onHorizontalScroll?: () => void\n          blockState?: Record<string, any>\n        }>\n      },\n\n      /**\n       * #getter\n       */\n      get DisplayBlurb(): React.FC<{ model: typeof self }> | null {\n        return null\n      },\n\n      /**\n       * #getter\n       */\n      get adapterConfig() {\n        return getConf(this.parentTrack, 'adapter')\n      },\n\n      /**\n       * #getter\n       */\n      get parentTrack() {\n        return getContainingTrack(self)\n      },\n\n      /**\n       * #getter\n       * Returns true if the parent track is minimized. Used to skip\n       * expensive operations like autoruns when track is not visible.\n       */\n      get isMinimized() {\n        return this.parentTrack.minimized\n      },\n\n      /**\n       * #getter\n       * Returns the parent display if this display is nested within another display\n       * (e.g., PileupDisplay inside LinearAlignmentsDisplay)\n       */\n      get parentDisplay() {\n        try {\n          const parent = getParent<any>(self)\n          // Check if immediate parent looks like a display\n          // (has type property ending with 'Display')\n          const parentType = parent?.type\n          if (\n            typeof parentType === 'string' &&\n            parentType.endsWith('Display')\n          ) {\n            return parent\n          }\n        } catch {\n          // Ignore errors walking up tree\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       * Returns the effective RPC driver name with hierarchical fallback:\n       * 1. This display's explicit rpcDriverName\n       * 2. Parent display's effectiveRpcDriverName (for nested displays)\n       * 3. Track config's rpcDriverName\n       */\n      get effectiveRpcDriverName() {\n        if (self.rpcDriverName) {\n          return self.rpcDriverName\n        }\n        if (this.parentDisplay?.effectiveRpcDriverName) {\n          return this.parentDisplay.effectiveRpcDriverName\n        }\n        try {\n          return getConf(this.parentTrack, 'rpcDriverName') || undefined\n        } catch {\n          return undefined\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * the react props that are passed to the Renderer when data\n       * is rendered in this display. these are serialized and sent to the\n       * worker for server-side rendering\n       */\n      renderProps() {\n        return {\n          ...getParentRenderProps(self),\n          notReady: self.isMinimized || getContainingView(self).minimized,\n          rpcDriverName: self.effectiveRpcDriverName,\n        }\n      },\n      /**\n       * #method\n       * props passed to the renderer's React \"Rendering\" component.\n       * these are client-side only and never sent to the worker.\n       * includes displayModel and callbacks\n       */\n      renderingProps() {\n        return {\n          displayModel: self,\n        }\n      },\n\n      /**\n       * #getter\n       * the pluggable element type object for this display's renderer\n       */\n      get rendererType() {\n        const { pluginManager } = getEnv(self)\n        return pluginManager.getRendererType(self.rendererTypeName)!\n      },\n\n      /**\n       * #getter\n       * if a display-level message should be displayed instead, make this\n       * return a react component\n       */\n      get DisplayMessageComponent() {\n        return undefined as undefined | React.FC<any>\n      },\n      /**\n       * #method\n       */\n      trackMenuItems(): MenuItem[] {\n        return []\n      },\n\n      /**\n       * #getter\n       */\n      get viewMenuActions(): MenuItem[] {\n        return []\n      },\n      /**\n       * #method\n       * @param region -\n       * @returns falsy if the region is fine to try rendering. Otherwise,\n       * return a react node + string of text. string of text describes why it\n       * cannot be rendered react node allows user to force load at current\n       * setting\n       */\n      regionCannotBeRendered(/* region */) {\n        return null\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setStatusMessage(arg?: string) {\n        self.statusMessage = arg\n      },\n      /**\n       * #action\n       */\n      setError(error?: unknown) {\n        self.error = error\n      },\n      /**\n       * #action\n       */\n      setRpcDriverName(rpcDriverName: string) {\n        self.rpcDriverName = rpcDriverName\n      },\n      /**\n       * #action\n       * base display reload does nothing, see specialized displays for details\n       */\n      reload() {},\n    }))\n}\n\nexport const BaseDisplay = stateModelFactory()\nexport type BaseDisplayStateModel = typeof BaseDisplay\nexport type BaseDisplayModel = Instance<BaseDisplayStateModel>\n","import type { RpcResult } from './librpc.ts'\n\n/**\n * Type guard to check if a value is an RpcResult from librpc-web-mod.\n * Used to detect when a renderer has returned pre-serialized data with transferables.\n *\n * Note: Transferables flow only from worker to main thread (in responses),\n * not from main thread to worker. This is because the render results contain\n * ImageBitmaps and ArrayBuffers that benefit from zero-copy transfer.\n */\nexport function isRpcResult(value: unknown): value is RpcResult {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    '__rpcResult' in value &&\n    (value as RpcResult).__rpcResult\n  )\n}\n","import deepEqual from 'fast-deep-equal'\n\nimport { readConfObject } from '../../configuration/index.ts'\nimport GranularRectLayout from '../../util/layouts/GranularRectLayout.ts'\nimport MultiLayout from '../../util/layouts/MultiLayout.ts'\n\nimport type SerializableFilterChain from './util/serializableFilterChain.ts'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\nimport type { Region } from '../../util/index.ts'\nimport type { BaseLayout } from '../../util/layouts/index.ts'\n\nexport interface LayoutSessionProps {\n  regions: Region[]\n  config: AnyConfigurationModel\n  bpPerPx: number\n  filters?: SerializableFilterChain\n}\n\n// Generic type for any MultiLayout\nexport type BaseMultiLayout = MultiLayout<BaseLayout<unknown>, unknown>\n\n// Default type for GranularRectLayout (backwards compatibility)\nexport type MyMultiLayout = MultiLayout<GranularRectLayout<unknown>, unknown>\n\nexport interface CachedLayout {\n  layout: BaseMultiLayout\n  props: LayoutSessionProps\n}\n\n// Generic session interface that any layout session must implement\nexport interface LayoutSessionLike {\n  layout: BaseMultiLayout\n  update(props: LayoutSessionProps): LayoutSessionLike\n}\n\nexport class LayoutSession implements LayoutSessionLike {\n  props: LayoutSessionProps\n\n  cachedLayout: CachedLayout | undefined\n\n  constructor(props: LayoutSessionProps) {\n    this.props = props\n  }\n\n  update(props: LayoutSessionProps) {\n    this.props = props\n    return this\n  }\n\n  makeLayout() {\n    return new MultiLayout(GranularRectLayout, {\n      maxHeight: readConfObject(this.props.config, 'maxHeight'),\n      displayMode: readConfObject(this.props.config, 'displayMode'),\n      pitchX: this.props.bpPerPx,\n      pitchY: readConfObject(this.props.config, 'noSpacing') ? 1 : 3,\n    })\n  }\n\n  cachedLayoutIsValid(cachedLayout: CachedLayout) {\n    return (\n      cachedLayout.props.bpPerPx === this.props.bpPerPx &&\n      deepEqual(\n        readConfObject(this.props.config),\n        readConfObject(cachedLayout.props.config),\n      ) &&\n      deepEqual(this.props.filters, cachedLayout.props.filters)\n    )\n  }\n\n  get layout(): BaseMultiLayout {\n    if (!this.cachedLayout || !this.cachedLayoutIsValid(this.cachedLayout)) {\n      this.cachedLayout = {\n        layout: this.makeLayout(),\n        props: this.props,\n      }\n    }\n    return this.cachedLayout.layout\n  }\n}\n","import FeatureRendererType from './FeatureRendererType.ts'\nimport { LayoutSession } from './LayoutSession.ts'\nimport { expandRegion } from './util.ts'\nimport { readConfObject } from '../../configuration/index.ts'\nimport { getLayoutId } from '../../util/index.ts'\nimport PrecomputedLayout from '../../util/layouts/PrecomputedLayout.ts'\n\nimport type {\n  RenderArgs as FeatureRenderArgs,\n  RenderArgsDeserialized as FeatureRenderArgsDeserialized,\n  RenderArgsSerialized as FeatureRenderArgsSerialized,\n  RenderResults as FeatureRenderResults,\n  ResultsDeserialized as FeatureResultsDeserialized,\n  ResultsSerialized as FeatureResultsSerialized,\n} from './FeatureRendererType.ts'\nimport type { LayoutSessionLike, LayoutSessionProps } from './LayoutSession.ts'\nimport type { RenderReturn } from './RendererType.tsx'\nimport type RpcManager from '../../rpc/RpcManager.ts'\nimport type { Feature, Region } from '../../util/index.ts'\nimport type {\n  BaseLayout,\n  SerializedLayout,\n} from '../../util/layouts/BaseLayout.ts'\nexport interface RenderArgs extends FeatureRenderArgs {\n  bpPerPx: number\n  trackInstanceId: string\n}\n\nexport interface RenderArgsSerialized extends FeatureRenderArgsSerialized {\n  bpPerPx: number\n}\n\nexport interface RenderArgsDeserialized extends FeatureRenderArgsDeserialized {\n  statusCallback?: (arg: string) => void\n  bpPerPx: number\n  trackInstanceId: string\n}\n\nexport interface RenderResults extends FeatureRenderResults {\n  layout?: BaseLayout<Feature> | SerializedLayout\n}\n\nexport interface ResultsSerialized extends FeatureResultsSerialized {\n  maxHeightReached: boolean\n  layout: SerializedLayout\n}\n\nexport interface ResultsDeserialized extends FeatureResultsDeserialized {\n  maxHeightReached: boolean\n  layout: PrecomputedLayout<string>\n}\n\nexport default class BoxRendererType extends FeatureRendererType {\n  layoutSessions: Record<string, LayoutSessionLike> = {}\n\n  createLayoutSession(props: LayoutSessionProps): LayoutSessionLike {\n    return new LayoutSession(props)\n  }\n\n  getLayoutSession(props: { sessionId: string; trackInstanceId: string }) {\n    return this.layoutSessions[getLayoutId(props)]\n  }\n\n  getWorkerSession(\n    props: LayoutSessionProps & { sessionId: string; trackInstanceId: string },\n  ) {\n    const key = getLayoutId(props)\n    if (!this.layoutSessions[key]) {\n      this.layoutSessions[key] = this.createLayoutSession(props)\n    }\n    return this.layoutSessions[key].update(props)\n  }\n\n  getExpandedRegion(region: Region, renderArgs: RenderArgsDeserialized) {\n    const { bpPerPx, config } = renderArgs\n    const maxFeatureGlyphExpansion =\n      readConfObject(config, 'maxFeatureGlyphExpansion') || 0\n    const bpExpansion = Math.round(maxFeatureGlyphExpansion * bpPerPx)\n    return expandRegion(region, bpExpansion)\n  }\n\n  freeResources(args: RenderArgs) {\n    const key = getLayoutId(args)\n    const session = this.layoutSessions[key]\n    if (session) {\n      const region = args.regions[0]!\n      session.layout.discardRange(region.refName, region.start, region.end)\n    }\n  }\n\n  async freeResourcesInClient(rpcManager: RpcManager, args: RenderArgs) {\n    this.freeResources(args)\n    return super.freeResourcesInClient(rpcManager, args)\n  }\n\n  deserializeLayoutInClient(json: SerializedLayout) {\n    return new PrecomputedLayout(json)\n  }\n\n  deserializeResultsInClient(result: ResultsSerialized, args: RenderArgs) {\n    const layout = this.deserializeLayoutInClient(result.layout)\n    return super.deserializeResultsInClient(\n      {\n        ...result,\n        layout,\n      } as FeatureResultsSerialized,\n      args,\n    ) as ResultsDeserialized\n  }\n\n  createLayoutInWorker(args: RenderArgsDeserialized) {\n    const { regions } = args\n    const { layout } = this.getWorkerSession(args)\n    return layout.getSublayout(regions[0]!.refName)\n  }\n\n  serializeLayout(layout: BaseLayout<unknown>, args: RenderArgsDeserialized) {\n    const region = args.regions[0]!\n    return layout.serializeRegion(this.getExpandedRegion(region, args))\n  }\n\n  /**\n   * Default render method that fetches features and creates layout.\n   * Canvas-based renderers should override this and return rpcResult() directly.\n   */\n  async render(renderArgs: RenderArgsDeserialized): Promise<RenderReturn> {\n    const features = await this.getFeatures(renderArgs)\n    const layout = this.createLayoutInWorker(renderArgs)\n    return { features, layout }\n  }\n\n  serializeResultsInWorker(\n    results: RenderResults,\n    args: RenderArgsDeserialized,\n  ): ResultsSerialized {\n    const { features, ...rest } = super.serializeResultsInWorker(\n      results,\n      args,\n    ) as ResultsSerialized\n\n    const region = args.regions[0]!\n    const resultLayout = results.layout\n\n    // Live layouts (BaseLayout) have serializeRegion method, plain objects (SerializedLayout) don't\n    const layout =\n      resultLayout && 'serializeRegion' in resultLayout\n        ? resultLayout.serializeRegion(this.getExpandedRegion(region, args))\n        : (resultLayout as unknown as SerializedLayout)\n\n    return {\n      ...rest,\n      layout,\n      maxHeightReached: layout.maxHeightReached,\n      // Filter features to only those visible in the layout\n      features: features?.filter(f => !!layout.rectangles[f.uniqueId]),\n    }\n  }\n}\n","import {\n  Button,\n  DialogActions,\n  DialogContent,\n  DialogContentText,\n} from '@mui/material'\n\nimport Dialog from './Dialog.tsx'\n\nexport default function FactoryResetDialog({\n  onClose,\n  open,\n  onFactoryReset,\n}: {\n  onClose: () => void\n  open: boolean\n  onFactoryReset: () => void\n}) {\n  function handleDialogClose(action?: string) {\n    if (action === 'reset') {\n      onFactoryReset()\n    }\n    onClose()\n  }\n\n  return (\n    <Dialog\n      title=\"Reset\"\n      onClose={() => {\n        handleDialogClose()\n      }}\n      open={open}\n    >\n      <DialogContent>\n        <DialogContentText>\n          Are you sure you want to reset? This will restore the default\n          configuration.\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          onClick={() => {\n            handleDialogClose()\n          }}\n          color=\"primary\"\n        >\n          Cancel\n        </Button>\n        <Button\n          onClick={() => {\n            handleDialogClose('reset')\n          }}\n          color=\"primary\"\n          variant=\"contained\"\n        >\n          OK\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","import { useState } from 'react'\n\nimport {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n} from '@mui/material'\n\nimport ErrorMessage from './ErrorMessage.tsx'\nimport FactoryResetDialog from './FactoryResetDialog.tsx'\n\nconst ResetComponent = ({\n  onFactoryReset,\n  resetButtonText,\n}: {\n  onFactoryReset: () => void\n  resetButtonText: string\n}) => {\n  const [dialogOpen, setDialogOpen] = useState(false)\n\n  return (\n    <>\n      <Button\n        data-testid=\"fatal-error\"\n        color=\"primary\"\n        variant=\"contained\"\n        onClick={() => {\n          setDialogOpen(true)\n        }}\n      >\n        {resetButtonText}\n      </Button>\n      <FactoryResetDialog\n        onClose={() => {\n          setDialogOpen(false)\n        }}\n        open={dialogOpen}\n        onFactoryReset={onFactoryReset}\n      />\n    </>\n  )\n}\n\nexport default function FatalErrorDialog({\n  componentStack,\n  error = 'No error message provided',\n  onFactoryReset,\n  resetButtonText = 'Factory Reset',\n}: {\n  componentStack?: string\n  error?: unknown\n  onFactoryReset: () => void\n  resetButtonText?: string\n}) {\n  return (\n    <Dialog maxWidth=\"xl\" open>\n      <DialogTitle>Fatal error</DialogTitle>\n      <DialogContent>\n        <ErrorMessage error={error} />\n        <pre>{componentStack}</pre>\n      </DialogContent>\n      <DialogActions>\n        <Button\n          color=\"secondary\"\n          variant=\"contained\"\n          onClick={() => {\n            window.location.reload()\n          }}\n        >\n          Refresh\n        </Button>\n        <ResetComponent\n          onFactoryReset={onFactoryReset}\n          resetButtonText={resetButtonText}\n        />\n      </DialogActions>\n    </Dialog>\n  )\n}\n","import { getFillProps } from '@jbrowse/core/util'\nimport { observer } from 'mobx-react'\n\n// core\nimport { getCytobands } from './util.ts'\nimport { HEADER_OVERVIEW_HEIGHT } from '../consts.ts'\n\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { ContentBlock } from '@jbrowse/core/util/blockTypes'\n\n// rounded rect from https://stackoverflow.com/a/45889603/2129219\nfunction rightRoundedRect(\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius: number,\n) {\n  return `M${x},${y}h${width - radius}a${radius},${radius} 0 0 1 ${radius},${radius}v${height - 2 * radius}a${radius},${radius} 0 0 1 ${-radius},${radius}h${radius - width}z`\n}\n\nfunction leftRoundedRect(\n  x: number,\n  y: number,\n  width: number,\n  height: number,\n  radius: number,\n) {\n  return `M${x + radius},${y}h${width - radius}v${height}h${radius - width}a${radius},${radius} 0 0 1 ${-radius},${-radius}v${2 * radius - height}a${radius},${radius} 0 0 1 ${radius},${-radius}z`\n}\n\nfunction leftTriangle(x: number, _y: number, width: number, height: number) {\n  return [\n    [x, 0],\n    [x + width, height / 2],\n    [x, height],\n  ].toString()\n}\n\nfunction rightTriangle(x: number, _y: number, width: number, height: number) {\n  return [\n    [x, height / 2],\n    [x + width, 0],\n    [x + width, height],\n  ].toString()\n}\n\nconst colorMap: Record<string, string> = {\n  gneg: 'rgb(227,227,227)',\n  gpos25: 'rgb(142,142,142)',\n  gpos33: 'rgb(142,142,142)',\n  gpos50: 'rgb(85,85,85)',\n  gpos66: 'rgb(85,85,85)',\n  gpos100: 'rgb(0,0,0)',\n  gpos75: 'rgb(57,57,57)',\n  gvar: 'rgb(0,0,0)',\n  stalk: 'rgb(127,127,127)',\n  acen: '#800',\n}\n\nconst Cytobands = observer(function Cytobands({\n  overview,\n  block,\n  assembly,\n}: {\n  overview: Base1DViewModel\n  assembly?: Assembly\n  block: ContentBlock\n}) {\n  const { offsetPx, reversed } = block\n  const cytobands = getCytobands(assembly, block.refName)\n  const lcap = reversed ? cytobands.length - 1 : 0\n  const rcap = reversed ? 0 : cytobands.length - 1\n\n  const h = HEADER_OVERVIEW_HEIGHT\n  let centromereSeen = false\n  let curr = ''\n  let idx = 0\n  return (\n    <g transform={`translate(-${offsetPx})`}>\n      {cytobands.map((args, index) => {\n        const k = JSON.stringify(args)\n        const { refName, name, type, start, end } = args\n        const s = overview.bpToPx({ refName, coord: start }) || 0\n        const e = overview.bpToPx({ refName, coord: end }) || 0\n        const l = Math.min(s, e)\n        const w = Math.abs(e - s)\n        if (type === 'n/a') {\n          const match = name?.match(/^(\\d+)([A-Za-z])/)\n          const ret = match[1] + match[2]\n          if (ret && ret !== curr) {\n            curr = ret\n            idx++\n          }\n        }\n        const c =\n          type === 'n/a'\n            ? idx % 2\n              ? 'black'\n              : '#a77'\n            : colorMap[type] || 'black'\n\n        if (type === 'acen' && !centromereSeen) {\n          centromereSeen = true // the next acen entry is drawn with different right triangle\n          return (\n            <polygon\n              key={k}\n              points={\n                reversed\n                  ? rightTriangle(s - w, 0, w, h)\n                  : leftTriangle(s, 0, w, h)\n              }\n              {...getFillProps(c)}\n            />\n          )\n        }\n        if (type === 'acen' && centromereSeen) {\n          return (\n            <polygon\n              key={k}\n              points={\n                reversed\n                  ? leftTriangle(s - w, 0, w, h)\n                  : rightTriangle(s, 0, w, h)\n              }\n              {...getFillProps(c)}\n            />\n          )\n        }\n        if (lcap === index) {\n          return (\n            <path\n              key={k}\n              d={leftRoundedRect(l, 0, w, h, 8)}\n              {...getFillProps(c)}\n            />\n          )\n        }\n        if (rcap === index) {\n          return (\n            <path\n              key={k}\n              d={rightRoundedRect(l, 0, w, h, 8)}\n              {...getFillProps(c)}\n            />\n          )\n        }\n        return (\n          <rect key={k} x={l} y={0} width={w} height={h} {...getFillProps(c)} />\n        )\n      })}\n    </g>\n  )\n})\n\nexport default Cytobands\n","import { useMemo } from 'react'\n\nimport { serializeStyles } from '@emotion/serialize'\nimport { getRegisteredStyles, insertStyles } from '@emotion/utils'\n\nimport { classnames } from './tools/classnames.ts'\nimport { matchCSSObject } from './types.ts'\n\nimport type { CSSObject, Css, Cx } from './types.ts'\nimport type { EmotionCache } from '@emotion/cache'\nimport type { RegisteredCache } from '@emotion/serialize'\n\nexport const { createCssAndCx } = (() => {\n  function merge(registered: RegisteredCache, css: Css, className: string) {\n    const registeredStyles: string[] = []\n\n    const rawClassName = getRegisteredStyles(\n      registered,\n      registeredStyles,\n      className,\n    )\n\n    if (registeredStyles.length < 2) {\n      return className\n    }\n\n    return rawClassName + css(registeredStyles)\n  }\n\n  function createCssAndCx(params: { cache: EmotionCache }) {\n    const { cache } = params\n\n    const css: Css = (...args) => {\n      const serialized = serializeStyles(args, cache.registered)\n      insertStyles(cache, serialized, false)\n      const className = `${cache.key}-${serialized.name}`\n\n      scope: {\n        const arg = args[0]\n\n        if (!matchCSSObject(arg)) {\n          break scope\n        }\n\n        increaseSpecificityToTakePrecedenceOverMediaQueries.saveClassNameCSSObjectMapping(\n          cache,\n          className,\n          arg,\n        )\n      }\n\n      return className\n    }\n\n    const cx: Cx = (...args) => {\n      const className = classnames(args)\n\n      const feat27FixedClassnames =\n        increaseSpecificityToTakePrecedenceOverMediaQueries.fixClassName(\n          cache,\n          className,\n          css,\n        )\n\n      return merge(cache.registered, css, feat27FixedClassnames)\n      // return merge(cache.registered, css, className);\n    }\n\n    return { css, cx }\n  }\n\n  return { createCssAndCx }\n})()\n\nexport function createUseCssAndCx(params: { useCache: () => EmotionCache }) {\n  const { useCache } = params\n\n  function useCssAndCx() {\n    const cache = useCache()\n\n    const { css, cx } = useMemo(() => createCssAndCx({ cache }), [cache])\n\n    return { css, cx }\n  }\n\n  return { useCssAndCx }\n}\n\n// https://github.com/garronej/tss-react/issues/27\nconst increaseSpecificityToTakePrecedenceOverMediaQueries = (() => {\n  const cssObjectMapByCache = new WeakMap<\n    EmotionCache,\n    Map<string, CSSObject>\n  >()\n\n  return {\n    saveClassNameCSSObjectMapping: (\n      cache: EmotionCache,\n      className: string,\n      cssObject: CSSObject,\n    ) => {\n      let cssObjectMap = cssObjectMapByCache.get(cache)\n\n      if (cssObjectMap === undefined) {\n        cssObjectMap = new Map()\n        cssObjectMapByCache.set(cache, cssObjectMap)\n      }\n\n      cssObjectMap.set(className, cssObject)\n    },\n    fixClassName: (() => {\n      function fix(\n        classNameCSSObjects: [string /* className*/, CSSObject | undefined][],\n      ): (string | CSSObject)[] {\n        let isThereAnyMediaQueriesInPreviousClasses = false\n\n        return classNameCSSObjects.map(([className, cssObject]) => {\n          if (cssObject === undefined) {\n            return className\n          }\n\n          let out: string | CSSObject\n\n          if (!isThereAnyMediaQueriesInPreviousClasses) {\n            out = className\n\n            for (const key in cssObject) {\n              if (key.startsWith('@media')) {\n                isThereAnyMediaQueriesInPreviousClasses = true\n                break\n              }\n            }\n          } else {\n            out = {\n              '&&': cssObject,\n            }\n          }\n\n          return out\n        })\n      }\n\n      return (cache: EmotionCache, className: string, css: Css): string => {\n        // Fast path: single class with no spaces\n        if (!className.includes(' ')) {\n          return className\n        }\n\n        const cssObjectMap = cssObjectMapByCache.get(cache)\n\n        return classnames(\n          fix(\n            className\n              .split(' ')\n              .map(className => [className, cssObjectMap?.get(className)]),\n          ).map(classNameOrCSSObject =>\n            typeof classNameOrCSSObject === 'string'\n              ? classNameOrCSSObject\n              : css(classNameOrCSSObject),\n          ),\n        )\n      }\n    })(),\n  }\n})()\n","import type { CxArg } from './tools/classnames.ts'\n// Use @emotion/react (direct dep) instead of @emotion/serialize (transitive)\nimport type { CSSObject as CSSObject_base, Interpolation } from '@emotion/react'\n\nexport type CSSInterpolation = Interpolation<undefined>\n\nexport interface CSSObject extends CSSObject_base {\n  /** https://emotion.sh/docs/labels */\n  label?: string\n}\n\nexport interface Css {\n  (template: TemplateStringsArray, ...args: CSSInterpolation[]): string\n  (...args: CSSInterpolation[]): string\n}\n\n// SEE: https://github.com/emotion-js/emotion/pull/2276\nexport type Cx = (...classNames: CxArg[]) => string\n\nexport function matchCSSObject(\n  arg: TemplateStringsArray | CSSInterpolation,\n): arg is CSSObject {\n  return (\n    arg instanceof Object &&\n    !('styles' in arg) &&\n    !('length' in arg) &&\n    !('__emotion_styles' in arg)\n  )\n}\n\nexport type { CxArg } from './tools/classnames.ts'\n","'use client'\n\nimport { useMemo } from 'react'\n\nimport { __unsafe_useEmotionCache } from '@emotion/react'\n\nimport { createUseCssAndCx } from './cssAndCx.ts'\nimport { mergeClasses } from './mergeClasses.ts'\nimport { getDependencyArrayRef } from './tools/getDependencyArrayRef.ts'\n\nimport type { CSSObject } from './types.ts'\nimport type { EmotionCache } from '@emotion/cache'\n\nconst useContextualCache = __unsafe_useEmotionCache as () => EmotionCache\n\nexport function createMakeStyles<Theme>(params: { useTheme: () => Theme }) {\n  const { useTheme } = params\n\n  const { useCssAndCx } = createUseCssAndCx({\n    useCache: useContextualCache,\n  })\n\n  function makeStyles() {\n    return function <RuleName extends string>(\n      cssObjectByRuleNameOrGetCssObjectByRuleName:\n        | ((theme: Theme) => Record<RuleName, CSSObject>)\n        | Record<RuleName, CSSObject>,\n    ) {\n      const getCssObjectByRuleName =\n        typeof cssObjectByRuleNameOrGetCssObjectByRuleName === 'function'\n          ? cssObjectByRuleNameOrGetCssObjectByRuleName\n          : () => cssObjectByRuleNameOrGetCssObjectByRuleName\n\n      return function useStyles(\n        _params?: unknown,\n        muiStyleOverridesParams?: {\n          props: { classes?: Record<string, string> }\n        },\n      ) {\n        const theme = useTheme()\n        const { css, cx } = useCssAndCx()\n\n        const classes = useMemo(() => {\n          const cssObjectByRuleName = getCssObjectByRuleName(theme)\n          const result: Record<string, string> = {}\n\n          for (const ruleName of Object.keys(cssObjectByRuleName)) {\n            const cssObject = cssObjectByRuleName[ruleName as RuleName]\n            result[ruleName] = css(cssObject)\n          }\n\n          return result as Record<RuleName, string>\n        }, [css, theme])\n\n        const propsClasses = muiStyleOverridesParams?.props.classes\n        const propsClassesRef = getDependencyArrayRef(propsClasses)\n        const mergedClasses = useMemo(\n          () =>\n            propsClasses ? mergeClasses(classes, propsClasses, cx) : classes,\n          // eslint-disable-next-line react-hooks/exhaustive-deps\n          [classes, propsClassesRef, cx],\n        )\n\n        return { classes: mergedClasses, theme, css, cx }\n      }\n    }\n  }\n\n  return { makeStyles }\n}\n","import { useTheme } from '@mui/material/styles'\n\nimport { createMakeStyles } from '../makeStyles.tsx'\n\nexport const { makeStyles } = createMakeStyles({\n  useTheme,\n})\n","/**\n * useEffect(\n *    ()=> { ... },\n *    [ { \"foo\": \"bar\" } ]\n * )\n * => The callback will be invoked every render.\n * because { \"foo\": \"bar\" } is a new instance every render.\n *\n * useEffect(\n *    ()=> { ... },\n *    [ getDependencyArrayRef({ \"foo\": \"bar\" }) ]\n * );\n * => The callback will only be invoked once.\n *\n * The optimization will be enabled only if obj is\n * of the form Record<string, string | number | undefined | null>\n * otherwise the object is returned (the function is the identity function).\n */\nexport function getDependencyArrayRef(obj: any): any {\n  if (!(obj instanceof Object) || typeof obj === 'function') {\n    return obj\n  }\n\n  const arr: string[] = []\n\n  for (const key in obj) {\n    const value = obj[key]\n\n    const typeofValue = typeof value\n\n    if (\n      !(\n        typeofValue === 'string' ||\n        (typeofValue === 'number' && !isNaN(value)) ||\n        typeofValue === 'boolean' ||\n        value === undefined ||\n        value === null\n      )\n    ) {\n      return obj\n    }\n\n    arr.push(`${key}:${typeofValue}_${value}`)\n  }\n\n  return `xSqLiJdLMd9s${arr.join('|')}`\n}\n","import type { Cx } from './types.ts'\n\nexport function mergeClasses<T extends string, U extends string>(\n  classesFromUseStyles: Record<T, string>,\n  classesOverrides: Partial<Record<U, string>> | undefined,\n  cx: Cx,\n): Record<T, string> & Partial<Record<Exclude<U, T>, string>> {\n  if (!(classesOverrides instanceof Object)) {\n    return classesFromUseStyles as Record<T, string> &\n      Partial<Record<Exclude<U, T>, string>>\n  }\n\n  const overrideKeys = Object.keys(classesOverrides)\n  if (overrideKeys.length === 0) {\n    return classesFromUseStyles as Record<T, string> &\n      Partial<Record<Exclude<U, T>, string>>\n  }\n\n  const out: Record<string, string> = {}\n\n  for (const ruleName of Object.keys(classesFromUseStyles)) {\n    out[ruleName] = cx(\n      classesFromUseStyles[ruleName as T],\n      classesOverrides[ruleName as U],\n    )\n  }\n\n  for (const ruleName of overrideKeys) {\n    if (ruleName in classesFromUseStyles) {\n      continue\n    }\n\n    const className = classesOverrides[ruleName as U]\n\n    if (typeof className !== 'string') {\n      continue\n    }\n\n    out[ruleName] = className\n  }\n\n  return out as Record<T, string> & Partial<Record<Exclude<U, T>, string>>\n}\n","import { stitch } from '../BaseFeatureWidget/util.tsx'\n\nimport type { Feat } from '../BaseFeatureWidget/util.tsx'\n\nexport function convertCodingSequenceToPeptides({\n  cds,\n  sequence,\n  codonTable,\n}: {\n  cds: Feat[]\n  sequence: string\n  codonTable: Record<string, string>\n}) {\n  const str = stitch(cds, sequence)\n  let protein = ''\n  for (let i = 0; i < str.length; i += 3) {\n    // use & symbol for undefined codon, or partial slice\n    protein += codonTable[str.slice(i, i + 3)] || '&'\n  }\n  return protein\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\nexport const NoAssemblyRegion = types\n  .model('NoAssemblyRegion', {\n    refName: types.string,\n    start: types.number,\n    end: types.number,\n    reversed: types.optional(types.boolean, false),\n  })\n  .actions(self => ({\n    setRefName(newRefName: string): void {\n      self.refName = newRefName\n    },\n  }))\n\nexport const Region = types.compose(\n  'Region',\n  NoAssemblyRegion,\n  types.model({\n    assemblyName: types.string,\n  }),\n)\n\nexport const LocalPathLocation = types.model('LocalPathLocation', {\n  locationType: types.literal('LocalPathLocation'),\n  localPath: types.string,\n})\n\n// like how blobId is used to get a blob map\nexport const BlobLocation = types.model('BlobLocation', {\n  locationType: types.literal('BlobLocation'),\n  name: types.string,\n  blobId: types.string,\n})\n\nexport const UriLocationRaw = types.model('UriLocation', {\n  locationType: types.literal('UriLocation'),\n  uri: types.string,\n  baseUri: types.maybe(types.string),\n\n  internetAccountId: types.maybe(types.string),\n\n  // auths information (such as tokens) needed for using this resource.\n  // if provided, these must be completely sufficient for using it\n  internetAccountPreAuthorization: types.maybe(\n    types.model('InternetAccountPreAuthorization', {\n      internetAccountType: types.string,\n      authInfo: types.frozen(),\n    }),\n  ),\n})\n\nexport const UriLocation = types.snapshotProcessor(UriLocationRaw, {\n  postProcessor: snap => {\n    // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n    const { baseUri, ...rest } = snap as Omit<typeof snap, symbol>\n    if (!baseUri) {\n      return rest\n    }\n    return snap\n  },\n})\n\nexport const FileLocation = types.snapshotProcessor(\n  types.union(LocalPathLocation, UriLocation, BlobLocation),\n  {\n    // @ts-expect-error\n    preProcessor(snap) {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return undefined\n      }\n\n      // @ts-expect-error\n      // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n      const { locationType, ...rest } = snap as Omit<typeof snap, symbol>\n      if (!locationType) {\n        // @ts-expect-error\n        const { uri, localPath, blob } = rest\n        let locationType = ''\n        if (uri !== undefined) {\n          locationType = 'UriLocation'\n        } else if (localPath !== undefined) {\n          locationType = 'LocalPathLocation'\n        } else if (blob !== undefined) {\n          locationType = 'BlobLocation'\n        }\n\n        return { ...rest, locationType }\n      }\n      return snap\n    },\n  },\n)\n\nexport { ElementId, createElementId } from './ElementId.ts'\n","import { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nexport default types.model('AddConnectionModel', {\n  id: ElementId,\n  type: types.literal('AddConnectionWidget'),\n})\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport stateModel from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('AddConnectionWidget', {})\n\nexport default function AddConnectionWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'AddConnectionWidget',\n      heading: 'Add a connection',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(\n        () => import('./components/AddConnectionWidget.tsx'),\n      ),\n    })\n  })\n}\n","import { cast, types } from '@jbrowse/mobx-state-tree'\n\nimport { bpToPx, moveTo, pxToBp } from './Base1DUtils.ts'\nimport calculateDynamicBlocks from './calculateDynamicBlocks.ts'\nimport calculateStaticBlocks from './calculateStaticBlocks.ts'\nimport { clamp, sum } from './index.ts'\nimport { ElementId } from './types/mst.ts'\n\nimport type { BpOffset } from './Base1DUtils.ts'\nimport type { Feature } from './simpleFeature.ts'\nimport type { Region as IRegion } from './types/index.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel Base1DView\n * used in non-lgv view representations of a 1d view e.g. the two axes of the\n * dotplot use this\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst Base1DView = types\n  .model('Base1DView', {\n    /**\n     * #property\n     */\n    id: ElementId,\n    /**\n     * #property\n     */\n    displayedRegions: types.optional(types.frozen<IRegion[]>(), []),\n    /**\n     * #property\n     */\n    bpPerPx: 0,\n    /**\n     * #property\n     */\n    offsetPx: 0,\n    /**\n     * #property\n     */\n    interRegionPaddingWidth: types.optional(types.number, 0),\n    /**\n     * #property\n     */\n    minimumBlockWidth: types.optional(types.number, 0),\n  })\n  .volatile(() => ({\n    features: undefined as undefined | Feature[],\n    volatileWidth: 0,\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     */\n    setDisplayedRegions(regions: IRegion[]) {\n      self.displayedRegions = cast(regions)\n    },\n    /**\n     * #action\n     */\n    setBpPerPx(val: number) {\n      self.bpPerPx = val\n    },\n    /**\n     * #action\n     */\n    setVolatileWidth(width: number) {\n      self.volatileWidth = width\n    },\n  }))\n  .views(self => ({\n    /**\n     * #getter\n     */\n    get width() {\n      return self.volatileWidth\n    },\n    /**\n     * #getter\n     */\n    get assemblyNames() {\n      return [...new Set(self.displayedRegions.map(r => r.assemblyName))]\n    },\n    /**\n     * #getter\n     */\n    get displayedRegionsTotalPx() {\n      return this.totalBp / self.bpPerPx\n    },\n\n    /**\n     * #getter\n     */\n    get maxOffset() {\n      // objectively determined to keep the linear genome on the main screen\n      const leftPadding = 10\n      return this.displayedRegionsTotalPx - leftPadding\n    },\n\n    /**\n     * #getter\n     */\n    get minOffset() {\n      // objectively determined to keep the linear genome on the main screen\n      const rightPadding = 30\n      return -this.width + rightPadding\n    },\n\n    /**\n     * #getter\n     */\n    get totalBp() {\n      return sum(self.displayedRegions.map(a => a.end - a.start))\n    },\n  }))\n  .views(self => ({\n    /**\n     * #getter\n     */\n    get dynamicBlocks() {\n      return calculateDynamicBlocks(self)\n    },\n\n    /**\n     * #getter\n     */\n    get staticBlocks() {\n      return calculateStaticBlocks(self)\n    },\n\n    /**\n     * #getter\n     */\n    get currBp() {\n      return sum(this.dynamicBlocks.map(a => a.end - a.start))\n    },\n  }))\n  .views(self => ({\n    /**\n     * #method\n     */\n    pxToBp(px: number) {\n      return pxToBp(self, px)\n    },\n\n    /**\n     * #method\n     */\n    bpToPx({\n      refName,\n      coord,\n      regionNumber,\n    }: {\n      refName: string\n      coord: number\n      regionNumber?: number\n    }) {\n      return bpToPx({ refName, coord, regionNumber, self })?.offsetPx\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     */\n    setFeatures(features: Feature[]) {\n      self.features = features\n    },\n\n    /**\n     * #action\n     * this makes a zoomed out view that shows all displayedRegions that makes\n     * the overview bar square with the scale bar\n     */\n    showAllRegions() {\n      self.bpPerPx = self.totalBp / self.width\n      self.offsetPx = 0\n    },\n\n    /**\n     * #action\n     */\n    zoomOut() {\n      this.zoomTo(self.bpPerPx * 2)\n    },\n\n    /**\n     * #action\n     */\n    zoomIn() {\n      this.zoomTo(self.bpPerPx / 2)\n    },\n\n    /**\n     * #action\n     */\n    zoomTo(bpPerPx: number, offset = self.width / 2) {\n      const newBpPerPx = clamp(\n        bpPerPx,\n        'minBpPerPx' in self ? (self.minBpPerPx as number) : 0,\n        'maxBpPerPx' in self\n          ? (self.maxBpPerPx as number)\n          : Number.POSITIVE_INFINITY,\n      )\n\n      const oldBpPerPx = self.bpPerPx\n      if (Math.abs(oldBpPerPx - newBpPerPx) < 0.000001) {\n        return oldBpPerPx\n      }\n\n      self.bpPerPx = newBpPerPx\n\n      // tweak the offset so that the center of the view remains at the same\n      // coordinate\n      self.offsetPx = clamp(\n        Math.round(\n          ((self.offsetPx + offset) * oldBpPerPx) / newBpPerPx - offset,\n        ),\n        self.minOffset,\n        self.maxOffset,\n      )\n      return self.bpPerPx\n    },\n\n    /**\n     * #action\n     */\n    scrollTo(offsetPx: number) {\n      const newOffsetPx = clamp(offsetPx, self.minOffset, self.maxOffset)\n      self.offsetPx = newOffsetPx\n      return newOffsetPx\n    },\n    /**\n     * #action\n     */\n    centerAt(coord: number, refName: string | undefined, regionNumber: number) {\n      if (!refName) {\n        return\n      }\n      const centerPx = self.bpToPx({\n        refName,\n        coord,\n        regionNumber,\n      })\n      if (centerPx) {\n        this.scrollTo(Math.round(centerPx - self.width / 2))\n      }\n    },\n\n    /**\n     * #action\n     * note: the scroll is clamped to keep the view on the main screen\n     */\n    scroll(distance: number) {\n      const oldOffsetPx = self.offsetPx\n      const newOffsetPx = clamp(\n        self.offsetPx + distance,\n        self.minOffset,\n        self.maxOffset,\n      )\n      self.offsetPx = newOffsetPx\n      return newOffsetPx - oldOffsetPx\n    },\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     * offset is the base-pair-offset in the displayed region, index is the\n     * index of the displayed region in the linear genome view\n     *\n     * @param start - object as `{start, end, offset, index}`\n     * @param end - object as `{start, end, offset, index}`\n     */\n    moveTo(start?: BpOffset, end?: BpOffset) {\n      moveTo(self, start, end)\n    },\n  }))\n\nexport type Base1DViewStateModel = typeof Base1DView\nexport type Base1DViewModel = Instance<Base1DViewStateModel>\n\nexport default Base1DView\n","type LogoVariant = 'color' | 'black' | 'white'\n\ninterface LogoProps {\n  variant?: LogoVariant\n}\n\nfunction getColors(variant?: LogoVariant) {\n  if (variant === 'black') {\n    return {\n      midnight: '#808080',\n      forrest: '#666666',\n      grape: '#4d4d4d',\n      mandarin: '#333333',\n      gray: '#1a1a1a',\n    }\n  }\n  if (variant === 'white') {\n    return {\n      midnight: '#ffffff',\n      forrest: '#e6e6e6',\n      grape: '#cccccc',\n      mandarin: '#b3b3b3',\n      gray: '#999999',\n    }\n  }\n  return {\n    midnight: '#0d233f',\n    forrest: '#135560',\n    grape: '#721e63',\n    mandarin: '#ffb11d',\n    gray: '#dadada',\n  }\n}\n\nexport function Logomark({ variant }: LogoProps) {\n  return (\n    <svg viewBox=\"0 0 175 175\">\n      <Icon variant={variant} />\n    </svg>\n  )\n}\n\nexport function LogoFull({ variant }: LogoProps) {\n  return (\n    <svg viewBox=\"0 0 641 175\">\n      <Text variant={variant} />\n      <Icon variant={variant} />\n    </svg>\n  )\n}\n\nfunction Icon({ variant }: LogoProps) {\n  const colors = getColors(variant)\n  return (\n    <>\n      <path\n        style={{ fill: colors.midnight }}\n        d=\"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z\"\n      />\n      <path\n        style={{ fill: colors.forrest }}\n        d=\"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z\"\n      />\n      <path\n        style={{ fill: colors.grape }}\n        d=\"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z\"\n      />\n      <path\n        style={{ fill: colors.mandarin }}\n        d=\"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z\"\n      />\n      <path\n        style={{ fill: colors.gray }}\n        d=\"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z\"\n      />\n    </>\n  )\n}\n\nfunction Text({ variant }: LogoProps) {\n  const colors = getColors(variant)\n  return (\n    <g\n      aria-label=\"JBrowse\"\n      transform=\"translate(213.084 144.241)\"\n      style={{ fill: colors.midnight }}\n    >\n      <path d=\"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z\" />\n      <path d=\"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z\" />\n      <path d=\"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z\" />\n      <path d=\"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z\" />\n      <path d=\"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z\" />\n      <path d=\"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z\" />\n      <path d=\"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z\" />\n    </g>\n  )\n}\n","import { getParent, isRoot, isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport { getEnv, getSession, objectHash } from './index.ts'\nimport { readConfObject } from '../configuration/index.ts'\n\nimport type { FileLocation, PreFileLocation } from './types/index.ts'\nimport type { AnyConfigurationModel } from '../configuration/index.ts'\nimport type {\n  IAnyStateTreeNode,\n  IAnyType,\n  Instance,\n  types,\n} from '@jbrowse/mobx-state-tree'\n\n/* utility functions for use by track models and so forth */\n\n// Cache for track assembly names - keyed by track object to avoid\n// repeated track.configuration access which triggers MobX machinery\nconst trackAssemblyNamesCache = new WeakMap<IAnyStateTreeNode, string[]>()\n\nexport function getTrackAssemblyNames(\n  track: IAnyStateTreeNode & { configuration: AnyConfigurationModel },\n) {\n  let cached = trackAssemblyNamesCache.get(track)\n  if (!cached) {\n    // Only access track.configuration on cache miss\n    cached = getConfAssemblyNames(track.configuration)\n    trackAssemblyNamesCache.set(track, cached)\n  }\n  return cached\n}\n\nexport function getConfAssemblyNames(conf: AnyConfigurationModel) {\n  const trackAssemblyNames = readConfObject(conf, 'assemblyNames') as\n    | string[]\n    | undefined\n  if (!trackAssemblyNames) {\n    // Check if it's an assembly sequence track\n    const parent = getParent<any>(conf)\n    if ('sequence' in parent) {\n      return [readConfObject(parent, 'name') as string]\n    } else {\n      throw new Error('unknown assembly names')\n    }\n  }\n  return trackAssemblyNames\n}\n\n/**\n * return the rpcSessionId of the highest parent node in the tree that has an\n * rpcSessionId */\n\nexport function getRpcSessionId(thisNode: IAnyStateTreeNode) {\n  interface NodeWithRpcSessionId extends IAnyStateTreeNode {\n    rpcSessionId: string\n  }\n  let highestRpcSessionId: string | undefined\n\n  for (let node = thisNode; !isRoot(node); node = getParent<any>(node)) {\n    if ('rpcSessionId' in node) {\n      highestRpcSessionId = (node as NodeWithRpcSessionId).rpcSessionId\n    }\n  }\n  if (!highestRpcSessionId) {\n    throw new Error(\n      'getRpcSessionId failed, no parent node in the state tree has an `rpcSessionId` attribute',\n    )\n  }\n  return highestRpcSessionId\n}\n\n/**\n * given an MST node, get the renderprops of the first parent container that\n * has renderProps\n * @param node -\n * @returns renderprops, or empty object if none found\n */\nexport function getParentRenderProps(node: IAnyStateTreeNode) {\n  for (\n    let currentNode = getParent<any>(node);\n    !isRoot(currentNode);\n    currentNode = getParent<any>(currentNode)\n  ) {\n    if ('renderProps' in currentNode) {\n      return currentNode.renderProps()\n    }\n  }\n\n  return {}\n}\n\nexport const UNKNOWN = 'UNKNOWN'\nexport const UNSUPPORTED = 'UNSUPPORTED'\n\nlet blobMap: Record<string, File> = {}\n\n// get a specific blob\nexport function getBlob(id: string) {\n  return blobMap[id]\n}\n\n// used to export entire context to webworker\nexport function getBlobMap() {\n  return blobMap\n}\n\n// TODO:IS THIS BAD?\n// used in new contexts like webworkers\nexport function setBlobMap(map: Record<string, File>) {\n  blobMap = map\n}\n\nlet counter = 0\n\n// blob files are stored in a global map. the blobId is based on a combination\n// of timestamp plus counter to be unique across sessions and fast repeated\n// calls\nexport function storeBlobLocation(location: PreFileLocation) {\n  if ('blob' in location) {\n    const blobId = `b${Date.now()}-${counter++}`\n    blobMap[blobId] = location.blob\n    return { name: location.blob.name, blobId, locationType: 'BlobLocation' }\n  }\n  return location\n}\n\n/**\n * creates a new location from the provided location including the appropriate\n * suffix and location type\n *\n * @param location - the FileLocation\n * @param suffix - the file suffix (e.g. .bam)\n * @returns the constructed location object from the provided parameters\n */\nexport function makeIndex(location: FileLocation, suffix: string) {\n  if ('uri' in location) {\n    return {\n      uri: location.uri + suffix,\n      locationType: 'UriLocation',\n    }\n  } else if ('localPath' in location) {\n    return {\n      localPath: location.localPath + suffix,\n      locationType: 'LocalPathLocation',\n    }\n  } else {\n    return location\n  }\n}\n\n/**\n * constructs a potential index file (with suffix) from the provided file name\n *\n * @param name - the name of the index file\n * @param typeA - one option of a potential two file suffix (e.g. CSI, BAI)\n * @param typeB - the second option of a potential two file suffix (e.g. CSI, BAI)\n * @returns a likely name of the index file for a given filename\n */\nexport function makeIndexType(\n  name: string | undefined,\n  typeA: string,\n  typeB: string,\n) {\n  return name?.toUpperCase().endsWith(typeA) ? typeA : typeB\n}\n\nexport interface AdapterConfig {\n  type: string\n  [key: string]: unknown\n}\n\nexport type AdapterGuesser = (\n  file: FileLocation,\n  index?: FileLocation,\n  adapterHint?: string,\n) => AdapterConfig | undefined\n\nexport type TrackTypeGuesser = (adapterName: string) => string | undefined\n\nexport function getFileName(track: FileLocation) {\n  const uri = 'uri' in track ? track.uri : undefined\n  const localPath = 'localPath' in track ? track.localPath : undefined\n  const blob = 'blobId' in track ? track : undefined\n  return (\n    blob?.name ||\n    uri?.slice(uri.lastIndexOf('/') + 1) ||\n    localPath?.slice(localPath.replace(/\\\\/g, '/').lastIndexOf('/') + 1) ||\n    ''\n  )\n}\n\nexport function guessAdapter(\n  file: FileLocation,\n  index: FileLocation | undefined,\n  adapterHint?: string,\n  model?: IAnyStateTreeNode,\n) {\n  if (model) {\n    const { pluginManager } = getEnv(model)\n    const adapterGuesser = pluginManager.evaluateExtensionPoint(\n      'Core-guessAdapterForLocation',\n      (\n        _file: FileLocation,\n        _index?: FileLocation,\n        _adapterHint?: string,\n      ): AdapterConfig | undefined => {\n        return undefined\n      },\n    ) as AdapterGuesser\n\n    const adapter = adapterGuesser(file, index, adapterHint)\n    if (adapter) {\n      return adapter\n    }\n  }\n\n  return {\n    type: UNKNOWN,\n  }\n}\n\nexport function guessTrackType(\n  adapterType: string,\n  model?: IAnyStateTreeNode,\n): string {\n  if (model) {\n    const session = getSession(model)\n\n    const trackTypeGuesser = getEnv(\n      session,\n    ).pluginManager.evaluateExtensionPoint(\n      'Core-guessTrackTypeForLocation',\n      (_adapterName: string): AdapterConfig | undefined => {\n        return undefined\n      },\n    ) as TrackTypeGuesser\n\n    const trackType = trackTypeGuesser(adapterType)\n    if (trackType) {\n      return trackType\n    }\n  }\n  return 'FeatureTrack'\n}\n\nexport function generateUnsupportedTrackConf(\n  trackName: string,\n  trackUrl: string,\n  categories: string[] | undefined,\n) {\n  const conf = {\n    type: 'FeatureTrack',\n    name: `${trackName} (Unsupported)`,\n    description: `Support not yet implemented for \"${trackUrl}\"`,\n    category: categories,\n    trackId: '',\n  }\n  conf.trackId = objectHash(conf)\n  return conf\n}\n\nexport function generateUnknownTrackConf(\n  trackName: string,\n  trackUrl: string,\n  categories?: string[],\n) {\n  const conf = {\n    type: 'FeatureTrack',\n    name: `${trackName} (Unknown)`,\n    description: `Could not determine track type for \"${trackUrl}\"`,\n    category: categories,\n    trackId: '',\n  }\n  conf.trackId = objectHash(conf)\n  return conf\n}\n\nexport function getTrackName(\n  conf: AnyConfigurationModel | { name?: string; type?: string },\n  session: { assemblies: AnyConfigurationModel[] },\n): string {\n  // Handle both MST models and plain objects\n  const trackName = isStateTreeNode(conf)\n    ? (readConfObject(conf, 'name') as string)\n    : (conf.name ?? '')\n  const trackType = isStateTreeNode(conf)\n    ? (readConfObject(conf, 'type') as string)\n    : conf.type\n  if (!trackName && trackType === 'ReferenceSequenceTrack') {\n    const asm = session.assemblies.find(a => a.sequence === conf)\n    return asm\n      ? `Reference sequence (${\n          readConfObject(asm, 'displayName') || readConfObject(asm, 'name')\n        })`\n      : 'Reference sequence'\n  }\n  return trackName\n}\n\ntype MSTArray<T extends IAnyType> = Instance<ReturnType<typeof types.array<T>>>\n\ninterface MinimalTrack extends IAnyType {\n  configuration: { trackId: string }\n}\n\ninterface GenericView {\n  type: string\n  tracks: MSTArray<MinimalTrack>\n}\n\nexport function showTrackGeneric(\n  self: GenericView,\n  trackId: string,\n  initialSnapshot = {},\n  displayInitialSnapshot = {},\n) {\n  const { pluginManager } = getEnv(self)\n  const session = getSession(self)\n\n  // Check if track is already shown\n  const found = self.tracks.find(t => t.configuration.trackId === trackId)\n  if (found) {\n    return found\n  }\n\n  const conf = session.getTracksById()[trackId]\n  if (!conf) {\n    throw new Error(`Could not resolve identifier \"${trackId}\"`)\n  }\n\n  const trackType = pluginManager.getTrackType(conf.type)\n  if (!trackType) {\n    throw new Error(`Unknown track type ${conf.type}`)\n  }\n\n  // Find a compatible display for this view type\n  const viewType = pluginManager.getViewType(self.type)!\n  const supportedDisplays = new Set(viewType.displayTypes.map(d => d.name))\n  const displays = conf.displays ?? []\n  const displayConf = displays.find((d: { type: string }) =>\n    supportedDisplays.has(d.type),\n  )\n\n  // Find a compatible display type for this view\n  const displayType =\n    displayConf?.type ??\n    trackType.displayTypes.find(d => supportedDisplays.has(d.name))?.name\n\n  if (!displayType) {\n    throw new Error(\n      `Could not find a compatible display for view type ${self.type}`,\n    )\n  }\n\n  // Generate displayId if not found in config - must use the actual displayType\n  const displayId = displayConf?.displayId ?? `${trackId}-${displayType}`\n\n  // Create track with just the trackId - the ConfigurationReference will resolve it\n  const track = trackType.stateModel.create({\n    ...initialSnapshot,\n    type: conf.type,\n    configuration: trackId,\n    displays: [\n      {\n        type: displayType,\n        configuration: displayId,\n        ...displayInitialSnapshot,\n      },\n    ],\n  })\n  self.tracks.push(track)\n  return track\n}\n\nexport function hideTrackGeneric(self: GenericView, trackId: string) {\n  const t = self.tracks.find(t => t.configuration.trackId === trackId)\n  if (t) {\n    self.tracks.remove(t)\n    return 1\n  }\n  return 0\n}\n\nexport function toggleTrackGeneric(self: GenericView, trackId: string) {\n  const hiddenCount = hideTrackGeneric(self, trackId)\n  if (!hiddenCount) {\n    showTrackGeneric(self, trackId)\n  }\n}\n","import { hashCode } from './index.ts'\n\n// generates a short \"id fingerprint\" from the config passed to the base\n// feature adapter by recursively enumerating props, but if config is too big\n// does not process entire config (FromConfigAdapter for example can be large)\nexport default function idMaker(\n  args: Record<string, unknown>,\n  id = '',\n  len = 5000,\n) {\n  const stack = [args]\n\n  // while not empty\n  while (stack.length) {\n    const obj = stack.pop()!\n    for (const [key, val] of Object.entries(obj)) {\n      if (id.length > len) {\n        return hashCode(id)\n      } else {\n        if (typeof val === 'object' && val !== null) {\n          stack.push(val as Record<string, unknown>)\n        } else {\n          id += `${key}-${val}`\n        }\n      }\n    }\n  }\n\n  return `adp-${hashCode(id)}`\n}\n","// from https://www.w3.org/TR/css-color-4/#named-colors\n\nconst colors: Record<string, string> = {\n  aliceblue: '#F0F8FF',\n  antiquewhite: '#FAEBD7',\n  aqua: '#00FFFF',\n  aquamarine: '#7FFFD4',\n  azure: '#F0FFFF',\n  beige: '#F5F5DC',\n  bisque: '#FFE4C4',\n  black: '#000000',\n  blanchedalmond: '#FFEBCD',\n  blue: '#0000FF',\n  blueviolet: '#8A2BE2',\n  brown: '#A52A2A',\n  burlywood: '#DEB887',\n  cadetblue: '#5F9EA0',\n  chartreuse: '#7FFF00',\n  chocolate: '#D2691E',\n  coral: '#FF7F50',\n  cornflowerblue: '#6495ED',\n  cornsilk: '#FFF8DC',\n  crimson: '#DC143C',\n  cyan: '#00FFFF',\n  darkblue: '#00008B',\n  darkcyan: '#008B8B',\n  darkgoldenrod: '#B8860B',\n  darkgray: '#A9A9A9',\n  darkgreen: '#006400',\n  darkgrey: '#A9A9A9',\n  darkkhaki: '#BDB76B',\n  darkmagenta: '#8B008B',\n  darkolivegreen: '#556B2F',\n  darkorange: '#FF8C00',\n  darkorchid: '#9932CC',\n  darkred: '#8B0000',\n  darksalmon: '#E9967A',\n  darkseagreen: '#8FBC8F',\n  darkslateblue: '#483D8B',\n  darkslategray: '#2F4F4F',\n  darkslategrey: '#2F4F4F',\n  darkturquoise: '#00CED1',\n  darkviolet: '#9400D3',\n  deeppink: '#FF1493',\n  deepskyblue: '#00BFFF',\n  dimgray: '#696969',\n  dimgrey: '#696969',\n  dodgerblue: '#1E90FF',\n  firebrick: '#B22222',\n  floralwhite: '#FFFAF0',\n  forestgreen: '#228B22',\n  fuchsia: '#FF00FF',\n  gainsboro: '#DCDCDC',\n  ghostwhite: '#F8F8FF',\n  gold: '#FFD700',\n  goldenrod: '#DAA520',\n  gray: '#808080',\n  green: '#008000',\n  greenyellow: '#ADFF2F',\n  grey: '#808080',\n  honeydew: '#F0FFF0',\n  hotpink: '#FF69B4',\n  indianred: '#CD5C5C',\n  indigo: '#4B0082',\n  ivory: '#FFFFF0',\n  khaki: '#F0E68C',\n  lavender: '#E6E6FA',\n  lavenderblush: '#FFF0F5',\n  lawngreen: '#7CFC00',\n  lemonchiffon: '#FFFACD',\n  lightblue: '#ADD8E6',\n  lightcoral: '#F08080',\n  lightcyan: '#E0FFFF',\n  lightgoldenrodyellow: '#FAFAD2',\n  lightgray: '#D3D3D3',\n  lightgreen: '#90EE90',\n  lightgrey: '#D3D3D3',\n  lightpink: '#FFB6C1',\n  lightsalmon: '#FFA07A',\n  lightseagreen: '#20B2AA',\n  lightskyblue: '#87CEFA',\n  lightslategray: '#778899',\n  lightslategrey: '#778899',\n  lightsteelblue: '#B0C4DE',\n  lightyellow: '#FFFFE0',\n  lime: '#00FF00',\n  limegreen: '#32CD32',\n  linen: '#FAF0E6',\n  magenta: '#FF00FF',\n  maroon: '#800000',\n  mediumaquamarine: '#66CDAA',\n  mediumblue: '#0000CD',\n  mediumorchid: '#BA55D3',\n  mediumpurple: '#9370DB',\n  mediumseagreen: '#3CB371',\n  mediumslateblue: '#7B68EE',\n  mediumspringgreen: '#00FA9A',\n  mediumturquoise: '#48D1CC',\n  mediumvioletred: '#C71585',\n  midnightblue: '#191970',\n  mintcream: '#F5FFFA',\n  mistyrose: '#FFE4E1',\n  moccasin: '#FFE4B5',\n  navajowhite: '#FFDEAD',\n  navy: '#000080',\n  oldlace: '#FDF5E6',\n  olive: '#808000',\n  olivedrab: '#6B8E23',\n  orange: '#FFA500',\n  orangered: '#FF4500',\n  orchid: '#DA70D6',\n  palegoldenrod: '#EEE8AA',\n  palegreen: '#98FB98',\n  paleturquoise: '#AFEEEE',\n  palevioletred: '#DB7093',\n  papayawhip: '#FFEFD5',\n  peachpuff: '#FFDAB9',\n  peru: '#CD853F',\n  pink: '#FFC0CB',\n  plum: '#DDA0DD',\n  powderblue: '#B0E0E6',\n  purple: '#800080',\n  rebeccapurple: '#663399',\n  red: '#FF0000',\n  rosybrown: '#BC8F8F',\n  royalblue: '#4169E1',\n  saddlebrown: '#8B4513',\n  salmon: '#FA8072',\n  sandybrown: '#F4A460',\n  seagreen: '#2E8B57',\n  seashell: '#FFF5EE',\n  sienna: '#A0522D',\n  silver: '#C0C0C0',\n  skyblue: '#87CEEB',\n  slateblue: '#6A5ACD',\n  slategray: '#708090',\n  slategrey: '#708090',\n  snow: '#FFFAFA',\n  springgreen: '#00FF7F',\n  steelblue: '#4682B4',\n  tan: '#D2B48C',\n  teal: '#008080',\n  thistle: '#D8BFD8',\n  tomato: '#FF6347',\n  turquoise: '#40E0D0',\n  violet: '#EE82EE',\n  wheat: '#F5DEB3',\n  white: '#FFFFFF',\n  whitesmoke: '#F5F5F5',\n  yellow: '#FFFF00',\n  yellowgreen: '#9ACD32',\n}\n\nexport function namedColorToHex(name: string): string | undefined {\n  return colors[name]\n}\n\nexport function isNamedColor(name: string): boolean {\n  return !!colors[name]\n}\n","import {\n  darken,\n  emphasize as muiEmphasize,\n  getContrastRatio,\n  getLuminance as muiGetLuminance,\n  lighten,\n} from '@mui/material/styles'\n\nimport { namedColorToHex } from './cssColorsLevel4.ts'\n\n/**\n * Algorithmically pick a contrasting text color that will\n * be visible on top of the given background color. Either\n * black or white.\n *\n * @param color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(),\n *  hsl(), hsla(), or named color\n * @returns 'black' or 'white'\n */\nexport function contrastingTextColor(color: string): string {\n  const luminance = getLuminance(color)\n  return luminance > 0.5 ? 'black' : 'white'\n}\n\n/**\n * The relative brightness of any point in a color space,\n * normalized to 0 for darkest black and 1 for lightest white.\n * Uses MUI's `getLuminance`, but adds support for named colors\n *\n * Formula: https://www.w3.org/TR/WCAG20-TECHS/G17.html#G17-tests\n *\n * @param color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(),\n *  hsl(), hsla(), or named color\n * @returns The relative brightness of the color in the range 0 - 1\n */\nfunction getLuminance(color: string): number {\n  const convertedColor = namedColorToHex(color)\n  return muiGetLuminance(convertedColor || color)\n}\n\n/**\n * Darken or lighten a color, depending on its luminance.\n * Light colors are darkened, dark colors are lightened.\n * Uses MUI's `emphasize`, but adds support for named colors\n *\n * @param color - CSS color, i.e. one of: #nnn, #nnnnnn, rgb(), rgba(),\n * hsl(), hsla(), or named color\n * @param coefficient - multiplier in the range 0 - 1, defaults to 0.15\n * @returns A CSS color string. Hex input values are returned as rgb\n */\nexport function emphasize(color: string, coefficient = 0.15): string {\n  const convertedColor = namedColorToHex(color)\n  return muiEmphasize(convertedColor || color, coefficient)\n}\n\nexport function makeContrasting(\n  foreground: string,\n  background = 'white',\n  minContrastRatio = 3,\n) {\n  let convertedForeground = namedColorToHex(foreground) || foreground\n  const convertedBackground = namedColorToHex(background) || background\n  const backgroundLuminance = getLuminance(convertedBackground)\n  let contrastRatio = getContrastRatio(convertedForeground, convertedBackground)\n  const originalColor = convertedForeground\n  let coefficient = 0.05\n  while (contrastRatio < minContrastRatio) {\n    convertedForeground =\n      backgroundLuminance > 0.5\n        ? darken(originalColor, coefficient)\n        : lighten(originalColor, coefficient)\n    coefficient += 0.05\n    contrastRatio = getContrastRatio(convertedForeground, convertedBackground)\n  }\n  return convertedForeground\n}\n\nexport { isNamedColor, namedColorToHex } from './cssColorsLevel4.ts'\n\n/**\n * Generate a consistent random color for a given string.\n * The same string will always generate the same color.\n *\n * @param str - The string to generate a color from\n * @returns A CSS color string in HSL format\n */\nexport function randomColor(str: string): string {\n  let sum = 0\n  for (let i = 0; i < str.length; i++) {\n    sum += str.charCodeAt(i)\n  }\n  return `hsl(${sum * 10}, 50%, 50%)`\n}\n","import {\n  offset,\n  useClientPoint,\n  useFloating,\n  useInteractions,\n} from '@floating-ui/react'\nimport { Portal, alpha, useTheme } from '@mui/material'\n\nimport { makeStyles } from '../util/tss-react/index.ts'\n\nfunction round(value: number) {\n  return Math.round(value * 1e5) / 1e5\n}\n\nconst useStyles = makeStyles()(theme => ({\n  // these styles come from\n  // https://github.com/mui-org/material-ui/blob/master/packages/material-ui/src/Tooltip/Tooltip.js\n  tooltip: {\n    position: 'absolute',\n    pointerEvents: 'none',\n    backgroundColor: alpha(theme.palette.grey[700], 0.9),\n    borderRadius: theme.shape.borderRadius,\n    color: theme.palette.common.white,\n    fontFamily: theme.typography.fontFamily,\n    padding: '4px 8px',\n    fontSize: theme.typography.fontSize,\n    lineHeight: `${round(14 / 10)}em`,\n    maxWidth: 300,\n    wordWrap: 'break-word',\n  },\n}))\n\nexport default function BaseTooltip({\n  clientPoint: clientPointCoords,\n  children,\n  placement = 'right',\n}: {\n  placement?:\n    | 'top'\n    | 'top-start'\n    | 'top-end'\n    | 'right'\n    | 'right-start'\n    | 'right-end'\n    | 'bottom'\n    | 'bottom-start'\n    | 'bottom-end'\n    | 'left'\n    | 'left-start'\n    | 'left-end'\n  clientPoint?: { x: number; y: number }\n  children: React.ReactNode\n}) {\n  const theme = useTheme()\n  const popperTheme = theme.components?.MuiPopper\n  const { classes } = useStyles()\n  const { refs, floatingStyles, context } = useFloating({\n    placement,\n    strategy: 'fixed',\n    middleware: [offset(5)],\n  })\n\n  const clientPoint = useClientPoint(context, clientPointCoords)\n  const { getFloatingProps } = useInteractions([clientPoint])\n  return (\n    <Portal container={popperTheme?.defaultProps?.container}>\n      <div\n        className={classes.tooltip}\n        // eslint-disable-next-line react-hooks/refs\n        ref={refs.setFloating}\n        style={{\n          ...floatingStyles,\n          zIndex: 100000,\n          // workaround for tooltips flashing at top left corner of screen\n          // when first appearing\n          visibility:\n            floatingStyles.transform === 'translate(0px, 0px)'\n              ? 'hidden'\n              : undefined,\n          pointerEvents: 'none',\n        }}\n        {...getFloatingProps()}\n      >\n        {children}\n      </div>\n    </Portal>\n  )\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport { groupBy } from '@jbrowse/core/util'\nimport { firstValueFrom, toArray } from 'rxjs'\n\nimport type { GetScoreMatrixArgs } from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\n\nexport async function getScoreMatrix({\n  pluginManager,\n  args,\n}: {\n  args: GetScoreMatrixArgs\n  pluginManager: PluginManager\n}) {\n  const { sources, regions, adapterConfig, sessionId, bpPerPx } = args\n  const adapter = await getAdapter(pluginManager, sessionId, adapterConfig)\n  const dataAdapter = adapter.dataAdapter as BaseFeatureDataAdapter\n\n  const r0 = regions[0]!\n  const r0len = r0.end - r0.start\n  const w = Math.floor(r0len / bpPerPx)\n  const feats = await firstValueFrom(\n    dataAdapter.getFeatures(r0, args).pipe(toArray()),\n  )\n\n  const groups = groupBy(feats, f => f.get('source'))\n  const rows = {} as Record<string, number[]>\n\n  // pre-compute values used in inner loop\n  const r0Start = r0.start\n  const invBpPerPx = 1 / bpPerPx\n\n  for (const source of sources) {\n    const { name } = source\n    const features = groups[name] || []\n\n    // use Float32Array for better performance with numeric data\n    const arr = new Float32Array(w)\n    for (const feat of features) {\n      // extract feature properties once to avoid repeated get() calls\n      const fstart = feat.get('start')\n      const fend = feat.get('end')\n      const score = feat.get('score')\n\n      // calculate loop bounds once, avoid repeated bounds checks\n      const startX = Math.max(0, ((fstart - r0Start) * invBpPerPx) | 0)\n      const endX = Math.min(w, ((fend - r0Start) * invBpPerPx) | 0)\n\n      for (let x = startX; x < endX; x++) {\n        if (arr[x] === 0) {\n          arr[x] = score\n        }\n      }\n    }\n    // convert to regular array for JSON serialization\n    rows[name] = Array.from(arr)\n  }\n\n  return rows\n}\n","// this is vendored from v6.0.0 of https://github.com/sindresorhus/map-obj/ (MIT)\n\nexport const mapObjectSkip: unique symbol = Symbol('mapObjectSkip')\n\nexport interface Options {\n  readonly deep?: boolean\n  readonly includeSymbols?: boolean\n  readonly target?: Record<string | symbol, unknown>\n}\n\nexport interface MapperOptions {\n  readonly shouldRecurse?: boolean\n}\n\ntype MapperResult<K extends string | symbol, V> =\n  | [targetKey: K, targetValue: V, mapperOptions?: MapperOptions]\n  | typeof mapObjectSkip\n\nexport type Mapper<\n  SourceObjectType extends Record<string | symbol, unknown>,\n  MappedObjectKeyType extends string | symbol,\n  MappedObjectValueType,\n> = (\n  sourceKey: string,\n  sourceValue: unknown,\n  source: SourceObjectType,\n) => MapperResult<MappedObjectKeyType, MappedObjectValueType>\n\nconst isObject = (value: unknown): value is Record<string | symbol, unknown> =>\n  typeof value === 'object' && value !== null\n\nconst isObjectCustom = (\n  value: unknown,\n): value is Record<string | symbol, unknown> => {\n  if (!isObject(value)) {\n    return false\n  }\n\n  if (\n    value instanceof RegExp ||\n    value instanceof Error ||\n    value instanceof Date ||\n    value instanceof Map ||\n    value instanceof Set ||\n    value instanceof WeakMap ||\n    value instanceof WeakSet ||\n    value instanceof Promise ||\n    value instanceof ArrayBuffer ||\n    value instanceof DataView ||\n    ArrayBuffer.isView(value) ||\n    (globalThis.Blob && value instanceof globalThis.Blob)\n  ) {\n    return false\n  }\n\n  // Exclude Jest matchers\n  const v = value as { $$typeof?: unknown; asymmetricMatch?: unknown }\n  if (\n    typeof v.$$typeof === 'symbol' ||\n    typeof v.asymmetricMatch === 'function'\n  ) {\n    return false\n  }\n\n  return true\n}\n\nconst getEnumerableKeys = (\n  object: Record<string | symbol, unknown>,\n  includeSymbols: boolean,\n): (string | symbol)[] => {\n  if (includeSymbols) {\n    const stringKeys = Object.keys(object)\n    const symbolKeys = Object.getOwnPropertySymbols(object).filter(\n      symbol => Object.getOwnPropertyDescriptor(object, symbol)?.enumerable,\n    )\n    return [...stringKeys, ...symbolKeys]\n  }\n\n  return Object.keys(object)\n}\n\ninterface ProcessOptions {\n  deep: boolean\n  includeSymbols: boolean\n}\n\nconst _mapObject = <\n  SourceObjectType extends Record<string | symbol, unknown>,\n  MappedObjectKeyType extends string | symbol,\n  MappedObjectValueType,\n>(\n  object: SourceObjectType | unknown[],\n  mapper: Mapper<SourceObjectType, MappedObjectKeyType, MappedObjectValueType>,\n  options: Options | undefined,\n  isSeen: WeakMap<object, unknown> = new WeakMap(),\n): Record<MappedObjectKeyType, MappedObjectValueType> | unknown[] => {\n  const { target = {}, deep = false, includeSymbols = false } = options ?? {}\n  const processOptions: ProcessOptions = { deep, includeSymbols }\n\n  if (isSeen.has(object as object)) {\n    return isSeen.get(object as object) as Record<\n      MappedObjectKeyType,\n      MappedObjectValueType\n    >\n  }\n\n  isSeen.set(object as object, target)\n\n  const mapArray = (array: unknown[]): unknown[] =>\n    array.map(element =>\n      isObjectCustom(element)\n        ? _mapObject(\n            element as SourceObjectType,\n            mapper,\n            processOptions,\n            isSeen,\n          )\n        : element,\n    )\n\n  if (Array.isArray(object)) {\n    return mapArray(object)\n  }\n\n  for (const key of getEnumerableKeys(object, processOptions.includeSymbols)) {\n    const value = object[key]\n    const mapResult = mapper(key as string, value, object)\n\n    if (mapResult === mapObjectSkip) {\n      continue\n    }\n\n    if (!Array.isArray(mapResult)) {\n      throw new TypeError(\n        `Mapper must return an array or mapObjectSkip, got ${mapResult === null ? 'null' : typeof mapResult}`,\n      )\n    }\n\n    if (mapResult.length < 2) {\n      throw new TypeError(\n        `Mapper must return an array with at least 2 elements [key, value], got ${mapResult.length} elements`,\n      )\n    }\n\n    let [newKey, newValue, { shouldRecurse = true } = {}] = mapResult\n\n    // Drop `__proto__` keys.\n    if (newKey === '__proto__') {\n      continue\n    }\n\n    if (processOptions.deep && shouldRecurse && isObjectCustom(newValue)) {\n      newValue = (\n        Array.isArray(newValue)\n          ? mapArray(newValue)\n          : _mapObject(\n              newValue as SourceObjectType,\n              mapper,\n              processOptions,\n              isSeen,\n            )\n      ) as MappedObjectValueType\n    }\n\n    try {\n      ;(target as Record<string | symbol, unknown>)[newKey] = newValue\n    } catch (error) {\n      if (error instanceof TypeError && error.message.includes('read only')) {\n        continue\n      }\n      throw error\n    }\n  }\n\n  return target as Record<MappedObjectKeyType, MappedObjectValueType>\n}\n\nexport default function mapObject<\n  SourceObjectType extends Record<string | symbol, unknown>,\n  MappedObjectKeyType extends string | symbol,\n  MappedObjectValueType,\n>(\n  object: SourceObjectType,\n  mapper: Mapper<SourceObjectType, MappedObjectKeyType, MappedObjectValueType>,\n  options?: Options,\n): Record<MappedObjectKeyType, MappedObjectValueType> {\n  if (!isObject(object)) {\n    throw new TypeError(\n      `Expected an object, got \\`${object}\\` (${typeof object})`,\n    )\n  }\n\n  if (Array.isArray(object)) {\n    throw new TypeError('Expected an object, got an array')\n  }\n\n  const mapperWithRoot: Mapper<\n    SourceObjectType,\n    MappedObjectKeyType,\n    MappedObjectValueType\n  > = (key, value) => mapper(key, value, object)\n\n  return _mapObject(object, mapperWithRoot, options) as Record<\n    MappedObjectKeyType,\n    MappedObjectValueType\n  >\n}\n","import PluggableElementBase from './PluggableElementBase.ts'\nimport mapObject from '../util/map-obj/index.ts'\nimport { isRpcResult } from '../util/rpc.ts'\nimport { getBlobMap, setBlobMap } from '../util/tracks.ts'\nimport {\n  RetryError,\n  isAppRootModel,\n  isAuthNeededException,\n  isUriLocation,\n} from '../util/types/index.ts'\n\nimport type PluginManager from '../PluginManager.ts'\nimport type { UriLocation } from '../util/types/index.ts'\n\nexport type RpcMethodConstructor = new (pm: PluginManager) => RpcMethodType\n\nexport default abstract class RpcMethodType extends PluggableElementBase {\n  pluginManager: PluginManager\n\n  constructor(pluginManager: PluginManager) {\n    super()\n    this.pluginManager = pluginManager\n  }\n\n  async serializeArguments(\n    args: Record<string, unknown>,\n    rpcDriverClassName: string,\n  ): Promise<Record<string, unknown>> {\n    await this.augmentLocationObjects(args, rpcDriverClassName)\n    return {\n      ...args,\n      blobMap: getBlobMap(),\n    }\n  }\n\n  async serializeNewAuthArguments(\n    loc: UriLocation,\n    _rpcDriverClassName: string,\n  ) {\n    const rootModel = this.pluginManager.rootModel\n\n    // args dont need auth or already have auth\n    if (!isAppRootModel(rootModel) || loc.internetAccountPreAuthorization) {\n      return loc\n    }\n\n    const account = rootModel.findAppropriateInternetAccount(loc)\n\n    if (account) {\n      loc.internetAccountPreAuthorization =\n        await account.getPreAuthorizationInformation(loc)\n    }\n    return loc\n  }\n\n  async deserializeArguments<T>(\n    args: T & { blobMap?: Record<string, File> },\n    _rpcDriverClassName: string,\n  ): Promise<T> {\n    if (args.blobMap) {\n      setBlobMap(args.blobMap)\n    }\n\n    return args\n  }\n\n  abstract execute(\n    serializedArgs: unknown,\n    rpcDriverClassName: string,\n  ): Promise<unknown>\n\n  /**\n   * Execute directly without serialization. Override in subclasses that support\n   * direct execution (e.g., CoreRender). Returns undefined by default, signaling\n   * that the driver should fall back to serialized execution.\n   */\n  async executeDirect(_args: Record<string, unknown>): Promise<unknown> {\n    return undefined\n  }\n\n  supportsDirectExecution(): boolean {\n    return this.executeDirect !== RpcMethodType.prototype.executeDirect\n  }\n\n  async serializeReturn(\n    originalReturn: unknown,\n    _args: unknown,\n    _rpcDriverClassName: string,\n  ) {\n    return originalReturn\n  }\n\n  async deserializeReturn(\n    serializedReturn: unknown,\n    _args: unknown,\n    _rpcDriverClassName: string,\n  ) {\n    let r: unknown\n    try {\n      r = await serializedReturn\n    } catch (error) {\n      if (isAuthNeededException(error)) {\n        const retryAccount = // @ts-expect-error\n          this.pluginManager.rootModel?.createEphemeralInternetAccount(\n            `HTTPBasicInternetAccount-${new URL(error.url).origin}`,\n            {},\n            error.url,\n          )\n        throw new RetryError(\n          'Retrying with created internet account',\n          retryAccount.internetAccountId,\n        )\n      }\n      throw error\n    }\n    // Unwrap rpcResult if present (needed for MainThreadRpcDriver where the\n    // rpcResult wrapper isn't stripped by the worker message handler)\n    if (isRpcResult(r)) {\n      return r.value\n    }\n    return r\n  }\n\n  private async augmentLocationObjects(\n    thing: Record<string, unknown>,\n    rpcDriverClassName: string,\n  ) {\n    const rootModel = this.pluginManager.rootModel\n\n    // Skip expensive deep traversal only if we have a valid root model with no internet accounts\n    // (Don't skip if rootModel isn't set up - let serializeNewAuthArguments handle that case)\n    if (isAppRootModel(rootModel) && rootModel.internetAccounts.length === 0) {\n      return thing\n    }\n\n    const uris = [] as UriLocation[]\n\n    // exclude renderingProps from deep traversal - it is only needed\n    // client-side for React components and can contain circular references\n    // (e.g. d3 hierarchy nodes) or non-serializable objects like callbacks\n    const { renderingProps, ...rest } = thing\n\n    // using map-obj avoids cycles, seen in circular view svg export\n    mapObject(\n      rest,\n      (key, val: unknown) => {\n        if (isUriLocation(val)) {\n          uris.push(val)\n        }\n        if (Array.isArray(val)) {\n          for (const item of val) {\n            if (isUriLocation(item)) {\n              uris.push(item)\n            }\n          }\n        }\n        return [key, val]\n      },\n      { deep: true },\n    )\n    for (const uri of uris) {\n      await this.serializeNewAuthArguments(uri, rpcDriverClassName)\n    }\n    return thing\n  }\n}\n","import { lazy } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport EqualizerIcon from '@mui/icons-material/Equalizer'\nimport PaletteIcon from '@mui/icons-material/Palette'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\n\nimport SharedWiggleMixin from '../shared/SharedWiggleMixin.ts'\nimport axisPropsFromTickScale from '../shared/axisPropsFromTickScale.ts'\nimport { YSCALEBAR_LABEL_OFFSET, getScale } from '../util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { AnyReactComponentType } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\n\n// lazies\nconst Tooltip = lazy(() => import('./components/Tooltip.tsx'))\nconst SetColorDialog = lazy(() => import('./components/SetColorDialog.tsx'))\n\n// using a map because it preserves order\nconst rendererTypes = new Map([\n  ['xyplot', 'XYPlotRenderer'],\n  ['density', 'DensityRenderer'],\n  ['line', 'LinePlotRenderer'],\n])\n\n/**\n * #stateModel LinearWiggleDisplay\n * extends\n * - [SharedWiggleMixin](../sharedwigglemixin)\n */\nfunction stateModelFactory(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearWiggleDisplay',\n      SharedWiggleMixin(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearWiggleDisplay'),\n        /**\n         * #property\n         */\n        invertedSetting: types.maybe(types.boolean),\n      }),\n    )\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setInverted(arg: boolean) {\n        self.invertedSetting = arg\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get TooltipComponent() {\n        return Tooltip as AnyReactComponentType\n      },\n\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        const name = self.rendererTypeNameSimple\n        const rendererType = rendererTypes.get(name)\n        if (!rendererType) {\n          throw new Error(`unknown renderer ${name}`)\n        }\n        return rendererType\n      },\n      /**\n       * #getter\n       * unused currently\n       */\n      get quantitativeStatsRelevantToCurrentZoom() {\n        const view = getContainingView(self) as LinearGenomeViewModel\n        return self.stats?.currStatsBpPerPx === view.bpPerPx\n      },\n\n      /**\n       * #getter\n       */\n      get graphType() {\n        return (\n          self.rendererTypeName === 'XYPlotRenderer' ||\n          self.rendererTypeName === 'LinePlotRenderer'\n        )\n      },\n      /**\n       * #getter\n       */\n      get inverted() {\n        return self.invertedSetting ?? (getConf(self, 'inverted') as boolean)\n      },\n    }))\n\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        adapterProps() {\n          const superProps = superRenderProps()\n          const { filters, resolution, scaleOpts } = self\n          return {\n            ...superProps,\n            rpcDriverName: self.effectiveRpcDriverName,\n            config: self.rendererConfig,\n            displayCrossHatches: self.displayCrossHatchesSetting,\n            scaleOpts,\n            resolution,\n            filters,\n          }\n        },\n\n        /**\n         * #getter\n         */\n        get ticks() {\n          const { inverted, scaleType, domain, height } = self\n          const minimalTicks = getConf(self, 'minimalTicks')\n          if (domain) {\n            const ticks = axisPropsFromTickScale(\n              getScale({\n                scaleType,\n                domain,\n                range: [\n                  height - YSCALEBAR_LABEL_OFFSET,\n                  YSCALEBAR_LABEL_OFFSET,\n                ],\n                inverted,\n              }),\n              4,\n            )\n            return height < 100 || minimalTicks\n              ? { ...ticks, values: domain }\n              : ticks\n          } else {\n            return undefined\n          }\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #method\n       */\n      renderProps() {\n        const { inverted, ticks, height, domain } = self\n        const superProps = self.adapterProps()\n        const view = getContainingView(self) as LinearGenomeViewModel\n        const statsRegion = JSON.stringify(view.dynamicBlocks)\n        return {\n          ...self.adapterProps(),\n          notReady:\n            superProps.notReady ||\n            !domain ||\n            self.stats?.statsRegion !== statsRegion,\n          height,\n          ticks,\n          inverted,\n          offset: YSCALEBAR_LABEL_OFFSET,\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get fillSetting() {\n        if (self.filled) {\n          return 0\n        } else if (self.minSize === 1) {\n          return 1\n        } else {\n          return 2\n        }\n      },\n      /**\n       * #getter\n       */\n      get quantitativeStatsReady() {\n        const view = getContainingView(self) as LinearGenomeViewModel\n        return (\n          view.initialized &&\n          self.featureDensityStatsReadyAndRegionNotTooLarge &&\n          !self.error\n        )\n      },\n    }))\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n      const hasRenderings = getConf(self, 'defaultRendering')\n      return {\n        /**\n         * #method\n         * Base track menu items shared by all wiggle displays (Score submenu)\n         */\n        wiggleBaseTrackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Score',\n              icon: EqualizerIcon,\n              subMenu: self.scoreTrackMenuItems(),\n            },\n          ]\n        },\n\n        /**\n         * #method\n         * Menu items specific to LinearWiggleDisplay (Color, Inverted, etc.)\n         * Not used by SNPCoverageDisplay\n         */\n        wiggleOnlyTrackMenuItems() {\n          return [\n            ...(self.canHaveFill\n              ? [\n                  {\n                    label: 'Fill mode',\n                    subMenu: ['filled', 'no fill', 'no fill w/ emphasis'].map(\n                      (elt, idx) => ({\n                        label: elt,\n                        type: 'radio',\n                        checked: self.fillSetting === idx,\n                        onClick: () => {\n                          self.setFill(idx)\n                        },\n                      }),\n                    ),\n                  },\n                ]\n              : []),\n\n            ...(hasRenderings\n              ? [\n                  {\n                    label: 'Renderer type',\n                    subMenu: ['xyplot', 'density', 'line'].map(key => ({\n                      label: key,\n                      type: 'radio',\n                      checked: self.rendererTypeNameSimple === key,\n                      onClick: () => {\n                        self.setRendererType(key)\n                      },\n                    })),\n                  },\n                ]\n              : []),\n\n            {\n              label: 'Color',\n              icon: PaletteIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  SetColorDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #method\n       */\n      trackMenuItems() {\n        return [\n          ...self.wiggleBaseTrackMenuItems(),\n          {\n            label: 'Show...',\n            icon: VisibilityIcon,\n            subMenu: [\n              {\n                label: 'Show tooltips',\n                type: 'checkbox',\n                checked: self.showTooltipsEnabled,\n                onClick: () => {\n                  self.setShowTooltips(!self.showTooltipsEnabled)\n                },\n              },\n              ...(self.graphType\n                ? [\n                    {\n                      label: 'Show inverted',\n                      type: 'checkbox',\n                      checked: self.inverted,\n                      onClick: () => {\n                        self.setInverted(!self.inverted)\n                      },\n                    },\n                    {\n                      label: 'Show cross hatches',\n                      type: 'checkbox',\n                      checked: self.displayCrossHatchesSetting,\n                      onClick: () => {\n                        self.toggleCrossHatches()\n                      },\n                    },\n                  ]\n                : []),\n            ],\n          },\n          ...self.wiggleOnlyTrackMenuItems(),\n        ]\n      },\n    }))\n    .actions(self => {\n      const { renderSvg: superRenderSvg } = self\n\n      return {\n        afterAttach() {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises\n          ;(async () => {\n            const { getQuantitativeStatsAutorun } =\n              await import('../getQuantitativeStatsAutorun.ts')\n            getQuantitativeStatsAutorun(self)\n          })()\n        },\n        /**\n         * #action\n         */\n        async renderSvg(opts: ExportSvgDisplayOptions) {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self, opts, superRenderSvg)\n        },\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { invertedSetting, ...rest } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(invertedSetting !== undefined ? { invertedSetting } : {}),\n      } as typeof snap\n    })\n}\n\nexport type WiggleDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type WiggleDisplayModel = Instance<WiggleDisplayStateModel>\n\nexport default stateModelFactory\n","import { memo } from 'react'\n\nimport { getContainingView } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport { calculateFloatingLabelPosition } from './util.ts'\n\nimport type { FeatureTrackModel } from '../../LinearBasicDisplay/model.ts'\nimport type { LinearGenomeViewModel } from '../../LinearGenomeView/index.ts'\n\nconst useStyles = makeStyles()({\n  // Full-size overlay container for floating labels\n  // pointerEvents:none allows clicks to pass through to features beneath\n  container: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    height: '100%',\n    pointerEvents: 'none',\n    zIndex: 5,\n  },\n  // Base label styles - positioned via transform for performance\n  // pointerEvents:auto re-enables interaction on the labels themselves\n  label: {\n    position: 'absolute',\n    fontSize: 11,\n    cursor: 'default',\n    pointerEvents: 'auto',\n  },\n  // Overlay labels get a semi-transparent background for readability\n  overlay: {\n    backgroundColor: 'rgba(255, 255, 255, 0.8)',\n    lineHeight: 1,\n  },\n})\n\ninterface BaseLabelProps {\n  text: string\n  color: string\n  isOverlay: boolean\n  featureLeftPx: number\n  featureId: string\n  subfeatureId?: string\n  y: number\n  tooltip?: string\n  labelClass: string\n  overlayClass: string\n}\n\ninterface FloatingLabelProps extends BaseLabelProps {\n  featureRightPx: number\n  labelWidth: number\n  offsetPx: number\n  viewportLeft: number\n}\n\n// Fixed labels use CSS variable for offset - position updates via CSS, not JS\n// This avoids React re-renders during scroll for labels that don't float\nconst FixedLabel = memo(function FixedLabel({\n  text,\n  color,\n  isOverlay,\n  featureLeftPx,\n  featureId,\n  subfeatureId,\n  y,\n  tooltip,\n  labelClass,\n  overlayClass,\n}: BaseLabelProps) {\n  return (\n    <div\n      data-feature-id={featureId}\n      data-subfeature-id={subfeatureId}\n      data-tooltip={tooltip}\n      className={isOverlay ? `${labelClass} ${overlayClass}` : labelClass}\n      style={{\n        color,\n        transform: `translate(calc(${featureLeftPx}px - var(--offset-px)), ${y}px)`,\n      }}\n    >\n      {text}\n    </div>\n  )\n})\n\n// Floating labels need JS calculation for the clamp logic\nfunction FloatingLabel({\n  text,\n  color,\n  isOverlay,\n  featureLeftPx,\n  featureRightPx,\n  featureId,\n  subfeatureId,\n  labelWidth,\n  y,\n  offsetPx,\n  viewportLeft,\n  tooltip,\n  labelClass,\n  overlayClass,\n}: FloatingLabelProps) {\n  const x = calculateFloatingLabelPosition(\n    featureLeftPx,\n    featureRightPx,\n    labelWidth,\n    offsetPx,\n    viewportLeft,\n  )\n\n  return (\n    <div\n      data-feature-id={featureId}\n      data-subfeature-id={subfeatureId}\n      data-tooltip={tooltip}\n      className={isOverlay ? `${labelClass} ${overlayClass}` : labelClass}\n      style={{ color, transform: `translate(${x}px,${y}px)` }}\n    >\n      {text}\n    </div>\n  )\n}\n\nconst FloatingLabels = observer(function FloatingLabels({\n  model,\n}: {\n  model: FeatureTrackModel\n}) {\n  const { classes } = useStyles()\n  const view = getContainingView(model) as LinearGenomeViewModel\n  const { offsetPx } = view\n  const featureLabels = model.floatingLabelData\n\n  // @ts-expect-error\n  const { onFeatureClick, onFeatureContextMenu, onMouseMove } =\n    model.renderingProps()\n\n  const fixedLabels: React.ReactElement[] = []\n  const floatingLabels: React.ReactElement[] = []\n\n  // Calculate viewport left edge once per render instead of per label\n  const viewportLeft = Math.max(0, offsetPx)\n\n  for (const [\n    key,\n    {\n      leftPx,\n      topPx,\n      totalFeatureHeight,\n      floatingLabels: labelData,\n      featureWidth,\n    },\n  ] of featureLabels.entries()) {\n    const featureVisualBottom = topPx + totalFeatureHeight\n    const featureRightPx = leftPx + featureWidth\n\n    for (let i = 0, l = labelData.length; i < l; i++) {\n      const floatingLabel = labelData[i]!\n      const {\n        text,\n        relativeY,\n        color,\n        isOverlay,\n        textWidth: labelWidth,\n        parentFeatureId,\n        subfeatureId,\n        tooltip,\n      } = floatingLabel\n\n      const y = featureVisualBottom + relativeY\n      const labelKey = `${key}-${i}`\n      const featureId = parentFeatureId ?? key\n\n      // Labels wider than feature don't float - use CSS variable for offset\n      // This avoids React re-renders during scroll\n      if (labelWidth > featureWidth) {\n        fixedLabels.push(\n          <FixedLabel\n            key={labelKey}\n            text={text}\n            color={color}\n            isOverlay={isOverlay ?? false}\n            featureLeftPx={leftPx}\n            featureId={featureId}\n            subfeatureId={subfeatureId}\n            y={y}\n            tooltip={tooltip}\n            labelClass={classes.label}\n            overlayClass={classes.overlay}\n          />,\n        )\n      } else {\n        // Labels that fit within feature need JS calculation for floating logic\n        floatingLabels.push(\n          <FloatingLabel\n            key={labelKey}\n            text={text}\n            color={color}\n            isOverlay={isOverlay ?? false}\n            featureLeftPx={leftPx}\n            featureRightPx={featureRightPx}\n            featureId={featureId}\n            subfeatureId={subfeatureId}\n            labelWidth={labelWidth}\n            y={y}\n            offsetPx={offsetPx}\n            viewportLeft={viewportLeft}\n            tooltip={tooltip}\n            labelClass={classes.label}\n            overlayClass={classes.overlay}\n          />,\n        )\n      }\n    }\n  }\n\n  return (\n    <div\n      className={classes.container}\n      style={{ '--offset-px': `${offsetPx}px` } as React.CSSProperties}\n      onClick={e => {\n        const target = e.target as HTMLElement\n        const subfeatureId = target.dataset.subfeatureId\n        const featureId = subfeatureId ?? target.dataset.featureId\n        if (featureId) {\n          onFeatureClick?.(e, featureId)\n        }\n      }}\n      onContextMenu={e => {\n        const target = e.target as HTMLElement\n        const subfeatureId = target.dataset.subfeatureId\n        const featureId = subfeatureId ?? target.dataset.featureId\n        if (featureId) {\n          onFeatureContextMenu?.(e, featureId)\n        }\n      }}\n      onMouseOver={e => {\n        const target = e.target as HTMLElement\n        const featureId = target.dataset.featureId\n        if (featureId) {\n          const tooltip = target.dataset.tooltip\n          const subfeatureId = target.dataset.subfeatureId\n          onMouseMove?.(e, featureId, tooltip)\n          model.setSubfeatureIdUnderMouse(subfeatureId)\n        }\n      }}\n    >\n      {fixedLabels}\n      {floatingLabels}\n    </div>\n  )\n})\n\nexport default FloatingLabels\n","import { observer } from 'mobx-react'\n\nimport FloatingLabels from '../../BaseLinearDisplay/components/FloatingLabels.tsx'\nimport { BaseLinearDisplayComponent } from '../../BaseLinearDisplay/index.ts'\n\nimport type { FeatureTrackModel } from '../model.ts'\n\nconst LinearBasicDisplayComponent = observer(\n  function LinearBasicDisplayComponent(props: { model: FeatureTrackModel }) {\n    const { model } = props\n    return (\n      <BaseLinearDisplayComponent model={model}>\n        <FloatingLabels model={model} />\n      </BaseLinearDisplayComponent>\n    )\n  },\n)\n\nexport default LinearBasicDisplayComponent\n","import type { Feature } from '@jbrowse/core/util'\n\nexport function stringifyBED({ features }: { features: Feature[] }) {\n  const fields = ['refName', 'start', 'end', 'name', 'score', 'strand']\n  return features\n    .map(feature =>\n      fields\n        .map(field => feature.get(field) ?? '.')\n        .join('\\t')\n        .trim(),\n    )\n    .join('\\n')\n}\n","/**\n * EXPERIMENTAL: GenBank format exporter\n *\n * This module provides experimental support for exporting features to GenBank format.\n * The generated output may not fully conform to the GenBank specification and should\n * be validated before use in production workflows.\n */\nimport { fetchSequence } from './fetchSequence.ts'\nimport { max, min } from '../../../util/index.ts'\n\nimport type { AbstractSessionModel, Feature } from '../../../util/index.ts'\n\nconst coreFields = new Set([\n  'uniqueId',\n  'refName',\n  'source',\n  'type',\n  'start',\n  'end',\n  'strand',\n  'parent',\n  'parentId',\n  'score',\n  'subfeatures',\n  'phase',\n])\n\nconst blank = '                     '\n\nconst retitle = {\n  name: 'Name',\n} as Record<string, string | undefined>\n\nfunction fmt(obj: unknown): string {\n  if (Array.isArray(obj)) {\n    return obj.map(o => fmt(o)).join(',')\n  } else if (typeof obj === 'object') {\n    return JSON.stringify(obj)\n  } else {\n    return `${obj}`\n  }\n}\n\nfunction formatTags(f: Feature, parentId?: string, parentType?: string) {\n  return [\n    parentId && parentType ? `${blank}/${parentType}=\"${parentId}\"` : '',\n    f.get('id') ? `${blank}/name=${f.get('id')}` : '',\n    ...Object.keys(f.toJSON())\n      .filter(tag => !coreFields.has(tag))\n      .map(tag => [tag, fmt(f.get(tag))] as const)\n      .filter(tag => !!tag[1] && tag[0] !== parentType)\n      .map(tag => `${blank}/${retitle[tag[0]] || tag[0]}=\"${tag[1]}\"`),\n  ].filter(f => !!f)\n}\n\nfunction relativeStart(f: Feature, min: number) {\n  return f.get('start') - min + 1\n}\nfunction relativeEnd(f: Feature, min: number) {\n  return f.get('end') - min\n}\nfunction loc(f: Feature, min: number) {\n  return `${relativeStart(f, min)}..${relativeEnd(f, min)}`\n}\nfunction formatFeat(\n  f: Feature,\n  min: number,\n  parentType?: string,\n  parentId?: string,\n) {\n  const type = `${f.get('type')}`.slice(0, 16)\n  const l = loc(f, min)\n  const locstrand = f.get('strand') === -1 ? `complement(${l})` : l\n  return [\n    `     ${type.padEnd(16)}${locstrand}`,\n    ...formatTags(f, parentType, parentId),\n  ]\n}\n\nfunction formatCDS(\n  feats: Feature[],\n  parentId: string,\n  parentType: string,\n  strand: number,\n  min: number,\n) {\n  const cds = feats.map(f => loc(f, min))\n  const pre = `join(${cds})`\n  const str = strand === -1 ? `complement(${pre})` : pre\n  return feats.length\n    ? [`     ${'CDS'.padEnd(16)}${str}`, `${blank}/${parentType}=\"${parentId}\"`]\n    : []\n}\n\nexport function formatFeatWithSubfeatures(\n  feature: Feature,\n  min: number,\n  parentId?: string,\n  parentType?: string,\n): string {\n  const primary = formatFeat(feature, min, parentId, parentType)\n  const subfeatures = feature.get('subfeatures') || []\n  const cds = subfeatures.filter(f => f.get('type') === 'CDS')\n  const sansCDS = subfeatures.filter(\n    f => f.get('type') !== 'CDS' && f.get('type') !== 'exon',\n  )\n  const newParentId = feature.get('id')\n  const newParentType = feature.get('type')\n  const newParentStrand = feature.get('strand')\n  return [\n    ...primary,\n    ...formatCDS(cds, newParentId, newParentType, newParentStrand, min),\n    ...sansCDS.flatMap(sub =>\n      formatFeatWithSubfeatures(sub, min, newParentId, newParentType),\n    ),\n  ].join('\\n')\n}\n\nexport async function stringifyGBK({\n  features,\n  assemblyName,\n  session,\n}: {\n  assemblyName: string\n  session: AbstractSessionModel\n  features: Feature[]\n}) {\n  if (!features.length) {\n    return ''\n  }\n  const date = '10-JAN-1970'\n\n  const start = min(features.map(f => f.get('start')))\n  const end = max(features.map(f => f.get('end')))\n  const length = end - start\n  const refName = features[0]!.get('refName') || ''\n\n  const l1 = [\n    'LOCUS'.padEnd(12),\n    `${refName}:${start + 1}..${end}`.padEnd(20),\n    ` ${length} bp`.padEnd(15),\n    ` ${'DNA'.padEnd(10)}`,\n    'linear'.padEnd(10),\n    `UNK ${date}`,\n  ].join('')\n  const l2 = 'FEATURES             Location/Qualifiers'\n  const contig =\n    (await fetchSequence({\n      session,\n      region: { assemblyName, start, end, refName },\n    })) ?? ''\n  const lines = features.map(feat => formatFeatWithSubfeatures(feat, start))\n  const seqlines = ['ORIGIN', `\\t1 ${contig}`, '//']\n  return [l1, l2, ...lines, ...seqlines].join('\\n')\n}\n","import { getConf } from '../../../configuration/index.ts'\n\nimport type { AbstractSessionModel, Region } from '../../../util/index.ts'\n\nexport async function fetchSequence({\n  session,\n  region,\n}: {\n  session: AbstractSessionModel\n  region: Region\n}) {\n  const { rpcManager, assemblyManager } = session\n  const assembly = assemblyManager.get(region.assemblyName)\n  if (!assembly) {\n    throw new Error(`assembly ${region.assemblyName} not found`)\n  }\n\n  const sessionId = 'getSequence'\n  return rpcManager.call(sessionId, 'CoreGetSequence', {\n    adapterConfig: getConf(assembly, ['sequence', 'adapter']),\n    region: {\n      ...region,\n      refName: assembly.getCanonicalRefName(region.refName),\n    },\n    sessionId,\n  }) as Promise<string | undefined>\n}\n","import type { Feature } from '@jbrowse/core/util'\n\nconst coreFields = new Set([\n  'uniqueId',\n  'refName',\n  'source',\n  'type',\n  'start',\n  'end',\n  'strand',\n  'parent',\n  'parentId',\n  'score',\n  'subfeatures',\n  'phase',\n  '_lineHash',\n])\n\nconst retitle = {\n  id: 'ID',\n  name: 'Name',\n  alias: 'Alias',\n  parent: 'Parent',\n  target: 'Target',\n  gap: 'Gap',\n  derives_from: 'Derives_from',\n  note: 'Note',\n  description: 'Note',\n  dbxref: 'Dbxref',\n  ontology_term: 'Ontology_term',\n  is_circular: 'Is_circular',\n} as Record<string, string>\n\nfunction fmt(obj: unknown): string {\n  if (Array.isArray(obj)) {\n    return obj.map(o => fmt(o)).join(',')\n  } else if (typeof obj === 'object' && obj !== null) {\n    return JSON.stringify(obj)\n  } else {\n    return String(obj)\n  }\n}\n\nfunction formatAttributes(f: Feature, parentId?: string) {\n  const attributes = []\n  if (parentId) {\n    attributes.push(`Parent=${parentId}`)\n  }\n\n  const tags = Object.keys(f.toJSON()).filter(tag => !coreFields.has(tag))\n\n  for (const tag of tags) {\n    const val = f.get(tag)\n    if (val !== undefined && val !== null) {\n      const formattedVal = fmt(val)\n      if (formattedVal) {\n        const key = retitle[tag] || tag\n        attributes.push(`${key}=${formattedVal}`)\n      }\n    }\n  }\n  return attributes.join(';')\n}\n\nfunction formatFeat(f: Feature, parentId?: string, parentRef?: string) {\n  const strand = f.get('strand')\n  const score = f.get('score')\n  const phase = f.get('phase')\n  return [\n    f.get('refName') || parentRef,\n    f.get('source') || '.',\n    f.get('type') || '.',\n    f.get('start') + 1,\n    f.get('end'),\n    score !== undefined && score !== null ? score : '.',\n    strand === 1 ? '+' : strand === -1 ? '-' : '.',\n    phase !== undefined && phase !== null ? phase : '.',\n    formatAttributes(f, parentId),\n  ].join('\\t')\n}\nexport function formatMultiLevelFeat(\n  feature: Feature,\n  parentId?: string,\n  parentRef?: string,\n): string {\n  const featureRefName = parentRef || feature.get('refName')\n  const featureId = feature.get('id')\n  const primary = formatFeat(feature, parentId, featureRefName)\n\n  return [\n    primary,\n    ...(feature\n      .get('subfeatures')\n      ?.map(sub => formatMultiLevelFeat(sub, featureId, featureRefName)) || []),\n  ].join('\\n')\n}\n\nexport function stringifyGFF3({ features }: { features: Feature[] }) {\n  return [\n    '##gff-version 3',\n    ...features.map(f => formatMultiLevelFeat(f)),\n  ].join('\\n')\n}\n","import { lazy } from 'react'\n\nimport { types } from '@jbrowse/mobx-state-tree'\nimport Save from '@mui/icons-material/Save'\n\nimport { stringifyBED } from './saveTrackFileTypes/bed.ts'\nimport { stringifyGBK } from './saveTrackFileTypes/genbank.ts'\nimport { stringifyGFF3 } from './saveTrackFileTypes/gff3.ts'\nimport { ConfigurationReference, getConf } from '../../configuration/index.ts'\nimport { adapterConfigCacheKey } from '../../data_adapters/util.ts'\nimport { getContainingView, getEnv, getSession } from '../../util/index.ts'\nimport { isSessionModelWithConfigEditing } from '../../util/types/index.ts'\nimport { ElementId } from '../../util/types/mst.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n} from '../../configuration/index.ts'\nimport type { MenuItem } from '../../ui/index.ts'\nimport type { IAnyStateTreeNode, Instance } from '@jbrowse/mobx-state-tree'\n\nconst SaveTrackDataDlg = lazy(() => import('./components/SaveTrackData.tsx'))\n\ninterface DisplayConf {\n  displayId: string\n  type: string\n}\n\nexport function getCompatibleDisplays(self: IAnyStateTreeNode) {\n  const { pluginManager } = getEnv(self)\n  const view = getContainingView(self)\n  const viewType = pluginManager.getViewType(view.type)!\n  const compatTypes = new Set(viewType.displayTypes.map(d => d.name))\n  const displays = self.configuration.displays as AnyConfigurationModel[]\n  return displays.filter(d => compatTypes.has(d.type))\n}\n\nfunction getDisplayConf(displays: DisplayConf[], displayId: string) {\n  const displayConf = displays.find(d => d.displayId === displayId)\n  if (!displayConf) {\n    throw new Error(`could not find display config ${displayId}`)\n  }\n  return displayConf\n}\n\n/**\n * #stateModel BaseTrackModel\n * #category track\n *\n * these MST models only exist for tracks that are *shown*. they should contain\n * only UI state for the track, and have a reference to a track configuration.\n * note that multiple displayed tracks could use the same configuration.\n */\nexport function createBaseTrackModel(\n  pm: PluginManager,\n  trackType: string,\n  baseTrackConfig: AnyConfigurationSchemaType,\n) {\n  return types\n    .model(trackType, {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal(trackType),\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(baseTrackConfig),\n      /**\n       * #property\n       */\n      minimized: false,\n      /**\n       * #property\n       */\n      pinned: false,\n      /**\n       * #property\n       */\n      displays: types.array(pm.pluggableMstType('display', 'stateModel')),\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get trackId() {\n        return self.configuration.trackId as string\n      },\n      /**\n       * #getter\n       * determines which webworker to send the track to, currently based on trackId\n       */\n      get rpcSessionId() {\n        const adapter = getConf(self, 'adapter')\n        return adapter ? adapterConfigCacheKey(adapter) : this.trackId\n      },\n      /**\n       * #getter\n       */\n      get name() {\n        return getConf(self, 'name')\n      },\n      /**\n       * #getter\n       */\n      get textSearchAdapter() {\n        return getConf(self, 'textSearchAdapter')\n      },\n\n      /**\n       * #getter\n       */\n      get adapterConfig() {\n        return getConf(self, 'adapter')\n      },\n\n      /**\n       * #getter\n       */\n      get viewMenuActions(): MenuItem[] {\n        return self.displays.flatMap(d => d.viewMenuActions)\n      },\n\n      /**\n       * #getter\n       */\n      get canConfigure() {\n        const session = getSession(self)\n        const { sessionTracks, adminMode } = session\n        return (\n          isSessionModelWithConfigEditing(session) &&\n          (adminMode || sessionTracks?.find(t => t.trackId === this.trackId))\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get adapterType() {\n        const { adapterConfig } = self\n        if (!adapterConfig) {\n          throw new Error(`no adapter configuration provided for ${self.type}`)\n        }\n        const adapterType = pm.getAdapterType(adapterConfig.type)\n        if (!adapterType) {\n          throw new Error(`unknown adapter type ${adapterConfig.type}`)\n        }\n        return adapterType\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setPinned(flag: boolean) {\n        self.pinned = flag\n      },\n      /**\n       * #action\n       */\n      setMinimized(flag: boolean) {\n        self.minimized = flag\n      },\n\n      /**\n       * #action\n       */\n      showDisplay(displayId: string, initialSnapshot = {}) {\n        const displays = self.configuration.displays as DisplayConf[]\n        const displayConf = getDisplayConf(displays, displayId)\n        const displayType = pm.getDisplayType(displayConf.type)\n        if (!displayType) {\n          throw new Error(`unknown display type ${displayConf.type}`)\n        }\n        self.displays.push(\n          displayType.stateModel.create({\n            ...initialSnapshot,\n            type: displayConf.type,\n            configuration: displayId,\n          }),\n        )\n      },\n\n      /**\n       * #action\n       */\n      hideDisplay(displayId: string) {\n        const displaysToRemove = self.displays.filter(\n          d => d.configuration.displayId === displayId,\n        )\n        for (const display of displaysToRemove) {\n          self.displays.remove(display)\n        }\n        return displaysToRemove.length\n      },\n\n      /**\n       * #action\n       */\n      replaceDisplay(\n        oldDisplayId: string,\n        newDisplayId: string,\n        initialSnapshot = {},\n      ) {\n        const idx = self.displays.findIndex(\n          d => d.configuration.displayId === oldDisplayId,\n        )\n        if (idx === -1) {\n          throw new Error(\n            `could not find display id ${oldDisplayId} to replace`,\n          )\n        }\n        const displays = self.configuration.displays as DisplayConf[]\n        const displayConf = getDisplayConf(displays, newDisplayId)\n        const displayType = pm.getDisplayType(displayConf.type)\n        if (!displayType) {\n          throw new Error(`unknown display type ${displayConf.type}`)\n        }\n        self.displays.splice(idx, 1, {\n          ...initialSnapshot,\n          type: displayConf.type,\n          configuration: newDisplayId,\n        })\n      },\n    }))\n    .views(() => ({\n      saveTrackFileFormatOptions() {\n        return {\n          gff3: {\n            name: 'GFF3',\n            extension: 'gff3',\n            callback: stringifyGFF3,\n          },\n          genbank: {\n            name: 'GenBank',\n            extension: 'gbk',\n            callback: stringifyGBK,\n            helpText:\n              'Note: GenBank format export is experimental. The generated output may not fully conform to the GenBank specification and should be validated before use in production workflows.',\n          },\n          bed: {\n            name: 'BED',\n            extension: 'bed',\n            callback: stringifyBED,\n          },\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      trackMenuItems(): MenuItem[] {\n        const menuItems: MenuItem[] = self.displays.flatMap(d =>\n          d.trackMenuItems(),\n        )\n        const shownId = self.displays[0].configuration.displayId\n        const compatDisp = getCompatibleDisplays(self)\n\n        return [\n          ...menuItems,\n          {\n            label: 'Save track data',\n            icon: Save,\n            priority: 998,\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                SaveTrackDataDlg,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n          ...(compatDisp.length > 1\n            ? [\n                {\n                  type: 'subMenu' as const,\n                  label: 'Display types',\n                  priority: -1000,\n                  subMenu: compatDisp.map(d => {\n                    const displayType = pm.getDisplayType(d.type)!\n                    return {\n                      type: 'radio' as const,\n                      label: displayType.displayName,\n                      helpText: displayType.helpText,\n                      checked: d.displayId === shownId,\n                      onClick: () => {\n                        if (d.displayId !== shownId) {\n                          self.replaceDisplay(\n                            shownId,\n                            d.displayId,\n                            self.displays[0].getPortableSettings?.() ?? {},\n                          )\n                        }\n                      },\n                    }\n                  }),\n                },\n              ]\n            : []),\n        ]\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { minimized, pinned, ...rest } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(minimized ? { minimized } : {}),\n        ...(pinned ? { pinned } : {}),\n      } as typeof snap\n    })\n}\n\nexport type BaseTrackStateModel = ReturnType<typeof createBaseTrackModel>\nexport type BaseTrackModel = Instance<BaseTrackStateModel>\n","import { getSession } from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport { isAlive } from '@jbrowse/mobx-state-tree'\n\nimport type { ModificationType } from './types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { BlockSet } from '@jbrowse/core/util/blockTypes'\n\nexport interface ModificationOpts {\n  headers?: Record<string, string>\n  stopToken?: string\n  filters: string[]\n}\n\nexport async function getUniqueModifications({\n  model,\n  adapterConfig,\n  blocks,\n  opts,\n}: {\n  model: {\n    setStatusMessage: (arg: string) => void\n    effectiveRpcDriverName?: string\n  }\n  adapterConfig: AnyConfigurationModel\n  blocks: BlockSet\n  opts?: ModificationOpts\n}) {\n  const { rpcManager } = getSession(model)\n  const sessionId = getRpcSessionId(model)\n  const values = await rpcManager.call(\n    sessionId,\n    'PileupGetVisibleModifications',\n    {\n      adapterConfig,\n      sessionId,\n      regions: blocks.contentBlocks,\n      rpcDriverName: model.effectiveRpcDriverName,\n      statusCallback: (arg: string) => {\n        if (isAlive(model)) {\n          model.setStatusMessage(arg)\n        }\n      },\n      ...opts,\n    },\n  )\n  return values as {\n    modifications: ModificationType[]\n    simplexModifications: string[]\n  }\n}\n","import { useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type axisPropsFromTickScale from './axisPropsFromTickScale.ts'\n\ntype Ticks = ReturnType<typeof axisPropsFromTickScale>\n\nconst YScaleBar = observer(function YScaleBar({\n  model,\n  orientation,\n}: {\n  model: { ticks?: Ticks }\n  orientation?: string\n}) {\n  const { ticks } = model\n  const theme = useTheme()\n  if (!ticks) {\n    return null\n  }\n  const { range, values, position } = ticks\n  const bg = theme.palette.background.default\n  const fg = theme.palette.text.primary\n  const isLeft = orientation === 'left'\n  const k = isLeft ? -1 : 1\n  const range0 = range[0]! + 0.5\n  const range1 = range[1]! + 0.5\n\n  return (\n    <g\n      fill=\"none\"\n      fontSize={10}\n      fontFamily=\"sans-serif\"\n      textAnchor={isLeft ? 'end' : 'start'}\n      strokeWidth={1}\n    >\n      <path stroke={fg} d={`M${k * 6},${range0}H0.5V${range1}H${k * 6}`} />\n      {values.map((v, idx) => {\n        const pos = position(v)\n        return (\n          <g\n            key={idx}\n            transform={`translate(0,${Number.isFinite(pos) ? pos : 0})`}\n          >\n            <line stroke={fg} x2={k * 6} y1={0.5} y2={0.5} />\n            <text\n              stroke={bg}\n              strokeWidth={2.5}\n              paintOrder=\"stroke\"\n              fill={fg}\n              dy=\"0.32em\"\n              x={k * 9}\n              y={0.5}\n            >\n              {v}\n            </text>\n          </g>\n        )\n      })}\n    </g>\n  )\n})\n\nexport default YScaleBar\n","import { getType, isStateTreeNode } from '@jbrowse/mobx-state-tree'\nimport { observer } from 'mobx-react'\n\nconst HeadingComponent = observer(function HeadingComponent({\n  model,\n}: {\n  model?: {\n    target?: { type: string }\n  }\n}) {\n  const target = model?.target\n  if (target) {\n    if (target.type) {\n      return `${target.type} settings`\n    }\n    if (isStateTreeNode(target)) {\n      const type = getType(target)\n      if (type.name) {\n        return `${type.name.replace('ConfigurationSchema', '')} settings`\n      }\n    }\n  }\n  return <>Settings</>\n})\n\nexport default HeadingComponent\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport HeadingComponent from './components/HeadingComponent.tsx'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('ConfigurationEditorWidget', {})\n\nconst LazyConfigurationEditorComponent = lazy(\n  () => import('./components/ConfigurationEditor.tsx'),\n)\n\nexport default function registerConfigurationEditorWidget(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'ConfigurationEditorWidget',\n      HeadingComponent,\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: LazyConfigurationEditorComponent,\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config FromConfigAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'FromConfigAdapter',\n  {\n    /**\n     * #slot\n     */\n    features: {\n      type: 'frozen',\n      defaultValue: [],\n    },\n  },\n  { explicitlyTyped: true, implicitIdentifier: 'adapterId' },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n/**\n * #config FromConfigRegionsAdapter\n * used for specifying refNames+sizes of an assembly\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst regionsConfigSchema = ConfigurationSchema(\n  'FromConfigRegionsAdapter',\n  {\n    /**\n     * #slot\n     */\n    features: {\n      type: 'frozen',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n    implicitIdentifier: 'adapterId',\n  },\n)\nexport default regionsConfigSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n/**\n * #config FromConfigSequenceAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst sequenceConfigSchema = ConfigurationSchema(\n  'FromConfigSequenceAdapter',\n  {\n    /**\n     * #slot\n     */\n    features: {\n      type: 'frozen',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n    implicitIdentifier: 'adapterId',\n  },\n)\n\nexport default sequenceConfigSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config NcbiSequenceReportAliasAdapter\n * can read \"sequence_report.tsv\" type files from NCBI\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst NcbiSequenceReportAliasAdapterConfigSchema = ConfigurationSchema(\n  'NcbiSequenceReportAliasAdapter',\n  {\n    /**\n     * #slot\n     */\n    location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my/sequence_report.tsv',\n        locationType: 'UriLocation',\n      },\n    },\n\n    /**\n     * #slot\n     */\n    useNameOverride: {\n      type: 'boolean',\n      defaultValue: true,\n      description:\n        'forces usage of the UCSC names over the NCBI style names from a FASTA',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"NcbiSequenceReportAliasAdapter\",\n     *   \"uri\": \"sequence_report.tsv\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            location: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default NcbiSequenceReportAliasAdapterConfigSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config RefNameAliasAdapter\n * can read \"chromAliases\" type files from UCSC or any tab separated file of\n * refName aliases\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst RefNameAliasAdapter = ConfigurationSchema(\n  'RefNameAliasAdapter',\n  {\n    /**\n     * #slot\n     */\n    location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my/aliases.txt',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     * by default, the \"ref names that match the fasta\" are assumed to be in the\n     * first column (0), change this variable if needed\n     */\n    refNameColumn: {\n      type: 'number',\n      defaultValue: 0,\n    },\n\n    /**\n     * #slot\n     * refNameColumnHeaderName\n     */\n    refNameColumnHeaderName: {\n      type: 'string',\n      description:\n        'alternative to refNameColumn, instead looks at header (starts with # and finds column name)',\n      defaultValue: '',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"RefNameAliasAdapter\",\n     *   \"uri\": \"yourfile.chromAlias.txt\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            location: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default RefNameAliasAdapter\n","import { lazy } from 'react'\n\nimport Plugin from '@jbrowse/core/Plugin'\n\nimport ConfigurationEditorWidgetF from './ConfigurationEditorWidget/index.ts'\nimport FromConfigAdapterF from './FromConfigAdapter/index.ts'\nimport FromConfigRegionsAdapterF from './FromConfigRegionsAdapter/index.ts'\nimport FromConfigSequenceAdapterF from './FromConfigSequenceAdapter/index.ts'\nimport NcbiSequenceReportAliasAdapterF from './NcbiSequenceReportAliasAdapter/index.ts'\nimport RefNameAliasAdapterF from './RefNameAliasAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst LazyConfigurationEditorComponent = lazy(\n  () =>\n    import('./ConfigurationEditorWidget/components/ConfigurationEditor.tsx'),\n)\n\nexport default class ConfigurationPlugin extends Plugin {\n  name = 'ConfigurationPlugin'\n\n  install(pluginManager: PluginManager) {\n    FromConfigAdapterF(pluginManager)\n    FromConfigRegionsAdapterF(pluginManager)\n    FromConfigSequenceAdapterF(pluginManager)\n    RefNameAliasAdapterF(pluginManager)\n    ConfigurationEditorWidgetF(pluginManager)\n    NcbiSequenceReportAliasAdapterF(pluginManager)\n  }\n}\n\nexport { LazyConfigurationEditorComponent as ConfigurationEditor }\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function FromConfigAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'FromConfigAdapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./FromConfigAdapter.ts').then(r => r.default),\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n      }),\n  )\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function FromConfigRegionsAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'FromConfigRegionsAdapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./FromConfigRegionsAdapter.ts').then(r => r.default),\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n      }),\n  )\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function FromConfigSequenceAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'FromConfigSequenceAdapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./FromConfigSequenceAdapter.ts').then(r => r.default),\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n      }),\n  )\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function RefNameAliasAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'RefNameAliasAdapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./RefNameAliasAdapter.ts').then(r => r.default),\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n      }),\n  )\n}\n","import { getSession } from '@jbrowse/core/util'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { addDisposer, getSnapshot, types } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\n\nexport default function stateModelFactory(_pluginManager: PluginManager) {\n  return types\n    .model('ConfigurationEditorWidget', {\n      id: ElementId,\n      type: types.literal('ConfigurationEditorWidget'),\n    })\n    .volatile(() => ({\n      // Target is stored as volatile since it doesn't need to be serialized.\n      // The target is an MST model from track.configuration (which creates\n      // an MST model from frozen config via ConfigurationReference).\n      target: undefined as AnyConfigurationModel | undefined,\n    }))\n    .actions(self => ({\n      setTarget(newTarget: AnyConfigurationModel | undefined) {\n        self.target = newTarget\n      },\n      afterCreate() {\n        let timeout: ReturnType<typeof setTimeout> | undefined\n        // Auto-save configuration changes with 400ms debounce. The autorun\n        // reacts to any changes in the target configuration model and persists\n        // them back to the session after a short delay.\n        addDisposer(\n          self,\n          autorun(() => {\n            if (self.target) {\n              const snapshot = getSnapshot(self.target)\n              clearTimeout(timeout)\n              timeout = setTimeout(() => {\n                const session = getSession(self)\n                session.jbrowse.updateTrackConf(snapshot)\n              }, 400)\n            }\n          }),\n        )\n      },\n    }))\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function NcbiSequenceReportAliasAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'NcbiSequenceReportAliasAdapter',\n      configSchema,\n      getAdapterClass: () =>\n        import('./NcbiSequenceReportAliasAdapter.ts').then(r => r.default),\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n    })\n  })\n}\n","import type { BaseAdapter } from './BaseAdapter.ts'\nimport type { BaseFeatureDataAdapter } from './BaseFeatureDataAdapter.ts'\nimport type { BaseRefNameAliasAdapter } from './BaseRefNameAliasAdapter.ts'\nimport type { BaseSequenceAdapter } from './BaseSequenceAdapter.ts'\nimport type { BaseTextSearchAdapter } from './BaseTextSearchAdapter.ts'\nimport type { RegionsAdapter } from './RegionsAdapter.ts'\n\nexport type AnyDataAdapter =\n  | BaseAdapter\n  | BaseFeatureDataAdapter\n  | BaseRefNameAliasAdapter\n  | BaseTextSearchAdapter\n  | RegionsAdapter\n  | BaseSequenceAdapter\n\nexport function isSequenceAdapter(t: AnyDataAdapter): t is BaseSequenceAdapter {\n  return 'getRegions' in t && 'getFeatures' in t\n}\n\nexport function isRegionsAdapter(t: AnyDataAdapter): t is RegionsAdapter {\n  return 'getRegions' in t\n}\n\nexport function isFeatureAdapter(\n  t: AnyDataAdapter,\n): t is BaseFeatureDataAdapter {\n  return 'getFeatures' in t\n}\n\nexport function isRefNameAliasAdapter(t: object): t is BaseRefNameAliasAdapter {\n  return 'getRefNameAliases' in t\n}\n\nexport function isTextSearchAdapter(\n  t: AnyDataAdapter,\n): t is BaseTextSearchAdapter {\n  return 'searchIndex' in t\n}\n","import type React from 'react'\n\nimport type { SearchType } from '../data_adapters/BaseAdapter/index.ts'\nimport type TextSearchAdapterType from '../pluggableElementTypes/TextSearchAdapterType.ts'\n\nexport interface BaseResultArgs {\n  label: string\n\n  displayString?: string\n\n  renderingComponent?: React.ReactElement\n\n  matchedAttribute?: string\n\n  matchedObject?: object\n\n  textSearchAdapter?: TextSearchAdapterType\n\n  relevance?: SearchType\n\n  locString?: string\n\n  refName?: string\n\n  trackId?: string\n\n  score?: number\n\n  results?: BaseResult[]\n}\n\nexport default class BaseResult {\n  label: string\n\n  renderingComponent?: React.ReactElement\n\n  displayString?: string\n\n  matchedAttribute?: string\n\n  matchedObject?: object\n\n  textSearchAdapter?: TextSearchAdapterType\n\n  relevance?: SearchType\n\n  trackId?: string\n\n  score: number\n\n  locString?: string\n\n  results?: BaseResult[]\n\n  constructor(args: BaseResultArgs) {\n    this.label = args.label\n    this.locString = args.locString\n    this.renderingComponent = args.renderingComponent\n    this.displayString = args.displayString\n    this.matchedAttribute = args.matchedAttribute\n    this.matchedObject = args.matchedObject\n    this.textSearchAdapter = args.textSearchAdapter\n    this.relevance = args.relevance\n    this.trackId = args.trackId\n    this.score = args.score || 1\n    this.results = args.results || []\n  }\n\n  getLabel() {\n    return this.label\n  }\n\n  getDisplayString() {\n    return this.displayString || this.label\n  }\n\n  getRenderingComponent() {\n    return this.renderingComponent\n  }\n\n  getTrackId() {\n    return this.trackId\n  }\n\n  getScore() {\n    return this.score\n  }\n\n  updateScore(newScore: number) {\n    this.score = newScore\n    return this.score\n  }\n\n  getId() {\n    return `${this.getLabel()}-${this.getLocation()}-${this.getTrackId()}`\n  }\n\n  hasLocation() {\n    return !!this.locString\n  }\n\n  getLocation() {\n    return this.locString\n  }\n\n  getComboResults() {\n    return this.results\n  }\n}\n\nexport class RefSequenceResult extends BaseResult {\n  refName: string\n\n  constructor(args: BaseResultArgs) {\n    super(args)\n    this.refName = args.refName ?? ''\n  }\n\n  getLocation() {\n    return this.refName\n  }\n}\n","export function findNonSparseKeys(\n  keys: readonly string[],\n  rows: Record<string, unknown>[],\n  cb: (row: Record<string, unknown>, f: string) => unknown,\n) {\n  return keys.filter(key => rows.filter(row => cb(row, key)).length > 5)\n}\n\nexport function getRootKeys(obj: Record<string, unknown>) {\n  return Object.entries(obj)\n    .map(([key, val]) => (typeof val === 'string' ? key : ''))\n    .filter((f): f is string => !!f)\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport function hasAnyOverlap<T>(a1: T[] = [], a2: T[] = []) {\n  // shortcut case is that arrays are single entries, and are equal\n  // long case is that we use a set\n  if (a1[0] === a2[0]) {\n    return true\n  } else {\n    const s1 = new Set(a1)\n    return a2.some(a => s1.has(a))\n  }\n}\n\nexport function hasAllOverlap<T>(a1: T[] = [], a2: T[] = []) {\n  const s1 = new Set(a1)\n  return a2.every(a => s1.has(a))\n}\n\nexport function matches(\n  query: string,\n  conf: AnyConfigurationModel,\n  session: AbstractSessionModel,\n) {\n  const categories = (readConfObject(conf, 'category') || []) as string[]\n  const queryLower = query.toLowerCase()\n  return (\n    getTrackName(conf, session).toLowerCase().includes(queryLower) ||\n    categories.some(c => c.toLowerCase().includes(queryLower))\n  )\n}\n\ninterface Node {\n  children: Node[]\n  id: string\n}\n\nexport function findSubCategories(obj: Node[], paths: string[], depth = 0) {\n  let hasSubs = false\n  for (const elt of obj) {\n    if (elt.children.length) {\n      const hasSubCategories = findSubCategories(elt.children, paths, depth + 1)\n      // avoid pushing the root \"Tracks\" node by checking depth>0\n      if (hasSubCategories && depth > 0) {\n        paths.push(elt.id)\n      }\n    } else {\n      hasSubs = true\n    }\n  }\n  return hasSubs\n}\n\nexport function findTopLevelCategories(obj: Node[], paths: string[]) {\n  for (const elt of obj) {\n    if (elt.children.length) {\n      paths.push(elt.id)\n    }\n  }\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport {\n  getSession,\n  localStorageGetBoolean,\n  localStorageGetNumber,\n} from '@jbrowse/core/util'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\nimport { addDisposer, getParent, types } from '@jbrowse/mobx-state-tree'\nimport { autorun, observable } from 'mobx'\n\nimport { getRowStr } from './components/faceted/util.ts'\nimport { findNonSparseKeys, getRootKeys } from './facetedUtil.ts'\nimport { matches } from './util.ts'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nconst nonMetadataKeys = ['category', 'adapter', 'description'] as const\n\n/**\n * #stateModel FacetedModel\n */\nexport function facetedStateTreeF() {\n  return types\n    .model('FacetedModel', {\n      /**\n       * #property\n       */\n      filterText: types.optional(types.string, ''),\n      /**\n       * #property\n       */\n      showSparse: types.optional(types.boolean, () =>\n        localStorageGetBoolean('facet-showSparse', false),\n      ),\n      /**\n       * #property\n       */\n      showFilters: types.optional(types.boolean, () =>\n        localStorageGetBoolean('facet-showFilters', true),\n      ),\n\n      /**\n       * #property\n       */\n      showOptions: types.optional(types.boolean, () =>\n        localStorageGetBoolean('facet-showTableOptions', false),\n      ),\n\n      /**\n       * #property\n       */\n      panelWidth: types.optional(types.number, () =>\n        localStorageGetNumber('facet-panelWidth', 400),\n      ),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      visible: {} as Record<string, boolean>,\n      /**\n       * #volatile\n       */\n      useShoppingCart: false,\n      /**\n       * #volatile\n       */\n      filters: observable.map<string, string[]>(),\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setFilter(key: string, value: string[]) {\n        self.filters.set(key, value)\n      },\n      /**\n       * #action\n       */\n      setPanelWidth(width: number) {\n        self.panelWidth = width\n        return self.panelWidth\n      },\n      /**\n       * #action\n       */\n      setUseShoppingCart(f: boolean) {\n        self.useShoppingCart = f\n      },\n      /**\n       * #action\n       */\n      setFilterText(str: string) {\n        self.filterText = str\n      },\n      /**\n       * #action\n       */\n      setShowSparse(f: boolean) {\n        self.showSparse = f\n      },\n      /**\n       * #action\n       */\n      setShowOptions(f: boolean) {\n        self.showOptions = f\n      },\n      /**\n       * #action\n       */\n      setShowFilters(f: boolean) {\n        self.showFilters = f\n      },\n      /**\n       * #action\n       */\n      setVisible(args: Record<string, boolean>) {\n        self.visible = args\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get allTrackConfigurations() {\n        return getParent<{ allTrackConfigurations: AnyConfigurationModel[] }>(\n          self,\n        ).allTrackConfigurations\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rows() {\n        const session = getSession(self)\n        const { allTrackConfigurations, filterText } = self\n        return allTrackConfigurations\n          .filter(conf => matches(filterText, conf, session))\n          .map(\n            track =>\n              ({\n                id: track.trackId as string,\n                conf: track,\n                name: getTrackName(track, session),\n                category: readConfObject(track, 'category')?.join(\n                  ', ',\n                ) as string,\n                adapter: readConfObject(track, 'adapter')?.type as string,\n                description: readConfObject(track, 'description') as string,\n                metadata: (track.metadata || {}) as Record<string, unknown>,\n              }) as const,\n          )\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get filteredNonMetadataKeys() {\n        return self.showSparse\n          ? nonMetadataKeys\n          : findNonSparseKeys(nonMetadataKeys, self.rows, (r, f) => r[f])\n      },\n      /**\n       * #getter\n       */\n      get metadataKeys() {\n        return [...new Set(self.rows.flatMap(row => getRootKeys(row.metadata)))]\n      },\n      /**\n       * #getter\n       */\n      get filteredMetadataKeys() {\n        return self.showSparse\n          ? this.metadataKeys\n          : findNonSparseKeys(\n              this.metadataKeys,\n              self.rows,\n              // @ts-expect-error\n              (r, f) => r.metadata[f],\n            )\n      },\n      /**\n       * #getter\n       */\n      get fields() {\n        return [\n          'name',\n          ...this.filteredNonMetadataKeys,\n          ...this.filteredMetadataKeys.map(m => `metadata.${m}`),\n        ]\n      },\n      /**\n       * #getter\n       */\n      get filteredRows() {\n        const arrFilters = [...self.filters.entries()]\n          .filter(f => f[1].length > 0)\n          .map(([key, val]) => [key, new Set(val)] as const)\n        return self.rows.filter(row =>\n          arrFilters.every(([key, val]) => val.has(getRowStr(key, row))),\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function facetedVisibleAutorun() {\n              self.setVisible(\n                Object.fromEntries(self.fields.map(c => [c, true])),\n              )\n            },\n            { name: 'FacetedVisible' },\n          ),\n        )\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        filterText,\n        showSparse,\n        showFilters,\n        showOptions,\n        panelWidth,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(filterText ? { filterText } : {}),\n        ...(showSparse ? { showSparse } : {}),\n        ...(!showFilters ? { showFilters } : {}),\n        ...(showOptions ? { showOptions } : {}),\n        ...(panelWidth !== 400 ? { panelWidth } : {}),\n      } as typeof snap\n    })\n}\nexport type FacetedStateModel = ReturnType<typeof facetedStateTreeF>\nexport type FacetedModel = Instance<FacetedStateModel>\nexport type FacetedRow = FacetedModel['filteredRows'][0]\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { getEnv, getSession, notEmpty } from '@jbrowse/core/util'\n\nimport { hasAllOverlap, hasAnyOverlap } from './util.ts'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\n\nexport function filterTracks(\n  tracks: AnyConfigurationModel[],\n  self: {\n    view?: {\n      type: string\n      trackSelectorAnyOverlap?: boolean\n    }\n    assemblyNames: string[]\n  },\n) {\n  const { assemblyManager } = getSession(self)\n  const { pluginManager } = getEnv(self)\n  const { view } = self\n\n  if (!view) {\n    return []\n  }\n  const viewAssemblyNames = self.assemblyNames\n    .map(a => assemblyManager.getCanonicalAssemblyName(a))\n    .filter(notEmpty)\n  const { displayTypes } = pluginManager.getViewType(view.type)!\n  const viewDisplaysSet = new Set(\n    displayTypes.map((d: { name: string }) => d.name),\n  )\n  return tracks.filter(c => {\n    const trackConfigAssemblyNames = readConfObject(c, 'assemblyNames') as\n      | string[]\n      | undefined\n    const trackCanonicalAssemblyNames = trackConfigAssemblyNames\n      ?.map(name => assemblyManager.getCanonicalAssemblyName(name))\n      .filter(notEmpty)\n    const assemblyMatch = view.trackSelectorAnyOverlap\n      ? hasAnyOverlap(trackCanonicalAssemblyNames, viewAssemblyNames)\n      : hasAllOverlap(trackCanonicalAssemblyNames, viewAssemblyNames)\n    if (!assemblyMatch) {\n      return false\n    }\n    const trackType = pluginManager.getTrackType(c.type)!\n    return trackType.displayTypes.some(d => viewDisplaysSet.has(d.name))\n  })\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { getSession } from '@jbrowse/core/util'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\n\nimport { sortConfs } from './sortUtils.ts'\nimport { matches } from './util.ts'\n\nimport type { MinimalModel, TreeNode } from './types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { MenuItem } from '@jbrowse/core/ui'\n\nexport function generateHierarchy({\n  model,\n  trackConfs,\n  extra,\n  noCategories,\n  menuItems,\n}: {\n  model: MinimalModel\n  noCategories?: boolean\n  menuItems?: MenuItem[]\n  trackConfs: AnyConfigurationModel[]\n  extra?: string\n}): TreeNode[] {\n  const hierarchy = { children: [] as TreeNode[] } as TreeNode\n  const { filterText, activeSortTrackNames, activeSortCategories } = model\n  const session = getSession(model)\n  const confs = trackConfs.filter(conf => matches(filterText, conf, session))\n  const leafCounts = new Map<TreeNode, number>()\n  const categoryMaps = new Map<TreeNode, Map<string, TreeNode>>()\n\n  for (const conf of sortConfs(\n    confs,\n    activeSortTrackNames,\n    activeSortCategories,\n  )) {\n    const isSessionTrack = conf.trackId.endsWith('sessionTrack')\n    const baseCategories = readConfObject(conf, 'category') ?? []\n    const categories = isSessionTrack\n      ? [' Session tracks', ...baseCategories]\n      : baseCategories\n\n    let currLevel = hierarchy\n    let nestingLevel = 0\n\n    if (!noCategories) {\n      let categoryPath = ''\n      for (const [i, category_] of categories.entries()) {\n        const category = category_!\n        categoryPath = categoryPath ? `${categoryPath},${category}` : category\n\n        let categoryMap = categoryMaps.get(currLevel)\n        if (!categoryMap) {\n          categoryMap = new Map()\n          categoryMaps.set(currLevel, categoryMap)\n        }\n\n        let existing = categoryMap.get(category)\n        if (!existing) {\n          const id = extra ? `${extra}-${categoryPath}` : categoryPath\n          existing = {\n            children: [],\n            name: category,\n            id,\n            nestingLevel: i + 1,\n            menuItems,\n            type: 'category' as const,\n          } as TreeNode\n          currLevel.children.push(existing)\n          categoryMap.set(category, existing)\n        }\n        currLevel = existing\n        nestingLevel = i + 1\n      }\n    }\n\n    const leafCount = leafCounts.get(currLevel) ?? 0\n    currLevel.children.splice(leafCount, 0, {\n      id: extra ? `${extra},${conf.trackId}` : conf.trackId,\n      trackId: conf.trackId,\n      name: getTrackName(conf, session),\n      conf,\n      children: [],\n      nestingLevel: nestingLevel + 1,\n      type: 'track' as const,\n    })\n    leafCounts.set(currLevel, leafCount + 1)\n  }\n\n  return hierarchy.children\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\n\nexport function sortConfs(\n  confs: AnyConfigurationModel[],\n  sortNames: boolean,\n  sortCategories: boolean,\n) {\n  // uses readConfObject instead of getTrackName so that the undefined\n  // reference sequence track is sorted to the top\n  const ret = confs.map(c => [\n    c,\n    readConfObject(c, 'name'),\n    readConfObject(c, 'category')?.[0] || '',\n    readConfObject(c, 'category')?.[1] || '',\n    readConfObject(c, 'category')?.[2] || '',\n  ])\n  if (sortNames) {\n    ret.sort((a, b) => a[1].localeCompare(b[1]))\n  }\n  if (sortCategories) {\n    // sort up to three sub-category levels, harder to code it to go deeper\n    // than this and likely rarely used\n    ret.sort((a, b) => {\n      if (a[2] !== b[2]) {\n        return a[2].localeCompare(b[2])\n      } else if (a[3] !== b[3]) {\n        return a[3].localeCompare(b[3])\n      } else if (a[4] !== b[4]) {\n        return a[4].localeCompare(b[4])\n      }\n      return 0\n    })\n  }\n  return ret.map(a => a[0])\n}\n","import { getConf, readConfObject } from '@jbrowse/core/configuration'\nimport {\n  dedupe,\n  getSession,\n  localStorageGetItem,\n  localStorageSetItem,\n  notEmpty,\n} from '@jbrowse/core/util'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport { autorun, observable } from 'mobx'\n\nimport { facetedStateTreeF } from './facetedModel.ts'\nimport { filterTracks } from './filterTracks.ts'\nimport { generateHierarchy } from './generateHierarchy.ts'\nimport { findSubCategories, findTopLevelCategories } from './util.ts'\n\nimport type { TreeNode } from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { GridRowId } from '@mui/x-data-grid'\n\ntype MaybeAnyConfigurationModel = AnyConfigurationModel | undefined\n\ntype MaybeBoolean = boolean | undefined\n\ntype MaybeCollapsedKeys = [string, boolean][] | undefined\n\nconst defaultItemHeight = 22\nconst categoryItemHeight = 40\nconst overscan = 20\n\n// for settings that are config dependent\nfunction keyConfigPostFix() {\n  return typeof window !== 'undefined'\n    ? [\n        window.location.pathname,\n        new URLSearchParams(window.location.search).get('config'),\n      ]\n        .filter(Boolean)\n        .join('-')\n    : 'empty'\n}\n\nexport function getItemHeight(item: TreeNode) {\n  return item.type === 'category' ? categoryItemHeight : defaultItemHeight\n}\n\nfunction recentlyUsedK(assemblyNames: string[]) {\n  return ['recentlyUsedTracks', keyConfigPostFix(), assemblyNames.join(',')]\n    .filter(Boolean)\n    .join('-')\n}\n\n// this has a extra } at the end because that's how it was initially\n// released\nfunction favoritesK() {\n  return `favoriteTracks-${keyConfigPostFix()}}`\n}\n\nfunction collapsedK(assemblyNames: string[], viewType: string) {\n  return [\n    'collapsedCategories',\n    keyConfigPostFix(),\n    assemblyNames.join(','),\n    viewType,\n  ].join('-')\n}\n\nfunction sortTrackNamesK() {\n  return 'sortTrackNames'\n}\n\nfunction sortCategoriesK() {\n  return 'sortCategories'\n}\n\nfunction localStorageGetJSON<T>(key: string, defaultValue: T) {\n  const val = localStorageGetItem(key)\n  return val !== undefined && val !== null && val\n    ? (JSON.parse(val) as T)\n    : defaultValue\n}\n\nfunction localStorageSetJSON(key: string, val: unknown) {\n  if (val !== undefined && val !== null) {\n    localStorageSetItem(key, JSON.stringify(val))\n  }\n}\n\nconst MAX_RECENTLY_USED = 10\n\n/**\n * #stateModel HierarchicalTrackSelectorWidget\n */\nexport default function stateTreeFactory(pluginManager: PluginManager) {\n  return types\n    .model('HierarchicalTrackSelectorWidget', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal('HierarchicalTrackSelectorWidget'),\n\n      /**\n       * #property\n       */\n      view: types.safeReference(\n        pluginManager.pluggableMstType('view', 'stateModel'),\n      ),\n      /**\n       * #property\n       */\n      faceted: types.optional(facetedStateTreeF(), {}),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      favorites: localStorageGetJSON<string[]>(favoritesK(), []),\n      /**\n       * #volatile\n       */\n      recentlyUsed: [] as GridRowId[],\n      /**\n       * #volatile\n       */\n      selection: [] as AnyConfigurationModel[],\n      /**\n       * #volatile\n       */\n      sortTrackNames: localStorageGetJSON<MaybeBoolean>(\n        sortTrackNamesK(),\n        undefined,\n      ),\n      /**\n       * #volatile\n       */\n      sortCategories: localStorageGetJSON<MaybeBoolean>(\n        sortCategoriesK(),\n        undefined,\n      ),\n      /**\n       * #volatile\n       */\n      collapsed: observable.map<string, boolean>(),\n      /**\n       * #volatile\n       */\n      filterText: '',\n      /**\n       * #volatile\n       */\n      recentlyUsedCounter: 0,\n      /**\n       * #volatile\n       */\n      favoritesCounter: 0,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get shownTrackIds() {\n        return new Set<string>(\n          self.view?.tracks?.map(\n            (t: { configuration: { trackId: string } }) =>\n              t.configuration.trackId,\n          ),\n        )\n      },\n      /**\n       * #getter\n       */\n      get selectionSet() {\n        return new Set(self.selection)\n      },\n      /**\n       * #getter\n       */\n      get favoritesSet() {\n        return new Set(self.favorites)\n      },\n      /**\n       * #getter\n       */\n      get recentlyUsedSet() {\n        return new Set(self.recentlyUsed)\n      },\n      /**\n       * #getter\n       */\n      get assemblyNames(): string[] {\n        return self.view?.assemblyNames || []\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setSortTrackNames(val: boolean) {\n        self.sortTrackNames = val\n      },\n      /**\n       * #action\n       */\n      setSortCategories(val: boolean) {\n        self.sortCategories = val\n      },\n      /**\n       * #action\n       */\n      setSelection(elt: AnyConfigurationModel[]) {\n        self.selection = elt\n      },\n      /**\n       * #action\n       */\n      addToSelection(elt: AnyConfigurationModel[]) {\n        self.selection = dedupe([...self.selection, ...elt], e => e.trackId)\n      },\n      /**\n       * #action\n       */\n      removeFromSelection(elt: AnyConfigurationModel[]) {\n        const s = new Set(elt)\n        self.selection = self.selection.filter(f => !s.has(f))\n      },\n      /**\n       * #action\n       */\n      clearSelection() {\n        self.selection = []\n      },\n\n      /**\n       * #action\n       */\n      addToFavorites(trackId: string) {\n        self.favoritesCounter += 1\n        self.favorites = [...self.favorites, trackId]\n      },\n      /**\n       * #action\n       */\n      removeFromFavorites(trackId: string) {\n        self.favorites = self.favorites.filter(f => f !== trackId)\n      },\n      /**\n       * #action\n       */\n      clearFavorites() {\n        self.favorites = []\n      },\n\n      /**\n       * #action\n       */\n      setRecentlyUsedCounter(val: number) {\n        self.recentlyUsedCounter = val\n      },\n      /**\n       * #action\n       */\n      setRecentlyUsed(str: string[]) {\n        self.recentlyUsed = str\n      },\n      /**\n       * #action\n       */\n      setFavorites(str: string[]) {\n        self.favorites = str\n      },\n      /**\n       * #action\n       */\n      setFavoritesCounter(val: number) {\n        self.favoritesCounter = val\n      },\n      /**\n       * #action\n       */\n      addToRecentlyUsed(id: GridRowId) {\n        if (!self.recentlyUsed.includes(id)) {\n          self.recentlyUsedCounter = Math.min(\n            self.recentlyUsedCounter + 1,\n            MAX_RECENTLY_USED,\n          )\n          self.recentlyUsed =\n            self.recentlyUsed.length >= MAX_RECENTLY_USED\n              ? [...self.recentlyUsed.slice(1), id]\n              : [...self.recentlyUsed, id]\n        }\n      },\n      /**\n       * #action\n       */\n      clearRecentlyUsed() {\n        self.recentlyUsed = []\n      },\n      /**\n       * #action\n       */\n      setView(view: unknown) {\n        self.view = view\n      },\n      /**\n       * #action\n       */\n      toggleCategory(pathName: string) {\n        self.collapsed.set(pathName, !self.collapsed.get(pathName))\n      },\n      /**\n       * #action\n       */\n      setCategoryCollapsed(pathName: string, status: boolean) {\n        self.collapsed.set(pathName, status)\n      },\n      /**\n       * #action\n       */\n      expandAllCategories() {\n        self.collapsed.clear()\n      },\n      /**\n       * #action\n       */\n      setCollapsedCategories(str: [string, boolean][]) {\n        self.collapsed.replace(str)\n      },\n      /**\n       * #action\n       */\n      clearFilterText() {\n        self.filterText = ''\n      },\n      /**\n       * #action\n       */\n      setFilterText(newText: string) {\n        self.filterText = newText\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      isSelected(track: AnyConfigurationModel) {\n        return self.selectionSet.has(track)\n      },\n      /**\n       * #method\n       */\n      isFavorite(trackId: string) {\n        return self.favoritesSet.has(trackId)\n      },\n      /**\n       * #method\n       */\n      isRecentlyUsed(trackId: string) {\n        return self.recentlyUsedSet.has(trackId)\n      },\n      /**\n       * #method\n       */\n      getRefSeqTrackConf(assemblyName: string): MaybeAnyConfigurationModel {\n        const { assemblyManager } = getSession(self)\n        const assembly = assemblyManager.get(assemblyName)\n        const trackConf = assembly?.configuration.sequence\n        const viewType = pluginManager.getViewType(self.view.type)!\n        if (trackConf) {\n          for (const display of trackConf.displays) {\n            if (viewType.displayTypes.some(d => d.name === display.type)) {\n              return trackConf\n            }\n          }\n        }\n        return undefined\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get activeSortTrackNames() {\n        return (\n          self.sortTrackNames ??\n          getConf(getSession(self), ['hierarchical', 'sort', 'trackNames'])\n        )\n      },\n      /**\n       * #getter\n       */\n      get activeSortCategories() {\n        return (\n          self.sortCategories ??\n          getConf(getSession(self), ['hierarchical', 'sort', 'categories'])\n        )\n      },\n\n      /**\n       * #getter\n       * filter out tracks that don't match the current assembly/display types\n       */\n      get configAndSessionTrackConfigurations() {\n        return [\n          ...self.assemblyNames.map(a => self.getRefSeqTrackConf(a)),\n          ...filterTracks(getSession(self).tracks, self),\n        ].filter(notEmpty)\n      },\n      /**\n       * #getter\n       */\n      get allTrackConfigurations() {\n        const { connectionInstances = [] } = getSession(self)\n        return [\n          ...this.configAndSessionTrackConfigurations,\n          ...connectionInstances.flatMap(c => c.tracks),\n        ]\n      },\n\n      /**\n       * #getter\n       */\n      get allTrackConfigurationTrackIdSet() {\n        return new Map(this.allTrackConfigurations.map(t => [t.trackId, t]))\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * filters out tracks that are not in the favorites group\n       */\n      get favoriteTracks() {\n        return self.favorites\n          .filter(t => self.allTrackConfigurationTrackIdSet.has(t))\n          .map(t => self.allTrackConfigurationTrackIdSet.get(t)!)\n      },\n\n      /**\n       * #getter\n       * filters out tracks that are not in the recently used group\n       */\n      get recentlyUsedTracks() {\n        return self.recentlyUsed\n          .filter(t => self.allTrackConfigurationTrackIdSet.has(t))\n          .map(t => self.allTrackConfigurationTrackIdSet.get(t)!)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get allTracks() {\n        const { connectionInstances = [] } = getSession(self)\n        return [\n          {\n            group: 'Tracks',\n            tracks: self.configAndSessionTrackConfigurations,\n            noCategories: false,\n            menuItems: [],\n          },\n          ...connectionInstances.flatMap(c => ({\n            group: getConf(c, 'name'),\n            tracks: filterTracks(c.tracks, self),\n            noCategories: false,\n            menuItems: [],\n          })),\n        ]\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get hierarchy() {\n        return {\n          name: 'Root',\n          id: 'Root',\n          type: 'category' as const,\n          children: self.allTracks.map(s => ({\n            name: s.group,\n            id: s.group,\n            type: 'category' as const,\n            menuItems: s.menuItems,\n            nestingLevel: 0,\n            children: generateHierarchy({\n              model: self,\n              trackConfs: s.tracks,\n              extra: s.group,\n              noCategories: s.noCategories,\n            }),\n          })),\n        }\n      },\n    }))\n    .views(self => ({\n      get flattenedItems() {\n        const flatten = (items: TreeNode[], result = [] as TreeNode[]) => {\n          for (const item of items) {\n            result.push(item)\n            if (item.children.length > 0 && !self.collapsed.get(item.id)) {\n              flatten(item.children, result)\n            }\n          }\n          return result\n        }\n\n        return flatten(self.hierarchy.children)\n      },\n      get flattenedItemOffsets() {\n        const offsets: number[] = []\n        let cumulativeHeight = 0\n\n        for (let i = 0, l = this.flattenedItems.length; i < l; i++) {\n          offsets.push(cumulativeHeight)\n          cumulativeHeight += getItemHeight(this.flattenedItems[i]!)\n        }\n        return { cumulativeHeight, offsets }\n      },\n    }))\n    .views(self => ({\n      itemOffsets(height: number, scrollTop: number) {\n        const { flattenedItemOffsets } = self\n        const { cumulativeHeight, offsets } = flattenedItemOffsets\n\n        if (offsets.length === 0) {\n          return {\n            startIndex: 0,\n            endIndex: 0,\n            totalHeight: 0,\n            itemOffsets: offsets,\n          }\n        }\n\n        // Binary search to find the index at a given offset\n        const findIndexAtOffset = (offset: number) => {\n          let low = 0\n          let high = offsets.length - 1\n\n          while (low <= high) {\n            const mid = Math.floor((low + high) / 2)\n            if (\n              offsets[mid]! <= offset &&\n              (mid === offsets.length - 1 || offsets[mid + 1]! > offset)\n            ) {\n              return mid\n            } else if (offsets[mid]! < offset) {\n              low = mid + 1\n            } else {\n              high = mid - 1\n            }\n          }\n\n          return 0\n        }\n\n        const start = Math.max(0, findIndexAtOffset(scrollTop) - overscan)\n        const targetHeight = scrollTop + height + overscan * defaultItemHeight\n        const end = Math.min(\n          offsets.length - 1,\n          findIndexAtOffset(targetHeight) + overscan,\n        )\n\n        return {\n          startIndex: start,\n          endIndex: end,\n          totalHeight: cumulativeHeight,\n          itemOffsets: offsets,\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      collapseSubCategories() {\n        const paths = [] as string[]\n        findSubCategories(self.hierarchy.children, paths)\n        for (const path of paths) {\n          self.setCategoryCollapsed(path, true)\n        }\n      },\n      /**\n       * #action\n       */\n      collapseTopLevelCategories() {\n        const paths = [] as string[]\n        for (const trackGroups of self.hierarchy.children) {\n          if (trackGroups.children.length) {\n            findTopLevelCategories(trackGroups.children, paths)\n          }\n        }\n        for (const path of paths) {\n          self.setCategoryCollapsed(path, true)\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get hasAnySubcategories() {\n        return self.allTracks.some(group =>\n          group.tracks.some(t => readConfObject(t, 'category')?.length > 1),\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // this should be the first autorun to properly initialize\n        addDisposer(\n          self,\n          autorun(\n            function trackSelectorInitAutorun() {\n              const { assemblyNames, view } = self\n              self.setRecentlyUsed(\n                localStorageGetJSON<string[]>(recentlyUsedK(assemblyNames), []),\n              )\n              if (view) {\n                const lc = localStorageGetJSON<MaybeCollapsedKeys>(\n                  collapsedK(assemblyNames, view.type),\n                  undefined,\n                )\n                const r = ['hierarchical', 'defaultCollapsed']\n                const session = getSession(self)\n                if (!lc) {\n                  self.expandAllCategories()\n                  if (getConf(session, [...r, 'topLevelCategories'])) {\n                    self.collapseTopLevelCategories()\n                  }\n                  if (getConf(session, [...r, 'subCategories'])) {\n                    self.collapseSubCategories()\n                  }\n                  for (const elt of getConf(session, [...r, 'categoryNames'])) {\n                    self.setCategoryCollapsed(`Tracks-${elt}`, true)\n                  }\n                } else {\n                  self.setCollapsedCategories(lc)\n                }\n              }\n            },\n            { name: 'TrackSelectorInit' },\n          ),\n        )\n        // this should be the second autorun\n        addDisposer(\n          self,\n          autorun(\n            function trackSelectorLocalStorageAutorun() {\n              const {\n                sortTrackNames,\n                sortCategories,\n                favorites,\n                recentlyUsed,\n                assemblyNames,\n                collapsed,\n                view,\n              } = self\n              localStorageSetJSON(recentlyUsedK(assemblyNames), recentlyUsed)\n              localStorageSetJSON(favoritesK(), favorites)\n              localStorageSetJSON(sortTrackNamesK(), sortTrackNames)\n              localStorageSetJSON(sortCategoriesK(), sortCategories)\n              if (view) {\n                localStorageSetJSON(\n                  collapsedK(assemblyNames, view.type),\n                  collapsed,\n                )\n              }\n            },\n            { name: 'TrackSelectorLocalStorage' },\n          ),\n        )\n      },\n    }))\n}\n\nexport type HierarchicalTrackSelectorStateModel = ReturnType<\n  typeof stateTreeFactory\n>\nexport type HierarchicalTrackSelectorModel =\n  Instance<HierarchicalTrackSelectorStateModel>\n","import { getSnapshot, isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport {\n  BlockSet,\n  ContentBlock,\n  ElidedBlock,\n  InterRegionPaddingBlock,\n} from './blockTypes.ts'\nimport { assembleLocStringFast } from './index.ts'\nimport { intersection2 } from './range.ts'\n\nimport type { Base1DViewModel } from './calculateStaticBlocks.ts'\n\n/**\n * returns a BlockSet of which the `blocks` attribute is an array of 'dynamic\n * blocks', which are blocks representing only the regions that are visible in\n * the view right now. these are mostly used by tracks for which static blocks\n * are not feasible.\n *\n * each block is a plain JS object like:\n *   `{ refName, start, end, offsetPx, reversed? }`\n *\n * start and end are in bp, and start is always less than end, but if reversed\n * is true, startBp will be on the right side of the visible region.\n *\n * offsetPx is the number of pixels from the left edge of the view to the left\n * edge of the region\n *\n * NOTE: start, end, and offsetPx may all be fractional!\n *\n * @returns BlockSet of `{ refName, startBp, end, offset, reversed? }`\n */\nexport default function calculateDynamicBlocks(\n  model: Base1DViewModel,\n  padding = true,\n  elision = true,\n) {\n  const {\n    offsetPx,\n    displayedRegions,\n    bpPerPx,\n    width,\n    minimumBlockWidth,\n    interRegionPaddingWidth,\n  } = model\n\n  if (!width) {\n    throw new Error('view has no width, cannot calculate displayed blocks')\n  }\n\n  // Pre-calculate inverse to avoid repeated divisions\n  const invBpPerPx = 1 / bpPerPx\n  const blocks = new BlockSet()\n  let displayedRegionLeftPx = 0\n  const windowLeftPx = offsetPx\n  const windowRightPx = windowLeftPx + width\n  for (\n    let regionNumber = 0;\n    regionNumber < displayedRegions.length;\n    regionNumber++\n  ) {\n    const region = displayedRegions[regionNumber]\n    const {\n      assemblyName,\n      refName,\n      start: regionStart,\n      end: regionEnd,\n      reversed,\n    } = region!\n    const displayedRegionRightPx =\n      displayedRegionLeftPx + (regionEnd - regionStart) * invBpPerPx\n\n    const regionWidthPx = (regionEnd - regionStart) * invBpPerPx\n    const parentRegion = isStateTreeNode(region) ? getSnapshot(region) : region\n\n    const [leftPx, rightPx] = intersection2(\n      windowLeftPx,\n      windowRightPx,\n      displayedRegionLeftPx,\n      displayedRegionRightPx,\n    )\n    if (leftPx !== undefined && rightPx !== undefined) {\n      // this displayed region overlaps the view, so make a record for it\n      let start: number\n      let end: number\n      let isLeftEndOfDisplayedRegion: boolean\n      let isRightEndOfDisplayedRegion: boolean\n      let blockOffsetPx: number\n      if (reversed) {\n        start = Math.max(\n          regionStart,\n          regionEnd - (rightPx - displayedRegionLeftPx) * bpPerPx,\n        )\n        end = regionEnd - (leftPx - displayedRegionLeftPx) * bpPerPx\n        isLeftEndOfDisplayedRegion = end === regionEnd\n        isRightEndOfDisplayedRegion = start === regionStart\n        blockOffsetPx = displayedRegionLeftPx + (regionEnd - end) * invBpPerPx\n      } else {\n        start = (leftPx - displayedRegionLeftPx) * bpPerPx + regionStart\n        end = Math.min(\n          regionEnd,\n          (rightPx - displayedRegionLeftPx) * bpPerPx + regionStart,\n        )\n        isLeftEndOfDisplayedRegion = start === regionStart\n        isRightEndOfDisplayedRegion = end === regionEnd\n        blockOffsetPx =\n          displayedRegionLeftPx + (start - regionStart) * invBpPerPx\n      }\n      const widthPx = (end - start) * invBpPerPx\n      const blockData = {\n        assemblyName,\n        refName,\n        start,\n        end,\n        reversed,\n        offsetPx: blockOffsetPx,\n        parentRegion,\n        regionNumber,\n        widthPx,\n        isLeftEndOfDisplayedRegion,\n        isRightEndOfDisplayedRegion,\n        key: `${assembleLocStringFast({\n          assemblyName,\n          refName,\n          start,\n          end,\n          reversed,\n        })}-${regionNumber}${reversed ? '-reversed' : ''}`,\n      }\n\n      if (padding && blocks.length === 0 && isLeftEndOfDisplayedRegion) {\n        blocks.push(\n          new InterRegionPaddingBlock({\n            key: `${blockData.key}-beforeFirstRegion`,\n            widthPx: -offsetPx,\n            offsetPx: blockData.offsetPx + offsetPx,\n            variant: 'boundary',\n          }),\n        )\n      }\n\n      if (elision && regionWidthPx < minimumBlockWidth) {\n        blocks.push(new ElidedBlock(blockData))\n      } else {\n        blocks.push(new ContentBlock(blockData))\n      }\n\n      if (padding) {\n        // insert a inter-region padding block if we are crossing a displayed region\n        if (\n          regionWidthPx >= minimumBlockWidth &&\n          blockData.isRightEndOfDisplayedRegion &&\n          regionNumber < displayedRegions.length - 1\n        ) {\n          blocks.push(\n            new InterRegionPaddingBlock({\n              key: `${blockData.key}-rightpad`,\n              widthPx: interRegionPaddingWidth,\n              offsetPx: blockData.offsetPx + blockData.widthPx,\n            }),\n          )\n          displayedRegionLeftPx += interRegionPaddingWidth\n        }\n\n        if (\n          regionNumber === displayedRegions.length - 1 &&\n          blockData.isRightEndOfDisplayedRegion\n        ) {\n          blockOffsetPx = blockData.offsetPx + blockData.widthPx\n          blocks.push(\n            new InterRegionPaddingBlock({\n              key: `${blockData.key}-afterLastRegion`,\n              widthPx: width - blockOffsetPx + offsetPx,\n              offsetPx: blockOffsetPx,\n              variant: 'boundary',\n            }),\n          )\n        }\n      }\n    }\n    displayedRegionLeftPx += (regionEnd - regionStart) * invBpPerPx\n  }\n  return blocks\n}\n","export const f2 = 0.3\n\n// Variant rendering colors\nexport const REFERENCE_COLOR = '#ccc'\nexport const NO_CALL_COLOR = 'hsl(50,50%,50%)'\nexport const UNPHASED_COLOR = 'black'\n\n// Allele count mode colors (HSL values)\nexport const ALT_COLOR_HUE = 200\nexport const ALT_COLOR_SATURATION = 50\nexport const OTHER_ALT_COLOR = 'hsl(0,100%,20%)'\n\n// Helper to get alt color based on dosage (0-1)\nexport function getAltColorForDosage(dosage: number) {\n  const lightness = 80 - dosage * 50\n  return `hsl(${ALT_COLOR_HUE},${ALT_COLOR_SATURATION}%,${lightness}%)`\n}\n","import { Box, Button, FormControl, Typography } from '@mui/material'\n\nimport { isElectron } from '../../util/index.ts'\nimport { getBlob, storeBlobLocation } from '../../util/tracks.ts'\nimport { makeStyles } from '../../util/tss-react/index.ts'\n\nimport type {\n  BlobLocation,\n  FileLocation,\n  LocalPathLocation,\n} from '../../util/types/index.ts'\n\nfunction isLocalPathLocation(loc: FileLocation): loc is LocalPathLocation {\n  return 'localPath' in loc\n}\n\nfunction isBlobLocation(loc: FileLocation): loc is BlobLocation {\n  return 'blobId' in loc\n}\n\nconst useStyles = makeStyles()(theme => ({\n  filename: {\n    marginLeft: theme.spacing(1),\n  },\n}))\n\nfunction LocalFileChooser({\n  location,\n  setLocation,\n}: {\n  location?: FileLocation\n  setLocation: (arg: FileLocation) => void\n}) {\n  const { classes } = useStyles()\n  const filename =\n    location &&\n    ((isBlobLocation(location) && location.name) ||\n      (isLocalPathLocation(location) && location.localPath))\n\n  const needToReload =\n    location && isBlobLocation(location) && !getBlob(location.blobId)\n\n  return (\n    <Box display=\"flex\" flexDirection=\"row\" alignItems=\"center\">\n      <Box>\n        <FormControl fullWidth>\n          <Button variant=\"outlined\" component=\"label\">\n            Choose File\n            <input\n              type=\"file\"\n              hidden\n              onChange={({ target }) => {\n                const file = target.files?.[0]\n                if (file) {\n                  if (isElectron) {\n                    const { webUtils } = window.require('electron')\n                    setLocation({\n                      localPath: webUtils.getPathForFile(file),\n                      locationType: 'LocalPathLocation',\n                    })\n                  } else {\n                    // @ts-expect-error\n                    setLocation(storeBlobLocation({ blob: file }))\n                  }\n                }\n              }}\n            />\n          </Button>\n        </FormControl>\n      </Box>\n      <Box>\n        <Typography\n          component=\"span\"\n          className={classes.filename}\n          color={filename ? 'initial' : 'textSecondary'}\n        >\n          {filename || 'No file chosen'}\n        </Typography>\n        {needToReload ? (\n          <Typography color=\"error\">(need to reload)</Typography>\n        ) : null}\n      </Box>\n    </Box>\n  )\n}\n\nexport default LocalFileChooser\n","import { TextField } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { isUriLocation } from '../../util/types/index.ts'\n\nimport type { FileLocation } from '../../util/types/index.ts'\n\nconst UrlChooser = observer(function UrlChooser({\n  location,\n  label,\n  style,\n  setLocation,\n}: {\n  location?: FileLocation\n  label?: string\n  style?: Record<string, unknown>\n  setLocation: (arg: FileLocation) => void\n}) {\n  return (\n    <TextField\n      variant=\"outlined\"\n      fullWidth\n      defaultValue={location && isUriLocation(location) ? location.uri : ''}\n      label={label || 'Enter URL'}\n      style={style}\n      onChange={event => {\n        setLocation({\n          uri: event.target.value.trim(),\n          locationType: 'UriLocation',\n        })\n      }}\n      slotProps={{\n        htmlInput: {\n          'data-testid': 'urlInput',\n        },\n      }}\n    />\n  )\n})\n\nexport default UrlChooser\n","import LocalFileChooser from './LocalFileChooser.tsx'\nimport UrlChooser from './UrlChooser.tsx'\n\nimport type { BaseInternetAccountModel } from '../../pluggableElementTypes/index.ts'\nimport type { FileLocation } from '../../util/types/index.ts'\n\nexport default function LocationInput({\n  toggleButtonValue,\n  selectedAccount,\n  location,\n  inline,\n  setLocation,\n}: {\n  toggleButtonValue: string\n  selectedAccount?: BaseInternetAccountModel\n  location?: FileLocation\n  inline?: boolean\n  setLocation: (arg: FileLocation) => void\n}) {\n  if (selectedAccount?.SelectorComponent) {\n    return (\n      <selectedAccount.SelectorComponent\n        setLocation={setLocation}\n        selectedAccount={selectedAccount}\n      />\n    )\n  }\n  if (toggleButtonValue === 'url') {\n    return (\n      <UrlChooser\n        location={location}\n        setLocation={setLocation}\n        label={selectedAccount?.selectorLabel}\n        style={inline ? { margin: 0 } : undefined}\n      />\n    )\n  }\n  if (toggleButtonValue === 'file') {\n    return <LocalFileChooser location={location} setLocation={setLocation} />\n  }\n  return null\n}\n","import { useState } from 'react'\n\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown'\nimport {\n  Menu,\n  MenuItem,\n  ToggleButton,\n  ToggleButtonGroup,\n  Tooltip,\n} from '@mui/material'\n\nimport type { BaseInternetAccountModel } from '../../pluggableElementTypes/index.ts'\nimport type { ToggleButtonProps } from '@mui/material'\n\nfunction shorten(str: string, len: number) {\n  return str.length > len ? `${str.slice(0, len)}` : str\n}\n\nfunction ToggleButtonWithTooltip(props: ToggleButtonProps) {\n  const { title, children, ...other } = props\n  return (\n    <Tooltip title={title || ''}>\n      <ToggleButton {...other}>{children}</ToggleButton>\n    </Tooltip>\n  )\n}\n\nconst isAdminMode = () =>\n  new URLSearchParams(window.location.search).get('adminKey') !== null\n\nfunction HiddenAccountsMenu({\n  anchorEl,\n  hiddenAccountIds,\n  accountMap,\n  onClose,\n  onSelect,\n}: {\n  anchorEl: HTMLElement | null\n  hiddenAccountIds: string[]\n  accountMap: Record<string, BaseInternetAccountModel>\n  onClose: () => void\n  onSelect: (id: string) => void\n}) {\n  if (!anchorEl) {\n    return null\n  }\n  return (\n    <Menu\n      open\n      anchorEl={anchorEl}\n      anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n      transformOrigin={{ vertical: 'top', horizontal: 'center' }}\n      onClose={onClose}\n    >\n      {hiddenAccountIds.map(id => (\n        <MenuItem\n          key={id}\n          value={id}\n          onClick={() => {\n            onSelect(id)\n          }}\n        >\n          {accountMap[id]!.name}\n        </MenuItem>\n      ))}\n    </Menu>\n  )\n}\n\nexport default function SourceTypeSelector({\n  value,\n  shownAccountIds,\n  hiddenAccountIds,\n  accountMap,\n  onChange,\n  onHiddenAccountSelect,\n}: {\n  value: string\n  shownAccountIds: string[]\n  hiddenAccountIds: string[]\n  accountMap: Record<string, BaseInternetAccountModel>\n  onChange: (event: React.MouseEvent, newValue: string | null) => void\n  onHiddenAccountSelect: (id: string) => void\n}) {\n  const [anchorEl, setAnchorEl] = useState<HTMLElement | null>(null)\n\n  return (\n    <>\n      <ToggleButtonGroup\n        value={value}\n        exclusive\n        size=\"small\"\n        onChange={onChange}\n        aria-label=\"file, url, or account picker\"\n      >\n        {isAdminMode() ? null : (\n          <ToggleButton size=\"small\" value=\"file\" aria-label=\"local file\">\n            File\n          </ToggleButton>\n        )}\n        <ToggleButton size=\"small\" value=\"url\" aria-label=\"url\">\n          URL\n        </ToggleButton>\n        {shownAccountIds.map(id => {\n          const account = accountMap[id]!\n          const { toggleContents, name: accountName } = account\n          const label =\n            typeof toggleContents === 'string'\n              ? shorten(toggleContents, 5)\n              : toggleContents || shorten(accountName, 5)\n          return (\n            <ToggleButtonWithTooltip key={id} value={id} title={accountName}>\n              {label}\n            </ToggleButtonWithTooltip>\n          )\n        })}\n        {hiddenAccountIds.length > 0 ? (\n          <ToggleButton\n            value=\"more\"\n            onClick={event => {\n              setAnchorEl(event.target as HTMLElement)\n            }}\n            selected={false}\n          >\n            More\n            <ArrowDropDownIcon />\n          </ToggleButton>\n        ) : null}\n      </ToggleButtonGroup>\n      <HiddenAccountsMenu\n        anchorEl={anchorEl}\n        hiddenAccountIds={hiddenAccountIds}\n        accountMap={accountMap}\n        onClose={() => {\n          setAnchorEl(null)\n        }}\n        onSelect={id => {\n          onHiddenAccountSelect(id)\n          setAnchorEl(null)\n        }}\n      />\n    </>\n  )\n}\n","import { useLocalStorage } from '../../util/index.ts'\nimport { isAppRootModel } from '../../util/types/index.ts'\n\nimport type { AbstractRootModel } from '../../util/types/index.ts'\n\nconst NUM_SHOWN = 2\n\nexport default function useInternetAccounts(rootModel?: AbstractRootModel) {\n  const [recentlyUsed, setRecentlyUsed] = useLocalStorage(\n    'fileSelector-recentlyUsedInternetAccounts',\n    [] as string[],\n  )\n\n  const accounts = isAppRootModel(rootModel)\n    ? rootModel.internetAccounts.filter(\n        f => f.type !== 'HTTPBasicInternetAccount',\n      )\n    : []\n\n  const accountMap = Object.fromEntries(\n    accounts.map(a => [a.internetAccountId, a]),\n  )\n  const sortedIds = [...new Set(accounts.map(s => s.internetAccountId))].sort(\n    (a, b) => recentlyUsed.indexOf(a) - recentlyUsed.indexOf(b),\n  )\n\n  return {\n    accountMap,\n    shownAccountIds: sortedIds.slice(0, NUM_SHOWN),\n    hiddenAccountIds: sortedIds.slice(NUM_SHOWN),\n    recentlyUsed,\n    setRecentlyUsed,\n  }\n}\n","import { useCallback, useEffect, useState } from 'react'\n\nimport { Box, FormGroup, FormHelperText, InputLabel } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport LocationInput from './LocationInput.tsx'\nimport SourceTypeSelector from './SourceTypeSelector.tsx'\nimport useInternetAccounts from './useInternetAccounts.ts'\nimport { notEmpty } from '../../util/index.ts'\nimport { isUriLocation } from '../../util/types/index.ts'\n\nimport type { AbstractRootModel, FileLocation } from '../../util/types/index.ts'\n\nfunction getInitialToggleValue(location?: FileLocation) {\n  if (\n    location &&\n    'internetAccountId' in location &&\n    location.internetAccountId\n  ) {\n    return location.internetAccountId\n  }\n  return !location || isUriLocation(location) ? 'url' : 'file'\n}\n\nconst FileSelector = observer(function FileSelector({\n  inline,\n  location,\n  name,\n  description,\n  rootModel,\n  setLocation,\n}: {\n  location?: FileLocation\n  name?: string\n  description?: string\n  inline?: boolean\n  rootModel?: AbstractRootModel\n  setLocation: (param: FileLocation) => void\n  setName?: (str: string) => void\n}) {\n  const [toggleButtonValue, setToggleButtonValue] = useState(() =>\n    getInitialToggleValue(location),\n  )\n\n  const {\n    accountMap,\n    shownAccountIds,\n    hiddenAccountIds,\n    recentlyUsed,\n    setRecentlyUsed,\n  } = useInternetAccounts(rootModel)\n\n  const selectedAccount = accountMap[toggleButtonValue]\n\n  const setLocationWithAccount = useCallback(\n    (loc: FileLocation) => {\n      setLocation({\n        ...loc,\n        ...(selectedAccount && isUriLocation(loc)\n          ? { internetAccountId: selectedAccount.internetAccountId }\n          : {}),\n      })\n    },\n    [setLocation, selectedAccount],\n  )\n\n  useEffect(() => {\n    if (\n      selectedAccount &&\n      isUriLocation(location) &&\n      location.internetAccountId !== selectedAccount.internetAccountId\n    ) {\n      setLocationWithAccount(location)\n    }\n  }, [location, selectedAccount, setLocationWithAccount])\n\n  const selectSourceType = useCallback(\n    (newValue: string | null) => {\n      setRecentlyUsed([\n        ...new Set([newValue, ...recentlyUsed].filter(notEmpty)),\n      ])\n      if (newValue) {\n        setToggleButtonValue(newValue)\n      }\n      if (isUriLocation(location)) {\n        setLocationWithAccount(location)\n      }\n    },\n    [location, recentlyUsed, setRecentlyUsed, setLocationWithAccount],\n  )\n\n  return (\n    <>\n      <Box display=\"flex\">\n        <InputLabel shrink>{name}</InputLabel>\n      </Box>\n      <FormGroup>\n        <Box display=\"flex\" flexDirection={inline ? 'row' : 'column'} gap={0.5}>\n          <SourceTypeSelector\n            value={toggleButtonValue}\n            shownAccountIds={shownAccountIds}\n            hiddenAccountIds={hiddenAccountIds}\n            accountMap={accountMap}\n            onChange={(_event, newValue) => {\n              selectSourceType(newValue)\n            }}\n            onHiddenAccountSelect={selectSourceType}\n          />\n          <LocationInput\n            toggleButtonValue={toggleButtonValue}\n            selectedAccount={selectedAccount}\n            location={location}\n            inline={inline}\n            setLocation={setLocationWithAccount}\n          />\n        </Box>\n      </FormGroup>\n      <FormHelperText>{description}</FormHelperText>\n    </>\n  )\n})\n\nexport default FileSelector\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Alert, Tooltip } from '@mui/material'\n\nimport type { AlertColor } from '@mui/material'\n\nconst useStyles = makeStyles()({\n  ellipses: {\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n  },\n  content: {\n    textOverflow: 'ellipsis',\n    overflow: 'hidden',\n    whiteSpace: 'nowrap',\n    maxWidth: '80%',\n    textAlign: 'center',\n  },\n})\n\nexport default function BlockMsg({\n  message,\n  severity,\n  action,\n}: {\n  message: string\n  severity?: AlertColor\n  action?: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  return (\n    <Alert\n      severity={severity}\n      action={action}\n      classes={{\n        message: classes.ellipses,\n      }}\n      onMouseDown={event => {\n        event.stopPropagation()\n      }}\n      onClick={event => {\n        // avoid clicks on block messages from turning into double-click zoom\n        event.stopPropagation()\n      }}\n    >\n      <Tooltip title={message}>\n        <div className={classes.content}>{message}</div>\n      </Tooltip>\n    </Alert>\n  )\n}\n","import type { Region, ViewSnap } from './index.ts'\n\nexport interface BpOffset {\n  refName?: string\n  index: number\n  offset: number\n  start?: number\n  end?: number\n}\n\nfunction lengthBetween(self: ViewSnap, start: BpOffset, end: BpOffset) {\n  let bpSoFar = 0\n  const { displayedRegions } = self\n  if (start.index === end.index) {\n    bpSoFar += end.offset - start.offset\n  } else {\n    const s = displayedRegions[start.index]!\n    bpSoFar += s.end - s.start - start.offset\n    if (end.index - start.index >= 2) {\n      for (let i = start.index + 1, l = end.index; i < l; i++) {\n        const region = displayedRegions[i]!\n        const len = region.end - region.start\n        bpSoFar += len\n      }\n    }\n    bpSoFar += end.offset\n  }\n  return bpSoFar\n}\n\nexport function moveTo(\n  self: ViewSnap & {\n    zoomTo: (arg: number) => number\n    scrollTo: (arg: number) => void\n  },\n  start?: BpOffset,\n  end?: BpOffset,\n) {\n  if (!start || !end) {\n    return\n  }\n  const {\n    width,\n    interRegionPaddingWidth,\n    displayedRegions,\n    bpPerPx,\n    minimumBlockWidth,\n  } = self\n\n  const len = lengthBetween(self, start, end)\n  let numBlocksWideEnough = 0\n  for (let i = start.index, l = end.index; i < l; i++) {\n    const r = displayedRegions[i]!\n    if ((r.end - r.start) / bpPerPx > minimumBlockWidth) {\n      numBlocksWideEnough++\n    }\n  }\n\n  const targetBpPerPx =\n    len / (width - interRegionPaddingWidth * numBlocksWideEnough)\n  const newBpPerPx = self.zoomTo(targetBpPerPx)\n\n  // If our target bpPerPx was smaller than the allowed minBpPerPx, adjust\n  // the scroll so the requested range is in the middle of the screen\n  let extraBp = 0\n  if (targetBpPerPx < newBpPerPx) {\n    extraBp = ((newBpPerPx - targetBpPerPx) * self.width) / 2\n  }\n\n  let bpToStart = -extraBp\n  for (let i = 0, l = displayedRegions.length; i < l; i++) {\n    const region = displayedRegions[i]!\n    if (start.index === i) {\n      bpToStart += start.offset\n      break\n    } else {\n      bpToStart += region.end - region.start\n    }\n  }\n\n  const scrollPos = Math.round(bpToStart / self.bpPerPx)\n  self.scrollTo(scrollPos)\n}\n\nfunction coord(r: Region, bp: number) {\n  return Math.floor(r.reversed ? r.end - bp : r.start + bp) + 1\n}\n\n// manual return type since getSnapshot hard to infer here\nexport function pxToBp(\n  self: ViewSnap,\n  px: number,\n): {\n  coord: number\n  index: number\n  refName: string\n  oob: boolean\n  assemblyName: string\n  offset: number\n  start: number\n  end: number\n  reversed?: boolean\n} {\n  let bpSoFar = 0\n  const {\n    bpPerPx,\n    offsetPx,\n    displayedRegions,\n    interRegionPaddingWidth,\n    staticBlocks,\n  } = self\n  const blocks = staticBlocks.contentBlocks\n  const bp = (offsetPx + px) * bpPerPx\n  if (bp < 0) {\n    const r = displayedRegions[0]!\n    const snap = r\n    return {\n      // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n      ...(snap as Omit<typeof snap, symbol>),\n      oob: true,\n      coord: coord(r, bp),\n      offset: bp,\n      index: 0,\n    }\n  }\n\n  const interRegionPaddingBp = interRegionPaddingWidth * bpPerPx\n  let currBlock = 0\n\n  for (let i = 0, l = displayedRegions.length; i < l; i++) {\n    const r = displayedRegions[i]!\n    const len = r.end - r.start\n    const offset = bp - bpSoFar\n    if (len + bpSoFar > bp && bpSoFar <= bp) {\n      const snap = r\n      return {\n        // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n        ...(snap as Omit<typeof snap, symbol>),\n        oob: false,\n        offset,\n        coord: coord(r, offset),\n        index: i,\n      }\n    }\n\n    // add the interRegionPaddingWidth if the boundary is in the screen e.g. in\n    // a static block\n    if (blocks[currBlock]?.regionNumber === i) {\n      const paddingStart = bpSoFar + len\n      const paddingEnd = paddingStart + interRegionPaddingBp\n      // If bp is in the inter-region padding, use the next region's info\n      if (\n        bp >= paddingStart &&\n        bp < paddingEnd &&\n        i + 1 < displayedRegions.length\n      ) {\n        const nextR = displayedRegions[i + 1]!\n        const snap = nextR\n        return {\n          // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n          ...(snap as Omit<typeof snap, symbol>),\n          oob: false,\n          offset: 0,\n          coord: coord(nextR, 0),\n          index: i + 1,\n        }\n      }\n      bpSoFar += len + interRegionPaddingBp\n      currBlock++\n    } else {\n      bpSoFar += len\n    }\n  }\n\n  if (bp >= bpSoFar && displayedRegions.length > 0) {\n    const r = displayedRegions.at(-1)!\n    const len = r.end - r.start\n    const offset = bp - bpSoFar + len\n\n    const snap = r\n    return {\n      // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n      ...(snap as Omit<typeof snap, symbol>),\n      oob: true,\n      offset,\n      coord: coord(r, offset),\n      index: displayedRegions.length - 1,\n    }\n  }\n  return {\n    coord: 0,\n    index: 0,\n    refName: '',\n    oob: true,\n    assemblyName: '',\n    offset: 0,\n    start: 0,\n    end: 0,\n    reversed: false,\n  }\n}\n\nexport function bpToPx({\n  refName,\n  coord,\n  regionNumber,\n  self,\n}: {\n  refName: string\n  coord: number\n  regionNumber?: number\n  self: ViewSnap\n}) {\n  let bpSoFar = 0\n\n  const { interRegionPaddingWidth, bpPerPx, displayedRegions, staticBlocks } =\n    self\n  const blocks = staticBlocks.contentBlocks\n  const interRegionPaddingBp = interRegionPaddingWidth * bpPerPx\n  let currBlock = 0\n\n  let i = 0\n  for (let l = displayedRegions.length; i < l; i++) {\n    const r = displayedRegions[i]!\n    const len = r.end - r.start\n    if (\n      refName === r.refName &&\n      coord >= r.start &&\n      coord <= r.end &&\n      (regionNumber ? regionNumber === i : true)\n    ) {\n      bpSoFar += r.reversed ? r.end - coord : coord - r.start\n      break\n    }\n\n    // add the interRegionPaddingWidth if the boundary is in the screen e.g. in\n    // a static block\n    if (blocks[currBlock]?.regionNumber === i) {\n      bpSoFar += len + interRegionPaddingBp\n      currBlock++\n    } else {\n      bpSoFar += len\n    }\n  }\n  const found = displayedRegions[i]\n  if (found) {\n    return {\n      index: i,\n      offsetPx: Math.round(bpSoFar / bpPerPx),\n    }\n  }\n\n  return undefined\n}\n\nexport function bpToPxMap({\n  refName,\n  coord,\n  regionNumber,\n  self,\n}: {\n  refName: string\n  coord: number\n  regionNumber?: number\n  self: ViewSnap\n}) {\n  let bpSoFar = 0\n\n  const { interRegionPaddingWidth, bpPerPx, displayedRegions, staticBlocks } =\n    self\n  const blocks = staticBlocks.contentBlocks\n  const interRegionPaddingBp = interRegionPaddingWidth * bpPerPx\n  const map = {}\n  let currBlock = 0\n\n  let i = 0\n  for (let l = displayedRegions.length; i < l; i++) {\n    const r = displayedRegions[i]!\n    const len = r.end - r.start\n    if (\n      refName === r.refName &&\n      coord >= r.start &&\n      coord <= r.end &&\n      (regionNumber === undefined ? true : regionNumber === i)\n    ) {\n      bpSoFar += r.reversed ? r.end - coord : coord - r.start\n      break\n    }\n\n    // add the interRegionPaddingWidth if the boundary is in the screen e.g. in\n    // a static block\n    if (blocks[currBlock]?.regionNumber === i) {\n      bpSoFar += len + interRegionPaddingBp\n      currBlock++\n    } else {\n      bpSoFar += len\n    }\n  }\n  const found = displayedRegions[i]\n  if (found) {\n    return {\n      index: i,\n      offsetPx: Math.round(bpSoFar / bpPerPx),\n    }\n  }\n\n  return map\n}\n","import { CanvasSequence } from 'canvas-sequencer-ts'\n\nimport { blobToDataURL } from './blobToDataURL.ts'\nimport { createCanvas, createImageBitmap } from './offscreenCanvasPonyfill.tsx'\n\ninterface ExportSVGOptions {\n  rasterizeLayers?: boolean\n  scale?: number\n}\n\ninterface RenderToAbstractCanvasOptions {\n  exportSVG?: ExportSVGOptions\n  highResolutionScaling?: number\n}\n\ntype RenderResult =\n  | { canvasRecordedData: Record<string, unknown> }\n  | { imageData: ImageBitmap }\n  | { html: string }\n\nexport async function renderToAbstractCanvas<T extends object | undefined>(\n  width: number,\n  height: number,\n  opts: RenderToAbstractCanvasOptions,\n  cb: (ctx: CanvasRenderingContext2D) => Promise<T> | T,\n): Promise<(T extends undefined ? object : T) & RenderResult> {\n  const { exportSVG, highResolutionScaling = 1 } = opts\n\n  // Ensure minimum dimensions of 1 because creating a 0-dimension\n  // OffscreenCanvas throws \"Failed to create ImageBitmap from OffscreenCanvas\"\n  // when transferToImageBitmap is called\n  const safeWidth = Math.max(1, width)\n  const safeHeight = Math.max(1, height)\n\n  type Result = (T extends undefined ? object : T) & RenderResult\n\n  if (exportSVG) {\n    if (!exportSVG.rasterizeLayers) {\n      const fakeCtx = new CanvasSequence()\n      const callbackResult = await cb(\n        fakeCtx as unknown as CanvasRenderingContext2D,\n      )\n      return {\n        ...callbackResult,\n        canvasRecordedData: fakeCtx.toJSON() as Record<string, unknown>,\n      } as unknown as Result\n    } else {\n      const s = exportSVG.scale || highResolutionScaling\n      const canvas = createCanvas(\n        Math.ceil(safeWidth * s),\n        Math.ceil(safeHeight * s),\n      )\n      const ctx = canvas.getContext('2d')\n      if (!ctx) {\n        throw new Error('2d canvas rendering not supported on this platform')\n      }\n      if (s !== 1) {\n        ctx.scale(s, s)\n      }\n      const callbackResult = await cb(ctx)\n\n      // two methods needed for converting canvas to PNG, one for webworker\n      // offscreen canvas, one for main thread\n      return {\n        ...callbackResult,\n        html: `<image width=\"${width}\" height=\"${height}\" href=\"${\n          'convertToBlob' in canvas\n            ? await blobToDataURL(\n                await canvas.convertToBlob({\n                  type: 'image/png',\n                }),\n              )\n            : canvas.toDataURL('image/png')\n        }\" />`,\n      } as unknown as Result\n    }\n  } else {\n    const canvas = createCanvas(\n      Math.ceil(safeWidth * highResolutionScaling),\n      Math.ceil(safeHeight * highResolutionScaling),\n    )\n    const ctx = canvas.getContext('2d')\n    if (!ctx) {\n      throw new Error('2d canvas rendering not supported on this platform')\n    }\n    if (highResolutionScaling !== 1) {\n      ctx.scale(highResolutionScaling, highResolutionScaling)\n    }\n    const callbackResult = await cb(ctx)\n    return {\n      ...callbackResult,\n      imageData: await createImageBitmap(canvas),\n    } as unknown as Result\n  }\n}\n","import BaseResult from '@jbrowse/core/TextSearch/BaseResults'\nimport { dedupe, getSession } from '@jbrowse/core/util'\n\nimport type { LinearGenomeViewModel } from './LinearGenomeView/index.ts'\nimport type { SearchScope } from '@jbrowse/core/TextSearch/TextSearchManager'\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\nimport type { SearchType } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { TextSearchManager } from '@jbrowse/core/util'\n\nexport async function navToOption({\n  option,\n  model,\n  assemblyName,\n}: {\n  model: LinearGenomeViewModel\n  option: BaseResult\n  assemblyName: string\n}) {\n  const location = option.getLocation()\n  const trackId = option.getTrackId()\n  if (location) {\n    await model.navToLocString(location, assemblyName, 0.2)\n    if (trackId) {\n      model.showTrack(trackId)\n    }\n  }\n}\n\n// gets a string as input, or use stored option results from previous query,\n// then re-query and\n// 1) if it has multiple results: pop a dialog\n// 2) if it's a single result navigate to it\n// 3) else assume it's a locstring and navigate to it\nexport async function handleSelectedRegion({\n  input,\n  model,\n  assembly,\n}: {\n  input: string\n  model: LinearGenomeViewModel\n  assembly: Assembly\n}) {\n  const allRefs = assembly.allRefNamesWithLowerCase || []\n  const assemblyName = assembly.name\n  if (input.split(' ').every(entry => checkRef(entry, allRefs))) {\n    await model.navToLocString(input, assembly.name)\n  } else {\n    const searchScope = model.searchScope(assemblyName)\n    const { textSearchManager } = getSession(model)\n    const results = await fetchResults({\n      queryString: input,\n      searchType: 'exact',\n      searchScope,\n      rankSearchResults: model.rankSearchResults,\n      textSearchManager,\n      assembly,\n    })\n\n    if (results.length > 1) {\n      model.setSearchResults(results, input.toLowerCase(), assemblyName)\n    } else if (results.length === 1) {\n      await navToOption({\n        option: results[0]!,\n        model,\n        assemblyName,\n      })\n    } else {\n      await model.navToLocString(input, assemblyName)\n    }\n  }\n}\n\nexport function checkRef(str: string, allRefs: string[]) {\n  const [ref, rest] = splitLast(str, ':')\n  return (\n    allRefs.includes(str) ||\n    (allRefs.includes(ref) && !Number.isNaN(Number.parseInt(rest, 10)))\n  )\n}\n\nexport async function fetchResults({\n  queryString,\n  searchType,\n  searchScope,\n  rankSearchResults,\n  textSearchManager,\n  assembly,\n}: {\n  queryString: string\n  searchScope: SearchScope\n  rankSearchResults: (results: BaseResult[]) => BaseResult[]\n  searchType?: SearchType\n  textSearchManager?: TextSearchManager\n  assembly?: Assembly\n}) {\n  if (!textSearchManager) {\n    console.warn('No text search manager')\n  }\n\n  const textSearchResults = await textSearchManager?.search(\n    {\n      queryString,\n      searchType,\n    },\n    searchScope,\n    rankSearchResults,\n  )\n\n  const refNameResults = assembly?.allRefNames\n    ?.filter(ref => ref.toLowerCase().startsWith(queryString.toLowerCase()))\n    .slice(0, 10)\n    .map(r => new BaseResult({ label: r }))\n\n  return dedupe(\n    [...(refNameResults || []), ...(textSearchResults || [])],\n    elt => elt.getId(),\n  )\n}\n\n// splits on the last instance of a character\nexport function splitLast(str: string, split: string): [string, string] {\n  const lastIndex = str.lastIndexOf(split)\n  if (lastIndex === -1) {\n    return [str, '']\n  }\n  const before = str.slice(0, lastIndex)\n  const after = str.slice(lastIndex + 1)\n  return [before, after]\n}\n","export function blobToDataURL(blob: Blob): Promise<string> {\n  const a = new FileReader()\n  return new Promise((resolve, reject) => {\n    a.onload = e => {\n      if (e.target) {\n        resolve(e.target.result as string)\n      } else {\n        reject(new Error('unknown result reading blob from canvas'))\n      }\n    }\n    a.readAsDataURL(blob)\n  })\n}\n","import OpenInNewIcon from '@mui/icons-material/OpenInNew'\nimport { Link } from '@mui/material'\n\nimport type { LinkProps } from '@mui/material'\n\nexport default function ExternalLink(props: LinkProps) {\n  const { children, ...rest } = props\n  return (\n    <Link {...rest} target=\"_blank\" rel=\"noopener noreferrer\">\n      {children} <OpenInNewIcon fontSize=\"small\" />\n    </Link>\n  )\n}\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nconst useStyles = makeStyles()(theme => ({\n  legend: {\n    position: 'absolute',\n    right: 10,\n    top: 10,\n    background: theme.palette.background.paper,\n    padding: 3,\n    fontSize: 10,\n    pointerEvents: 'none',\n    zIndex: 100,\n    maxWidth: 200,\n  },\n  item: {\n    display: 'flex',\n    alignItems: 'center',\n    marginBottom: 1,\n    '&:last-child': {\n      marginBottom: 0,\n    },\n  },\n  colorBox: {\n    width: 12,\n    height: 12,\n    marginRight: 6,\n    flexShrink: 0,\n  },\n  label: {\n    whiteSpace: 'nowrap',\n    overflow: 'hidden',\n    textOverflow: 'ellipsis',\n  },\n}))\n\nexport interface LegendItem {\n  color?: string\n  label: string\n}\n\nconst FloatingLegend = observer(function FloatingLegend({\n  items,\n}: {\n  items: LegendItem[]\n}) {\n  const { classes } = useStyles()\n\n  if (items.length === 0) {\n    return null\n  }\n\n  return (\n    <div className={classes.legend}>\n      {items.map((item, idx) => (\n        <div key={`${item.label}-${idx}`} className={classes.item}>\n          <div\n            className={classes.colorBox}\n            style={{ backgroundColor: item.color }}\n          />\n          <span className={classes.label}>{item.label}</span>\n        </div>\n      ))}\n    </div>\n  )\n})\n\nexport default FloatingLegend\n","import { isValidElement } from 'react'\n\nimport CloseIcon from '@mui/icons-material/Close'\nimport {\n  Dialog as MUIDialog,\n  DialogTitle,\n  Divider,\n  IconButton,\n  ScopedCssBaseline,\n  ThemeProvider,\n  createTheme,\n  useTheme,\n} from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport { ErrorBoundary } from './ErrorBoundary.tsx'\nimport ErrorMessage from './ErrorMessage.tsx'\nimport SanitizedHTML from './SanitizedHTML.tsx'\nimport { makeStyles } from '../util/tss-react/index.ts'\n\nimport type { DialogProps } from '@mui/material'\n\nconst useStyles = makeStyles()(theme => ({\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500],\n  },\n  errorBox: {\n    width: 800,\n    margin: 40,\n  },\n}))\n\nfunction DialogError({ error }: { error: unknown }) {\n  const { classes } = useStyles()\n  return (\n    <div className={classes.errorBox}>\n      <ErrorMessage error={error} />\n    </div>\n  )\n}\n\nexport interface Props extends DialogProps {\n  header?: React.ReactNode\n  titleNode?: React.ReactNode\n}\n\nconst Dialog = observer(function Dialog(props: Props) {\n  const { classes } = useStyles()\n  const { titleNode, ...rest } = props\n  const { title, header, children, onClose } = rest\n  const theme = useTheme()\n\n  return (\n    <MUIDialog {...rest}>\n      <ScopedCssBaseline>\n        {isValidElement(header) ? (\n          header\n        ) : (\n          <DialogTitle>\n            {titleNode || <SanitizedHTML html={title || ''} />}\n            {onClose ? (\n              <IconButton\n                className={classes.closeButton}\n                onClick={event => {\n                  onClose(event, 'backdropClick')\n                }}\n              >\n                <CloseIcon />\n              </IconButton>\n            ) : null}\n          </DialogTitle>\n        )}\n        <Divider />\n\n        <ErrorBoundary FallbackComponent={DialogError}>\n          <ThemeProvider\n            theme={createTheme(theme, {\n              components: {\n                MuiInputBase: {\n                  styleOverrides: {\n                    input: {\n                      // xref https://github.com/GMOD/jbrowse-components/pull/3666\n                      boxSizing: 'content-box!important' as 'content-box',\n                    },\n                  },\n                },\n              },\n            })}\n          >\n            {children}\n          </ThemeProvider>\n        </ErrorBoundary>\n      </ScopedCssBaseline>\n    </MUIDialog>\n  )\n})\n\nexport default Dialog\n","import { addDisposer, isAlive } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\nimport { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { modificationData } from './shared/modificationData.ts'\n\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { AugmentedRegion, Feature } from '@jbrowse/core/util'\nimport type { IAnyStateTreeNode } from '@jbrowse/mobx-state-tree'\nimport type { IAutorunOptions } from 'mobx'\n\n// use fallback alt tag, used in situations where upper case/lower case tags\n// exist e.g. Mm/MM for base modifications\nexport function getTagAlt(feature: Feature, tag: string, alt: string) {\n  const tags = feature.get('tags')\n  return tags[tag] ?? tags[alt]\n}\n\n// orientation definitions from igv.js, see also\n// https://software.broadinstitute.org/software/igv/interpreting_pair_orientations\nexport const orientationTypes = {\n  fr: {\n    F1R2: 'LR',\n    F2R1: 'LR',\n\n    F1F2: 'LL',\n    F2F1: 'LL',\n\n    R1R2: 'RR',\n    R2R1: 'RR',\n\n    R1F2: 'RL',\n    R2F1: 'RL',\n  } as Record<string, string>,\n\n  rf: {\n    R1F2: 'LR',\n    R2F1: 'LR',\n\n    R1R2: 'LL',\n    R2R1: 'LL',\n\n    F1F2: 'RR',\n    F2F1: 'RR',\n\n    F1R2: 'RL',\n    F2R1: 'RL',\n  } as Record<string, string>,\n\n  ff: {\n    F2F1: 'LR',\n    R1R2: 'LR',\n\n    F2R1: 'LL',\n    R1F2: 'LL',\n\n    R2F1: 'RR',\n    F1R2: 'RR',\n\n    R2R1: 'RL',\n    F1F2: 'RL',\n  } as Record<string, string>,\n}\n\nexport const pairMap = {\n  LR: 'color_pair_lr',\n  LL: 'color_pair_ll',\n  RR: 'color_pair_rr',\n  RL: 'color_pair_rl',\n} as const\n\nexport function getColorWGBS(strand: number, base: string) {\n  if (strand === 1) {\n    if (base === 'C') {\n      return '#f00'\n    }\n    if (base === 'T') {\n      return '#00f'\n    }\n  } else if (strand === -1) {\n    if (base === 'G') {\n      return '#f00'\n    }\n    if (base === 'A') {\n      return '#00f'\n    }\n  }\n  return '#888'\n}\n\nexport async function fetchSequence(\n  region: AugmentedRegion,\n  adapter: BaseFeatureDataAdapter,\n) {\n  const { start, end, originalRefName, refName } = region\n\n  const feats = await firstValueFrom(\n    adapter\n      .getFeatures({\n        ...region,\n        refName: originalRefName || refName,\n        end,\n        start,\n      })\n      .pipe(toArray()),\n  )\n  return feats[0]?.get('seq')\n}\n\ntype DisplayModel = IAnyStateTreeNode & { setError?: (arg: unknown) => void }\n\nexport function createAutorun(\n  self: DisplayModel,\n  cb: () => Promise<void>,\n  opts?: IAutorunOptions,\n) {\n  addDisposer(\n    self,\n    autorun(async function sharedAlignmentsAutorun() {\n      try {\n        await cb()\n      } catch (e) {\n        if (isAlive(self)) {\n          self.setError?.(e)\n        }\n      }\n    }, opts),\n  )\n}\n\nexport function randomColor(str: string) {\n  let sum = 0\n\n  for (let i = 0; i < str.length; i++) {\n    sum += str.charCodeAt(i)\n  }\n  return `hsl(${sum * 10}, 20%, 50%)`\n}\n\nexport function getColorForModification(str: string) {\n  return modificationData[str]?.color || randomColor(str)\n}\n\nexport { modificationData } from './shared/modificationData.ts'\n","import { forwardRef, useState } from 'react'\n\nimport useMeasure from '@jbrowse/core/util/useMeasure'\nimport { InputBase, Typography, useTheme } from '@mui/material'\n\nimport { makeStyles } from '../util/tss-react/index.ts'\n\nimport type { TypographyProps } from '@mui/material'\n\ntype Variant = TypographyProps['variant']\n\ntype EditableTypographyClassKey =\n  | 'input'\n  | 'inputBase'\n  | 'inputRoot'\n  | 'inputFocused'\n\nconst useStyles = makeStyles()(theme => ({\n  input: {},\n  inputBase: {},\n  typography: {\n    top: 6,\n    left: 2,\n    position: 'absolute',\n    whiteSpace: 'nowrap',\n    visibility: 'hidden',\n  },\n  inputRoot: {\n    padding: theme.spacing(0.5),\n  },\n  inputFocused: {\n    borderStyle: 'solid',\n    borderWidth: 2,\n  },\n}))\n\ninterface Props {\n  value: string\n  setValue: (value: string) => void\n  variant: Variant\n  classes?: Partial<Record<EditableTypographyClassKey, string>>\n}\n\n// using forwardRef so that MUI Tooltip can wrap this component\nconst EditableTypography = forwardRef<HTMLDivElement, Props>(\n  function EditableTypography2(props, ref) {\n    const { value, setValue, variant, ...other } = props\n    const [ref2, { width }] = useMeasure()\n    const [editedValue, setEditedValue] = useState<string>()\n    const [inputNode, setInputNode] = useState<HTMLInputElement | null>(null)\n\n    const { classes } = useStyles(props, { props })\n    const theme = useTheme()\n\n    const val = editedValue === undefined ? value : editedValue\n\n    return (\n      <div {...other} ref={ref}>\n        <div style={{ position: 'relative' }}>\n          <Typography\n            ref={ref2}\n            component=\"span\"\n            variant={variant}\n            className={classes.typography}\n          >\n            {val}\n          </Typography>\n        </div>\n        <InputBase\n          inputRef={node => {\n            setInputNode(node)\n          }}\n          className={classes.inputBase}\n          inputProps={{\n            style: {\n              width,\n              ...(variant && variant !== 'inherit'\n                ? theme.typography[variant]\n                : {}),\n            },\n          }}\n          classes={{\n            input: classes.input,\n            root: classes.inputRoot,\n            focused: classes.inputFocused,\n          }}\n          value={val}\n          onChange={event => {\n            setEditedValue(event.target.value)\n          }}\n          onKeyDown={event => {\n            if (event.key === 'Enter') {\n              inputNode?.blur()\n            } else if (event.key === 'Escape') {\n              setEditedValue(undefined)\n              inputNode?.blur()\n            }\n          }}\n          onBlur={() => {\n            setValue(editedValue || value || '')\n            setEditedValue(undefined)\n          }}\n        />\n      </div>\n    )\n  },\n)\n\nexport default EditableTypography\n","import { Observable } from 'rxjs'\n\nimport type { StopToken } from './stopToken.ts'\nimport type { Observer } from 'rxjs'\n\n/**\n * Wrapper for rxjs Observable.create with improved error handling and aborting\n * support\n *\n * @param func - observer function, could be async\n */\nexport function ObservableCreate<T>(\n  func: (arg: Observer<T>) => void | Promise<void>,\n  _stopToken?: StopToken,\n): Observable<T> {\n  return new Observable((observer: Observer<T>) => {\n    try {\n      const ret = func(observer)\n      if (ret?.catch) {\n        ret.catch((error: unknown) => {\n          observer.error(error)\n        })\n      }\n    } catch (error) {\n      observer.error(error)\n    }\n  })\n}\n","import { Typography } from '@mui/material'\n\nimport { cx, keyframes, makeStyles } from '../util/tss-react/index.ts'\n\nimport type { TypographyProps } from '@mui/material'\n\nconst useStyles = makeStyles()({\n  dots: {\n    '&::after': {\n      display: 'inline-block',\n      content: '\"\"',\n      width: '1em',\n      textAlign: 'left',\n      animation: `${keyframes`\n      0% {\n        content: '';\n      }\n      25% {\n          content: '.';\n      }\n      50% {\n        content: '..';\n      }\n      75% {\n        content: '...';\n      }\n      `} 1.2s infinite ease-in-out`,\n    },\n  },\n})\n\ninterface Props extends TypographyProps {\n  message?: string\n  children?: never\n}\n\nexport default function LoadingEllipses({\n  message,\n  children,\n  variant = 'body2',\n  ...rest\n}: Props) {\n  const { classes } = useStyles()\n  return (\n    <Typography\n      className={cx(classes.dots, rest.className)}\n      {...rest}\n      variant={variant}\n    >\n      {message || 'Loading'}\n    </Typography>\n  )\n}\n","import Flatbush from '../flatbush/index.ts'\n\nimport type {\n  BaseLayout,\n  RectTuple,\n  Rectangle,\n  SerializedLayout,\n} from './BaseLayout.ts'\n\nexport interface Layout {\n  minX: number\n  minY: number\n  maxX: number\n  maxY: number\n  name: string\n}\n\nexport default class PrecomputedLayout<T> implements BaseLayout<T> {\n  private rectangles: Map<string, RectTuple>\n\n  private totalHeight: number\n\n  public maxHeightReached: boolean\n\n  private index?: Flatbush\n\n  private indexData: { name: string; rect: RectTuple }[] = []\n\n  constructor({ rectangles, totalHeight, maxHeightReached }: SerializedLayout) {\n    this.rectangles = new Map(Object.entries(rectangles))\n    // rectangles is of the form \"featureId\": [leftPx, topPx, rightPx, bottomPx]\n    this.totalHeight = totalHeight\n    this.maxHeightReached = maxHeightReached\n    this.buildIndex()\n  }\n\n  private buildIndex() {\n    if (this.rectangles.size === 0) {\n      return\n    }\n\n    this.index = new Flatbush(this.rectangles.size)\n    this.indexData = []\n\n    for (const [name, rect] of this.rectangles) {\n      this.index.add(rect[0], rect[1], rect[2], rect[3])\n      this.indexData.push({ name, rect })\n    }\n\n    this.index.finish()\n  }\n\n  addRect(id: string) {\n    const rect = this.rectangles.get(id)\n    if (!rect) {\n      throw new Error(`id ${id} not found in precomputed feature layout`)\n    }\n    // left, top, right, bottom\n    return rect[1]\n  }\n\n  /**\n   * returns a Map of `feature id -> rectangle`\n   */\n  getRectangles(): Map<string, RectTuple> {\n    return this.rectangles\n  }\n\n  getTotalHeight(): number {\n    return this.totalHeight\n  }\n\n  collides(_rect: Rectangle<T>, _top: number): boolean {\n    throw new Error('Method not implemented.')\n  }\n\n  getByCoord(x: number, y: number) {\n    if (!this.index) {\n      return undefined\n    }\n\n    const results = this.index.search(x, y, x + 1, y + 1)\n    if (results.length > 0) {\n      return this.indexData[results[0]!]?.name\n    }\n\n    return undefined\n  }\n\n  getByID(id: string) {\n    return this.rectangles.get(id)\n  }\n\n  addRectToBitmap(_rect: Rectangle<T>, _data: Record<string, T>): void {\n    throw new Error('Method not implemented.')\n  }\n\n  discardRange(_left: number, _right: number): void {\n    throw new Error('Method not implemented.')\n  }\n\n  serializeRegion(_region: { start: number; end: number }): SerializedLayout {\n    throw new Error('Method not implemented.')\n  }\n\n  toJSON(): SerializedLayout {\n    return {\n      rectangles: Object.fromEntries(this.rectangles),\n      totalHeight: this.totalHeight,\n      maxHeightReached: false,\n    }\n  }\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport { getEnv } from '../util/index.ts'\nimport { stringToJexlExpression } from '../util/jexlStrings.ts'\nimport { FileLocation } from '../util/types/mst.ts'\n\nimport type { IAnyComplexType, IAnyModelType } from '@jbrowse/mobx-state-tree'\n\nfunction isValidColorString(_str: string) {\n  return true\n}\nconst typeModels: Record<string, any> = {\n  stringArray: types.array(types.string),\n  stringArrayMap: types.map(types.array(types.string)),\n  numberMap: types.map(types.number),\n  boolean: types.boolean,\n  color: types.refinement('Color', types.string, isValidColorString),\n  integer: types.integer,\n  number: types.number,\n  string: types.string,\n  text: types.string,\n  fileLocation: FileLocation,\n  frozen: types.frozen(),\n}\n\n// default values we use if the defaultValue is malformed or does not work\nconst fallbackDefaults: Record<string, any> = {\n  stringArray: [],\n  stringArrayMap: {},\n  numberMap: {},\n  boolean: true,\n  color: 'black',\n  integer: 1,\n  number: 1,\n  string: '',\n  text: '',\n  fileLocation: { uri: '/path/to/resource.txt', locationType: 'UriLocation' },\n  frozen: {},\n}\n\nconst literalJSON = (self: { value: any }) => ({\n  views: {\n    get valueJSON() {\n      return self.value\n    },\n  },\n})\n\nconst objectJSON = (self: { value: any }) => ({\n  views: {\n    get valueJSON() {\n      return JSON.stringify(self.value)\n    },\n  },\n})\n\n// custom actions for modifying the value models\nconst typeModelExtensions: Record<string, (self: any) => any> = {\n  fileLocation: objectJSON,\n  number: literalJSON,\n  integer: literalJSON,\n  boolean: literalJSON,\n  frozen: objectJSON,\n  // special actions for working with stringArray slots\n  stringArray: (self: { value: string[] }) => ({\n    views: {\n      get valueJSON() {\n        return JSON.stringify(self.value)\n      },\n    },\n    actions: {\n      add(val: string) {\n        self.value.push(val)\n      },\n      removeAtIndex(idx: number) {\n        self.value.splice(idx, 1)\n      },\n      setAtIndex(idx: number, val: string) {\n        self.value[idx] = val\n      },\n    },\n  }),\n  stringArrayMap: (self: { value: Map<string, string[]> }) => ({\n    views: {\n      get valueJSON() {\n        return JSON.stringify(self.value)\n      },\n    },\n    actions: {\n      add(key: string, val: any) {\n        self.value.set(key, val)\n      },\n      remove(key: string) {\n        self.value.delete(key)\n      },\n      addToKey(key: string, val: string) {\n        const ar = self.value.get(key)\n        if (!ar) {\n          throw new Error(`${key} not found`)\n        }\n        ar.push(val)\n      },\n      removeAtKeyIndex(key: string, idx: number) {\n        const ar = self.value.get(key)\n        if (!ar) {\n          throw new Error(`${key} not found`)\n        }\n        ar.splice(idx, 1)\n      },\n      setAtKeyIndex(key: string, idx: number, val: string) {\n        const ar = self.value.get(key)\n        if (!ar) {\n          throw new Error(`${key} not found`)\n        }\n        ar[idx] = val\n      },\n    },\n  }),\n  numberMap: (self: { value: Map<string, number> }) => ({\n    views: {\n      get valueJSON() {\n        return JSON.stringify(self.value)\n      },\n    },\n    actions: {\n      add(key: string, val: number) {\n        self.value.set(key, val)\n      },\n      remove(key: string) {\n        self.value.delete(key)\n      },\n    },\n  }),\n}\n\n// const FunctionStringType = types.refinement(\n//   'FunctionString',\n//   types.string,\n//   str => functionRegexp.test(str),\n// )\n\nconst JexlStringType = types.refinement('JexlString', types.string, str =>\n  str.startsWith('jexl:'),\n)\nfunction json(value: any) {\n  return value?.toJSON ? value.toJSON() : `\"${value}\"`\n}\nexport interface ConfigSlotDefinition {\n  /** human-readable description of the slot's meaning */\n  description?: string\n  /** custom base MST model for the slot's value */\n  model?: IAnyModelType | IAnyComplexType\n  /** name of the type of slot, e.g. \"string\", \"number\", \"stringArray\" */\n  type: string\n  /** default value of the slot */\n  defaultValue: any\n  /** parameter names of the function callback */\n  contextVariable?: string[]\n}\n\n/**\n * builds a MST model for a configuration slot\n *\n * @param slotName -\n * @param  definition -\n */\nexport default function ConfigSlot(\n  slotName: string,\n  {\n    description = '',\n    model,\n    type,\n    defaultValue,\n    contextVariable = [],\n  }: ConfigSlotDefinition,\n) {\n  if (!type) {\n    throw new Error('type name required')\n  }\n  if (!model) {\n    model = typeModels[type]\n  }\n  if (!model) {\n    throw new Error(\n      `no builtin config slot type \"${type}\", and no 'model' param provided`,\n    )\n  }\n\n  if (defaultValue === undefined) {\n    throw new Error(\"no 'defaultValue' provided\")\n  }\n\n  const configSlotModelName = `${slotName.charAt(0).toUpperCase()}${slotName.slice(1)}ConfigSlot`\n  let slot = types\n    .model(configSlotModelName, {\n      name: types.literal(slotName),\n      description: types.literal(description),\n      type: types.literal(type),\n      value: types.optional(types.union(JexlStringType, model), defaultValue),\n    })\n    .volatile(() => ({\n      contextVariable,\n    }))\n    .views(self => ({\n      get isCallback() {\n        return String(self.value).startsWith('jexl:')\n      },\n    }))\n    .views(self => ({\n      get expr() {\n        return self.isCallback\n          ? stringToJexlExpression(\n              String(self.value),\n              getEnv(self).pluginManager.jexl,\n            )\n          : {\n              eval: () => self.value,\n            }\n      },\n\n      // JS representation of the value of this slot, suitable\n      // for embedding in either JSON or a JS function string.\n      // many of the data types override this in typeModelExtensions\n      get valueJSON(): any[] | Record<string, any> | string | undefined {\n        return self.isCallback ? undefined : json(self.value)\n      },\n    }))\n    .views(self => ({\n      // Resolve the slot value, evaluating jexl if needed\n      getValue(args: Record<string, unknown> = {}) {\n        const v = self.value\n        return typeof v === 'string' && v.startsWith('jexl:')\n          ? self.expr.eval(args)\n          : v\n      },\n    }))\n    .preProcessSnapshot(val =>\n      typeof val === 'object' && val.name === slotName\n        ? val\n        : {\n            name: slotName,\n            description,\n            type,\n            value: val,\n          },\n    )\n    .postProcessSnapshot(snap => {\n      if (typeof snap.value === 'object') {\n        return JSON.stringify(snap.value) !== JSON.stringify(defaultValue)\n          ? snap.value\n          : undefined\n      }\n      return snap.value !== defaultValue ? snap.value : undefined\n    })\n    .actions(self => ({\n      set(newVal: any) {\n        self.value = newVal\n      },\n      reset() {\n        self.value = defaultValue\n      },\n      convertToCallback() {\n        if (self.isCallback) {\n          return\n        }\n        self.value = `jexl:${self.valueJSON || \"''\"}`\n      },\n      convertToValue() {\n        if (!self.isCallback) {\n          return\n        }\n        // try calling it with no arguments\n        try {\n          const funcResult = self.expr.eval()\n          if (funcResult !== undefined) {\n            self.value = funcResult\n            return\n          }\n        } catch (e) {\n          /* ignore */\n        }\n        self.value = defaultValue\n        // if it is still a callback (happens if the defaultValue is a\n        // callback), then use the last-resort fallback default\n        // if defaultValue has jexl: string, run this part\n        if (!(type in fallbackDefaults)) {\n          throw new Error(`no fallbackDefault defined for type ${type}`)\n        }\n        self.value = fallbackDefaults[type]\n      },\n    }))\n\n  // if there are any type-specific extensions (views or actions)\n  //  to the slot, add those in\n  if (typeModelExtensions[type]) {\n    slot = slot.extend(typeModelExtensions[type])\n  }\n\n  const completeModel = types.optional(slot, {\n    name: slotName,\n    type,\n    description,\n    value: defaultValue,\n  })\n  Object.defineProperty(completeModel, 'isJBrowseConfigurationSlot', {\n    value: true,\n  })\n  return completeModel\n}\n","import {\n  getEnv,\n  getRoot,\n  getSnapshot,\n  isLateType,\n  isStateTreeNode,\n  isType,\n  resolveIdentifier,\n  types,\n} from '@jbrowse/mobx-state-tree'\n\nimport ConfigSlot from './configurationSlot.ts'\nimport { isConfigurationSchemaType } from './util.ts'\nimport { getContainingTrack, getSession } from '../util/index.ts'\nimport { ElementId } from '../util/types/mst.ts'\n\nimport type { ConfigSlotDefinition } from './configurationSlot.ts'\nimport type { AnyConfigurationSchemaType } from './types.ts'\nimport type { IAnyType, SnapshotOut } from '@jbrowse/mobx-state-tree'\n\nexport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n  AnyConfigurationSlot,\n  AnyConfigurationSlotType,\n} from './types.ts'\n\nfunction isEmptyObject(thing: unknown) {\n  return (\n    typeof thing === 'object' &&\n    !Array.isArray(thing) &&\n    thing !== null &&\n    Object.keys(thing).length === 0\n  )\n}\n\nfunction isEmptyArray(thing: unknown) {\n  return Array.isArray(thing) && thing.length === 0\n}\n\nexport interface ConfigurationSchemaDefinition {\n  [n: string]:\n    | ConfigSlotDefinition\n    | ConfigurationSchemaDefinition\n    | string\n    | number\n    | IAnyType\n}\n\nexport interface ConfigurationSchemaOptions<\n  BASE_SCHEMA extends AnyConfigurationSchemaType | undefined,\n  EXPLICIT_IDENTIFIER extends string | undefined,\n> {\n  explicitlyTyped?: boolean\n  explicitIdentifier?: EXPLICIT_IDENTIFIER\n  implicitIdentifier?: string | boolean\n  baseConfiguration?: BASE_SCHEMA\n\n  actions?: (self: unknown) => any\n  views?: (self: unknown) => any\n  extend?: (self: unknown) => any\n  preProcessSnapshot?: (\n    snapshot: Record<string, unknown>,\n  ) => Record<string, unknown>\n}\n\nfunction preprocessConfigurationSchemaArguments(\n  modelName: string,\n  inputSchemaDefinition: ConfigurationSchemaDefinition,\n  inputOptions: ConfigurationSchemaOptions<any, any> = {},\n) {\n  if (typeof modelName !== 'string') {\n    throw new Error(\n      'first arg must be string name of the model that this config schema goes with',\n    )\n  }\n\n  // if we have a base configuration schema that we are\n  // extending, grab the slot definitions from that\n  let schemaDefinition = inputSchemaDefinition\n  let options = inputOptions\n  if (inputOptions.baseConfiguration?.jbrowseSchemaDefinition) {\n    schemaDefinition = {\n      ...inputOptions.baseConfiguration.jbrowseSchemaDefinition,\n      ...schemaDefinition,\n    }\n    options = {\n      ...inputOptions.baseConfiguration.jbrowseSchemaOptions,\n      ...inputOptions,\n      baseConfiguration: undefined,\n    }\n  }\n  return { schemaDefinition, options }\n}\n\nfunction makeConfigurationSchemaModel<\n  DEFINITION extends ConfigurationSchemaDefinition,\n  OPTIONS extends ConfigurationSchemaOptions<any, any>,\n>(modelName: string, schemaDefinition: DEFINITION, options: OPTIONS) {\n  // now assemble the MST model of the configuration schema\n  const modelDefinition: Record<string, any> = {}\n  let identifier: string | undefined\n\n  if (options.explicitlyTyped) {\n    modelDefinition.type = types.optional(types.literal(modelName), modelName)\n  }\n\n  if (options.explicitIdentifier && options.implicitIdentifier) {\n    throw new Error(\n      `Cannot have both explicit and implicit identifiers in ${modelName}`,\n    )\n  }\n  if (options.explicitIdentifier) {\n    if (typeof options.explicitIdentifier === 'string') {\n      modelDefinition[options.explicitIdentifier] = types.identifier\n      identifier = options.explicitIdentifier\n    } else {\n      modelDefinition.id = types.identifier\n      identifier = 'id'\n    }\n  } else if (options.implicitIdentifier) {\n    if (typeof options.implicitIdentifier === 'string') {\n      modelDefinition[options.implicitIdentifier] = ElementId\n      identifier = options.implicitIdentifier\n    } else {\n      modelDefinition.id = ElementId\n      identifier = 'id'\n    }\n  }\n\n  const volatileConstants: Record<string, any> = {\n    isJBrowseConfigurationSchema: true,\n    jbrowseSchema: {\n      modelName,\n      definition: schemaDefinition,\n      options,\n    },\n  }\n  for (const [slotName, slotDefinition] of Object.entries(schemaDefinition)) {\n    if (\n      (isType(slotDefinition) && isLateType(slotDefinition)) ||\n      isConfigurationSchemaType(slotDefinition)\n    ) {\n      // this is either an MST late() type (which we assume to be a sub-configuration),\n      // or an actual sub-configuration\n      modelDefinition[slotName] = slotDefinition\n    } else if (\n      typeof slotDefinition === 'string' ||\n      typeof slotDefinition === 'number'\n    ) {\n      volatileConstants[slotName] = slotDefinition\n    } else if (typeof slotDefinition === 'object') {\n      // this is a slot definition\n      if (!slotDefinition.type) {\n        throw new Error(`no type set for config slot ${modelName}.${slotName}`)\n      }\n      try {\n        modelDefinition[slotName] = ConfigSlot(\n          slotName,\n          slotDefinition as ConfigSlotDefinition,\n        )\n      } catch (e) {\n        throw new Error(\n          `invalid config slot definition for ${modelName}.${slotName}: ${e}`,\n        )\n      }\n    } else {\n      throw new Error(\n        `invalid configuration schema definition, \"${slotName}\" must be either a valid configuration slot definition, a constant, or a nested configuration schema`,\n      )\n    }\n  }\n\n  let completeModel = types\n    .model(`${modelName}ConfigurationSchema`, modelDefinition)\n    .actions(self => ({\n      setSubschema(slotName: string, data: Record<string, unknown>) {\n        if (!isConfigurationSchemaType(modelDefinition[slotName])) {\n          throw new Error(`${slotName} is not a subschema, cannot replace`)\n        }\n        const newSchema = isStateTreeNode(data)\n          ? data\n          : modelDefinition[slotName].create(data)\n        self[slotName] = newSchema\n        return newSchema\n      },\n    }))\n\n  if (Object.keys(volatileConstants).length) {\n    completeModel = completeModel.volatile((/* self */) => volatileConstants)\n  }\n  if (options.actions) {\n    completeModel = completeModel.actions(options.actions)\n  }\n  if (options.views) {\n    completeModel = completeModel.views(options.views)\n  }\n  if (options.extend) {\n    completeModel = completeModel.extend(options.extend)\n  }\n\n  const identifierDefault = identifier ? { [identifier]: 'placeholderId' } : {}\n  const modelDefault = options.explicitlyTyped\n    ? { type: modelName, ...identifierDefault }\n    : identifierDefault\n\n  const defaultSnap = getSnapshot(completeModel.create(modelDefault))\n  completeModel = completeModel.postProcessSnapshot(snap => {\n    const newSnap: SnapshotOut<typeof completeModel> = {}\n    let matchesDefault = true\n    // let keyCount = 0\n    for (const [key, value] of Object.entries(snap)) {\n      if (matchesDefault) {\n        if (typeof defaultSnap[key] === 'object' && typeof value === 'object') {\n          if (JSON.stringify(defaultSnap[key]) !== JSON.stringify(value)) {\n            matchesDefault = false\n          }\n        } else if (defaultSnap[key] !== value) {\n          matchesDefault = false\n        }\n      }\n      if (\n        value !== undefined &&\n        volatileConstants[key] === undefined &&\n        !isEmptyObject(value) &&\n        !isEmptyArray(value)\n      ) {\n        // keyCount += 1\n        newSnap[key] = value\n      }\n    }\n    if (matchesDefault) {\n      return {}\n    }\n    return newSnap\n  })\n\n  if (options.preProcessSnapshot) {\n    completeModel = completeModel.preProcessSnapshot(options.preProcessSnapshot)\n  }\n\n  return types.optional(completeModel, modelDefault)\n}\n\nexport interface ConfigurationSchemaType<\n  DEFINITION extends ConfigurationSchemaDefinition,\n  OPTIONS extends ConfigurationSchemaOptions<any, any>,\n> extends ReturnType<typeof makeConfigurationSchemaModel<DEFINITION, OPTIONS>> {\n  isJBrowseConfigurationSchema: boolean\n  jbrowseSchemaDefinition: DEFINITION\n  jbrowseSchemaOptions: OPTIONS\n  type: string\n  [key: string]: unknown\n}\n\nexport function ConfigurationSchema<\n  DEFINITION extends ConfigurationSchemaDefinition,\n  OPTIONS extends ConfigurationSchemaOptions<BASE_SCHEMA, EXPLICIT_IDENTIFIER>,\n  BASE_SCHEMA extends AnyConfigurationSchemaType | undefined = undefined,\n  EXPLICIT_IDENTIFIER extends string | undefined = undefined,\n>(\n  modelName: string,\n  inputSchemaDefinition: DEFINITION,\n  inputOptions?: ConfigurationSchemaOptions<BASE_SCHEMA, EXPLICIT_IDENTIFIER>,\n): ConfigurationSchemaType<DEFINITION, OPTIONS> {\n  const { schemaDefinition, options } = preprocessConfigurationSchemaArguments(\n    modelName,\n    inputSchemaDefinition,\n    inputOptions,\n  )\n  const schemaType = makeConfigurationSchemaModel(\n    modelName,\n    schemaDefinition,\n    options,\n  ) as AnyConfigurationSchemaType\n  // saving a couple of jbrowse-specific things in the type object. hope nobody gets mad.\n  schemaType.isJBrowseConfigurationSchema = true\n  schemaType.jbrowseSchemaDefinition = schemaDefinition\n  schemaType.jbrowseSchemaOptions = options\n  return schemaType\n}\n\n/**\n * Creates a reference type for track configurations that:\n * - Resolves trackId strings to configuration objects at runtime\n * - Always serializes as just the trackId string in snapshots\n * - Works with both frozen tracks (plain objects) and MST model tracks\n */\nexport function TrackConfigurationReference(schemaType: IAnyType) {\n  const trackRef = types.reference(schemaType, {\n    get(id, parent) {\n      const session = getSession(parent)\n\n      // Try session.getTracksById first (works for frozen tracks)\n      let ret = session.getTracksById()[id]\n      if (!ret) {\n        // Fall back to resolveIdentifier for view-specific tracks (e.g. viewTrackConfigs)\n        // that are MST models but not in session.tracks\n        // @ts-expect-error\n        ret = resolveIdentifier(schemaType, getRoot(parent), id)\n      }\n      if (!ret) {\n        throw new Error(`Could not resolve identifier \"${id}\"`)\n      }\n      // If it's a frozen/plain object, we need to instantiate it\n      return isStateTreeNode(ret) ? ret : schemaType.create(ret, getEnv(parent))\n    },\n    set(value) {\n      return value.trackId\n    },\n  })\n\n  // Use snapshotProcessor to always serialize as just the trackId.\n  // The union allows accepting either a string ID or full object as input,\n  // but postProcessor ensures output is always just the ID string.\n  return types.snapshotProcessor(\n    types.union(\n      {\n        dispatcher: snapshot =>\n          typeof snapshot === 'string' ? trackRef : schemaType,\n      },\n      trackRef,\n      schemaType,\n    ),\n    {\n      postProcessor(snapshot) {\n        if (\n          typeof snapshot === 'object' &&\n          snapshot !== null &&\n          'trackId' in snapshot\n        ) {\n          return (snapshot as { trackId: string }).trackId\n        }\n        return snapshot\n      },\n    },\n  )\n}\n\n/**\n * Creates a reference type for display configurations that:\n * - Resolves displayId strings to configuration objects at runtime\n * - Works with frozen track configurations (where displays are plain objects)\n * - Falls back to creating a default configuration if display is not explicitly configured\n *\n * Note: Unlike TrackConfigurationReference, we don't use snapshotProcessor here\n * because it interferes with how sub-displays (like PileupDisplay) are created\n * and causes \"setConfig is not a function\" errors. Display configs are serialized\n * through the containing track's snapshot processing instead.\n */\nexport function DisplayConfigurationReference(schemaType: IAnyType) {\n  const displayRef = types.reference(schemaType, {\n    get(id, parent) {\n      const track = getContainingTrack(parent)\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      const displays = track.configuration.displays || []\n      // Find in the track's displays array (may be frozen/plain objects)\n      let ret = displays.find((d: { displayId: string }) => d.displayId === id)\n\n      // If not found in config, create a default configuration for this display type\n      // This handles the common case where displays are auto-generated from track types\n      if (!ret) {\n        // Extract display type from the displayId (format: trackId-DisplayType)\n        const displayType = `${id}`.split('-').slice(1).join('-')\n        if (displayType) {\n          // @ts-expect-error\n          ret = { displayId: `${id}`, type: displayType }\n        }\n      }\n\n      if (!ret) {\n        throw new Error(`Display configuration \"${id}\" not found`)\n      }\n      // If it's a frozen/plain object, instantiate it as an MST model\n      return isStateTreeNode(ret) ? ret : schemaType.create(ret, getEnv(parent))\n    },\n    set(value) {\n      return value.displayId\n    },\n  })\n\n  return types.union(\n    {\n      dispatcher: snapshot =>\n        typeof snapshot === 'string' ? displayRef : schemaType,\n    },\n    displayRef,\n    schemaType,\n  )\n}\n\nexport function ConfigurationReference<\n  SCHEMATYPE extends AnyConfigurationSchemaType,\n>(schemaType: SCHEMATYPE) {\n  const name = schemaType.name\n  // Check if this is a track configuration schema\n  if (\n    name.includes('TrackConfigurationSchema') &&\n    !name.includes('DisplayConfigurationSchema')\n  ) {\n    return TrackConfigurationReference(schemaType) as SCHEMATYPE\n  }\n  // Check if this is a display configuration schema\n  if (name.includes('DisplayConfigurationSchema')) {\n    return DisplayConfigurationReference(schemaType) as SCHEMATYPE\n  }\n  // Default behavior for other configuration types\n  // we cast this to SCHEMATYPE, because the reference *should* behave just\n  // like the object it points to. It won't be undefined (this is a\n  // `reference`, not a `safeReference`)\n  return types.union(types.reference(schemaType), schemaType) as SCHEMATYPE\n}\n","import { cast, types } from '@jbrowse/mobx-state-tree'\n\nimport configSchema from './baseConnectionConfig.ts'\nimport { ConfigurationReference } from '../../configuration/index.ts'\n\nimport type PluginManager from '../../PluginManager.ts'\nimport type { AnyConfigurationModel } from '../../configuration/index.ts'\n\ntype TrackConf = AnyConfigurationModel | Record<string, unknown>\n\n/**\n * #stateModel BaseConnectionModel\n */\nfunction stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .model('Connection', {\n      /**\n       * #property\n       */\n      name: types.identifier,\n      /**\n       * #property\n       */\n      tracks: types.array(pluginManager.pluggableConfigSchemaType('track')),\n\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(configSchema),\n    })\n    .actions(() => ({\n      /**\n       * #action\n       */\n      connect(_arg: AnyConfigurationModel) {},\n    }))\n    .actions(self => ({\n      afterAttach() {\n        if (self.tracks.length === 0) {\n          self.connect(self.configuration)\n        }\n      },\n      /**\n       * #action\n       */\n      addTrackConf(trackConf: TrackConf) {\n        const length = self.tracks.push(trackConf)\n        return self.tracks[length - 1]\n      },\n      /**\n       * #action\n       */\n      addTrackConfs(trackConfs: TrackConf[]) {\n        for (const trackConf of trackConfs) {\n          self.tracks.push(trackConf)\n        }\n      },\n      /**\n       * #action\n       */\n      setTrackConfs(trackConfs: AnyConfigurationModel[]) {\n        self.tracks = cast(trackConfs)\n      },\n      /**\n       * #action\n       */\n      clear() {},\n    }))\n}\n\nexport type BaseConnectionModel = ReturnType<typeof stateModelFactory>\nexport default stateModelFactory\n","import { getSnapshot, isStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nimport {\n  BlockSet,\n  ContentBlock,\n  ElidedBlock,\n  InterRegionPaddingBlock,\n} from './blockTypes.ts'\nimport { assembleLocStringFast } from './index.ts'\n\nimport type { Region } from './types/index.ts'\nimport type { Region as RegionModel } from './types/mst.ts'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport interface Base1DViewModel {\n  offsetPx: number\n  width: number\n  displayedRegions: (Region | Instance<typeof RegionModel>)[]\n  bpPerPx: number\n  minimumBlockWidth: number\n  interRegionPaddingWidth: number\n}\n\nexport default function calculateStaticBlocks(\n  model: Base1DViewModel,\n  padding = true,\n  elision = true,\n  extra = 0,\n  width = 800,\n) {\n  const {\n    offsetPx,\n    displayedRegions,\n    bpPerPx,\n    minimumBlockWidth,\n    interRegionPaddingWidth,\n    width: modelWidth,\n  } = model\n\n  const windowLeftBp = offsetPx * bpPerPx\n  const windowRightBp = (offsetPx + modelWidth) * bpPerPx\n  const blockSizePx = width\n  const blockSizeBp = Math.ceil(blockSizePx * bpPerPx)\n\n  // Pre-calculate inverse values to avoid repeated divisions\n  const invBpPerPx = 1 / bpPerPx\n  const invBlockSizeBp = 1 / blockSizeBp\n  // for each displayed region\n  let regionBpOffset = 0\n  const blocks = new BlockSet()\n  for (\n    let regionNumber = 0;\n    regionNumber < displayedRegions.length;\n    regionNumber++\n  ) {\n    const region = displayedRegions[regionNumber]!\n    const {\n      assemblyName,\n      refName,\n      start: regionStart,\n      end: regionEnd,\n      reversed,\n    } = region\n\n    const regionBlockCount = Math.ceil(\n      (regionEnd - regionStart) * invBlockSizeBp,\n    )\n    const parentRegion = isStateTreeNode(region) ? getSnapshot(region) : region\n\n    let windowRightBlockNum =\n      Math.floor((windowRightBp - regionBpOffset) * invBlockSizeBp) + extra\n    if (windowRightBlockNum >= regionBlockCount) {\n      windowRightBlockNum = regionBlockCount - 1\n    }\n\n    let windowLeftBlockNum =\n      Math.floor((windowLeftBp - regionBpOffset) * invBlockSizeBp) - extra\n    if (windowLeftBlockNum < 0) {\n      windowLeftBlockNum = 0\n    }\n\n    const regionWidthPx = (regionEnd - regionStart) * invBpPerPx\n\n    for (\n      let blockNum = windowLeftBlockNum;\n      blockNum <= windowRightBlockNum;\n      blockNum += 1\n    ) {\n      let start: number\n      let end: number\n      let isLeftEndOfDisplayedRegion: boolean\n      let isRightEndOfDisplayedRegion: boolean\n      if (reversed) {\n        start = Math.max(regionStart, regionEnd - (blockNum + 1) * blockSizeBp)\n        end = regionEnd - blockNum * blockSizeBp\n        isLeftEndOfDisplayedRegion = end === regionEnd\n        isRightEndOfDisplayedRegion = start === regionStart\n      } else {\n        start = regionStart + blockNum * blockSizeBp\n        end = Math.min(regionEnd, regionStart + (blockNum + 1) * blockSizeBp)\n        isLeftEndOfDisplayedRegion = start === regionStart\n        isRightEndOfDisplayedRegion = end === regionEnd\n      }\n      const widthPx = (end - start) * invBpPerPx\n      const blockData = {\n        assemblyName,\n        refName,\n        start,\n        end,\n        reversed,\n        offsetPx: (regionBpOffset + blockNum * blockSizeBp) * invBpPerPx,\n        parentRegion,\n        regionNumber,\n        widthPx,\n        isLeftEndOfDisplayedRegion,\n        isRightEndOfDisplayedRegion,\n        key: `${assembleLocStringFast({\n          assemblyName,\n          refName,\n          start,\n          end,\n          reversed,\n        })}-${regionNumber}${reversed ? '-reversed' : ''}`,\n      }\n\n      if (padding && regionNumber === 0 && blockNum === 0) {\n        blocks.push(\n          new InterRegionPaddingBlock({\n            key: `${blockData.key}-beforeFirstRegion`,\n            widthPx: width,\n            offsetPx: blockData.offsetPx - width,\n            variant: 'boundary',\n          }),\n        )\n      }\n\n      if (elision && regionWidthPx < minimumBlockWidth) {\n        blocks.push(new ElidedBlock(blockData))\n      } else {\n        blocks.push(new ContentBlock(blockData))\n      }\n\n      if (padding) {\n        // insert a inter-region padding block if we are crossing a displayed region\n        if (\n          regionWidthPx >= minimumBlockWidth &&\n          blockData.isRightEndOfDisplayedRegion &&\n          regionNumber < displayedRegions.length - 1\n        ) {\n          regionBpOffset += interRegionPaddingWidth * bpPerPx\n          blocks.push(\n            new InterRegionPaddingBlock({\n              key: `${blockData.key}-rightpad`,\n              widthPx: interRegionPaddingWidth,\n              offsetPx: blockData.offsetPx + blockData.widthPx,\n            }),\n          )\n        }\n        if (\n          regionNumber === displayedRegions.length - 1 &&\n          blockData.isRightEndOfDisplayedRegion\n        ) {\n          regionBpOffset += interRegionPaddingWidth * bpPerPx\n          blocks.push(\n            new InterRegionPaddingBlock({\n              key: `${blockData.key}-afterLastRegion`,\n              widthPx: width,\n              offsetPx: blockData.offsetPx + blockData.widthPx,\n              variant: 'boundary',\n            }),\n          )\n        }\n      }\n    }\n    regionBpOffset += regionEnd - regionStart\n  }\n  return blocks\n}\n","import type { ErrorInfo } from 'react'\nimport { Component } from 'react'\n\ninterface Props {\n  children: React.ReactNode\n  FallbackComponent: React.FC<{ error: unknown }>\n}\n\ninterface State {\n  error: unknown\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props)\n    this.state = { error: undefined }\n  }\n\n  componentDidCatch(error: Error, errorInfo: ErrorInfo) {\n    console.error('ErrorBoundary caught an error:', error, errorInfo)\n    this.setState({ error })\n  }\n\n  render() {\n    return this.state.error ? (\n      <this.props.FallbackComponent error={this.state.error} />\n    ) : (\n      this.props.children\n    )\n  }\n}\n\nexport { ErrorBoundary }\n","import type { SerializedFeat } from './types.tsx'\nimport type { SimpleFeatureSerialized } from '../util/index.ts'\n\nexport interface Feat {\n  start: number\n  end: number\n  type?: string\n  name?: string\n  id?: string\n}\nexport interface ParentFeat extends Feat {\n  uniqueId: string\n  strand?: number\n  refName: string\n  subfeatures?: Feat[]\n  parentId?: string\n}\nexport interface SeqState {\n  seq: string\n  upstream?: string\n  downstream?: string\n}\n\nexport interface ErrorState {\n  error: string\n}\n\nexport function stitch(\n  subfeats: { start: number; end: number }[],\n  sequence: string,\n) {\n  return subfeats.map(sub => sequence.slice(sub.start, sub.end)).join('')\n}\n\n// filter items if they have the same \"ID\" or location\nfunction getItemId(feat: Feat) {\n  return `${feat.start}-${feat.end}`\n}\n\n// filters if successive elements share same start/end\nexport function filterSuccessiveElementsWithSameStartAndEndCoord(list: Feat[]) {\n  return list.filter(\n    (item, pos, ary) => !pos || getItemId(item) !== getItemId(ary[pos - 1]!),\n  )\n}\n\nexport function revlist(list: Feat[], seqlen: number) {\n  return list\n    .map(sub => ({\n      ...sub,\n      start: seqlen - sub.end,\n      end: seqlen - sub.start,\n    }))\n    .sort((a, b) => a.start - b.start)\n}\n\nexport function calculateUTRs(cds: Feat[], exons: Feat[]) {\n  // checking length ensures the .at below are valid\n  if (!cds.length) {\n    return []\n  }\n  if (exons.length < cds.length) {\n    console.warn(\n      'exons.length less than cds.length, cant calculate UTR properly',\n      { exons, cds },\n    )\n    return []\n  }\n\n  const firstCds = cds.at(0)!\n\n  const lastCds = cds.at(-1)!\n  const firstCdsIdx = exons.findIndex(\n    exon => exon.end >= firstCds.start && exon.start <= firstCds.start,\n  )\n  const lastCdsIdx = exons.findIndex(\n    exon => exon.end >= lastCds.end && exon.start <= lastCds.end,\n  )\n  const lastCdsExon = exons[lastCdsIdx]!\n  const firstCdsExon = exons[firstCdsIdx]!\n\n  const fivePrimeUTRs = [\n    ...exons.slice(0, firstCdsIdx),\n    {\n      start: firstCdsExon.start,\n      end: firstCds.start,\n    },\n  ].map(elt => ({\n    ...elt,\n    type: 'five_prime_UTR',\n  }))\n\n  const threePrimeUTRs = [\n    {\n      start: lastCds.end,\n      end: lastCdsExon.end,\n    },\n    ...exons.slice(lastCdsIdx + 1),\n  ].map(elt => ({\n    ...elt,\n    type: 'three_prime_UTR',\n  }))\n\n  return [...fivePrimeUTRs, ...threePrimeUTRs]\n}\n\n// calculates UTRs using impliedUTRs logic, but there are no exon subfeatures\nexport function calculateUTRs2(cds: Feat[], parentFeat: Feat) {\n  if (!cds.length) {\n    return []\n  }\n\n  const firstCds = cds.at(0)!\n  const lastCds = cds.at(-1)!\n  const fivePrimeUTRs = [\n    {\n      start: parentFeat.start,\n      end: firstCds.start,\n    },\n  ].map(elt => ({\n    ...elt,\n    type: 'five_prime_UTR',\n  }))\n\n  const threePrimeUTRs = [\n    {\n      start: lastCds.end,\n      end: parentFeat.end,\n    },\n  ].map(elt => ({\n    ...elt,\n    type: 'three_prime_UTR',\n  }))\n\n  return [...fivePrimeUTRs, ...threePrimeUTRs]\n}\n\nexport function ellipses(slug: string) {\n  return slug.length > 20 ? `${slug.slice(0, 20)}...` : slug\n}\n\nexport function replaceUndefinedWithNull(obj: SimpleFeatureSerialized) {\n  return JSON.parse(JSON.stringify(obj, (_, v) => (v === undefined ? null : v)))\n}\n\nexport function formatSubfeatures(\n  obj: SerializedFeat,\n  depth: number,\n  parse: (obj: Record<string, unknown>) => void,\n  currentDepth = 0,\n  returnObj = {} as Record<string, unknown>,\n) {\n  if (depth <= currentDepth) {\n    return\n  }\n  obj.subfeatures?.map(sub => {\n    formatSubfeatures(sub, depth, parse, currentDepth + 1, returnObj)\n    parse(sub)\n  })\n}\n","export default abstract class PluggableElementBase {\n  name: string\n  maybeDisplayName?: string\n\n  constructor(args?: { name?: string; displayName?: string }) {\n    this.name = args?.name || 'UNKNOWN'\n    this.maybeDisplayName = args?.displayName\n  }\n\n  get displayName() {\n    return this.maybeDisplayName || this.name\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nconst configSchema = ConfigurationSchema('HierarchicalTrackSelectorWidget', {})\nexport default configSchema\n","import { lazy } from 'react'\n\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function HierarchicalTrackSelectorWidgetF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'HierarchicalTrackSelectorWidget',\n      heading: 'Available tracks',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(\n        () => import('./components/HierarchicalTrackSelector.tsx'),\n      ),\n    })\n  })\n}\n\nexport {\n  type HierarchicalTrackSelectorModel,\n  default as stateModelFactory,\n} from './model.ts'\nexport { default as configSchema } from './configSchema.ts'\n","import { useEffect, useRef, useState } from 'react'\n\nimport { drawImageOntoCanvasContext } from '../util/offscreenCanvasPonyfill.tsx'\n\nfunction PrerenderedCanvas(props: {\n  width: number\n  height: number\n  highResolutionScaling?: number\n  style?: React.CSSProperties\n  imageData?: unknown\n  showSoftClip?: boolean\n  blockKey?: string\n}) {\n  const {\n    width,\n    height,\n    highResolutionScaling = 1,\n    style = {},\n    imageData,\n    blockKey,\n    showSoftClip,\n  } = props\n  const [done, setDone] = useState(false)\n\n  const featureCanvas = useRef<HTMLCanvasElement>(null)\n\n  useEffect(() => {\n    if (!imageData) {\n      return\n    }\n    const canvas = featureCanvas.current\n    if (!canvas) {\n      return\n    }\n    const context = canvas.getContext('2d')\n    if (!context) {\n      return\n    }\n    context.clearRect(0, 0, canvas.width, canvas.height)\n    drawImageOntoCanvasContext(imageData, context)\n    // eslint-disable-next-line react-hooks/set-state-in-effect\n    setDone(true)\n  }, [imageData])\n\n  return (\n    <canvas\n      data-testid={[\n        'prerendered_canvas',\n        showSoftClip ? 'softclipped' : '',\n        blockKey,\n        done ? 'done' : '',\n      ]\n        .filter(f => !!f)\n        .join('_')}\n      ref={featureCanvas}\n      width={width * highResolutionScaling}\n      height={height * highResolutionScaling}\n      style={{ width, height, ...style }}\n    />\n  )\n}\n\nexport default PrerenderedCanvas\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport { baseLinearDisplayConfigSchema } from '../BaseLinearDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearBareDisplay\n * #category display\n */\nfunction configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearBareDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: pluginManager.pluggableConfigSchemaType('renderer'),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport { configSchemaFactory }\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { modelFactory as LinearFeatureDisplayModelFactory } from '../LinearFeatureDisplay/index.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { MenuItem, SubMenuItem } from '@jbrowse/core/ui'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nfunction findSubMenu(items: MenuItem[], label: string) {\n  return items.find(\n    (item): item is SubMenuItem => 'label' in item && item.label === label,\n  )\n}\n\n/**\n * #stateModel LinearBasicDisplay\n * #category display\n * Used by `FeatureTrack`, has simple settings like \"show/hide feature labels\",\n * plus gene glyph display options.\n *\n * extends\n * - [LinearFeatureDisplay](../linearfeaturedisplay)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearBasicDisplay',\n      LinearFeatureDisplayModelFactory(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearBasicDisplay'),\n        /**\n         * #property\n         */\n        trackGeneGlyphMode: types.maybe(types.string),\n        /**\n         * #property\n         */\n        trackSubfeatureLabels: types.maybe(types.string),\n        /**\n         * #property\n         */\n        trackDisplayDirectionalChevrons: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get geneGlyphMode() {\n        return (\n          self.trackGeneGlyphMode ??\n          getConf(self, ['renderer', 'geneGlyphMode'])\n        )\n      },\n      /**\n       * #getter\n       */\n      get subfeatureLabels() {\n        return (\n          self.trackSubfeatureLabels ??\n          getConf(self, ['renderer', 'subfeatureLabels'])\n        )\n      },\n      /**\n       * #getter\n       */\n      get displayDirectionalChevrons() {\n        return (\n          self.trackDisplayDirectionalChevrons ??\n          getConf(self, ['renderer', 'displayDirectionalChevrons'])\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const configBlob = getConf(self, ['renderer']) || {}\n        const config = configBlob as Omit<typeof configBlob, symbol>\n        return {\n          ...config,\n          // Use track overrides if set, otherwise use what's already in configBlob\n          // This avoids redundant getConf calls for each property\n          showLabels: self.trackShowLabels ?? config.showLabels,\n          showDescriptions:\n            self.trackShowDescriptions ?? config.showDescriptions,\n          subfeatureLabels:\n            self.trackSubfeatureLabels ?? config.subfeatureLabels,\n          displayMode: self.trackDisplayMode ?? config.displayMode,\n          maxHeight: self.trackMaxHeight ?? config.maxHeight,\n          geneGlyphMode: self.trackGeneGlyphMode ?? config.geneGlyphMode,\n          displayDirectionalChevrons:\n            self.trackDisplayDirectionalChevrons ??\n            config.displayDirectionalChevrons,\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setGeneGlyphMode(val: string) {\n        self.trackGeneGlyphMode = val\n      },\n      /**\n       * #action\n       */\n      setSubfeatureLabels(val: string) {\n        self.trackSubfeatureLabels = val\n      },\n      /**\n       * #action\n       */\n      toggleDisplayDirectionalChevrons() {\n        self.trackDisplayDirectionalChevrons = !self.displayDirectionalChevrons\n      },\n    }))\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems(): MenuItem[] {\n          const items = superTrackMenuItems()\n          const showMenu = findSubMenu(items, 'Show...')\n          if (showMenu) {\n            showMenu.subMenu = [\n              ...showMenu.subMenu,\n              {\n                label: 'Show chevrons',\n                type: 'checkbox',\n                checked: self.displayDirectionalChevrons,\n                onClick: () => {\n                  self.toggleDisplayDirectionalChevrons()\n                },\n              },\n              {\n                label: 'Subfeature labels',\n                subMenu: ['none', 'below', 'overlay'].map(val => ({\n                  label: val,\n                  type: 'radio' as const,\n                  checked: self.subfeatureLabels === val,\n                  onClick: () => {\n                    self.setSubfeatureLabels(val)\n                  },\n                })),\n              },\n              {\n                label: 'Gene glyph',\n                subMenu: [\n                  {\n                    value: 'all',\n                    label: 'All transcripts',\n                  },\n                  {\n                    value: 'longest',\n                    label: 'Longest transcript',\n                  },\n                  {\n                    value: 'longestCoding',\n                    label: 'Longest coding transcript',\n                  },\n                ].map(({ value, label }) => ({\n                  label,\n                  type: 'radio' as const,\n                  checked: self.geneGlyphMode === value,\n                  onClick: () => {\n                    self.setGeneGlyphMode(value)\n                  },\n                })),\n              },\n            ]\n          }\n          const filtersMenu = findSubMenu(items, 'Filters')\n          if (filtersMenu) {\n            filtersMenu.subMenu = [\n              {\n                label: 'Show only genes',\n                type: 'checkbox',\n                checked: self.activeFilters.includes(\n                  \"jexl:get(feature,'type')=='gene'\",\n                ),\n                onClick: () => {\n                  const geneFilter = \"jexl:get(feature,'type')=='gene'\"\n                  const currentFilters = self.activeFilters\n                  if (currentFilters.includes(geneFilter)) {\n                    self.setJexlFilters(\n                      currentFilters.filter((f: string) => f !== geneFilter),\n                    )\n                  } else {\n                    self.setJexlFilters([...currentFilters, geneFilter])\n                  }\n                },\n              },\n              ...filtersMenu.subMenu,\n            ]\n          }\n          return items\n        },\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        trackGeneGlyphMode,\n        trackSubfeatureLabels,\n        trackDisplayDirectionalChevrons,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(trackGeneGlyphMode !== undefined ? { trackGeneGlyphMode } : {}),\n        ...(trackSubfeatureLabels !== undefined\n          ? { trackSubfeatureLabels }\n          : {}),\n        ...(trackDisplayDirectionalChevrons !== undefined\n          ? { trackDisplayDirectionalChevrons }\n          : {}),\n      } as typeof snap\n    })\n}\n\nexport type FeatureTrackStateModel = ReturnType<typeof stateModelFactory>\nexport type FeatureTrackModel = Instance<FeatureTrackStateModel>\n\nexport default stateModelFactory\n","import { lazy, useEffect, useState } from 'react'\n\nimport CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\nimport { getBpDisplayStr, getSession } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport MoreVert from '@mui/icons-material/MoreVert'\nimport ZoomIn from '@mui/icons-material/ZoomIn'\nimport ZoomOut from '@mui/icons-material/ZoomOut'\nimport { IconButton, Slider, Tooltip } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { SliderValueLabelProps } from '@mui/material'\n\n// lazies\nconst RegionWidthEditorDialog = lazy(\n  () => import('./RegionWidthEditorDialog.tsx'),\n)\n\nconst useStyles = makeStyles()(theme => ({\n  container: {\n    display: 'flex',\n    flexDirection: 'row',\n    alignItems: 'center',\n  },\n  slider: {\n    width: 100,\n    color: theme.palette.text.secondary,\n  },\n}))\nfunction ValueLabelComponent(props: SliderValueLabelProps) {\n  const { children, open, value } = props\n  return (\n    <Tooltip\n      open={open}\n      enterTouchDelay={0}\n      placement=\"top\"\n      title={value}\n      arrow\n    >\n      {children}\n    </Tooltip>\n  )\n}\nconst HeaderZoomControls = observer(function HeaderZoomControls({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  const { width, maxBpPerPx, minBpPerPx, bpPerPx, effectiveBpPerPx } = model\n\n  // local state needed for slider drag: onChange updates this for visual\n  // feedback, onChangeCommitted syncs to model\n  const [value, setValue] = useState(-Math.log2(bpPerPx) * 100)\n  useEffect(() => {\n    setValue(-Math.log2(effectiveBpPerPx) * 100)\n  }, [effectiveBpPerPx])\n  const zoomInDisabled = effectiveBpPerPx <= minBpPerPx + 0.0001\n  const zoomOutDisabled = effectiveBpPerPx >= maxBpPerPx - 0.0001\n  return (\n    <div className={classes.container}>\n      <Tooltip title=\"Zoom out 2x\">\n        <span>\n          <IconButton\n            data-testid=\"zoom_out\"\n            disabled={zoomOutDisabled}\n            onClick={() => {\n              model.zoom(bpPerPx * 2)\n            }}\n          >\n            <ZoomOut />\n          </IconButton>\n        </span>\n      </Tooltip>\n\n      <Slider\n        size=\"small\"\n        className={classes.slider}\n        value={value}\n        min={-Math.log2(maxBpPerPx) * 100}\n        max={-Math.log2(minBpPerPx) * 100}\n        onChangeCommitted={() => model.zoomTo(2 ** (-value / 100))}\n        valueLabelDisplay=\"auto\"\n        valueLabelFormat={newValue =>\n          `Window size: ${getBpDisplayStr(2 ** (-newValue / 100) * width)}`\n        }\n        slots={{\n          valueLabel: ValueLabelComponent,\n        }}\n        onChange={(_, val) => {\n          setValue(val)\n        }}\n      />\n      <Tooltip title=\"Zoom in 2x\">\n        <span>\n          <IconButton\n            data-testid=\"zoom_in\"\n            disabled={zoomInDisabled}\n            onClick={() => {\n              model.zoom(model.bpPerPx / 2)\n            }}\n          >\n            <ZoomIn />\n          </IconButton>\n        </span>\n      </Tooltip>\n\n      <CascadingMenuButton\n        menuItems={[\n          ...[100, 50, 10].map(r => ({\n            label: `Zoom in ${r}x`,\n            onClick: () => {\n              model.zoom(model.bpPerPx / r)\n            },\n          })),\n          ...[10, 50, 100].map(r => ({\n            label: `Zoom out ${r}x`,\n            onClick: () => {\n              model.zoom(model.bpPerPx * r)\n            },\n          })),\n          {\n            label: 'Custom zoom',\n            onClick: () => {\n              getSession(model).queueDialog(handleClose => [\n                RegionWidthEditorDialog,\n                {\n                  model,\n                  handleClose,\n                },\n              ])\n            },\n          },\n        ]}\n      >\n        <MoreVert />\n      </CascadingMenuButton>\n    </div>\n  )\n})\n\nexport default HeaderZoomControls\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack'\nimport ArrowForwardIcon from '@mui/icons-material/ArrowForward'\nimport { Button, alpha } from '@mui/material'\n\nimport { SPACING } from '../consts.ts'\n\nimport type { LinearGenomeViewModel } from '..'\n\ntype LGV = LinearGenomeViewModel\nconst useStyles = makeStyles()(theme => ({\n  panButton: {\n    background: alpha(theme.palette.background.paper, 0.8),\n    color: theme.palette.text.primary,\n    margin: SPACING,\n  },\n}))\n\nexport default function HeaderPanControls({ model }: { model: LGV }) {\n  const { classes } = useStyles()\n  return (\n    <>\n      <Button\n        variant=\"outlined\"\n        className={classes.panButton}\n        onClick={() => {\n          model.slide(-0.9)\n        }}\n      >\n        <ArrowBackIcon />\n      </Button>\n      <Button\n        variant=\"outlined\"\n        className={classes.panButton}\n        onClick={() => {\n          model.slide(0.9)\n        }}\n      >\n        <ArrowForwardIcon />\n      </Button>\n    </>\n  )\n}\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Typography } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\n\nconst useStyles = makeStyles()({\n  bp: {\n    display: 'flex',\n    alignItems: 'center',\n    marginLeft: 5,\n    cursor: 'pointer',\n  },\n})\n\nconst HeaderRegionWidth = observer(function HeaderRegionWidth({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  const { effectiveTotalBpDisplayStr } = model\n  return (\n    <Typography variant=\"body2\" color=\"textSecondary\" className={classes.bp}>\n      {effectiveTotalBpDisplayStr}\n    </Typography>\n  )\n})\n\nexport default HeaderRegionWidth\n","import { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { IconButton } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\n\nconst useStyles = makeStyles()(theme => ({\n  toggleButton: {\n    height: 44,\n    border: 'none',\n    marginLeft: theme.spacing(4),\n  },\n}))\n\nconst HeaderTrackSelectorButton = observer(function HeaderTrackSelectorButton({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  return (\n    <IconButton\n      onClick={model.activateTrackSelector}\n      className={classes.toggleButton}\n      title=\"Open track selector\"\n      value=\"track_select\"\n    >\n      <TrackSelectorIcon />\n    </IconButton>\n  )\n})\n\nexport default HeaderTrackSelectorButton\n","import { getSession, notEmpty } from '@jbrowse/core/util'\nimport { colord } from '@jbrowse/core/util/colord'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '../model.ts'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()(theme => ({\n  highlight: {\n    height: '100%',\n    position: 'absolute',\n    left: 0,\n    background: colord(theme.palette.highlight.main).alpha(0.35).toRgbString(),\n    borderLeft: `1px solid ${theme.palette.highlight.main}`,\n    borderRight: `1px solid ${theme.palette.highlight.main}`,\n  },\n}))\n\nconst OverviewHighlight = observer(function OverviewHighlight({\n  model,\n  overview,\n}: {\n  model: LGV\n  overview: Base1DViewModel\n}) {\n  const { classes } = useStyles()\n  const { highlight, cytobandOffset } = model\n\n  const session = getSession(model) as SessionWithWidgets\n  const { assemblyManager } = session\n  return highlight\n    .map(r => {\n      const asm = assemblyManager.get(r.assemblyName)\n      const refName = asm?.getCanonicalRefName(r.refName) ?? r.refName\n      const s = overview.bpToPx({\n        ...r,\n        refName,\n        coord: r.start,\n      })\n      const e = overview.bpToPx({\n        ...r,\n        refName,\n        coord: r.end,\n      })\n      return s !== undefined && e !== undefined\n        ? {\n            width: Math.abs(e - s),\n            left: s + cytobandOffset,\n          }\n        : undefined\n    })\n    .filter(notEmpty)\n    .map(({ left, width }, idx) => (\n      <div\n        /* biome-ignore lint/suspicious/noArrayIndexKey: */\n        key={`${left}_${width}_${idx}`}\n        className={classes.highlight}\n        style={{\n          width,\n          transform: `translateX(${left}px)`,\n        }}\n      />\n    ))\n})\n\nexport default OverviewHighlight\n","import { getSession, stringify } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Tooltip } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()({\n  guide: {\n    pointerEvents: 'none',\n    height: '100%',\n    width: 1,\n    position: 'absolute',\n    left: 0,\n  },\n})\n\nconst OverviewRubberbandHoverTooltip = observer(\n  function OverviewRubberbandHoverTooltip({\n    model,\n    open,\n    guideX,\n    overview,\n  }: {\n    model: LGV\n    open: boolean\n    guideX: number\n    overview: Base1DViewModel\n  }) {\n    const { classes } = useStyles()\n    const { cytobandOffset } = model\n    const { assemblyManager } = getSession(model)\n\n    const px = overview.pxToBp(guideX - cytobandOffset)\n    const assembly = assemblyManager.get(px.assemblyName)\n    const cytoband = assembly?.cytobands?.find(\n      f =>\n        px.coord > f.get('start') &&\n        px.coord < f.get('end') &&\n        px.refName === assembly.getCanonicalRefName(f.get('refName')),\n    )\n\n    return (\n      <Tooltip\n        open={open}\n        placement=\"top\"\n        title={[\n          stringify(px),\n          cytoband?.get('name'),\n          cytoband?.get('type'),\n        ].join(' ')}\n        arrow\n      >\n        <div\n          className={classes.guide}\n          style={{ transform: `translateX(${guideX}px)` }}\n        />\n      </Tooltip>\n    )\n  },\n)\n\nexport default OverviewRubberbandHoverTooltip\n","import { useEffect, useRef, useState } from 'react'\n\nimport { getSession } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nimport OverviewRubberbandHoverTooltip from './OverviewRubberbandHoverTooltip.tsx'\nimport RubberbandSpan from './RubberbandSpan.tsx'\nimport { getRelativeX } from './util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\ntype LGV = LinearGenomeViewModel\n\nconst useStyles = makeStyles()({\n  rubberbandControl: {\n    cursor: 'crosshair',\n    width: '100%',\n    minHeight: 8,\n  },\n  rel: {\n    position: 'relative',\n  },\n})\n\nconst OverviewRubberband = observer(function OverviewRubberband({\n  model,\n  overview,\n  ControlComponent = <div />,\n}: {\n  model: LGV\n  overview: Base1DViewModel\n  ControlComponent?: React.ReactElement\n}) {\n  const { cytobandOffset } = model\n  const [startX, setStartX] = useState<number>()\n  const [currentX, setCurrentX] = useState<number>()\n  const [guideX, setGuideX] = useState<number>()\n  const controlsRef = useRef<HTMLDivElement>(null)\n  const { classes } = useStyles()\n  const mouseDragging = startX !== undefined\n\n  useEffect(() => {\n    function globalMouseMove(event: MouseEvent) {\n      const ref = controlsRef.current\n      if (ref && mouseDragging) {\n        setCurrentX(getRelativeX(event, ref))\n      }\n    }\n\n    function globalMouseUp() {\n      // click and drag\n      if (startX !== undefined && currentX !== undefined) {\n        if (Math.abs(currentX - startX) > 3) {\n          const left = Math.min(startX, currentX)\n          const right = Math.max(startX, currentX)\n          model.moveTo(\n            overview.pxToBp(left - cytobandOffset),\n            overview.pxToBp(right - cytobandOffset),\n          )\n        }\n      }\n\n      // just a click\n      if (startX !== undefined && currentX === undefined) {\n        const click = overview.pxToBp(startX - cytobandOffset)\n        if (!click.refName) {\n          getSession(model).notify('unknown position clicked')\n          console.error('unknown position clicked', click)\n        } else {\n          model.centerAt(Math.round(click.coord), click.refName, click.index)\n        }\n      }\n      setStartX(undefined)\n      setCurrentX(undefined)\n\n      if (startX !== undefined) {\n        setGuideX(undefined)\n      }\n    }\n\n    function globalKeyDown(event: KeyboardEvent) {\n      if (event.key === 'Escape') {\n        setStartX(undefined)\n        setCurrentX(undefined)\n      }\n    }\n\n    if (mouseDragging) {\n      window.addEventListener('mousemove', globalMouseMove, true)\n      window.addEventListener('mouseup', globalMouseUp, true)\n      window.addEventListener('keydown', globalKeyDown, true)\n      return () => {\n        window.removeEventListener('mousemove', globalMouseMove, true)\n        window.removeEventListener('mouseup', globalMouseUp, true)\n        window.removeEventListener('keydown', globalKeyDown, true)\n      }\n    }\n    return () => {}\n  }, [mouseDragging, currentX, startX, model, overview, cytobandOffset])\n\n  function mouseDown(event: React.MouseEvent<HTMLDivElement>) {\n    event.preventDefault()\n    event.stopPropagation()\n    setStartX(getRelativeX(event, controlsRef.current))\n  }\n\n  function mouseMove(event: React.MouseEvent<HTMLDivElement>) {\n    setGuideX(getRelativeX(event, controlsRef.current))\n  }\n\n  function mouseOut() {\n    setGuideX(undefined)\n  }\n\n  if (startX === undefined) {\n    return (\n      <div className={classes.rel}>\n        {guideX !== undefined ? (\n          <OverviewRubberbandHoverTooltip\n            model={model}\n            open={!mouseDragging}\n            overview={overview}\n            guideX={guideX}\n          />\n        ) : null}\n        <div\n          className={classes.rubberbandControl}\n          ref={controlsRef}\n          onMouseDown={mouseDown}\n          onMouseOut={mouseOut}\n          onMouseMove={mouseMove}\n        >\n          {ControlComponent}\n        </div>\n      </div>\n    )\n  }\n\n  let left = startX || 0\n  let width = 0\n  if (currentX !== undefined) {\n    left = Math.min(currentX, startX)\n    width = currentX - startX\n  }\n  // calculate the start and end bp of drag\n  let leftBpOffset: ReturnType<typeof overview.pxToBp> | undefined\n  let rightBpOffset: ReturnType<typeof overview.pxToBp> | undefined\n  if (startX) {\n    leftBpOffset = overview.pxToBp(startX - cytobandOffset)\n    rightBpOffset = overview.pxToBp(startX + width - cytobandOffset)\n    if (currentX !== undefined && currentX < startX) {\n      ;[leftBpOffset, rightBpOffset] = [rightBpOffset, leftBpOffset]\n    }\n  }\n\n  return (\n    <div className={classes.rel}>\n      {leftBpOffset && rightBpOffset ? (\n        <RubberbandSpan\n          leftBpOffset={leftBpOffset}\n          rightBpOffset={rightBpOffset}\n          width={Math.abs(width)}\n          left={left}\n        />\n      ) : null}\n      <div\n        data-testid=\"rubberband_controls\"\n        className={classes.rubberbandControl}\n        ref={controlsRef}\n        onMouseDown={mouseDown}\n        onMouseOut={mouseOut}\n        onMouseMove={mouseMove}\n      >\n        {ControlComponent}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewRubberband\n","import { getSession, getTickDisplayStr } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Typography } from '@mui/material'\nimport { observer } from 'mobx-react'\n\n// core\nimport { HEADER_OVERVIEW_HEIGHT } from '../consts.ts'\nimport { chooseGridPitch } from '../util.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { ContentBlock } from '@jbrowse/core/util/blockTypes'\n\nconst useStyles = makeStyles()({\n  scalebarLabel: {\n    height: HEADER_OVERVIEW_HEIGHT,\n    position: 'absolute',\n    left: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    pointerEvents: 'none',\n  },\n})\n\nconst OverviewScalebarTickLabels = observer(\n  function OverviewScalebarTickLabels({\n    block,\n    scale,\n    overview,\n    model,\n  }: {\n    model: LinearGenomeViewModel\n    scale: number\n    block: ContentBlock\n    overview: Base1DViewModel\n  }) {\n    const { classes } = useStyles()\n    const { start, end, reversed, refName, assemblyName } = block\n    const { majorPitch } = chooseGridPitch(scale, 120, 15)\n    const { assemblyManager } = getSession(model)\n    const assembly = assemblyManager.get(assemblyName)\n    const refNameColor = assembly?.getRefNameColor(refName)\n\n    const tickLabels = []\n    for (let i = 0; i < Math.floor((end - start) / majorPitch); i++) {\n      const offsetLabel = (i + 1) * majorPitch\n      tickLabels.push(reversed ? end - offsetLabel : start + offsetLabel)\n    }\n    return tickLabels.map((tickLabel, labelIdx) => (\n      <Typography\n        key={`${JSON.stringify(block)}-${tickLabel}-${labelIdx}`}\n        className={classes.scalebarLabel}\n        variant=\"body2\"\n        style={{\n          transform: `translateX(${((labelIdx + 1) * majorPitch) / scale}px)`,\n          color: refNameColor,\n        }}\n      >\n        {getTickDisplayStr(tickLabel, overview.bpPerPx)}\n      </Typography>\n    ))\n  },\n)\n\nexport default OverviewScalebarTickLabels\n","import { useMemo } from 'react'\n\n// core\nimport { getEnv, getSession } from '@jbrowse/core/util'\nimport Base1DView from '@jbrowse/core/util/Base1DViewModel'\nimport { cx, makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Typography, alpha, useTheme } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport Cytobands from './Cytobands.tsx'\nimport OverviewHighlight from './OverviewHighlight.tsx'\nimport OverviewRubberband from './OverviewRubberband.tsx'\nimport OverviewScalebarPolygon from './OverviewScalebarPolygon.tsx'\nimport OverviewScalebarTickLabels from './OverviewScalebarTickLabels.tsx'\nimport { getCytobands } from './util.ts'\nimport { HEADER_BAR_HEIGHT, HEADER_OVERVIEW_HEIGHT } from '../consts.ts'\n\nimport type { LinearGenomeViewModel } from '..'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { ContentBlock } from '@jbrowse/core/util/blockTypes'\n\nconst wholeSeqSpacer = 2\n\nconst useStyles = makeStyles()(theme => ({\n  scalebar: {\n    height: HEADER_OVERVIEW_HEIGHT,\n    contain: 'layout style',\n  },\n  scalebarBorder: {\n    border: '1px solid',\n  },\n  scalebarContig: {\n    backgroundColor: theme.palette.background.default,\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: HEADER_OVERVIEW_HEIGHT,\n    overflow: 'hidden',\n  },\n  scalebarContigForward: {\n    backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M-.1 0L6 4.5L-.1 9' fill='none' stroke='${theme.palette.divider}'/%3E%3C/svg%3E\")`,\n    backgroundRepeat: 'repeat',\n  },\n  scalebarContigReverse: {\n    backgroundImage: `url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 15 9'%3E%3Cpath d='M6 0L0 4.5L6 9' fill='none' stroke='${theme.palette.divider}'/%3E%3C/svg%3E\")`,\n    backgroundRepeat: 'repeat',\n  },\n\n  scalebarRefName: {\n    position: 'absolute',\n    left: 0,\n    fontWeight: 'bold',\n    pointerEvents: 'none',\n    zIndex: 100,\n  },\n  scalebarVisibleRegion: {\n    position: 'absolute',\n    height: HEADER_OVERVIEW_HEIGHT,\n    pointerEvents: 'none',\n    zIndex: 100,\n    border: '1px solid',\n    left: 0,\n  },\n  overview: {\n    height: HEADER_BAR_HEIGHT,\n    position: 'relative',\n  },\n  overviewSvg: {\n    pointerEvents: 'none',\n    width: '100%',\n    position: 'absolute',\n  },\n}))\n\ntype LGV = LinearGenomeViewModel\n\nconst OverviewBox = observer(function OverviewBox({\n  scale,\n  model,\n  block,\n  overview,\n}: {\n  scale: number\n  model: LGV\n  block: ContentBlock\n  overview: Base1DViewModel\n}) {\n  const { classes } = useStyles()\n  const theme = useTheme()\n  const { cytobandOffset, showCytobands } = model\n  const { reversed, refName, assemblyName } = block\n  const { assemblyManager } = getSession(model)\n  const assembly = assemblyManager.get(assemblyName)\n  const refNameColor = assembly?.getRefNameColor(refName)\n\n  const canDisplayCytobands =\n    showCytobands && getCytobands(assembly, block.refName).length\n\n  return (\n    <div>\n      {/* name of sequence */}\n      <Typography\n        style={{\n          transform: `translateX(${block.offsetPx + 3}px)`,\n          color: canDisplayCytobands\n            ? theme.palette.text.primary\n            : refNameColor,\n        }}\n        className={classes.scalebarRefName}\n      >\n        {refName}\n      </Typography>\n      <div\n        className={cx(\n          classes.scalebarContig,\n          canDisplayCytobands\n            ? undefined\n            : reversed\n              ? classes.scalebarContigReverse\n              : classes.scalebarContigForward,\n          !canDisplayCytobands ? classes.scalebarBorder : undefined,\n        )}\n        style={{\n          transform: `translateX(${block.offsetPx + cytobandOffset}px)`,\n          width: block.widthPx,\n          borderColor: refNameColor,\n        }}\n      >\n        {canDisplayCytobands ? (\n          <svg style={{ width: '100%' }}>\n            <Cytobands overview={overview} assembly={assembly} block={block} />\n          </svg>\n        ) : (\n          <OverviewScalebarTickLabels\n            model={model}\n            overview={overview}\n            scale={scale}\n            block={block}\n          />\n        )}\n      </div>\n    </div>\n  )\n})\n\nconst VisibleRegionBox = observer(function VisibleRegionBox({\n  model,\n  overview,\n  className,\n}: {\n  model: LGV\n  overview: Base1DViewModel\n  className: string\n}) {\n  const theme = useTheme()\n  const scalebarColor = theme.palette.tertiary.light\n\n  const { dynamicBlocks, showCytobands, cytobandOffset } = model\n  const visibleRegions = dynamicBlocks.contentBlocks\n\n  if (!visibleRegions.length) {\n    return null\n  }\n\n  const first = visibleRegions.at(0)!\n  const last = visibleRegions.at(-1)!\n  const firstOverviewPx =\n    overview.bpToPx({\n      refName: first.refName,\n      coord: first.reversed ? first.end : first.start,\n    }) || 0\n  const lastOverviewPx =\n    overview.bpToPx({\n      refName: last.refName,\n      coord: last.reversed ? last.start : last.end,\n    }) || 0\n\n  const color = showCytobands ? '#f00' : scalebarColor\n  const transparency = showCytobands ? 0.1 : 0.3\n  const left = firstOverviewPx + cytobandOffset\n\n  return (\n    <div\n      className={className}\n      style={{\n        width: lastOverviewPx - firstOverviewPx,\n        transform: `translateX(${left}px)`,\n        background: alpha(color, transparency),\n        borderColor: color,\n      }}\n    />\n  )\n})\n\nconst Scalebar = observer(function Scalebar({\n  model,\n  scale,\n  overview,\n}: {\n  model: LGV\n  overview: Base1DViewModel\n  scale: number\n}) {\n  const { classes } = useStyles()\n  const { pluginManager } = getEnv(model)\n  const overviewVisibleRegions = overview.dynamicBlocks\n\n  const additional = pluginManager.evaluateExtensionPoint(\n    'LinearGenomeView-OverviewScalebarComponent',\n    undefined,\n    { model, overview },\n  ) as React.ReactNode\n\n  return (\n    <div className={classes.scalebar}>\n      <VisibleRegionBox\n        model={model}\n        overview={overview}\n        className={classes.scalebarVisibleRegion}\n      />\n      {/* this is the entire scale bar */}\n      {overviewVisibleRegions.map((block, idx) => {\n        return !(block.type === 'ContentBlock') ? (\n          <div\n            key={`${JSON.stringify(block)}-${idx}`}\n            className={classes.scalebarContig}\n            style={{\n              width: block.widthPx,\n              transform: `translateX(${block.offsetPx}px)`,\n              backgroundColor: '#999',\n              backgroundImage:\n                'repeating-linear-gradient(90deg, transparent, transparent 1px, rgba(255,255,255,.5) 1px, rgba(255,255,255,.5) 3px)',\n            }}\n          />\n        ) : (\n          <OverviewBox\n            scale={scale}\n            block={block}\n            model={model}\n            overview={overview}\n            key={`${JSON.stringify(block)}-${idx}`}\n          />\n        )\n      })}\n      <OverviewHighlight model={model} overview={overview} />\n      {additional}\n    </div>\n  )\n})\n\nconst OverviewScalebar = observer(function OverviewScalebar({\n  model,\n  children,\n}: {\n  model: LGV\n  children: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  const {\n    minimumBlockWidth,\n    totalBp,\n    width,\n    cytobandOffset,\n    displayedRegions,\n  } = model\n\n  const modWidth = width - cytobandOffset\n  const str = JSON.stringify(displayedRegions)\n  const overview = useMemo(() => {\n    const overview = Base1DView.create({\n      displayedRegions: JSON.parse(str),\n      interRegionPaddingWidth: 0,\n      minimumBlockWidth,\n    })\n\n    overview.setVolatileWidth(modWidth)\n    overview.showAllRegions()\n    return overview\n  }, [str, minimumBlockWidth, modWidth])\n\n  const scale =\n    totalBp / (modWidth - (displayedRegions.length - 1) * wholeSeqSpacer)\n\n  return (\n    <div>\n      <OverviewRubberband\n        model={model}\n        overview={overview}\n        ControlComponent={\n          <Scalebar model={model} overview={overview} scale={scale} />\n        }\n      />\n      <div className={classes.overview}>\n        <svg height={HEADER_BAR_HEIGHT} className={classes.overviewSvg}>\n          <OverviewScalebarPolygon model={model} overview={overview} />\n        </svg>\n        {children}\n      </div>\n    </div>\n  )\n})\n\nexport default OverviewScalebar\n","import { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { FormGroup } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport HeaderPanControls from './HeaderPanControls.tsx'\nimport HeaderRegionWidth from './HeaderRegionWidth.tsx'\nimport HeaderTrackSelectorButton from './HeaderTrackSelectorButton.tsx'\nimport HeaderZoomControls from './HeaderZoomControls.tsx'\nimport OverviewScalebar from './OverviewScalebar.tsx'\nimport SearchBox from './SearchBox.tsx'\nimport { HEADER_BAR_HEIGHT } from '../consts.ts'\n\nimport type { LinearGenomeViewModel } from '..'\n\nconst useStyles = makeStyles()({\n  headerBar: {\n    display: 'flex',\n    height: HEADER_BAR_HEIGHT,\n  },\n  headerForm: {\n    flexWrap: 'nowrap',\n    marginRight: 7,\n  },\n  spacer: {\n    flexGrow: 1,\n  },\n})\n\nconst Controls = function ({ model }: { model: LinearGenomeViewModel }) {\n  const { classes } = useStyles()\n  return (\n    <div className={classes.headerBar}>\n      <HeaderTrackSelectorButton model={model} />\n      <div className={classes.spacer} />\n      <FormGroup row className={classes.headerForm}>\n        <HeaderPanControls model={model} />\n        <SearchBox model={model} />\n      </FormGroup>\n      <HeaderRegionWidth model={model} />\n      <HeaderZoomControls model={model} />\n      <div className={classes.spacer} />\n    </div>\n  )\n}\n\nconst LinearGenomeViewHeader = observer(function LinearGenomeViewHeader({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { hideHeader, hideHeaderOverview } = model\n  return !hideHeader ? (\n    hideHeaderOverview ? (\n      <Controls model={model} />\n    ) : (\n      <OverviewScalebar model={model}>\n        <Controls model={model} />\n      </OverviewScalebar>\n    )\n  ) : null\n})\n\nexport default LinearGenomeViewHeader\n","import CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\nimport { getSession } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport ArrowDown from '@mui/icons-material/KeyboardArrowDown'\nimport ZoomIn from '@mui/icons-material/ZoomIn'\nimport ZoomOut from '@mui/icons-material/ZoomOut'\nimport { IconButton, Paper, alpha } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { LinearGenomeViewModel } from '..'\n\nconst useStyles = makeStyles()(theme => ({\n  background: {\n    position: 'absolute',\n    right: 0,\n    background: theme.palette.background.paper,\n\n    // needed when sticky header is off in lgv, e.g. in breakpoint split view\n    zIndex: 2,\n  },\n  focusedBackground: {\n    background: alpha(theme.palette.secondary.light, 0.2),\n  },\n}))\n\nconst MiniControls = observer(function MiniControls({\n  model,\n}: {\n  model: LinearGenomeViewModel\n}) {\n  const { classes } = useStyles()\n  const { id, bpPerPx, maxBpPerPx, minBpPerPx, hideHeader, effectiveBpPerPx } =\n    model\n  const { focusedViewId } = getSession(model)\n  return hideHeader ? (\n    <Paper className={classes.background}>\n      <Paper\n        className={focusedViewId === id ? classes.focusedBackground : undefined}\n      >\n        <CascadingMenuButton menuItems={() => model.menuItems()}>\n          <ArrowDown fontSize=\"small\" />\n        </CascadingMenuButton>\n        <IconButton\n          data-testid=\"zoom_out\"\n          onClick={() => {\n            model.zoom(bpPerPx * 2)\n          }}\n          disabled={effectiveBpPerPx >= maxBpPerPx - 0.0001}\n        >\n          <ZoomOut fontSize=\"small\" />\n        </IconButton>\n        <IconButton\n          data-testid=\"zoom_in\"\n          onClick={() => {\n            model.zoom(bpPerPx / 2)\n          }}\n          disabled={effectiveBpPerPx <= minBpPerPx + 0.0001}\n        >\n          <ZoomIn fontSize=\"small\" />\n        </IconButton>\n      </Paper>\n    </Paper>\n  ) : null\n})\n\nexport default MiniControls\n","import { lazy } from 'react'\n\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport {\n  getSession,\n  isSessionWithAddTracks,\n  toLocale,\n} from '@jbrowse/core/util'\nimport CenterFocusStrongIcon from '@mui/icons-material/CenterFocusStrong'\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport LabelIcon from '@mui/icons-material/Label'\nimport MenuOpenIcon from '@mui/icons-material/MenuOpen'\nimport PaletteIcon from '@mui/icons-material/Palette'\nimport PhotoCameraIcon from '@mui/icons-material/PhotoCamera'\nimport SearchIcon from '@mui/icons-material/Search'\nimport SyncAltIcon from '@mui/icons-material/SyncAlt'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport ZoomInIcon from '@mui/icons-material/ZoomIn'\n\nimport type { LinearGenomeViewModel } from './model.ts'\nimport type { BpOffset } from './types.ts'\nimport type { MenuItem } from '@jbrowse/core/ui'\n\n// lazies\nconst ReturnToImportFormDialog = lazy(\n  () => import('@jbrowse/core/ui/ReturnToImportFormDialog'),\n)\nconst SequenceSearchDialog = lazy(\n  () => import('./components/SequenceSearchDialog.tsx'),\n)\nconst ExportSvgDialog = lazy(() => import('./components/ExportSvgDialog.tsx'))\nconst GetSequenceDialog = lazy(\n  () => import('./components/GetSequenceDialog.tsx'),\n)\n\nfunction toLocaleRounded(n: number) {\n  return toLocale(Math.round(n))\n}\n\n/**\n * Modifies view menu action onClick to apply to all tracks of same type\n */\nexport function rewriteOnClicks(\n  self: LinearGenomeViewModel,\n  trackType: string,\n  viewMenuActions: MenuItem[],\n) {\n  for (const action of viewMenuActions) {\n    if ('subMenu' in action) {\n      rewriteOnClicks(self, trackType, action.subMenu)\n    }\n    if ('onClick' in action) {\n      const holdOnClick = action.onClick\n      action.onClick = (...args: unknown[]) => {\n        for (const track of self.tracks) {\n          if (track.type === trackType) {\n            holdOnClick.apply(track, [track, ...args])\n          }\n        }\n      }\n    }\n  }\n}\n\n/**\n * Build the main view menu items\n */\nexport function buildMenuItems(self: LinearGenomeViewModel): MenuItem[] {\n  if (!self.hasDisplayedRegions) {\n    return []\n  }\n  const { canShowCytobands, showCytobands } = self\n  const session = getSession(self)\n  const menuItems: MenuItem[] = [\n    {\n      label: 'Return to import form',\n      onClick: () => {\n        session.queueDialog(handleClose => [\n          ReturnToImportFormDialog,\n          {\n            model: self,\n            handleClose,\n          },\n        ])\n      },\n      icon: FolderOpenIcon,\n    },\n    ...(isSessionWithAddTracks(session)\n      ? [\n          {\n            label: 'Sequence search',\n            icon: SearchIcon,\n            onClick: () => {\n              session.queueDialog(handleClose => [\n                SequenceSearchDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n        ]\n      : []),\n    {\n      label: 'Export SVG',\n      icon: PhotoCameraIcon,\n      onClick: () => {\n        session.queueDialog(handleClose => [\n          ExportSvgDialog,\n          {\n            model: self,\n            handleClose,\n          },\n        ])\n      },\n    },\n    {\n      label: 'Open track selector',\n      onClick: self.activateTrackSelector,\n      icon: TrackSelectorIcon,\n    },\n    {\n      label: 'Horizontally flip',\n      icon: SyncAltIcon,\n      onClick: self.horizontallyFlip,\n    },\n    {\n      label: 'Color by CDS and draw amino acids',\n      type: 'checkbox',\n      checked: self.colorByCDS,\n      icon: PaletteIcon,\n      onClick: () => {\n        self.setColorByCDS(!self.colorByCDS)\n      },\n    },\n    {\n      label: 'Show...',\n      icon: VisibilityIcon,\n      subMenu: [\n        {\n          label: 'Show all regions in assembly',\n          onClick: self.showAllRegionsInAssembly,\n        },\n        {\n          label: 'Show center line',\n          type: 'checkbox',\n          checked: self.showCenterLine,\n          onClick: () => {\n            self.setShowCenterLine(!self.showCenterLine)\n          },\n        },\n        {\n          label: 'Show header',\n          type: 'checkbox',\n          checked: !self.hideHeader,\n          onClick: () => {\n            self.setHideHeader(!self.hideHeader)\n          },\n        },\n\n        {\n          label: 'Show track outlines',\n          type: 'checkbox',\n          checked: self.showTrackOutlines,\n          onClick: () => {\n            self.setShowTrackOutlines(!self.showTrackOutlines)\n          },\n        },\n        {\n          label: 'Show header overview',\n          type: 'checkbox',\n          checked: !self.hideHeaderOverview,\n          onClick: () => {\n            self.setHideHeaderOverview(!self.hideHeaderOverview)\n          },\n          disabled: self.hideHeader,\n        },\n        {\n          label: 'Show no tracks active button',\n          type: 'checkbox',\n          checked: !self.hideNoTracksActive,\n          onClick: () => {\n            self.setHideNoTracksActive(!self.hideNoTracksActive)\n          },\n        },\n        {\n          label: 'Show guidelines',\n          type: 'checkbox',\n          checked: self.showGridlines,\n          onClick: () => {\n            self.setShowGridlines(!self.showGridlines)\n          },\n        },\n        ...(canShowCytobands\n          ? [\n              {\n                label: 'Show ideogram',\n                type: 'checkbox' as const,\n                checked: self.showCytobands,\n                onClick: () => {\n                  self.setShowCytobands(!showCytobands)\n                },\n              },\n            ]\n          : []),\n      ],\n    },\n    {\n      label: 'Track labels',\n      icon: LabelIcon,\n      subMenu: [\n        {\n          label: 'Overlapping',\n          icon: VisibilityIcon,\n          type: 'radio',\n          checked: self.trackLabelsSetting === 'overlapping',\n          onClick: () => {\n            self.setTrackLabels('overlapping')\n          },\n        },\n        {\n          label: 'Offset',\n          icon: VisibilityIcon,\n          type: 'radio',\n          checked: self.trackLabelsSetting === 'offset',\n          onClick: () => {\n            self.setTrackLabels('offset')\n          },\n        },\n        {\n          label: 'Hidden',\n          icon: VisibilityIcon,\n          type: 'radio',\n          checked: self.trackLabelsSetting === 'hidden',\n          onClick: () => {\n            self.setTrackLabels('hidden')\n          },\n        },\n      ],\n    },\n  ]\n\n  // add track's view level menu options\n  for (const [key, value] of self.trackTypeActions.entries()) {\n    if (value.length) {\n      menuItems.push(\n        {\n          type: 'divider',\n        },\n        {\n          type: 'subHeader',\n          label: key,\n        },\n      )\n      for (const action of value) {\n        menuItems.push(action)\n      }\n    }\n  }\n\n  return menuItems\n}\n\n/**\n * Build rubberband selection menu items\n */\nexport function buildRubberBandMenuItems(\n  self: LinearGenomeViewModel,\n): MenuItem[] {\n  const { leftOffset, rightOffset } = self\n  const leftRef = leftOffset?.refName ?? ''\n  const rightRef = rightOffset?.refName ?? ''\n  const leftCoord = toLocaleRounded((leftOffset?.coord ?? 0) + 1)\n  const rightCoord = toLocaleRounded(rightOffset?.coord ?? 0)\n  const rangeString =\n    leftRef === rightRef\n      ? `${leftRef}:${leftCoord}-${rightCoord}`\n      : `${leftRef}:${leftCoord}..${rightRef}:${rightCoord}`\n\n  return [\n    {\n      label: 'Zoom to region',\n      icon: ZoomInIcon,\n      onClick: () => {\n        self.moveTo(self.leftOffset, self.rightOffset)\n      },\n    },\n    {\n      label: 'Get sequence',\n      icon: MenuOpenIcon,\n      onClick: () => {\n        getSession(self).queueDialog(handleClose => [\n          GetSequenceDialog,\n          {\n            model: self,\n            handleClose,\n          },\n        ])\n      },\n    },\n    {\n      label: 'Copy range',\n      icon: ContentCopyIcon,\n      onClick: async () => {\n        const { default: copy } = await import('copy-to-clipboard')\n        copy(rangeString)\n      },\n    },\n  ]\n}\n\n/**\n * Build rubberband click menu items (single click on rubberband area)\n */\nexport function buildRubberbandClickMenuItems(\n  self: LinearGenomeViewModel,\n  clickOffset: BpOffset,\n): MenuItem[] {\n  const { coord, refName } = clickOffset\n  if (coord === undefined || refName === undefined) {\n    return []\n  }\n  const locString = `${refName}:${toLocaleRounded(coord + 1)}`\n  return [\n    {\n      label: 'Center view here',\n      icon: CenterFocusStrongIcon,\n      onClick: () => {\n        self.centerAt(coord, refName)\n      },\n    },\n    {\n      label: 'Zoom to base level',\n      icon: ZoomInIcon,\n      onClick: () => {\n        self.centerAt(coord, refName)\n        self.zoomTo(self.minBpPerPx)\n      },\n    },\n    {\n      label: `Copy coordinate (${locString})`,\n      icon: ContentCopyIcon,\n      onClick: async () => {\n        const { default: copy } = await import('copy-to-clipboard')\n        copy(locString)\n      },\n    },\n  ]\n}\n","import type React from 'react'\nimport { lazy } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { VIEW_HEADER_HEIGHT } from '@jbrowse/core/ui'\nimport {\n  assembleLocString,\n  clamp,\n  findLast,\n  getBpDisplayStr,\n  getSession,\n  isSessionModelWithWidgets,\n  localStorageGetBoolean,\n  localStorageGetItem,\n  measureText,\n  springAnimate,\n  sum,\n} from '@jbrowse/core/util'\nimport { bpToPx, moveTo, pxToBp } from '@jbrowse/core/util/Base1DUtils'\nimport Base1DView from '@jbrowse/core/util/Base1DViewModel'\nimport calculateDynamicBlocks from '@jbrowse/core/util/calculateDynamicBlocks'\nimport calculateStaticBlocks from '@jbrowse/core/util/calculateStaticBlocks'\nimport {\n  getParentRenderProps,\n  hideTrackGeneric,\n  showTrackGeneric,\n  toggleTrackGeneric,\n} from '@jbrowse/core/util/tracks'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { cast, getParent, getSnapshot, types } from '@jbrowse/mobx-state-tree'\nimport { isSessionWithMultipleViews } from '@jbrowse/product-core'\nimport { when } from 'mobx'\n\nimport { handleSelectedRegion } from '../searchUtils.ts'\nimport { doAfterAttach } from './afterAttach.ts'\nimport Header from './components/Header.tsx'\nimport MiniControls from './components/MiniControls.tsx'\nimport {\n  HEADER_BAR_HEIGHT,\n  HEADER_OVERVIEW_HEIGHT,\n  INTER_REGION_PADDING_WIDTH,\n  RESIZE_HANDLE_HEIGHT,\n  SCALE_BAR_HEIGHT,\n} from './consts.ts'\nimport { setupKeyboardHandler } from './keyboardHandler.ts'\nimport {\n  buildMenuItems,\n  buildRubberBandMenuItems,\n  buildRubberbandClickMenuItems,\n  rewriteOnClicks,\n} from './menuItems.tsx'\nimport {\n  calculateVisibleLocStrings,\n  expandRegion,\n  generateLocations,\n  parseLocStrings,\n} from './util.ts'\n\nimport type {\n  BpOffset,\n  ExportSvgOptions,\n  HighlightType,\n  InitState,\n  NavLocation,\n} from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type BaseResult from '@jbrowse/core/TextSearch/BaseResults'\nimport type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { ParsedLocString } from '@jbrowse/core/util'\nimport type { BaseBlock, BlockSet } from '@jbrowse/core/util/blockTypes'\nimport type { Region } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n// lazies\nconst SearchResultsDialog = lazy(\n  () => import('./components/SearchResultsDialog.tsx'),\n)\n\n/**\n * #stateModel LinearGenomeView\n * #category view\n *\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nexport function stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .compose(\n      'LinearGenomeView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        id: ElementId,\n\n        /**\n         * #property\n         * this is a string instead of the const literal 'LinearGenomeView' to\n         * reduce some typescripting strictness, but you should pass the string\n         * 'LinearGenomeView' to the model explicitly\n         */\n        type: types.literal('LinearGenomeView') as unknown as string,\n\n        /**\n         * #property\n         * corresponds roughly to the horizontal scroll of the LGV\n         */\n        offsetPx: 0,\n\n        /**\n         * #property\n         * corresponds roughly to the zoom level, base-pairs per pixel\n         */\n        bpPerPx: 1,\n\n        /**\n         * #property\n         * currently displayed regions, can be a single chromosome, arbitrary\n         * subsections, or the entire  set of chromosomes in the genome, but it not\n         * advised to use the entire set of chromosomes if your assembly is very\n         * fragmented\n         */\n        displayedRegions: types.optional(types.frozen<Region[]>(), []),\n\n        /**\n         * #property\n         * array of currently displayed tracks state models instances\n         */\n        tracks: types.array(\n          pluginManager.pluggableMstType('track', 'stateModel'),\n        ),\n\n        /**\n         * #property\n         */\n        hideHeader: false,\n\n        /**\n         * #property\n         */\n        hideHeaderOverview: false,\n\n        /**\n         * #property\n         */\n        hideNoTracksActive: false,\n\n        /**\n         * #property\n         */\n        trackSelectorType: types.optional(\n          types.enumeration(['hierarchical']),\n          'hierarchical',\n        ),\n        /**\n         * #property\n         * show the \"center line\"\n         */\n        showCenterLine: types.optional(types.boolean, () =>\n          localStorageGetBoolean('lgv-showCenterLine', false),\n        ),\n\n        /**\n         * #property\n         * show the \"cytobands\" in the overview scale bar\n         */\n        showCytobandsSetting: types.optional(types.boolean, () =>\n          localStorageGetBoolean('lgv-showCytobands', true),\n        ),\n\n        /**\n         * #property\n         * how to display the track labels, can be \"overlapping\", \"offset\", or\n         * \"hidden\", or empty string \"\" (which results in conf being used). see\n         * LinearGenomeViewPlugin\n         * https://jbrowse.org/jb2/docs/config/lineargenomeviewplugin/ docs for\n         * how conf is used\n         */\n        trackLabels: types.optional(\n          types.string,\n          () => localStorageGetItem('lgv-trackLabels') || '',\n        ),\n\n        /**\n         * #property\n         * show the \"gridlines\" in the track area\n         */\n        showGridlines: true,\n\n        /**\n         * #property\n         * highlights on the LGV from the URL parameters\n         */\n        highlight: types.optional(\n          types.array(types.frozen<HighlightType>()),\n          [],\n        ),\n\n        /**\n         * #property\n         * color by CDS\n         */\n        colorByCDS: types.optional(types.boolean, () =>\n          localStorageGetBoolean('lgv-colorByCDS', false),\n        ),\n\n        /**\n         * #property\n         * show the track outlines\n         */\n        showTrackOutlines: types.optional(types.boolean, () =>\n          localStorageGetBoolean('lgv-showTrackOutlines', true),\n        ),\n        /**\n         * #property\n         * this is a non-serialized property that can be used for loading the\n         * linear genome view via session snapshots\n         * example:\n         * ```json\n         * {\n         *   loc: \"chr1:1,000,000-2,000,000\"\n         *   assembly: \"hg19\"\n         *   tracks: [\"genes\", \"variants\"]\n         * }\n         * ```\n         */\n        init: types.frozen<InitState | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      volatileWidth: undefined as number | undefined,\n      /**\n       * #volatile\n       */\n      minimumBlockWidth: 3,\n      /**\n       * #volatile\n       */\n      draggingTrackId: undefined as undefined | string,\n      /**\n       * #volatile\n       */\n      lastTrackDragY: undefined as undefined | number,\n      /**\n       * #volatile\n       */\n      volatileError: undefined as unknown,\n\n      /**\n       * #volatile\n       */\n      scaleFactor: 1,\n      /**\n       * #volatile\n       * target bpPerPx during zoom animation, used for immediate UI feedback\n       */\n      targetBpPerPx: undefined as number | undefined,\n      /**\n       * #volatile\n       */\n      trackRefs: {} as Record<string, HTMLDivElement>,\n      /**\n       * #volatile\n       */\n      coarseDynamicBlocks: [] as BaseBlock[],\n      /**\n       * #volatile\n       */\n      coarseTotalBp: 0,\n      /**\n       * #volatile\n       */\n      leftOffset: undefined as undefined | BpOffset,\n      /**\n       * #volatile\n       */\n      rightOffset: undefined as undefined | BpOffset,\n      /**\n       * #volatile\n       */\n      isScalebarRefNameMenuOpen: false,\n      /**\n       * #volatile\n       */\n      scalebarRefNameClickPending: false,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get pinnedTracks() {\n        return self.tracks.filter(t => t.pinned)\n      },\n      /**\n       * #getter\n       */\n      get unpinnedTracks() {\n        return self.tracks.filter(t => !t.pinned)\n      },\n      /**\n       * #getter\n       * this is the effective value of the track labels setting, incorporating\n       * both the config and view state. use this instead of view.trackLabels\n       */\n      get trackLabelsSetting() {\n        const sessionSetting = getConf(getSession(self), [\n          'LinearGenomeViewPlugin',\n          'trackLabels',\n        ])\n        return self.trackLabels || sessionSetting\n      },\n      /**\n       * #getter\n       */\n      get width(): number {\n        if (self.volatileWidth === undefined) {\n          throw new Error(\n            'width undefined, make sure to check for model.initialized',\n          )\n        }\n        return self.volatileWidth\n      },\n      /**\n       * #getter\n       */\n      get interRegionPaddingWidth() {\n        return INTER_REGION_PADDING_WIDTH\n      },\n\n      /**\n       * #getter\n       */\n      get assemblyNames() {\n        return [...new Set(self.displayedRegions.map(r => r.assemblyName))]\n      },\n      /**\n       * #getter\n       */\n      get assemblyDisplayNames() {\n        const { assemblyManager } = getSession(self)\n        return this.assemblyNames.map(\n          a => assemblyManager.get(a)?.displayName ?? a,\n        )\n      },\n      /**\n       * #getter\n       * checking if lgv is a 'top-level' view is used for toggling pin track\n       * capability, sticky positioning\n       */\n      get isTopLevelView() {\n        return getSession(self).views.some(r => r.id === self.id)\n      },\n      /**\n       * #getter\n       * only uses sticky view headers when it is a 'top-level' view and\n       * session allows it\n       */\n      get stickyViewHeaders() {\n        const session = getSession(self)\n        return isSessionWithMultipleViews(session)\n          ? this.isTopLevelView && session.stickyViewHeaders\n          : false\n      },\n\n      /**\n       * #getter\n       */\n      get rubberbandTop() {\n        let pinnedTracksTop = 0\n        if (this.stickyViewHeaders) {\n          pinnedTracksTop = VIEW_HEADER_HEIGHT\n          if (!self.hideHeader) {\n            pinnedTracksTop += HEADER_BAR_HEIGHT\n            if (!self.hideHeaderOverview) {\n              pinnedTracksTop += HEADER_OVERVIEW_HEIGHT\n            }\n          }\n        }\n        return pinnedTracksTop\n      },\n\n      get pinnedTracksTop() {\n        return this.rubberbandTop + SCALE_BAR_HEIGHT\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      scalebarDisplayPrefix() {\n        return getParent<any>(self, 2).type === 'LinearSyntenyView'\n          ? self.assemblyDisplayNames[0]\n          : ''\n      },\n      /**\n       * #method\n       */\n\n      MiniControlsComponent(): React.FC<any> {\n        return MiniControls\n      },\n\n      /**\n       * #method\n       */\n\n      HeaderComponent(): React.FC<any> {\n        return Header\n      },\n\n      /**\n       * #getter\n       */\n      get assembliesNotFound() {\n        const { assemblyManager } = getSession(self)\n        const r0 = self.assemblyNames\n          .map(a => (!assemblyManager.get(a) ? a : undefined))\n          .filter(f => !!f)\n          .join(',')\n        return r0 ? `Assemblies ${r0} not found` : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get assemblyErrors() {\n        const { assemblyManager } = getSession(self)\n        return self.assemblyNames\n          .map(a => assemblyManager.get(a)?.error)\n          .filter(f => !!f)\n          .join(', ')\n      },\n\n      /**\n       * #getter\n       */\n      get assembliesInitialized() {\n        const { assemblyManager } = getSession(self)\n        return self.assemblyNames.every(\n          a => assemblyManager.get(a)?.initialized,\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get initialized() {\n        if (self.volatileWidth === undefined) {\n          return false\n        }\n        // if init is set, wait for that assembly to have regions loaded\n        if (self.init) {\n          const { assemblyManager } = getSession(self)\n          const asm = assemblyManager.get(self.init.assembly)\n          return !!(asm?.initialized && asm.regions)\n        }\n        return this.assembliesInitialized\n      },\n\n      /**\n       * #getter\n       */\n      get hasDisplayedRegions() {\n        return self.displayedRegions.length > 0\n      },\n\n      /**\n       * #getter\n       */\n      get loadingMessage() {\n        return this.showLoading ? 'Loading' : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get hasSomethingToShow() {\n        return this.hasDisplayedRegions || !!self.init\n      },\n\n      /**\n       * #getter\n       * Whether to show a loading indicator instead of the import form or view\n       */\n      get showLoading() {\n        return !this.initialized && !this.error && this.hasSomethingToShow\n      },\n\n      /**\n       * #getter\n       * Whether to show the import form\n       */\n      get showImportForm() {\n        return !this.hasSomethingToShow || !!this.error\n      },\n\n      /**\n       * #getter\n       */\n      get scalebarHeight() {\n        return SCALE_BAR_HEIGHT + RESIZE_HANDLE_HEIGHT\n      },\n\n      /**\n       * #getter\n       */\n      get headerHeight() {\n        if (self.hideHeader) {\n          return 0\n        } else if (self.hideHeaderOverview) {\n          return HEADER_BAR_HEIGHT\n        } else {\n          return HEADER_BAR_HEIGHT + HEADER_OVERVIEW_HEIGHT\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get trackHeights() {\n        return sum(self.tracks.map(t => t.displays[0].height))\n      },\n\n      /**\n       * #getter\n       */\n      get trackHeightsWithResizeHandles() {\n        return this.trackHeights + self.tracks.length * RESIZE_HANDLE_HEIGHT\n      },\n\n      /**\n       * #getter\n       */\n      get height() {\n        return (\n          this.trackHeightsWithResizeHandles +\n          this.headerHeight +\n          this.scalebarHeight\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get totalBp() {\n        return sum(self.displayedRegions.map(r => r.end - r.start))\n      },\n\n      /**\n       * #getter\n       */\n      get maxBpPerPx() {\n        return this.totalBp / (self.width * 0.9)\n      },\n\n      /**\n       * #getter\n       */\n      get minBpPerPx() {\n        return 1 / 50\n      },\n\n      /**\n       * #getter\n       */\n      get error(): unknown {\n        if (self.volatileError) {\n          return self.volatileError\n        }\n        if (this.assemblyErrors) {\n          return this.assemblyErrors\n        }\n        if (this.assembliesNotFound) {\n          return this.assembliesNotFound\n        }\n        // Check init assembly for errors (displayedRegions may be empty during init)\n        if (self.init) {\n          const { assemblyManager } = getSession(self)\n          const asm = assemblyManager.get(self.init.assembly)\n          if (asm?.error) {\n            return asm.error\n          }\n          if (!asm) {\n            return `Assembly ${self.init.assembly} not found`\n          }\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       */\n      get maxOffset() {\n        // objectively determined to keep the linear genome on the main screen\n        const leftPadding = 10\n        return this.displayedRegionsTotalPx - leftPadding\n      },\n\n      /**\n       * #getter\n       */\n      get minOffset() {\n        // objectively determined to keep the linear genome on the main screen\n        const rightPadding = 30\n        return -self.width + rightPadding\n      },\n\n      /**\n       * #getter\n       */\n      get displayedRegionsTotalPx() {\n        return this.totalBp / self.bpPerPx\n      },\n\n      /**\n       * #method\n       */\n      renderProps() {\n        return {\n          ...getParentRenderProps(self),\n          bpPerPx: self.bpPerPx,\n          colorByCDS: self.colorByCDS,\n        }\n      },\n\n      /**\n       * #method\n       */\n      searchScope(assemblyName: string) {\n        return {\n          assemblyName,\n          includeAggregateIndexes: true,\n          tracks: self.tracks,\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get trackMap() {\n        const map = new Map()\n        for (const track of self.tracks) {\n          map.set(track.configuration.trackId, track)\n        }\n        return map\n      },\n\n      /**\n       * #method\n       */\n      getTrack(id: string) {\n        return this.trackMap.get(id)\n      },\n\n      /**\n       * #method\n       * does nothing currently\n       */\n      rankSearchResults(results: BaseResult[]) {\n        return results\n      },\n\n      /**\n       * #getter\n       */\n      get trackTypeActions() {\n        const allActions = new Map<string, MenuItem[]>()\n        for (const track of self.tracks) {\n          const trackInMap = allActions.get(track.type)\n          if (!trackInMap) {\n            const viewMenuActions = structuredClone(track.viewMenuActions)\n            rewriteOnClicks(\n              self as LinearGenomeViewModel,\n              track.type,\n              viewMenuActions,\n            )\n            allActions.set(track.type, viewMenuActions)\n          }\n        }\n\n        return allActions\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setShowTrackOutlines(arg: boolean) {\n        self.showTrackOutlines = arg\n      },\n      /**\n       * #action\n       */\n      setColorByCDS(flag: boolean) {\n        self.colorByCDS = flag\n      },\n      /**\n       * #action\n       */\n      setShowCytobands(flag: boolean) {\n        self.showCytobandsSetting = flag\n      },\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.volatileWidth = newWidth\n      },\n      /**\n       * #action\n       */\n      setError(error: unknown) {\n        self.volatileError = error\n      },\n      /**\n       * #action\n       */\n      setIsScalebarRefNameMenuOpen(isOpen: boolean) {\n        self.isScalebarRefNameMenuOpen = isOpen\n      },\n      /**\n       * #action\n       */\n      setScalebarRefNameClickPending(pending: boolean) {\n        self.scalebarRefNameClickPending = pending\n      },\n      /**\n       * #action\n       */\n      setHideHeader(b: boolean) {\n        self.hideHeader = b\n      },\n      /**\n       * #action\n       */\n      setHideHeaderOverview(b: boolean) {\n        self.hideHeaderOverview = b\n      },\n      /**\n       * #action\n       */\n      setHideNoTracksActive(b: boolean) {\n        self.hideNoTracksActive = b\n      },\n      /**\n       * #action\n       */\n      setShowGridlines(b: boolean) {\n        self.showGridlines = b\n      },\n      /**\n       * #action\n       */\n      addToHighlights(highlight: HighlightType) {\n        self.highlight.push(highlight)\n      },\n      /**\n       * #action\n       */\n      setHighlight(highlight?: HighlightType[]) {\n        self.highlight = cast(highlight)\n      },\n      /**\n       * #action\n       */\n      removeHighlight(highlight: HighlightType) {\n        self.highlight.remove(highlight)\n      },\n      /**\n       * #action\n       */\n      scrollTo(offsetPx: number) {\n        const newOffsetPx = clamp(offsetPx, self.minOffset, self.maxOffset)\n        self.offsetPx = newOffsetPx\n        return newOffsetPx\n      },\n\n      /**\n       * #action\n       */\n      zoomTo(bpPerPx: number, offset = self.width / 2, centerAtOffset = false) {\n        const newBpPerPx = clamp(bpPerPx, self.minBpPerPx, self.maxBpPerPx)\n        if (newBpPerPx === self.bpPerPx) {\n          return newBpPerPx\n        }\n        const oldBpPerPx = self.bpPerPx\n\n        if (Math.abs(oldBpPerPx - newBpPerPx) < 0.000001) {\n          console.warn('zoomTo bpPerPx rounding error')\n          return oldBpPerPx\n        }\n        self.bpPerPx = newBpPerPx\n\n        // tweak the offset so that the center of the view remains at the same\n        // coordinate\n        const newOffsetPx = Math.round(\n          ((self.offsetPx + offset) * oldBpPerPx) / newBpPerPx -\n            (centerAtOffset ? self.width / 2 : offset),\n        )\n        this.scrollTo(newOffsetPx)\n        return newBpPerPx\n      },\n\n      /**\n       * #action\n       * sets offsets of rubberband, used in the get sequence dialog can call\n       * view.getSelectedRegions(view.leftOffset,view.rightOffset) to compute\n       * the selected regions from the offsets\n       */\n      setOffsets(left?: BpOffset, right?: BpOffset) {\n        self.leftOffset = left\n        self.rightOffset = right\n      },\n\n      /**\n       * #action\n       */\n      setSearchResults(\n        searchResults: BaseResult[],\n        searchQuery: string,\n        assemblyName?: string,\n      ) {\n        getSession(self).queueDialog(handleClose => [\n          SearchResultsDialog,\n          {\n            model: self as LinearGenomeViewModel,\n            searchResults,\n            searchQuery,\n            handleClose,\n            assemblyName,\n          },\n        ])\n      },\n\n      /**\n       * #action\n       */\n      setNewView(bpPerPx: number, offsetPx: number) {\n        this.zoomTo(bpPerPx)\n        this.scrollTo(offsetPx)\n      },\n\n      /**\n       * #action\n       */\n      horizontallyFlip() {\n        self.displayedRegions = cast(\n          [...self.displayedRegions]\n            .reverse()\n            .map(region => ({ ...region, reversed: !region.reversed })),\n        )\n        this.scrollTo(self.totalBp / self.bpPerPx - self.offsetPx - self.width)\n      },\n\n      /**\n       * #action\n       */\n      showTrack(\n        trackId: string,\n        initialSnapshot = {},\n        displayInitialSnapshot = {},\n      ) {\n        return showTrackGeneric(\n          self,\n          trackId,\n          initialSnapshot,\n          displayInitialSnapshot,\n        )\n      },\n      /**\n       * #action\n       */\n      hideTrack(trackId: string) {\n        return hideTrackGeneric(self, trackId)\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      moveTrackDown(id: string) {\n        const idx = self.tracks.findIndex(v => v.id === id)\n        if (idx !== -1 && idx < self.tracks.length - 1) {\n          self.tracks.splice(idx, 2, self.tracks[idx + 1], self.tracks[idx])\n        }\n      },\n      /**\n       * #action\n       */\n      moveTrackUp(id: string) {\n        const idx = self.tracks.findIndex(track => track.id === id)\n        if (idx > 0) {\n          self.tracks.splice(idx - 1, 2, self.tracks[idx], self.tracks[idx - 1])\n        }\n      },\n      /**\n       * #action\n       */\n      moveTrackToTop(id: string) {\n        const track = self.tracks.find(track => track.id === id)\n        if (track) {\n          self.tracks = cast([track, ...self.tracks.filter(t => t.id !== id)])\n        }\n      },\n      /**\n       * #action\n       */\n      moveTrackToBottom(id: string) {\n        const track = self.tracks.find(track => track.id === id)\n        if (track) {\n          self.tracks = cast([...self.tracks.filter(t => t.id !== id), track])\n        }\n      },\n      /**\n       * #action\n       */\n      moveTrack(movingId: string, targetId: string) {\n        const oldIndex = self.tracks.findIndex(track => track.id === movingId)\n        if (oldIndex === -1) {\n          throw new Error(`Track ID ${movingId} not found`)\n        }\n        const newIndex = self.tracks.findIndex(track => track.id === targetId)\n        if (newIndex === -1) {\n          throw new Error(`Track ID ${targetId} not found`)\n        }\n\n        const tracks = self.tracks.filter((_, idx) => idx !== oldIndex)\n        tracks.splice(newIndex, 0, self.tracks[oldIndex])\n        self.tracks = cast(tracks)\n      },\n\n      /**\n       * #action\n       */\n      toggleTrack(trackId: string) {\n        toggleTrackGeneric(self, trackId)\n      },\n\n      /**\n       * #action\n       */\n      setTrackLabels(setting: 'overlapping' | 'offset' | 'hidden') {\n        self.trackLabels = setting\n      },\n\n      /**\n       * #action\n       */\n      setShowCenterLine(b: boolean) {\n        self.showCenterLine = b\n      },\n\n      /**\n       * #action\n       */\n      setDisplayedRegions(regions: Region[]) {\n        self.displayedRegions = cast(regions)\n        self.zoomTo(self.bpPerPx)\n      },\n\n      /**\n       * #action\n       */\n      activateTrackSelector() {\n        if (self.trackSelectorType === 'hierarchical') {\n          const session = getSession(self)\n          if (isSessionModelWithWidgets(session)) {\n            const selector = session.addWidget(\n              'HierarchicalTrackSelectorWidget',\n              'hierarchicalTrackSelector',\n              { view: self },\n            )\n            session.showWidget(selector)\n            return selector\n          }\n        }\n        throw new Error(`invalid track selector type ${self.trackSelectorType}`)\n      },\n\n      /**\n       * #method\n       * Helper method for the fetchSequence.\n       * Retrieves the corresponding regions that were selected by the\n       * rubberband\n       *\n       * @param leftOffset - `object as {start, end, index, offset}`, offset = start\n       * of user drag\n       * @param rightOffset - `object as {start, end, index, offset}`,\n       * offset = end of user drag\n       * @returns array of Region[]\n       */\n      getSelectedRegions(leftOffset?: BpOffset, rightOffset?: BpOffset) {\n        const snap = getSnapshot(self)\n        const simView = Base1DView.create({\n          ...snap,\n          interRegionPaddingWidth: self.interRegionPaddingWidth,\n        })\n\n        simView.setVolatileWidth(self.width)\n        simView.moveTo(leftOffset, rightOffset)\n\n        return simView.dynamicBlocks.contentBlocks.map(region => ({\n          assemblyName: region.assemblyName,\n          refName: region.refName,\n          start: Math.floor(region.start),\n          end: Math.ceil(region.end),\n        }))\n      },\n\n      /**\n       * #action\n       */\n      horizontalScroll(distance: number) {\n        const oldOffsetPx = self.offsetPx\n        // newOffsetPx is the actual offset after the scroll is clamped\n        const newOffsetPx = self.scrollTo(self.offsetPx + distance)\n        return newOffsetPx - oldOffsetPx\n      },\n\n      /**\n       * #action\n       */\n      center() {\n        // Calculate total content width including inter-region padding\n        const numPaddings = Math.max(0, self.displayedRegions.length - 1)\n        const totalPaddingPx = numPaddings * self.interRegionPaddingWidth\n        const totalContentPx = self.totalBp / self.bpPerPx + totalPaddingPx\n        const centerPx = totalContentPx / 2\n        const targetOffsetPx = Math.round(centerPx - self.width / 2)\n        self.scrollTo(targetOffsetPx)\n      },\n\n      /**\n       * #action\n       */\n      showAllRegions() {\n        // Set zoom to show all regions, then center the view\n        self.bpPerPx = clamp(self.maxBpPerPx, self.minBpPerPx, self.maxBpPerPx)\n        this.center()\n      },\n\n      /**\n       * #action\n       */\n      showAllRegionsInAssembly(assemblyName?: string) {\n        const session = getSession(self)\n        const { assemblyManager } = session\n        if (!assemblyName) {\n          const names = new Set(self.displayedRegions.map(r => r.assemblyName))\n          if (names.size > 1) {\n            session.notify(\n              `Can't perform operation with multiple assemblies currently`,\n            )\n            return\n          }\n          ;[assemblyName] = [...names]\n        }\n        const regions = assemblyManager.get(assemblyName!)?.regions\n        if (!regions) {\n          return\n        }\n        this.setDisplayedRegions(regions)\n        self.zoomTo(self.maxBpPerPx)\n        this.center()\n      },\n\n      /**\n       * #action\n       */\n      setDraggingTrackId(idx?: string) {\n        self.draggingTrackId = idx\n        if (idx === undefined) {\n          self.lastTrackDragY = undefined\n        }\n      },\n\n      /**\n       * #action\n       */\n      setLastTrackDragY(y: number) {\n        self.lastTrackDragY = y\n      },\n\n      /**\n       * #action\n       */\n      setScaleFactor(factor: number) {\n        self.scaleFactor = factor\n      },\n\n      /**\n       * #action\n       */\n      setTargetBpPerPx(target: number | undefined) {\n        self.targetBpPerPx = target\n      },\n\n      /**\n       * #action\n       * this \"clears the view\" and makes the view return to the import form\n       */\n      clearView() {\n        this.setDisplayedRegions([])\n        self.tracks.clear()\n        // it is necessary to run these after setting displayed regions empty\n        // or else model.offsetPx gets set to Infinity and breaks\n        // @jbrowse/mobx-state-tree snapshot\n        self.scrollTo(0)\n        self.zoomTo(10)\n      },\n\n      /**\n       * #action\n       */\n      setInit(arg?: InitState) {\n        self.init = arg\n      },\n\n      /**\n       * #method\n       * creates an svg export and save using FileSaver\n       */\n      async exportSvg(opts: ExportSvgOptions = {}) {\n        const { renderToSvg } =\n          await import('./svgcomponents/SVGLinearGenomeView.tsx')\n        const html = await renderToSvg(self as LinearGenomeViewModel, opts)\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        const { saveAs } = await import('file-saver-es')\n\n        saveAs(\n          new Blob([html], { type: 'image/svg+xml' }),\n          opts.filename || 'image.svg',\n        )\n      },\n    }))\n    .actions(self => {\n      let cancelLastAnimation = () => {}\n\n      /**\n       * #action\n       * perform animated slide\n       */\n      function slide(viewWidths: number) {\n        const [animate, cancelAnimation] = springAnimate(\n          self.offsetPx,\n          self.offsetPx + self.width * viewWidths,\n          self.scrollTo,\n          undefined,\n          undefined,\n          200,\n        )\n        cancelLastAnimation()\n        cancelLastAnimation = cancelAnimation!\n        animate!()\n      }\n\n      return { slide }\n    })\n    .actions(self => {\n      let cancelLastAnimation = () => {}\n\n      /**\n       * #action\n       * perform animated zoom\n       */\n      function zoom(targetBpPerPx: number) {\n        cancelLastAnimation()\n\n        // Calculate the zoom factor the caller intended (e.g., 2 for zoom out, 0.5 for zoom in)\n        const intendedFactor = targetBpPerPx / self.bpPerPx\n\n        // Apply that factor to the pending target (if mid-animation) or current bpPerPx\n        // This allows rapid clicks to accumulate\n        const effectiveBase = self.targetBpPerPx ?? self.bpPerPx\n        let effectiveTarget = effectiveBase * intendedFactor\n\n        // Clamp to zoom limits\n        effectiveTarget = Math.max(\n          self.minBpPerPx,\n          Math.min(self.maxBpPerPx, effectiveTarget),\n        )\n\n        const currentTarget = self.targetBpPerPx ?? self.bpPerPx\n\n        // If already at limit (or effectively no change), do nothing\n        if (effectiveTarget === currentTarget) {\n          return\n        }\n\n        // Set target immediately for UI feedback\n        self.setTargetBpPerPx(effectiveTarget)\n\n        // Calculate target scale factor relative to committed bpPerPx\n        // Don't update bpPerPx until animation completes - keeps blocks stable\n        const targetScaleFactor = self.bpPerPx / effectiveTarget\n\n        // Animate from current scaleFactor to target (smooth continuation on rapid clicks)\n        const [animate, cancelAnimation] = springAnimate(\n          self.scaleFactor,\n          targetScaleFactor,\n          self.setScaleFactor,\n          () => {\n            self.zoomTo(effectiveTarget)\n            self.setScaleFactor(1)\n            self.setTargetBpPerPx(undefined)\n          },\n          0,\n          1000,\n          50,\n        )\n        cancelLastAnimation = cancelAnimation!\n        animate!()\n      }\n\n      return { zoom }\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get canShowCytobands() {\n        return self.displayedRegions.length === 1 && this.anyCytobandsExist\n      },\n      /**\n       * #getter\n       */\n      get showCytobands() {\n        return this.canShowCytobands && self.showCytobandsSetting\n      },\n      /**\n       * #getter\n       */\n      get anyCytobandsExist() {\n        const { assemblyManager } = getSession(self)\n        return self.assemblyNames.some(\n          a => assemblyManager.get(a)?.cytobands?.length,\n        )\n      },\n      /**\n       * #getter\n       * the cytoband is displayed to the right of the chromosome name, and\n       * that offset is calculated manually with this method\n       */\n      get cytobandOffset() {\n        return this.showCytobands\n          ? measureText(self.displayedRegions[0]?.refName || '', 12) + 15\n          : 0\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * return the view menu items\n       */\n      menuItems(): MenuItem[] {\n        return buildMenuItems(self as LinearGenomeViewModel)\n      },\n    }))\n    .views(self => {\n      let currentlyCalculatedStaticBlocks: BlockSet | undefined\n      let currentBlockKeys: string | undefined\n      return {\n        /**\n         * #getter\n         * static blocks are an important concept jbrowse uses to avoid\n         * re-rendering when you scroll to the side. when you horizontally\n         * scroll to the right, old blocks to the left may be removed, and new\n         * blocks may be instantiated on the right. tracks may use the static\n         * blocks to render their data for the region represented by the block\n         */\n        get staticBlocks() {\n          const newBlocks = calculateStaticBlocks(self)\n          const newKeys = newBlocks.blocks.map(b => b.key).join(',')\n          if (\n            currentlyCalculatedStaticBlocks === undefined ||\n            currentBlockKeys !== newKeys\n          ) {\n            currentlyCalculatedStaticBlocks = newBlocks\n            currentBlockKeys = newKeys\n            return currentlyCalculatedStaticBlocks\n          } else {\n            return currentlyCalculatedStaticBlocks\n          }\n        },\n        /**\n         * #getter\n         * dynamic blocks represent the exact coordinates of the currently\n         * visible genome regions on the screen. they are similar to static\n         * blocks, but static blocks can go offscreen while dynamic blocks\n         * represent exactly what is on screen\n         */\n        get dynamicBlocks() {\n          return calculateDynamicBlocks(self)\n        },\n        /**\n         * #getter\n         * rounded dynamic blocks are dynamic blocks without fractions of bp\n         */\n        get roundedDynamicBlocks() {\n          return this.dynamicBlocks.contentBlocks.map(\n            block =>\n              ({\n                // eslint-disable-next-line @typescript-eslint/no-misused-spread\n                ...block,\n                start: Math.floor(block.start),\n                end: Math.ceil(block.end),\n              }) as BaseBlock,\n          )\n        },\n\n        /**\n         * #getter\n         * a single \"combo-locstring\" representing all the regions visible on\n         * the screen\n         */\n        get visibleLocStrings() {\n          return calculateVisibleLocStrings(this.dynamicBlocks.contentBlocks)\n        },\n\n        /**\n         * #getter\n         * same as visibleLocStrings, but only updated every 300ms\n         */\n        get coarseVisibleLocStrings() {\n          return calculateVisibleLocStrings(self.coarseDynamicBlocks)\n        },\n\n        /**\n         * #getter\n         */\n        get coarseTotalBpDisplayStr() {\n          return getBpDisplayStr(self.coarseTotalBp)\n        },\n\n        /**\n         * #getter\n         * effective bpPerPx accounting for pending zoom target\n         */\n        get effectiveBpPerPx() {\n          return self.targetBpPerPx ?? self.bpPerPx\n        },\n\n        /**\n         * #getter\n         * total bp based on effective bpPerPx (updates immediately on zoom click)\n         */\n        get effectiveTotalBp() {\n          return this.effectiveBpPerPx * self.width\n        },\n\n        /**\n         * #getter\n         * display string for effective total bp (updates immediately on zoom click)\n         */\n        get effectiveTotalBpDisplayStr() {\n          return getBpDisplayStr(this.effectiveTotalBp)\n        },\n      }\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setCoarseDynamicBlocks(blocks: BlockSet) {\n        self.coarseDynamicBlocks = blocks.contentBlocks\n        self.coarseTotalBp = blocks.totalBp\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * offset is the base-pair-offset in the displayed region, index is the\n       * index of the displayed region in the linear genome view\n       *\n       * @param start - object as `{start, end, offset, index}`\n       * @param end - object as `{start, end, offset, index}`\n       */\n      moveTo(start?: BpOffset, end?: BpOffset) {\n        moveTo(self, start, end)\n      },\n\n      /**\n       * #action\n       * Navigate to the given locstring, will change displayed regions if\n       * needed, and wait for assemblies to be initialized\n       *\n       * @param input - e.g. \"chr1:1-100\", \"chr1:1-100 chr2:1-100\", \"chr 1 100\"\n       * @param optAssemblyName - (optional) the assembly name to use when\n       * navigating to the locstring\n       * @param grow - optional multiplier to expand the region by (e.g., 0.2\n       * adds 20% padding on each side)\n       */\n      async navToLocString(\n        input: string,\n        optAssemblyName?: string,\n        grow?: number,\n      ) {\n        const { assemblyNames } = self\n        const { assemblyManager } = getSession(self)\n        const assemblyName = optAssemblyName || assemblyNames[0]!\n        if (assemblyName) {\n          await assemblyManager.waitForAssembly(assemblyName)\n        }\n\n        return this.navToLocations(\n          parseLocStrings(input, assemblyName, (ref, asm) =>\n            assemblyManager.isValidRefName(ref, asm),\n          ),\n          assemblyName,\n          grow,\n        )\n      },\n\n      /**\n       * #action\n       * Performs a text index search, and navigates to it immediately if a\n       * single result is returned. Will pop up a search dialog if multiple\n       * results are returned\n       */\n      async navToSearchString({\n        input,\n        assembly,\n      }: {\n        input: string\n        assembly: Assembly\n      }) {\n        await handleSelectedRegion({\n          input,\n          assembly,\n          model: self as LinearGenomeViewModel,\n        })\n      },\n\n      /**\n       * #action\n       * Similar to `navToLocString`, but accepts a parsed location object\n       * instead of a locstring. Will try to perform `setDisplayedRegions` if\n       * changing regions\n       *\n       * @param parsedLocString - a parsed location object with refName, start,\n       * end, etc.\n       * @param assemblyName - optional assembly name\n       * @param grow - optional multiplier to expand the region by (e.g., 0.2\n       * adds 20% padding on each side)\n       */\n      async navToLocation(\n        parsedLocString: ParsedLocString,\n        assemblyName?: string,\n        grow?: number,\n      ) {\n        return this.navToLocations([parsedLocString], assemblyName, grow)\n      },\n\n      /**\n       * #action\n       * Similar to `navToLocString`, but accepts a list of parsed location\n       * objects instead of a locstring. Will try to perform\n       * `setDisplayedRegions` if changing regions\n       *\n       * @param regions - array of parsed location objects\n       * @param assemblyName - optional assembly name\n       * @param grow - optional multiplier to expand the region by (e.g., 0.2\n       * adds 20% padding on each side)\n       */\n      async navToLocations(\n        regions: ParsedLocString[],\n        assemblyName?: string,\n        grow?: number,\n      ) {\n        const { assemblyManager } = getSession(self)\n        await when(() => self.volatileWidth !== undefined)\n\n        // Generate locations from the parsed regions\n        const locations = await generateLocations({\n          regions,\n          assemblyManager,\n          assemblyName,\n          grow,\n        })\n\n        // Handle single location case\n        if (locations.length === 1) {\n          const location = locations[0]!\n          const { reversed, parentRegion, start, end } = location\n\n          // Set the displayed region based on the parent region\n          self.setDisplayedRegions([\n            {\n              reversed,\n              ...parentRegion,\n            },\n          ])\n\n          // Navigate to the specific coordinates within the region\n          this.navTo({\n            ...location,\n            start: clamp(start ?? 0, 0, parentRegion.end),\n            end: clamp(end ?? parentRegion.end, 0, parentRegion.end),\n          })\n        }\n        // Handle multiple locations case\n        else {\n          self.setDisplayedRegions(\n            locations.map(location => {\n              const { start, end } = location\n              return start === undefined || end === undefined\n                ? location.parentRegion\n                : {\n                    ...location,\n                    start,\n                    end,\n                  }\n            }),\n          )\n          self.showAllRegions()\n        }\n      },\n\n      /**\n       * #action\n       * Navigate to a location based on its refName and optionally start, end,\n       * and assemblyName. Will not try to change displayed regions, use\n       * `navToLocations` instead. Only navigates to a location if it is\n       * entirely within a displayedRegion. Navigates to the first matching\n       * location encountered.\n       *\n       * Throws an error if navigation was unsuccessful\n       *\n       * @param query - a proposed location to navigate to\n       * @param grow - optional multiplier to expand the region by (e.g., 0.2\n       * adds 20% padding on each side)\n       */\n      navTo(query: NavLocation, grow?: number) {\n        this.navToMultiple([query], grow)\n      },\n\n      /**\n       * #action\n       * Navigate to a location based on its refName and optionally start, end,\n       * and assemblyName. Will not try to change displayed regions, use\n       * navToLocations instead. Only navigates to a location if it is entirely\n       * within a displayedRegion. Navigates to the first matching location\n       * encountered.\n       *\n       * Throws an error if navigation was unsuccessful\n       *\n       * @param locations - proposed location to navigate to\n       * @param grow - optional multiplier to expand the region by (e.g., 0.2\n       * adds 20% padding on each side)\n       */\n      navToMultiple(locations: NavLocation[], grow?: number) {\n        if (\n          locations.some(\n            l =>\n              l.start !== undefined && l.end !== undefined && l.start > l.end,\n          )\n        ) {\n          throw new Error('found start greater than end')\n        }\n\n        const firstLocation = locations.at(0)\n        const lastLocation = locations.at(-1)\n        if (!firstLocation || !lastLocation) {\n          return\n        }\n\n        // Get assembly information\n        const defaultAssemblyName = self.assemblyNames[0]!\n        const { assemblyManager } = getSession(self)\n\n        // Process first location\n        const firstAssembly = assemblyManager.get(\n          firstLocation.assemblyName || defaultAssemblyName,\n        )\n        const firstRefName =\n          firstAssembly?.getCanonicalRefName(firstLocation.refName) ||\n          firstLocation.refName\n        const firstRegion = self.displayedRegions.find(\n          r => r.refName === firstRefName,\n        )\n\n        // Process last location\n        const lastAssembly = assemblyManager.get(\n          lastLocation.assemblyName || defaultAssemblyName,\n        )\n        const lastRefName =\n          lastAssembly?.getCanonicalRefName(lastLocation.refName) ||\n          lastLocation.refName\n        const lastRegion = findLast(\n          self.displayedRegions,\n          r => r.refName === lastRefName,\n        )\n\n        // Validate regions exist\n        if (!firstRegion) {\n          throw new Error(\n            `could not find a region with refName \"${firstRefName}\"`,\n          )\n        }\n        if (!lastRegion) {\n          throw new Error(\n            `could not find a region with refName \"${lastRefName}\"`,\n          )\n        }\n\n        // Calculate coordinates, using region bounds if not specified\n        let firstStart =\n          firstLocation.start === undefined\n            ? firstRegion.start\n            : firstLocation.start\n        let firstEnd =\n          firstLocation.end === undefined ? firstRegion.end : firstLocation.end\n        let lastStart =\n          lastLocation.start === undefined\n            ? lastRegion.start\n            : lastLocation.start\n        let lastEnd =\n          lastLocation.end === undefined ? lastRegion.end : lastLocation.end\n\n        // Apply grow factor to add padding around the region\n        if (grow) {\n          const expanded = expandRegion(\n            firstStart,\n            lastEnd,\n            grow,\n            firstRegion.start,\n            lastRegion.end,\n          )\n          firstStart = expanded.start\n          firstEnd = expanded.end\n          lastStart = expanded.start\n          lastEnd = expanded.end\n        }\n\n        // Find region indices that contain our locations\n        const firstIndex = self.displayedRegions.findIndex(\n          r =>\n            firstRefName === r.refName &&\n            firstStart >= r.start &&\n            firstStart <= r.end &&\n            firstEnd <= r.end &&\n            firstEnd >= r.start,\n        )\n\n        const lastIndex = self.displayedRegions.findIndex(\n          r =>\n            lastRefName === r.refName &&\n            lastStart >= r.start &&\n            lastStart <= r.end &&\n            lastEnd <= r.end &&\n            lastEnd >= r.start,\n        )\n\n        if (firstIndex === -1 || lastIndex === -1) {\n          throw new Error(\n            `could not find a region that contained \"${locations.map(l =>\n              assembleLocString(l),\n            )}\"`,\n          )\n        }\n\n        const startDisplayedRegion = self.displayedRegions[firstIndex]!\n        const endDisplayedRegion = self.displayedRegions[lastIndex]!\n\n        // Calculate offsets, accounting for reversed regions\n        const startOffset = startDisplayedRegion.reversed\n          ? startDisplayedRegion.end - firstEnd\n          : firstStart - startDisplayedRegion.start\n\n        const endOffset = endDisplayedRegion.reversed\n          ? endDisplayedRegion.end - lastStart\n          : lastEnd - endDisplayedRegion.start\n\n        this.moveTo(\n          {\n            index: firstIndex,\n            offset: startOffset,\n          },\n          {\n            index: lastIndex,\n            offset: endOffset,\n          },\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      rubberBandMenuItems(): MenuItem[] {\n        return buildRubberBandMenuItems(self as LinearGenomeViewModel)\n      },\n\n      /**\n       * #method\n       */\n      bpToPx({\n        refName,\n        coord,\n        regionNumber,\n      }: {\n        refName: string\n        coord: number\n        regionNumber?: number\n      }) {\n        return bpToPx({ refName, coord, regionNumber, self })\n      },\n\n      /**\n       * #method\n       * scrolls the view to center on the given bp. if that is not in any of\n       * the displayed regions, does nothing\n       *\n       * @param coord - basepair at which you want to center the view\n       * @param refName - refName of the displayedRegion you are centering at\n       * @param regionNumber - index of the displayedRegion\n       */\n      centerAt(coord: number, refName: string, regionNumber?: number) {\n        const centerPx = this.bpToPx({\n          refName,\n          coord,\n          regionNumber,\n        })\n        if (centerPx !== undefined) {\n          self.scrollTo(Math.round(centerPx.offsetPx - self.width / 2))\n        }\n      },\n\n      /**\n       * #method\n       */\n      pxToBp(px: number) {\n        return pxToBp(self, px)\n      },\n\n      /**\n       * #getter\n       */\n      get centerLineInfo() {\n        return self.displayedRegions.length > 0\n          ? this.pxToBp(self.width / 2)\n          : undefined\n      },\n\n      get visibleRegions() {\n        return self.dynamicBlocks.contentBlocks\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      rubberbandClickMenuItems(clickOffset: BpOffset): MenuItem[] {\n        return buildRubberbandClickMenuItems(\n          self as LinearGenomeViewModel,\n          clickOffset,\n        )\n      },\n    }))\n    .actions(self => ({\n      afterCreate() {\n        setupKeyboardHandler(self as LinearGenomeViewModel)\n      },\n\n      afterAttach() {\n        doAfterAttach(self as LinearGenomeViewModel)\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { highlight, ...rest } = snap\n      return {\n        highlight:\n          Array.isArray(highlight) || highlight === undefined\n            ? highlight\n            : [highlight],\n        ...rest,\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        init,\n        offsetPx,\n        bpPerPx,\n        hideHeader,\n        hideHeaderOverview,\n        hideNoTracksActive,\n        showGridlines,\n        trackSelectorType,\n        displayedRegions,\n        highlight,\n        showCenterLine,\n        showCytobandsSetting,\n        trackLabels,\n        colorByCDS,\n        showTrackOutlines,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n\n      return {\n        ...rest,\n        // only include non-default values\n        ...(offsetPx ? { offsetPx } : {}),\n        ...(bpPerPx !== 1 ? { bpPerPx } : {}),\n        ...(hideHeader ? { hideHeader } : {}),\n        ...(hideHeaderOverview ? { hideHeaderOverview } : {}),\n        ...(hideNoTracksActive ? { hideNoTracksActive } : {}),\n        ...(!showGridlines ? { showGridlines } : {}),\n        ...(trackSelectorType !== 'hierarchical' ? { trackSelectorType } : {}),\n        ...(displayedRegions.length ? { displayedRegions } : {}),\n        ...(highlight.length ? { highlight } : {}),\n        ...(showCenterLine ? { showCenterLine } : {}),\n        ...(!showCytobandsSetting ? { showCytobandsSetting } : {}),\n        ...(trackLabels ? { trackLabels } : {}),\n        ...(colorByCDS ? { colorByCDS } : {}),\n        ...(!showTrackOutlines ? { showTrackOutlines } : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearGenomeViewStateModel = ReturnType<typeof stateModelFactory>\nexport type LinearGenomeViewModel = Instance<LinearGenomeViewStateModel>\n\nexport {\n  default as LinearGenomeView,\n  default as ReactComponent,\n} from './components/LinearGenomeView.tsx'\n\nexport { default as RefNameAutocomplete } from './components/RefNameAutocomplete/index.tsx'\nexport { default as SearchBox } from './components/SearchBox.tsx'\n\nexport { renderToSvg } from './svgcomponents/SVGLinearGenomeView.tsx'\n","import { getSession } from '@jbrowse/core/util'\nimport { addDisposer } from '@jbrowse/mobx-state-tree'\n\nimport type { LinearGenomeViewModel } from './model.ts'\n\n/**\n * Sets up keyboard shortcuts for the LinearGenomeView\n * - Ctrl/Cmd + ArrowLeft: slide left\n * - Ctrl/Cmd + ArrowRight: slide right\n * - Ctrl/Cmd + ArrowUp: zoom in\n * - Ctrl/Cmd + ArrowDown: zoom out\n */\nexport function setupKeyboardHandler(self: LinearGenomeViewModel) {\n  function handler(e: KeyboardEvent) {\n    const session = getSession(self)\n    if (session.focusedViewId === self.id && (e.ctrlKey || e.metaKey)) {\n      if (e.code === 'ArrowLeft') {\n        e.preventDefault()\n        self.slide(-0.9)\n      } else if (e.code === 'ArrowRight') {\n        e.preventDefault()\n        self.slide(0.9)\n      } else if (e.code === 'ArrowUp') {\n        e.preventDefault()\n        self.zoom(self.bpPerPx / 2)\n      } else if (e.code === 'ArrowDown') {\n        e.preventDefault()\n        self.zoom(self.bpPerPx * 2)\n      }\n    }\n  }\n  document.addEventListener('keydown', handler)\n  addDisposer(self, () => {\n    document.removeEventListener('keydown', handler)\n  })\n}\n","import {\n  getSession,\n  localStorageSetItem,\n  parseLocString,\n} from '@jbrowse/core/util'\nimport { addDisposer } from '@jbrowse/mobx-state-tree'\nimport { autorun, when } from 'mobx'\n\nimport type { LinearGenomeViewModel } from './model.ts'\n\n/**\n * Autorun that handles the init state - navigating to initial location,\n * showing tracks, etc.\n */\nexport function setupInitAutorun(self: LinearGenomeViewModel) {\n  addDisposer(\n    self,\n    autorun(\n      async function initAutorun() {\n        const { init, initialized } = self\n        if (!initialized) {\n          return\n        }\n        if (init) {\n          const session = getSession(self)\n          const { assemblyManager } = session\n\n          // Workaround: activate tracklist first so the drawer opens before we\n          // navigate. This ensures volatileWidth accounts for the drawer width.\n          // Without this, the navigation calculates the region based on full\n          // width, then the drawer opens and obscures part of the region.\n          if (init.tracklist) {\n            self.activateTrackSelector()\n            const currentWidth = self.volatileWidth\n            await when(() => self.volatileWidth !== currentWidth, {\n              timeout: 500,\n            }).catch(() => {\n              // Timeout is ok - width may not change if drawer was already open\n            })\n          }\n\n          try {\n            if (init.loc) {\n              await self.navToLocString(init.loc, init.assembly)\n            } else {\n              self.showAllRegionsInAssembly(init.assembly)\n            }\n          } catch (e) {\n            console.error(init, e)\n            session.notifyError(`${e}`, e)\n          }\n\n          if (init.tracks) {\n            const idsNotFound = [] as string[]\n            for (const t of init.tracks) {\n              try {\n                self.showTrack(t)\n              } catch (e) {\n                if (/Could not resolve identifier/.exec(`${e}`)) {\n                  idsNotFound.push(t)\n                } else {\n                  throw e\n                }\n              }\n            }\n            if (idsNotFound.length) {\n              session.notifyError(\n                `Could not resolve identifiers: ${idsNotFound.join(',')}`,\n                new Error(\n                  `Could not resolve identifiers: ${idsNotFound.join(',')}`,\n                ),\n              )\n            }\n          }\n\n          if (init.nav !== undefined) {\n            self.setHideHeader(!init.nav)\n          }\n\n          if (init.highlight) {\n            for (const h of init.highlight) {\n              const p = parseLocString(h, refName =>\n                assemblyManager.isValidRefName(refName, init.assembly),\n              )\n              const { start, end } = p\n              if (start !== undefined && end !== undefined) {\n                self.addToHighlights({\n                  ...p,\n                  start,\n                  end,\n                  assemblyName: init.assembly,\n                })\n              }\n            }\n          }\n\n          // clear init state\n          self.setInit(undefined)\n        }\n      },\n      { name: 'LGVInit' },\n    ),\n  )\n}\n\n/**\n * Autorun that updates coarse dynamic blocks with a delay\n */\nexport function setupCoarseDynamicBlocksAutorun(self: LinearGenomeViewModel) {\n  addDisposer(\n    self,\n    autorun(\n      function coarseDynamicBlocksAutorun() {\n        if (self.initialized) {\n          self.setCoarseDynamicBlocks(self.dynamicBlocks)\n        }\n      },\n      { delay: 500, name: 'LGVCoarseDynamicBlocks' },\n    ),\n  )\n}\n\n/**\n * Autorun that syncs view settings to localStorage\n */\nexport function setupLocalStorageAutorun(self: LinearGenomeViewModel) {\n  addDisposer(\n    self,\n    autorun(\n      function localStorageAutorun() {\n        const s = (s: unknown) => JSON.stringify(s)\n        const {\n          showCytobandsSetting,\n          showCenterLine,\n          colorByCDS,\n          showTrackOutlines,\n          trackLabels,\n        } = self\n        localStorageSetItem('lgv-showCytobands', s(showCytobandsSetting))\n        localStorageSetItem('lgv-showCenterLine', s(showCenterLine))\n        localStorageSetItem('lgv-colorByCDS', s(colorByCDS))\n        localStorageSetItem('lgv-showTrackOutlines', s(showTrackOutlines))\n        localStorageSetItem('lgv-trackLabels', trackLabels)\n      },\n      { name: 'LGVLocalStorage' },\n    ),\n  )\n}\n\n/**\n * Sets up all afterAttach autoruns for the LinearGenomeView\n */\nexport function doAfterAttach(self: LinearGenomeViewModel) {\n  setupInitAutorun(self)\n  setupCoarseDynamicBlocksAutorun(self)\n  setupLocalStorageAutorun(self)\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport LineStyleIcon from '@mui/icons-material/LineStyle'\n\nimport {\n  BaseLinearDisplay,\n  BaseLinearDisplayComponent,\n  baseLinearDisplayConfigSchema,\n} from './BaseLinearDisplay/index.ts'\nimport BasicTrackF from './BasicTrack/index.ts'\nimport FeatureTrackF from './FeatureTrack/index.ts'\nimport LaunchLinearGenomeViewF from './LaunchLinearGenomeView/index.ts'\nimport LinearBareDisplayF from './LinearBareDisplay/index.ts'\nimport LinearBasicDisplayF from './LinearBasicDisplay/index.ts'\nimport ZoomControls from './LinearGenomeView/components/HeaderZoomControls.tsx'\nimport LinearGenomeViewF, {\n  LinearGenomeView,\n  SearchBox,\n} from './LinearGenomeView/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default class LinearGenomeViewPlugin extends Plugin {\n  name = 'LinearGenomeViewPlugin'\n\n  exports = {\n    BaseLinearDisplayComponent,\n    BaseLinearDisplay,\n    baseLinearDisplayConfigSchema,\n    SearchBox,\n    ZoomControls,\n    LinearGenomeView,\n  }\n\n  /**\n   * #config LinearGenomeViewConfigSchema\n   */\n  configurationSchema = ConfigurationSchema('LinearGenomeViewConfigSchema', {\n    /**\n     * #slot configuration.LinearGenomeViewPlugin.trackLabels\n     */\n    trackLabels: {\n      type: 'string',\n      defaultValue: 'overlapping',\n      model: types.enumeration('trackLabelOptions', [\n        'offset',\n        'overlapping',\n        'hidden',\n      ]),\n    },\n  })\n\n  install(pluginManager: PluginManager) {\n    FeatureTrackF(pluginManager)\n    BasicTrackF(pluginManager)\n    LinearBasicDisplayF(pluginManager)\n    LinearGenomeViewF(pluginManager)\n    LinearBareDisplayF(pluginManager)\n    LaunchLinearGenomeViewF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['Add'], {\n        label: 'Linear genome view',\n        icon: LineStyleIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('LinearGenomeView', {})\n        },\n      })\n    }\n  }\n}\n\nexport type {\n  BaseLinearDisplayModel,\n  BlockModel,\n  ExportSvgDisplayOptions,\n  FloatingLabelData,\n  LayoutFeatureMetadata,\n  LegendItem,\n} from './BaseLinearDisplay/index.ts'\n\nexport {\n  configSchemaFactory as linearBareDisplayConfigSchemaFactory,\n  stateModelFactory as linearBareDisplayStateModelFactory,\n} from './LinearBareDisplay/index.ts'\nexport {\n  BaseLinearDisplay,\n  BaseLinearDisplayComponent,\n  BlockMsg,\n  FeatureDensityMixin,\n  FloatingLegend,\n  NonBlockCanvasDisplayComponent,\n  NonBlockCanvasDisplayMixin,\n  SVGLegend,\n  TooLargeMessage,\n  TrackHeightMixin,\n  baseLinearDisplayConfigSchema,\n  calculateSvgLegendWidth,\n  createSubfeatureLabelMetadata,\n  drawCanvasImageData,\n} from './BaseLinearDisplay/index.ts'\nexport type {\n  NonBlockCanvasDisplayMixinType,\n  NonBlockCanvasDisplayModel,\n} from './BaseLinearDisplay/index.ts'\nexport {\n  type LinearGenomeViewModel,\n  type LinearGenomeViewStateModel,\n  RefNameAutocomplete,\n  SearchBox,\n} from './LinearGenomeView/index.ts'\nexport {\n  SVGGridlines,\n  SVGRuler,\n  SVGTracks,\n  renderToSvg,\n} from './LinearGenomeView/svgcomponents/SVGLinearGenomeView.tsx'\nexport { totalHeight } from './LinearGenomeView/svgcomponents/util.ts'\nexport {\n  configSchema as linearBasicDisplayConfigSchemaFactory,\n  modelFactory as linearBasicDisplayModelFactory,\n} from './LinearBasicDisplay/index.ts'\nexport {\n  configSchema as linearFeatureDisplayConfigSchemaFactory,\n  modelFactory as linearFeatureDisplayModelFactory,\n} from './LinearFeatureDisplay/index.ts'\nexport type {\n  LinearFeatureDisplayModel,\n  LinearFeatureDisplayStateModel,\n} from './LinearFeatureDisplay/index.ts'\nexport { default as LinearBasicDisplayComponent } from './LinearBasicDisplay/components/LinearBasicDisplayComponent.tsx'\n","import {\n  TrackType,\n  createBaseTrackModel,\n} from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function FeatureTrackF(pm: PluginManager) {\n  pm.addTrackType(() => {\n    const configSchema = configSchemaF(pm)\n    return new TrackType({\n      name: 'FeatureTrack',\n      displayName: 'Feature track',\n      configSchema,\n      stateModel: createBaseTrackModel(pm, 'FeatureTrack', configSchema),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config FeatureTrack\n * #category track\n * used for basic gene and feature tracks, generally used with LinearBasicDisplay\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) =>\n  ConfigurationSchema(\n    'FeatureTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n      /**\n       * #identifier\n       */\n      explicitIdentifier: 'trackId',\n    },\n  )\n\nexport default configSchema\n","import {\n  TrackType,\n  createBaseTrackModel,\n} from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BasicTrackF(pm: PluginManager) {\n  pm.addTrackType(() => {\n    const configSchema = configSchemaF(pm)\n\n    return new TrackType({\n      name: 'BasicTrack',\n      configSchema,\n      stateModel: createBaseTrackModel(pm, 'BasicTrack', configSchema),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config BasicTrack\n * #category track\n * synonym for FeatureTrack\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) =>\n  ConfigurationSchema(\n    'BasicTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n      explicitIdentifier: 'trackId',\n    },\n  )\nexport default configSchema\n","import { lazy } from 'react'\n\nimport { DisplayType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearBasicDisplay(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const config = configSchema(pluginManager)\n    return new DisplayType({\n      name: 'LinearBasicDisplay',\n      displayName: 'Basic feature display',\n      configSchema: config,\n      stateModel: modelFactory(config),\n      trackType: 'FeatureTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/LinearBasicDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n\nexport { default as modelFactory } from './model.ts'\nexport { default as configSchema } from './configSchema.ts'\n","import { lazy } from 'react'\n\nimport { ViewType } from '@jbrowse/core/pluggableElementTypes'\n\nimport { stateModelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearGenomeViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'LinearGenomeView',\n      displayName: 'Linear genome view',\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/LinearGenomeView.tsx')),\n    })\n  })\n}\n\nexport * from './model.ts'\n","import { DisplayType } from '@jbrowse/core/pluggableElementTypes'\n\nimport { configSchemaFactory } from './configSchema.ts'\nimport { stateModelFactory } from './model.ts'\nimport { BaseLinearDisplayComponent } from '../BaseLinearDisplay//index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearBareDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearBareDisplay',\n      configSchema,\n      displayName: 'Bare feature display',\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'BasicTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n\nexport { configSchemaFactory } from './configSchema.ts'\nexport { stateModelFactory } from './model.ts'\n","import type { LinearGenomeViewModel } from '../LinearGenomeView/index.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\ntype LGV = LinearGenomeViewModel\n\nexport default function LaunchLinearGenomeViewF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-LinearGenomeView',\n    // @ts-expect-error\n    async ({\n      session,\n      assembly,\n      loc,\n      tracks = [],\n      tracklist,\n      nav,\n      highlight,\n    }: {\n      session: AbstractSessionModel\n      assembly?: string\n      loc?: string\n      tracks?: string[]\n      tracklist?: boolean\n      nav?: boolean\n      highlight?: string[]\n    }) => {\n      if (!assembly) {\n        throw new Error(\n          'No assembly provided when launching linear genome view',\n        )\n      }\n\n      // Use the init property to let the model handle initialization\n      session.addView('LinearGenomeView', {\n        init: {\n          assembly,\n          loc,\n          tracks,\n          tracklist,\n          nav,\n          highlight,\n        },\n      }) as LGV\n    },\n  )\n}\n","import { checkStopToken2 } from '@jbrowse/core/util/stopToken'\n\nimport type { Feature, LastStopTokenCheck } from '@jbrowse/core/util'\n\nexport function calculateAlleleCounts(\n  genotypes: Record<string, string>,\n  cacheSplit: Record<string, string[]>,\n) {\n  const alleleCounts = {} as Record<string, number>\n  const vals = Object.values(genotypes)\n  for (const val of vals) {\n    const genotype = val\n    const alleles =\n      cacheSplit[genotype] ?? (cacheSplit[genotype] = genotype.split(/[/|]/))\n    for (const allele of alleles) {\n      const a = allele\n      alleleCounts[a] = (alleleCounts[a] || 0) + 1\n    }\n  }\n  return alleleCounts\n}\n\nexport function calculateMinorAlleleFrequency(\n  alleleCounts: Record<string, number>,\n) {\n  let firstMax = 0\n  let secondMax = 0\n  let total = 0\n  for (const count of Object.values(alleleCounts)) {\n    total += count\n    if (count > firstMax) {\n      secondMax = firstMax\n      firstMax = count\n    } else if (count > secondMax && count !== firstMax) {\n      secondMax = count\n    }\n  }\n  return secondMax / (total || 1)\n}\n\nfunction getMostFrequentAlt(alleleCounts: Record<string, number>) {\n  let mostFrequentAlt\n  let max = 0\n  for (const [alt, altCount] of Object.entries(alleleCounts)) {\n    if (alt !== '.' && alt !== '0' && altCount > max) {\n      mostFrequentAlt = alt\n      max = altCount\n    }\n  }\n  return mostFrequentAlt\n}\n\nexport function getFeaturesThatPassMinorAlleleFrequencyFilter({\n  features,\n  minorAlleleFrequencyFilter,\n  lengthCutoffFilter,\n  lastCheck,\n  genotypesCache,\n  splitCache = {},\n}: {\n  features: Iterable<Feature>\n  minorAlleleFrequencyFilter: number\n  lengthCutoffFilter: number\n  lastCheck?: LastStopTokenCheck\n  genotypesCache?: Map<string, Record<string, string>>\n  splitCache?: Record<string, string[]>\n}) {\n  const results = [] as {\n    feature: Feature\n    mostFrequentAlt: string\n    alleleCounts: Record<string, number>\n  }[]\n\n  for (const feature of features) {\n    if (feature.get('end') - feature.get('start') <= lengthCutoffFilter) {\n      const featureId = feature.id()\n      let genotypes = genotypesCache?.get(featureId)\n      if (!genotypes) {\n        genotypes = feature.get('genotypes') as Record<string, string>\n        genotypesCache?.set(featureId, genotypes)\n      }\n\n      const alleleCounts = calculateAlleleCounts(genotypes, splitCache)\n      if (\n        calculateMinorAlleleFrequency(alleleCounts) >=\n        minorAlleleFrequencyFilter\n      ) {\n        results.push({\n          feature,\n          mostFrequentAlt: getMostFrequentAlt(alleleCounts)!,\n          alleleCounts,\n        })\n      }\n    }\n    checkStopToken2(lastCheck)\n  }\n\n  return results\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport const configSchema = ConfigurationSchema('AlignmentsFeatureWidget', {})\n","import { stateModelFactory as baseModelFactory } from '@jbrowse/core/BaseFeatureWidget'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport function stateModelFactory(pluginManager: PluginManager) {\n  return types.compose(\n    baseModelFactory(pluginManager),\n    types.model('AlignmentsFeatureWidget', {\n      type: types.literal('AlignmentsFeatureWidget'),\n    }),\n  )\n}\n\nexport type AlignmentFeatureWidgetStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type AlignmentFeatureWidgetModel =\n  Instance<AlignmentFeatureWidgetStateModel>\n","import { lazy } from 'react'\n\nimport WidgetType from '@jbrowse/core/pluggableElementTypes/WidgetType'\n\nimport { configSchema } from './configSchema.ts'\nimport { stateModelFactory } from './stateModelFactory.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function AlignmentFeatureDetailsF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(\n    () =>\n      new WidgetType({\n        name: 'AlignmentsFeatureWidget',\n        heading: 'Feature details',\n        configSchema: configSchema,\n        stateModel: stateModelFactory(pluginManager),\n        ReactComponent: lazy(() => import('./AlignmentsFeatureDetail.tsx')),\n      }),\n  )\n}\n","/**\n * EXPERIMENTAL: SAM format exporter\n *\n * This module provides experimental support for exporting alignment features to SAM format.\n * The generated output includes the 11 mandatory SAM fields but does not currently output\n * optional tags. The output may not fully conform to the SAM specification and should be\n * validated before use in production workflows.\n */\nimport type { AbstractSessionModel, Feature } from '@jbrowse/core/util'\n\nfunction qualToPhred(qual: string): string {\n  if (!qual) {\n    return '*'\n  }\n\n  return qual\n    .split(' ')\n    .map(q => String.fromCharCode(+q + 33))\n    .join('')\n}\n\nexport function stringifySAM({\n  features,\n  session,\n  assemblyName,\n}: {\n  features: Feature[]\n  session: AbstractSessionModel\n  assemblyName: string\n}) {\n  const lines: string[] = ['@HD\\tVN:1.6\\tSO:unsorted']\n\n  // @HD header - SAM version\n\n  // @SQ headers - reference sequences\n  const { assemblyManager } = session\n  const assembly = assemblyManager.get(assemblyName)\n  if (assembly) {\n    const regions = assembly.regions\n    if (regions) {\n      for (const region of regions) {\n        const length = region.end - region.start\n        lines.push(`@SQ\\tSN:${region.refName}\\tLN:${length}`)\n      }\n    }\n  }\n\n  // @PG header - program info\n  lines.push('@PG\\tID:jbrowse\\tPN:JBrowse\\tVN:2')\n\n  // Alignment records\n  for (const feature of features) {\n    const start = feature.get('start')\n    // The 11 mandatory SAM fields (optional tags are not currently output)\n    const fields = [\n      // QNAME (query name)\n      feature.get('name') || feature.get('id') || '*',\n      // FLAG (bitwise flags) - 0 for unmapped/unknown\n      feature.get('flag') ?? '0',\n      // RNAME (reference sequence name)\n      feature.get('refName') || '*',\n      // POS (1-based leftmost mapping position)\n      String(start + 1),\n      // MAPQ (mapping quality)\n      feature.get('mapq') ?? '255',\n      // CIGAR (CIGAR string)\n      feature.get('CIGAR') || '*',\n      // RNEXT (reference sequence name of next read)\n      feature.get('next_ref') || '*',\n      // PNEXT (position of next read)\n      feature.get('next_pos') ?? '0',\n      // TLEN (template length)\n      feature.get('template_len') ?? '0',\n      // SEQ (sequence)\n      feature.get('seq') || '*',\n      // QUAL (quality in PHRED ASCII format)\n      qualToPhred(feature.get('qual')),\n    ]\n    // TODO: Add support for optional tags\n\n    lines.push(fields.join('\\t'))\n  }\n\n  return lines.join('\\n')\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchemaF.ts'\nimport { stringifySAM } from '../saveTrackFormats/sam.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pm: PluginManager) {\n  pm.addTrackType(() => {\n    const configSchema = configSchemaF(pm)\n    const track = new TrackType({\n      name: 'AlignmentsTrack',\n      displayName: 'Alignments track',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pm,\n        'AlignmentsTrack',\n        configSchema,\n      ).views(() => ({\n        saveTrackFileFormatOptions() {\n          return {\n            sam: {\n              name: 'SAM',\n              extension: 'sam',\n              callback: stringifySAM,\n              helpText:\n                'Note: SAM format export is experimental and does not currently output optional tags. The output may not fully conform to the SAM specification and should be validated before use in production workflows.',\n            },\n          }\n        },\n      })),\n    })\n    const linearAlignmentsDisplay = pm.getDisplayType(\n      'LinearAlignmentsDisplay',\n    )!\n    // Add LinearAlignmentsDisplay here so that it has priority over the other\n    // linear displays (defaults to order the displays are added, but we have\n    // to add the Pileup and SNPCoverage displays first).\n    track.addDisplayType(linearAlignmentsDisplay)\n    return track\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config AlignmentsTrack\n * has very little config; most config and state logic is on the display\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'AlignmentsTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config BamAdapter\n * used to configure BAM adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'BamAdapter',\n  {\n    /**\n     * #slot\n     */\n    bamLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bam',\n        locationType: 'UriLocation',\n      },\n    },\n\n    index: ConfigurationSchema('BamIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['BAI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'BAI',\n      },\n      /**\n       * #slot index.location\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.bam.bai',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n    /**\n     * #slot\n     */\n    fetchSizeLimit: {\n      type: 'number',\n      description:\n        'size to fetch in bytes over which to display a warning to the user that too much data will be fetched',\n      defaultValue: 5_000_000,\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes yourfile.bam.bai:\n     * ```json\n     * {\n     *   \"type\": \"BamAdapter\",\n     *   \"uri\": \"yourfile.bam\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bamLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.bai`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default configSchema\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BamAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'BamAdapter',\n      displayName: 'BAM adapter',\n      configSchema,\n      getAdapterClass: () => import('./BamAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config CramAdapter\n * used to configure CRAM adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'CramAdapter',\n  {\n    /**\n     * #slot fetchSizeLimit\n     */\n    fetchSizeLimit: {\n      type: 'number',\n      description:\n        'size in bytes over which to display a warning to the user that too much data will be fetched',\n      defaultValue: 3_000_000,\n    },\n\n    /**\n     * #slot cramLocation\n     */\n    cramLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.cram',\n        locationType: 'UriLocation',\n      },\n    },\n\n    /**\n     * #slot craiLocation\n     */\n    craiLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.cram.crai',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     * preprocessor to allow minimal config, assumes yourfile.cram.crai:\n     *\n     * ```json\n     * {\n     *   \"type\": \"CramAdapter\",\n     *   \"uri\": \"yourfile.cram\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            cramLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            craiLocation: {\n              uri: `${snap.uri}.crai`,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default configSchema\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function CramAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'CramAdapter',\n      displayName: 'CRAM adapter',\n      configSchema,\n      getAdapterClass: () => import('./CramAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport {\n  getFileName,\n  makeIndex,\n  makeIndexType,\n} from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAlignmentsTypesF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        const indexName = index && getFileName(index)\n\n        if (testAdapter(fileName, /\\.bam$/i, adapterHint, 'BamAdapter')) {\n          return {\n            type: 'BamAdapter',\n            bamLocation: file,\n            index: {\n              location: index || makeIndex(file, '.bai'),\n              indexType: makeIndexType(indexName, 'CSI', 'BAI'),\n            },\n          }\n        } else if (\n          testAdapter(fileName, /\\.cram$/i, adapterHint, 'CramAdapter')\n        ) {\n          return {\n            type: 'CramAdapter',\n            cramLocation: file,\n            craiLocation: index || makeIndex(file, '.crai'),\n          }\n        } else {\n          return adapterGuesser(file, index, adapterHint)\n        }\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        if (adapterName === 'BamAdapter' || adapterName === 'CramAdapter') {\n          return 'AlignmentsTrack'\n        }\n        return trackTypeGuesser(adapterName)\n      }\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n/**\n * #config HtsgetBamAdapter\n * Used to fetch data from Htsget endpoints in BAM format, using the gmod/bam library\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst HtsgetBamAdapter = ConfigurationSchema(\n  'HtsgetBamAdapter',\n  {\n    /**\n     * #slot\n     */\n    htsgetBase: {\n      type: 'string',\n      description: 'the base URL to fetch from',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    htsgetTrackId: {\n      type: 'string',\n      description: 'the trackId, which is appended to the base URL',\n      defaultValue: '',\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default HtsgetBamAdapter\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function HtsgetBamAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'HtsgetBamAdapter',\n      displayName: 'Htsget BAM adapter',\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n      configSchema,\n      getAdapterClass: () =>\n        import('./HtsgetBamAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import type PluginManager from '@jbrowse/core/PluginManager'\n\nexport function getLowerPanelDisplays(pluginManager: PluginManager) {\n  return pluginManager\n    .getDisplayElements()\n    .filter(f => f.subDisplay?.type === 'LinearAlignmentsDisplay')\n    .filter(f => f.subDisplay?.lowerPanel)\n}\n","import { getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport { addDisposer, getSnapshot, types } from '@jbrowse/mobx-state-tree'\nimport deepEqual from 'fast-deep-equal'\nimport { autorun } from 'mobx'\n\nimport { LinearAlignmentsDisplayMixin } from './alignmentsModel.tsx'\nimport { getLowerPanelDisplays } from './util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n} from '@jbrowse/core/configuration'\nimport type { FeatureDensityStats } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { ExportSvgDisplayOptions } from '@jbrowse/plugin-linear-genome-view'\n\nconst minDisplayHeight = 20\nconst defaultDisplayHeight = 250\nconst defaultSnpCovHeight = 45\n\n/**\n * #stateModel LinearAlignmentsDisplay\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [LinearAlignmentsDisplayMixin](../linearalignmentsdisplaymixin)\n */\nfunction stateModelFactory(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearAlignmentsDisplay',\n      BaseDisplay,\n      LinearAlignmentsDisplayMixin(pluginManager, configSchema),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      scrollTop: 0,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setScrollTop(scrollTop: number) {\n        self.scrollTop = scrollTop\n      },\n\n      /**\n       * #action\n       */\n      setSNPCoverageHeight(n: number) {\n        self.snpCovHeight = n\n      },\n\n      /**\n       * #action\n       * Toggle legend visibility on the PileupDisplay sub-display\n       */\n      setShowLegend(s: boolean) {\n        self.PileupDisplay?.setShowLegend(s)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get height() {\n        return self.heightPreConfig ?? getConf(self, 'height')\n      },\n\n      /**\n       * #getter\n       */\n      get featureIdUnderMouse() {\n        return (\n          self.PileupDisplay.featureIdUnderMouse ||\n          self.SNPCoverageDisplay.featureIdUnderMouse\n        )\n      },\n\n      /**\n       * #getter\n       * Returns true if PileupDisplay has legend shown\n       */\n      get showLegend() {\n        return self.PileupDisplay?.showLegend\n      },\n\n      /**\n       * #method\n       * Returns the width needed for the SVG legend from subdisplays.\n       * Used by SVG export to add extra width for the legend area.\n       */\n      svgLegendWidth(theme?: unknown) {\n        const pileupWidth = self.PileupDisplay?.svgLegendWidth?.(theme) ?? 0\n        const snpCovWidth =\n          self.SNPCoverageDisplay?.svgLegendWidth?.(theme) ?? 0\n        return Math.max(pileupWidth, snpCovWidth)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get pileupConf() {\n        const conf = getConf(self, 'pileupDisplay')\n        return {\n          ...conf,\n          type: self.lowerPanelType,\n          displayId: `${self.configuration.displayId}_${self.lowerPanelType}_xyz`, // xyz to avoid someone accidentally naming the displayId similar to this\n        }\n      },\n\n      /**\n       * #method\n       */\n      getFeatureByID(blockKey: string, id: string) {\n        return self.PileupDisplay.getFeatureByID(blockKey, id)\n      },\n      /**\n       * #method\n       */\n      searchFeatureByID(id: string) {\n        return self.PileupDisplay.searchFeatureByID?.(id)\n      },\n\n      /**\n       * #getter\n       */\n      get features() {\n        return self.PileupDisplay.features\n      },\n\n      /**\n       * #getter\n       */\n      get DisplayBlurb() {\n        return self.PileupDisplay?.DisplayBlurb\n      },\n\n      /**\n       * #getter\n       */\n      get sortedBy() {\n        return self.PileupDisplay.sortedBy\n      },\n\n      /**\n       * #getter\n       */\n      get coverageConf() {\n        const conf = getConf(self, 'snpCoverageDisplay')\n        return {\n          ...conf,\n          displayId: `${self.configuration.displayId}_snpcoverage_xyz`, // xyz to avoid someone accidentally naming the displayId similar to this\n        }\n      },\n\n      /**\n       * #method\n       */\n      notReady() {\n        return (\n          self.PileupDisplay?.renderProps().notReady ||\n          self.SNPCoverageDisplay?.renderProps().notReady\n        )\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setSNPCoverageDisplay(configuration: AnyConfigurationModel) {\n        self.SNPCoverageDisplay = {\n          type: 'LinearSNPCoverageDisplay',\n          configuration,\n          height: self.snpCovHeight,\n        }\n      },\n      /**\n       * #action\n       */\n      setFeatureDensityStatsLimit(stats?: FeatureDensityStats) {\n        self.PileupDisplay.setFeatureDensityStatsLimit(stats)\n        self.SNPCoverageDisplay.setFeatureDensityStatsLimit(stats)\n      },\n\n      /**\n       * #action\n       */\n      setPileupDisplay(configuration: AnyConfigurationModel) {\n        self.PileupDisplay = {\n          type: configuration.type || 'LinearPileupDisplay',\n          configuration,\n        }\n      },\n      /**\n       * #action\n       */\n      setHeight(n: number) {\n        self.heightPreConfig = Math.max(n, minDisplayHeight)\n        return self.heightPreConfig\n      },\n      /**\n       * #action\n       */\n      setLowerPanelType(type: string) {\n        self.lowerPanelType = type\n      },\n      /**\n       * #action\n       */\n      resizeHeight(distance: number) {\n        const oldHeight = self.height\n        const newHeight = this.setHeight(self.height + distance)\n        return newHeight - oldHeight\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function alignmentsDisplayConfigAutorun() {\n              const {\n                SNPCoverageDisplay,\n                PileupDisplay,\n                coverageConf,\n                pileupConf,\n              } = self\n\n              if (!SNPCoverageDisplay) {\n                self.setSNPCoverageDisplay(coverageConf)\n              } else if (\n                !deepEqual(\n                  coverageConf,\n                  getSnapshot(SNPCoverageDisplay.configuration),\n                )\n              ) {\n                SNPCoverageDisplay.setHeight(self.snpCovHeight)\n                SNPCoverageDisplay.setConfig(self.coverageConf)\n              }\n\n              if (self.lowerPanelType !== PileupDisplay?.type) {\n                self.setPileupDisplay(pileupConf)\n              } else if (\n                !deepEqual(pileupConf, getSnapshot(PileupDisplay.configuration))\n              ) {\n                PileupDisplay.setConfig(self.pileupConf)\n              }\n            },\n            { name: 'AlignmentsDisplayConfig' },\n          ),\n        )\n\n        addDisposer(\n          self,\n          autorun(\n            function snpCoverageHeightAutorun() {\n              self.setSNPCoverageHeight(self.SNPCoverageDisplay.height)\n            },\n            { name: 'SNPCoverageHeight' },\n          ),\n        )\n\n        addDisposer(\n          self,\n          autorun(\n            function pileupHeightAutorun() {\n              self.PileupDisplay.setHeight(\n                self.height - self.SNPCoverageDisplay.height,\n              )\n            },\n            { name: 'PileupHeight' },\n          ),\n        )\n\n        addDisposer(\n          self,\n          autorun(\n            function syncColorByAutorun() {\n              const colorBy = self.PileupDisplay.colorBy\n              if (\n                colorBy?.type === 'modifications' ||\n                colorBy?.type === 'methylation'\n              ) {\n                self.SNPCoverageDisplay.setColorScheme(colorBy)\n              } else if (self.SNPCoverageDisplay.colorBy) {\n                self.SNPCoverageDisplay.setColorScheme(undefined)\n              }\n            },\n            { name: 'SyncColorBy' },\n          ),\n        )\n\n        addDisposer(\n          self,\n          autorun(\n            function syncFilterByAutorun() {\n              const filterBy = self.PileupDisplay.filterBy\n              self.SNPCoverageDisplay.setFilterBy(filterBy)\n            },\n            { name: 'SyncFilterBy' },\n          ),\n        )\n      },\n      /**\n       * #action\n       */\n      async renderSvg(opts: ExportSvgDisplayOptions) {\n        const { renderSvg } = await import('./renderSvg.tsx')\n        return renderSvg(self, opts)\n      },\n    }))\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems(): MenuItem[] {\n          if (!self.PileupDisplay) {\n            return []\n          }\n          const extra = getLowerPanelDisplays(pluginManager).map(d => ({\n            type: 'radio' as const,\n            label: d.displayName,\n            checked: d.name === self.PileupDisplay.type,\n            onClick: () => {\n              self.setLowerPanelType(d.name)\n            },\n          }))\n\n          return [\n            ...superTrackMenuItems(),\n            {\n              type: 'subMenu' as const,\n              label: 'Pileup settings',\n              subMenu: self.PileupDisplay.trackMenuItems(),\n            },\n            {\n              type: 'subMenu' as const,\n              label: 'SNPCoverage settings',\n              subMenu: self.SNPCoverageDisplay.trackMenuItems(),\n            },\n            {\n              type: 'subMenu' as const,\n              label: 'Replace lower panel with...',\n              subMenu: extra,\n            },\n          ]\n        },\n      }\n    })\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      // @ts-expect-error\n      const { height, ...rest } = snap\n      return { heightPreConfig: height, ...rest }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { heightPreConfig, lowerPanelType, snpCovHeight, ...rest } =\n        snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(heightPreConfig !== undefined &&\n        heightPreConfig !== defaultDisplayHeight\n          ? { height: heightPreConfig }\n          : {}),\n        ...(lowerPanelType !== 'LinearPileupDisplay' ? { lowerPanelType } : {}),\n        ...(snpCovHeight !== defaultSnpCovHeight ? { snpCovHeight } : {}),\n      } as typeof snap\n    })\n}\n\nexport default stateModelFactory\n\nexport type LinearAlignmentsDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearAlignmentsDisplayModel =\n  Instance<LinearAlignmentsDisplayStateModel>\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { getLowerPanelDisplays } from './util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearAlignmentsDisplayMixin\n */\nexport function LinearAlignmentsDisplayMixin(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types.model({\n    /**\n     * #property\n     * refers to LinearPileupDisplay sub-display model\n     */\n    PileupDisplay: types.maybe(\n      types.union(\n        ...getLowerPanelDisplays(pluginManager).map(f => f.stateModel),\n      ),\n    ),\n    /**\n     * #property\n     * refers to LinearSNPCoverageDisplay sub-display model\n     */\n    SNPCoverageDisplay: types.maybe(\n      pluginManager.getDisplayType('LinearSNPCoverageDisplay')!.stateModel,\n    ),\n    /**\n     * #property\n     */\n    snpCovHeight: 45,\n    /**\n     * #property\n     */\n    type: types.literal('LinearAlignmentsDisplay'),\n    /**\n     * #property\n     */\n    configuration: ConfigurationReference(configSchema),\n    /**\n     * #property\n     */\n    heightPreConfig: types.maybe(types.number),\n    /**\n     * #property\n     */\n    userFeatureScreenDensity: types.maybe(types.number),\n    /**\n     * #property\n     */\n    lowerPanelType: 'LinearPileupDisplay',\n  })\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearAlignmentsDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearAlignmentsDisplay',\n      displayName: 'Alignments display (combination)',\n      configSchema,\n      stateModel: modelFactory(pluginManager, configSchema),\n      trackType: 'AlignmentsTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(() => import('./components/AlignmentsDisplay.tsx')),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearAlignmentsDisplay\n * has a \"pileup\" sub-display, where you can see individual reads and a\n * quantitative \"snpcoverage\" sub-display track showing SNP frequencies\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport default function configModelFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearAlignmentsDisplay',\n    {\n      /**\n       * #slot\n       */\n      pileupDisplay: pluginManager.getDisplayType('LinearPileupDisplay')!\n        .configSchema,\n\n      /**\n       * #slot\n       */\n      snpCoverageDisplay: pluginManager.getDisplayType(\n        'LinearSNPCoverageDisplay',\n      )!.configSchema,\n\n      /**\n       * #slot\n       */\n      height: {\n        type: 'number',\n        defaultValue: 250,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { linearBasicDisplayConfigSchemaFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport { defaultFilterFlags } from '../shared/util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearPileupDisplay\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nfunction configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearPileupDisplay',\n    {\n      /**\n       * #slot\n       */\n      defaultRendering: {\n        type: 'stringEnum',\n        model: types.enumeration('Rendering', ['pileup']),\n        defaultValue: 'pileup',\n      },\n      /**\n       * #slot\n       */\n      renderers: ConfigurationSchema('RenderersConfiguration', {\n        PileupRenderer:\n          pluginManager.getRendererType('PileupRenderer')!.configSchema,\n      }),\n      /**\n       * #slot\n       */\n      maxFeatureScreenDensity: {\n        type: 'number',\n        description: 'maximum features per pixel that is displayed in the view',\n        defaultValue: 5,\n      },\n\n      /**\n       * #slot\n       */\n      colorBy: {\n        type: 'frozen',\n        description: 'color scheme to use',\n        defaultValue: {\n          type: 'normal',\n        },\n      },\n\n      /**\n       * #slot\n       */\n      filterBy: {\n        type: 'frozen',\n        description: 'default filters to use',\n        defaultValue: defaultFilterFlags,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearBasicDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaF\n","import { Typography } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { SortedBy } from '../../shared/types.ts'\n\nconst LinearPileupDisplayBlurb = observer(function LinearPileupDisplayBlurb({\n  model,\n}: {\n  model: {\n    sortedBy?: SortedBy\n  }\n}) {\n  const { sortedBy } = model\n  return sortedBy ? (\n    <div data-testid={`blurb-${sortedBy}`}>\n      <Typography color=\"secondary\" variant=\"caption\">\n        {`Sorted by ${sortedBy.tag ?? sortedBy.type} at ${\n          sortedBy.refName\n        }:${sortedBy.pos}`}\n      </Typography>\n    </div>\n  ) : null\n})\n\nexport default LinearPileupDisplayBlurb\n","import { fillColor } from './color.ts'\n\nimport type { ColorBy, ModificationTypeWithColor } from './types.ts'\nimport type { LegendItem } from '@jbrowse/plugin-linear-genome-view'\nimport type { Theme } from '@mui/material'\n\n// Re-export from linear-genome-view for convenience\nexport { calculateSvgLegendWidth } from '@jbrowse/plugin-linear-genome-view'\nexport type { LegendItem } from '@jbrowse/plugin-linear-genome-view'\n\nconst supplementaryItem: LegendItem = {\n  color: fillColor.color_supplementary,\n  label: 'Supplementary/split',\n}\n\nconst unmappedMateItem: LegendItem = {\n  color: fillColor.color_unmapped_mate,\n  label: 'Unmapped mate',\n}\n\nconst orientationItems: LegendItem[] = [\n  { color: fillColor.color_pair_lr, label: 'Normal pair orientation' },\n  { color: fillColor.color_pair_rr, label: 'Both mates reverse strand' },\n  { color: fillColor.color_pair_rl, label: 'Both mates point outward' },\n  { color: fillColor.color_pair_ll, label: 'Both mates forward strand' },\n]\n\nconst insertSizeItems: LegendItem[] = [\n  { color: fillColor.color_longinsert, label: 'Long insert' },\n  { color: fillColor.color_shortinsert, label: 'Short insert' },\n  { color: fillColor.color_interchrom, label: 'Inter-chromosomal' },\n]\n\nconst normalInsertItem: LegendItem = {\n  color: fillColor.color_pair_lr,\n  label: 'Normal',\n}\n\nconst orientationLegendItems: LegendItem[] = [\n  ...orientationItems,\n  unmappedMateItem,\n  supplementaryItem,\n]\n\nconst insertSizeLegendItems: LegendItem[] = [\n  normalInsertItem,\n  ...insertSizeItems,\n  unmappedMateItem,\n  supplementaryItem,\n]\n\nconst insertSizeAndOrientationLegendItems: LegendItem[] = [\n  ...orientationItems,\n  ...insertSizeItems,\n  unmappedMateItem,\n  supplementaryItem,\n]\n\nfunction getBaseItems(theme: Theme): LegendItem[] {\n  const { bases, insertion, deletion, hardclip, softclip } = theme.palette\n  return [\n    { color: bases.A.main, label: 'A' },\n    { color: bases.C.main, label: 'C' },\n    { color: bases.G.main, label: 'G' },\n    { color: bases.T.main, label: 'T' },\n    { color: insertion, label: 'Insertion' },\n    { color: deletion, label: 'Deletion' },\n    { color: hardclip, label: 'Hard clip' },\n    { color: softclip, label: 'Soft clip' },\n  ]\n}\n\n/**\n * Get legend items for pileup display based on colorBy setting\n */\nexport function getPileupLegendItems(\n  colorBy: ColorBy | undefined,\n  theme: Theme,\n): LegendItem[] {\n  const colorType = colorBy?.type\n\n  if (colorType === 'strand') {\n    return [\n      { color: fillColor.color_fwd_strand, label: 'Forward strand' },\n      { color: fillColor.color_rev_strand, label: 'Reverse strand' },\n      supplementaryItem,\n    ]\n  } else if (colorType === 'stranded') {\n    return [\n      { color: fillColor.color_fwd_strand, label: 'First-of-pair forward' },\n      { color: fillColor.color_rev_strand, label: 'First-of-pair reverse' },\n      supplementaryItem,\n    ]\n  } else if (colorType === 'insertSize') {\n    return insertSizeLegendItems\n  } else if (colorType === 'pairOrientation') {\n    return orientationLegendItems\n  } else if (colorType === 'insertSizeAndPairOrientation') {\n    return insertSizeAndOrientationLegendItems\n  } else {\n    return getBaseItems(theme)\n  }\n}\n\n/**\n * Get legend items for SNP coverage display based on colorBy setting\n */\nexport function getSNPCoverageLegendItems(\n  colorBy: ColorBy | undefined,\n  visibleModifications: Map<string, ModificationTypeWithColor>,\n  theme: Theme,\n): LegendItem[] {\n  if (colorBy?.type === 'methylation') {\n    return [\n      { color: 'red', label: 'CpG methylated' },\n      { color: 'blue', label: 'CpG unmethylated' },\n    ]\n  } else if (colorBy?.type === 'modifications') {\n    const items: LegendItem[] = []\n    for (const [type, mod] of visibleModifications.entries()) {\n      items.push({ color: mod.color, label: type })\n    }\n    return items\n  } else {\n    return getBaseItems(theme)\n  }\n}\n\n/**\n * Get legend items for read cloud/arcs display based on colorBy setting.\n * Used by both LinearReadCloudDisplay and LinearReadArcsDisplay.\n */\nexport function getReadDisplayLegendItems(\n  colorBy: ColorBy | undefined,\n  visibleModifications?: Map<string, ModificationTypeWithColor>,\n): LegendItem[] {\n  const colorType = colorBy?.type\n\n  if (colorType === 'modifications' && visibleModifications) {\n    const items: LegendItem[] = []\n    for (const [type, mod] of visibleModifications.entries()) {\n      items.push({ color: mod.color, label: type })\n    }\n    items.push(supplementaryItem)\n    return items\n  }\n  if (colorType === 'insertSizeAndOrientation') {\n    return insertSizeAndOrientationLegendItems\n  }\n  if (colorType === 'insertSize') {\n    return insertSizeLegendItems\n  }\n  if (colorType === 'orientation') {\n    return orientationLegendItems\n  }\n\n  return [supplementaryItem]\n}\n","import { lazy } from 'react'\n\nimport { getSession } from '@jbrowse/core/util'\nimport FilterListIcon from '@mui/icons-material/ClearAll'\nimport PaletteIcon from '@mui/icons-material/Palette'\n\nimport { modificationData } from './modificationData.ts'\n\nimport type { ColorBy } from './types.ts'\n\nconst FilterByTagDialog = lazy(\n  () => import('./components/FilterByTagDialog.tsx'),\n)\nconst SetModificationThresholdDialog = lazy(\n  () => import('./components/SetModificationThresholdDialog.tsx'),\n)\n\ninterface LinearReadDisplayModel {\n  setColorScheme: (colorBy: ColorBy) => void\n}\n\nexport interface ModificationsModel extends LinearReadDisplayModel {\n  modificationsReady: boolean\n  visibleModificationTypes: string[]\n  modificationThreshold: number\n  colorBy?: ColorBy\n}\n\nexport function hasModificationsSupport(\n  model: LinearReadDisplayModel,\n): model is ModificationsModel {\n  return 'modificationsReady' in model && 'visibleModificationTypes' in model\n}\n\nexport interface ModificationsMenuOptions {\n  includeMethylation?: boolean\n}\n\nexport function getModificationsSubMenu(\n  model: ModificationsModel,\n  options: ModificationsMenuOptions = {},\n) {\n  const { includeMethylation = false } = options\n  const {\n    modificationThreshold,\n    modificationsReady,\n    visibleModificationTypes,\n  } = model\n\n  if (!modificationsReady) {\n    return [\n      {\n        label: 'Loading modifications...',\n        onClick: () => {},\n      },\n    ]\n  } else {\n    return visibleModificationTypes.length\n      ? [\n          {\n            label: `All modifications (>= ${modificationThreshold}% prob)`,\n            onClick: () => {\n              model.setColorScheme({\n                type: 'modifications',\n                modifications: {\n                  threshold: modificationThreshold,\n                },\n              })\n            },\n          },\n          ...model.visibleModificationTypes.map(key => ({\n            label: `Show only ${modificationData[key]?.name || key} (>= ${modificationThreshold}% prob)`,\n            onClick: () => {\n              model.setColorScheme({\n                type: 'modifications',\n                modifications: {\n                  isolatedModification: key,\n                  threshold: modificationThreshold,\n                },\n              })\n            },\n          })),\n          { type: 'divider' as const },\n          {\n            label: 'All modifications (<50% prob colored blue)',\n            onClick: () => {\n              model.setColorScheme({\n                type: 'modifications',\n                modifications: {\n                  twoColor: true,\n                  threshold: modificationThreshold,\n                },\n              })\n            },\n          },\n          ...model.visibleModificationTypes.map(key => ({\n            label: `Show only ${modificationData[key]?.name || key} (<50% prob colored blue)`,\n            onClick: () => {\n              model.setColorScheme({\n                type: 'modifications',\n                modifications: {\n                  isolatedModification: key,\n                  twoColor: true,\n                  threshold: modificationThreshold,\n                },\n              })\n            },\n          })),\n          ...(includeMethylation\n            ? [\n                { type: 'divider' as const },\n                {\n                  label: 'All reference CpGs',\n                  onClick: () => {\n                    model.setColorScheme({\n                      type: 'methylation',\n                      modifications: {\n                        threshold: modificationThreshold,\n                      },\n                    })\n                  },\n                },\n              ]\n            : []),\n          { type: 'divider' as const },\n          {\n            label: `Adjust threshold (${modificationThreshold}%)`,\n            onClick: () => {\n              getSession(model).queueDialog(handleClose => [\n                SetModificationThresholdDialog,\n                {\n                  model,\n                  handleClose,\n                },\n              ])\n            },\n          },\n        ]\n      : [{ label: 'No modifications currently visible' }]\n  }\n}\n\nexport function getModificationsMenuItem(\n  model: ModificationsModel,\n  options: ModificationsMenuOptions = {},\n) {\n  return {\n    label: 'Modifications',\n    type: 'subMenu' as const,\n    subMenu: getModificationsSubMenu(model, options),\n  }\n}\n\n/**\n * Shared color scheme menu items for all LinearRead displays\n */\nexport function getColorSchemeMenuItem(model: LinearReadDisplayModel) {\n  const baseItems = [\n    {\n      label: 'Insert size  3 and orientation',\n      onClick: () => {\n        model.setColorScheme({ type: 'insertSizeAndOrientation' })\n      },\n    },\n    {\n      label: 'Insert size  3',\n      onClick: () => {\n        model.setColorScheme({ type: 'insertSize' })\n      },\n    },\n    {\n      label: 'Orientation',\n      onClick: () => {\n        model.setColorScheme({ type: 'orientation' })\n      },\n    },\n    {\n      label: 'Insert size gradient',\n      onClick: () => {\n        model.setColorScheme({ type: 'gradient' })\n      },\n    },\n  ]\n\n  const modificationsItem =\n    hasModificationsSupport(model) && model.visibleModificationTypes.length > 0\n      ? [getModificationsMenuItem(model)]\n      : []\n\n  return {\n    label: 'Color scheme',\n    icon: PaletteIcon,\n    subMenu: [...baseItems, ...modificationsItem],\n  }\n}\n\n/**\n * Shared filter by menu item for all LinearRead displays\n */\nexport function getFilterByMenuItem(model: unknown) {\n  return {\n    label: 'Filter by',\n    icon: FilterListIcon,\n    onClick: () => {\n      // @ts-expect-error getSession works on model\n      getSession(model).queueDialog((handleClose: () => void) => [\n        FilterByTagDialog,\n        { model, handleClose },\n      ])\n    },\n  }\n}\n\ninterface EditFiltersModel {\n  drawSingletons: boolean\n  drawProperPairs: boolean\n  setDrawSingletons: (arg: boolean) => void\n  setDrawProperPairs: (arg: boolean) => void\n}\n\n/**\n * Edit filters submenu for LinearReadCloudDisplay\n */\nexport function getEditFiltersMenuItem(model: EditFiltersModel) {\n  return {\n    label: 'Edit filters',\n    icon: FilterListIcon,\n    type: 'subMenu' as const,\n    subMenu: [\n      {\n        label: 'Show singletons',\n        type: 'checkbox' as const,\n        checked: model.drawSingletons,\n        onClick: () => {\n          model.setDrawSingletons(!model.drawSingletons)\n        },\n      },\n      {\n        label: 'Show proper pairs',\n        type: 'checkbox' as const,\n        checked: model.drawProperPairs,\n        onClick: () => {\n          model.setDrawProperPairs(!model.drawProperPairs)\n        },\n      },\n      { type: 'divider' as const },\n      {\n        label: 'Edit filters...',\n        onClick: () => {\n          // @ts-expect-error getSession works on model\n          getSession(model).queueDialog((handleClose: () => void) => [\n            FilterByTagDialog,\n            { model, handleClose },\n          ])\n        },\n      },\n    ],\n  }\n}\n\ninterface MismatchDisplayModel {\n  hideMismatches?: boolean\n  hideSmallIndels?: boolean\n  hideLargeIndels?: boolean\n  setHideMismatches: (arg: boolean) => void\n  setHideSmallIndels: (arg: boolean) => void\n  setHideLargeIndels: (arg: boolean) => void\n}\n\n/**\n * Shared mismatch/indel display submenu for pileup and read cloud displays\n */\nexport function getMismatchDisplayMenuItem(model: MismatchDisplayModel) {\n  return {\n    label: 'Mismatch/indel display',\n    type: 'subMenu' as const,\n    subMenu: [\n      {\n        label: 'Show all mismatches',\n        type: 'radio' as const,\n        checked:\n          !model.hideMismatches &&\n          !model.hideSmallIndels &&\n          !model.hideLargeIndels,\n        onClick: () => {\n          model.setHideMismatches(false)\n          model.setHideSmallIndels(false)\n          model.setHideLargeIndels(false)\n        },\n      },\n      {\n        label: 'Show mismatches and large indels+clipping',\n        type: 'radio' as const,\n        checked:\n          !model.hideMismatches &&\n          model.hideSmallIndels &&\n          !model.hideLargeIndels,\n        onClick: () => {\n          model.setHideMismatches(false)\n          model.setHideSmallIndels(true)\n          model.setHideLargeIndels(false)\n        },\n      },\n      {\n        label: 'Show just large indels',\n        type: 'radio' as const,\n        checked:\n          model.hideMismatches &&\n          model.hideSmallIndels &&\n          !model.hideLargeIndels,\n        onClick: () => {\n          model.setHideMismatches(true)\n          model.setHideSmallIndels(true)\n          model.setHideLargeIndels(false)\n        },\n      },\n      {\n        label: 'Show none',\n        type: 'radio' as const,\n        checked:\n          model.hideMismatches &&\n          model.hideSmallIndels &&\n          model.hideLargeIndels,\n        onClick: () => {\n          model.setHideMismatches(true)\n          model.setHideSmallIndels(true)\n          model.setHideLargeIndels(true)\n        },\n      },\n    ],\n  }\n}\n","import { lazy } from 'react'\n\nimport {\n  ConfigurationReference,\n  getConf,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport SerializableFilterChain from '@jbrowse/core/pluggableElementTypes/renderers/util/serializableFilterChain'\nimport {\n  SimpleFeature,\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport { cast, isAlive, types } from '@jbrowse/mobx-state-tree'\nimport { BaseLinearDisplay } from '@jbrowse/plugin-linear-genome-view'\nimport FilterListIcon from '@mui/icons-material/ClearAll'\nimport ContentCopyIcon from '@mui/icons-material/ContentCopy'\nimport MenuOpenIcon from '@mui/icons-material/MenuOpen'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { observable } from 'mobx'\n\nimport LinearPileupDisplayBlurb from './components/LinearPileupDisplayBlurb.tsx'\nimport { getPileupLegendItems } from '../shared/legendUtils.ts'\nimport { getMismatchDisplayMenuItem } from '../shared/menuItems.ts'\nimport { isDefaultFilterFlags } from '../shared/util.ts'\n\nimport type { ColorBy, FilterBy } from '../shared/types.ts'\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n} from '@jbrowse/core/configuration'\nimport type { Feature, SimpleFeatureSerialized } from '@jbrowse/core/util'\nimport type {\n  LegendItem,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\nimport type { Theme } from '@mui/material'\n// lazies\nconst FilterByTagDialog = lazy(\n  () => import('../shared/components/FilterByTagDialog.tsx'),\n)\nconst ColorByTagDialog = lazy(() => import('./components/ColorByTagDialog.tsx'))\nconst SetFeatureHeightDialog = lazy(\n  () => import('../shared/components/SetFeatureHeightDialog.tsx'),\n)\nconst SetMaxHeightDialog = lazy(\n  () => import('../shared/components/SetMaxHeightDialog.tsx'),\n)\n\n// using a map because it preserves order\nconst rendererTypes = new Map([\n  ['pileup', 'PileupRenderer'],\n  ['svg', 'SvgFeatureRenderer'],\n])\n\ntype LGV = LinearGenomeViewModel\n\n/**\n * #stateModel SharedLinearPileupDisplayMixin\n * #category display\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport function SharedLinearPileupDisplayMixin(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        featureHeight: types.maybe(types.number),\n        /**\n         * #property\n         */\n        noSpacing: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        fadeLikelihood: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        trackMaxHeight: types.maybe(types.number),\n        /**\n         * #property\n         */\n        colorBySetting: types.frozen<ColorBy | undefined>(),\n        /**\n         * #property\n         */\n        filterBySetting: types.frozen<FilterBy | undefined>(),\n        /**\n         * #property\n         */\n        jexlFilters: types.optional(types.array(types.string), []),\n        /**\n         * #property\n         */\n        hideSmallIndelsSetting: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        hideMismatchesSetting: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        hideLargeIndelsSetting: types.maybe(types.boolean),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      colorTagMap: observable.map<string, string>({}),\n      /**\n       * #volatile\n       */\n      featureUnderMouseVolatile: undefined as undefined | Feature,\n      /**\n       * #volatile\n       */\n      tagsReady: false,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get colorBy() {\n        return self.colorBySetting ?? getConf(self, 'colorBy')\n      },\n\n      /**\n       * #getter\n       */\n      get filterBy() {\n        return self.filterBySetting ?? getConf(self, 'filterBy')\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get autorunReady() {\n        if (self.isMinimized) {\n          return false\n        }\n        const view = getContainingView(self) as LGV\n        return (\n          view.initialized && self.featureDensityStatsReadyAndRegionNotTooLarge\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get hideSmallIndels() {\n        return self.hideSmallIndelsSetting\n      },\n      /**\n       * #getter\n       */\n      get hideMismatches() {\n        return self.hideMismatchesSetting\n      },\n      /**\n       * #getter\n       */\n      get hideLargeIndels() {\n        return self.hideLargeIndelsSetting\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setTagsReady(flag: boolean) {\n        self.tagsReady = flag\n      },\n\n      /**\n       * #action\n       */\n      setMaxHeight(n?: number) {\n        self.trackMaxHeight = n\n      },\n\n      /**\n       * #action\n       */\n      setFeatureHeight(n?: number) {\n        self.featureHeight = n\n      },\n\n      /**\n       * #action\n       */\n      setNoSpacing(flag?: boolean) {\n        self.noSpacing = flag\n      },\n\n      /**\n       * #action\n       */\n      setColorScheme(colorScheme: ColorBy) {\n        self.colorTagMap = observable.map({})\n        self.colorBySetting = {\n          ...colorScheme,\n        }\n        if (colorScheme.tag) {\n          self.tagsReady = false\n        }\n      },\n\n      /**\n       * #action\n       */\n      updateColorTagMap(uniqueTag: string[]) {\n        // pale color scheme\n        // https://cran.r-project.org/web/packages/khroma/vignettes/tol.html\n        // e.g. \"tol_light\"\n        const colorPalette = [\n          '#BBCCEE',\n          'pink',\n          '#CCDDAA',\n          '#EEEEBB',\n          '#FFCCCC',\n          'lightblue',\n          'lightgreen',\n          'tan',\n          '#CCEEFF',\n          'lightsalmon',\n        ]\n\n        for (const value of uniqueTag) {\n          if (!self.colorTagMap.has(value)) {\n            const totalKeys = [...self.colorTagMap.keys()].length\n            self.colorTagMap.set(value, colorPalette[totalKeys]!)\n          }\n        }\n      },\n\n      /**\n       * #action\n       */\n      setFeatureUnderMouse(feat?: Feature) {\n        self.featureUnderMouseVolatile = feat\n      },\n\n      /**\n       * #action\n       */\n      selectFeature(feature: Feature) {\n        const session = getSession(self)\n        if (isSessionModelWithWidgets(session)) {\n          const featureWidget = session.addWidget(\n            'AlignmentsFeatureWidget',\n            'alignmentFeature',\n            {\n              featureData: feature.toJSON(),\n              view: getContainingView(self),\n              track: getContainingTrack(self),\n            },\n          )\n          session.showWidget(featureWidget)\n        }\n        session.setSelection(feature)\n      },\n\n      /**\n       * #action\n       */\n      setConfig(conf: AnyConfigurationModel) {\n        self.configuration = conf\n      },\n\n      /**\n       * #action\n       */\n      setFilterBy(filter: FilterBy) {\n        self.filterBySetting = {\n          ...filter,\n        }\n      },\n\n      /**\n       * #action\n       */\n      setJexlFilters(filters: string[]) {\n        self.jexlFilters = cast(filters)\n      },\n\n      /**\n       * #action\n       */\n      setHideSmallIndels(arg: boolean) {\n        self.hideSmallIndelsSetting = arg\n      },\n\n      /**\n       * #action\n       */\n      setHideMismatches(arg: boolean) {\n        self.hideMismatchesSetting = arg\n      },\n      /**\n       * #action\n       */\n      setHideLargeIndels(arg: boolean) {\n        self.hideLargeIndelsSetting = arg\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #method\n       * uses copy-to-clipboard and generates notification\n       */\n      async copyFeatureToClipboard(feature: Feature) {\n        const { uniqueId, ...rest } = feature.toJSON()\n        const session = getSession(self)\n        const { default: copy } = await import('copy-to-clipboard')\n        copy(JSON.stringify(rest, null, 4))\n        session.notify('Copied to clipboard', 'success')\n      },\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const {\n          featureHeight,\n          noSpacing,\n          hideSmallIndels,\n          hideMismatches,\n          hideLargeIndels,\n          trackMaxHeight,\n          rendererTypeName,\n        } = self\n        // @ts-ignore\n        const conf = self.configuration.renderers?.[rendererTypeName]\n        return {\n          height: featureHeight ?? readConfObject(conf, 'height'),\n          noSpacing: noSpacing ?? readConfObject(conf, 'noSpacing'),\n          maxHeight: trackMaxHeight ?? readConfObject(conf, 'maxHeight'),\n          hideSmallIndels:\n            hideSmallIndels ?? readConfObject(conf, 'hideSmallIndels'),\n          hideMismatches:\n            hideMismatches ?? readConfObject(conf, 'hideMismatches'),\n          hideLargeIndels:\n            hideLargeIndels ?? readConfObject(conf, 'hideLargeIndels'),\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get maxHeight() {\n        return self.rendererConfig.maxHeight\n      },\n\n      /**\n       * #getter\n       */\n      get featureHeightSetting() {\n        return self.rendererConfig.height\n      },\n      /**\n       * #getter\n       */\n      get noSpacingSetting() {\n        return self.rendererConfig.noSpacing\n      },\n      /**\n       * #getter\n       */\n      get featureUnderMouse() {\n        return self.featureUnderMouseVolatile\n      },\n      /**\n       * #getter\n       */\n      renderReady() {\n        return self.tagsReady\n      },\n      /**\n       * #getter\n       */\n      get filters() {\n        return new SerializableFilterChain({ filters: self.jexlFilters })\n      },\n\n      /**\n       * #method\n       * Returns legend items based on current colorBy setting\n       */\n      legendItems(theme: Theme): LegendItem[] {\n        return getPileupLegendItems(self.colorBy, theme)\n      },\n\n      /**\n       * #method\n       */\n      showSubMenuItems() {\n        return [\n          {\n            label: 'Show tooltips',\n            type: 'checkbox',\n            checked: self.showTooltipsEnabled,\n            onClick: () => {\n              self.setShowTooltips(!self.showTooltipsEnabled)\n            },\n          },\n          {\n            label: 'Show legend',\n            type: 'checkbox',\n            checked: self.showLegend,\n            onClick: () => {\n              self.setShowLegend(!self.showLegend)\n            },\n          },\n          getMismatchDisplayMenuItem(self),\n        ]\n      },\n    }))\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        renderProps: superRenderProps,\n        renderingProps: superRenderingProps,\n      } = self\n\n      return {\n        /**\n         * #getter\n         */\n        get rendererTypeName() {\n          const viewName = getConf(self, 'defaultRendering')\n          const rendererType = rendererTypes.get(viewName)\n          if (!rendererType) {\n            throw new Error(`unknown alignments view name ${viewName}`)\n          }\n          return rendererType\n        },\n\n        /**\n         * #method\n         */\n        contextMenuItems() {\n          const feat = self.contextMenuFeature\n          return feat\n            ? [\n                {\n                  label: 'Open feature details',\n                  icon: MenuOpenIcon,\n                  onClick: () => {\n                    self.clearFeatureSelection()\n                    self.selectFeature(feat)\n                  },\n                },\n                {\n                  label: 'Copy info to clipboard',\n                  icon: ContentCopyIcon,\n                  onClick: () => {\n                    // eslint-disable-next-line @typescript-eslint/no-floating-promises\n                    self.copyFeatureToClipboard(feat)\n                  },\n                },\n              ]\n            : []\n        },\n\n        /**\n         * #getter\n         */\n        get DisplayBlurb() {\n          return LinearPileupDisplayBlurb\n        },\n        /**\n         * #method\n         */\n        adapterRenderProps() {\n          const { colorTagMap, colorBy, filterBy } = self\n          const superProps = superRenderProps()\n          return {\n            ...superProps,\n            notReady: superProps.notReady || !self.renderReady(),\n            colorBy,\n            filterBy,\n            filters: self.filters,\n            colorTagMap: Object.fromEntries(colorTagMap.toJSON()),\n            config: self.rendererConfig,\n          }\n        },\n        /**\n         * #method\n         */\n        renderingProps() {\n          return {\n            ...superRenderingProps(),\n            async onFeatureClick(_: unknown, featureId?: string) {\n              const session = getSession(self)\n              const { rpcManager } = session\n              try {\n                const f = featureId || self.featureIdUnderMouse\n                if (!f) {\n                  self.clearFeatureSelection()\n                } else {\n                  const sessionId = getRpcSessionId(self)\n                  const { feature } = (await rpcManager.call(\n                    sessionId,\n                    'CoreGetFeatureDetails',\n                    {\n                      featureId: f,\n                      sessionId,\n                      trackInstanceId: getContainingTrack(self).id,\n                      rendererType: 'PileupRenderer',\n                      rpcDriverName: self.effectiveRpcDriverName,\n                    },\n                  )) as { feature: SimpleFeatureSerialized | undefined }\n\n                  if (isAlive(self) && feature) {\n                    self.selectFeature(new SimpleFeature(feature))\n                  }\n                }\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n              }\n            },\n\n            onClick() {\n              self.clearFeatureSelection()\n            },\n            // similar to click but opens a menu with further options\n            async onFeatureContextMenu(_: unknown, featureId?: string) {\n              const session = getSession(self)\n              const { rpcManager } = session\n              try {\n                const f = featureId || self.featureIdUnderMouse\n                if (!f) {\n                  self.clearFeatureSelection()\n                } else {\n                  const sessionId = getRpcSessionId(self)\n                  const { feature } = (await rpcManager.call(\n                    sessionId,\n                    'CoreGetFeatureDetails',\n                    {\n                      featureId: f,\n                      sessionId,\n                      trackInstanceId: getContainingTrack(self).id,\n                      rendererType: 'PileupRenderer',\n                      rpcDriverName: self.effectiveRpcDriverName,\n                    },\n                  )) as { feature: SimpleFeatureSerialized | undefined }\n\n                  if (feature) {\n                    self.setContextMenuFeature(new SimpleFeature(feature))\n                  }\n                }\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n              }\n            },\n          }\n        },\n\n        /**\n         * #method\n         */\n        colorSchemeSubMenuItems() {\n          return [\n            {\n              label: 'Normal',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'normal',\n                })\n              },\n            },\n            {\n              label: 'Mapping quality',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'mappingQuality',\n                })\n              },\n            },\n            {\n              label: 'Strand',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'strand',\n                })\n              },\n            },\n            {\n              label: 'Per-base quality',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'perBaseQuality',\n                })\n              },\n            },\n            {\n              label: 'Per-base lettering',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'perBaseLettering',\n                })\n              },\n            },\n            {\n              label: 'First-of-pair strand',\n              onClick: () => {\n                self.setColorScheme({\n                  type: 'stranded',\n                })\n              },\n            },\n            {\n              label: 'Color by tag...',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  ColorByTagDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Set feature height...',\n              priority: 0,\n              subMenu: [\n                {\n                  label: 'Normal',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 7 &&\n                    self.noSpacingSetting === false,\n                  onClick: () => {\n                    self.setFeatureHeight(7)\n                    self.setNoSpacing(false)\n                  },\n                },\n                {\n                  label: 'Compact',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 2 &&\n                    self.noSpacingSetting === true,\n                  onClick: () => {\n                    self.setFeatureHeight(2)\n                    self.setNoSpacing(true)\n                  },\n                },\n                {\n                  label: 'Super-compact',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 1 &&\n                    self.noSpacingSetting === true,\n                  onClick: () => {\n                    self.setFeatureHeight(1)\n                    self.setNoSpacing(true)\n                  },\n                },\n                {\n                  label: 'Custom',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      SetFeatureHeightDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              priority: -1,\n              type: 'subMenu',\n              subMenu: self.showSubMenuItems(),\n            },\n            {\n              label: 'Set max track height...',\n              priority: -1,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  SetMaxHeightDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n            {\n              label: 'Filter by...',\n              icon: FilterListIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  FilterByTagDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n      }\n    })\n    .views(self => ({\n      renderProps() {\n        return self.adapterRenderProps()\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          const { sharedDoAfterAttach } =\n            await import('./sharedDoAfterAttach.ts')\n          sharedDoAfterAttach(self)\n        })()\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (snap) {\n        // @ts-expect-error\n        const { colorBy, colorBySetting, filterBySetting, filterBy, ...rest } =\n          snap\n        return {\n          ...rest,\n          filterBySetting: filterBySetting || filterBy,\n          colorBySetting: colorBySetting || colorBy,\n        }\n      }\n      return snap\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        trackMaxHeight,\n        colorBySetting,\n        filterBySetting,\n        jexlFilters,\n        hideSmallIndelsSetting,\n        hideMismatchesSetting,\n        hideLargeIndelsSetting,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(trackMaxHeight !== undefined ? { trackMaxHeight } : {}),\n        ...(colorBySetting !== undefined ? { colorBySetting } : {}),\n        ...(!isDefaultFilterFlags(filterBySetting) ? { filterBySetting } : {}),\n        // mst types wrong, nullish needed\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        ...(jexlFilters?.length ? { jexlFilters } : {}),\n        ...(hideSmallIndelsSetting !== undefined\n          ? { hideSmallIndelsSetting }\n          : {}),\n        ...(hideMismatchesSetting !== undefined\n          ? { hideMismatchesSetting }\n          : {}),\n        ...(hideLargeIndelsSetting !== undefined\n          ? { hideLargeIndelsSetting }\n          : {}),\n      } as typeof snap\n    })\n}\n","import { types } from '@jbrowse/mobx-state-tree'\nimport { observable } from 'mobx'\n\nimport { getColorForModification } from '../util.ts'\n\nimport type { ModificationType, ModificationTypeWithColor } from './types.ts'\n\n/**\n * Shared mixin for modification-related state and actions.\n * Used by both LinearPileupDisplay and LinearSNPCoverageDisplay.\n */\nexport function SharedModificationsMixin() {\n  return types\n    .model({})\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      visibleModifications: observable.map<string, ModificationTypeWithColor>(\n        {},\n      ),\n      /**\n       * #volatile\n       */\n      simplexModifications: new Set<string>(),\n      /**\n       * #volatile\n       */\n      modificationsReady: false,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get visibleModificationTypes() {\n        return [...self.visibleModifications.keys()]\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      updateVisibleModifications(uniqueModifications: ModificationType[]) {\n        for (const modification of uniqueModifications) {\n          if (!self.visibleModifications.has(modification.type)) {\n            self.visibleModifications.set(modification.type, {\n              ...modification,\n              color: getColorForModification(modification.type),\n            })\n          }\n        }\n      },\n      /**\n       * #action\n       */\n      setSimplexModifications(simplex: string[]) {\n        const currentSet = self.simplexModifications\n        if (\n          simplex.length === currentSet.size &&\n          simplex.every(s => currentSet.has(s))\n        ) {\n          return\n        }\n        self.simplexModifications = new Set(simplex)\n      },\n      /**\n       * #action\n       */\n      setModificationsReady(flag: boolean) {\n        self.modificationsReady = flag\n      },\n    }))\n}\n","import { lazy } from 'react'\n\nimport {\n  ConfigurationReference,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport ColorLensIcon from '@mui/icons-material/ColorLens'\nimport SwapVertIcon from '@mui/icons-material/SwapVert'\nimport WorkspacesIcon from '@mui/icons-material/Workspaces'\n\nimport { SharedLinearPileupDisplayMixin } from './SharedLinearPileupDisplayMixin.ts'\nimport { SharedModificationsMixin } from '../shared/SharedModificationsMixin.ts'\nimport { getModificationsSubMenu } from '../shared/menuItems.ts'\n\nimport type { SortedBy } from '../shared/types.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\n// lazies\nconst SortByTagDialog = lazy(() => import('./components/SortByTagDialog.tsx'))\nconst GroupByDialog = lazy(() => import('./components/GroupByDialog.tsx'))\n\ntype LGV = LinearGenomeViewModel\n\n/**\n * #stateModel LinearPileupDisplay\n * #category display\n * extends\n * - [SharedLinearPileupDisplayMixin](../sharedlinearpileupdisplaymixin)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearPileupDisplay',\n      SharedLinearPileupDisplayMixin(configSchema),\n      SharedModificationsMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearPileupDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        showSoftClipping: false,\n        /**\n         * #property\n         */\n        mismatchAlpha: types.maybe(types.boolean),\n\n        /**\n         * #property\n         */\n        sortedBy: types.frozen<SortedBy | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      sortReady: false,\n      /**\n       * #volatile\n       */\n      currSortBpPerPx: 0,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setCurrSortBpPerPx(n: number) {\n        self.currSortBpPerPx = n\n      },\n      /**\n       * #action\n       */\n      setSortReady(flag: boolean) {\n        self.sortReady = flag\n      },\n      /**\n       * #action\n       */\n      clearSelected() {\n        self.sortedBy = undefined\n      },\n      /**\n       * #action\n       */\n      toggleSoftClipping() {\n        self.showSoftClipping = !self.showSoftClipping\n      },\n      /**\n       * #action\n       */\n      toggleMismatchAlpha() {\n        self.mismatchAlpha = !self.mismatchAlpha\n      },\n      /**\n       * #action\n       */\n      setSortedBy(type: string, tag?: string) {\n        const { centerLineInfo } = getContainingView(self) as LGV\n        if (!centerLineInfo) {\n          return\n        }\n        const { refName, assemblyName, offset } = centerLineInfo\n        const centerBp = Math.round(offset) + 1\n\n        if (centerBp < 0 || !refName) {\n          return\n        }\n\n        self.sortReady = false\n        self.sortedBy = {\n          type,\n          pos: centerBp,\n          refName,\n          assemblyName,\n          tag,\n        }\n      },\n      /**\n       * #action\n       * Sort by a specific position (used for sorting at mismatch positions)\n       */\n      setSortedByAtPosition(type: string, pos: number, refName: string) {\n        const view = getContainingView(self) as LGV\n        const assemblyName = view.assemblyNames[0]\n        if (!assemblyName) {\n          return\n        }\n        self.sortReady = false\n        self.sortedBy = {\n          type,\n          pos: pos + 1,\n          refName,\n          assemblyName,\n        }\n      },\n      /**\n       * #action\n       * overrides base from SharedLinearPileupDisplay to make sortReady false\n       * since changing feature height destroys the sort-induced layout\n       */\n      setFeatureHeight(n?: number) {\n        self.sortReady = false\n        self.featureHeight = n\n      },\n    }))\n    .actions(self => {\n      // resets the sort object and refresh whole display on reload\n      const superReload = self.reload\n\n      return {\n        /**\n         * #action\n         */\n        reload() {\n          self.clearSelected()\n          superReload()\n        },\n      }\n    })\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get modificationThreshold() {\n        return self.colorBy?.modifications?.threshold ?? 10\n      },\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const {\n          featureHeight,\n          noSpacing,\n          trackMaxHeight,\n          mismatchAlpha,\n          hideSmallIndels,\n          hideMismatches,\n          hideLargeIndels,\n        } = self\n        // @ts-ignore\n        const conf = self.configuration.renderers?.PileupRenderer\n        return {\n          height: featureHeight ?? readConfObject(conf, 'height'),\n          noSpacing: noSpacing ?? readConfObject(conf, 'noSpacing'),\n          maxHeight: trackMaxHeight ?? readConfObject(conf, 'maxHeight'),\n          mismatchAlpha: mismatchAlpha ?? readConfObject(conf, 'mismatchAlpha'),\n          hideSmallIndels:\n            hideSmallIndels ?? readConfObject(conf, 'hideSmallIndels'),\n          hideMismatches:\n            hideMismatches ?? readConfObject(conf, 'hideMismatches'),\n          hideLargeIndels:\n            hideLargeIndels ?? readConfObject(conf, 'hideLargeIndels'),\n        }\n      },\n    }))\n    .views(self => {\n      const { renderReady: superRenderReady } = self\n      return {\n        /**\n         * #getter\n         */\n        get mismatchAlphaSetting() {\n          return self.rendererConfig.mismatchAlpha\n        },\n        /**\n         * #method\n         */\n        renderReady() {\n          const view = getContainingView(self) as LGV\n          return (\n            self.modificationsReady &&\n            self.currSortBpPerPx === view.bpPerPx &&\n            superRenderReady()\n          )\n        },\n      }\n    })\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        adapterRenderProps: superAdapterRenderProps,\n        renderProps: superRenderProps,\n        colorSchemeSubMenuItems: superColorSchemeSubMenuItems,\n        showSubMenuItems: superShowSubMenuItems,\n      } = self\n\n      return {\n        /**\n         * #method\n         */\n        adapterRenderProps() {\n          const {\n            sortedBy,\n            showSoftClipping,\n            visibleModifications,\n            simplexModifications,\n          } = self\n          const superProps = superAdapterRenderProps()\n          return {\n            ...superProps,\n            showSoftClip: showSoftClipping,\n            sortedBy,\n            visibleModifications: Object.fromEntries(\n              visibleModifications.toJSON(),\n            ),\n            simplexModifications: [...simplexModifications],\n          }\n        },\n        /**\n         * #method\n         */\n        renderProps() {\n          const { sortReady } = self\n          const result = superRenderProps()\n          return {\n            ...result,\n            notReady: result.notReady || !sortReady,\n          }\n        },\n\n        /**\n         * #method\n         */\n        showSubMenuItems() {\n          return [\n            ...superShowSubMenuItems(),\n            {\n              label: 'Show soft clipping',\n              type: 'checkbox',\n              checked: self.showSoftClipping,\n              onClick: () => {\n                self.toggleSoftClipping()\n                // if toggling from off to on, will break sort for this track\n                // so clear it\n                if (self.showSoftClipping) {\n                  self.clearSelected()\n                }\n              },\n            },\n            {\n              label: 'Show mismatches faded by quality',\n              type: 'checkbox',\n              checked: self.mismatchAlphaSetting,\n              onClick: () => {\n                self.toggleMismatchAlpha()\n              },\n            },\n          ]\n        },\n\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Sort by...',\n              icon: SwapVertIcon,\n              disabled: self.showSoftClipping,\n              subMenu: [\n                ...['Start location', 'Read strand', 'Base pair'].map(\n                  option => ({\n                    label: option,\n                    onClick: () => {\n                      self.setSortedBy(option)\n                    },\n                  }),\n                ),\n                {\n                  label: 'Sort by tag...',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      SortByTagDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n                {\n                  label: 'Clear sort',\n                  onClick: () => {\n                    self.clearSelected()\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Color by...',\n              icon: ColorLensIcon,\n              subMenu: [\n                {\n                  label: 'Pair orientation',\n                  onClick: () => {\n                    self.setColorScheme({\n                      type: 'pairOrientation',\n                    })\n                  },\n                },\n                {\n                  label: 'Modifications',\n                  type: 'subMenu',\n                  subMenu: getModificationsSubMenu(self, {\n                    includeMethylation: true,\n                  }),\n                },\n                {\n                  label: 'Insert size',\n                  onClick: () => {\n                    self.setColorScheme({\n                      type: 'insertSize',\n                    })\n                  },\n                },\n                ...superColorSchemeSubMenuItems(),\n              ],\n            },\n            {\n              label: 'Group by...',\n              icon: WorkspacesIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  GroupByDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ] as const\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttach } = await import('./doAfterAttach.ts')\n            doAfterAttach(self)\n          } catch (e) {\n            getSession(self).notifyError(`${e}`, e)\n            console.error(e)\n          }\n        })()\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { showSoftClipping, mismatchAlpha, sortedBy, ...rest } =\n        snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(showSoftClipping ? { showSoftClipping } : {}),\n        ...(mismatchAlpha !== undefined ? { mismatchAlpha } : {}),\n        ...(sortedBy !== undefined ? { sortedBy } : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearPileupDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type LinearPileupDisplayModel = Instance<LinearPileupDisplayStateModel>\nexport default stateModelFactory\n","import DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearPileupDisplay',\n      displayName: 'Pileup display',\n      helpText:\n        'Display stacked aligned reads showing exact placement and sequences relative to the reference genome',\n      configSchema,\n      stateModel: modelFactory(configSchema),\n      subDisplay: { type: 'LinearAlignmentsDisplay', lowerPanel: true },\n      trackType: 'AlignmentsTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n\nexport { default as linearPileupDisplayStateModelFactory } from './model.ts'\nexport { default as linearPileupDisplayConfigSchemaFactory } from './configSchema.ts'\nexport { SharedLinearPileupDisplayMixin } from './SharedLinearPileupDisplayMixin.ts'\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { linearBasicDisplayConfigSchemaFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport { defaultFilterFlags } from '../shared/util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearReadArcsDisplay\n */\nfunction configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearReadArcsDisplay',\n    {\n      /**\n       * #slot\n       */\n      maxFeatureScreenDensity: {\n        type: 'number',\n        description: 'maximum features per pixel that is displayed in the view',\n        defaultValue: 5,\n      },\n\n      /**\n       * #slot\n       */\n      lineWidth: {\n        type: 'number',\n        description: 'set arc line width',\n        defaultValue: 1,\n      },\n\n      /**\n       * #slot\n       */\n      jitter: {\n        type: 'number',\n        description:\n          'jitters the x position so e.g. if many reads map to exact same x position, jittering makes it easy to see that there are many of them',\n        defaultValue: 0,\n      },\n\n      /**\n       * #slot\n       */\n      colorBy: {\n        type: 'frozen',\n        defaultValue: { type: 'insertSizeAndOrientation' },\n      },\n      /**\n       * #slot\n       */\n      filterBy: {\n        type: 'frozen',\n        defaultValue: defaultFilterFlags,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearBasicDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaF\n","import { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\n\n/**\n * #stateModel NonBlockCanvasDisplayMixin\n * #category display\n *\n * Mixin for non-block-based displays that render to a single canvas.\n * Provides common state for tracking rendering offset, loading state,\n * and canvas references.\n *\n * Used by displays like LinearReadCloudDisplay, LinearReadArcsDisplay,\n * and LinearHicDisplay that render across the entire view width rather\n * than in discrete blocks.\n */\nexport default function NonBlockCanvasDisplayMixin() {\n  return types\n    .model('NonBlockCanvasDisplayMixin', {})\n    .volatile(() => ({\n      /**\n       * #volatile\n       * Loading state for data fetching/rendering\n       */\n      loading: false,\n      /**\n       * #volatile\n       * The offsetPx of the view when the canvas was last rendered.\n       * Used to calculate how much to shift the canvas during scrolling\n       * before a new render completes.\n       */\n      lastDrawnOffsetPx: undefined as number | undefined,\n      /**\n       * #volatile\n       * Reference to the main canvas element\n       */\n      ref: null as HTMLCanvasElement | null,\n      /**\n       * #volatile\n       * ImageBitmap returned from RPC rendering\n       */\n      renderingImageData: undefined as ImageBitmap | undefined,\n      /**\n       * #volatile\n       * Stop token for the current rendering operation\n       */\n      renderingStopToken: undefined as StopToken | undefined,\n      /**\n       * #volatile\n       * Status message to display during loading\n       */\n      statusMessage: undefined as string | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Whether the display has been rendered at least once\n       */\n      get drawn() {\n        return self.lastDrawnOffsetPx !== undefined\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * Set the offsetPx at which the canvas was rendered\n       */\n      setLastDrawnOffsetPx(n: number) {\n        self.lastDrawnOffsetPx = n\n      },\n      /**\n       * #action\n       * Set loading state\n       */\n      setLoading(f: boolean) {\n        self.loading = f\n      },\n      /**\n       * #action\n       * Set reference to the canvas element\n       */\n      setRef(ref: HTMLCanvasElement | null) {\n        self.ref = ref\n      },\n      /**\n       * #action\n       * Set the rendering imageData from RPC\n       */\n      setRenderingImageData(imageData: ImageBitmap | undefined) {\n        self.renderingImageData = imageData\n      },\n      /**\n       * #action\n       * Set the rendering stop token\n       */\n      setRenderingStopToken(token?: StopToken) {\n        self.renderingStopToken = token\n      },\n      /**\n       * #action\n       * Set the status message displayed during loading\n       */\n      setStatusMessage(msg?: string) {\n        self.statusMessage = msg\n      },\n    }))\n    .actions(self => ({\n      beforeDestroy() {\n        if (self.renderingStopToken) {\n          stopStopToken(self.renderingStopToken)\n        }\n      },\n    }))\n}\n\nexport type NonBlockCanvasDisplayMixinType = ReturnType<\n  typeof NonBlockCanvasDisplayMixin\n>\n","import { types } from '@jbrowse/mobx-state-tree'\nimport { NonBlockCanvasDisplayMixin } from '@jbrowse/plugin-linear-genome-view'\n\nimport type { ChainData, ColorBy, FilterBy } from './types.ts'\n\n/**\n * #stateModel LinearReadDisplayBaseMixin\n * Base mixin for all LinearRead displays (Cloud, Stack, Arcs)\n * Contains common volatile state, views, and actions shared across all three\n * display types. Composes with NonBlockCanvasDisplayMixin for the shared\n * non-block canvas display state.\n *\n * extends\n * - [NonBlockCanvasDisplayMixin](../nonblockcanvasdisplaymixin)\n */\nexport function LinearReadDisplayBaseMixin() {\n  return types.compose(\n    'LinearReadDisplayBaseMixin',\n    NonBlockCanvasDisplayMixin(),\n    types\n      .model({\n        /**\n         * #property\n         * Filter settings override (if set, overrides configuration)\n         */\n        filterBySetting: types.frozen<FilterBy | undefined>(),\n\n        /**\n         * #property\n         * Color scheme settings override (if set, overrides configuration)\n         */\n        colorBySetting: types.frozen<ColorBy | undefined>(),\n      })\n      .volatile(() => ({\n        /**\n         * #volatile\n         * Chain data containing features to render\n         */\n        chainData: undefined as ChainData | undefined,\n        /**\n         * #volatile\n         * Last drawn base pairs per pixel (for tracking zoom changes)\n         */\n        lastDrawnBpPerPx: 0,\n      }))\n      .actions(self => ({\n        /**\n         * #action\n         * Update the last drawn bp per pixel value\n         */\n        setLastDrawnBpPerPx(n: number) {\n          self.lastDrawnBpPerPx = n\n        },\n        /**\n         * #action\n         * Set the color scheme override\n         */\n        setColorScheme(colorBy: { type: string }) {\n          self.colorBySetting = {\n            ...colorBy,\n          }\n        },\n        /**\n         * #action\n         * Set the chain data to render\n         */\n        setChainData(args: ChainData) {\n          self.chainData = args\n        },\n        /**\n         * #action\n         * Set the filter override\n         */\n        setFilterBy(filter: FilterBy) {\n          self.filterBySetting = {\n            ...filter,\n          }\n        },\n      })),\n  )\n}\n","import type React from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport {\n  FeatureDensityMixin,\n  TrackHeightMixin,\n} from '@jbrowse/plugin-linear-genome-view'\n\nimport { LinearReadArcsDisplaySettingsMixin } from '../shared/LinearReadArcsDisplaySettingsMixin.ts'\nimport { LinearReadDisplayBaseMixin } from '../shared/LinearReadDisplayBaseMixin.ts'\nimport {\n  calculateSvgLegendWidth,\n  getReadDisplayLegendItems,\n} from '../shared/legendUtils.ts'\nimport {\n  getColorSchemeMenuItem,\n  getFilterByMenuItem,\n} from '../shared/menuItems.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LegendItem,\n} from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #stateModel LinearReadArcsDisplay\n * the arc display is a non-block-based track, so draws to a single canvas and\n * can connect multiple regions\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [TrackHeightMixin](../trackheightmixin)\n * - [FeatureDensityMixin](../featuredensitymixin)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearReadArcsDisplay',\n      BaseDisplay,\n      TrackHeightMixin(),\n      FeatureDensityMixin(),\n      LinearReadDisplayBaseMixin(),\n      LinearReadArcsDisplaySettingsMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearReadArcsDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        showLegend: types.maybe(types.boolean),\n      }),\n    )\n    .views(self => ({\n      /**\n       * #getter\n       * Get the color settings (from override or configuration)\n       */\n      get colorBy() {\n        return self.colorBySetting ?? getConf(self, 'colorBy')\n      },\n      /**\n       * #getter\n       * Get the filter settings (from override or configuration)\n       */\n      get filterBy() {\n        return self.filterBySetting ?? getConf(self, 'filterBy')\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setShowLegend(s: boolean) {\n        self.showLegend = s\n      },\n      /**\n       * #action\n       * Reload the display (clears error state)\n       */\n      reload() {\n        self.error = undefined\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * Returns legend items based on current colorBy setting\n       */\n      legendItems(): LegendItem[] {\n        return getReadDisplayLegendItems(self.colorBy)\n      },\n\n      /**\n       * #method\n       * Returns the width needed for the SVG legend if showLegend is enabled.\n       * Used by SVG export to add extra width for the legend area.\n       */\n      svgLegendWidth(): number {\n        return self.showLegend ? calculateSvgLegendWidth(this.legendItems()) : 0\n      },\n    }))\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        renderProps: superRenderProps,\n      } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            notReady: false,\n            filterBy: self.filterBy,\n            colorBy: self.colorBy,\n            drawInter: self.drawInter,\n            drawLongRange: self.drawLongRange,\n            lineWidth: self.lineWidthSetting,\n            jitter: self.jitterVal,\n            height: self.height,\n          }\n        },\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            getFilterByMenuItem(self),\n            {\n              label: 'Line width',\n              subMenu: [\n                {\n                  label: 'Thin',\n                  onClick: () => {\n                    self.setLineWidth(1)\n                  },\n                },\n                {\n                  label: 'Bold',\n                  onClick: () => {\n                    self.setLineWidth(2)\n                  },\n                },\n                {\n                  label: 'Extra bold',\n                  onClick: () => {\n                    self.setLineWidth(5)\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Jitter x-positions',\n              subMenu: [\n                {\n                  type: 'checkbox',\n                  checked: self.jitterVal === 0,\n                  label: 'None',\n                  onClick: () => {\n                    self.setJitter(0)\n                  },\n                },\n                {\n                  type: 'checkbox',\n                  checked: self.jitterVal === 2,\n                  label: 'Small',\n                  onClick: () => {\n                    self.setJitter(2)\n                  },\n                },\n                {\n                  type: 'checkbox',\n                  checked: self.jitterVal === 10,\n                  label: 'Large',\n                  onClick: () => {\n                    self.setJitter(10)\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Show...',\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Show legend',\n                  type: 'checkbox',\n                  checked: self.showLegend,\n                  onClick: () => {\n                    self.setShowLegend(!self.showLegend)\n                  },\n                },\n                {\n                  label:\n                    'Inter-chromosomal connections (purple vertical lines)',\n                  type: 'checkbox',\n                  checked: self.drawInter,\n                  onClick: () => {\n                    self.setDrawInter(!self.drawInter)\n                  },\n                },\n                {\n                  label: 'Long range connections (red vertical lines)',\n                  type: 'checkbox',\n                  checked: self.drawLongRange,\n                  onClick: () => {\n                    self.setDrawLongRange(!self.drawLongRange)\n                  },\n                },\n              ],\n            },\n            getColorSchemeMenuItem(self),\n          ]\n        },\n\n        /**\n         * #method\n         */\n        async renderSvg(\n          opts: ExportSvgDisplayOptions,\n        ): Promise<React.ReactNode> {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self as LinearReadArcsDisplayModel, opts)\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttachRPC } = await import('./afterAttachRPC.tsx')\n            doAfterAttachRPC(self)\n          } catch (e) {\n            console.error(e)\n            self.setError(e)\n          }\n        })()\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        lineWidth,\n        jitter,\n        drawInter,\n        drawLongRange,\n        showLegend,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(lineWidth !== undefined ? { lineWidth } : {}),\n        ...(jitter !== undefined ? { jitter } : {}),\n        ...(!drawInter ? { drawInter } : {}),\n        ...(!drawLongRange ? { drawLongRange } : {}),\n        ...(showLegend !== undefined ? { showLegend } : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearReadArcsDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearReadArcsDisplayModel =\n  Instance<LinearReadArcsDisplayStateModel>\n\nexport default stateModelFactory\n","import { getConf } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel LinearReadArcsDisplaySettingsMixin\n *\n * Mixin for LinearReadArcsDisplay-specific settings\n * Contains arc rendering options like line width, jitter, and connection toggles\n */\nexport function LinearReadArcsDisplaySettingsMixin() {\n  return types\n    .model('LinearReadArcsDisplaySettingsMixin', {\n      /**\n       * #property\n       * Width of the arc lines (thin, bold, extra bold)\n       */\n      lineWidth: types.maybe(types.number),\n\n      /**\n       * #property\n       * Jitter amount for x-position to better visualize overlapping arcs\n       */\n      jitter: types.maybe(types.number),\n\n      /**\n       * #property\n       * Whether to draw inter-region vertical lines\n       */\n      drawInter: true,\n\n      /**\n       * #property\n       * Whether to draw long-range connections\n       */\n      drawLongRange: true,\n    })\n    .actions(self => ({\n      /**\n       * #action\n       * Toggle drawing of inter-region vertical lines\n       */\n      setDrawInter(f: boolean) {\n        self.drawInter = f\n      },\n\n      /**\n       * #action\n       * Toggle drawing of long-range connections\n       */\n      setDrawLongRange(f: boolean) {\n        self.drawLongRange = f\n      },\n\n      /**\n       * #action\n       * Set the line width (thin=1, bold=2, extrabold=5, etc)\n       */\n      setLineWidth(n: number) {\n        self.lineWidth = n\n      },\n\n      /**\n       * #action\n       * Set jitter amount for x-position\n       * Helpful to jitter the x direction so you see better evidence\n       * when e.g. 100 long reads map to same x position\n       */\n      setJitter(n: number) {\n        self.jitter = n\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get lineWidthSetting() {\n        // @ts-expect-error getConf works\n        return self.lineWidth ?? getConf(self, 'lineWidth')\n      },\n\n      /**\n       * #getter\n       */\n      get jitterVal(): number {\n        // @ts-expect-error getConf works\n        return self.jitter ?? getConf(self, 'jitter')\n      },\n    }))\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './configSchema.ts'\nimport stateModelF from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new DisplayType({\n      name: 'LinearReadArcsDisplay',\n      displayName: 'Read arc display',\n      helpText: 'Connect paired end reads and long split reads using arcs',\n      configSchema,\n      stateModel: stateModelF(configSchema),\n      trackType: 'AlignmentsTrack',\n      viewType: 'LinearGenomeView',\n      subDisplay: { type: 'LinearAlignmentsDisplay', lowerPanel: true },\n      ReactComponent: lazy(\n        () => import('./components/LinearReadArcsReactComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { linearBasicDisplayConfigSchemaFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport { defaultFilterFlags } from '../shared/util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearReadCloudDisplay\n */\nfunction configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearReadCloudDisplay',\n    {\n      minSubfeatureWidth: {\n        type: 'number',\n        defaultValue: 1,\n      },\n\n      /**\n       * #slot\n       */\n      maxFeatureScreenDensity: {\n        type: 'number',\n        description: 'maximum features per pixel that is displayed in the view',\n        defaultValue: 5,\n      },\n\n      /**\n       * #slot\n       */\n      featureHeight: {\n        type: 'number',\n        defaultValue: 7,\n      },\n\n      /**\n       * #slot\n       */\n      hideSmallIndels: {\n        type: 'boolean',\n        defaultValue: false,\n      },\n\n      /**\n       * #slot\n       */\n      hideMismatches: {\n        type: 'boolean',\n        defaultValue: false,\n      },\n\n      /**\n       * #slot\n       */\n      hideLargeIndels: {\n        type: 'boolean',\n        defaultValue: false,\n      },\n\n      /**\n       * #slot\n       */\n      colorBy: {\n        type: 'frozen',\n        defaultValue: { type: 'insertSizeAndOrientation' },\n      },\n\n      /**\n       * #slot\n       */\n      filterBy: {\n        type: 'frozen',\n        defaultValue: defaultFilterFlags,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearBasicDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaF\n","import type React from 'react'\nimport { lazy } from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport {\n  FeatureDensityMixin,\n  TrackHeightMixin,\n} from '@jbrowse/plugin-linear-genome-view'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\n\nimport { chainToSimpleFeature } from '../LinearReadArcsDisplay/chainToSimpleFeature.ts'\nimport { calculateCloudTicks } from '../RenderLinearReadCloudDisplayRPC/drawFeatsCloud.ts'\nimport { LinearReadDisplayBaseMixin } from '../shared/LinearReadDisplayBaseMixin.ts'\nimport { LinearReadDisplayWithLayoutMixin } from '../shared/LinearReadDisplayWithLayoutMixin.ts'\nimport { LinearReadDisplayWithPairFiltersMixin } from '../shared/LinearReadDisplayWithPairFiltersMixin.ts'\nimport { SharedModificationsMixin } from '../shared/SharedModificationsMixin.ts'\nimport {\n  calculateSvgLegendWidth,\n  getReadDisplayLegendItems,\n} from '../shared/legendUtils.ts'\nimport {\n  getColorSchemeMenuItem,\n  getEditFiltersMenuItem,\n  getMismatchDisplayMenuItem,\n} from '../shared/menuItems.ts'\n\nimport type { ReducedFeature } from '../shared/types.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LegendItem,\n} from '@jbrowse/plugin-linear-genome-view'\n\nconst SetFeatureHeightDialog = lazy(\n  () => import('./components/SetFeatureHeightDialog.tsx'),\n)\n\n/**\n * #stateModel LinearReadCloudDisplay\n * it is not a block based track, hence not BaseLinearDisplay\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [TrackHeightMixin](../trackheightmixin)\n * - [FeatureDensityMixin](../featuredensitymixin)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearReadCloudDisplay',\n      BaseDisplay,\n      TrackHeightMixin(),\n      FeatureDensityMixin(),\n      LinearReadDisplayBaseMixin(),\n      LinearReadDisplayWithLayoutMixin(),\n      LinearReadDisplayWithPairFiltersMixin(),\n      SharedModificationsMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearReadCloudDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n\n        /**\n         * #property\n         */\n        drawCloud: false,\n\n        /**\n         * #property\n         * Whether to remove spacing between stacked features\n         */\n        noSpacing: types.maybe(types.boolean),\n\n        /**\n         * #property\n         * Maximum height for the layout (prevents infinite stacking)\n         */\n        trackMaxHeight: types.maybe(types.number),\n\n        /**\n         * #property\n         */\n        hideSmallIndelsSetting: types.maybe(types.boolean),\n\n        /**\n         * #property\n         */\n        hideMismatchesSetting: types.maybe(types.boolean),\n\n        /**\n         * #property\n         */\n        hideLargeIndelsSetting: types.maybe(types.boolean),\n\n        /**\n         * #property\n         */\n        showLegend: types.maybe(types.boolean),\n\n        /**\n         * #property\n         */\n        showYScalebar: types.optional(types.boolean, true),\n\n        /**\n         * #property\n         */\n        showOutline: types.optional(types.boolean, true),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       * Current height of the layout after drawing\n       */\n      layoutHeight: 0,\n      /**\n       * #volatile\n       * Chain ID of the currently selected feature for persistent highlighting\n       */\n      selectedFeatureId: undefined as string | undefined,\n      /**\n       * #volatile\n       * Max distance for cloud mode scale (min is always 1 for log scale)\n       */\n      cloudMaxDistance: undefined as number | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Get the color settings (from override or configuration)\n       */\n      get colorBy() {\n        return self.colorBySetting ?? getConf(self, 'colorBy')\n      },\n      /**\n       * #getter\n       * Get the filter settings (from override or configuration)\n       */\n      get filterBy() {\n        return self.filterBySetting ?? getConf(self, 'filterBy')\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * Reload the display (clears error state)\n       */\n      reload() {\n        self.error = undefined\n      },\n    }))\n    .views(self => ({\n      get dataTestId() {\n        return self.drawCloud ? 'cloud-canvas' : 'stack-canvas'\n      },\n      /**\n       * #getter\n       */\n      get featureHeightSetting() {\n        return self.featureHeight ?? getConf(self, 'featureHeight')\n      },\n      /**\n       * #getter\n       */\n      get hideSmallIndels() {\n        return self.hideSmallIndelsSetting ?? getConf(self, 'hideSmallIndels')\n      },\n      /**\n       * #getter\n       */\n      get hideMismatches() {\n        return self.hideMismatchesSetting ?? getConf(self, 'hideMismatches')\n      },\n      /**\n       * #getter\n       */\n      get hideLargeIndels() {\n        return self.hideLargeIndelsSetting ?? getConf(self, 'hideLargeIndels')\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get modificationThreshold() {\n        return self.colorBy?.modifications?.threshold ?? 10\n      },\n      /**\n       * #getter\n       * Domain for cloud mode scale: [1, maxDistance]\n       * Uses 1 as lower bound since it's a log scale\n       */\n      get cloudDomain(): [number, number] | undefined {\n        if (self.cloudMaxDistance === undefined) {\n          return undefined\n        }\n        return [1, self.cloudMaxDistance]\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Calculate ticks for the y-axis scalebar in cloud mode\n       */\n      get cloudTicks() {\n        if (!self.drawCloud || !self.cloudDomain || !self.showYScalebar) {\n          return undefined\n        }\n        return calculateCloudTicks(self.cloudDomain, self.height)\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * Set whether to remove spacing between features\n       */\n      setNoSpacing(flag?: boolean) {\n        self.noSpacing = flag\n      },\n      /**\n       * #action\n       * Set the maximum height for the layout\n       */\n      setMaxHeight(n?: number) {\n        self.trackMaxHeight = n\n      },\n      /**\n       * #action\n       * Set the current layout height\n       */\n      setLayoutHeight(n: number) {\n        self.layoutHeight = n\n      },\n      /**\n       * #action\n       * Set the max distance for cloud mode scale\n       * Only updates if value differs by more than EPSILON to avoid infinite re-renders\n       */\n      setCloudMaxDistance(maxDistance: number) {\n        const EPSILON = 0.000001\n        if (\n          self.cloudMaxDistance === undefined ||\n          Math.abs(self.cloudMaxDistance - maxDistance) > EPSILON\n        ) {\n          self.cloudMaxDistance = maxDistance\n        }\n      },\n      /**\n       * #action\n       */\n      setShowYScalebar(show: boolean) {\n        self.showYScalebar = show\n      },\n      /**\n       * #action\n       */\n      setShowOutline(show: boolean) {\n        self.showOutline = show\n      },\n      /**\n       * #action\n       */\n      selectFeature(chain: ReducedFeature[]) {\n        const session = getSession(self)\n        const syntheticFeature = chainToSimpleFeature(chain)\n        if (isSessionModelWithWidgets(session)) {\n          const featureWidget = session.addWidget(\n            'BaseFeatureWidget',\n            'baseFeature',\n            {\n              featureData: syntheticFeature.toJSON(),\n              view: getContainingView(self),\n              track: getContainingTrack(self),\n            },\n          )\n          session.showWidget(featureWidget)\n        }\n        session.setSelection(syntheticFeature)\n      },\n      /**\n       * #action\n       */\n      setDrawCloud(b: boolean) {\n        self.drawCloud = b\n      },\n      /**\n       * #action\n       * Set the ID of the selected feature for persistent highlighting\n       */\n      setSelectedFeatureId(id: string | undefined) {\n        self.selectedFeatureId = id\n      },\n      /**\n       * #action\n       */\n      setHideSmallIndels(arg: boolean) {\n        self.hideSmallIndelsSetting = arg\n      },\n      /**\n       * #action\n       */\n      setHideMismatches(arg: boolean) {\n        self.hideMismatchesSetting = arg\n      },\n      /**\n       * #action\n       */\n      setHideLargeIndels(arg: boolean) {\n        self.hideLargeIndelsSetting = arg\n      },\n\n      /**\n       * #action\n       */\n      setShowLegend(s: boolean) {\n        self.showLegend = s\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * Returns legend items based on current colorBy setting\n       */\n      legendItems(): LegendItem[] {\n        return getReadDisplayLegendItems(\n          self.colorBy,\n          self.visibleModifications,\n        )\n      },\n\n      /**\n       * #method\n       * Returns the width needed for the SVG legend if showLegend is enabled.\n       * Used by SVG export to add extra width for the legend area.\n       */\n      svgLegendWidth(): number {\n        return self.showLegend ? calculateSvgLegendWidth(this.legendItems()) : 0\n      },\n    }))\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        renderProps: superRenderProps,\n      } = self\n\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            notReady: false,\n            filterBy: self.filterBy,\n            colorBy: self.colorBy,\n            featureHeight: self.featureHeightSetting,\n            noSpacing: self.noSpacing ?? false,\n            drawCloud: self.drawCloud,\n            drawSingletons: self.drawSingletons,\n            drawProperPairs: self.drawProperPairs,\n            flipStrandLongReadChains: self.flipStrandLongReadChains,\n            trackMaxHeight: self.trackMaxHeight,\n            hideSmallIndels: self.hideSmallIndels,\n            hideMismatches: self.hideMismatches,\n            hideLargeIndels: self.hideLargeIndels,\n            showOutline: self.showOutline,\n            cloudDomain: self.cloudDomain,\n            visibleModifications: Object.fromEntries(\n              self.visibleModifications.toJSON(),\n            ),\n          }\n        },\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Set feature height...',\n              subMenu: [\n                {\n                  label: 'Normal',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 7 && self.noSpacing !== true,\n                  onClick: () => {\n                    self.setFeatureHeight(7)\n                    self.setNoSpacing(false)\n                  },\n                },\n                {\n                  label: 'Compact',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 3 && self.noSpacing === true,\n                  onClick: () => {\n                    self.setFeatureHeight(3)\n                    self.setNoSpacing(true)\n                  },\n                },\n                {\n                  label: 'Super-compact',\n                  type: 'radio',\n                  checked:\n                    self.featureHeightSetting === 1 && self.noSpacing === true,\n                  onClick: () => {\n                    self.setFeatureHeight(1)\n                    self.setNoSpacing(true)\n                  },\n                },\n                {\n                  label: 'Manually set height...',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      SetFeatureHeightDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Show legend',\n                  type: 'checkbox',\n                  checked: self.showLegend,\n                  onClick: () => {\n                    self.setShowLegend(!self.showLegend)\n                  },\n                },\n                {\n                  label: \"Show as 'read cloud' (paired-end reads)\",\n                  type: 'checkbox',\n                  helpText:\n                    'In read cloud mode, the y-coordinate of paired-end reads is proportional to insert size (TLEN). This mode is designed for paired-end short reads; long reads will appear at y=0.',\n                  checked: self.drawCloud,\n                  onClick: () => {\n                    self.setDrawCloud(!self.drawCloud)\n                  },\n                },\n                {\n                  label: 'Show y-scalebar',\n                  type: 'checkbox',\n                  helpText:\n                    'Show insert size scale on the y-axis (only visible in cloud mode)',\n                  checked: self.showYScalebar,\n                  onClick: () => {\n                    self.setShowYScalebar(!self.showYScalebar)\n                  },\n                },\n                {\n                  label: 'Show read strand relative to primary',\n                  helpText:\n                    'This makes all the reads draw their strand relative to the primary alignment, which can be helpful in seeing patterns of flipping orientation in split long-read alignments',\n                  type: 'checkbox',\n                  checked: self.flipStrandLongReadChains,\n                  onClick: () => {\n                    self.setFlipStrandLongReadChains(\n                      !self.flipStrandLongReadChains,\n                    )\n                  },\n                },\n                {\n                  label: 'Show outline',\n                  helpText: 'Draw an outline around each read',\n                  type: 'checkbox',\n                  checked: self.showOutline,\n                  onClick: () => {\n                    self.setShowOutline(!self.showOutline)\n                  },\n                },\n                getMismatchDisplayMenuItem(self),\n              ],\n            },\n\n            getEditFiltersMenuItem(self),\n            getColorSchemeMenuItem(self),\n          ]\n        },\n\n        /**\n         * #method\n         */\n        async renderSvg(\n          opts: ExportSvgDisplayOptions,\n        ): Promise<React.ReactNode> {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self as LinearReadCloudDisplayModel, opts)\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttachRPC } = await import('./afterAttachRPC.tsx')\n            doAfterAttachRPC(self)\n          } catch (e) {\n            console.error(e)\n            self.setError(e)\n          }\n        })()\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        drawCloud,\n        noSpacing,\n        trackMaxHeight,\n        showLegend,\n        showOutline,\n        hideSmallIndelsSetting,\n        hideMismatchesSetting,\n        hideLargeIndelsSetting,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(drawCloud ? { drawCloud } : {}),\n        ...(noSpacing !== undefined ? { noSpacing } : {}),\n        ...(trackMaxHeight !== undefined ? { trackMaxHeight } : {}),\n        ...(showLegend !== undefined ? { showLegend } : {}),\n        ...(!showOutline ? { showOutline } : {}),\n        ...(hideSmallIndelsSetting !== undefined\n          ? { hideSmallIndelsSetting }\n          : {}),\n        ...(hideMismatchesSetting !== undefined\n          ? { hideMismatchesSetting }\n          : {}),\n        ...(hideLargeIndelsSetting !== undefined\n          ? { hideLargeIndelsSetting }\n          : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearReadCloudDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearReadCloudDisplayModel =\n  Instance<LinearReadCloudDisplayStateModel>\n\nexport default stateModelFactory\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport type { FlatbushEntry } from './flatbushType.ts'\nimport type { FlatbushItem } from '../PileupRenderer/types.ts'\nimport type Flatbush from '@jbrowse/core/util/flatbush'\n\n/**\n * Mixin for LinearRead displays that use Flatbush layout for mouseover functionality\n * Used by LinearReadCloudDisplay and LinearReadStackDisplay\n */\nexport function LinearReadDisplayWithLayoutMixin() {\n  return types\n    .model('LinearReadDisplayWithLayoutMixin', {})\n    .volatile(() => ({\n      /**\n       * #volatile\n       * Flatbush spatial index for efficient mouseover detection\n       */\n      featureLayout: undefined as Flatbush | undefined,\n      /**\n       * #volatile\n       * Reference to the mouseover overlay canvas\n       */\n      mouseoverRef: null as HTMLCanvasElement | null,\n      /**\n       * #volatile\n       * Array of feature data for Flatbush spatial index\n       */\n      featuresForFlatbush: [] as FlatbushEntry[],\n      /**\n       * #volatile\n       * Flatbush spatial index for mismatch mouseover detection\n       */\n      mismatchLayout: undefined as Flatbush | undefined,\n      /**\n       * #volatile\n       * Array of mismatch data for Flatbush spatial index\n       */\n      mismatchItems: [] as FlatbushItem[],\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * Set the Flatbush spatial index\n       */\n      setFeatureLayout(layout: Flatbush) {\n        self.featureLayout = layout\n      },\n      /**\n       * #action\n       * Set reference to the mouseover canvas element\n       */\n      setMouseoverRef(ref: HTMLCanvasElement | null) {\n        self.mouseoverRef = ref\n      },\n      /**\n       * #action\n       * Set the features data for Flatbush index\n       */\n      setFeaturesForFlatbush(features: FlatbushEntry[]) {\n        self.featuresForFlatbush = features\n      },\n      /**\n       * #action\n       * Set the mismatch Flatbush spatial index\n       */\n      setMismatchLayout(layout: Flatbush) {\n        self.mismatchLayout = layout\n      },\n      /**\n       * #action\n       * Set the mismatch data for Flatbush index\n       */\n      setMismatchItems(items: FlatbushItem[]) {\n        self.mismatchItems = items\n      },\n    }))\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * Mixin for LinearRead displays that support pair filtering and feature height customization\n * Used by LinearReadCloudDisplay and LinearReadStackDisplay\n */\nexport function LinearReadDisplayWithPairFiltersMixin() {\n  return types\n    .model('LinearReadDisplayWithPairFiltersMixin', {\n      /**\n       * #property\n       * Whether to draw singleton reads (reads without a mate)\n       */\n      drawSingletons: true,\n\n      /**\n       * #property\n       * Whether to draw proper pairs (correctly oriented and spaced paired reads)\n       */\n      drawProperPairs: true,\n\n      /**\n       * #property\n       * Whether to flip strand for long read chains (multiply by primaryStrand)\n       */\n      flipStrandLongReadChains: true,\n\n      /**\n       * #property\n       * Custom feature height override (if set, overrides configuration)\n       */\n      featureHeight: types.maybe(types.number),\n    })\n    .actions(self => ({\n      /**\n       * #action\n       * Toggle whether to draw singleton reads\n       */\n      setDrawSingletons(f: boolean) {\n        self.drawSingletons = f\n      },\n      /**\n       * #action\n       * Toggle whether to draw proper pairs\n       */\n      setDrawProperPairs(f: boolean) {\n        self.drawProperPairs = f\n      },\n      /**\n       * #action\n       * Toggle whether to flip strand for long read chains\n       */\n      setFlipStrandLongReadChains(f: boolean) {\n        self.flipStrandLongReadChains = f\n      },\n      /**\n       * #action\n       * Set custom feature height\n       */\n      setFeatureHeight(n?: number) {\n        self.featureHeight = n\n      },\n    }))\n}\n","import { SimpleFeature } from '@jbrowse/core/util'\n\nimport type { ReducedFeature } from '../shared/types.ts'\n\n/**\n * Helper function to convert a chain of ReducedFeatures into a SimpleFeature\n * with subfeatures representing each part of the chain\n */\nexport function chainToSimpleFeature(chain: ReducedFeature[]) {\n  if (chain.length === 0) {\n    throw new Error('Chain cannot be empty')\n  }\n\n  const firstFeat = chain[0]!\n\n  // Create a synthetic feature that encompasses the entire chain\n  return new SimpleFeature({\n    uniqueId: firstFeat.id,\n    id: firstFeat.id,\n    name: firstFeat.name,\n    refName: firstFeat.refName,\n    start: Math.min(...chain.map(f => f.start)),\n    end: Math.max(...chain.map(f => f.end)),\n    strand: firstFeat.strand,\n    flags: firstFeat.flags,\n    tlen: firstFeat.tlen,\n    pair_orientation: firstFeat.pair_orientation,\n    clipLengthAtStartOfRead: firstFeat.clipLengthAtStartOfRead,\n    ...(firstFeat.next_ref && { next_ref: firstFeat.next_ref }),\n    ...(firstFeat.next_pos !== undefined && { next_pos: firstFeat.next_pos }),\n    ...(firstFeat.SA && { SA: firstFeat.SA }),\n    // Add subfeatures for each part of the chain\n    subfeatures: chain.map((feat, idx) => ({\n      uniqueId: `${feat.id}_${idx}`,\n      id: `${feat.id}_${idx}`,\n      name: feat.name,\n      refName: feat.refName,\n      start: feat.start,\n      end: feat.end,\n      strand: feat.strand,\n      type: 'alignment_part',\n      flags: feat.flags,\n      tlen: feat.tlen,\n      pair_orientation: feat.pair_orientation,\n      clipLengthAtStartOfRead: feat.clipLengthAtStartOfRead,\n      ...(feat.next_ref && { next_ref: feat.next_ref }),\n      ...(feat.next_pos !== undefined && { next_pos: feat.next_pos }),\n      ...(feat.SA && { SA: feat.SA }),\n    })),\n  })\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './configSchema.ts'\nimport stateModelF from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new DisplayType({\n      name: 'LinearReadCloudDisplay',\n      displayName: 'Linked reads display',\n      helpText:\n        'Display paired-end and split read (supplementary read) alignments as linked entities. Note that the concept of \"linked reads\" is not specifically referring to Chromium 10x linked reads, this is just the general idea of linking paired-end, and split (supplementary) alignments',\n      configSchema,\n      stateModel: stateModelF(configSchema),\n      trackType: 'AlignmentsTrack',\n      viewType: 'LinearGenomeView',\n      subDisplay: {\n        type: 'LinearAlignmentsDisplay',\n        lowerPanel: true,\n      },\n      ReactComponent: lazy(\n        () => import('./components/LinearReadCloudReactComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { getConf, readConfObject } from '@jbrowse/core/configuration'\nimport SerializableFilterChain from '@jbrowse/core/pluggableElementTypes/renderers/util/serializableFilterChain'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport { cast, getSnapshot, isAlive, types } from '@jbrowse/mobx-state-tree'\nimport { linearWiggleDisplayModelFactory } from '@jbrowse/plugin-wiggle'\nimport FilterListIcon from '@mui/icons-material/FilterList'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\n\nimport { SharedModificationsMixin } from '../shared/SharedModificationsMixin.ts'\nimport { getUniqueModifications } from '../shared/getUniqueModifications.ts'\nimport { getSNPCoverageLegendItems } from '../shared/legendUtils.ts'\nimport { isDefaultFilterFlags } from '../shared/util.ts'\nimport { createAutorun } from '../util.ts'\n\nimport type { ColorBy, FilterBy } from '../shared/types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AnyConfigurationModel,\n  AnyConfigurationSchemaType,\n} from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LegendItem,\n  LinearGenomeViewModel,\n} from '@jbrowse/plugin-linear-genome-view'\nimport type { Theme } from '@mui/material'\n\n// lazies\nconst Tooltip = lazy(() => import('./components/Tooltip.tsx'))\nconst FilterArcsByScoreDialog = lazy(\n  () => import('./components/FilterArcsByScoreDialog.tsx'),\n)\n\n// using a map because it preserves order\nconst rendererTypes = new Map([['snpcoverage', 'SNPCoverageRenderer']])\n\ntype LGV = LinearGenomeViewModel\n\n/**\n * #stateModel LinearSNPCoverageDisplay\n * extends\n * - [LinearWiggleDisplay](../linearwiggledisplay)\n */\nfunction stateModelFactory(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearSNPCoverageDisplay',\n      linearWiggleDisplayModelFactory(pluginManager, configSchema),\n      SharedModificationsMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearSNPCoverageDisplay'),\n        /**\n         * #property\n         */\n        showInterbaseCounts: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        showInterbaseIndicators: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        showArcs: types.maybe(types.boolean),\n        /**\n         * #property\n         */\n        minArcScore: types.optional(types.number, 0),\n        /**\n         * #property\n         */\n        filterBySetting: types.frozen<FilterBy | undefined>(),\n        /**\n         * #property\n         */\n        colorBySetting: types.frozen<ColorBy | undefined>(),\n        /**\n         * #property\n         */\n        jexlFilters: types.optional(types.array(types.string), []),\n      }),\n    )\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get colorBy() {\n        return self.colorBySetting ?? getConf(self, 'colorBy')\n      },\n\n      /**\n       * #getter\n       */\n      get filterBy() {\n        return self.filterBySetting ?? getConf(self, 'filterBy')\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setConfig(configuration: AnyConfigurationModel) {\n        self.configuration = configuration\n      },\n      /**\n       * #action\n       */\n      setFilterBy(filter: FilterBy) {\n        self.filterBySetting = {\n          ...filter,\n        }\n      },\n      /**\n       * #action\n       */\n      setColorScheme(colorBy?: ColorBy) {\n        self.colorBySetting = colorBy\n          ? {\n              ...colorBy,\n            }\n          : undefined\n      },\n      /**\n       * #action\n       */\n      setJexlFilters(filters: string[]) {\n        self.jexlFilters = cast(filters)\n      },\n    }))\n    .views(self => {\n      const { adapterProps: superAdapterProps } = self\n      return {\n        /**\n         * #getter\n         */\n        get modificationThreshold() {\n          return self.colorBy?.modifications?.threshold ?? 10\n        },\n        /**\n         * #getter\n         */\n        get rendererConfig() {\n          const { showArcs, showInterbaseCounts, showInterbaseIndicators } =\n            self\n          // @ts-ignore\n          const conf = self.configuration.renderers?.[self.rendererTypeName]\n          return {\n            showInterbaseCounts:\n              showInterbaseCounts ??\n              readConfObject(conf, 'showInterbaseCounts'),\n            showInterbaseIndicators:\n              showInterbaseIndicators ??\n              readConfObject(conf, 'showInterbaseIndicators'),\n            showArcs: showArcs ?? readConfObject(conf, 'showArcs'),\n          }\n        },\n        /**\n         * #getter\n         */\n        get showArcsSetting() {\n          return this.rendererConfig.showArcs\n        },\n        /**\n         * #getter\n         * Collect all skip features from rendered blocks for cross-region arc drawing\n         * Uses a Map to deduplicate features that appear in multiple blocks\n         * Only computed when showArcsSetting is true for performance\n         * Filters out arcs with score below minArcScore\n         */\n        get skipFeatures(): Feature[] {\n          if (!this.showArcsSetting) {\n            return []\n          }\n          const { minArcScore } = self\n          const skipFeaturesMap = new Map<string, Feature>()\n          for (const block of self.blockState.values()) {\n            if (block.features) {\n              for (const feature of block.features.values()) {\n                if (\n                  feature.get('type') === 'skip' &&\n                  (feature.get('score') ?? 1) >= minArcScore\n                ) {\n                  skipFeaturesMap.set(feature.id(), feature)\n                }\n              }\n            }\n          }\n          return [...skipFeaturesMap.values()]\n        },\n        /**\n         * #getter\n         */\n        get showInterbaseCountsSetting() {\n          return this.rendererConfig.showInterbaseCounts\n        },\n        /**\n         * #getter\n         */\n        get showInterbaseIndicatorsSetting() {\n          return this.rendererConfig.showInterbaseIndicators\n        },\n\n        /**\n         * #getter\n         */\n        get autorunReady() {\n          const view = getContainingView(self) as LGV\n          return (\n            view.initialized &&\n            self.featureDensityStatsReadyAndRegionNotTooLarge &&\n            !self.error\n          )\n        },\n\n        /**\n         * #method\n         */\n        adapterProps() {\n          const superProps = superAdapterProps()\n          const { filters, filterBy } = self\n          return {\n            ...superProps,\n            filters,\n            filterBy,\n            modificationThreshold: this.modificationThreshold,\n          }\n        },\n      }\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setShowInterbaseIndicators(arg: boolean) {\n        self.showInterbaseIndicators = arg\n      },\n      /**\n       * #action\n       */\n      setShowInterbaseCounts(arg: boolean) {\n        self.showInterbaseCounts = arg\n      },\n      /**\n       * #action\n       */\n      setShowArcs(arg: boolean) {\n        self.showArcs = arg\n      },\n      /**\n       * #action\n       */\n      setMinArcScore(arg: number) {\n        self.minArcScore = arg\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        createAutorun(\n          self,\n          async () => {\n            self.setModificationsReady(false)\n            if (!self.autorunReady) {\n              return\n            }\n            const view = getContainingView(self) as LGV\n            const { staticBlocks } = view\n            const { colorBy } = self\n            if (colorBy?.type === 'modifications') {\n              const { modifications, simplexModifications } =\n                await getUniqueModifications({\n                  model: self,\n                  adapterConfig: getConf(self.parentTrack, 'adapter'),\n                  blocks: staticBlocks,\n                })\n              if (isAlive(self)) {\n                self.updateVisibleModifications(modifications)\n                self.setSimplexModifications(simplexModifications)\n                self.setModificationsReady(true)\n              }\n            } else {\n              self.setModificationsReady(true)\n            }\n          },\n          { delay: 1000 },\n        )\n      },\n    }))\n\n    .views(self => {\n      const {\n        renderProps: superRenderProps,\n        renderingProps: superRenderingProps,\n        renderSvg: superRenderSvg,\n        wiggleBaseTrackMenuItems,\n      } = self\n      return {\n        /**\n         * #getter\n         */\n        renderReady() {\n          const superProps = superRenderProps()\n          return !superProps.notReady && self.modificationsReady\n        },\n\n        /**\n         * #method\n         */\n        renderProps() {\n          const { colorBy, visibleModifications, simplexModifications } = self\n          return {\n            ...superRenderProps(),\n            notReady: !this.renderReady(),\n            colorBy,\n            visibleModifications: Object.fromEntries(\n              visibleModifications.toJSON(),\n            ),\n            simplexModifications: [...simplexModifications],\n          }\n        },\n\n        /**\n         * #method\n         */\n        renderingProps() {\n          return {\n            ...superRenderingProps(),\n            displayModel: self,\n          }\n        },\n\n        /**\n         * #method\n         * Custom renderSvg that includes sashimi arcs\n         */\n        async renderSvg(opts: ExportSvgDisplayOptions) {\n          const { renderSNPCoverageSvg } =\n            await import('./components/renderSvg.tsx')\n          return renderSNPCoverageSvg(self, opts, superRenderSvg)\n        },\n\n        /**\n         * #getter\n         */\n        get TooltipComponent() {\n          return Tooltip\n        },\n\n        /**\n         * #getter\n         */\n        get adapterConfig() {\n          const subadapter = getConf(self.parentTrack, 'adapter')\n          const view = getContainingView(self) as LGV\n          const session = getSession(self)\n          const { assemblyManager } = session\n          const assemblyName = view.assemblyNames[0]\n          const assembly = assemblyName\n            ? assemblyManager.get(assemblyName)\n            : undefined\n          const sequenceAdapterConfig =\n            assembly?.configuration?.sequence?.adapter\n          const sequenceAdapter = sequenceAdapterConfig\n            ? getSnapshot(sequenceAdapterConfig)\n            : undefined\n          return {\n            type: 'SNPCoverageAdapter',\n            subadapter,\n            sequenceAdapter,\n          }\n        },\n\n        /**\n         * #getter\n         */\n        get rendererTypeName() {\n          return rendererTypes.get('snpcoverage')\n        },\n\n        /**\n         * #getter\n         */\n        get graphType() {\n          return true\n        },\n\n        /**\n         * #method\n         */\n        contextMenuItems() {\n          return []\n        },\n\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...wiggleBaseTrackMenuItems(),\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Show tooltips',\n                  type: 'checkbox',\n                  checked: self.showTooltipsEnabled,\n                  onClick: () => {\n                    self.setShowTooltips(!self.showTooltipsEnabled)\n                  },\n                },\n                {\n                  label: 'Show legend',\n                  type: 'checkbox',\n                  checked: self.showLegend,\n                  onClick: () => {\n                    self.setShowLegend(!self.showLegend)\n                  },\n                },\n                {\n                  label: 'Insertion/clipping indicators',\n                  type: 'checkbox',\n                  checked: self.showInterbaseIndicatorsSetting,\n                  onClick: () => {\n                    self.setShowInterbaseIndicators(\n                      !self.showInterbaseIndicatorsSetting,\n                    )\n                  },\n                },\n                {\n                  label: 'Insertion/clipping counts',\n                  type: 'checkbox',\n                  checked: self.showInterbaseCountsSetting,\n                  onClick: () => {\n                    self.setShowInterbaseCounts(\n                      !self.showInterbaseCountsSetting,\n                    )\n                  },\n                },\n                {\n                  label: 'Sashimi arcs',\n                  type: 'checkbox',\n                  checked: self.showArcsSetting,\n                  onClick: () => {\n                    self.setShowArcs(!self.showArcsSetting)\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Filter arcs by score...',\n              icon: FilterListIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  FilterArcsByScoreDialog,\n                  { model: self, handleClose },\n                ])\n              },\n            },\n          ]\n        },\n\n        /**\n         * #getter\n         */\n        get filters() {\n          return new SerializableFilterChain({ filters: self.jexlFilters })\n        },\n\n        /**\n         * #method\n         * Returns legend items for SNP coverage display\n         */\n        legendItems(theme: Theme): LegendItem[] {\n          return getSNPCoverageLegendItems(\n            self.colorBy,\n            self.visibleModifications,\n            theme,\n          )\n        },\n      }\n    })\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (snap) {\n        // @ts-expect-error\n        const { colorBy, colorBySetting, filterBySetting, filterBy, ...rest } =\n          snap\n        return {\n          ...rest,\n          filterBySetting: filterBySetting || filterBy,\n          colorBySetting: colorBySetting || colorBy,\n        }\n      }\n      return snap\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        showInterbaseCounts,\n        showInterbaseIndicators,\n        showArcs,\n        minArcScore,\n        filterBySetting,\n        colorBySetting,\n        jexlFilters,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(showInterbaseCounts !== undefined ? { showInterbaseCounts } : {}),\n        ...(showInterbaseIndicators !== undefined\n          ? { showInterbaseIndicators }\n          : {}),\n        ...(showArcs !== undefined ? { showArcs } : {}),\n        ...(minArcScore ? { minArcScore } : {}),\n        ...(!isDefaultFilterFlags(filterBySetting) ? { filterBySetting } : {}),\n        ...(colorBySetting !== undefined ? { colorBySetting } : {}),\n        // mst types wrong, nullish needed\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        ...(jexlFilters?.length ? { jexlFilters } : {}),\n      } as typeof snap\n    })\n}\n\nexport type SNPCoverageDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type SNPCoverageDisplayModel = Instance<SNPCoverageDisplayStateModel>\n\nexport default stateModelFactory\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearSNPCoverageDisplay',\n      displayName: 'SNPCoverage display',\n      helpText:\n        'Display coverage histogram and SNP composition for each genomic position',\n      configSchema,\n      stateModel: modelFactory(pluginManager, configSchema),\n      trackType: 'AlignmentsTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/SNPCoverageDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\nimport { defaultFilterFlags } from '../shared/util.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearSNPCoverageDisplay\n *\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function SNPCoverageConfigFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearSNPCoverageDisplay',\n    {\n      /**\n       * #slot\n       */\n      autoscale: {\n        type: 'stringEnum',\n        defaultValue: 'local',\n        model: types.enumeration('Autoscale type', ['local']),\n        description:\n          'performs local autoscaling (no other options for SNP Coverage available)',\n      },\n      /**\n       * #slot\n       */\n      minScore: {\n        type: 'number',\n        defaultValue: Number.MIN_VALUE,\n        description: 'minimum value for the y-scale',\n      },\n      /**\n       * #slot\n       */\n      maxScore: {\n        type: 'number',\n        description: 'maximum value for the y-scale',\n        defaultValue: Number.MAX_VALUE,\n      },\n      /**\n       * #slot\n       */\n      scaleType: {\n        type: 'stringEnum',\n        model: types.enumeration('Scale type', ['linear', 'log']), // todo zscale\n        description: 'The type of scale to use',\n        defaultValue: 'linear',\n      },\n      /**\n       * #slot\n       */\n      inverted: {\n        type: 'boolean',\n        description: 'draw upside down',\n        defaultValue: false,\n      },\n      /**\n       * #slot\n       */\n      multiTicks: {\n        type: 'boolean',\n        description: 'Display multiple values for the ticks',\n        defaultValue: false,\n      },\n      /**\n       * #slot\n       */\n      renderers: ConfigurationSchema('RenderersConfiguration', {\n        SNPCoverageRenderer: pluginManager.getRendererType(\n          'SNPCoverageRenderer',\n        )!.configSchema,\n      }),\n      /**\n       * #slot\n       */\n      colorBy: {\n        type: 'frozen',\n        description: 'color scheme to use',\n        defaultValue: {\n          type: 'normal',\n        },\n      },\n\n      /**\n       * #slot\n       */\n      filterBy: {\n        type: 'frozen',\n        description: 'default filters to use',\n        defaultValue: defaultFilterFlags,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import RpcMethodType from '@jbrowse/core/pluggableElementTypes/RpcMethodType'\nimport { renameRegionsIfNeeded } from '@jbrowse/core/util'\n\nimport type { RenderArgs } from '@jbrowse/core/rpc/coreRpcMethods'\n\n// specialized get features to return limited data about alignments\nexport default abstract class PileupBaseRPC extends RpcMethodType {\n  async serializeArguments(\n    args: RenderArgs & {\n      stopToken?: string\n      statusCallback?: (arg: string) => void\n    },\n    rpcDriver: string,\n  ) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel?.session?.assemblyManager\n    if (!assemblyManager) {\n      throw new Error('no assembly manager available')\n    }\n\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n\n    return super.serializeArguments(renamedArgs, rpcDriver)\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport PileupBaseRPC from '../base.ts'\n\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { Region } from '@jbrowse/core/util'\n\nexport default class PileupGetGlobalValueForTag extends PileupBaseRPC {\n  name = 'PileupGetGlobalValueForTag'\n\n  async execute(\n    args: {\n      adapterConfig: Record<string, unknown>\n      stopToken?: string\n      headers?: Record<string, string>\n      regions: Region[]\n      sessionId: string\n      tag: string\n    },\n    rpcDriver: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { adapterConfig, sessionId, regions, tag } = deserializedArgs\n\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseFeatureDataAdapter\n\n    const features = dataAdapter.getFeaturesInMultipleRegions(\n      regions,\n      deserializedArgs,\n    )\n    const featuresArray = await firstValueFrom(features.pipe(toArray()))\n    return [\n      ...new Set(\n        featuresArray\n          .map(feature => feature.get('tags')?.[tag])\n          .filter(f => f !== undefined)\n          .map(f => `${f}`),\n      ),\n    ]\n  }\n}\n","import { modificationRegex } from './consts.ts'\n\nexport function getModTypes(mm: string) {\n  const result = []\n  const mods = mm.split(';')\n  for (let i = 0, modsLen = mods.length; i < modsLen; i++) {\n    const mod = mods[i]!\n    if (mod === '') {\n      continue\n    }\n\n    const basemod = mod.split(',')[0]!\n    const matches = modificationRegex.exec(basemod)\n    if (!matches) {\n      throw new Error(`bad format for MM tag: \"${mod}\"`)\n    }\n\n    const base = matches[1]!\n    const strand = matches[2]!\n    const typestr = matches[3]!\n\n    // can be a multi e.g. C+mh for both meth (m) and hydroxymeth (h) so split,\n    // and they can also be chemical codes (ChEBI) e.g. C+16061\n    const types = typestr.split(/(\\d+|.)/)\n\n    for (let j = 0, typesLen = types.length; j < typesLen; j++) {\n      const type = types[j]!\n      if (type === '') {\n        continue\n      }\n      result.push({\n        type,\n        base,\n        strand,\n      })\n    }\n  }\n  return result\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport { detectSimplexModifications } from '../../ModificationParser/detectSimplexModifications.ts'\nimport { getModTypes } from '../../ModificationParser/getModTypes.ts'\nimport { getTagAlt } from '../../util.ts'\nimport PileupBaseRPC from '../base.ts'\n\nimport type { ModificationType } from '../../shared/types.ts'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { Region } from '@jbrowse/core/util'\n\n/**\n * RPC method that collects all unique modifications from alignment features\n * and detects which are simplex (single-strand) vs duplex (both strands).\n *\n * For example:\n * - C+m without G-m  simplex\n * - A+a with T-a  duplex (6mA on both strands)\n *\n * Returns both the modifications for display and the simplex list for\n * correct detectable count calculations in the renderer.\n */\nexport default class PileupGetVisibleModifications extends PileupBaseRPC {\n  name = 'PileupGetVisibleModifications'\n\n  async execute(\n    args: {\n      adapterConfig: Record<string, unknown>\n      stopToken?: string\n      headers?: Record<string, string>\n      regions: Region[]\n      sessionId: string\n      tag: string\n    },\n    rpcDriver: string,\n  ) {\n    const deserializeArguments = await this.deserializeArguments(\n      args,\n      rpcDriver,\n    )\n    const { adapterConfig, sessionId, regions } = deserializeArguments\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseFeatureDataAdapter\n\n    const featuresArray = await firstValueFrom(\n      dataAdapter\n        .getFeaturesInMultipleRegions(regions, deserializeArguments)\n        .pipe(toArray()),\n    )\n\n    // Collect all unique base+strand+type combinations for simplex detection\n    // Use a compound key to ensure we capture both A+a and T-a separately\n    const uniqueModifications = new Map<string, ModificationType>()\n    for (const feat of featuresArray) {\n      const mmTag = getTagAlt(feat, 'MM', 'Mm')\n      for (const mod of getModTypes(typeof mmTag === 'string' ? mmTag : '')) {\n        const key = `${mod.base}${mod.strand}${mod.type}`\n        if (!uniqueModifications.has(key)) {\n          uniqueModifications.set(key, mod)\n        }\n      }\n    }\n\n    const modifications = [...uniqueModifications.values()]\n    const simplexModifications = detectSimplexModifications(modifications)\n\n    // For visibleModifications display, we only need one entry per type\n    // (but we needed all of them for simplex detection above)\n    const modificationsForDisplay = new Map<string, ModificationType>()\n    for (const mod of modifications) {\n      if (!modificationsForDisplay.has(mod.type)) {\n        modificationsForDisplay.set(mod.type, mod)\n      }\n    }\n\n    return {\n      modifications: [...modificationsForDisplay.values()],\n      simplexModifications: [...simplexModifications],\n    }\n  }\n}\n","import type { ModificationType } from '../shared/types.ts'\n\ntype ModificationTypeList = readonly ModificationType[]\n\n/**\n * Detects simplex modifications based on the IGV algorithm.\n *\n * A modification is considered \"simplex\" if it appears on the positive strand\n * but has no corresponding modification on the negative strand.\n *\n * For example:\n * - C+m without G-m would be simplex\n * - C+m with G-m would be duplex\n *\n * This affects how we calculate the \"detectable\" count in coverage rendering:\n * - Simplex: detectable uses strand-specific counts\n * - Duplex: detectable equals modifiable (uses all counts)\n *\n * Reference: IGV's BaseModificationCoverageRenderer.updateBaseModifications\n * https://github.com/igvteam/igv/blob/master/src/main/java/org/broad/igv/sam/mods/BaseModificationCoverageRenderer.java\n */\nexport function detectSimplexModifications(\n  modifications: ModificationTypeList,\n): ReadonlySet<string> {\n  // Use two-pass algorithm for efficiency:\n  // Pass 1: Collect all modification types on minus strand (O(n))\n  // Pass 2: Find plus strand mods without minus strand counterpart (O(n))\n  // Total: O(n) time, O(m) space where m = unique modification types\n\n  const minusStrandMods = new Set<string>()\n  const simplexModifications = new Set<string>()\n\n  // First pass: collect all modifications on the minus strand\n  for (const modification of modifications) {\n    const mod = modification\n    if (mod.strand === '-') {\n      minusStrandMods.add(mod.type)\n    }\n  }\n\n  // Second pass: find positive strand modifications without minus strand counterparts\n  for (const modification of modifications) {\n    const mod = modification\n    if (mod.strand === '+' && !minusStrandMods.has(mod.type)) {\n      simplexModifications.add(mod.type)\n    }\n  }\n\n  return simplexModifications\n}\n","import {\n  PileupGetGlobalValueForTag,\n  PileupGetVisibleModifications,\n} from './rpcMethods.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function PileupRPCMethodsF(pm: PluginManager) {\n  pm.addRpcMethod(() => new PileupGetGlobalValueForTag(pm))\n  pm.addRpcMethod(() => new PileupGetVisibleModifications(pm))\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { MultiLayout, PileupLayout } from '@jbrowse/core/util/layouts'\nimport deepEqual from 'fast-deep-equal'\n\nimport type { FilterBy, SortedBy } from '../shared/types.ts'\nimport type {\n  LayoutSessionLike,\n  LayoutSessionProps,\n} from '@jbrowse/core/pluggableElementTypes/renderers/LayoutSession'\n\nexport interface PileupLayoutSessionProps extends LayoutSessionProps {\n  filterBy: FilterBy\n  sortedBy: SortedBy\n  showSoftClip: boolean\n}\n\ntype MyMultiLayout = MultiLayout<PileupLayout<unknown>, unknown>\n\ninterface CachedPileupLayout {\n  layout: MyMultiLayout\n  props: PileupLayoutSessionProps\n}\n\nexport class PileupLayoutSession implements LayoutSessionLike {\n  props: PileupLayoutSessionProps\n\n  cachedLayout: CachedPileupLayout | undefined\n\n  constructor(props: PileupLayoutSessionProps) {\n    this.props = props\n  }\n\n  update(props: LayoutSessionProps) {\n    this.props = props as PileupLayoutSessionProps\n    return this\n  }\n\n  makeLayout() {\n    const noSpacing = readConfObject(this.props.config, 'noSpacing')\n    const featureHeight = readConfObject(this.props.config, 'height')\n    const maxHeight = readConfObject(this.props.config, 'maxHeight')\n\n    return new MultiLayout(PileupLayout, {\n      featureHeight,\n      spacing: noSpacing ? 0 : 2,\n      maxHeight,\n    })\n  }\n\n  cachedLayoutIsValid(cachedLayout: CachedPileupLayout) {\n    return (\n      cachedLayout.props.bpPerPx === this.props.bpPerPx &&\n      deepEqual(\n        readConfObject(this.props.config),\n        readConfObject(cachedLayout.props.config),\n      ) &&\n      deepEqual(this.props.filters, cachedLayout.props.filters) &&\n      this.props.showSoftClip === cachedLayout.props.showSoftClip &&\n      deepEqual(this.props.sortedBy, cachedLayout.props.sortedBy) &&\n      deepEqual(this.props.filterBy, cachedLayout.props.filterBy)\n    )\n  }\n\n  get layout(): MyMultiLayout {\n    if (!this.cachedLayout || !this.cachedLayoutIsValid(this.cachedLayout)) {\n      this.cachedLayout = {\n        layout: this.makeLayout(),\n        props: this.props,\n      }\n    }\n    return this.cachedLayout.layout\n  }\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport BoxRendererType from '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType'\nimport { expandRegion } from '@jbrowse/core/pluggableElementTypes/renderers/util'\nimport { updateStatus } from '@jbrowse/core/util'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\n\nimport { PileupLayoutSession } from './PileupLayoutSession.ts'\n\nimport type { PileupLayoutSessionProps } from './PileupLayoutSession.ts'\nimport type { RenderArgsDeserialized } from './types.ts'\nimport type { Region } from '@jbrowse/core/util'\n\nexport default class PileupRenderer extends BoxRendererType {\n  supportsSVG = true\n\n  getExpandedRegion(region: Region, renderArgs: RenderArgsDeserialized) {\n    const { config, showSoftClip } = renderArgs\n    const maxClippingSize = readConfObject(config, 'maxClippingSize')\n    const bpExpansion = showSoftClip ? Math.round(maxClippingSize) : 0\n    return expandRegion(region, bpExpansion)\n  }\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { statusCallback = () => {}, regions, bpPerPx } = renderProps\n    const region = regions[0]!\n    const width = (region.end - region.start) / bpPerPx\n\n    const features = await this.getFeatures(renderProps)\n    const layout = this.createLayoutInWorker(renderProps)\n\n    const { makeImageData } = await import('./makeImageData.ts')\n    const { result, height, featureNames } = await updateStatus(\n      'Rendering alignments',\n      statusCallback,\n      () =>\n        makeImageData({\n          width,\n          renderArgs: {\n            ...renderProps,\n            layout,\n            features,\n          },\n          pluginManager: this.pluginManager,\n        }),\n    )\n\n    const serializedLayout = this.serializeLayout(layout, renderProps)\n\n    return rpcResult(\n      {\n        ...result,\n        featureNames,\n        layout: serializedLayout,\n        height,\n        width,\n        maxHeightReached: layout.maxHeightReached,\n      },\n      collectTransferables(result),\n    )\n  }\n\n  createLayoutSession(args: PileupLayoutSessionProps) {\n    return new PileupLayoutSession(args)\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config PileupRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst PileupRenderer = ConfigurationSchema(\n  'PileupRenderer',\n  {\n    /**\n     * #slot\n     * default magenta here is used to detect the user has not customized this\n     */\n    color: {\n      type: 'color',\n      description: 'the color of each feature in a pileup alignment',\n      defaultValue: '#f0f',\n      contextVariable: ['feature'],\n    },\n\n    /**\n     * #slot\n     */\n    orientationType: {\n      type: 'stringEnum',\n      model: types.enumeration('orientationType', ['fr', 'rf', 'ff']),\n      defaultValue: 'fr',\n      description:\n        'read sequencer orientation. fr is normal \"reads pointing at each other ---> <--- while some other sequencers can use other options',\n    },\n    /**\n     * #slot\n     */\n    displayMode: {\n      type: 'stringEnum',\n      model: types.enumeration('displayMode', [\n        'normal',\n        'compact',\n        'collapse',\n      ]),\n      description: 'Alternative display modes',\n      defaultValue: 'normal',\n    },\n    /**\n     * #slot\n     */\n    minSubfeatureWidth: {\n      type: 'number',\n      description:\n        'the minimum width in px for a pileup mismatch feature. use for increasing/decreasing mismatch marker widths when zoomed out, e.g. 0 or 1',\n      defaultValue: 1,\n    },\n    /**\n     * #slot\n     */\n    hideSmallIndels: {\n      type: 'boolean',\n      description:\n        'Hides small indels, sometimes occurring in long read sequencing',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    hideMismatches: {\n      type: 'boolean',\n      description: 'Hides SNP mismatches',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    hideLargeIndels: {\n      type: 'boolean',\n      description: 'Hides large indels (>=10bp)',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    maxHeight: {\n      type: 'integer',\n      description: 'the maximum height to be used in a pileup rendering',\n      defaultValue: 1200,\n    },\n    /**\n     * #slot\n     */\n    maxClippingSize: {\n      type: 'integer',\n      description: 'the max clip size to be used in a pileup rendering',\n      defaultValue: 10000,\n    },\n    /**\n     * #slot\n     */\n    height: {\n      type: 'number',\n      description: 'the height of each feature in a pileup alignment',\n      defaultValue: 7,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    noSpacing: {\n      type: 'boolean',\n      description: 'remove spacing between features',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    largeInsertionIndicatorScale: {\n      type: 'number',\n      description:\n        'scale at which to draw the large insertion indicators (bp/pixel)',\n      defaultValue: 10,\n    },\n    /**\n     * #slot\n     */\n    mismatchAlpha: {\n      type: 'boolean',\n      defaultValue: false,\n      description: 'Fade low quality mismatches',\n    },\n  },\n  { explicitlyTyped: true },\n)\nexport default PileupRenderer\n","import { lazy } from 'react'\n\nimport PileupRenderer from './PileupRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addRendererType(() => {\n    return new PileupRenderer({\n      name: 'PileupRenderer',\n      displayName: 'Pileup renderer',\n      ReactComponent: lazy(() => import('./components/PileupRendering.tsx')),\n      configSchema,\n      pluginManager,\n    })\n  })\n}\n","import RpcMethodType from '@jbrowse/core/pluggableElementTypes/RpcMethodType'\nimport { renameRegionsIfNeeded } from '@jbrowse/core/util'\n\nimport configSchema from '../LinearReadArcsDisplay/configSchema.ts'\n\nimport type { ColorBy } from '../shared/types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { ThemeOptions } from '@mui/material'\n\nexport interface RenderLinearReadArcsDisplayArgs {\n  sessionId: string\n  view: Base1DViewModel\n  adapterConfig: AnyConfigurationModel\n  sequenceAdapter?: Record<string, unknown>\n  config: AnyConfigurationModel\n  theme: ThemeOptions\n  filterBy: Record<string, unknown>\n  colorBy: ColorBy\n  drawInter: boolean\n  drawLongRange: boolean\n  lineWidth: number\n  jitter: number\n  height: number\n  highResolutionScaling?: number\n  exportSVG?: { rasterizeLayers?: boolean; scale?: number }\n  statusCallback?: (status: string) => void\n  stopToken?: string\n}\n\nexport default class RenderLinearReadArcsDisplay extends RpcMethodType {\n  name = 'RenderLinearReadArcsDisplay'\n\n  deserializeArguments(args: any, _rpcDriver: string) {\n    return {\n      ...args,\n      config: configSchema(this.pluginManager).create(args.config, {\n        pluginManager: this.pluginManager,\n      }),\n    }\n  }\n\n  async renameRegionsIfNeeded(\n    args: RenderLinearReadArcsDisplayArgs,\n  ): Promise<RenderLinearReadArcsDisplayArgs> {\n    const assemblyManager =\n      this.pluginManager.rootModel?.session?.assemblyManager\n    if (!assemblyManager) {\n      throw new Error('no assembly manager')\n    }\n\n    const { view, sessionId, adapterConfig } = args\n    const { displayedRegions } = view\n\n    if (!displayedRegions.length) {\n      return args\n    }\n\n    const result = await renameRegionsIfNeeded(assemblyManager, {\n      sessionId,\n      adapterConfig,\n      regions: displayedRegions,\n    })\n\n    return {\n      ...args,\n      view: {\n        ...view,\n        displayedRegions: result.regions,\n      } as typeof view,\n    }\n  }\n\n  async serializeArguments(args: Record<string, unknown>, rpcDriver: string) {\n    const renamed = await this.renameRegionsIfNeeded(\n      args as unknown as RenderLinearReadArcsDisplayArgs,\n    )\n    return super.serializeArguments(\n      renamed as unknown as Record<string, unknown>,\n      rpcDriver,\n    )\n  }\n\n  async execute(args: Record<string, unknown>, rpcDriver: string) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { executeRenderLinearReadArcsDisplay } =\n      await import('./executeRenderLinearReadArcsDisplay.ts')\n    return executeRenderLinearReadArcsDisplay({\n      pluginManager: this.pluginManager,\n      args: deserializedArgs,\n    })\n  }\n}\n","import RenderLinearReadArcsDisplay from './RenderLinearReadArcsDisplay.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearReadArcsDisplayRPCMethodsF(pm: PluginManager) {\n  pm.addRpcMethod(() => new RenderLinearReadArcsDisplay(pm))\n}\n","import RpcMethodType from '@jbrowse/core/pluggableElementTypes/RpcMethodType'\nimport { renameRegionsIfNeeded } from '@jbrowse/core/util'\n\nimport configSchema from '../LinearReadCloudDisplay/configSchema.ts'\n\nimport type { ColorBy, ModificationTypeWithColor } from '../shared/types.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { ThemeOptions } from '@mui/material'\n\nexport interface RenderLinearReadCloudDisplayArgs {\n  sessionId: string\n  view: Base1DViewModel\n  adapterConfig: AnyConfigurationModel\n  sequenceAdapter?: Record<string, unknown>\n  config: AnyConfigurationModel\n  theme: ThemeOptions\n  filterBy: Record<string, unknown>\n  featureHeight: number\n  noSpacing: boolean\n  drawCloud: boolean\n  colorBy: ColorBy\n  drawSingletons: boolean\n  drawProperPairs: boolean\n  flipStrandLongReadChains: boolean\n  trackMaxHeight?: number\n  cloudModeHeight?: number\n  cloudDomain?: [number, number]\n  highResolutionScaling?: number\n  exportSVG?: { rasterizeLayers?: boolean; scale?: number }\n  statusCallback?: (status: string) => void\n  stopToken?: string\n  visibleModifications?: Record<string, ModificationTypeWithColor>\n  hideSmallIndels?: boolean\n  hideMismatches?: boolean\n  hideLargeIndels?: boolean\n  showOutline?: boolean\n}\n\nexport default class RenderLinearReadCloudDisplay extends RpcMethodType {\n  name = 'RenderLinearReadCloudDisplay'\n\n  async renameRegionsIfNeeded(\n    args: RenderLinearReadCloudDisplayArgs,\n  ): Promise<RenderLinearReadCloudDisplayArgs> {\n    const assemblyManager =\n      this.pluginManager.rootModel?.session?.assemblyManager\n    if (!assemblyManager) {\n      throw new Error('no assembly manager')\n    }\n\n    const { view, sessionId, adapterConfig } = args\n    const { displayedRegions } = view\n\n    if (!displayedRegions.length) {\n      return args\n    }\n\n    const result = await renameRegionsIfNeeded(assemblyManager, {\n      sessionId,\n      adapterConfig,\n      regions: displayedRegions,\n    })\n\n    return {\n      ...args,\n      view: {\n        ...view,\n        displayedRegions: result.regions,\n      } as typeof view,\n    }\n  }\n\n  deserializeArguments(args: any, _rpcDriver: string) {\n    return {\n      ...args,\n      config: configSchema(this.pluginManager).create(args.config, {\n        pluginManager: this.pluginManager,\n      }),\n    }\n  }\n\n  async serializeArguments(args: Record<string, unknown>, rpcDriver: string) {\n    const renamed = await this.renameRegionsIfNeeded(\n      args as unknown as RenderLinearReadCloudDisplayArgs,\n    )\n    return super.serializeArguments(\n      renamed as unknown as Record<string, unknown>,\n      rpcDriver,\n    )\n  }\n\n  async execute(args: Record<string, unknown>, rpcDriver: string) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { executeRenderLinearReadCloudDisplay } =\n      await import('./executeRenderLinearReadCloudDisplay.ts')\n    return executeRenderLinearReadCloudDisplay({\n      pluginManager: this.pluginManager,\n      args: deserializedArgs,\n    })\n  }\n}\n","import RenderLinearReadCloudDisplay from './RenderLinearReadCloudDisplay.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearReadCloudDisplayRPCMethodsF(pm: PluginManager) {\n  pm.addRpcMethod(() => new RenderLinearReadCloudDisplay(pm))\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config SNPCoverageAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'SNPCoverageAdapter',\n  {\n    /**\n     * #slot\n     * normally refers to a BAM or CRAM adapter\n     */\n    subadapter: {\n      type: 'frozen',\n      defaultValue: null,\n    },\n    /**\n     * #slot\n     * sequence adapter for fetching reference sequences (needed by CRAM)\n     */\n    sequenceAdapter: {\n      type: 'frozen',\n      defaultValue: null,\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default configSchema\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function SNPCoverageAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'SNPCoverageAdapter',\n      displayName: 'SNPCoverage adapter',\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n      getAdapterClass: () =>\n        import('./SNPCoverageAdapter.ts').then(r => r.default),\n      configSchema,\n    })\n  })\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport FeatureRendererType, {\n  type RenderArgs,\n  type ResultsDeserialized,\n  type ResultsSerialized,\n} from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport SimpleFeature from '@jbrowse/core/util/simpleFeature'\nimport { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport type { RenderArgsDeserialized } from './types.ts'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { Feature, SimpleFeatureSerialized } from '@jbrowse/core/util'\n\ninterface SNPCoverageResultsSerialized extends ResultsSerialized {\n  skipFeatures?: SimpleFeatureSerialized[]\n}\n\nexport interface SNPCoverageResultsDeserialized extends ResultsDeserialized {\n  skipFeatures: Feature[]\n}\n\nexport default class SNPCoverageRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  deserializeResultsInClient(\n    result: SNPCoverageResultsSerialized,\n    args: RenderArgs,\n  ): SNPCoverageResultsDeserialized {\n    const deserialized = super.deserializeResultsInClient(result, args)\n    const skipFeatures = (result.skipFeatures ?? []).map(f =>\n      SimpleFeature.fromJSON(f),\n    )\n    // Add skip features to the features map so they get stored in the block\n    // and can be accessed by the display for cross-region arc rendering\n    for (const skipFeature of skipFeatures) {\n      deserialized.features.set(skipFeature.id(), skipFeature)\n    }\n    return {\n      ...deserialized,\n      skipFeatures,\n    }\n  }\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { sessionId, adapterConfig, regions } = renderProps\n    const pm = this.pluginManager\n    const { dataAdapter } = await getAdapter(pm, sessionId, adapterConfig)\n    const region = regions[0]!\n\n    const feats = await firstValueFrom(\n      (dataAdapter as BaseFeatureDataAdapter)\n        .getFeatures(region, renderProps)\n        .pipe(toArray()),\n    )\n    const features = new Map(feats.map(f => [f.id(), f] as const))\n\n    const { renderSNPCoverageToCanvas } = await import('./makeImage.ts')\n    return renderSNPCoverageToCanvas({ ...renderProps, features })\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config SNPCoverageRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst SNPCoverageRenderer = ConfigurationSchema(\n  'SNPCoverageRenderer',\n  {\n    /**\n     * #slot\n     */\n    clipColor: {\n      type: 'color',\n      description: 'the color of the clipping marker',\n      defaultValue: 'red',\n    },\n    /**\n     * #slot\n     */\n    indicatorThreshold: {\n      type: 'number',\n      description:\n        'the proportion of reads containing a insertion/clip indicator',\n      defaultValue: 0.4,\n    },\n    /**\n     * #slot\n     */\n    showArcs: {\n      type: 'boolean',\n      description: 'Draw sashimi-style arcs for intron features',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    showInterbaseCounts: {\n      type: 'boolean',\n      description:\n        'draw count \"upsidedown histogram\" of the interbase events that don\\'t contribute to the coverage count so are not drawn in the normal histogram',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    showInterbaseIndicators: {\n      type: 'boolean',\n      description:\n        'draw a triangular indicator where an event has been detected',\n      defaultValue: true,\n    },\n\n    color: {\n      type: 'color',\n      description: 'Background color for the SNPCoverage renderer',\n      defaultValue: '#d3d3d3',\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default SNPCoverageRenderer\n","import { lazy } from 'react'\n\nimport SNPCoverageRenderer from './SNPCoverageRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function register(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new SNPCoverageRenderer({\n        name: 'SNPCoverageRenderer',\n        ReactComponent: lazy(\n          () => import('./components/SNPCoverageRendering.tsx'),\n        ),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport AlignmentsFeatureWidgetF from './AlignmentsFeatureDetail/index.ts'\nimport AlignmentsTrackF from './AlignmentsTrack/index.ts'\nimport CramAdapterF from './BamAdapter/index.ts'\nimport BamAdapterF from './CramAdapter/index.ts'\nimport GuessAlignmentsTypesF from './GuessAlignmentsTypes/index.ts'\nimport HtsgetBamAdapterF from './HtsgetBamAdapter/index.ts'\nimport LinearAlignmentsDisplayF from './LinearAlignmentsDisplay/index.ts'\nimport LinearPileupDisplayF from './LinearPileupDisplay/index.ts'\nimport LinearReadArcsDisplayF from './LinearReadArcsDisplay/index.ts'\nimport LinearReadCloudDisplayF from './LinearReadCloudDisplay/index.ts'\nimport LinearSNPCoverageDisplayF from './LinearSNPCoverageDisplay/index.ts'\nimport PileupRPCMethodsF from './PileupRPC/index.ts'\nimport PileupRendererF from './PileupRenderer/index.ts'\nimport LinearReadArcsDisplayRPCMethodsF from './RenderLinearReadArcsDisplayRPC/index.ts'\nimport LinearReadCloudDisplayRPCMethodsF from './RenderLinearReadCloudDisplayRPC/index.ts'\nimport SNPCoverageAdapterF from './SNPCoverageAdapter/index.ts'\nimport SNPCoverageRendererF from './SNPCoverageRenderer/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class AlignmentsPlugin extends Plugin {\n  name = 'AlignmentsPlugin'\n\n  install(pluginManager: PluginManager) {\n    ;[\n      CramAdapterF,\n      BamAdapterF,\n      LinearPileupDisplayF,\n      LinearSNPCoverageDisplayF,\n      AlignmentsTrackF,\n      SNPCoverageAdapterF,\n      HtsgetBamAdapterF,\n      PileupRendererF,\n      PileupRPCMethodsF,\n      LinearReadArcsDisplayRPCMethodsF,\n      LinearReadCloudDisplayRPCMethodsF,\n      SNPCoverageRendererF,\n      LinearReadArcsDisplayF,\n      LinearReadCloudDisplayF,\n      LinearAlignmentsDisplayF,\n      AlignmentsFeatureWidgetF,\n      GuessAlignmentsTypesF,\n    ].map(f => {\n      f(pluginManager)\n    })\n  }\n}\n\nexport {\n  SharedLinearPileupDisplayMixin,\n  linearPileupDisplayConfigSchemaFactory,\n  linearPileupDisplayStateModelFactory,\n} from './LinearPileupDisplay/index.ts'\nexport { type LinearPileupDisplayModel } from './LinearPileupDisplay/model.ts'\nexport * as MismatchParser from './MismatchParser/index.ts'\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nexport default class ArcRenderer extends FeatureRendererType {}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config ArcRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst ArcRenderer = ConfigurationSchema(\n  'ArcRenderer',\n  {\n    /**\n     * #slot\n     */\n    color: {\n      type: 'color',\n      description: 'the color of the arcs',\n      defaultValue: 'darkblue',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    thickness: {\n      type: 'number',\n      description: 'the thickness of the arcs',\n      defaultValue: `jexl:logThickness(feature,'score')`,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    label: {\n      type: 'string',\n      description: 'the label to appear at the apex of the arcs',\n      defaultValue: `jexl:get(feature,'score')`,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    height: {\n      type: 'number',\n      description: 'the height of the arcs',\n      defaultValue: `jexl:log10(get(feature,'end')-get(feature,'start'))*50`,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    caption: {\n      type: 'string',\n      description:\n        'the caption to appear when hovering over any point on the arcs',\n      defaultValue: `jexl:get(feature,'name')`,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    displayMode: {\n      type: 'enum',\n      defaultValue: 'arcs',\n      model: types.enumeration('DisplayMode', ['arcs', 'semicircles']),\n      description: 'render semi-circles instead of arcs',\n    },\n  },\n  { explicitlyTyped: true },\n)\nexport default ArcRenderer\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { BaseLinearDisplay } from '@jbrowse/plugin-linear-genome-view'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearArcDisplay\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearArcDisplay',\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearArcDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        displayMode: types.maybe(types.string),\n      }),\n    )\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get blockType() {\n        return 'staticBlocks'\n      },\n      /**\n       * #getter\n       */\n      get renderDelay() {\n        return 500\n      },\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return self.configuration.renderer.type\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get displayModeSetting() {\n        return self.displayMode ?? getConf(self, ['renderer', 'displayMode'])\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rendererConfig() {\n        const configBlob = getConf(self, ['renderer']) || {}\n        const config = configBlob as Omit<typeof configBlob, symbol>\n        return {\n          ...config,\n          displayMode: self.displayModeSetting,\n        }\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            config: self.rendererConfig,\n            height: self.height,\n          }\n        },\n      }\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setDisplayMode(flag: string) {\n        self.displayMode = flag\n      },\n    }))\n    .views(self => {\n      const superMenuItems = self.trackMenuItems\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superMenuItems(),\n            {\n              label: 'Display mode',\n              subMenu: [\n                {\n                  type: 'radio',\n                  label: 'Arcs',\n                  onClick: () => {\n                    self.setDisplayMode('arcs')\n                  },\n                  checked: self.displayMode === 'arcs',\n                },\n                {\n                  type: 'radio',\n                  label: 'Semi-circles',\n                  onClick: () => {\n                    self.setDisplayMode('semicircles')\n                  },\n                  checked: self.displayMode === 'semicircles',\n                },\n              ],\n            },\n          ]\n        },\n      }\n    })\n}\n","import type React from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isSelectionContainer,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport {\n  FeatureDensityMixin,\n  TrackHeightMixin,\n} from '@jbrowse/plugin-linear-genome-view'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel LinearPairedArcDisplay\n * this is a non-block-based track type, and can connect arcs across multiple\n * displayedRegions\n *\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [TrackHeightMixin](../trackheightmixin)\n * - [FeatureDensityMixin](../featuredensitymixin)\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearPairedArcDisplay',\n      BaseDisplay,\n      TrackHeightMixin(),\n      FeatureDensityMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearPairedArcDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        displayMode: types.maybe(types.string),\n      }),\n    )\n    .volatile(() => ({\n      lastDrawnOffsetPx: 0,\n      features: undefined as Feature[] | undefined,\n      loading: false,\n      drawn: true,\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get displayModeSetting() {\n        return self.displayMode ?? getConf(self, ['renderer', 'displayMode'])\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      selectFeature(feature: Feature) {\n        const session = getSession(self)\n        if (isSessionModelWithWidgets(session)) {\n          const featureWidget = session.addWidget(\n            'VariantFeatureWidget',\n            'variantFeature',\n            {\n              view: getContainingView(self),\n              track: getContainingTrack(self),\n              featureData: feature.toJSON(),\n            },\n          )\n\n          session.showWidget(featureWidget)\n        }\n        if (isSelectionContainer(session)) {\n          session.setSelection(feature)\n        }\n      },\n      /**\n       * #action\n       */\n      setLoading(flag: boolean) {\n        self.loading = flag\n      },\n      /**\n       * #action\n       */\n      setFeatures(f: Feature[]) {\n        self.features = f\n      },\n      /**\n       * #action\n       */\n      setDisplayMode(flag: string) {\n        self.displayMode = flag\n      },\n    }))\n\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttach } = await import('./afterAttach.tsx')\n            doAfterAttach(self)\n          } catch (e) {\n            console.error(e)\n            self.setError(e)\n          }\n        })()\n      },\n      /**\n       * #action\n       */\n      async renderSvg(opts: {\n        rasterizeLayers?: boolean\n      }): Promise<React.ReactNode> {\n        const { renderArcSvg } = await import('./renderSvg.tsx')\n        // @ts-expect-error\n        return renderArcSvg(self, opts)\n      },\n    }))\n}\n\nexport type LinearArcDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type LinearArcDisplayModel = Instance<LinearArcDisplayStateModel>\n","import Plugin from '@jbrowse/core/Plugin'\nimport { set1 } from '@jbrowse/core/ui/colors'\n\nimport ArcRendererF from './ArcRenderer/index.ts'\nimport LinearArcDisplayF from './LinearArcDisplay/index.ts'\nimport LinearPairedArcDisplayF from './LinearPairedArcDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport default class ArcPlugin extends Plugin {\n  name = 'ArcRenderer'\n  install(pluginManager: PluginManager) {\n    ArcRendererF(pluginManager)\n    LinearArcDisplayF(pluginManager)\n    LinearPairedArcDisplayF(pluginManager)\n\n    pluginManager.jexl.addFunction(\n      'logThickness',\n      (feature: Feature, attributeName: string) =>\n        Math.log(feature.get(attributeName) + 1),\n    )\n    pluginManager.jexl.addFunction(\n      'defaultPairedArcColor',\n      (_feature: Feature, alt?: string) => {\n        if (alt?.startsWith('<DEL')) {\n          return set1[0]\n        } else if (alt?.startsWith('<DUP')) {\n          return set1[1]\n        } else if (alt?.startsWith('<INV')) {\n          return set1[2]\n        } else if (alt?.startsWith('<TRA')) {\n          return set1[3]\n        } else if (alt?.startsWith('<CNV')) {\n          return set1[4]\n        } else {\n          return set1[6] // skip 5, yellow\n        }\n      },\n    )\n  }\n}\n","import { lazy } from 'react'\n\nimport ArcRenderer from './ArcRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function ArcRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new ArcRenderer({\n        name: 'ArcRenderer',\n        ReactComponent: lazy(() => import('./ArcRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { DisplayType } from '@jbrowse/core/pluggableElementTypes'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\n\nimport { configSchemaFactory } from './configSchema.ts'\nimport { stateModelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearArcDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearArcDisplay',\n      displayName: 'Arc display',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'FeatureTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearArcDisplay\n */\nexport function configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearArcDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: types.optional(\n        pluginManager.pluggableConfigSchemaType('renderer'),\n        { type: 'ArcRenderer' },\n      ),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport { DisplayType } from '@jbrowse/core/pluggableElementTypes'\n\nimport { configSchemaFactory } from './configSchema.ts'\nimport { stateModelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearPairedArcDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory()\n    return new DisplayType({\n      name: 'LinearPairedArcDisplay',\n      displayName: 'Variant display arcs',\n      helpText:\n        'Can display arcs connecting SVs and breakends in VCF format or BEDPE pairs',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'VariantTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(() => import('./components/ReactComponent.tsx')),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #config LinearPairedArcDisplay\n */\nexport function configSchemaFactory() {\n  return ConfigurationSchema(\n    'LinearPairedArcDisplay',\n    {\n      /**\n       * #slot\n       */\n      color: {\n        type: 'color',\n        description: 'the color of the arcs',\n        defaultValue: 'jexl:defaultPairedArcColor(feature,alt)',\n        contextVariable: ['feature', 'alt'],\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { BaseInternetAccountConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config OAuthInternetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst OAuthConfigSchema = ConfigurationSchema(\n  'OAuthInternetAccount',\n  {\n    /**\n     * #slot\n     */\n    tokenType: {\n      description: 'a custom name for a token to include in the header',\n      type: 'string',\n      defaultValue: 'Bearer',\n    },\n    /**\n     * #slot\n     */\n    authEndpoint: {\n      description: 'the authorization code endpoint of the internet account',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    tokenEndpoint: {\n      description: 'the token endpoint of the internet account',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    needsPKCE: {\n      description: 'boolean to indicate if the endpoint needs a PKCE code',\n      type: 'boolean',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    clientId: {\n      description: 'id for the OAuth application',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    scopes: {\n      description: 'optional scopes for the authorization call',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    state: {\n      description: 'optional state for the authorization call',\n      type: 'string',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    responseType: {\n      description:\n        \"the type of response from the authorization endpoint. can be 'token' or 'code'\",\n      type: 'string',\n      defaultValue: 'code',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: BaseInternetAccountConfig,\n    explicitlyTyped: true,\n  },\n)\n\nexport type OAuthInternetAccountConfigModel = typeof OAuthConfigSchema\nexport type OAuthInternetAccountConfig =\n  Instance<OAuthInternetAccountConfigModel>\nexport default OAuthConfigSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport OAuthConfigSchema from '../OAuthModel/configSchema.ts'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config DropboxOAuthInternetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst DropboxOAuthConfigSchema = ConfigurationSchema(\n  'DropboxOAuthInternetAccount',\n  {\n    /**\n     * #slot\n     */\n    authEndpoint: {\n      description: 'the authorization code endpoint of the internet account',\n      type: 'string',\n      defaultValue: 'https://www.dropbox.com/oauth2/authorize',\n    },\n    /**\n     * #slot\n     */\n    tokenEndpoint: {\n      description: 'the token endpoint of the internet account',\n      type: 'string',\n      defaultValue: 'https://api.dropbox.com/oauth2/token',\n    },\n    /**\n     * #slot\n     */\n    needsPKCE: {\n      description: 'boolean to indicate if the endpoint needs a PKCE code',\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    domains: {\n      description:\n        'array of valid domains the url can contain to use this account',\n      type: 'stringArray',\n      defaultValue: [\n        'addtodropbox.com',\n        'db.tt',\n        'dropbox.com',\n        'dropboxapi.com',\n        'dropboxbusiness.com',\n        'dropbox.tech',\n        'getdropbox.com',\n      ],\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: OAuthConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport type DropboxOAuthInternetAccountConfigModel =\n  typeof DropboxOAuthConfigSchema\n\nexport type DropboxOAuthInternetAccountConfig =\n  Instance<DropboxOAuthInternetAccountConfigModel>\nexport default DropboxOAuthConfigSchema\n","import { SvgIcon } from '@mui/material'\n\nimport type { SvgIconProps } from '@mui/material'\n\nexport default function DropboxIcon(props: SvgIconProps) {\n  return (\n    <SvgIcon {...props}>\n      <path d=\"M3 6.2L8 9.39L13 6.2L8 3L3 6.2M13 6.2L18 9.39L23 6.2L18 3L13 6.2M3 12.55L8 15.74L13 12.55L8 9.35L3 12.55M18 9.35L13 12.55L18 15.74L23 12.55L18 9.35M8.03 16.8L13.04 20L18.04 16.8L13.04 13.61L8.03 16.8Z\" />\n    </SvgIcon>\n  )\n}\n","export async function getResponseError({\n  response,\n  reason,\n  statusText,\n}: {\n  response: Response\n  reason?: string\n  statusText?: string\n}) {\n  return [\n    `HTTP ${response.status}`,\n    reason,\n    statusText ?? (await getError(response)),\n  ]\n    .filter(f => !!f)\n    .join(' - ')\n}\n\nexport async function getError(response: Response) {\n  try {\n    return await response.text()\n  } catch (e) {\n    return response.statusText\n  }\n}\n","import { getResponseError } from '../util.ts'\n\ninterface DropboxError {\n  error_summary: string\n  error: {\n    '.tag': string\n  }\n}\n\n/**\n * Error messages from\n * https://www.dropbox.com/developers/documentation/http/documentation#sharing-get_shared_link_file\n * */\nconst dropboxErrorMessages: Record<string, string> = {\n  shared_link_not_found: \"The shared link wasn't found.\",\n  shared_link_access_denied:\n    'The caller is not allowed to access this shared link.',\n  unsupported_link_type:\n    'This type of link is not supported; use files/export instead.',\n  shared_link_is_directory: 'Directories cannot be retrieved by this endpoint.',\n}\n\nexport async function getDescriptiveErrorMessage(\n  response: Response,\n  reason?: string,\n) {\n  let errorMessage = ''\n  try {\n    const err = JSON.parse(await response.text()) as DropboxError\n    const tag = err.error['.tag']\n    errorMessage = dropboxErrorMessages[tag] || tag\n  } catch (error) {\n    /* do nothing */\n  }\n  return getResponseError({ response, reason, statusText: errorMessage })\n}\n","export function fixup(buf: string) {\n  return buf.replaceAll('+', '-').replaceAll('/', '_').replaceAll('=', '')\n}\n\nexport async function generateChallenge(val: string) {\n  const sha256 = await import('crypto-js/sha256').then(f => f.default)\n  const Base64 = await import('crypto-js/enc-base64')\n  return fixup(Base64.stringify(sha256(val)))\n}\n\n// if response is JSON, checks if it needs to remove tokens in error, or just plain throw\nexport function processError(text: string, invalidErrorCb: () => void) {\n  try {\n    const obj = JSON.parse(text)\n    if (obj.error === 'invalid_grant') {\n      invalidErrorCb()\n    }\n    return obj?.error_description ?? text\n  } catch (e) {\n    /* response text is not json, just use original text as error */\n  }\n  return text\n}\n\nexport function processTokenResponse(\n  data: { refresh_token?: string; access_token: string },\n  storeRefreshTokenCb: (str: string) => void,\n) {\n  if (data.refresh_token) {\n    storeRefreshTokenCb(data.refresh_token)\n  }\n  return data.access_token\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { InternetAccount } from '@jbrowse/core/pluggableElementTypes/models'\nimport { isElectron } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport {\n  fixup,\n  generateChallenge,\n  processError,\n  processTokenResponse,\n} from './util.ts'\nimport { getResponseError } from '../util.ts'\n\nimport type { OAuthInternetAccountConfigModel } from './configSchema.ts'\nimport type { UriLocation } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n// ISC Copyright (c) 2020, Andrea Giammarchi, @WebReflection\n// https://github.com/WebReflection/uint8-to-base64\nfunction encode(uint8array: Uint8Array) {\n  const output = []\n\n  for (let i = 0, length = uint8array.length; i < length; i++) {\n    output.push(String.fromCharCode(uint8array[i]!))\n  }\n\n  return btoa(output.join(''))\n}\n\ninterface OAuthData {\n  client_id: string\n  redirect_uri: string\n  response_type: 'token' | 'code'\n  scope?: string\n  code_challenge?: string\n  code_challenge_method?: string\n  token_access_type?: string\n  state?: string\n}\n\n/**\n * #stateModel OAuthInternetAccount\n */\nconst stateModelFactory = (configSchema: OAuthInternetAccountConfigModel) => {\n  return InternetAccount.named('OAuthInternetAccount')\n    .props({\n      /**\n       * #property\n       */\n      type: types.literal('OAuthInternetAccount'),\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(configSchema),\n    })\n    .views(() => {\n      let codeVerifier: string | undefined = undefined\n      return {\n        /**\n         * #getter\n         */\n        get codeVerifierPKCE() {\n          if (!codeVerifier) {\n            const array = new Uint8Array(32)\n            globalThis.crypto.getRandomValues(array)\n            codeVerifier = fixup(encode(array))\n          }\n          return codeVerifier\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get authEndpoint(): string {\n        return getConf(self, 'authEndpoint')\n      },\n      /**\n       * #getter\n       */\n      get tokenEndpoint(): string {\n        return getConf(self, 'tokenEndpoint')\n      },\n      /**\n       * #getter\n       */\n      get needsPKCE(): boolean {\n        return getConf(self, 'needsPKCE')\n      },\n      /**\n       * #getter\n       */\n      get clientId(): string {\n        return getConf(self, 'clientId')\n      },\n      /**\n       * #getter\n       */\n      get scopes(): string {\n        return getConf(self, 'scopes')\n      },\n      /**\n       * #method\n       * OAuth state parameter:\n       * https://www.rfc-editor.org/rfc/rfc6749#section-4.1.1\n       *\n       * Can override or extend if dynamic state is needed.\n       */\n      state(): string | undefined {\n        return getConf(self, 'state')\n      },\n      /**\n       * #getter\n       */\n      get responseType(): 'token' | 'code' {\n        return getConf(self, 'responseType')\n      },\n      /**\n       * #getter\n       */\n      get refreshTokenKey() {\n        return `${self.internetAccountId}-refreshToken`\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      storeRefreshToken(refreshToken: string) {\n        localStorage.setItem(self.refreshTokenKey, refreshToken)\n      },\n      /**\n       * #action\n       */\n      removeRefreshToken() {\n        localStorage.removeItem(self.refreshTokenKey)\n      },\n      /**\n       * #method\n       */\n      retrieveRefreshToken() {\n        return localStorage.getItem(self.refreshTokenKey)\n      },\n      /**\n       * #action\n       */\n      async exchangeAuthorizationForAccessToken(\n        token: string,\n        redirectUri: string,\n      ) {\n        const params = new URLSearchParams(\n          Object.entries({\n            code: token,\n            grant_type: 'authorization_code',\n            client_id: self.clientId,\n            redirect_uri: redirectUri,\n            ...(self.needsPKCE ? { code_verifier: self.codeVerifierPKCE } : {}),\n          }),\n        )\n\n        const response = await fetch(self.tokenEndpoint, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n          body: params.toString(),\n        })\n\n        if (!response.ok) {\n          throw new Error(\n            await getResponseError({\n              response,\n              reason: 'Failed to obtain token',\n            }),\n          )\n        }\n\n        const data = await response.json()\n        return processTokenResponse(data, token => {\n          this.storeRefreshToken(token)\n        })\n      },\n      /**\n       * #action\n       */\n      async exchangeRefreshForAccessToken(refreshToken: string) {\n        const response = await fetch(self.tokenEndpoint, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },\n          body: new URLSearchParams(\n            Object.entries({\n              grant_type: 'refresh_token',\n              refresh_token: refreshToken,\n              client_id: self.clientId,\n            }),\n          ).toString(),\n        })\n\n        if (!response.ok) {\n          self.removeToken()\n          const text = await response.text()\n          throw new Error(\n            await getResponseError({\n              response,\n              statusText: processError(text, () => {\n                this.removeRefreshToken()\n              }),\n            }),\n          )\n        }\n        const data = await response.json()\n        return processTokenResponse(data, token => {\n          this.storeRefreshToken(token)\n        })\n      },\n    }))\n    .actions(self => {\n      let listener: (event: MessageEvent) => undefined\n      let exchangedTokenPromise: Promise<string> | undefined = undefined\n      return {\n        /**\n         * #action\n         * used to listen to child window for auth code/token\n         */\n        addMessageChannel(\n          resolve: (token: string) => void,\n          reject: (error: Error) => void,\n        ) {\n          listener = event => {\n            // this should probably get better handling, but ignored for now\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.finishOAuthWindow(event, resolve, reject)\n          }\n          window.addEventListener('message', listener)\n        },\n        /**\n         * #action\n         */\n        deleteMessageChannel() {\n          window.removeEventListener('message', listener)\n        },\n        /**\n         * #action\n         */\n        async finishOAuthWindow(\n          event: MessageEvent,\n          resolve: (token: string) => void,\n          reject: (error: Error) => void,\n        ) {\n          if (\n            event.data.name !== `JBrowseAuthWindow-${self.internetAccountId}`\n          ) {\n            this.deleteMessageChannel()\n            return\n          }\n          const redirectUriWithInfo = event.data.redirectUri\n          const fixedQueryString = redirectUriWithInfo.replace('#', '?')\n          const redirectUrl = new URL(fixedQueryString)\n          const queryStringSearch = redirectUrl.search\n          const urlParams = new URLSearchParams(queryStringSearch)\n          if (urlParams.has('access_token')) {\n            const token = urlParams.get('access_token')\n            if (!token) {\n              reject(new Error('Error with token endpoint'))\n              return\n            }\n            self.storeToken(token)\n            resolve(token)\n            return\n          }\n          if (urlParams.has('code')) {\n            const code = urlParams.get('code')\n            if (!code) {\n              reject(new Error('Error with authorization endpoint'))\n              return\n            }\n            try {\n              const token = await self.exchangeAuthorizationForAccessToken(\n                code,\n                redirectUrl.origin + redirectUrl.pathname,\n              )\n              self.storeToken(token)\n              resolve(token)\n              return\n            } catch (e) {\n              if (e instanceof Error) {\n                reject(e)\n              } else {\n                reject(new Error(String(e)))\n              }\n              return\n            }\n          }\n          if (redirectUriWithInfo.includes('access_denied')) {\n            reject(new Error('OAuth flow was cancelled'))\n            return\n          }\n          if (redirectUriWithInfo.includes('error')) {\n            reject(new Error(`OAuth flow error: ${queryStringSearch}`))\n            return\n          }\n          this.deleteMessageChannel()\n        },\n        /**\n         * #action\n         * opens external OAuth flow, popup for web and new browser window for\n         * desktop\n         */\n        async useEndpointForAuthorization(\n          resolve: (token: string) => void,\n          reject: (error: Error) => void,\n        ) {\n          const redirectUri = isElectron\n            ? 'http://localhost/auth'\n            : window.location.origin + window.location.pathname\n          const data: OAuthData = {\n            client_id: self.clientId,\n            redirect_uri: redirectUri,\n            response_type: self.responseType,\n            token_access_type: 'offline',\n          }\n\n          if (self.state()) {\n            data.state = self.state()\n          }\n\n          if (self.scopes) {\n            data.scope = self.scopes\n          }\n\n          if (self.needsPKCE) {\n            data.code_challenge = await generateChallenge(self.codeVerifierPKCE)\n            data.code_challenge_method = 'S256'\n          }\n\n          const params = new URLSearchParams(Object.entries(data))\n\n          const url = new URL(self.authEndpoint)\n          url.search = params.toString()\n\n          const eventName = `JBrowseAuthWindow-${self.internetAccountId}`\n          if (isElectron) {\n            const { ipcRenderer } = window.require('electron')\n            const redirectUri = await ipcRenderer.invoke('openAuthWindow', {\n              internetAccountId: self.internetAccountId,\n              data,\n              url: url.toString(),\n            })\n\n            const eventFromDesktop = new MessageEvent('message', {\n              data: { name: eventName, redirectUri: redirectUri },\n            })\n            // may want to improve handling\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.finishOAuthWindow(eventFromDesktop, resolve, reject)\n          } else {\n            window.open(url, eventName, 'width=500,height=600,left=0,top=0')\n          }\n        },\n        /**\n         * #action\n         */\n        async getTokenFromUser(\n          resolve: (token: string) => void,\n          reject: (error: Error) => void,\n        ) {\n          const refreshToken = self.retrieveRefreshToken()\n          let doUserFlow = true\n\n          // if there is a refresh token, then try it out, and only if that\n          // refresh token succeeds, set doUserFlow to false\n          if (refreshToken) {\n            try {\n              const token =\n                await self.exchangeRefreshForAccessToken(refreshToken)\n              resolve(token)\n              doUserFlow = false\n            } catch (e) {\n              console.error(e)\n              self.removeRefreshToken()\n            }\n          }\n          if (doUserFlow) {\n            this.addMessageChannel(resolve, reject)\n            // may want to improve handling\n            // eslint-disable-next-line @typescript-eslint/no-floating-promises\n            this.useEndpointForAuthorization(resolve, reject)\n          }\n        },\n        /**\n         * #action\n         */\n        async validateToken(token: string, location: UriLocation) {\n          const newInit = self.addAuthHeaderToInit({ method: 'HEAD' }, token)\n          const response = await fetch(location.uri, newInit)\n          if (!response.ok) {\n            self.removeToken()\n            const refreshToken = self.retrieveRefreshToken()\n            if (refreshToken) {\n              try {\n                if (!exchangedTokenPromise) {\n                  exchangedTokenPromise =\n                    self.exchangeRefreshForAccessToken(refreshToken)\n                }\n                const newToken = await exchangedTokenPromise\n                exchangedTokenPromise = undefined\n                return newToken\n              } catch (err) {\n                console.error('Token could not be refreshed', err)\n                // let original error be thrown\n              }\n            }\n\n            throw new Error(\n              await getResponseError({\n                response,\n                reason: 'Error validating token',\n              }),\n            )\n          }\n          return token\n        },\n      }\n    })\n    .actions(self => {\n      const superGetFetcher = self.getFetcher\n      return {\n        /**\n         * #action\n         * Get a fetch method that will add any needed authentication headers\n         * to the request before sending it. If location is provided, it will\n         * be checked to see if it includes a token in it's pre-auth\n         * information.\n         *\n         * @param loc - UriLocation of the resource\n         * @returns A function that can be used to fetch\n         */\n        getFetcher(loc?: UriLocation) {\n          const fetcher = superGetFetcher(loc)\n          return async (input: RequestInfo, init?: RequestInit) => {\n            if (loc) {\n              await self.validateToken(await self.getToken(loc), loc)\n            }\n            return fetcher(input, init)\n          }\n        },\n      }\n    })\n}\n\nexport default stateModelFactory\nexport type OAuthStateModel = ReturnType<typeof stateModelFactory>\nexport type OAuthModel = Instance<OAuthStateModel>\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport DropboxIcon from './DropboxIcon.tsx'\nimport { getDescriptiveErrorMessage } from './util.ts'\nimport { configSchema as OAuthConfigSchema } from '../OAuthModel/index.ts'\nimport baseModel from '../OAuthModel/model.tsx'\n\nimport type { DropboxOAuthInternetAccountConfigModel } from './configSchema.ts'\nimport type { UriLocation } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel DropboxOAuthInternetAccount\n */\nconst stateModelFactory = (\n  configSchema: DropboxOAuthInternetAccountConfigModel,\n) => {\n  return baseModel(OAuthConfigSchema)\n    .named('DropboxOAuthInternetAccount')\n    .props({\n      /**\n       * #property\n       */\n      type: types.literal('DropboxOAuthInternetAccount'),\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(configSchema),\n    })\n    .views(() => ({\n      /**\n       * #getter\n       * The FileSelector icon for Dropbox\n       */\n      get toggleContents() {\n        return <DropboxIcon />\n      },\n      /**\n       * #getter\n       */\n      get selectorLabel() {\n        return 'Enter Dropbox share link'\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #method\n       */\n      getFetcher(location?: UriLocation) {\n        return async (input: RequestInfo, init?: RequestInit) => {\n          const authToken = await self.getToken(location)\n          const newInit = self.addAuthHeaderToInit(\n            { ...init, method: 'POST' },\n            authToken,\n          )\n          newInit.headers.append(\n            'Dropbox-API-Arg',\n            JSON.stringify({ url: input }),\n          )\n          const response = await fetch(\n            'https://content.dropboxapi.com/2/sharing/get_shared_link_file',\n            newInit,\n          )\n          if (!response.ok) {\n            throw new Error(await getDescriptiveErrorMessage(response))\n          }\n          return response\n        }\n      },\n      /**\n       * #action\n       */\n      async validateToken(\n        token: string,\n        location: UriLocation,\n      ): Promise<string> {\n        const response = await fetch(\n          'https://api.dropboxapi.com/2/sharing/get_shared_link_metadata',\n          {\n            method: 'POST',\n            headers: {\n              Authorization: `Bearer ${token}`,\n              'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n              url: location.uri,\n            }),\n          },\n        )\n        if (!response.ok) {\n          const refreshToken = self.retrieveRefreshToken()\n          if (refreshToken) {\n            self.removeRefreshToken()\n            const newToken =\n              await self.exchangeRefreshForAccessToken(refreshToken)\n            return this.validateToken(newToken, location)\n          }\n          throw new Error(\n            await getDescriptiveErrorMessage(\n              response,\n              'Token could not be validated',\n            ),\n          )\n        }\n        return token\n      },\n    }))\n}\n\nexport default stateModelFactory\nexport type DropboxOAuthStateModel = ReturnType<typeof stateModelFactory>\nexport type DropboxOAuthModel = Instance<DropboxOAuthStateModel>\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { BaseInternetAccountConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config ExternalTokenInternetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst ExternalTokenConfigSchema = ConfigurationSchema(\n  'ExternalTokenInternetAccount',\n  {\n    /**\n     * #slot\n     */\n    validateWithHEAD: {\n      description: 'validate the token with a HEAD request before using it',\n      type: 'boolean',\n      defaultValue: true,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: BaseInternetAccountConfig,\n    explicitlyTyped: true,\n  },\n)\n\nexport type ExternalTokenInternetAccountConfigModel =\n  typeof ExternalTokenConfigSchema\n\nexport type ExternalTokenInternetAccountConfig =\n  Instance<ExternalTokenInternetAccountConfigModel>\nexport default ExternalTokenConfigSchema\n","import { useState } from 'react'\n\nimport { Dialog } from '@jbrowse/core/ui'\nimport { Button, DialogActions, DialogContent, TextField } from '@mui/material'\n\nexport const ExternalTokenEntryForm = ({\n  internetAccountId,\n  handleClose,\n}: {\n  internetAccountId: string\n  handleClose: (token?: string) => void\n}) => {\n  const [token, setToken] = useState('')\n\n  return (\n    <Dialog\n      open\n      maxWidth=\"xl\"\n      data-testid=\"externalToken-form\"\n      onClose={() => {\n        handleClose()\n      }}\n      title={`Enter token for ${internetAccountId}`}\n    >\n      <DialogContent style={{ display: 'flex', flexDirection: 'column' }}>\n        <TextField\n          required\n          label=\"Enter Token\"\n          variant=\"outlined\"\n          onChange={event => {\n            setToken(event.target.value)\n          }}\n          margin=\"dense\"\n          slotProps={{\n            htmlInput: { 'data-testid': 'entry-externalToken' },\n          }}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          type=\"submit\"\n          disabled={!token}\n          onClick={() => {\n            if (token) {\n              handleClose(token)\n            }\n          }}\n        >\n          Add\n        </Button>\n        <Button\n          variant=\"contained\"\n          color=\"secondary\"\n          onClick={() => {\n            handleClose()\n          }}\n        >\n          Cancel\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { InternetAccount } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getRoot, types } from '@jbrowse/mobx-state-tree'\n\nimport { ExternalTokenEntryForm } from './ExternalTokenEntryForm.tsx'\n\nimport type { ExternalTokenInternetAccountConfigModel } from './configSchema.ts'\nimport type { UriLocation } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nconst stateModelFactory = (\n  configSchema: ExternalTokenInternetAccountConfigModel,\n) => {\n  return InternetAccount.named('ExternalTokenInternetAccount')\n    .props({\n      type: types.literal('ExternalTokenInternetAccount'),\n      configuration: ConfigurationReference(configSchema),\n    })\n    .views(self => ({\n      get validateWithHEAD(): boolean {\n        return getConf(self, 'validateWithHEAD')\n      },\n    }))\n    .actions(self => ({\n      getTokenFromUser(\n        resolve: (token: string) => void,\n        reject: (error: Error) => void,\n      ) {\n        const { session } = getRoot<any>(self)\n        session.queueDialog((doneCallback: () => void) => [\n          ExternalTokenEntryForm,\n          {\n            internetAccountId: self.internetAccountId,\n            handleClose: (token: string) => {\n              if (token) {\n                resolve(token)\n              } else {\n                reject(new Error('user cancelled entry'))\n              }\n              doneCallback()\n            },\n          },\n        ])\n      },\n      async validateToken(token: string, location: UriLocation) {\n        if (!self.validateWithHEAD) {\n          return token\n        }\n        const newInit = self.addAuthHeaderToInit({ method: 'HEAD' }, token)\n        const response = await fetch(location.uri, newInit)\n        if (!response.ok) {\n          let errorMessage: string\n          try {\n            errorMessage = await response.text()\n          } catch (error) {\n            errorMessage = ''\n          }\n          throw new Error(\n            `Token could not be validated  ${response.status} ${errorMessage ? ` (${errorMessage})` : ''}`,\n          )\n        }\n        return token\n      },\n    }))\n}\n\nexport default stateModelFactory\nexport type ExternalTokenStateModel = ReturnType<typeof stateModelFactory>\nexport type ExternalTokenModel = Instance<ExternalTokenStateModel>\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport OAuthConfigSchema from '../OAuthModel/configSchema.ts'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config GoogleDriveOAuthInternetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst GoogleDriveOAuthConfigSchema = ConfigurationSchema(\n  'GoogleDriveOAuthInternetAccount',\n  {\n    /**\n     * #slot\n     */\n    authEndpoint: {\n      description: 'the authorization code endpoint of the internet account',\n      type: 'string',\n      defaultValue: 'https://accounts.google.com/o/oauth2/v2/auth',\n    },\n    /**\n     * #slot\n     */\n    scopes: {\n      description: 'optional scopes for the authorization call',\n      type: 'string',\n      defaultValue: 'https://www.googleapis.com/auth/drive.readonly',\n    },\n    /**\n     * #slot\n     */\n    domains: {\n      description:\n        'array of valid domains the url can contain to use this account',\n      type: 'stringArray',\n      defaultValue: ['drive.google.com\"'],\n    },\n    /**\n     * #slot\n     */\n    responseType: {\n      description: 'the type of response from the authorization endpoint',\n      type: 'string',\n      defaultValue: 'token',\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: OAuthConfigSchema,\n    explicitlyTyped: true,\n  },\n)\n\nexport type GoogleDriveOAuthInternetAccountConfigModel =\n  typeof GoogleDriveOAuthConfigSchema\n\nexport type GoogleDriveOAuthInternetAccountConfig =\n  Instance<GoogleDriveOAuthInternetAccountConfigModel>\nexport default GoogleDriveOAuthConfigSchema\n","import { RemoteFileWithRangeCache } from '@jbrowse/core/util/io'\n\nimport type { FilehandleOptions, Stats } from 'generic-filehandle2'\n\nexport interface RequestInitWithMetadata extends RequestInit {\n  metadataOnly?: boolean\n}\n\ninterface GoogleDriveFilehandleOptions extends FilehandleOptions {\n  fetch(input: RequestInfo, opts?: RequestInitWithMetadata): Promise<Response>\n}\n\nexport class GoogleDriveFile extends RemoteFileWithRangeCache {\n  private statsPromise: Promise<{ size: number }>\n  constructor(source: string, opts: GoogleDriveFilehandleOptions) {\n    super(source, opts)\n    this.statsPromise = this.fetch(source, {\n      metadataOnly: true,\n    }).then(response => response.json())\n  }\n\n  async fetch(\n    input: RequestInfo,\n    opts?: RequestInitWithMetadata,\n  ): Promise<Response> {\n    return super.fetch(input, opts)\n  }\n\n  async stat(): Promise<Stats> {\n    return this.statsPromise\n  }\n}\n","import { SvgIcon } from '@mui/material'\n\nimport type { SvgIconProps } from '@mui/material'\n\nexport default function GoogleDriveIcon(props: SvgIconProps) {\n  return (\n    <SvgIcon {...props}>\n      <path d=\"M7.71,3.5L1.15,15L4.58,21L11.13,9.5M9.73,15L6.3,21H19.42L22.85,15M22.28,14L15.42,2H8.58L8.57,2L15.43,14H22.28Z\" />\n    </SvgIcon>\n  )\n}\n","import { getResponseError } from '../util.ts'\n\ninterface GoogleDriveError {\n  error: {\n    errors: {\n      domain: string\n      reason: string\n      message: string\n      locationType?: string\n      location?: string\n    }[]\n    code: number\n    message: string\n  }\n}\n\nexport async function getDescriptiveErrorMessage(\n  response: Response,\n  reason?: string,\n) {\n  let errorMessage = ''\n  try {\n    const err = JSON.parse(await response.text()) as GoogleDriveError\n    errorMessage = err.error.message\n  } catch (error) {\n    /* do nothing */\n  }\n  return getResponseError({ response, reason, statusText: errorMessage })\n}\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { GoogleDriveFile } from './GoogleDriveFilehandle.ts'\nimport GoogleDriveIcon from './GoogleDriveIcon.tsx'\nimport { getDescriptiveErrorMessage } from './util.ts'\nimport { configSchema as OAuthConfigSchema } from '../OAuthModel/index.ts'\nimport baseModel from '../OAuthModel/model.tsx'\n\nimport type { GoogleDriveOAuthInternetAccountConfigModel } from './configSchema.ts'\nimport type { UriLocation } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport interface RequestInitWithMetadata extends RequestInit {\n  metadataOnly?: boolean\n}\n\nfunction getUri(str: string) {\n  const urlId = /[-\\w]{25,}/.exec(str)\n  return `https://www.googleapis.com/drive/v3/files/${urlId}`\n}\n\n/**\n * #stateModel GoogleDriveOAuthInternetAccount\n */\nexport default function stateModelFactory(\n  configSchema: GoogleDriveOAuthInternetAccountConfigModel,\n) {\n  return baseModel(OAuthConfigSchema)\n    .named('GoogleDriveOAuthInternetAccount')\n    .props({\n      /**\n       * #property\n       */\n      type: types.literal('GoogleDriveOAuthInternetAccount'),\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(configSchema),\n    })\n    .views(() => ({\n      /**\n       * #getter\n       * The FileSelector icon for Google drive\n       */\n      get toggleContents() {\n        return <GoogleDriveIcon />\n      },\n      /**\n       * #getter\n       */\n      get selectorLabel() {\n        return 'Enter Google Drive share link'\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #method\n       */\n      getFetcher(location?: UriLocation) {\n        return async (input: RequestInfo, init?: RequestInitWithMetadata) => {\n          const driveUrl = new URL(getUri(String(input)))\n          const searchParams = new URLSearchParams()\n          if (init?.metadataOnly) {\n            searchParams.append('fields', 'size')\n          } else {\n            searchParams.append('alt', 'media')\n          }\n          driveUrl.search = searchParams.toString()\n          const authToken = await self.getToken(location)\n          const response = await fetch(\n            driveUrl,\n            self.addAuthHeaderToInit(\n              { ...init, method: 'GET', credentials: 'same-origin' },\n              authToken,\n            ),\n          )\n          if (!response.ok) {\n            throw new Error(await getDescriptiveErrorMessage(response))\n          }\n          return response\n        }\n      },\n      /**\n       * #method\n       */\n      openLocation(location: UriLocation) {\n        return new GoogleDriveFile(location.uri, {\n          fetch: this.getFetcher(location),\n        })\n      },\n      /**\n       * #action\n       */\n      async validateToken(token: string, location: UriLocation) {\n        const response = await fetch(getUri(location.uri), {\n          headers: {\n            Authorization: `Bearer ${token}`,\n            'Content-Type': 'application/x-www-form-urlencoded',\n          },\n        })\n        if (!response.ok) {\n          throw new Error(\n            await getDescriptiveErrorMessage(\n              response,\n              'Token could not be validated',\n            ),\n          )\n        }\n        return token\n      },\n    }))\n}\n\nexport type GoogleDriveOAuthStateModel = ReturnType<typeof stateModelFactory>\nexport type GoogleDriveOAuthModel = Instance<GoogleDriveOAuthStateModel>\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { BaseInternetAccountConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config HTTPBasicInternetAccount\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst HTTPBasicConfigSchema = ConfigurationSchema(\n  'HTTPBasicInternetAccount',\n  {\n    /**\n     * #slot\n     */\n    tokenType: {\n      description: 'a custom name for a token to include in the header',\n      type: 'string',\n      defaultValue: 'Basic',\n    },\n    /**\n     * #slot\n     */\n    validateWithHEAD: {\n      description: 'validate the token with a HEAD request before using it',\n      type: 'boolean',\n      defaultValue: true,\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: BaseInternetAccountConfig,\n    explicitlyTyped: true,\n  },\n)\n\nexport type HTTPBasicInternetAccountConfigModel = typeof HTTPBasicConfigSchema\n\nexport type HTTPBasicInternetAccountConfig =\n  Instance<HTTPBasicInternetAccountConfigModel>\nexport default HTTPBasicConfigSchema\n","import { useState } from 'react'\n\nimport { Dialog } from '@jbrowse/core/ui'\nimport { Button, DialogActions, DialogContent, TextField } from '@mui/material'\n\nexport function HTTPBasicLoginForm({\n  internetAccountId,\n  handleClose,\n}: {\n  internetAccountId: string\n  handleClose: (arg?: string) => void\n}) {\n  const [username, setUsername] = useState('')\n  const [password, setPassword] = useState('')\n\n  return (\n    <Dialog\n      open\n      maxWidth=\"xl\"\n      data-testid=\"login-httpbasic\"\n      title={`Log in for ${internetAccountId}`}\n      onClose={() => {\n        handleClose()\n      }}\n    >\n      <form\n        onSubmit={event => {\n          if (username && password) {\n            handleClose(btoa(`${username}:${password}`))\n          } else {\n            handleClose()\n          }\n          event.preventDefault()\n        }}\n      >\n        <DialogContent style={{ display: 'flex', flexDirection: 'column' }}>\n          <TextField\n            required\n            label=\"Username\"\n            variant=\"outlined\"\n            onChange={event => {\n              setUsername(event.target.value)\n            }}\n            margin=\"dense\"\n            slotProps={{\n              htmlInput: { 'data-testid': 'login-httpbasic-username' },\n            }}\n          />\n          <TextField\n            required\n            label=\"Password\"\n            type=\"password\"\n            autoComplete=\"current-password\"\n            variant=\"outlined\"\n            onChange={event => {\n              setPassword(event.target.value)\n            }}\n            margin=\"dense\"\n            slotProps={{\n              htmlInput: { 'data-testid': 'login-httpbasic-password' },\n            }}\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n            Submit\n          </Button>\n          <Button\n            variant=\"contained\"\n            color=\"secondary\"\n            type=\"submit\"\n            onClick={() => {\n              handleClose()\n            }}\n          >\n            Cancel\n          </Button>\n        </DialogActions>\n      </form>\n    </Dialog>\n  )\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { InternetAccount } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getRoot, types } from '@jbrowse/mobx-state-tree'\n\nimport { HTTPBasicLoginForm } from './HTTPBasicLoginForm.tsx'\nimport { getResponseError } from '../util.ts'\n\nimport type { HTTPBasicInternetAccountConfigModel } from './configSchema.ts'\nimport type { UriLocation } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel HTTPBasicInternetAccount\n */\nconst stateModelFactory = (\n  configSchema: HTTPBasicInternetAccountConfigModel,\n) => {\n  return InternetAccount.named('HTTPBasicInternetAccount')\n    .props({\n      /**\n       * #property\n       */\n      type: types.literal('HTTPBasicInternetAccount'),\n      /**\n       * #property\n       */\n      configuration: ConfigurationReference(configSchema),\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get validateWithHEAD(): boolean {\n        return getConf(self, 'validateWithHEAD')\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      getTokenFromUser(\n        resolve: (token: string) => void,\n        reject: (error: Error) => void,\n      ) {\n        const { session } = getRoot<any>(self)\n        session.queueDialog((doneCallback: () => void) => [\n          HTTPBasicLoginForm,\n          {\n            internetAccountId: self.internetAccountId,\n            handleClose: (token: string) => {\n              if (token) {\n                resolve(token)\n              } else {\n                reject(new Error('User cancelled entry'))\n              }\n              doneCallback()\n            },\n          },\n        ])\n      },\n      /**\n       * #action\n       */\n      async validateToken(token: string, location: UriLocation) {\n        if (!self.validateWithHEAD) {\n          return token\n        }\n        const newInit = self.addAuthHeaderToInit({ method: 'HEAD' }, token)\n        const response = await fetch(location.uri, newInit)\n        if (!response.ok) {\n          throw new Error(\n            await getResponseError({\n              response,\n              reason: 'Error validating token',\n            }),\n          )\n        }\n        return token\n      },\n    }))\n}\n\nexport default stateModelFactory\nexport type HTTPBasicStateModel = ReturnType<typeof stateModelFactory>\nexport type HTTPBasicModel = Instance<HTTPBasicStateModel>\n","import Plugin from '@jbrowse/core/Plugin'\nimport InternetAccountType from '@jbrowse/core/pluggableElementTypes/InternetAccountType'\n\nimport {\n  configSchema as DropboxOAuthConfigSchema,\n  modelFactory as DropboxOAuthInternetAccountModelFactory,\n} from './DropboxOAuthModel/index.ts'\nimport {\n  configSchema as ExternalTokenConfigSchema,\n  modelFactory as ExternalTokenInternetAccountModelFactory,\n} from './ExternalTokenModel/index.ts'\nimport {\n  configSchema as GoogleDriveOAuthConfigSchema,\n  modelFactory as GoogleDriveOAuthInternetAccountModelFactory,\n} from './GoogleDriveOAuthModel/index.ts'\nimport {\n  configSchema as HTTPBasicConfigSchema,\n  modelFactory as HTTPBasicInternetAccountModelFactory,\n} from './HTTPBasicModel/index.ts'\nimport {\n  configSchema as OAuthConfigSchema,\n  modelFactory as OAuthInternetAccountModelFactory,\n} from './OAuthModel/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class AuthenticationPlugin extends Plugin {\n  name = 'AuthenticationPlugin'\n\n  exports = {\n    OAuthConfigSchema,\n    OAuthInternetAccountModelFactory,\n    ExternalTokenConfigSchema,\n    ExternalTokenInternetAccountModelFactory,\n    HTTPBasicConfigSchema,\n    HTTPBasicInternetAccountModelFactory,\n    DropboxOAuthConfigSchema,\n    DropboxOAuthInternetAccountModelFactory,\n    GoogleDriveOAuthConfigSchema,\n    GoogleDriveOAuthInternetAccountModelFactory,\n  }\n\n  install(pluginManager: PluginManager) {\n    pluginManager.addInternetAccountType(() => {\n      return new InternetAccountType({\n        name: 'OAuthInternetAccount',\n        configSchema: OAuthConfigSchema,\n        stateModel: OAuthInternetAccountModelFactory(OAuthConfigSchema),\n      })\n    })\n    pluginManager.addInternetAccountType(() => {\n      return new InternetAccountType({\n        name: 'ExternalTokenInternetAccount',\n        configSchema: ExternalTokenConfigSchema,\n        stateModel: ExternalTokenInternetAccountModelFactory(\n          ExternalTokenConfigSchema,\n        ),\n      })\n    })\n    pluginManager.addInternetAccountType(() => {\n      return new InternetAccountType({\n        name: 'HTTPBasicInternetAccount',\n        configSchema: HTTPBasicConfigSchema,\n        stateModel: HTTPBasicInternetAccountModelFactory(HTTPBasicConfigSchema),\n      })\n    })\n    pluginManager.addInternetAccountType(() => {\n      return new InternetAccountType({\n        name: 'DropboxOAuthInternetAccount',\n        configSchema: DropboxOAuthConfigSchema,\n        stateModel: DropboxOAuthInternetAccountModelFactory(\n          DropboxOAuthConfigSchema,\n        ),\n      })\n    })\n    pluginManager.addInternetAccountType(() => {\n      return new InternetAccountType({\n        name: 'GoogleDriveOAuthInternetAccount',\n        configSchema: GoogleDriveOAuthConfigSchema,\n        stateModel: GoogleDriveOAuthInternetAccountModelFactory(\n          GoogleDriveOAuthConfigSchema,\n        ),\n      })\n    })\n  }\n}\n\nexport {\n  configSchema as OAuthConfigSchema,\n  modelFactory as OAuthInternetAccountModelFactory,\n} from './OAuthModel/index.ts'\nexport {\n  configSchema as ExternalTokenConfigSchema,\n  modelFactory as ExternalTokenInternetAccountModelFactory,\n} from './ExternalTokenModel/index.ts'\n\nexport {\n  configSchema as HTTPBasicConfigSchema,\n  modelFactory as HTTPBasicInternetAccountModelFactory,\n} from './HTTPBasicModel/index.ts'\n\nexport {\n  configSchema as DropboxOAuthConfigSchema,\n  modelFactory as DropboxOAuthInternetAccountModelFactory,\n} from './DropboxOAuthModel/index.ts'\n\nexport {\n  configSchema as GoogleDriveOAuthConfigSchema,\n  modelFactory as GoogleDriveOAuthInternetAccountModelFactory,\n} from './GoogleDriveOAuthModel/index.ts'\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BedAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BedAdapter = ConfigurationSchema(\n  'BedAdapter',\n  {\n    /**\n     * #slot\n     */\n    bedLocation: {\n      type: 'fileLocation',\n      description: 'path to bed file, also allows gzipped bed',\n      defaultValue: {\n        uri: '/path/to/my.bed.gz',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    columnNames: {\n      type: 'stringArray',\n      description: 'List of column names',\n      defaultValue: [],\n    },\n    /**\n     * #slot\n     */\n    scoreColumn: {\n      type: 'string',\n      description: 'The column to use as a \"score\" attribute',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    autoSql: {\n      type: 'string',\n      description: 'The autoSql definition for the data fields in the file',\n      defaultValue: '',\n    },\n    /**\n     * #slot\n     */\n    colRef: {\n      type: 'number',\n      description: 'The column to use as a \"refName\" attribute',\n      defaultValue: 0,\n    },\n    /**\n     * #slot\n     */\n    colStart: {\n      type: 'number',\n      description: 'The column to use as a \"start\" attribute',\n      defaultValue: 1,\n    },\n    /**\n     * #slot\n     */\n    colEnd: {\n      type: 'number',\n      description: 'The column to use as a \"end\" attribute',\n      defaultValue: 2,\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"BedAdapter\",\n     *   \"uri\": \"yourfile.bed\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bedLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default BedAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BedGraphAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BedGraphAdapter = ConfigurationSchema(\n  'BedGraphAdapter',\n  {\n    /**\n     * #slot\n     */\n    bedGraphLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bedgraph',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    columnNames: {\n      type: 'stringArray',\n      description: 'List of column names',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"BedGraphAdapter\",\n     *   \"uri\": \"yourfile.bed\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bedGraphLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default BedGraphAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config BedGraphTabixAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BedGraphTabixAdapter = ConfigurationSchema(\n  'BedGraphTabixAdapter',\n  {\n    /**\n     * #slot\n     */\n    bedGraphGzLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bedgraph',\n        locationType: 'UriLocation',\n      },\n    },\n    index: ConfigurationSchema('VcfIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['TBI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'TBI',\n      },\n      /**\n       * #slot index.location\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.vcf.gz.tbi',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n    /**\n     * #slot\n     */\n    columnNames: {\n      type: 'stringArray',\n      description: 'List of column names',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes yourfile.bg.gz.tbi:\n     * ```json\n     * {\n     *   \"type\": \"BedGraphTabixAdapter\",\n     *   \"uri\": \"yourfile.bg.gz\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bedGraphGzLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.tbi`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default BedGraphTabixAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config BedTabixAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BedTabixAdapter = ConfigurationSchema(\n  'BedTabixAdapter',\n  {\n    /**\n     * #slot\n     */\n    bedGzLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bed.gz',\n        locationType: 'UriLocation',\n      },\n    },\n\n    index: ConfigurationSchema('TabixIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['TBI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'TBI',\n      },\n      /**\n       * #slot index.location\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.bed.gz.tbi',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n\n    /**\n     * #slot\n     */\n    columnNames: {\n      type: 'stringArray',\n      description: 'List of column names',\n      defaultValue: [],\n    },\n\n    /**\n     * #slot\n     */\n    scoreColumn: {\n      type: 'string',\n      description: 'The column to use as a \"score\" attribute',\n      defaultValue: '',\n    },\n\n    /**\n     * #slot\n     */\n    autoSql: {\n      type: 'string',\n      description: 'The autoSql definition for the data fields in the file',\n      defaultValue: '',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes yourfile.bed.gz.tbi:\n     * ```json\n     * {\n     *   \"type\": \"BedTabixAdapter\",\n     *   \"uri\": \"yourfile.bed.gz\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bedGzLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.tbi`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default BedTabixAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BedpeAdapter\n * intended for SVs in a single assembly\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BedpeAdapter = ConfigurationSchema(\n  'BedpeAdapter',\n  {\n    /**\n     * #slot\n     */\n    bedpeLocation: {\n      type: 'fileLocation',\n      description:\n        'can be plaintext or gzipped, not indexed so loaded into memory on startup',\n      defaultValue: {\n        uri: '/path/to/my.bedpe.gz',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    columnNames: {\n      type: 'stringArray',\n      description: 'List of column names',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"BedpeAdapter\",\n     *   \"uri\": \"yourfile.bedpe.gz\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bedpeLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default BedpeAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BigBedAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BigBedAdapter = ConfigurationSchema(\n  'BigBedAdapter',\n  {\n    /**\n     * #slot\n     */\n    bigBedLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.bb',\n        locationType: 'UriLocation',\n      },\n    },\n\n    /**\n     * #slot\n     */\n    scoreColumn: {\n      type: 'string',\n      description: 'The column to use as a \"score\" attribute',\n      defaultValue: '',\n    },\n\n    /**\n     * #slot\n     */\n    aggregateField: {\n      type: 'string',\n      description: 'An attribute to aggregate features with',\n      defaultValue: 'geneName2',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"BigBedAdapter\",\n     *   \"uri\": \"yourfile.bigBed\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            bigBedLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default BigBedAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport BedAdapterF from './BedAdapter/index.ts'\nimport BedGraphAdapterF from './BedGraphAdapter/index.ts'\nimport BedGraphTabixAdapterF from './BedGraphTabixAdapter/index.ts'\nimport BedTabixAdapterF from './BedTabixAdapter/index.ts'\nimport BedpeAdapterF from './BedpeAdapter/index.ts'\nimport BigBedAdapterF from './BigBedAdapter/index.ts'\nimport GuessAdapterF from './GuessAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class BedPlugin extends Plugin {\n  name = 'BedPlugin'\n\n  install(pluginManager: PluginManager) {\n    BigBedAdapterF(pluginManager)\n    BedAdapterF(pluginManager)\n    BedpeAdapterF(pluginManager)\n    BedTabixAdapterF(pluginManager)\n    BedGraphAdapterF(pluginManager)\n    BedGraphTabixAdapterF(pluginManager)\n    GuessAdapterF(pluginManager)\n  }\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BigBedAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BigBedAdapter',\n        displayName: 'BigBed adapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./BigBedAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BedAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BedAdapter',\n        displayName: 'BED adapter',\n        configSchema,\n        getAdapterClass: () => import('./BedAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BedpeAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BedpeAdapter',\n        displayName: 'BEDPE adapter',\n        configSchema,\n        getAdapterClass: () => import('./BedpeAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BedTabixAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BedTabixAdapter',\n        displayName: 'BED tabix adapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./BedTabixAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BedGraphAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BedGraphAdapter',\n        displayName: 'BedGraph adapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./BedGraphAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BedGraphTabixAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BedGraphTabixAdapter',\n        displayName: 'BedGraphTabix adapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./BedGraphTabixAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport {\n  getFileName,\n  makeIndex,\n  makeIndexType,\n} from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAdapterF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        const indexName = index && getFileName(index)\n        if (\n          testAdapter(fileName, /\\.bedpe(\\.gz)?$/i, adapterHint, 'BedpeAdapter')\n        ) {\n          return {\n            type: 'BedpeAdapter',\n            bedpeLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.bb$/i, adapterHint, 'BigBedAdapter') ||\n          testAdapter(fileName, /\\.bigBed?$/i, adapterHint, 'BigBedAdapter')\n        ) {\n          return {\n            type: 'BigBedAdapter',\n            bigBedLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.bed$/i, adapterHint, 'BedAdapter')\n        ) {\n          return {\n            type: 'BedAdapter',\n            bedLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.bg$/i, adapterHint, 'BedGraphAdapter')\n        ) {\n          return {\n            type: 'BedGraphAdapter',\n            bedGraphLocation: file,\n          }\n        } else if (\n          testAdapter(\n            fileName,\n            /\\.bg(\\.gz)?$/i,\n            adapterHint,\n            'BedGraphTabixAdapter',\n          )\n        ) {\n          return {\n            type: 'BedGraphTabixAdapter',\n            bedGraphGzLocation: file,\n            index: {\n              location: index || makeIndex(file, '.tbi'),\n              indexType: makeIndexType(indexName, 'CSI', 'TBI'),\n            },\n          }\n        } else if (\n          testAdapter(fileName, /\\.bed\\.gz$/i, adapterHint, 'BedTabixAdapter')\n        ) {\n          return {\n            type: 'BedTabixAdapter',\n            bedGzLocation: file,\n            index: {\n              location: index || makeIndex(file, '.tbi'),\n              indexType: makeIndexType(indexName, 'CSI', 'TBI'),\n            },\n          }\n        } else {\n          return adapterGuesser(file, index, adapterHint)\n        }\n      }\n    },\n  )\n\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => (adapterName: string) => {\n      return (\n        {\n          BedpeAdapter: 'VariantTrack',\n          BedGraphAdapter: 'QuantitativeTrack',\n          BedGraphTabixAdapter: 'QuantitativeTrack',\n        }[adapterName] || trackTypeGuesser(adapterName)\n      )\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('BreakpointAlignmentsWidget', {})\n\nconst stateModel = types\n  .model('BreakpointAlignmentsWidget', {\n    id: ElementId,\n    type: types.literal('BreakpointAlignmentsWidget'),\n    featureData: types.frozen(),\n  })\n  .actions(self => ({\n    setFeatureData(data: unknown) {\n      self.featureData = data\n    },\n    clearFeatureData() {\n      self.featureData = undefined\n    },\n  }))\n\nexport default function BreakpointAlignmentsFeatureDetailF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'BreakpointAlignmentsWidget',\n      heading: 'Breakpoint feature details',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(\n        () => import('./BreakpointAlignmentsFeatureDetail.tsx'),\n      ),\n    })\n  })\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodType from '@jbrowse/core/pluggableElementTypes/RpcMethodType'\nimport { renameRegionsIfNeeded } from '@jbrowse/core/util'\nimport SimpleFeature from '@jbrowse/core/util/simpleFeature'\nimport { firstValueFrom } from 'rxjs'\nimport { toArray } from 'rxjs/operators'\n\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { RenderArgs } from '@jbrowse/core/rpc/methods/util'\nimport type { Region } from '@jbrowse/core/util'\n\nconst startClip = /(\\d+)[SH]$/\nconst endClip = /^(\\d+)([SH])/\n\nfunction getClip(cigar: string, strand: number) {\n  return strand === -1\n    ? +(startClip.exec(cigar)?.[1] ?? 0)\n    : +(endClip.exec(cigar)?.[1] ?? 0)\n}\n\n// This interface covers features from two different track types:\n//\n// 1. AlignmentsTrack (BAM/CRAM) - uses fields like:\n//    - CIGAR, strand, flags, pair_orientation, clipLengthAtStartOfRead\n//    - Rendered by AlignmentConnections component\n//\n// 2. VariantTrack (VCF) - uses fields like:\n//    - ALT, INFO, type (e.g. 'translocation', 'paired_feature', or breakend)\n//    - Rendered by Translocations, PairedFeatures, or Breakends components\ninterface MinimalFeature {\n  [key: string]: unknown\n  uniqueId: string\n  refName: string\n  start: number\n  end: number\n  strand: number\n  flags: number\n  name?: string\n  id?: string\n  // Alignment-specific fields\n  tags?: Record<string, unknown>\n  pair_orientation?: string\n  clipLengthAtStartOfRead?: number\n  // Variant-specific fields\n  INFO?: Record<string, unknown>\n  ALT?: unknown[]\n  mate?: Record<string, unknown>\n  type?: string\n}\n\nexport default class BreakpointGetFeatures extends RpcMethodType {\n  name = 'BreakpointGetFeatures'\n\n  async deserializeReturn(\n    feats: MinimalFeature[],\n    args: unknown,\n    rpcDriver: string,\n  ) {\n    const superDeserialized = (await super.deserializeReturn(\n      feats,\n      args,\n      rpcDriver,\n    )) as MinimalFeature[]\n    return superDeserialized.map(feat => new SimpleFeature(feat))\n  }\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rootModel } = this.pluginManager\n    const assemblyManager = rootModel!.session!.assemblyManager\n    const renamedArgs = await renameRegionsIfNeeded(assemblyManager, args)\n    return super.serializeArguments(\n      renamedArgs,\n      rpcDriver,\n    ) as Promise<RenderArgs>\n  }\n\n  async execute(\n    args: {\n      sessionId: string\n      regions: Region[]\n      adapterConfig: Record<string, unknown>\n      statusCallback: (arg: string) => void\n      stopToken?: string\n      opts?: Record<string, unknown>\n    },\n    rpcDriver: string,\n  ) {\n    const {\n      stopToken,\n      statusCallback,\n      sessionId,\n      adapterConfig,\n      regions,\n      opts,\n    } = await this.deserializeArguments(args, rpcDriver)\n\n    const dataAdapter = (\n      await getAdapter(this.pluginManager, sessionId, adapterConfig)\n    ).dataAdapter as BaseFeatureDataAdapter\n\n    const features = await firstValueFrom(\n      dataAdapter\n        .getFeaturesInMultipleRegions(regions, {\n          ...opts,\n          statusCallback,\n          stopToken,\n        })\n        .pipe(toArray()),\n    )\n\n    // Serialize minimal fields needed for breakpoint view. This includes fields\n    // for both alignment features (CIGAR, strand, pair_orientation) and variant\n    // features (ALT, INFO, type). Each feature will only have the relevant\n    // fields populated based on its source adapter.\n    return features.map(feature => {\n      const cigar = feature.get('CIGAR')\n      const strand = feature.get('strand')\n      return {\n        uniqueId: feature.id(),\n        start: feature.get('start'),\n        end: feature.get('end'),\n        refName: feature.get('refName'),\n        strand,\n        flags: feature.get('flags'),\n        name: feature.get('name'),\n        id: feature.get('id'),\n        tags: feature.get('tags'),\n        pair_orientation: feature.get('pair_orientation'),\n        type: feature.get('type'),\n        ALT: feature.get('ALT'),\n        INFO: feature.get('INFO'),\n        clipLengthAtStartOfRead:\n          cigar && strand !== undefined ? getClip(cigar, strand) : undefined,\n      }\n    })\n  }\n}\n","import { lazy } from 'react'\n\nimport { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getSession, notEmpty } from '@jbrowse/core/util'\nimport {\n  addDisposer,\n  addMiddleware,\n  cast,\n  getPath,\n  types,\n} from '@jbrowse/mobx-state-tree'\nimport LinkIcon from '@mui/icons-material/Link'\nimport PhotoCamera from '@mui/icons-material/PhotoCamera'\nimport { autorun } from 'mobx'\n\nimport { calc, getBlockFeatures, intersect } from './util.ts'\n\nimport type { BreakpointSplitViewInit, ExportSvgOptions } from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { LinearGenomeViewStateModel } from '@jbrowse/plugin-linear-genome-view'\n\n// lazies\nconst ExportSvgDialog = lazy(() => import('./components/ExportSvgDialog.tsx'))\n\n/**\n * #stateModel BreakpointSplitView\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nexport default function stateModelFactory(pluginManager: PluginManager) {\n  const defaultHeight = 400\n  return types\n    .compose(\n      'BreakpointSplitView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('BreakpointSplitView'),\n        /**\n         * #property\n         */\n        height: types.optional(types.number, defaultHeight),\n        /**\n         * #property\n         */\n        trackSelectorType: 'hierarchical',\n        /**\n         * #property\n         */\n        showIntraviewLinks: true,\n        /**\n         * #property\n         */\n        linkViews: false,\n        /**\n         * #property\n         */\n        interactiveOverlay: true,\n        /**\n         * #property\n         */\n        showHeader: false,\n        /**\n         * #property\n         */\n        views: types.array(\n          pluginManager.getViewType('LinearGenomeView')!\n            .stateModel as LinearGenomeViewStateModel,\n        ),\n        /**\n         * #property\n         * used for initializing the view from a session snapshot\n         */\n        init: types.frozen<BreakpointSplitViewInit | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      width: 800,\n      /**\n       * #volatile\n       */\n      matchedTrackFeatures: {} as Record<string, Feature[][]>,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get hasSomethingToShow() {\n        return self.views.length > 0 || !!self.init\n      },\n\n      /**\n       * #getter\n       */\n      get initialized() {\n        return self.views.length > 0 && self.views.every(v => v.initialized)\n      },\n\n      /**\n       * #getter\n       */\n      get showImportForm() {\n        return !this.hasSomethingToShow\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * creates an svg export and save using FileSaver\n       */\n      async exportSvg(opts: ExportSvgOptions = {}) {\n        const { renderToSvg } =\n          await import('./svgcomponents/SVGBreakpointSplitView.tsx')\n        const html = await renderToSvg(self as BreakpointViewModel, opts)\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        const { saveAs } = await import('file-saver-es')\n\n        saveAs(\n          new Blob([html], { type: 'image/svg+xml' }),\n          opts.filename || 'image.svg',\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Find all track ids that match across multiple views, or return just\n       * the single view's track if only a single row is used\n       */\n      get matchedTracks() {\n        return self.views.length === 1\n          ? self.views[0]!.tracks\n          : intersect(\n              elt => elt.configuration.trackId,\n              ...self.views.map(\n                view => view.tracks as { configuration: { trackId: string } }[],\n              ),\n            )\n      },\n\n      /**\n       * #method\n       * Get tracks with a given trackId across multiple views\n       */\n      getMatchedTracks(trackConfigId: string) {\n        return self.views\n          .map(view => view.getTrack(trackConfigId))\n          .filter(notEmpty)\n      },\n\n      /**\n       * #method\n       * Translocation features are handled differently since they do not have\n       * a mate e.g. they are one sided\n       */\n      hasTranslocations(trackConfigId: string) {\n        return [...this.getTrackFeatures(trackConfigId).values()].some(\n          f => f.get('type') === 'translocation',\n        )\n      },\n\n      /**\n       * #method\n       * Paired features similar to breakends, but simpler, like BEDPE\n       */\n      hasPairedFeatures(trackConfigId: string) {\n        return [...this.getTrackFeatures(trackConfigId).values()].some(\n          f => f.get('type') === 'paired_feature',\n        )\n      },\n\n      /**\n       * #method\n       * Get a composite map of featureId-\\>feature map for a track across\n       * multiple views\n       */\n      getTrackFeatures(trackConfigId: string) {\n        return new Map(\n          self.matchedTrackFeatures[trackConfigId]\n            ?.flat()\n            .map(f => [f.id(), f] as const),\n        )\n      },\n\n      /**\n       * #method\n       */\n      getMatchedFeaturesInLayout(trackConfigId: string, features: Feature[][]) {\n        const tracks = this.getMatchedTracks(trackConfigId)\n        return features.map(c =>\n          c\n            .map(feature => {\n              for (const [level, track] of tracks.entries()) {\n                const layout = calc(track, feature)\n                if (layout) {\n                  return {\n                    feature,\n                    layout,\n                    level,\n                    clipLengthAtStartOfRead:\n                      feature.get('clipLengthAtStartOfRead') ?? 0,\n                  }\n                }\n              }\n              return undefined\n            })\n            .filter(notEmpty),\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          addMiddleware(self, (rawCall, next) => {\n            if (rawCall.type === 'action' && rawCall.id === rawCall.rootId) {\n              const syncActions = [\n                'horizontalScroll',\n                'zoomTo',\n                'setScaleFactor',\n                'showTrack',\n                'toggleTrack',\n                'hideTrack',\n                'setTrackLabels',\n                'toggleCenterLine',\n              ]\n\n              if (self.linkViews && syncActions.includes(rawCall.name)) {\n                const sourcePath = getPath(rawCall.context)\n                next(rawCall)\n                // Sync to all other views\n                for (const view of self.views) {\n                  const viewPath = getPath(view)\n                  if (viewPath !== sourcePath) {\n                    // @ts-expect-error\n                    view[rawCall.name](rawCall.args[0])\n                  }\n                }\n                return\n              }\n            }\n            next(rawCall)\n          }),\n        )\n      },\n\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.width = newWidth\n        for (const v of self.views) {\n          v.setWidth(newWidth)\n        }\n      },\n\n      /**\n       * #action\n       */\n      setInteractiveOverlay(arg: boolean) {\n        self.interactiveOverlay = arg\n      },\n\n      /**\n       * #action\n       */\n      setShowIntraviewLinks(arg: boolean) {\n        self.showIntraviewLinks = arg\n      },\n\n      /**\n       * #action\n       */\n      setLinkViews(arg: boolean) {\n        self.linkViews = arg\n      },\n\n      /**\n       * #action\n       */\n      setShowHeader(arg: boolean) {\n        self.showHeader = arg\n      },\n\n      /**\n       * #action\n       */\n      setMatchedTrackFeatures(obj: Record<string, Feature[][]>) {\n        self.matchedTrackFeatures = obj\n      },\n      /**\n       * #action\n       */\n      reverseViewOrder() {\n        self.views.reverse()\n      },\n\n      /**\n       * #action\n       */\n      setInit(init?: BreakpointSplitViewInit) {\n        self.init = init\n      },\n\n      /**\n       * #action\n       */\n      setViews(\n        viewInits: {\n          loc?: string\n          assembly: string\n          tracks?: string[]\n        }[],\n      ) {\n        self.views = cast(\n          viewInits.map(viewInit => ({\n            type: 'LinearGenomeView' as const,\n            hideHeader: true,\n            init: viewInit,\n          })),\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // Init autorun for initializing from session snapshot\n        addDisposer(\n          self,\n          autorun(\n            function breakpointSplitViewInitAutorun() {\n              const { init, width } = self\n              if (!width || !init) {\n                return\n              }\n\n              // Set up the views with their init properties\n              // The child LinearGenomeViews will handle their own initialization\n              self.setViews(init.views)\n\n              // Clear init state\n              self.setInit(undefined)\n            },\n            { name: 'BreakpointSplitViewInit' },\n          ),\n        )\n        addDisposer(\n          self,\n          autorun(\n            async () => {\n              try {\n                // check all views 'initialized'\n                if (!self.views.every(view => view.initialized)) {\n                  return\n                }\n                // check that tracks are 'ready' (not notReady)\n                if (\n                  self.matchedTracks.some(track =>\n                    track.displays[0].notReady?.(),\n                  )\n                ) {\n                  return\n                }\n\n                self.setMatchedTrackFeatures(\n                  Object.fromEntries(\n                    await Promise.all(\n                      self.matchedTracks.map(async track => [\n                        track.configuration.trackId,\n                        await getBlockFeatures(self, track),\n                      ]),\n                    ),\n                  ),\n                )\n              } catch (e) {\n                console.error(e)\n                getSession(self).notifyError(`${e}`, e)\n              }\n            },\n            {\n              name: 'BreakpointFeatureFetcher',\n              delay: 1000,\n            },\n          ),\n        )\n      },\n\n      /**\n       * #method\n       */\n      menuItems() {\n        return [\n          ...self.views.map((view, idx) => ({\n            label: `Row ${idx + 1} view menu`,\n            subMenu: view.menuItems(),\n          })),\n\n          ...(self.views.length > 1\n            ? [\n                {\n                  label: 'Reverse view order',\n                  onClick: () => {\n                    self.reverseViewOrder()\n                  },\n                },\n              ]\n            : []),\n          {\n            label: 'Show header',\n            type: 'checkbox',\n            checked: self.showHeader,\n            onClick: () => {\n              self.setShowHeader(!self.showHeader)\n            },\n          },\n          {\n            label: 'Show intra-view links',\n            type: 'checkbox',\n            checked: self.showIntraviewLinks,\n            onClick: () => {\n              self.setShowIntraviewLinks(!self.showIntraviewLinks)\n            },\n          },\n          {\n            label: 'Allow clicking alignment squiggles?',\n            type: 'checkbox',\n            checked: self.interactiveOverlay,\n            onClick: () => {\n              self.setInteractiveOverlay(!self.interactiveOverlay)\n            },\n          },\n          {\n            label: 'Link views',\n            type: 'checkbox',\n            icon: LinkIcon,\n            checked: self.linkViews,\n            onClick: () => {\n              self.setLinkViews(!self.linkViews)\n            },\n          },\n          {\n            label: 'Export SVG',\n            icon: PhotoCamera,\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                ExportSvgDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n        ]\n      },\n\n      /**\n       * #method\n       */\n      rubberBandMenuItems() {\n        return [\n          {\n            label: 'Zoom to region(s)',\n            onClick: () => {\n              for (const view of self.views) {\n                const { leftOffset, rightOffset } = view\n                if (leftOffset && rightOffset) {\n                  view.moveTo(leftOffset, rightOffset)\n                }\n              }\n            },\n          },\n        ]\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        init,\n        height,\n        trackSelectorType,\n        showIntraviewLinks,\n        linkViews,\n        interactiveOverlay,\n        showHeader,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(height !== 400 ? { height } : {}),\n        ...(trackSelectorType !== 'hierarchical' ? { trackSelectorType } : {}),\n        ...(!showIntraviewLinks ? { showIntraviewLinks } : {}),\n        ...(linkViews ? { linkViews } : {}),\n        ...(!interactiveOverlay ? { interactiveOverlay } : {}),\n        ...(showHeader ? { showHeader } : {}),\n      } as typeof snap\n    })\n}\n\nexport type BreakpointViewStateModel = ReturnType<typeof stateModelFactory>\nexport type BreakpointViewModel = Instance<BreakpointViewStateModel>\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport BreakpointAlignmentsWidgetF from './BreakpointAlignmentsFeatureDetail/index.ts'\nimport BreakpointGetFeaturesF from './BreakpointGetFeatures/index.ts'\nimport BreakpointSplitViewF from './BreakpointSplitView/index.ts'\nimport LaunchBreakpointSplitViewF from './LaunchBreakpointSplitView/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class BreakpointSplitViewPlugin extends Plugin {\n  name = 'BreakpointSplitViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    BreakpointSplitViewF(pluginManager)\n    BreakpointAlignmentsWidgetF(pluginManager)\n    LaunchBreakpointSplitViewF(pluginManager)\n    BreakpointGetFeaturesF(pluginManager)\n  }\n\n  configure() {}\n}\n","import { lazy } from 'react'\n\nimport { ViewType } from '@jbrowse/core/pluggableElementTypes'\n\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BreakpointSplitViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'BreakpointSplitView',\n      displayName: 'Breakpoint split view',\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(\n        () => import('./components/BreakpointSplitView.tsx'),\n      ),\n    })\n  })\n}\n","import type { BreakpointViewModel } from '../BreakpointSplitView/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default function LaunchBreakpointSplitViewF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-BreakpointSplitView',\n    // @ts-expect-error\n    async ({\n      session,\n      views,\n    }: {\n      session: AbstractSessionModel\n      views: {\n        loc?: string\n        assembly: string\n        tracks?: string[]\n      }[]\n    }) => {\n      if (views.length < 2) {\n        throw new Error(\n          'BreakpointSplitView requires at least 2 views to be specified',\n        )\n      }\n\n      session.addView('BreakpointSplitView', {\n        init: {\n          views,\n        },\n      }) as BreakpointViewModel\n    },\n  )\n}\n","import BreakpointGetFeatures from './BreakpointGetFeatures.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BreakpointGetFeaturesF(pluginManager: PluginManager) {\n  pluginManager.addRpcMethod(() => new BreakpointGetFeatures(pluginManager))\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\n\n/**\n * IMPORTANT: Config Reading Performance Optimization\n *\n * Reading config values via readConfObject is expensive because:\n * 1. It may involve JEXL expression evaluation\n * 2. It traverses the config tree\n * 3. It can trigger MobX reactions\n *\n * In rendering code, we process thousands of features in tight loops.\n * Calling readConfObject per-feature creates significant overhead.\n *\n * SOLUTION: Read all non-feature-dependent config values ONCE at the start\n * of the rendering pipeline and pass them through as a context object.\n *\n * For feature-dependent configs (callbacks), we use CachedConfig which stores\n * both the cached value and whether it needs per-feature evaluation.\n */\n\n/**\n * A cached config value that may need per-feature evaluation.\n * - If isCallback is false, use `value` directly (fast path)\n * - If isCallback is true, call readCachedConfig() to evaluate per-feature\n */\nexport interface CachedConfig<T> {\n  value: T\n  isCallback: boolean\n}\n\n/**\n * Read a potentially cached config value.\n * Uses cached value if not a callback, otherwise evaluates per-feature.\n */\nexport function readCachedConfig<T>(\n  cached: CachedConfig<T>,\n  config: AnyConfigurationModel,\n  key: string | string[],\n  feature: Feature,\n): T {\n  return cached.isCallback\n    ? (readConfObject(config, key, { feature }) as T)\n    : cached.value\n}\n\nfunction createCachedConfig<T>(\n  config: AnyConfigurationModel,\n  key: string | string[],\n  defaultValue: T,\n): CachedConfig<T> {\n  const configSlot = Array.isArray(key)\n    ? key.reduce((acc: any, k) => acc?.[k], config)\n    : config[key]\n  const isCallback = configSlot?.isCallback ?? false\n  const value = isCallback ? defaultValue : (readConfObject(config, key) as T)\n  return { value, isCallback }\n}\n\nexport interface RenderConfigContext {\n  // Reference to the raw config for callback evaluation\n  config: AnyConfigurationModel\n\n  displayMode: string\n  showLabels: boolean\n  showDescriptions: boolean\n  subfeatureLabels: string\n\n  transcriptTypes: string[]\n  containerTypes: string[]\n\n  color1: CachedConfig<string>\n  color2: CachedConfig<string>\n  color3: CachedConfig<string>\n  outline: CachedConfig<string>\n\n  featureHeight: CachedConfig<number>\n  fontHeight: CachedConfig<number>\n\n  labelAllowed: boolean\n  geneGlyphMode: string\n  displayDirectionalChevrons: boolean\n}\n\nexport function createRenderConfigContext(\n  config: AnyConfigurationModel,\n): RenderConfigContext {\n  const displayMode = readConfObject(config, 'displayMode') as string\n\n  return {\n    config,\n    displayMode,\n    showLabels: readConfObject(config, 'showLabels') as boolean,\n    showDescriptions: readConfObject(config, 'showDescriptions') as boolean,\n    subfeatureLabels: readConfObject(config, 'subfeatureLabels') as string,\n    transcriptTypes: readConfObject(config, 'transcriptTypes') as string[],\n    containerTypes: readConfObject(config, 'containerTypes') as string[],\n    geneGlyphMode: readConfObject(config, 'geneGlyphMode') as string,\n    displayDirectionalChevrons: readConfObject(\n      config,\n      'displayDirectionalChevrons',\n    ) as boolean,\n\n    color1: createCachedConfig(config, 'color1', 'goldenrod'),\n    color2: createCachedConfig(config, 'color2', '#f0f'),\n    color3: createCachedConfig(config, 'color3', '#357089'),\n    outline: createCachedConfig(config, 'outline', ''),\n\n    featureHeight: createCachedConfig(config, 'height', 10),\n    fontHeight: createCachedConfig(config, ['labels', 'fontSize'], 12),\n\n    labelAllowed: displayMode !== 'collapse',\n  }\n}\n","import { getFrame, stripAlpha } from '@jbrowse/core/util'\n\nimport { readCachedConfig } from './renderConfig.ts'\n\nimport type { RenderConfigContext } from './renderConfig.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Theme } from '@mui/material'\n\nconst MAX_LABEL_LENGTH = 50\nconst UTR_REGEX = /(\\bUTR|_UTR|untranslated[_\\s]region)\\b/i\n\n/**\n * Get the effective strand direction accounting for region reversal.\n * Returns -1 (visual left), 1 (visual right), or 0 (no strand).\n */\nexport function getEffectiveStrand(strand: number, reversed: boolean): number {\n  return strand * (reversed ? -1 : 1)\n}\n\n/**\n * Calculate x position for an index within a feature, accounting for strand direction.\n * For reverse strand (effectiveStrand === -1), positions go from right to left.\n * For forward strand (effectiveStrand === 1), positions go from left to right.\n */\nexport function getStrandAwareX(\n  left: number,\n  width: number,\n  index: number,\n  pxPerBp: number,\n  effectiveStrand: number,\n): number {\n  if (effectiveStrand === -1) {\n    return left + width - pxPerBp * index\n  }\n  return left + pxPerBp * index\n}\n\nexport function truncateLabel(text: string, maxLength = MAX_LABEL_LENGTH) {\n  return text.length > maxLength ? `${text.slice(0, maxLength - 1)}` : text\n}\n\nexport function isOffScreen(left: number, width: number, canvasWidth: number) {\n  return left + width < 0 || left > canvasWidth\n}\n\nexport function isUTR(feature: Feature) {\n  return UTR_REGEX.test(feature.get('type') || '')\n}\n\nexport function getBoxColor({\n  feature,\n  config,\n  configContext,\n  colorByCDS,\n  theme,\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  configContext: RenderConfigContext\n  colorByCDS: boolean\n  theme: Theme\n}) {\n  const { color1, color3 } = configContext\n\n  let fill: string\n  fill = isUTR(feature)\n    ? readCachedConfig(color3, config, 'color3', feature)\n    : readCachedConfig(color1, config, 'color1', feature)\n\n  const featureType: string | undefined = feature.get('type')\n  const featureStrand: -1 | 1 | undefined = feature.get('strand')\n  const featurePhase: 0 | 1 | 2 | undefined = feature.get('phase')\n\n  if (\n    colorByCDS &&\n    featureType === 'CDS' &&\n    featureStrand !== undefined &&\n    featurePhase !== undefined\n  ) {\n    const featureStart = feature.get('start')\n    const featureEnd = feature.get('end')\n\n    const frame = getFrame(\n      featureStart,\n      featureEnd,\n      featureStrand,\n      featurePhase,\n    )\n    const frameColor = theme.palette.framesCDS.at(frame)?.main\n    if (frameColor) {\n      fill = frameColor\n    }\n  }\n\n  return fill\n}\n\nexport function getStrokeColor({\n  feature,\n  config,\n  configContext,\n  theme,\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  configContext: RenderConfigContext\n  theme: Theme\n}) {\n  const { color2 } = configContext\n  const c = readCachedConfig(color2, config, 'color2', feature)\n  return c === '#f0f' ? stripAlpha(theme.palette.text.secondary) : c\n}\n","import { measureText } from '@jbrowse/core/util'\n\nimport { readCachedConfig } from './renderConfig.ts'\nimport { truncateLabel } from './util.ts'\n\nimport type { RenderConfigContext } from './renderConfig.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { FloatingLabelData } from '@jbrowse/plugin-linear-genome-view'\n\nconst FLOATING_LABEL_FONT_SIZE = 11\n\n/**\n * Create floating labels for a top-level feature (gene, etc.)\n *\n * Labels are positioned relative to the feature's visual bottom.\n * relativeY = 0 means the label starts at the feature's bottom edge.\n */\nexport function createFeatureFloatingLabels({\n  feature,\n  config,\n  configContext,\n  nameColor,\n  descriptionColor,\n  name: rawName,\n  description: rawDescription,\n}: {\n  feature: Feature\n  config: AnyConfigurationModel\n  configContext: RenderConfigContext\n  nameColor: string\n  descriptionColor: string\n  name: string\n  description: string\n}): FloatingLabelData[] {\n  const { showLabels, showDescriptions, fontHeight } = configContext\n\n  const name = truncateLabel(rawName)\n  const description = truncateLabel(rawDescription)\n\n  const shouldShowLabel = /\\S/.test(name) && showLabels\n  const shouldShowDescription = /\\S/.test(description) && showDescriptions\n\n  if (!shouldShowLabel && !shouldShowDescription) {\n    return []\n  }\n\n  const actualFontHeight = readCachedConfig(\n    fontHeight,\n    config,\n    ['labels', 'fontSize'],\n    feature,\n  )\n\n  const floatingLabels: FloatingLabelData[] = []\n\n  if (shouldShowLabel && shouldShowDescription) {\n    floatingLabels.push(\n      {\n        text: name,\n        relativeY: 0,\n        color: nameColor,\n        textWidth: measureText(name, FLOATING_LABEL_FONT_SIZE),\n      },\n      {\n        text: description,\n        relativeY: actualFontHeight,\n        color: descriptionColor,\n        textWidth: measureText(description, FLOATING_LABEL_FONT_SIZE),\n      },\n    )\n  } else if (shouldShowLabel) {\n    floatingLabels.push({\n      text: name,\n      relativeY: 0,\n      color: nameColor,\n      textWidth: measureText(name, FLOATING_LABEL_FONT_SIZE),\n    })\n  } else if (shouldShowDescription) {\n    floatingLabels.push({\n      text: description,\n      relativeY: 0,\n      color: descriptionColor,\n      textWidth: measureText(description, FLOATING_LABEL_FONT_SIZE),\n    })\n  }\n\n  return floatingLabels\n}\n\n/**\n * Create floating labels for a transcript subfeature\n *\n * For 'overlay' mode, labels are positioned at the top of the feature.\n * For 'below' mode, labels are positioned at the bottom.\n */\nexport function createTranscriptFloatingLabel({\n  displayLabel,\n  featureHeight,\n  subfeatureLabels,\n  color,\n  parentFeatureId,\n  subfeatureId,\n  tooltip,\n}: {\n  displayLabel: string\n  featureHeight: number\n  subfeatureLabels: string\n  color: string\n  parentFeatureId: string\n  subfeatureId: string\n  tooltip: string\n}): FloatingLabelData | null {\n  if (!displayLabel) {\n    return null\n  }\n\n  const truncatedName = truncateLabel(displayLabel)\n\n  // For 'overlay' mode, position label at top of feature (negative relativeY)\n  // For 'below' mode, position label at bottom of feature (relativeY = 0)\n  // The label Y formula is: featureTop + featureHeight + relativeY\n  // For overlay: we want featureTop + 2, so relativeY = 2 - featureHeight\n  const isOverlay = subfeatureLabels === 'overlay'\n  const relativeY = isOverlay ? 2 - featureHeight : 0\n\n  return {\n    text: truncatedName,\n    relativeY,\n    color,\n    textWidth: measureText(truncatedName, FLOATING_LABEL_FONT_SIZE),\n    isOverlay,\n    parentFeatureId,\n    subfeatureId,\n    tooltip,\n  }\n}\n\nexport { type FloatingLabelData } from '@jbrowse/plugin-linear-genome-view'\n","import { drawChevrons } from '../drawChevrons.ts'\nimport { readCachedConfig } from '../renderConfig.ts'\nimport { getStrokeColor, isOffScreen } from '../util.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport const STRAND_ARROW_WIDTH = 8\n\n/**\n * Compute padding needed for strand arrows.\n *\n * The effectiveStrand accounts for region reversal:\n * - effectiveStrand === -1: arrow points left visually (padding on visual left)\n * - effectiveStrand === 1: arrow points right visually (padding on visual right)\n */\nexport function getStrandArrowPadding(strand: number, reversed: boolean) {\n  const reverseFlip = reversed ? -1 : 1\n  const effectiveStrand = strand * reverseFlip\n  return {\n    left: effectiveStrand === -1 ? STRAND_ARROW_WIDTH : 0,\n    right: effectiveStrand === 1 ? STRAND_ARROW_WIDTH : 0,\n    visualSide:\n      effectiveStrand === -1 ? 'left' : effectiveStrand === 1 ? 'right' : null,\n    width: strand ? STRAND_ARROW_WIDTH : 0,\n  }\n}\n\n/**\n * Layout a child feature relative to its parent.\n * Returns a FeatureLayout with position relative to parent (local coordinates).\n */\nexport function layoutChild(\n  child: Feature,\n  parentFeature: Feature,\n  args: LayoutArgs,\n  glyphType = 'Box',\n): FeatureLayout {\n  const { bpPerPx, reversed, configContext } = args\n  const { config, displayMode, featureHeight } = configContext\n\n  const heightPx = readCachedConfig(featureHeight, config, 'height', child)\n  const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n\n  const childStart = child.get('start')\n  const childEnd = child.get('end')\n  const parentStart = parentFeature.get('start')\n  const parentEnd = parentFeature.get('end')\n\n  const widthPx = (childEnd - childStart) / bpPerPx\n\n  const offsetBp = reversed ? parentEnd - childEnd : childStart - parentStart\n  const xRelativePx = offsetBp / bpPerPx\n\n  return {\n    feature: child,\n    glyphType: glyphType as FeatureLayout['glyphType'],\n    x: xRelativePx,\n    y: 0,\n    width: widthPx,\n    height: baseHeightPx,\n    totalLayoutHeight: baseHeightPx,\n    totalLayoutWidth: widthPx,\n    leftPadding: 0,\n    children: [],\n  }\n}\n\n/**\n * Draw a horizontal connecting line (intron line).\n */\nexport function drawConnectingLine(\n  ctx: CanvasRenderingContext2D,\n  left: number,\n  top: number,\n  width: number,\n  height: number,\n  color: string,\n) {\n  const centerY = top + height / 2\n  ctx.strokeStyle = color\n  ctx.lineWidth = 1\n  ctx.beginPath()\n  ctx.moveTo(left, centerY)\n  ctx.lineTo(left + width, centerY)\n  ctx.stroke()\n}\n\n/**\n * Draw a strand direction arrow at a specific position.\n * This is the core arrow drawing logic shared by multiple glyphs.\n */\nexport function drawStrandArrowAtPosition(\n  ctx: CanvasRenderingContext2D,\n  left: number,\n  centerY: number,\n  width: number,\n  strand: number,\n  reversed: boolean,\n  color: string,\n) {\n  const arrowSize = 5\n  const reverseFlip = reversed ? -1 : 1\n  const arrowOffset = 7 * strand * reverseFlip\n\n  const arrowX =\n    strand * reverseFlip === -1\n      ? left\n      : strand * reverseFlip === 1\n        ? left + width\n        : null\n\n  if (arrowX !== null) {\n    ctx.strokeStyle = color\n    ctx.lineWidth = 1\n    ctx.beginPath()\n    ctx.moveTo(arrowX, centerY)\n    ctx.lineTo(arrowX + arrowOffset, centerY)\n    ctx.stroke()\n\n    ctx.fillStyle = color\n    ctx.beginPath()\n    ctx.moveTo(arrowX + arrowOffset / 2, centerY - arrowSize / 2)\n    ctx.lineTo(arrowX + arrowOffset / 2, centerY + arrowSize / 2)\n    ctx.lineTo(arrowX + arrowOffset, centerY)\n    ctx.closePath()\n    ctx.fill()\n  }\n}\n\n/**\n * Draw a strand direction arrow at the end of a feature.\n */\nexport function drawStrandArrow(\n  ctx: CanvasRenderingContext2D,\n  layout: FeatureLayout,\n  dc: DrawContext,\n  color: string,\n) {\n  const { feature } = layout\n  const { region, canvasWidth } = dc\n  const reversed = region.reversed ?? false\n\n  const left = layout.x\n  const width = layout.width\n\n  if (isOffScreen(left, width, canvasWidth)) {\n    return\n  }\n\n  const strand = feature.get('strand') as number\n  if (!strand) {\n    return\n  }\n\n  const centerY = layout.y + layout.height / 2\n  drawStrandArrowAtPosition(ctx, left, centerY, width, strand, reversed, color)\n}\n\n/**\n * Draw a segmented feature (ProcessedTranscript or Segments glyph).\n * Draws connecting line, chevrons, children, and strand arrow.\n */\nexport function drawSegmentedFeature(\n  ctx: CanvasRenderingContext2D,\n  layout: FeatureLayout,\n  dc: DrawContext,\n  boxGlyph: Glyph,\n  cdsGlyph: Glyph,\n) {\n  const { feature, children } = layout\n  const { region, configContext, theme, canvasWidth } = dc\n  const { config, displayDirectionalChevrons } = configContext\n  const reversed = region.reversed ?? false\n\n  const left = layout.x\n  const width = layout.width\n  const top = layout.y\n  const height = layout.height\n\n  if (isOffScreen(left, width, canvasWidth)) {\n    return\n  }\n\n  const strokeColor = getStrokeColor({\n    feature,\n    config,\n    configContext,\n    theme,\n  })\n\n  // Draw connecting line\n  drawConnectingLine(ctx, left, top, width, height, strokeColor)\n\n  // Draw chevrons if enabled\n  if (displayDirectionalChevrons) {\n    const strand = feature.get('strand') as number\n    if (strand) {\n      const effectiveStrand = reversed ? -strand : strand\n      drawChevrons(\n        ctx,\n        left,\n        top + height / 2,\n        width,\n        effectiveStrand,\n        strokeColor,\n      )\n    }\n  }\n\n  // Draw children (exons, CDS, UTRs)\n  for (const childLayout of children) {\n    if (childLayout.glyphType === 'CDS') {\n      cdsGlyph.draw(ctx, childLayout, dc)\n    } else {\n      boxGlyph.draw(ctx, childLayout, dc)\n    }\n  }\n\n  // Draw strand arrow\n  drawStrandArrow(ctx, layout, dc, strokeColor)\n}\n","/**\n * Draw directional chevrons along a line to indicate strand direction\n * @param ctx - Canvas rendering context\n * @param x - Starting X position\n * @param y - Y position (vertical center of the line)\n * @param width - Width of the line\n * @param strand - Strand direction (-1 for reverse, 1 for forward)\n * @param color - Stroke color for the chevrons\n * @param spacing - Spacing between chevrons (default 20)\n * @param size - Size of each chevron (default 4)\n */\nexport function drawChevrons(\n  ctx: CanvasRenderingContext2D,\n  x: number,\n  y: number,\n  width: number,\n  strand: number,\n  color: string,\n  spacing = 40,\n  size = 4,\n) {\n  if (strand === 0 || width < spacing) {\n    return\n  }\n\n  ctx.strokeStyle = color\n  ctx.lineWidth = 0.5\n  ctx.beginPath()\n\n  const halfSize = size / 2\n  const numChevrons = Math.floor(width / spacing)\n  const startOffset = (width - numChevrons * spacing) / 2 + spacing / 2\n\n  for (let i = 0; i < numChevrons; i++) {\n    const cx = x + startOffset + i * spacing\n    if (strand === 1) {\n      // Forward strand: > shape pointing right\n      ctx.moveTo(cx - halfSize, y - halfSize)\n      ctx.lineTo(cx + halfSize, y)\n      ctx.lineTo(cx - halfSize, y + halfSize)\n    } else {\n      // Reverse strand: < shape pointing left\n      ctx.moveTo(cx + halfSize, y - halfSize)\n      ctx.lineTo(cx - halfSize, y)\n      ctx.lineTo(cx + halfSize, y + halfSize)\n    }\n  }\n\n  ctx.stroke()\n}\n","import { readCachedConfig } from '../renderConfig.ts'\nimport { getBoxColor, getStrokeColor, isOffScreen, isUTR } from '../util.ts'\nimport { drawStrandArrow, getStrandArrowPadding } from './glyphUtils.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\n\nconst UTR_HEIGHT_FRACTION = 0.65\n\nexport const boxGlyph: Glyph = {\n  type: 'Box',\n\n  match(feature) {\n    const type = feature.get('type')\n    if (type === 'CDS') {\n      return false\n    }\n    const subfeatures = feature.get('subfeatures')\n    return !subfeatures?.length\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, reversed, configContext } = args\n    const { config, displayMode, featureHeight } = configContext\n\n    const height = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeight = displayMode === 'compact' ? height / 2 : height\n    const width = (feature.get('end') - feature.get('start')) / bpPerPx\n\n    const isTopLevel = !feature.parent?.()\n    const strand = feature.get('strand') as number\n    const arrowPadding = isTopLevel\n      ? getStrandArrowPadding(strand, reversed)\n      : { left: 0, right: 0 }\n\n    return {\n      feature,\n      glyphType: 'Box',\n      x: 0,\n      y: 0,\n      width,\n      height: baseHeight,\n      totalLayoutHeight: baseHeight,\n      totalLayoutWidth: width + arrowPadding.left + arrowPadding.right,\n      leftPadding: arrowPadding.left,\n      children: [],\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    const { feature } = layout\n    const { region, bpPerPx, configContext, theme, canvasWidth } = dc\n    const { config } = configContext\n    const colorByCDS = dc.colorByCDS ?? false\n\n    const { start, end } = region\n    const screenWidth = Math.ceil((end - start) / bpPerPx)\n    const width = layout.width\n    const left = layout.x\n\n    if (\n      isOffScreen(left, width, canvasWidth) ||\n      (feature.parent?.() && feature.get('type') === 'intron')\n    ) {\n      return\n    }\n\n    let top = layout.y\n    let height = layout.height\n\n    if (isUTR(feature)) {\n      top += ((1 - UTR_HEIGHT_FRACTION) / 2) * height\n      height *= UTR_HEIGHT_FRACTION\n    }\n\n    const leftWithinBlock = Math.max(left, 0)\n    const diff = leftWithinBlock - left\n    const widthWithinBlock = Math.max(2, Math.min(width - diff, screenWidth))\n\n    const fill = getBoxColor({\n      feature,\n      config,\n      configContext,\n      colorByCDS,\n      theme,\n    })\n\n    const stroke = readCachedConfig(\n      configContext.outline,\n      config,\n      'outline',\n      feature,\n    )\n\n    ctx.fillStyle = fill\n    ctx.fillRect(leftWithinBlock, top, widthWithinBlock, height)\n    if (stroke) {\n      ctx.strokeStyle = stroke\n      ctx.lineWidth = 1\n      ctx.strokeRect(leftWithinBlock, top, widthWithinBlock, height)\n    }\n\n    const isTopLevel = !feature.parent?.()\n    if (isTopLevel) {\n      const strokeColor = getStrokeColor({\n        feature,\n        config,\n        configContext,\n        theme,\n      })\n      drawStrandArrow(ctx, layout, dc, strokeColor)\n    }\n  },\n}\n","/**\n * Zoom thresholds for CDS peptide rendering\n */\n\n/**\n * Minimum zoom level (bp per pixel) to fetch peptide data and render amino acid backgrounds\n */\nexport const ZOOM_THRESHOLD_FOR_PEPTIDE_BACKGROUND = 1\n\n/**\n * Minimum zoom level (bp per pixel) to render amino acid text labels\n */\nexport const ZOOM_THRESHOLD_FOR_PEPTIDE_TEXT = 8\n\n/**\n * Check if zoomed in enough to render amino acid backgrounds\n */\nexport function shouldRenderPeptideBackground(bpPerPx: number): boolean {\n  return 1 / bpPerPx >= ZOOM_THRESHOLD_FOR_PEPTIDE_BACKGROUND\n}\n\n/**\n * Check if zoomed in enough to render amino acid text labels\n */\nexport function shouldRenderPeptideText(bpPerPx: number): boolean {\n  return 1 / bpPerPx >= ZOOM_THRESHOLD_FOR_PEPTIDE_TEXT\n}\n","import { drawCDSBackground } from '../peptides/drawCDSBackground.ts'\nimport { drawPeptidesOnCDS } from '../peptides/drawPeptidesOnCDS.ts'\nimport { prepareAminoAcidData } from '../peptides/prepareAminoAcidData.ts'\nimport { readCachedConfig } from '../renderConfig.ts'\nimport { getBoxColor, isOffScreen } from '../util.ts'\nimport {\n  shouldRenderPeptideBackground,\n  shouldRenderPeptideText,\n} from '../zoomThresholds.ts'\nimport { boxGlyph } from './box.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\n\nexport const cdsGlyph: Glyph = {\n  type: 'CDS',\n\n  match(feature) {\n    return feature.get('type') === 'CDS'\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, configContext } = args\n    const { config, displayMode, featureHeight } = configContext\n\n    const height = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeight = displayMode === 'compact' ? height / 2 : height\n    const width = (feature.get('end') - feature.get('start')) / bpPerPx\n\n    return {\n      feature,\n      glyphType: 'CDS',\n      x: 0,\n      y: 0,\n      width,\n      height: baseHeight,\n      totalLayoutHeight: baseHeight,\n      totalLayoutWidth: width,\n      leftPadding: 0,\n      children: [],\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    const { feature } = layout\n    const {\n      region,\n      bpPerPx,\n      configContext,\n      theme,\n      canvasWidth,\n      peptideDataMap,\n    } = dc\n    const { config } = configContext\n    const colorByCDS = dc.colorByCDS ?? false\n    const reversed = region.reversed ?? false\n\n    const featureStart = feature.get('start')\n    const featureEnd = feature.get('end')\n    const strand = feature.get('strand') as number\n    const width = layout.width\n    const left = layout.x\n    const top = layout.y\n    const height = layout.height\n\n    if (isOffScreen(left, width, canvasWidth)) {\n      return\n    }\n\n    const parent = feature.parent?.() ?? feature\n    const peptideData = peptideDataMap?.get(parent.id())\n    const protein = peptideData?.protein\n    const doRenderBackground =\n      shouldRenderPeptideBackground(bpPerPx) && colorByCDS && !!protein\n\n    if (doRenderBackground) {\n      const aggregatedAminoAcids = prepareAminoAcidData(\n        parent,\n        protein,\n        featureStart,\n        featureEnd,\n        strand,\n      )\n\n      const baseColor = getBoxColor({\n        feature,\n        config,\n        configContext,\n        colorByCDS,\n        theme,\n      })\n\n      drawCDSBackground({\n        ctx,\n        aggregatedAminoAcids,\n        baseColor,\n        left,\n        top,\n        width,\n        height,\n        bpPerPx,\n        strand,\n        reversed,\n        canvasWidth,\n      })\n\n      if (shouldRenderPeptideText(bpPerPx)) {\n        drawPeptidesOnCDS({\n          ctx,\n          aggregatedAminoAcids,\n          left,\n          top,\n          width,\n          height,\n          bpPerPx,\n          strand,\n          reversed,\n          canvasWidth,\n        })\n      }\n    } else {\n      // Fall back to box drawing\n      boxGlyph.draw(ctx, { ...layout, glyphType: 'Box' }, dc)\n    }\n  },\n}\n","import { genomeToTranscriptSeqMapping } from 'g2p_mapper'\n\nimport { aggregateAminos } from './aggregateAminoAcids.ts'\n\nimport type { Feature } from '@jbrowse/core/util'\n\nexport interface AggregatedAminoAcid {\n  aminoAcid: string\n  startIndex: number\n  endIndex: number\n  length: number\n  proteinIndex: number\n}\n\nexport function prepareAminoAcidData(\n  parent: Feature,\n  protein: string,\n  featureStart: number,\n  featureEnd: number,\n  strand: number,\n) {\n  return aggregateAminos(\n    protein,\n    // @ts-expect-error - g2p_mapper types\n    genomeToTranscriptSeqMapping(parent.toJSON()).g2p,\n    featureStart,\n    featureEnd,\n    strand,\n  )\n}\n","export interface AggregatedAminoAcid {\n  aminoAcid: string\n  startIndex: number\n  endIndex: number\n  length: number\n  proteinIndex: number\n}\n\n/**\n * Aggregates consecutive genomic positions that map to the same amino acid\n */\nexport function aggregateAminos(\n  protein: string,\n  g2p: Record<string, number>,\n  featureStart: number,\n  featureEnd: number,\n  strand: number,\n): AggregatedAminoAcid[] {\n  const aggregated: AggregatedAminoAcid[] = []\n  const len = featureEnd - featureStart\n\n  let currentElt: number | undefined = undefined\n  let currentAminoAcid: string | null = null\n  let startIndex = 0\n  let idx = 0\n\n  for (let i = 0; i < len; i++) {\n    const pos = strand === -1 ? featureEnd - i : featureStart + i\n    const elt = g2p[pos]\n    // Skip positions without mapping (incomplete sequence data)\n    if (elt === undefined) {\n      console.warn(`No g2p mapping for position ${pos}`)\n      continue\n    }\n    const aminoAcid = protein[elt] ?? '&'\n\n    if (currentElt === undefined) {\n      currentElt = elt\n      currentAminoAcid = aminoAcid\n      startIndex = idx\n    } else if (currentElt !== elt) {\n      aggregated.push({\n        aminoAcid: currentAminoAcid!,\n        startIndex,\n        endIndex: idx - 1,\n        length: idx - startIndex,\n        proteinIndex: currentElt,\n      })\n      currentElt = elt\n      currentAminoAcid = aminoAcid\n      startIndex = idx\n    }\n\n    idx++\n  }\n\n  if (currentAminoAcid !== null) {\n    aggregated.push({\n      aminoAcid: currentAminoAcid,\n      startIndex,\n      endIndex: idx - 1,\n      length: idx - startIndex,\n      proteinIndex: currentElt!,\n    })\n  }\n\n  return aggregated\n}\n","import { colord } from '@jbrowse/core/util/colord'\nimport { darken, lighten } from '@mui/material'\n\nimport { getEffectiveStrand, getStrandAwareX } from '../util.ts'\n\nimport type { AggregatedAminoAcid } from './prepareAminoAcidData.ts'\n\ninterface DrawCDSBackgroundArgs {\n  ctx: CanvasRenderingContext2D\n  aggregatedAminoAcids: AggregatedAminoAcid[]\n  baseColor: string\n  left: number\n  top: number\n  width: number\n  height: number\n  bpPerPx: number\n  strand: number\n  reversed: boolean\n  canvasWidth: number\n}\n\n/**\n * Draw the alternating colored background rectangles for amino acids on a CDS feature\n */\nexport function drawCDSBackground(args: DrawCDSBackgroundArgs) {\n  const {\n    ctx,\n    aggregatedAminoAcids,\n    baseColor,\n    left,\n    top,\n    width,\n    height,\n    bpPerPx,\n    strand,\n    reversed,\n    canvasWidth,\n  } = args\n\n  const effectiveStrand = getEffectiveStrand(strand, reversed)\n  const pxPerBp = 1 / bpPerPx\n  const baseHex = colord(baseColor).toHex()\n  const color1 = lighten(baseHex, 0.2)\n  const color2 = darken(baseHex, 0.1)\n\n  for (let i = 0, l = aggregatedAminoAcids.length; i < l; i++) {\n    const aa = aggregatedAminoAcids[i]!\n    const bgColor = i % 2 === 1 ? color2 : color1\n\n    const startX = getStrandAwareX(\n      left,\n      width,\n      aa.startIndex,\n      pxPerBp,\n      effectiveStrand,\n    )\n    const endX = getStrandAwareX(\n      left,\n      width,\n      aa.endIndex + 1,\n      pxPerBp,\n      effectiveStrand,\n    )\n    const rectLeft = Math.min(startX, endX)\n    const rectWidth = Math.abs(startX - endX)\n\n    if (rectLeft + rectWidth < 0 || rectLeft > canvasWidth) {\n      continue\n    }\n\n    ctx.fillStyle = bgColor\n    ctx.fillRect(rectLeft, top, rectWidth, height)\n  }\n}\n","import { getEffectiveStrand, getStrandAwareX } from '../util.ts'\n\nimport type { AggregatedAminoAcid } from './prepareAminoAcidData.ts'\n\ninterface DrawPeptidesArgs {\n  ctx: CanvasRenderingContext2D\n  aggregatedAminoAcids: AggregatedAminoAcid[]\n  left: number\n  top: number\n  width: number\n  height: number\n  bpPerPx: number\n  strand: number\n  reversed: boolean\n  canvasWidth: number\n}\n\n/**\n * Draw amino acid text labels on a CDS feature\n * This only draws the text, not the background rectangles\n */\nexport function drawPeptidesOnCDS(args: DrawPeptidesArgs) {\n  const {\n    ctx,\n    aggregatedAminoAcids,\n    left,\n    top,\n    width,\n    height,\n    bpPerPx,\n    strand,\n    reversed,\n    canvasWidth,\n  } = args\n\n  if (height < 8) {\n    return\n  }\n\n  const effectiveStrand = getEffectiveStrand(strand, reversed)\n  const pxPerBp = 1 / bpPerPx\n  const fontSize = height\n  ctx.font = `${fontSize}px sans-serif`\n  ctx.textAlign = 'center'\n  ctx.textBaseline = 'middle'\n\n  const yCenter = top + height / 2\n\n  for (const aa of aggregatedAminoAcids) {\n    const startX = getStrandAwareX(\n      left,\n      width,\n      aa.startIndex,\n      pxPerBp,\n      effectiveStrand,\n    )\n    const endX = getStrandAwareX(\n      left,\n      width,\n      aa.endIndex + 1,\n      pxPerBp,\n      effectiveStrand,\n    )\n    const x = (startX + endX) / 2\n\n    if (x < 0 || x > canvasWidth) {\n      continue\n    }\n\n    const isNonTriplet = aa.length % 3 !== 0 || aa.aminoAcid === '&'\n    ctx.fillStyle = isNonTriplet ? 'red' : 'black'\n    const text =\n      isNonTriplet || aa.aminoAcid === '*' || aa.aminoAcid === '&'\n        ? aa.aminoAcid\n        : `${aa.aminoAcid}${aa.proteinIndex + 1}`\n    ctx.fillText(text, x, yCenter)\n  }\n}\n","import { readCachedConfig } from '../renderConfig.ts'\nimport { isOffScreen } from '../util.ts'\nimport { drawStrandArrowAtPosition, layoutChild } from './glyphUtils.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nconst MATURE_PROTEIN_COLORS = [\n  '#1f77b4', // blue\n  '#ff7f0e', // orange\n  '#2ca02c', // green\n  '#d62728', // red\n  '#9467bd', // purple\n  '#8c564b', // brown\n  '#e377c2', // pink\n  '#7f7f7f', // gray\n  '#bcbd22', // olive\n  '#17becf', // cyan\n  '#aec7e8', // light blue\n  '#ffbb78', // light orange\n]\n\nconst MATURE_PROTEIN_TYPES = new Set([\n  'mature_protein_region_of_CDS',\n  'mature_protein_region',\n])\n\nfunction getMatureProteinChildren(feature: Feature): Feature[] {\n  const subfeatures = feature.get('subfeatures')\n  return (\n    subfeatures?.filter(sub => MATURE_PROTEIN_TYPES.has(sub.get('type'))) ?? []\n  )\n}\n\nfunction sortByPosition(children: FeatureLayout[]) {\n  return [...children].sort((a, b) => {\n    const aStart = a.feature.get('start')\n    const bStart = b.feature.get('start')\n    if (aStart !== bStart) {\n      return aStart - bStart\n    }\n    return b.feature.get('end') - a.feature.get('end')\n  })\n}\n\nexport const matureProteinRegionGlyph: Glyph = {\n  type: 'MatureProteinRegion',\n  hasIndexableChildren: true,\n\n  match(feature) {\n    if (feature.get('type') !== 'CDS') {\n      return false\n    }\n    return getMatureProteinChildren(feature).length > 0\n  },\n\n  getSubfeatureMouseover(feature: Feature) {\n    const product = feature.get('product') as string | undefined\n    const proteinId = feature.get('protein_id') as string | undefined\n    const parts: string[] = []\n    if (product) {\n      parts.push(product)\n    }\n    if (proteinId) {\n      parts.push(`(${proteinId})`)\n    }\n    return parts.length > 0 ? parts.join(' ') : undefined\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, configContext } = args\n    const { config, displayMode, featureHeight, subfeatureLabels } =\n      configContext\n\n    const start = feature.get('start')\n    const end = feature.get('end')\n    const heightPx = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n    const widthPx = (end - start) / bpPerPx\n\n    const matureProteins = getMatureProteinChildren(feature)\n    const children = matureProteins.map(child =>\n      layoutChild(child, feature, args),\n    )\n\n    // Sort children by position and assign row y-positions\n    const sortedChildren = sortByPosition(children)\n    const numRows = Math.max(1, sortedChildren.length)\n    const perRowMultiplier = subfeatureLabels === 'below' ? 2 : 1\n    const rowHeight = baseHeightPx * perRowMultiplier\n    const totalHeight = rowHeight * numRows\n\n    // Position each child in its row, accounting for padding and label space\n    const padding = 1\n    const boxHeight =\n      subfeatureLabels === 'below'\n        ? Math.floor(rowHeight / 2) - padding\n        : rowHeight - padding * 2\n\n    for (const [i, sortedChild] of sortedChildren.entries()) {\n      const child = sortedChild\n      child.y = i * rowHeight + padding\n      child.height = boxHeight\n      child.totalLayoutHeight = rowHeight\n    }\n\n    return {\n      feature,\n      glyphType: 'MatureProteinRegion',\n      x: 0,\n      y: 0,\n      width: widthPx,\n      height: totalHeight,\n      totalLayoutHeight: totalHeight,\n      totalLayoutWidth: widthPx,\n      leftPadding: 0,\n      children: sortedChildren,\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    const { children } = layout\n    const { region, theme, canvasWidth } = dc\n    const reversed = region.reversed ?? false\n    const arrowColor = theme.palette.text.secondary\n\n    for (const [i, childLayout] of children.entries()) {\n      const color = MATURE_PROTEIN_COLORS[i % MATURE_PROTEIN_COLORS.length]!\n      drawMatureProteinBox(\n        ctx,\n        childLayout,\n        canvasWidth,\n        color,\n        reversed,\n        arrowColor,\n      )\n    }\n  },\n}\n\nfunction drawMatureProteinBox(\n  ctx: CanvasRenderingContext2D,\n  childLayout: FeatureLayout,\n  canvasWidth: number,\n  color: string,\n  reversed: boolean,\n  arrowColor: string,\n) {\n  const { x: left, y: boxTop, width, height: boxHeight, feature } = childLayout\n\n  if (isOffScreen(left, width, canvasWidth)) {\n    return\n  }\n\n  ctx.fillStyle = color\n  ctx.fillRect(left, boxTop, width, boxHeight)\n\n  ctx.strokeStyle = 'rgba(0,0,0,0.3)'\n  ctx.lineWidth = 1\n  ctx.strokeRect(left, boxTop, width, boxHeight)\n\n  const strand = feature.get('strand') as number\n  if (strand) {\n    const centerY = boxTop + boxHeight / 2\n    drawStrandArrowAtPosition(\n      ctx,\n      left,\n      centerY,\n      width,\n      strand,\n      reversed,\n      arrowColor,\n    )\n  }\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { type Feature, SimpleFeature } from '@jbrowse/core/util'\n\nimport { isUTR } from './util.ts'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\n\nfunction makeSubpartsFilter(\n  confKey: string | string[],\n  config: AnyConfigurationModel,\n) {\n  const filter = readConfObject(config, confKey) as string[] | string\n  const ret = typeof filter === 'string' ? filter.split(/\\s*,\\s*/) : filter\n  const lowerRet = new Set(ret.map(t => t.toLowerCase()))\n\n  return (feature: Feature) => lowerRet.has(feature.get('type').toLowerCase())\n}\n\nexport function filterSubpart(feature: Feature, config: AnyConfigurationModel) {\n  return makeSubpartsFilter('subParts', config)(feature)\n}\n\nexport function makeUTRs(parent: Feature, subs: Feature[]) {\n  const subparts = [...subs]\n\n  let codeStart = Number.POSITIVE_INFINITY\n  let codeEnd = Number.NEGATIVE_INFINITY\n\n  let haveLeftUTR: boolean | undefined\n  let haveRightUTR: boolean | undefined\n\n  // gather exons, find coding start and end, and look for UTRs\n  const exons = []\n  for (const subpart of subparts) {\n    const type = subpart.get('type')\n    if (/^cds/i.test(type)) {\n      if (codeStart > subpart.get('start')) {\n        codeStart = subpart.get('start')\n      }\n      if (codeEnd < subpart.get('end')) {\n        codeEnd = subpart.get('end')\n      }\n    } else if (/exon/i.test(type)) {\n      exons.push(subpart)\n    } else if (isUTR(subpart)) {\n      haveLeftUTR = subpart.get('start') === parent.get('start')\n      haveRightUTR = subpart.get('end') === parent.get('end')\n    }\n  }\n\n  // bail if we don't have exons and CDS\n  if (\n    !(\n      exons.length &&\n      codeStart < Number.POSITIVE_INFINITY &&\n      codeEnd > Number.NEGATIVE_INFINITY\n    )\n  ) {\n    return subparts\n  }\n\n  // make sure the exons are sorted by coord\n  exons.sort((a, b) => a.get('start') - b.get('start'))\n\n  const strand = parent.get('strand')\n\n  // make the left-hand UTRs\n  let start: number | undefined\n  let end: number | undefined\n  if (!haveLeftUTR) {\n    for (const [i, exon] of exons.entries()) {\n      start = exon.get('start')\n      if (start >= codeStart) {\n        break\n      }\n      end = Math.min(codeStart, exon.get('end'))\n      const type = strand >= 0 ? 'five_prime_UTR' : 'three_prime_UTR'\n      subparts.unshift(\n        new SimpleFeature({\n          parent,\n          id: `${parent.id()}_${type}_${i}`,\n          data: { start, end, strand, type },\n        }),\n      )\n    }\n  }\n\n  // make the right-hand UTRs\n  if (!haveRightUTR) {\n    for (let i = exons.length - 1; i >= 0; i--) {\n      end = exons[i]!.get('end')\n      if (end <= codeEnd) {\n        break\n      }\n\n      start = Math.max(codeEnd, exons[i]!.get('start'))\n      const type = strand >= 0 ? 'three_prime_UTR' : 'five_prime_UTR'\n      subparts.push(\n        new SimpleFeature({\n          parent,\n          id: `${parent.id()}_${type}_${i}`,\n          data: { start, end, strand, type },\n        }),\n      )\n    }\n  }\n\n  return subparts\n}\n\nexport function getSubparts(f: Feature, config: AnyConfigurationModel) {\n  let c = f.get('subfeatures')\n  if (!c || c.length === 0) {\n    return []\n  }\n  const hasUTRs = c.some(child => isUTR(child))\n  const isTranscript = ['mRNA', 'transcript'].includes(f.get('type'))\n  const impliedUTRs = !hasUTRs && isTranscript\n\n  if (impliedUTRs || readConfObject(config, 'impliedUTRs')) {\n    c = makeUTRs(f, c)\n  }\n\n  const subpartFilter = makeSubpartsFilter('subParts', config)\n  return c.filter(subpartFilter)\n}\n","import { getSubparts } from '../filterSubparts.ts'\nimport { readCachedConfig } from '../renderConfig.ts'\nimport { boxGlyph } from './box.ts'\nimport { cdsGlyph } from './cds.ts'\nimport {\n  drawSegmentedFeature,\n  getStrandArrowPadding,\n  layoutChild,\n} from './glyphUtils.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport const processedTranscriptGlyph: Glyph = {\n  type: 'ProcessedTranscript',\n\n  match(feature, configContext) {\n    const type = feature.get('type')\n    const subfeatures = feature.get('subfeatures')\n    if (!subfeatures?.length) {\n      return false\n    }\n    const { transcriptTypes } = configContext\n    // Must be a transcript type with CDS children\n    if (!transcriptTypes.includes(type)) {\n      return false\n    }\n    const hasCDS = subfeatures.some((f: Feature) => f.get('type') === 'CDS')\n    return hasCDS\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, reversed, configContext } = args\n    const { config, displayMode, featureHeight } = configContext\n\n    const start = feature.get('start')\n    const end = feature.get('end')\n    const heightPx = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n    const widthPx = (end - start) / bpPerPx\n\n    const strand = feature.get('strand') as number\n    const arrowPadding = getStrandArrowPadding(strand, reversed)\n\n    // Get subparts with synthesized UTRs\n    const subparts = getSubparts(feature, config)\n    const children = subparts.map(child => {\n      const childType = child.get('type')\n      const glyphType = childType === 'CDS' ? 'CDS' : 'Box'\n      return layoutChild(child, feature, args, glyphType)\n    })\n\n    return {\n      feature,\n      glyphType: 'ProcessedTranscript',\n      x: 0,\n      y: 0,\n      width: widthPx,\n      height: baseHeightPx,\n      totalLayoutHeight: baseHeightPx,\n      totalLayoutWidth: widthPx + arrowPadding.left + arrowPadding.right,\n      leftPadding: arrowPadding.left,\n      children,\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    drawSegmentedFeature(ctx, layout, dc, boxGlyph, cdsGlyph)\n  },\n}\n","import { readCachedConfig } from '../renderConfig.ts'\nimport { isOffScreen } from '../util.ts'\nimport {\n  drawConnectingLine,\n  drawStrandArrow,\n  getStrandArrowPadding,\n  layoutChild,\n} from './glyphUtils.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\n\nconst REPEAT_COLOR_MAP: Record<string, string> = {\n  CACTA_TIR_transposon: '#e6194b',\n  centromeric_repeat: '#3cb44b',\n  Copia_LTR_retrotransposon: '#118119',\n  Gypsy_LTR_retrotransposon: '#4363d8',\n  hAT_TIR_transposon: '#f58231',\n  helitron: '#911eb4',\n  knob: '#46f0f0',\n  L1_LINE_retrotransposon: '#f032e6',\n  LINE_element: '#bcf60c',\n  long_terminal_repeat: '#fb0',\n  low_complexity: '#008080',\n  LTR_retrotransposon: '#e6beff',\n  Mutator_TIR_transposon: '#9a6324',\n  PIF_Harbinger_TIR_transposon: '#fffac8',\n  rDNA_intergenic_spacer_element: '#800000',\n  repeat_region: '#aaffc3',\n  RTE_LINE_retrotransposon: '#808000',\n  subtelomere: '#ffd8b1',\n  target_site_duplication: '#000075',\n  Tc1_Mariner_TIR_transposon: '#808080',\n}\n\nconst SHORTEN_HEIGHT_FRACTION = 0.65\n\nexport const repeatRegionGlyph: Glyph = {\n  type: 'RepeatRegion',\n\n  match(feature) {\n    const type = feature.get('type')\n    const subfeatures = feature.get('subfeatures')\n    return type === 'repeat_region' && !!subfeatures?.length\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, reversed, configContext } = args\n    const { config, displayMode, featureHeight } = configContext\n\n    const start = feature.get('start')\n    const end = feature.get('end')\n    const heightPx = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n    const widthPx = (end - start) / bpPerPx\n\n    const strand = feature.get('strand') as number\n    const arrowPadding = getStrandArrowPadding(strand, reversed)\n\n    const subfeatures = feature.get('subfeatures') || []\n    const children = subfeatures.map(child => layoutChild(child, feature, args))\n\n    return {\n      feature,\n      glyphType: 'RepeatRegion',\n      x: 0,\n      y: 0,\n      width: widthPx,\n      height: baseHeightPx,\n      totalLayoutHeight: baseHeightPx,\n      totalLayoutWidth: widthPx + arrowPadding.left + arrowPadding.right,\n      leftPadding: arrowPadding.left,\n      children,\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    const { children } = layout\n    const { theme, canvasWidth } = dc\n\n    const left = layout.x\n    const width = layout.width\n    const top = layout.y\n    const height = layout.height\n\n    if (isOffScreen(left, width, canvasWidth)) {\n      return\n    }\n\n    const strokeColor = theme.palette.text.secondary\n\n    // Draw connecting line\n    drawConnectingLine(ctx, left, top, width, height, strokeColor)\n\n    // Sort children so retrotransposons are drawn first (underneath)\n    const sortedChildren = [...children].sort((a, b) => {\n      const aType = a.feature.get('type') as string\n      const bType = b.feature.get('type') as string\n      if (aType.endsWith('_retrotransposon')) {\n        return -1\n      }\n      if (bType.endsWith('_retrotransposon')) {\n        return 1\n      }\n      return 0\n    })\n\n    // Draw children\n    for (const childLayout of sortedChildren) {\n      const childType = childLayout.feature.get('type') as string\n      const color = REPEAT_COLOR_MAP[childType] || '#000'\n      const shorten = childType.endsWith('_retrotransposon')\n      drawRepeatBox(ctx, childLayout, canvasWidth, color, shorten)\n    }\n\n    // Draw strand arrow\n    drawStrandArrow(ctx, layout, dc, strokeColor)\n  },\n}\n\nfunction drawRepeatBox(\n  ctx: CanvasRenderingContext2D,\n  layout: FeatureLayout,\n  canvasWidth: number,\n  color: string,\n  shorten: boolean,\n) {\n  const { x: left, width, y, height: origHeight } = layout\n\n  if (isOffScreen(left, width, canvasWidth)) {\n    return\n  }\n\n  let top = y\n  let height = origHeight\n\n  if (shorten) {\n    top += ((1 - SHORTEN_HEIGHT_FRACTION) / 2) * height\n    height *= SHORTEN_HEIGHT_FRACTION\n  }\n\n  ctx.fillStyle = color\n  ctx.fillRect(left, top, width, height)\n}\n","import { readCachedConfig } from '../renderConfig.ts'\nimport { boxGlyph } from './box.ts'\nimport { cdsGlyph } from './cds.ts'\nimport {\n  drawSegmentedFeature,\n  getStrandArrowPadding,\n  layoutChild,\n} from './glyphUtils.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nexport const segmentsGlyph: Glyph = {\n  type: 'Segments',\n\n  match(feature, configContext) {\n    const type = feature.get('type')\n    if (type === 'CDS') {\n      return false\n    }\n    const subfeatures = feature.get('subfeatures')\n    if (!subfeatures?.length) {\n      return false\n    }\n    const { transcriptTypes, containerTypes } = configContext\n    // Not a coding transcript (those use ProcessedTranscript)\n    if (transcriptTypes.includes(type)) {\n      const hasCDS = subfeatures.some((f: Feature) => f.get('type') === 'CDS')\n      if (hasCDS) {\n        return false\n      }\n    }\n    // Not a container (gene)\n    if (containerTypes.includes(type)) {\n      return false\n    }\n    // Not a top-level feature with nested subfeatures\n    const isTopLevel = !feature.parent?.()\n    const hasNestedSubfeatures = subfeatures.some(\n      (f: Feature) => f.get('subfeatures')?.length,\n    )\n    if (isTopLevel && hasNestedSubfeatures) {\n      return false\n    }\n    return true\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, reversed, configContext } = args\n    const { config, displayMode, featureHeight } = configContext\n\n    const start = feature.get('start')\n    const end = feature.get('end')\n    const heightPx = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n    const widthPx = (end - start) / bpPerPx\n\n    const strand = feature.get('strand') as number\n    const arrowPadding = getStrandArrowPadding(strand, reversed)\n\n    const subfeatures = feature.get('subfeatures') || []\n    const children = subfeatures.map(child => {\n      const childType = child.get('type')\n      const glyphType = childType === 'CDS' ? 'CDS' : 'Box'\n      return layoutChild(child, feature, args, glyphType)\n    })\n\n    return {\n      feature,\n      glyphType: 'Segments',\n      x: 0,\n      y: 0,\n      width: widthPx,\n      height: baseHeightPx,\n      totalLayoutHeight: baseHeightPx,\n      totalLayoutWidth: widthPx + arrowPadding.left + arrowPadding.right,\n      leftPadding: arrowPadding.left,\n      children,\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    drawSegmentedFeature(ctx, layout, dc, boxGlyph, cdsGlyph)\n  },\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { measureText } from '@jbrowse/core/util'\n\nimport { readCachedConfig } from './renderConfig.ts'\nimport { truncateLabel } from './util.ts'\n\nimport type { RenderConfigContext } from './renderConfig.ts'\nimport type { FeatureLayout } from './types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\n/**\n * Calculate label dimensions and update layout accordingly.\n */\nexport function applyLabelDimensions(\n  layout: FeatureLayout,\n  args: {\n    feature: Feature\n    configContext: RenderConfigContext\n    isNested: boolean\n    isTranscriptChild: boolean\n  },\n): void {\n  const { feature, configContext, isNested, isTranscriptChild } = args\n  const {\n    config,\n    showLabels,\n    showDescriptions,\n    subfeatureLabels,\n    fontHeight,\n    labelAllowed,\n  } = configContext\n\n  const showSubfeatureLabels = subfeatureLabels !== 'none'\n  const shouldCalculateLabels =\n    labelAllowed && (!isNested || (isTranscriptChild && showSubfeatureLabels))\n\n  if (!shouldCalculateLabels) {\n    return\n  }\n\n  const effectiveShowLabels = isTranscriptChild ? true : showLabels\n  const effectiveShowDescriptions = isTranscriptChild ? false : showDescriptions\n\n  const name = truncateLabel(\n    String(readConfObject(config, ['labels', 'name'], { feature }) || ''),\n  )\n  const shouldShowName = /\\S/.test(name) && effectiveShowLabels\n\n  const description = truncateLabel(\n    String(\n      readConfObject(config, ['labels', 'description'], { feature }) || '',\n    ),\n  )\n  const shouldShowDescription =\n    /\\S/.test(description) && effectiveShowDescriptions\n\n  const actualFontHeight = readCachedConfig(\n    fontHeight,\n    config,\n    ['labels', 'fontSize'],\n    feature,\n  )\n\n  let extraHeightPx = 0\n  let maxLabelWidthPx = 0\n\n  if (shouldShowName) {\n    extraHeightPx += actualFontHeight\n    maxLabelWidthPx = Math.max(\n      maxLabelWidthPx,\n      measureText(name, actualFontHeight),\n    )\n  }\n  if (shouldShowDescription) {\n    extraHeightPx += actualFontHeight\n    maxLabelWidthPx = Math.max(\n      maxLabelWidthPx,\n      measureText(description, actualFontHeight),\n    )\n  }\n\n  const isOverlayMode = isTranscriptChild && subfeatureLabels === 'overlay'\n  if (!isOverlayMode) {\n    layout.totalLayoutHeight = layout.height + extraHeightPx\n  }\n\n  layout.totalLayoutWidth = Math.max(layout.totalLayoutWidth, maxLabelWidthPx)\n}\n","import { boxGlyph } from './box.ts'\nimport { cdsGlyph } from './cds.ts'\nimport { findGlyph } from './index.ts'\nimport { matureProteinRegionGlyph } from './matureProteinRegion.ts'\nimport { processedTranscriptGlyph } from './processed.ts'\nimport { repeatRegionGlyph } from './repeatRegion.ts'\nimport { segmentsGlyph } from './segments.ts'\n\nimport type { RenderConfigContext } from '../renderConfig.ts'\nimport type { Glyph } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\n// Glyphs that can be used as children of container glyphs (like genes).\n// This list excludes subfeaturesGlyph to avoid circular dependency.\n// Order matters - more specific glyphs first.\nexport const childGlyphs: Glyph[] = [\n  matureProteinRegionGlyph,\n  repeatRegionGlyph,\n  cdsGlyph,\n  processedTranscriptGlyph,\n  segmentsGlyph,\n  boxGlyph, // fallback - matches everything\n]\n\nexport function findChildGlyph(\n  feature: Feature,\n  configContext: RenderConfigContext,\n): Glyph {\n  return findGlyph(feature, configContext, childGlyphs)\n}\n","import { applyLabelDimensions } from '../labelUtils.ts'\nimport { readCachedConfig } from '../renderConfig.ts'\nimport { boxGlyph } from './box.ts'\nimport { findChildGlyph } from './childGlyphs.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph, LayoutArgs } from '../types.ts'\nimport type { Feature } from '@jbrowse/core/util'\n\nconst TRANSCRIPT_PADDING = 2\nconst CODING_TYPES = new Set(['CDS', 'cds'])\n\nfunction hasCodingSubfeature(feature: Feature): boolean {\n  const subfeatures = feature.get('subfeatures') || []\n  return subfeatures.some(\n    (sub: Feature) =>\n      CODING_TYPES.has(sub.get('type')) || hasCodingSubfeature(sub),\n  )\n}\n\nfunction filterByGeneGlyphMode(\n  subfeatures: Feature[],\n  transcriptTypes: string[],\n  mode: 'longest' | 'longestCoding',\n): Feature[] {\n  if (subfeatures.length <= 1) {\n    return subfeatures\n  }\n\n  const transcriptSubfeatures = subfeatures.filter(sub =>\n    transcriptTypes.includes(sub.get('type')),\n  )\n  let candidates =\n    transcriptSubfeatures.length > 0 ? transcriptSubfeatures : subfeatures\n\n  if (mode === 'longestCoding') {\n    const codingCandidates = candidates.filter(hasCodingSubfeature)\n    if (codingCandidates.length > 0) {\n      candidates = codingCandidates\n    }\n  }\n\n  const longest = candidates.reduce((a, b) =>\n    a.get('end') - a.get('start') > b.get('end') - b.get('start') ? a : b,\n  )\n  return [longest]\n}\n\nexport const subfeaturesGlyph: Glyph = {\n  type: 'Subfeatures',\n\n  match(feature, configContext) {\n    const type = feature.get('type')\n    const subfeatures = feature.get('subfeatures')\n    if (!subfeatures?.length) {\n      return false\n    }\n\n    const { containerTypes } = configContext\n\n    // Explicit container type\n    if (containerTypes.includes(type)) {\n      return true\n    }\n\n    // Top-level feature with nested subfeatures (gene-like)\n    const isTopLevel = !feature.parent?.()\n    const hasNestedSubfeatures = subfeatures.some(\n      (f: Feature) => f.get('subfeatures')?.length,\n    )\n    return isTopLevel && hasNestedSubfeatures\n  },\n\n  layout(args: LayoutArgs): FeatureLayout {\n    const { feature, bpPerPx, reversed, configContext } = args\n    const {\n      config,\n      displayMode,\n      featureHeight,\n      geneGlyphMode,\n      transcriptTypes,\n    } = configContext\n\n    const featureBp = {\n      start: feature.get('start'),\n      end: feature.get('end'),\n    }\n    const heightPx = readCachedConfig(featureHeight, config, 'height', feature)\n    const baseHeightPx = displayMode === 'compact' ? heightPx / 2 : heightPx\n    const widthPx = (featureBp.end - featureBp.start) / bpPerPx\n\n    // Get and sort subfeatures (coding first)\n    // Pre-compute CDS status to avoid O(N log N) complexity during sort\n    let subfeatures = [...(feature.get('subfeatures') || [])] as Feature[]\n    const codingStatus = new Map(\n      subfeatures.map(f => [f.id(), hasCodingSubfeature(f)]),\n    )\n    subfeatures.sort((a, b) => {\n      const aHasCDS = codingStatus.get(a.id())\n      const bHasCDS = codingStatus.get(b.id())\n      if (aHasCDS && !bHasCDS) {\n        return -1\n      }\n      if (!aHasCDS && bHasCDS) {\n        return 1\n      }\n      return 0\n    })\n\n    // Apply gene glyph mode filtering\n    if (geneGlyphMode === 'longest' || geneGlyphMode === 'longestCoding') {\n      subfeatures = filterByGeneGlyphMode(\n        subfeatures,\n        transcriptTypes,\n        geneGlyphMode,\n      )\n    }\n\n    // Stack children vertically\n    const children: FeatureLayout[] = []\n    let currentYPx = 0\n    const { subfeatureLabels } = configContext\n\n    for (let i = 0; i < subfeatures.length; i++) {\n      const child = subfeatures[i]!\n      const childType = child.get('type')\n      const isChildTranscript = transcriptTypes.includes(childType)\n      const childGlyph = findChildGlyph(child, configContext)\n\n      // Layout child using its glyph's layout function\n      const childLayout = childGlyph.layout({\n        ...args,\n        feature: child,\n        parentFeature: feature,\n      })\n\n      // Apply label dimensions to child (for transcript labels)\n      applyLabelDimensions(childLayout, {\n        feature: child,\n        configContext,\n        isNested: true,\n        isTranscriptChild: isChildTranscript,\n      })\n\n      // Position relative to parent\n      const childBp = {\n        start: child.get('start'),\n        end: child.get('end'),\n      }\n      const offsetBp = reversed\n        ? featureBp.end - childBp.end\n        : childBp.start - featureBp.start\n      const xRelativePx = offsetBp / bpPerPx\n\n      childLayout.x = xRelativePx\n      childLayout.y = currentYPx\n\n      children.push(childLayout)\n\n      // Use totalLayoutHeight when labels are below, otherwise just height\n      const useExtraHeightForLabels =\n        subfeatureLabels === 'below' && isChildTranscript\n      const heightForStacking = useExtraHeightForLabels\n        ? childLayout.totalLayoutHeight\n        : childLayout.height\n      currentYPx += heightForStacking\n      if (i < subfeatures.length - 1) {\n        currentYPx += TRANSCRIPT_PADDING\n      }\n    }\n\n    const totalHeightPx = currentYPx > 0 ? currentYPx : baseHeightPx\n\n    return {\n      feature,\n      glyphType: 'Subfeatures',\n      x: 0,\n      y: 0,\n      width: widthPx,\n      height: totalHeightPx,\n      totalLayoutHeight: totalHeightPx,\n      totalLayoutWidth: widthPx,\n      leftPadding: 0,\n      children,\n    }\n  },\n\n  draw(ctx: CanvasRenderingContext2D, layout: FeatureLayout, dc: DrawContext) {\n    const { children } = layout\n\n    if (children.length === 0) {\n      boxGlyph.draw(ctx, { ...layout, glyphType: 'Box' }, dc)\n      return\n    }\n\n    // All coordinates are already absolute - just draw each child\n    for (const childLayout of children) {\n      const childGlyph = findChildGlyph(childLayout.feature, dc.configContext)\n      childGlyph.draw(ctx, childLayout, dc)\n    }\n  },\n}\n","import { boxGlyph } from './box.ts'\nimport { cdsGlyph } from './cds.ts'\nimport { matureProteinRegionGlyph } from './matureProteinRegion.ts'\nimport { processedTranscriptGlyph } from './processed.ts'\nimport { repeatRegionGlyph } from './repeatRegion.ts'\nimport { segmentsGlyph } from './segments.ts'\nimport { subfeaturesGlyph } from './subfeatures.ts'\n\nimport type { RenderConfigContext } from '../renderConfig.ts'\nimport type { Glyph } from '../types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type GlyphType from '@jbrowse/core/pluggableElementTypes/GlyphType'\nimport type { Feature } from '@jbrowse/core/util'\n\n// Glyphs in priority order (first match wins)\n// More specific glyphs should come before more general ones\nexport const builtinGlyphs: Glyph[] = [\n  matureProteinRegionGlyph, // CDS with mature protein regions\n  repeatRegionGlyph, // repeat_region with subfeatures\n  cdsGlyph,\n  processedTranscriptGlyph,\n  subfeaturesGlyph,\n  segmentsGlyph,\n  boxGlyph, // fallback - matches everything\n]\n\n/**\n * Find the glyph that matches the given feature.\n * Returns the first matching glyph from the registry.\n */\nexport function findGlyph(\n  feature: Feature,\n  configContext: RenderConfigContext,\n  glyphs: Glyph[] = builtinGlyphs,\n): Glyph {\n  const match = glyphs.find(g => g.match(feature, configContext))\n  // boxGlyph is the fallback and matches everything\n  return match ?? boxGlyph\n}\n\n/**\n * Find a matching pluggable glyph from the plugin manager.\n * Pluggable glyphs take priority over builtin glyphs.\n */\nexport function findPluggableGlyph(\n  feature: Feature,\n  pluginManager?: PluginManager,\n): GlyphType | undefined {\n  if (!pluginManager) {\n    return undefined\n  }\n  const glyphTypes = pluginManager.getGlyphTypes()\n  const sortedGlyphs = [...glyphTypes].sort((a, b) => b.priority - a.priority)\n  return sortedGlyphs.find(glyph => glyph.match?.(feature))\n}\n\n// Only export boxGlyph for use as fallback in drawFeature.ts\nexport { boxGlyph } from './box.ts'\n","import {\n  builtinGlyphs,\n  findGlyph,\n  findPluggableGlyph,\n} from '../glyphs/index.ts'\nimport { applyLabelDimensions } from '../labelUtils.ts'\n\nimport type { RenderConfigContext } from '../renderConfig.ts'\nimport type { FeatureLayout, LayoutArgs } from '../types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\n\n// Re-export for backwards compatibility\nexport { applyLabelDimensions } from '../labelUtils.ts'\n\n/**\n * Layout a feature using the polymorphic glyph system.\n *\n * Phase 1 of the two-phase rendering:\n * 1. Find the matching glyph for the feature\n * 2. Call the glyph's layout function to allocate its rectangle\n * 3. Apply label dimensions\n */\nexport function layoutFeature(args: {\n  feature: Feature\n  bpPerPx: number\n  reversed: boolean\n  configContext: RenderConfigContext\n  pluginManager?: PluginManager\n  isNested?: boolean\n  isTranscriptChild?: boolean\n}): FeatureLayout {\n  const {\n    feature,\n    bpPerPx,\n    reversed,\n    configContext,\n    pluginManager,\n    isNested = false,\n    isTranscriptChild = false,\n  } = args\n\n  // Check for pluggable glyph first (higher priority)\n  const pluggableGlyph = findPluggableGlyph(feature, pluginManager)\n\n  let layout: FeatureLayout\n\n  if (pluggableGlyph) {\n    // Use pluggable glyph's layout (legacy interface)\n    // TODO: Migrate pluggable glyphs to new Glyph interface\n    const heightMultiplier =\n      pluggableGlyph.getHeightMultiplier?.(feature, configContext.config) ?? 1\n    const baseGlyph = findGlyph(feature, configContext, builtinGlyphs)\n\n    const layoutArgs: LayoutArgs = {\n      feature,\n      bpPerPx,\n      reversed,\n      configContext,\n      pluginManager,\n    }\n\n    layout = baseGlyph.layout(layoutArgs)\n\n    // Apply height multiplier from pluggable glyph\n    layout.height *= heightMultiplier\n    layout.totalLayoutHeight *= heightMultiplier\n  } else {\n    // Use builtin polymorphic glyph\n    const glyph = findGlyph(feature, configContext, builtinGlyphs)\n\n    const layoutArgs: LayoutArgs = {\n      feature,\n      bpPerPx,\n      reversed,\n      configContext,\n      pluginManager,\n    }\n\n    layout = glyph.layout(layoutArgs)\n  }\n\n  // Apply label dimensions\n  applyLabelDimensions(layout, {\n    feature,\n    configContext,\n    isNested,\n    isTranscriptChild,\n  })\n\n  return layout\n}\n","import { boxGlyph, builtinGlyphs, findPluggableGlyph } from './glyphs/index.ts'\n\nimport type { DrawContext, FeatureLayout, Glyph } from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n// Auto-generate glyph map from builtin glyphs\nconst glyphMap: Record<string, Glyph> = Object.fromEntries(\n  builtinGlyphs.map(g => [g.type, g]),\n)\n\n/**\n * Draw a feature using the polymorphic glyph system.\n *\n * Phase 2 of the two-phase rendering:\n * 1. Look up the glyph by type from the layout\n * 2. Call the glyph's draw function\n *\n * The layout already contains the allocated rectangle - the glyph\n * just draws itself within that space.\n */\nexport function drawFeature(\n  ctx: CanvasRenderingContext2D,\n  layout: FeatureLayout,\n  drawContext: DrawContext,\n  pluginManager?: PluginManager,\n): void {\n  // Check for pluggable glyph first\n  const pluggableGlyph = findPluggableGlyph(layout.feature, pluginManager)\n\n  if (pluggableGlyph) {\n    // Use pluggable glyph's draw (legacy interface)\n    pluggableGlyph.draw({\n      ctx,\n      feature: layout.feature,\n      featureLayout: layout,\n      region: drawContext.region,\n      bpPerPx: drawContext.bpPerPx,\n      config: drawContext.configContext.config,\n      theme: drawContext.theme,\n      reversed: drawContext.region.reversed ?? false,\n      topLevel: true,\n      canvasWidth: drawContext.canvasWidth,\n    })\n    return\n  }\n\n  // Use builtin glyph based on layout's glyphType\n  const glyph = glyphMap[layout.glyphType]\n  if (glyph) {\n    glyph.draw(ctx, layout, drawContext)\n  } else {\n    // Fallback to box\n    boxGlyph.draw(ctx, layout, drawContext)\n  }\n}\n","import type { ExportSvgOptions } from '../LinearGenomeView/types.ts'\nimport type { ThemeOptions } from '@mui/material'\n\nexport interface Layout {\n  minX: number\n  minY: number\n  maxX: number\n  maxY: number\n  name: string\n}\n\nexport interface FloatingLabelData {\n  text: string\n  relativeY: number\n  color: string\n  textWidth: number\n  isOverlay?: boolean\n  parentFeatureId?: string\n  subfeatureId?: string\n  tooltip?: string\n}\n\n/**\n * Metadata attached to layout rectangles for floating label rendering.\n * Used by both parent features and subfeatures.\n */\nexport interface LayoutFeatureMetadata {\n  label?: string\n  description?: string\n  refName: string\n  floatingLabels?: FloatingLabelData[]\n  totalFeatureHeight?: number\n  totalLayoutWidth?: number\n  featureWidth?: number\n  actualTopPx?: number\n  /** Actual feature start in bp (not layout start which includes padding) */\n  featureStartBp?: number\n  /** Actual feature end in bp (not layout end which includes padding) */\n  featureEndBp?: number\n}\n\n/**\n * Creates metadata for floating label rendering on subfeatures.\n */\nexport function createSubfeatureLabelMetadata(args: {\n  refName: string\n  floatingLabels: FloatingLabelData[]\n  totalFeatureHeight: number\n  totalLayoutWidth: number\n  featureWidth: number\n  actualTopPx: number\n  featureStartBp: number\n  featureEndBp: number\n}): LayoutFeatureMetadata {\n  return { ...args }\n}\n\nexport type LayoutRecord =\n  | [number, number, number, number]\n  | [number, number, number, number, LayoutFeatureMetadata]\n\nexport interface ExportSvgDisplayOptions extends ExportSvgOptions {\n  overrideHeight?: number\n  theme?: ThemeOptions\n  legendWidth?: number\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { createSubfeatureLabelMetadata } from '@jbrowse/plugin-linear-genome-view'\n\nimport { createTranscriptFloatingLabel } from '../floatingLabels.ts'\nimport { builtinGlyphs } from '../glyphs/index.ts'\n\nimport type { FloatingLabelData } from '../floatingLabels.ts'\nimport type { RenderConfigContext } from '../renderConfig.ts'\nimport type { FeatureLayout, SubfeatureInfo } from '../types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { BaseLayout } from '@jbrowse/core/util/layouts'\n\n/**\n * Convert a layout from local coordinates to canvas coordinates.\n * During layout, children are positioned relative to their parent.\n * This function recursively resolves those to final canvas pixel positions.\n */\nexport function convertToCanvasCoords(\n  layout: FeatureLayout,\n  offsetX: number,\n  offsetY: number,\n): FeatureLayout {\n  const canvasX = offsetX + layout.x\n  const canvasY = offsetY + layout.y\n  return {\n    ...layout,\n    x: canvasX,\n    y: canvasY,\n    children: layout.children.map(child =>\n      convertToCanvasCoords(child, canvasX, canvasY),\n    ),\n  }\n}\n\n// Unified interface for glyphs that provide custom mouseover\ninterface GlyphWithMouseover {\n  getSubfeatureMouseover?: (feature: Feature) => string | undefined\n}\n\nfunction findMatchingGlyph(\n  feature: Feature,\n  configContext: RenderConfigContext,\n  pluginManager?: PluginManager,\n): GlyphWithMouseover | undefined {\n  // Check builtin glyphs first\n  const builtinMatch = builtinGlyphs.find(\n    glyph => glyph.hasIndexableChildren && glyph.match(feature, configContext),\n  )\n  if (builtinMatch) {\n    return builtinMatch\n  }\n\n  // Check pluggable glyphs\n  if (pluginManager) {\n    const glyphTypes = pluginManager.getGlyphTypes()\n    const sortedGlyphs = [...glyphTypes].sort((a, b) => b.priority - a.priority)\n    const pluggableMatch = sortedGlyphs.find(\n      glyph => glyph.match?.(feature) && glyph.getChildFeatures,\n    )\n    if (pluggableMatch) {\n      return pluggableMatch\n    }\n  }\n\n  return undefined\n}\n\n/**\n * Build subfeature index for hit detection and floating labels.\n *\n * This unified function handles:\n * 1. Gene+transcript patterns (filters by transcriptTypes)\n * 2. Builtin glyphs with hasIndexableChildren (e.g., MatureProteinRegion)\n * 3. Pluggable glyphs with getChildFeatures\n *\n * All use the children's actual layout positions.\n */\nexport function buildChildrenIndex({\n  layout,\n  featureLayout,\n  subfeatureCoords,\n  subfeatureInfos,\n  config,\n  configContext,\n  pluginManager,\n  subfeatureLabels,\n  transcriptTypes,\n  labelColor,\n  parentTooltip,\n}: {\n  layout: BaseLayout<unknown>\n  featureLayout: FeatureLayout\n  subfeatureCoords: number[]\n  subfeatureInfos: SubfeatureInfo[]\n  config: AnyConfigurationModel\n  configContext: RenderConfigContext\n  pluginManager?: PluginManager\n  subfeatureLabels: string\n  transcriptTypes: string[]\n  labelColor: string\n  parentTooltip: string\n}) {\n  addChildrenRecursive({\n    layout,\n    featureLayout,\n    subfeatureCoords,\n    subfeatureInfos,\n    config,\n    configContext,\n    pluginManager,\n    subfeatureLabels,\n    transcriptTypes,\n    labelColor,\n    parentTooltip,\n  })\n}\n\nfunction addChildrenRecursive({\n  layout,\n  featureLayout,\n  subfeatureCoords,\n  subfeatureInfos,\n  config,\n  configContext,\n  pluginManager,\n  subfeatureLabels,\n  transcriptTypes,\n  labelColor,\n  parentTooltip,\n}: {\n  layout: BaseLayout<unknown>\n  featureLayout: FeatureLayout\n  subfeatureCoords: number[]\n  subfeatureInfos: SubfeatureInfo[]\n  config: AnyConfigurationModel\n  configContext: RenderConfigContext\n  pluginManager?: PluginManager\n  subfeatureLabels: string\n  transcriptTypes: string[]\n  labelColor: string\n  parentTooltip: string\n}) {\n  const feature = featureLayout.feature\n  const featureType = feature.get('type')\n  const isGene = featureType === 'gene'\n\n  // Check if a glyph wants its children indexed\n  const matchingGlyph = findMatchingGlyph(feature, configContext, pluginManager)\n\n  // Check for gene+transcript pattern\n  const hasTranscriptChildren =\n    isGene &&\n    featureLayout.children.some(child =>\n      transcriptTypes.includes(child.feature.get('type')),\n    )\n\n  const shouldIndexChildren = matchingGlyph || hasTranscriptChildren\n  const showSubfeatureLabels = subfeatureLabels !== 'none'\n\n  if (shouldIndexChildren) {\n    for (const child of featureLayout.children) {\n      const childFeature = child.feature\n      const childType = childFeature.get('type') as string\n\n      // For gene+transcript pattern, only index transcripts\n      if (hasTranscriptChildren && !matchingGlyph) {\n        if (!transcriptTypes.includes(childType)) {\n          continue\n        }\n      }\n\n      // Use child's actual layout position\n      const leftPx = child.x\n      const rightPx = child.x + child.totalLayoutWidth\n      const topPx = child.y\n      const bottomPx = child.y + child.totalLayoutHeight\n\n      subfeatureCoords.push(leftPx, topPx, rightPx, bottomPx)\n\n      // Get mouseover text - prefer glyph's custom mouseover\n      const glyphMouseover =\n        matchingGlyph?.getSubfeatureMouseover?.(childFeature)\n      const displayLabel =\n        glyphMouseover ??\n        String(\n          readConfObject(config, 'subfeatureMouseover', {\n            feature: childFeature,\n          }) || '',\n        )\n\n      subfeatureInfos.push({\n        featureId: childFeature.id(),\n        parentFeatureId: featureLayout.feature.id(),\n        displayLabel,\n        type: childType,\n        leftPx,\n        topPx,\n        rightPx,\n        bottomPx,\n      })\n\n      // Create floating labels\n      const floatingLabels: FloatingLabelData[] = []\n      if (showSubfeatureLabels && displayLabel) {\n        const label = createTranscriptFloatingLabel({\n          displayLabel,\n          featureHeight: child.height,\n          subfeatureLabels,\n          color: labelColor,\n          parentFeatureId: featureLayout.feature.id(),\n          subfeatureId: childFeature.id(),\n          tooltip: matchingGlyph ? displayLabel : parentTooltip,\n        })\n        if (label) {\n          floatingLabels.push(label)\n        }\n      }\n\n      const childStart = childFeature.get('start')\n      const childEnd = childFeature.get('end')\n      layout.addRect(\n        childFeature.id(),\n        childStart,\n        childEnd,\n        bottomPx - topPx,\n        childFeature,\n        showSubfeatureLabels && floatingLabels.length > 0\n          ? createSubfeatureLabelMetadata({\n              refName: childFeature.get('refName'),\n              floatingLabels,\n              totalFeatureHeight: child.height,\n              totalLayoutWidth: child.totalLayoutWidth,\n              actualTopPx: topPx,\n              featureWidth: child.width,\n              featureStartBp: childStart,\n              featureEndBp: childEnd,\n            })\n          : { refName: childFeature.get('refName') },\n      )\n    }\n  }\n\n  // Recurse into children\n  for (const child of featureLayout.children) {\n    addChildrenRecursive({\n      layout,\n      featureLayout: child,\n      subfeatureCoords,\n      subfeatureInfos,\n      config,\n      configContext,\n      pluginManager,\n      subfeatureLabels,\n      transcriptTypes,\n      labelColor,\n      parentTooltip,\n    })\n  }\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { createJBrowseTheme } from '@jbrowse/core/ui'\nimport { bpToPx } from '@jbrowse/core/util'\nimport Flatbush from '@jbrowse/core/util/flatbush'\nimport {\n  checkStopToken2,\n  createStopTokenChecker,\n} from '@jbrowse/core/util/stopToken'\n\nimport { drawFeature } from './drawFeature.ts'\nimport {\n  buildChildrenIndex,\n  convertToCanvasCoords,\n} from './layout/layoutUtils.ts'\n\nimport type { RenderConfigContext } from './renderConfig.ts'\nimport type {\n  DrawContext,\n  FlatbushItem,\n  LayoutRecord,\n  RenderArgs,\n  SubfeatureInfo,\n} from './types.ts'\n\nfunction buildFlatbush(coords: number[], count: number) {\n  const fb = new Flatbush(Math.max(count, 1))\n  if (coords.length) {\n    for (let i = 0; i < coords.length; i += 4) {\n      fb.add(coords[i]!, coords[i + 1]!, coords[i + 2], coords[i + 3])\n    }\n  } else {\n    fb.add(0, 0, 0, 0)\n  }\n  fb.finish()\n  return fb\n}\n\n/**\n * Phase 2: Render all features to canvas.\n *\n * This is the draw phase of the two-phase rendering:\n * 1. Layouts have already been computed in Phase 1 (layoutFeatures)\n * 2. Here we convert local coords to canvas coords and draw each feature\n * 3. Build Flatbush spatial indexes for hit detection\n */\nexport function makeImageData({\n  ctx,\n  layoutRecords,\n  canvasWidth,\n  renderArgs,\n  configContext,\n}: {\n  ctx: CanvasRenderingContext2D\n  layoutRecords: LayoutRecord[]\n  canvasWidth: number\n  renderArgs: RenderArgs\n  configContext: RenderConfigContext\n}) {\n  const {\n    bpPerPx,\n    regions,\n    theme: configTheme,\n    stopToken,\n    layout,\n    peptideDataMap,\n    colorByCDS,\n    pluginManager,\n  } = renderArgs\n\n  const region = regions[0]!\n  const theme = createJBrowseTheme(configTheme)\n\n  // Create draw context once - shared across all features\n  const drawContext: DrawContext = {\n    region,\n    bpPerPx,\n    configContext,\n    theme,\n    canvasWidth,\n    peptideDataMap,\n    colorByCDS,\n  }\n\n  // Hit detection data\n  const coords: number[] = []\n  const items: FlatbushItem[] = []\n  const subfeatureCoords: number[] = []\n  const subfeatureInfos: SubfeatureInfo[] = []\n\n  ctx.textBaseline = 'top'\n  ctx.textAlign = 'left'\n\n  const { subfeatureLabels, transcriptTypes, config } = configContext\n  const lastCheck = createStopTokenChecker(stopToken)\n\n  for (const record of layoutRecords) {\n    const {\n      feature,\n      layout: featureLayout,\n      topPx: recordTopPx,\n      label,\n      description,\n    } = record\n\n    // Convert local coordinates to canvas coordinates\n    const featureStartBp = feature.get(region.reversed ? 'end' : 'start')\n    const startPx = bpToPx(featureStartBp, region, bpPerPx)\n    const canvasLayout = convertToCanvasCoords(\n      featureLayout,\n      startPx,\n      recordTopPx,\n    )\n\n    // Draw the feature (all coordinates are now in canvas space)\n    drawFeature(ctx, canvasLayout, drawContext, pluginManager)\n\n    // Build hit detection indexes\n    const bounds = {\n      left: canvasLayout.x,\n      right: canvasLayout.x + canvasLayout.totalLayoutWidth,\n      top: canvasLayout.y,\n      bottom: canvasLayout.y + canvasLayout.totalLayoutHeight,\n    }\n\n    const tooltip = String(\n      readConfObject(config, 'mouseover', { feature, label, description }) ||\n        '',\n    )\n\n    coords.push(bounds.left, bounds.top, bounds.right, bounds.bottom)\n    items.push({\n      featureId: feature.id(),\n      type: 'box',\n      startBp: feature.get('start'),\n      endBp: feature.get('end'),\n      leftPx: bounds.left,\n      rightPx: bounds.right,\n      topPx: bounds.top,\n      bottomPx: bounds.bottom,\n      tooltip,\n    })\n\n    // Build subfeature index for hit detection and floating labels\n    buildChildrenIndex({\n      layout,\n      featureLayout: canvasLayout,\n      subfeatureCoords,\n      subfeatureInfos,\n      config,\n      configContext,\n      pluginManager,\n      subfeatureLabels,\n      transcriptTypes,\n      labelColor: theme.palette.text.primary,\n      parentTooltip: tooltip,\n    })\n\n    checkStopToken2(lastCheck)\n  }\n\n  return {\n    flatbush: buildFlatbush(coords, items.length).data,\n    items,\n    subfeatureFlatbush: buildFlatbush(subfeatureCoords, subfeatureInfos.length)\n      .data,\n    subfeatureInfos,\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport {\n  defaultCodonTable,\n  generateCodonTable,\n  revcom,\n} from '@jbrowse/core/util'\nimport { convertCodingSequenceToPeptides } from '@jbrowse/core/util/convertCodingSequenceToPeptides'\nimport { firstValueFrom, toArray } from 'rxjs'\n\nimport { shouldRenderPeptideBackground } from '../zoomThresholds.ts'\n\nimport type { PeptideData, SequenceData } from '../types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type { RenderArgsDeserialized } from '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType'\nimport type { Feature, Region } from '@jbrowse/core/util'\n\ntype RegionWithSeqAdapter = Region & { seqAdapterRefName?: string }\n\nasync function fetchSequence(\n  pluginManager: PluginManager,\n  renderProps: RenderArgsDeserialized,\n  region: RegionWithSeqAdapter,\n) {\n  const { sessionId, sequenceAdapter } = renderProps as {\n    sessionId: string\n    sequenceAdapter?: Record<string, unknown>\n  }\n  if (!sequenceAdapter) {\n    return undefined\n  }\n  try {\n    const { dataAdapter } = await getAdapter(\n      pluginManager,\n      sessionId,\n      sequenceAdapter,\n    )\n\n    const feats = await firstValueFrom(\n      (dataAdapter as BaseFeatureDataAdapter)\n        .getFeatures({\n          ...region,\n          refName: region.seqAdapterRefName ?? region.refName,\n          start: Math.max(0, region.start),\n        })\n        .pipe(toArray()),\n    )\n    return feats[0]?.get('seq') as string | undefined\n  } catch (error) {\n    console.warn('[fetchSequence] Failed to fetch sequence:', error)\n    return undefined\n  }\n}\n\nconst DEFAULT_TRANSCRIPT_TYPES = [\n  'mRNA',\n  'transcript',\n  'primary_transcript',\n  'protein_coding_primary_transcript',\n]\n\nfunction isTranscriptType(\n  type: string,\n  transcriptTypes = DEFAULT_TRANSCRIPT_TYPES,\n) {\n  return transcriptTypes.includes(type)\n}\n\nfunction hasCDSSubfeatures(feature: Feature) {\n  const subfeatures = feature.get('subfeatures')\n  return subfeatures?.some((sub: Feature) => sub.get('type') === 'CDS') ?? false\n}\n\nfunction findTranscriptsWithCDS(features: Map<string, Feature>): Feature[] {\n  const transcripts: Feature[] = []\n\n  for (const feature of features.values()) {\n    const type = feature.get('type')\n    const subfeatures = feature.get('subfeatures')\n\n    if (type === 'gene' && subfeatures?.length) {\n      for (const subfeature of subfeatures) {\n        const subType = subfeature.get('type')\n        if (isTranscriptType(subType) && hasCDSSubfeatures(subfeature)) {\n          transcripts.push(subfeature)\n        }\n      }\n    } else if (isTranscriptType(type) && hasCDSSubfeatures(feature)) {\n      transcripts.push(feature)\n    }\n  }\n\n  return transcripts\n}\n\nfunction extractCDSRegions(feature: Feature): { start: number; end: number }[] {\n  const subfeatures = feature.get('subfeatures') || []\n  const featureStart = feature.get('start')\n\n  return subfeatures\n    .filter((sub: Feature) => sub.get('type') === 'CDS')\n    .sort((a: Feature, b: Feature) => a.get('start') - b.get('start'))\n    .map((sub: Feature) => ({\n      start: sub.get('start') - featureStart,\n      end: sub.get('end') - featureStart,\n    }))\n}\n\nasync function fetchTranscriptPeptides(\n  pluginManager: PluginManager,\n  renderProps: RenderArgsDeserialized,\n  transcript: Feature,\n): Promise<PeptideData | undefined> {\n  try {\n    const baseRegion = renderProps.regions[0] as RegionWithSeqAdapter\n    const region = {\n      ...baseRegion,\n      start: transcript.get('start'),\n      end: transcript.get('end'),\n    }\n\n    let seq = await fetchSequence(pluginManager, renderProps, region)\n    if (!seq) {\n      return undefined\n    }\n\n    const strand = transcript.get('strand') as number\n    let cds = extractCDSRegions(transcript)\n    if (cds.length === 0) {\n      return undefined\n    }\n\n    if (strand === -1) {\n      seq = revcom(seq)\n      const seqLen = seq.length\n      cds = cds\n        .map(region => ({\n          start: seqLen - region.end,\n          end: seqLen - region.start,\n        }))\n        .reverse()\n    }\n\n    const sequenceData: SequenceData = { seq, cds }\n\n    try {\n      const protein = convertCodingSequenceToPeptides({\n        cds,\n        sequence: seq,\n        codonTable: generateCodonTable(defaultCodonTable),\n      })\n\n      return { sequenceData, protein }\n    } catch (error) {\n      console.warn(\n        `[fetchTranscriptPeptides] Failed to convert sequence to peptides for ${transcript.id()}:`,\n        error,\n      )\n      return { sequenceData }\n    }\n  } catch (error) {\n    console.warn(\n      `[fetchTranscriptPeptides] Failed to fetch sequence for transcript ${transcript.id()}:`,\n      error,\n    )\n    return undefined\n  }\n}\n\nexport async function fetchPeptideData(\n  pluginManager: PluginManager,\n  renderProps: RenderArgsDeserialized,\n  features: Map<string, Feature>,\n): Promise<Map<string, PeptideData>> {\n  const { colorByCDS, bpPerPx } = renderProps as {\n    colorByCDS?: boolean\n    bpPerPx: number\n  }\n  const peptideDataMap = new Map<string, PeptideData>()\n  if (!colorByCDS || !shouldRenderPeptideBackground(bpPerPx)) {\n    return peptideDataMap\n  }\n\n  for (const transcript of findTranscriptsWithCDS(features)) {\n    const peptideData = await fetchTranscriptPeptides(\n      pluginManager,\n      renderProps,\n      transcript,\n    )\n    if (peptideData) {\n      peptideDataMap.set(transcript.id(), peptideData)\n    }\n  }\n\n  return peptideDataMap\n}\n","import { renderToAbstractCanvas, updateStatus } from '@jbrowse/core/util'\n\nimport { layoutFeatures } from './layout/layoutFeatures.ts'\nimport { makeImageData } from './makeImageData.ts'\nimport { fetchPeptideData } from './peptides/peptideUtils.ts'\nimport { createRenderConfigContext } from './renderConfig.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { RenderArgsDeserialized } from '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { BaseLayout } from '@jbrowse/core/util/layouts'\n\n/**\n * Main rendering pipeline for CanvasFeatureRenderer\n *\n * IMPORTANT: Config values are read ONCE at the start via createRenderConfigContext()\n * and passed through the entire pipeline. This is critical for performance since\n * readConfObject() is expensive (JEXL evaluation, MobX reactions, tree traversal).\n *\n * DO NOT call readConfObject() in hot paths (per-feature loops). If you need a new\n * config value, add it to RenderConfigContext and createRenderConfigContext().\n */\nexport async function doAll({\n  layout,\n  features,\n  renderProps,\n  pluginManager,\n}: {\n  pluginManager: PluginManager\n  layout: BaseLayout<unknown>\n  features: Map<string, Feature>\n  renderProps: RenderArgsDeserialized\n}) {\n  const { statusCallback = () => {}, regions, bpPerPx, config } = renderProps\n  const region = regions[0]!\n  const width = Math.max(1, (region.end - region.start) / bpPerPx)\n\n  // Create config context ONCE at the start - this reads all config values upfront\n  // to avoid expensive readConfObject calls in per-feature hot paths\n  const configContext = createRenderConfigContext(config)\n\n  const layoutRecords = await updateStatus(\n    'Computing feature layout',\n    statusCallback,\n    async () => {\n      return layoutFeatures({\n        features,\n        bpPerPx,\n        region,\n        configContext,\n        layout,\n        pluginManager,\n      })\n    },\n  )\n\n  const height = Math.max(1, layout.getTotalHeight())\n\n  const peptideDataMap = await updateStatus(\n    'Fetching peptide data',\n    statusCallback,\n    async () => {\n      return fetchPeptideData(pluginManager, renderProps, features)\n    },\n  )\n\n  return updateStatus('Rendering features', statusCallback, async () => {\n    return renderToAbstractCanvas(width, height, renderProps, ctx =>\n      makeImageData({\n        ctx,\n        layoutRecords,\n        canvasWidth: width,\n        renderArgs: {\n          ...renderProps,\n          features,\n          layout,\n          displayMode: configContext.displayMode,\n          peptideDataMap,\n          colorByCDS: (renderProps as any).colorByCDS,\n          pluginManager,\n        },\n        configContext,\n      }),\n    )\n  })\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\n\nimport { createFeatureFloatingLabels } from '../floatingLabels.ts'\nimport { layoutFeature } from './layoutFeature.ts'\n\nimport type { RenderConfigContext } from '../renderConfig.ts'\nimport type { LayoutRecord } from '../types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature, Region } from '@jbrowse/core/util'\nimport type { BaseLayout } from '@jbrowse/core/util/layouts'\n\nconst yPadding = 5\n\nexport function layoutFeatures({\n  features,\n  bpPerPx,\n  region,\n  configContext,\n  layout,\n  pluginManager,\n}: {\n  features: Map<string, Feature>\n  bpPerPx: number\n  region: Region\n  configContext: RenderConfigContext\n  layout: BaseLayout<unknown>\n  pluginManager: PluginManager\n}): LayoutRecord[] {\n  const reversed = region.reversed || false\n  const layoutRecords: LayoutRecord[] = []\n  const { config } = configContext\n\n  for (const feature of features.values()) {\n    const featureLayout = layoutFeature({\n      feature,\n      bpPerPx,\n      reversed,\n      configContext,\n      pluginManager,\n    })\n\n    const totalLayoutWidth = featureLayout.totalLayoutWidth\n    const totalLayoutHeight = featureLayout.totalLayoutHeight\n\n    const name = String(\n      readConfObject(config, ['labels', 'name'], { feature }) || '',\n    )\n    const description = String(\n      readConfObject(config, ['labels', 'description'], { feature }) || '',\n    )\n\n    const floatingLabels = createFeatureFloatingLabels({\n      feature,\n      config,\n      configContext,\n      nameColor: 'black',\n      descriptionColor: 'blue',\n      name,\n      description,\n    })\n\n    const featureStart = feature.get('start')\n    const featureEnd = feature.get('end')\n    const leftPaddingBp = featureLayout.leftPadding * bpPerPx\n    const rightPaddingBp =\n      (totalLayoutWidth - featureLayout.width - featureLayout.leftPadding) *\n      bpPerPx\n    const layoutStart = featureStart - leftPaddingBp\n    const layoutEnd = featureEnd + rightPaddingBp\n\n    const topPx = layout.addRect(\n      feature.id(),\n      layoutStart,\n      layoutEnd,\n      totalLayoutHeight + yPadding,\n      feature,\n      {\n        label: name,\n        description,\n        refName: feature.get('refName'),\n        floatingLabels,\n        totalFeatureHeight: featureLayout.height,\n        totalLayoutWidth,\n        featureWidth: featureLayout.width,\n        featureStartBp: featureStart,\n        featureEndBp: featureEnd,\n      },\n    )\n\n    if (topPx !== null) {\n      layoutRecords.push({\n        feature,\n        layout: featureLayout,\n        topPx,\n        label: name,\n        description,\n      })\n    }\n  }\n\n  return layoutRecords\n}\n","import { BoxRendererType } from '@jbrowse/core/pluggableElementTypes'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\n\nimport { doAll } from './doAll.ts'\n\nimport type { RenderArgsDeserialized } from '@jbrowse/core/pluggableElementTypes/renderers/BoxRendererType'\n\nexport default class CanvasFeatureRenderer extends BoxRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const features = await this.getFeatures(renderProps)\n    const layout = this.createLayoutInWorker(renderProps)\n    const { regions, bpPerPx } = renderProps\n    const region = regions[0]!\n    const width = Math.max(1, (region.end - region.start) / bpPerPx)\n\n    const res = await doAll({\n      pluginManager: this.pluginManager,\n      renderProps,\n      layout,\n      features,\n    })\n\n    const height = Math.max(1, layout.getTotalHeight())\n    const serializedLayout = this.serializeLayout(layout, renderProps)\n\n    const serialized = {\n      ...res,\n      layout: serializedLayout,\n      height,\n      width,\n      maxHeightReached: layout.maxHeightReached,\n    }\n\n    return rpcResult(serialized, collectTransferables(res))\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config CanvasFeatureRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst CanvasFeatureRenderer = ConfigurationSchema(\n  'CanvasFeatureRenderer',\n  {\n    /**\n     * #slot\n     */\n    color1: {\n      type: 'color',\n      description: 'the main color of each feature',\n      defaultValue: 'goldenrod',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    color2: {\n      type: 'color',\n      description:\n        'the secondary color of each feature, used for connecting lines, etc',\n      defaultValue: '#f0f',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    color3: {\n      type: 'color',\n      description:\n        'the tertiary color of each feature, often used for contrasting fills, like on UTRs',\n      defaultValue: '#357089',\n      contextVariable: ['feature'],\n    },\n\n    /**\n     * #slot\n     */\n    outline: {\n      type: 'color',\n      description: 'the outline for features',\n      defaultValue: '',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    height: {\n      type: 'number',\n      description: 'height in pixels of the main body of each feature',\n      defaultValue: 10,\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    showLabels: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n\n    /**\n     * #slot\n     */\n    showDescriptions: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n\n    /**\n     * #slot\n     */\n    subfeatureLabels: {\n      type: 'stringEnum',\n      model: types.enumeration('subfeatureLabels', [\n        'none',\n        'below',\n        'overlay',\n      ]),\n      description:\n        'subfeature label display: \"none\" hides labels, \"below\" reserves extra space, \"overlay\" draws on top of feature',\n      defaultValue: 'none',\n    },\n\n    /**\n     * #slot\n     */\n    mouseover: {\n      type: 'string',\n      description:\n        'the mouseover tooltip label for features. Available variables: feature (the feature object), label (evaluated name), description (evaluated description)',\n      defaultValue: `jexl:get(feature,'_mouseover') || get(feature,'_mouseOver') || (label && description ? label + '<br/>' + description : (label || description || ''))`,\n      contextVariable: ['feature', 'label', 'description'],\n    },\n\n    /**\n     * #slot\n     */\n    subfeatureMouseover: {\n      type: 'string',\n      description:\n        'the mouseover tooltip label for subfeatures (e.g. transcripts). Available variables: feature (the subfeature object)',\n      defaultValue: `jexl:get(feature,'name') || get(feature,'id')`,\n      contextVariable: ['feature'],\n    },\n\n    labels: ConfigurationSchema('CanvasFeatureLabels', {\n      /**\n       * #slot labels.name\n       */\n      name: {\n        type: 'string',\n        description:\n          'the primary name of the feature to show, if space is available',\n        defaultValue: `jexl:get(feature,'name') || get(feature,'id')`,\n        contextVariable: ['feature'],\n      },\n      /**\n       * #slot labels.nameColor\n       */\n      nameColor: {\n        type: 'color',\n        description: 'the color of the name label, if shown',\n        defaultValue: '#f0f',\n        contextVariable: ['feature'],\n      },\n      /**\n       * #slot labels.description\n       */\n      description: {\n        type: 'string',\n        description: 'the text description to show, if space is available',\n        defaultValue: `jexl:get(feature,'note') || get(feature,'description')`,\n        contextVariable: ['feature'],\n      },\n      /**\n       * #slot labels.descriptionColor\n       */\n      descriptionColor: {\n        type: 'color',\n        description: 'the color of the description, if shown',\n        defaultValue: 'blue',\n        contextVariable: ['feature'],\n      },\n\n      /**\n       * #slot labels.fontSize\n       */\n      fontSize: {\n        type: 'number',\n        description:\n          'height in pixels of the text to use for names and descriptions',\n        defaultValue: 12,\n        contextVariable: ['feature'],\n      },\n    }),\n\n    /**\n     * #slot\n     */\n    displayMode: {\n      type: 'stringEnum',\n      model: types.enumeration('displayMode', [\n        'normal',\n        'compact',\n        'reducedRepresentation',\n        'collapse',\n      ]),\n      description: 'Alternative display modes',\n      defaultValue: 'normal',\n    },\n\n    /**\n     * #slot\n     */\n    maxFeatureGlyphExpansion: {\n      type: 'number',\n      description:\n        \"maximum number of pixels on each side of a feature's bounding coordinates that a glyph is allowed to use\",\n      defaultValue: 500,\n    },\n\n    /**\n     * #slot\n     */\n    maxHeight: {\n      type: 'integer',\n      description: 'the maximum height to be used in a rendering',\n      defaultValue: 5000,\n    },\n\n    /**\n     * #slot\n     */\n    subParts: {\n      type: 'string',\n      description: 'subparts for a glyph',\n      defaultValue: 'CDS,UTR,five_prime_UTR,three_prime_UTR',\n    },\n\n    /**\n     * #slot\n     */\n    impliedUTRs: {\n      type: 'boolean',\n      description: 'imply UTR from the exon and CDS differences',\n      defaultValue: false,\n    },\n    /**\n     * #slot\n     */\n    transcriptTypes: {\n      type: 'stringArray',\n      defaultValue: ['mRNA', 'transcript', 'primary_transcript'],\n    },\n    /**\n     * #slot\n     */\n    containerTypes: {\n      type: 'stringArray',\n      defaultValue: ['proteoform_orf'],\n    },\n\n    /**\n     * #slot\n     */\n    geneGlyphMode: {\n      type: 'stringEnum',\n      model: types.enumeration('geneGlyphMode', [\n        'all',\n        'longest',\n        'longestCoding',\n      ]),\n      description:\n        'Gene glyph display mode: \"all\" shows all transcripts, \"longest\" shows only the longest transcript, \"longestCoding\" shows only the longest coding transcript',\n      defaultValue: 'all',\n    },\n\n    /**\n     * #slot\n     */\n    displayDirectionalChevrons: {\n      type: 'boolean',\n      description:\n        'Display directional chevrons on intron lines to indicate strand direction',\n      defaultValue: true,\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default CanvasFeatureRenderer\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport configSchema from './configSchema.ts'\n\n/**\n * #config SvgFeatureRenderer\n * NOTE: This is a fake config for SvgFeatureRenderer which was deleted, please\n * update to use the real CanvasFeatureRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst SvgFeatureRenderer = ConfigurationSchema(\n  'SvgFeatureRenderer',\n  {},\n  { explicitlyTyped: true, baseConfiguration: configSchema },\n)\n\nexport default SvgFeatureRenderer\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport CanvasFeatureRendererF from './CanvasFeatureRenderer/index.ts'\nimport registerGlyphs from './glyphs/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class CanvasPlugin extends Plugin {\n  name = 'CanvasPlugin'\n\n  install(pluginManager: PluginManager) {\n    registerGlyphs(pluginManager)\n    CanvasFeatureRendererF(pluginManager)\n  }\n}\n","import { lazy } from 'react'\n\nimport CanvasFeatureRenderer from './CanvasFeatureRenderer.ts'\nimport configSchema from './configSchema.ts'\nimport configSchema2 from './configSchema2.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function CanvasFeatureRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(() => {\n    return new CanvasFeatureRenderer({\n      name: 'CanvasFeatureRenderer',\n      ReactComponent: lazy(() => import('./CanvasFeatureRendering.tsx')),\n      configSchema,\n      pluginManager,\n    })\n  })\n  // we fake svgfeaturerenderer, it was removed\n  pluginManager.addRendererType(() => {\n    return new CanvasFeatureRenderer({\n      name: 'SvgFeatureRenderer',\n      ReactComponent: lazy(() => import('./CanvasFeatureRendering.tsx')),\n      configSchema: configSchema2,\n      pluginManager,\n    })\n  })\n}\n\nexport { default as configSchema } from './configSchema.ts'\n","function findCircleIntersectionX(\n  y: number,\n  cx: number,\n  cy: number,\n  r: number,\n  resultArray: [number, number][],\n) {\n  const d = Math.abs(y - cy)\n  if (d > r) {\n    return\n  }\n  if (d === r) {\n    resultArray.push([cx, y])\n  }\n  const solution = Math.sqrt(r * r - d * d)\n  resultArray.push([cx - solution, y], [cx + solution, y])\n}\n\nfunction findCircleIntersectionY(\n  x: number,\n  cx: number,\n  cy: number,\n  r: number,\n  resultArray: [number, number][],\n) {\n  const d = Math.abs(x - cx)\n  if (d > r) {\n    return\n  }\n  if (d === r) {\n    resultArray.push([x, cy])\n  }\n  const solution = Math.sqrt(r * r - d * d)\n  resultArray.push([x, cy - solution], [x, cy + solution])\n}\n\nfunction cartesianToTheta(x: number, y: number) {\n  let theta = (Math.atan(y / x) + 2 * Math.PI) % (2 * Math.PI)\n  if (x < 0) {\n    if (y <= 0) {\n      theta += Math.PI\n    } else {\n      theta -= Math.PI\n    }\n  }\n  return theta\n}\n\nexport function cartesianToPolar(x: number, y: number) {\n  const rho = Math.sqrt(x * x + y * y)\n  if (rho === 0) {\n    return [0, 0] as const\n  }\n  const theta = cartesianToTheta(x, y)\n  return [rho, theta] as const\n}\n\nconst twoPi = 2 * Math.PI\nexport function thetaRangesOverlap(\n  r1start: number,\n  r1length: number,\n  r2start: number,\n  r2length: number,\n) {\n  if (r1length <= 0 || r2length <= 0) {\n    return false\n  }\n  if (r1length + 0.0001 >= twoPi || r2length + 0.0001 >= twoPi) {\n    return true\n  }\n\n  // put both range starts between 2 and 4\n  r1start = (((r1start % twoPi) + twoPi) % twoPi) + twoPi\n  r2start = (((r2start % twoPi) + twoPi) % twoPi) + twoPi\n\n  if (r1start < r2start + r2length && r1start + r1length > r2start) {\n    return true\n  }\n\n  // move r2 2 to the left and check\n  r2start -= twoPi\n  if (r1start < r2start + r2length && r1start + r1length > r2start) {\n    return true\n  }\n\n  // move it 2 to the right and check\n  r2start += twoPi + twoPi\n  return r1start < r2start + r2length && r1start + r1length > r2start\n}\n\n// return which arc range has any part of the circle visible in the viewport\nexport function viewportVisibleSection(\n  viewSides: [number, number, number, number],\n  circleCenter: [number, number],\n  circleRadius: number,\n) {\n  let [viewL, viewR, viewT, viewB] = viewSides\n  const [cx, cy] = circleCenter\n\n  // transform coordinate system to center of circle\n  viewL -= cx\n  viewR -= cx\n  viewT -= cy\n  viewB -= cy\n\n  const centerIsInsideViewport =\n    viewL < 0 && viewR > 0 && viewT < 0 && viewB > 0\n\n  if (centerIsInsideViewport) {\n    const vertices = [\n      [viewL, viewT],\n      [viewR, viewT],\n      [viewL, viewB],\n      [viewR, viewB],\n    ] as const\n    let maxRho = Number.NEGATIVE_INFINITY\n    for (const [x, y] of vertices) {\n      const rho = Math.sqrt(x * x + y * y)\n      if (rho > maxRho) {\n        maxRho = rho\n      }\n    }\n    return {\n      rho: [0, Math.min(circleRadius, maxRho)] as [number, number],\n      theta: [0, 2 * Math.PI] as [number, number],\n    }\n  }\n  // const viewportCompletelyContainsCircle =\n  //   circleCenter[0] - viewL >= circleRadius &&\n  //   viewR - circleCenter[0] >= circleRadius &&\n  //   circleCenter[1] - viewT >= circleRadius &&\n  //   viewB - circleCenter[1] >= circleRadius\n\n  // if (viewportCompletelyContainsCircle) {\n  //   return [0, 2 * Math.PI]\n  // }\n\n  // const distToCenterSquared = ([x, y]) => {\n  //   const [cx, cy] = circleCenter\n  //   const sq = n => n * n\n  //   return sq(x - cx) + sq(y - cy)\n  // }\n  // const circleRadiusSquared = circleRadius * circleRadius\n\n  // const tlInside = distToCenterSquared([viewL, viewT]) <= circleRadiusSquared\n  // const trInside = distToCenterSquared([viewR, viewT]) <= circleRadiusSquared\n  // const blInside = distToCenterSquared([viewL, viewB]) <= circleRadiusSquared\n  // const brInside = distToCenterSquared([viewR, viewB]) <= circleRadiusSquared\n\n  // const noIntersection = !tlInside && !trInside && !blInside && !brInside\n  // if (noIntersection) return undefined\n\n  // const circleCompletelyContainsViewport =\n  //   tlInside && trInside && blInside && brInside\n  // if (circleCompletelyContainsViewport) {\n  //   // viewport is in the circle, but the center is not in it, so take max\n  //   // and min of thetas to the center\n  //   const thetas = [\n  //     Math.atan(viewT / viewL),\n  //     Math.atan(viewT / viewR),\n  //     Math.atan(viewB / viewL),\n  //     Math.atan(viewB / viewR),\n  //   ]\n\n  //   return [Math.min(...thetas), Math.max(...thetas)]\n  // }\n\n  // if we get here, the viewport is partly in, partly out of the circle\n\n  // const viewLIntersects = Math.abs(viewL - circleCenter[0]) <= circleRadius\n  // const viewRIntersects = Math.abs(viewR - circleCenter[0]) <= circleRadius\n  // const viewTIntersects = Math.abs(viewT - circleCenter[1]) <= circleRadius\n  // const viewBIntersects = Math.abs(viewB - circleCenter[1]) <= circleRadius\n\n  // const numIntersectingSides =\n  //   Number(viewLIntersects) +\n  //   Number(viewRIntersects) +\n  //   Number(viewTIntersects) +\n  //   Number(viewBIntersects)\n\n  // if (numIntersectingSides === 4) return [0, 2 * Math.PI]\n  // if (numIntersectingSides === 3) {\n  //   // TODO calculate the thetas of the\n  // } else if (numIntersectingSides === 2) {\n  //   // TODO calculate the thetas of the 2 intersection points\n  // } else if (numIntersectingSides === 1) {\n  //   // TODO calculate the thetas of the 1-2 intersection points of the line, and the angle between\n  // }\n\n  // make a list of vertices-of-interest that lie inside both shapes to examine\n  // to determine the range covered by their intersection\n\n  // transform coordinates to have the circle as the origin and find the intersections\n  // of the circle and the view rectangle\n  const vertices: [number, number][] = [\n    [viewL, viewT],\n    [viewR, viewT],\n    [viewL, viewB],\n    [viewR, viewB],\n  ]\n  findCircleIntersectionY(viewL, 0, 0, circleRadius, vertices)\n  findCircleIntersectionY(viewR, 0, 0, circleRadius, vertices)\n  findCircleIntersectionX(viewT, 0, 0, circleRadius, vertices)\n  findCircleIntersectionX(viewB, 0, 0, circleRadius, vertices)\n\n  // for each edge, also look at the closest point to center if it is inside the circle\n  if (-viewL < circleRadius) {\n    vertices.push([viewL, 0])\n  }\n  if (viewR < circleRadius) {\n    vertices.push([viewR, 0])\n  }\n  if (-viewT < circleRadius) {\n    vertices.push([0, viewT])\n  }\n  if (viewB < circleRadius) {\n    vertices.push([0, viewB])\n  }\n\n  // const verticesOriginal = vertices.map(([x, y]) => [x + cx, y + cy])\n\n  // now convert them all to polar and take the max and min of rho and theta\n\n  // const viewportCenterTheta = cartesianToTheta(viewR + viewL, viewT + viewB)\n  const reflect = viewL >= 0 ? -1 : 1\n  // viewportCenterTheta < Math.PI / 2 || viewportCenterTheta > 1.5 * Math.PI\n  //   ? -1\n  //   : 1\n  let rhoMin = Number.POSITIVE_INFINITY\n  let rhoMax = Number.NEGATIVE_INFINITY\n  let thetaMin = Number.POSITIVE_INFINITY\n  let thetaMax = Number.NEGATIVE_INFINITY\n  for (const [vx, vy] of vertices) {\n    // ignore vertex if outside the viewport\n    if (vx >= viewL && vx <= viewR && vy >= viewT && vy <= viewB) {\n      const [rho, theta] = cartesianToPolar(vx * reflect, vy * reflect)\n      // ignore vertex if outside the circle\n      if (rho <= circleRadius + 0.001) {\n        // ignore theta if rho is 0\n        if (theta < thetaMin && rho > 0.0001) {\n          thetaMin = theta\n        }\n        if (theta > thetaMax && rho > 0.0001) {\n          thetaMax = theta\n        }\n        if (rho < rhoMin) {\n          rhoMin = rho\n        }\n        if (rho > rhoMax) {\n          rhoMax = rho\n        }\n      }\n    }\n  }\n\n  if (reflect === -1) {\n    thetaMin += Math.PI\n    thetaMax += Math.PI\n  }\n\n  if (thetaMin > 2 * Math.PI && thetaMax > 2 * Math.PI) {\n    thetaMin -= 2 * Math.PI\n    thetaMax -= 2 * Math.PI\n  }\n\n  return {\n    rho: [rhoMin, Math.min(circleRadius, rhoMax)] as [number, number],\n    theta: [thetaMin, thetaMax] as [number, number],\n  }\n}\n","import { assembleLocString, polarToCartesian } from '@jbrowse/core/util'\n\nimport { thetaRangesOverlap } from './viewportVisibleRegion.ts'\n\nimport type { Region } from '@jbrowse/core/util'\n\nexport interface SliceElidedRegion {\n  elided: true\n  widthBp: number\n  regions: Region[]\n}\n\nexport interface SliceNonElidedRegion {\n  elided: false\n  widthBp: number\n  start: number\n  end: number\n  refName: string\n  assemblyName: string\n}\nexport type SliceRegion = SliceNonElidedRegion | SliceElidedRegion\n\nexport class Slice {\n  key: string\n\n  startRadians: number\n\n  endRadians: number\n\n  bpPerRadian: number\n\n  flipped: boolean\n\n  constructor(\n    view: { bpPerRadian: number },\n    public region: SliceRegion,\n    public offsetRadians: number,\n    public radianWidth: number,\n  ) {\n    const { bpPerRadian } = view\n    this.key =\n      'regions' in region\n        ? JSON.stringify(region.regions)\n        : assembleLocString(region)\n    this.bpPerRadian = bpPerRadian\n    this.flipped = false\n\n    this.startRadians = offsetRadians\n    this.endRadians = region.widthBp / this.bpPerRadian + offsetRadians\n    Object.freeze(this)\n  }\n\n  bpToXY(bp: number, radiusPx: number) {\n    let offsetBp: number | undefined\n    if (this.region.elided) {\n      offsetBp = this.region.widthBp / 2\n    } else if (this.flipped) {\n      offsetBp = this.region.end - bp\n    } else {\n      offsetBp = bp - this.region.start\n    }\n    const totalRadians = offsetBp / this.bpPerRadian + this.offsetRadians\n    return polarToCartesian(radiusPx, totalRadians)\n  }\n\n  toJSON() {\n    return Object.fromEntries(Object.entries(this))\n  }\n}\n\nfunction calculateStaticSlices(self: {\n  elidedRegions: readonly SliceRegion[]\n  bpPerRadian: number\n  spacingPx: number\n  pxPerRadian: number\n}) {\n  const slices = []\n  let currentRadianOffset = 0\n  const { bpPerRadian, spacingPx, pxPerRadian } = self\n  for (const region of self.elidedRegions) {\n    const radianWidth = region.widthBp / bpPerRadian + spacingPx / pxPerRadian\n    slices.push(new Slice(self, region, currentRadianOffset, radianWidth))\n    currentRadianOffset += radianWidth\n  }\n  return slices\n}\n\nfunction sliceIsVisible(\n  self: { offsetRadians: number; visibleSection: { theta: [number, number] } },\n  slice: Slice,\n) {\n  const {\n    theta: [visibleThetaMin, visibleThetaMax],\n  } = self.visibleSection\n\n  return thetaRangesOverlap(\n    slice.offsetRadians + self.offsetRadians,\n    slice.radianWidth,\n    visibleThetaMin,\n    visibleThetaMax - visibleThetaMin,\n  )\n}\n\nexport { calculateStaticSlices, sliceIsVisible }\n","import type React from 'react'\nimport { lazy } from 'react'\n\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport {\n  clamp,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport {\n  hideTrackGeneric,\n  showTrackGeneric,\n  toggleTrackGeneric,\n} from '@jbrowse/core/util/tracks'\nimport { addDisposer, cast, types } from '@jbrowse/mobx-state-tree'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport PhotoCameraIcon from '@mui/icons-material/PhotoCamera'\nimport { autorun } from 'mobx'\n\nimport { calculateStaticSlices, sliceIsVisible } from './slices.ts'\nimport { viewportVisibleSection } from './viewportVisibleRegion.ts'\n\nimport type { SliceRegion } from './slices.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { Region } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n// lazies\nconst ExportSvgDialog = lazy(() => import('./components/ExportSvgDialog.tsx'))\n\nexport interface CircularViewInit {\n  assembly: string\n  tracks?: string[]\n}\nexport interface ExportSvgOptions {\n  rasterizeLayers?: boolean\n  filename?: string\n  Wrapper?: React.FC<{ children: React.ReactNode }>\n  themeName?: string\n}\n\n/**\n * #stateModel CircularView\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nfunction stateModelFactory(pluginManager: PluginManager) {\n  const minHeight = 40\n  const minWidth = 100\n  const defaultHeight = 400\n  const defaultOffsetRadians = -Math.PI / 2\n  const defaultBpPerPx = 200\n  const defaultMinimumRadiusPx = 25\n  const defaultSpacingPx = 10\n  const defaultPaddingPx = 80\n  const defaultLockedPaddingPx = 100\n  const defaultMinVisibleWidth = 6\n  const defaultMinimumBlockWidth = 20\n  return types\n    .compose(\n      'CircularView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('CircularView'),\n        /**\n         * #property\n         * similar to offsetPx in linear genome view\n         */\n        offsetRadians: defaultOffsetRadians,\n        /**\n         * #property\n         */\n        bpPerPx: defaultBpPerPx,\n        /**\n         * #property\n         */\n        tracks: types.array(\n          pluginManager.pluggableMstType('track', 'stateModel'),\n        ),\n\n        /**\n         * #property\n         */\n        hideVerticalResizeHandle: false,\n        /**\n         * #property\n         */\n        hideTrackSelectorButton: false,\n        /**\n         * #property\n         */\n        lockedFitToWindow: true,\n        /**\n         * #property\n         */\n        disableImportForm: false,\n\n        /**\n         * #property\n         */\n        height: types.optional(types.number, defaultHeight),\n        /*\n         * #property\n         */\n        displayedRegions: types.optional(types.frozen<Region[]>(), []),\n        /**\n         * #property\n         */\n        scrollX: 0,\n        /**\n         * #property\n         */\n        scrollY: 0,\n\n        /**\n         * #property\n         */\n        minimumRadiusPx: defaultMinimumRadiusPx,\n        /**\n         * #property\n         */\n        spacingPx: defaultSpacingPx,\n        /**\n         * #property\n         */\n        paddingPx: defaultPaddingPx,\n        /**\n         * #property\n         */\n        lockedPaddingPx: defaultLockedPaddingPx,\n        /**\n         * #property\n         */\n        minVisibleWidth: defaultMinVisibleWidth,\n        /**\n         * #property\n         */\n        minimumBlockWidth: defaultMinimumBlockWidth,\n        /**\n         * #property\n         */\n        trackSelectorType: 'hierarchical',\n        /**\n         * #property\n         * used for initializing the view from a session snapshot\n         */\n        init: types.frozen<CircularViewInit | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      volatileWidth: undefined as number | undefined,\n      volatileError: undefined as unknown,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get width() {\n        if (self.volatileWidth === undefined) {\n          throw new Error(\n            'wait for view to be initialized first before accessing width',\n          )\n        }\n        return self.volatileWidth\n      },\n\n      /**\n       * #getter\n       */\n      get visibleSection() {\n        const { scrollX, scrollY, width, height } = self\n        return viewportVisibleSection(\n          [scrollX, scrollX + width, scrollY, scrollY + height],\n          this.centerXY,\n          this.radiusPx,\n        )\n      },\n      /**\n       * #getter\n       */\n      get circumferencePx() {\n        let elidedBp = 0\n\n        for (const r of this.elidedRegions) {\n          elidedBp += r.widthBp\n        }\n        return (\n          elidedBp / self.bpPerPx + self.spacingPx * this.elidedRegions.length\n        )\n      },\n      /**\n       * #getter\n       */\n      get radiusPx() {\n        return this.circumferencePx / (2 * Math.PI)\n      },\n      /**\n       * #getter\n       */\n      get bpPerRadian() {\n        return self.bpPerPx * this.radiusPx\n      },\n      /**\n       * #getter\n       */\n      get pxPerRadian() {\n        return this.radiusPx\n      },\n      /**\n       * #getter\n       */\n      get centerXY(): [number, number] {\n        return [this.radiusPx + self.paddingPx, this.radiusPx + self.paddingPx]\n      },\n      /**\n       * #getter\n       */\n      get totalBp() {\n        let total = 0\n        for (const region of self.displayedRegions) {\n          total += region.end - region.start\n        }\n        return total\n      },\n      /**\n       * #getter\n       */\n      get maximumRadiusPx() {\n        return self.lockedFitToWindow\n          ? Math.min(self.width, self.height) / 2 - self.lockedPaddingPx\n          : 1000000\n      },\n      /**\n       * #getter\n       */\n      get maxBpPerPx() {\n        const minCircumferencePx = 2 * Math.PI * self.minimumRadiusPx\n        return this.totalBp / minCircumferencePx\n      },\n      /**\n       * #getter\n       */\n      get minBpPerPx() {\n        // min depends on window dimensions, clamp between old min(0.01) and max\n        const maxCircumferencePx = 2 * Math.PI * this.maximumRadiusPx\n        return clamp(\n          this.totalBp / maxCircumferencePx,\n          0.0000000001,\n          this.maxBpPerPx,\n        )\n      },\n      /**\n       * #getter\n       */\n      get atMaxBpPerPx() {\n        return self.bpPerPx >= this.maxBpPerPx\n      },\n      /**\n       * #getter\n       */\n      get atMinBpPerPx() {\n        return self.bpPerPx <= this.minBpPerPx\n      },\n      /**\n       * #getter\n       */\n      get tooSmallToLock() {\n        return this.minBpPerPx <= 0.0000000001\n      },\n      /**\n       * #getter\n       */\n      get figureDimensions(): [number, number] {\n        return [\n          this.radiusPx * 2 + 2 * self.paddingPx,\n          this.radiusPx * 2 + 2 * self.paddingPx,\n        ]\n      },\n      /**\n       * #getter\n       */\n      get figureWidth() {\n        return this.figureDimensions[0]\n      },\n      /**\n       * #getter\n       */\n      get figureHeight() {\n        return this.figureDimensions[1]\n      },\n      /**\n       * #getter\n       * this is displayedRegions, post-processed to elide regions that are too\n       * small to see reasonably\n       */\n      get elidedRegions() {\n        const visible: SliceRegion[] = []\n        for (const region of self.displayedRegions) {\n          const widthBp = region.end - region.start\n          const widthPx = widthBp / self.bpPerPx\n          if (widthPx < self.minVisibleWidth) {\n            // too small to see, collapse into a single elision region\n            const lastVisible = visible.at(-1)\n            if (lastVisible?.elided) {\n              lastVisible.regions.push({ ...region })\n              lastVisible.widthBp += widthBp\n            } else {\n              visible.push({\n                elided: true,\n                widthBp,\n                regions: [{ ...region }],\n              })\n            }\n          } else {\n            // big enough to see, display it\n            visible.push({ ...region, widthBp, elided: false })\n          }\n        }\n\n        // remove any single-region elisions\n        for (let i = 0; i < visible.length; i += 1) {\n          const v = visible[i]!\n          if (v.elided && v.regions.length === 1) {\n            visible[i] = { ...v, ...v.regions[0]!, elided: false }\n          }\n        }\n        return visible\n      },\n      /**\n       * #getter\n       */\n      get assemblyNames() {\n        const assemblyNames: string[] = []\n        for (const displayedRegion of self.displayedRegions) {\n          if (!assemblyNames.includes(displayedRegion.assemblyName)) {\n            assemblyNames.push(displayedRegion.assemblyName)\n          }\n        }\n        return assemblyNames\n      },\n      /**\n       * #getter\n       */\n      get initialized() {\n        if (self.volatileWidth === undefined) {\n          return false\n        }\n        const { assemblyManager } = getSession(self)\n        // if init is set, wait for that assembly to have regions loaded\n        if (self.init) {\n          const asm = assemblyManager.get(self.init.assembly)\n          return !!(asm?.initialized && asm.regions)\n        }\n        return this.assemblyNames.every(\n          a => assemblyManager.get(a)?.initialized,\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get assemblyErrors() {\n        const { assemblyManager } = getSession(self)\n        return this.assemblyNames\n          .map(a => assemblyManager.get(a)?.error)\n          .filter(f => !!f)\n          .join(', ')\n      },\n\n      /**\n       * #getter\n       */\n      get error(): unknown {\n        if (self.volatileError) {\n          return self.volatileError\n        }\n        if (this.assemblyErrors) {\n          return this.assemblyErrors\n        }\n        // Check init assembly for errors (displayedRegions may be empty during init)\n        if (self.init) {\n          const { assemblyManager } = getSession(self)\n          const asm = assemblyManager.get(self.init.assembly)\n          if (asm?.error) {\n            return asm.error\n          }\n          if (!asm) {\n            return `Assembly ${self.init.assembly} not found`\n          }\n        }\n        return undefined\n      },\n\n      /**\n       * #getter\n       */\n      get loadingMessage() {\n        return this.showLoading ? 'Loading' : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get hasSomethingToShow() {\n        return self.displayedRegions.length > 0 || !!self.init\n      },\n\n      /**\n       * #getter\n       * Whether to show a loading indicator instead of the import form or view\n       */\n      get showLoading() {\n        return !this.initialized && !this.error && this.hasSomethingToShow\n      },\n\n      /**\n       * #getter\n       * Whether the view is fully initialized and ready to display\n       */\n      get showView() {\n        return (\n          !!self.displayedRegions.length &&\n          !!this.figureWidth &&\n          !!this.figureHeight &&\n          this.initialized\n        )\n      },\n\n      /**\n       * #getter\n       * Whether to show the import form (when not ready to display and import\n       * form is enabled, or when there's an error)\n       */\n      get showImportForm() {\n        return (\n          (!this.hasSomethingToShow && !self.disableImportForm) || !!this.error\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get staticSlices() {\n        return calculateStaticSlices(self)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get visibleStaticSlices() {\n        return self.staticSlices.filter(s => sliceIsVisible(self, s))\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.volatileWidth = Math.max(newWidth, minWidth)\n        return self.volatileWidth\n      },\n      /**\n       * #action\n       */\n      setHeight(newHeight: number) {\n        self.height = Math.max(newHeight, minHeight)\n        return self.height\n      },\n      /**\n       * #action\n       */\n      resizeHeight(distance: number) {\n        const oldHeight = self.height\n        const newHeight = this.setHeight(self.height + distance)\n        this.setModelViewWhenAdjust(!self.tooSmallToLock)\n        return newHeight - oldHeight\n      },\n      /**\n       * #action\n       */\n      resizeWidth(distance: number) {\n        const oldWidth = self.width\n        const newWidth = this.setWidth(self.width + distance)\n        this.setModelViewWhenAdjust(!self.tooSmallToLock)\n        return newWidth - oldWidth\n      },\n      /**\n       * #action\n       */\n      rotateClockwiseButton() {\n        this.rotateClockwise(Math.PI / 6)\n      },\n\n      /**\n       * #action\n       */\n      rotateCounterClockwiseButton() {\n        this.rotateCounterClockwise(Math.PI / 6)\n      },\n\n      /**\n       * #action\n       */\n      rotateClockwise(distance = 0.17) {\n        self.offsetRadians += distance\n      },\n\n      /**\n       * #action\n       */\n      rotateCounterClockwise(distance = 0.17) {\n        self.offsetRadians -= distance\n      },\n\n      /**\n       * #action\n       */\n      zoomInButton() {\n        this.setBpPerPx(self.bpPerPx / 1.4)\n      },\n\n      /**\n       * #action\n       */\n      zoomOutButton() {\n        this.setBpPerPx(self.bpPerPx * 1.4)\n      },\n\n      /**\n       * #action\n       */\n      setBpPerPx(newVal: number) {\n        self.bpPerPx = clamp(newVal, self.minBpPerPx, self.maxBpPerPx)\n      },\n\n      /**\n       * #action\n       */\n      setModelViewWhenAdjust(secondCondition: boolean) {\n        if (self.lockedFitToWindow && secondCondition) {\n          this.setBpPerPx(self.minBpPerPx)\n        }\n      },\n\n      /**\n       * #action\n       */\n      setDisplayedRegions(regions: Region[]) {\n        const previouslyEmpty = self.displayedRegions.length === 0\n        self.displayedRegions = cast(regions)\n\n        if (previouslyEmpty) {\n          this.setBpPerPx(self.minBpPerPx)\n        } else {\n          this.setBpPerPx(self.bpPerPx)\n        }\n      },\n\n      /**\n       * #action\n       */\n      activateTrackSelector() {\n        if (self.trackSelectorType === 'hierarchical') {\n          const session = getSession(self)\n          if (isSessionModelWithWidgets(session)) {\n            const selector = session.addWidget(\n              'HierarchicalTrackSelectorWidget',\n              'hierarchicalTrackSelector',\n              { view: self },\n            )\n            session.showWidget(selector)\n            return selector\n          }\n        }\n        throw new Error(`invalid track selector type ${self.trackSelectorType}`)\n      },\n\n      /**\n       * #action\n       */\n      toggleTrack(trackId: string) {\n        toggleTrackGeneric(self, trackId)\n      },\n\n      /**\n       * #action\n       */\n      setError(error: unknown) {\n        self.volatileError = error\n      },\n\n      /**\n       * #action\n       */\n      setInit(init?: CircularViewInit) {\n        self.init = init\n      },\n\n      /**\n       * #action\n       */\n      showTrack(trackId: string, initialSnapshot = {}) {\n        showTrackGeneric(self, trackId, initialSnapshot)\n      },\n\n      /**\n       * #action\n       */\n      addTrackConf(configuration: AnyConfigurationModel, initialSnapshot = {}) {\n        const { type } = configuration\n        const name = readConfObject(configuration, 'name')\n        const trackType = pluginManager.getTrackType(type)\n        if (!trackType) {\n          throw new Error(`unknown track type ${type}`)\n        }\n        const viewType = pluginManager.getViewType(self.type)!\n        const supportedDisplays = new Set(\n          viewType.displayTypes.map(d => d.name),\n        )\n        const displayConf = configuration.displays.find(\n          (d: AnyConfigurationModel) => supportedDisplays.has(d.type),\n        )\n        self.tracks.push(\n          trackType.stateModel.create({\n            ...initialSnapshot,\n            name,\n            type,\n            configuration,\n            displays: [{ type: displayConf.type, configuration: displayConf }],\n          }),\n        )\n      },\n\n      /**\n       * #action\n       */\n      hideTrack(trackId: string) {\n        hideTrackGeneric(self, trackId)\n      },\n\n      /**\n       * #action\n       */\n      toggleFitToWindowLock() {\n        // when going unlocked -> locked and circle is cut off, set to the\n        // locked minBpPerPx\n        self.lockedFitToWindow = !self.lockedFitToWindow\n        this.setModelViewWhenAdjust(self.atMinBpPerPx)\n        return self.lockedFitToWindow\n      },\n      /**\n       * #action\n       * creates an svg export and save using FileSaver\n       */\n      async exportSvg(opts: ExportSvgOptions = {}) {\n        const { renderToSvg } =\n          await import('./svgcomponents/SVGCircularView.tsx')\n        const html = await renderToSvg(self as CircularViewModel, opts)\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        const { saveAs } = await import('file-saver-es')\n        saveAs(\n          new Blob([html], { type: 'image/svg+xml' }),\n          opts.filename || 'image.svg',\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function circularViewInitAutorun() {\n              const { init, initialized } = self\n              if (!initialized) {\n                return\n              }\n              if (init) {\n                const session = getSession(self)\n                const { assemblyManager } = session\n                const regions = assemblyManager.get(init.assembly)?.regions\n\n                if (regions) {\n                  self.setDisplayedRegions(regions)\n                }\n\n                if (init.tracks) {\n                  for (const trackId of init.tracks) {\n                    self.showTrack(trackId)\n                  }\n                }\n\n                self.setInit(undefined)\n              }\n            },\n            { name: 'CircularViewInit' },\n          ),\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * return the view menu items\n       */\n      menuItems(): MenuItem[] {\n        return [\n          {\n            label: 'Return to import form',\n            onClick: () => {\n              self.setDisplayedRegions([])\n            },\n            icon: FolderOpenIcon,\n          },\n          {\n            label: 'Export SVG',\n            icon: PhotoCameraIcon,\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                ExportSvgDialog,\n                { model: self, handleClose },\n              ])\n            },\n          },\n          {\n            label: 'Open track selector',\n            onClick: self.activateTrackSelector,\n            icon: TrackSelectorIcon,\n          },\n        ]\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        init,\n        offsetRadians,\n        bpPerPx,\n        hideVerticalResizeHandle,\n        hideTrackSelectorButton,\n        lockedFitToWindow,\n        disableImportForm,\n        height,\n        displayedRegions,\n        scrollX,\n        scrollY,\n        minimumRadiusPx,\n        spacingPx,\n        paddingPx,\n        lockedPaddingPx,\n        minVisibleWidth,\n        minimumBlockWidth,\n        trackSelectorType,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(offsetRadians !== defaultOffsetRadians ? { offsetRadians } : {}),\n        ...(bpPerPx !== defaultBpPerPx ? { bpPerPx } : {}),\n        ...(hideVerticalResizeHandle ? { hideVerticalResizeHandle } : {}),\n        ...(hideTrackSelectorButton ? { hideTrackSelectorButton } : {}),\n        ...(!lockedFitToWindow ? { lockedFitToWindow } : {}),\n        ...(disableImportForm ? { disableImportForm } : {}),\n        ...(height !== defaultHeight ? { height } : {}),\n        ...(displayedRegions.length ? { displayedRegions } : {}),\n        ...(scrollX ? { scrollX } : {}),\n        ...(scrollY ? { scrollY } : {}),\n        ...(minimumRadiusPx !== defaultMinimumRadiusPx\n          ? { minimumRadiusPx }\n          : {}),\n        ...(spacingPx !== defaultSpacingPx ? { spacingPx } : {}),\n        ...(paddingPx !== defaultPaddingPx ? { paddingPx } : {}),\n        ...(lockedPaddingPx !== defaultLockedPaddingPx\n          ? { lockedPaddingPx }\n          : {}),\n        ...(minVisibleWidth !== defaultMinVisibleWidth\n          ? { minVisibleWidth }\n          : {}),\n        ...(minimumBlockWidth !== defaultMinimumBlockWidth\n          ? { minimumBlockWidth }\n          : {}),\n        ...(trackSelectorType !== 'hierarchical' ? { trackSelectorType } : {}),\n      } as typeof snap\n    })\n}\n\nexport type CircularViewStateModel = ReturnType<typeof stateModelFactory>\nexport type CircularViewModel = Instance<CircularViewStateModel>\n\nexport default stateModelFactory\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport DataUsageIcon from '@mui/icons-material/DataUsage'\n\nimport CircularViewF from './CircularView/index.ts'\nimport LaunchCircularViewF from './LaunchCircularView/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default class CircularViewPlugin extends Plugin {\n  name = 'CircularViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    CircularViewF(pluginManager)\n    LaunchCircularViewF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['Add'], {\n        label: 'Circular view',\n        icon: DataUsageIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('CircularView', {})\n        },\n      })\n    }\n  }\n}\n\nexport {\n  type CircularViewModel,\n  type CircularViewStateModel,\n  type ExportSvgOptions,\n} from './CircularView/model.ts'\n","import { lazy } from 'react'\n\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\n\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function CircularViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(\n    () =>\n      new ViewType({\n        ReactComponent: lazy(() => import('./components/CircularView.tsx')),\n        stateModel: stateModelFactory(pluginManager),\n        name: 'CircularView',\n        displayName: 'Circular view',\n      }),\n  )\n}\n","import type { CircularViewModel } from '../CircularView/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\ntype CGV = CircularViewModel\n\nexport default function LaunchCircularViewF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-CircularView',\n    // @ts-expect-error\n    async ({\n      session,\n      assembly,\n      tracks = [],\n    }: {\n      session: AbstractSessionModel\n      assembly?: string\n      tracks?: string[]\n    }) => {\n      if (!assembly) {\n        throw new Error(\n          'No assembly provided when launching circular genome view',\n        )\n      }\n\n      // Use the init property to let the model handle initialization\n      session.addView('CircularView', {\n        init: {\n          assembly,\n          tracks,\n        },\n      }) as CGV\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BlastTabularAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BlastTabularAdapter = ConfigurationSchema(\n  'BlastTabularAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Query assembly is the first value in the array, target assembly is the second',\n    },\n\n    /**\n     * #slot\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the target assembly',\n    },\n    /**\n     * #slot\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the query assembly',\n    },\n    /**\n     * #slot\n     */\n    blastTableLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/blastTable.tsv',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    columns: {\n      type: 'string',\n      description:\n        'Optional space-separated column name list. If custom columns were used in outfmt, enter them here exactly as specified in the command. At least qseqid, sseqid, qstart, qend, sstart, and send are required',\n      defaultValue:\n        'qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore',\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default BlastTabularAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config ChainAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst ChainAdapter = ConfigurationSchema(\n  'ChainAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second',\n    },\n    /**\n     * #slot\n     * can be specified as alternative to assemblyNames\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the target assembly',\n    },\n    /**\n     * #slot\n     * can be specified as alternative to assemblyNames\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the query assembly',\n    },\n    /**\n     * #slot\n     */\n    chainLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/file.chain', locationType: 'UriLocation' },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"ChainAdapter\",\n     *   \"uri\": \"yourfile.chain.gz\",\n     *   \"queryAssembly\": \"hg19\",\n     *   \"targetAssembly\": \"hg38\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            chainLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default ChainAdapter\n","export const syntenyTypes = [\n  'PAFAdapter',\n  'ChainAdapter',\n  'DeltaAdapter',\n  'BlastTabularAdapter',\n  'MashMapAdapter',\n  'MCScanAnchorsAdapter',\n  'MCScanSimpleAnchorsAdapter',\n  'PairwiseIndexedPAFAdapter',\n]\n\nexport const pairwiseTypes = [\n  'PAFAdapter',\n  'ChainAdapter',\n  'DeltaAdapter',\n  'MashMapAdapter',\n  'BlastTabularAdapter',\n  'PairwiseIndexedPAFAdapter',\n]\n\nexport const mcscanTypes = [\n  'MCScanAnchorsAdapter',\n  'MCScanSimpleAnchorsAdapter',\n]\n","import { lazy } from 'react'\n\nimport { pairwiseTypes } from '../syntenyTypes.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n// lazies\nconst ComparativeAddTrackComponent = lazy(\n  () => import('./ComparativeAddTrackComponent.tsx'),\n)\n\nexport default function ComparativeAddTrackComponentF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addToExtensionPoint(\n    'Core-addTrackComponent',\n    // @ts-expect-error\n    (comp, { model }: { trackAdapterType: string }) => {\n      return pairwiseTypes.includes(model.trackAdapterType)\n        ? ComparativeAddTrackComponent\n        : comp\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config DeltaAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst DeltaAdapter = ConfigurationSchema(\n  'DeltaAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second',\n    },\n    /**\n     * #slot\n     * alternative to assembly names\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the target assembly name',\n    },\n    /**\n     * #slot\n     * alternative to assembly names\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the query assembly name',\n    },\n    /**\n     * #slot\n     */\n    deltaLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.delta',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"DeltaAdapter\",\n     *   \"uri\": \"yourfile.delta.gz\",\n     *   \"queryAssembly\": \"hg19\",\n     *   \"targetAssembly\": \"hg38\"\n     * }\n     * ```\n     */\n\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            deltaLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default DeltaAdapter\n","import { lazy } from 'react'\n\nimport { mcscanTypes } from '../syntenyTypes.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n// lazies\nconst MCScanAddTrackComponent = lazy(\n  () => import('./MCScanAddTrackComponent.tsx'),\n)\n\nexport default function MCScanAddTrackComponentF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-addTrackComponent',\n    // @ts-expect-error\n    (comp, { model }: { trackAdapterType: string }) => {\n      return mcscanTypes.includes(model.trackAdapterType)\n        ? MCScanAddTrackComponent\n        : comp\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config MCScanAnchorsAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst MCScanAnchorsAdapter = ConfigurationSchema(\n  'MCScanAnchorsAdapter',\n  {\n    /**\n     * #slot\n     */\n    mcscanAnchorsLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/mcscan.anchors',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    bed1Location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.bed',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    bed2Location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.bed',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"MCScanAnchorsAdapter\",\n     *   \"uri\": \"file.anchors\",\n     *   \"bed1\": \"bed1.bed\",\n     *   \"bed2\": \"bed2.bed\",\n     *   \"assemblyNames\": [\"hg19\", \"hg38\"],\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      return snap.uri && snap.bed1 && snap.bed2\n        ? {\n            ...snap,\n            mcscanAnchorsLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            bed1Location: {\n              uri: snap.bed1,\n              baseUri: snap.baseUri,\n            },\n            bed2Location: {\n              uri: snap.bed2,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default MCScanAnchorsAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config MCScanSimpleAnchorsAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst MCScanSimpleAnchorsAdapter = ConfigurationSchema(\n  'MCScanSimpleAnchorsAdapter',\n  {\n    /**\n     * #slot\n     */\n    mcscanSimpleAnchorsLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/mcscan.anchors.simple',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    bed1Location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.bed',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    bed2Location: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.bed',\n        locationType: 'UriLocation',\n      },\n    },\n\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"MCScanSimpleAnchorsAdapter\",\n     *   \"uri\": \"file.anchors\",\n     *   \"bed1\": \"bed1.bed\",\n     *   \"bed2\": \"bed2.bed\",\n     *   \"assemblyNames\": [\"hg19\", \"hg38\"],\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      return snap.uri && snap.bed1 && snap.bed2\n        ? {\n            ...snap,\n            mcscanSimpleAnchorsLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            bed1Location: {\n              uri: snap.bed1,\n              baseUri: snap.baseUri,\n            },\n            bed2Location: {\n              uri: snap.bed2,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default MCScanSimpleAnchorsAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config MashMapAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst MashMapAdapter = ConfigurationSchema(\n  'MashMapAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second',\n    },\n\n    /**\n     * #slot\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the target assembly',\n    },\n    /**\n     * #slot\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames array: the query assembly',\n    },\n    /**\n     * #slot\n     */\n    outLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/mashmap.out',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"MashMapAdapter\",\n     *   \"uri\": \"file.out\",\n     *   \"queryAssembly\":\"hg19\",\n     *   \"targetAssembly\":\"hg38\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            outLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default MashMapAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config PAFAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst PAFAdapter = ConfigurationSchema(\n  'PAFAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second',\n    },\n    /**\n     * #slot\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the target assembly name',\n    },\n    /**\n     * #slot\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the query assembly name',\n    },\n    /**\n     * #slot\n     */\n    pafLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/file.paf',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"PAFAdapter\",\n     *   \"uri\": \"file.paf.gz\",\n     *   \"queryAssembly\":\"hg19\",\n     *   \"targetAssembly\":\"hg38\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            pafLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default PAFAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config PairwiseIndexedPAFAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst PairwiseIndexedPAFAdapter = ConfigurationSchema(\n  'PairwiseIndexedPAFAdapter',\n  {\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Array of assembly names to use for this file. The query assembly name is the first value in the array, target assembly name is the second',\n    },\n    /**\n     * #slot\n     */\n    targetAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the target assembly name',\n    },\n    /**\n     * #slot\n     */\n    queryAssembly: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Alternative to assemblyNames: the query assembly name',\n    },\n    /**\n     * #slot\n     */\n    pifGzLocation: {\n      type: 'fileLocation',\n      description: 'location of pairwise tabix indexed PAF (pif)',\n      defaultValue: {\n        uri: '/path/to/data/file.pif.gz',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    index: ConfigurationSchema('TabixIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['TBI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'TBI',\n      },\n      /**\n       * #slot index.location\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.paf.gz.tbi',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes file.pif.gz.tbi:\n     * ```json\n     * {\n     *   \"type\": \"PairwiseIndexedPAFAdapter\",\n     *   \"uri\": \"file.pif.gz\",\n     *   \"queryAssembly\": \"hg19\",\n     *   \"targetAssembly\": \"hg38\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            pifGzLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.tbi`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default PairwiseIndexedPAFAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport BlastTabularAdapter from './BlastTabularAdapter/index.ts'\nimport ChainAdapterF from './ChainAdapter/index.ts'\nimport ComparativeAddTrackComponentF from './ComparativeAddTrackComponent/index.tsx'\nimport DeltaAdapterF from './DeltaAdapter/index.ts'\nimport GuessAdapterF from './GuessAdapter/index.ts'\nimport MCScanAddTrackComponentF from './MCScanAddTrackComponent/index.tsx'\nimport MCScanAnchorsAdapterF from './MCScanAnchorsAdapter/index.ts'\nimport MCScanSimpleAnchorsAdapterF from './MCScanSimpleAnchorsAdapter/index.ts'\nimport MashMapAdapterF from './MashMapAdapter/index.ts'\nimport PAFAdapterF from './PAFAdapter/index.ts'\nimport PairwiseIndexedPAFAdapterF from './PairwiseIndexedPAFAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class ComparativeAdaptersPlugin extends Plugin {\n  name = 'ComparativeAdaptersPlugin'\n\n  install(pluginManager: PluginManager) {\n    PAFAdapterF(pluginManager)\n    PairwiseIndexedPAFAdapterF(pluginManager)\n    DeltaAdapterF(pluginManager)\n    ChainAdapterF(pluginManager)\n    MCScanAnchorsAdapterF(pluginManager)\n    MCScanSimpleAnchorsAdapterF(pluginManager)\n    MashMapAdapterF(pluginManager)\n    BlastTabularAdapter(pluginManager)\n    ComparativeAddTrackComponentF(pluginManager)\n    MCScanAddTrackComponentF(pluginManager)\n    GuessAdapterF(pluginManager)\n  }\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function PAFAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'PAFAdapter',\n        displayName: 'PAF adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () => import('./PAFAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function PairwiseIndexedPAFAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'PairwiseIndexedPAFAdapter',\n        displayName: 'Pairwise indexed PAF adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () =>\n          import('./PairwiseIndexedPAFAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function DeltaAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'DeltaAdapter',\n        displayName: 'MUMmer delta adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () => import('./DeltaAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function ChainAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'ChainAdapter',\n        displayName: 'Liftover chain adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () => import('./ChainAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MCScanAnchorsAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'MCScanAnchorsAdapter',\n        displayName: 'MCScan anchors adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n\n        getAdapterClass: () =>\n          import('./MCScanAnchorsAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MCScanSimpleAnchorsAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'MCScanSimpleAnchorsAdapter',\n        displayName: 'MCScan anchors.simple adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () =>\n          import('./MCScanSimpleAnchorsAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MashMapAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'MashMapAdapter',\n        displayName: 'MashMap adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () =>\n          import('./MashMapAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BlastTabularAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'BlastTabularAdapter',\n        displayName: 'Tabular BLAST output adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Synteny adapters',\n        },\n        getAdapterClass: () =>\n          import('./BlastTabularAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport {\n  getFileName,\n  makeIndex,\n  makeIndexType,\n} from '@jbrowse/core/util/tracks'\n\nimport { syntenyTypes } from '../syntenyTypes.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAdapterF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        const indexName = index && getFileName(index)\n        if (testAdapter(fileName, /\\.paf(.gz)?/i, adapterHint, 'PAFAdapter')) {\n          return {\n            type: 'PAFAdapter',\n            pafLocation: file,\n          }\n        } else if (adapterHint === 'BlastTabularAdapter') {\n          return {\n            type: 'BlastTabularAdapter',\n            blastTableLocation: file,\n          }\n        } else if (\n          testAdapter(\n            fileName,\n            /\\.anchors.simple(.gz)?/i,\n            adapterHint,\n            'MCScanSimpleAnchorsAdapter',\n          )\n        ) {\n          return {\n            type: 'MCScanSimpleAnchorsAdapter',\n            mcscanSimpleAnchorsLocation: file,\n          }\n        } else if (\n          testAdapter(\n            fileName,\n            /\\.anchors(.gz)?/i,\n            adapterHint,\n            'MCScanAnchorsAdapter',\n          )\n        ) {\n          return {\n            type: 'MCScanAnchorsAdapter',\n            mcscanAnchorsLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.delta(.gz)?/i, adapterHint, 'DeltaAdapter')\n        ) {\n          return {\n            type: 'DeltaAdapter',\n            deltaLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.chain(.gz)?/i, adapterHint, 'ChainAdapter')\n        ) {\n          return {\n            type: 'ChainAdapter',\n            chainLocation: file,\n          }\n        } else if (\n          testAdapter(fileName, /\\.out(.gz)?/i, adapterHint, 'MashMapAdapter')\n        ) {\n          return {\n            type: 'MashMapAdapter',\n            outLocation: file,\n          }\n        } else if (\n          testAdapter(\n            fileName,\n            /\\.pif\\.gz/i,\n            adapterHint,\n            'PairwiseIndexedPAFAdapter',\n          )\n        ) {\n          return {\n            type: 'PairwiseIndexedPAFAdapter',\n            pifGzLocation: file,\n            index: {\n              location: index || makeIndex(file, '.tbi'),\n              indexType: makeIndexType(indexName, 'CSI', 'TBI'),\n            },\n          }\n        } else {\n          return adapterGuesser(file, index, adapterHint)\n        }\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) =>\n        syntenyTypes.includes(adapterName)\n          ? 'SyntenyTrack'\n          : trackTypeGuesser(adapterName)\n    },\n  )\n}\n","import RpcMethodType from '@jbrowse/core/pluggableElementTypes/RpcMethodType'\nimport { checkStopToken } from '@jbrowse/core/util/stopToken'\n\nimport type {\n  DotplotRenderArgs,\n  RenderArgsSerialized,\n  ResultsSerialized,\n} from '../DotplotRenderer/DotplotRenderer.ts'\nimport type DotplotRenderer from '../DotplotRenderer/DotplotRenderer.ts'\nimport type { RenderResults } from '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType'\n\ninterface RenderArgs extends DotplotRenderArgs {\n  rendererType: string\n}\n\ninterface RenderArgsSerializedWithRenderer extends RenderArgsSerialized {\n  adapterConfig: Record<string, unknown>\n  rendererType: string\n}\n\nexport default class ComparativeRender extends RpcMethodType {\n  name = 'ComparativeRender'\n\n  async renameRegionsIfNeeded(args: RenderArgs, rend: DotplotRenderer) {\n    return rend.renameRegionsIfNeeded(args)\n  }\n\n  getRenderer(rendererType: string) {\n    const pm = this.pluginManager\n    return pm.getRendererType(rendererType) as DotplotRenderer\n  }\n\n  async serializeArguments(args: RenderArgs, rpcDriver: string) {\n    const { rendererType } = args\n    const renderer = this.getRenderer(rendererType)\n    const n = (await super.serializeArguments(args, rpcDriver)) as RenderArgs\n    const result = await this.renameRegionsIfNeeded(n, renderer)\n\n    return renderer.serializeArgsInClient(result)\n  }\n\n  async execute(\n    args: RenderArgsSerializedWithRenderer & { stopToken?: string },\n    rpcDriver: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(args, rpcDriver)\n    const { sessionId, rendererType, stopToken } = deserializedArgs\n    if (!sessionId) {\n      throw new Error('must pass a unique session id')\n    }\n\n    checkStopToken(stopToken)\n\n    const renderer = this.getRenderer(rendererType)\n    return renderer.renderInWorker(deserializedArgs)\n  }\n\n  async deserializeReturn(\n    val: RenderResults | ResultsSerialized,\n    args: RenderArgs,\n    rpcDriver: string,\n  ): Promise<unknown> {\n    const ret = (await super.deserializeReturn(\n      val,\n      args,\n      rpcDriver,\n    )) as ResultsSerialized\n\n    const renderer = this.getRenderer(args.rendererType)\n    return renderer.deserializeResultsInClient(ret, args)\n  }\n}\n","import Base1DView from '@jbrowse/core/util/Base1DViewModel'\nimport calculateDynamicBlocks from '@jbrowse/core/util/calculateDynamicBlocks'\nimport { getParent } from '@jbrowse/mobx-state-tree'\nimport { observable } from 'mobx'\n\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel Dotplot1DView\n * ref https://@jbrowse/mobx-state-tree.js.org/concepts/volatiles on volatile state used here\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst Dotplot1DView = Base1DView.extend(self => {\n  const scaleFactor = observable.box(1)\n  return {\n    views: {\n      /**\n       * #getter\n       * this uses padding=false and elision=false\n       */\n      get dynamicBlocks() {\n        return calculateDynamicBlocks(self, false, false)\n      },\n      /**\n       * #getter\n       */\n\n      get scaleFactor() {\n        return scaleFactor.get()\n      },\n\n      /**\n       * #getter\n       */\n      get maxBpPerPx() {\n        return self.totalBp / (self.width * 0.9)\n      },\n\n      /**\n       * #getter\n       */\n      get minBpPerPx() {\n        return 1 / 50\n      },\n\n      /**\n       * #getter\n       */\n      get maxOffset() {\n        const contentPx = self.displayedRegionsTotalPx\n        const viewWidth = self.width\n        // When content is smaller than view (zoomed out), center it\n        if (contentPx <= viewWidth) {\n          return (contentPx - viewWidth) / 2\n        }\n        // Otherwise allow scrolling with small padding\n        const leftPadding = 10\n        return contentPx - leftPadding\n      },\n\n      /**\n       * #getter\n       */\n      get minOffset() {\n        const contentPx = self.displayedRegionsTotalPx\n        const viewWidth = self.width\n        // When content is smaller than view (zoomed out), center it\n        if (contentPx <= viewWidth) {\n          return (contentPx - viewWidth) / 2\n        }\n        // Otherwise allow scrolling with small padding\n        const rightPadding = 30\n        return -viewWidth + rightPadding\n      },\n    },\n    actions: {\n      /**\n       * #action\n       */\n      setScaleFactor(n: number) {\n        scaleFactor.set(n)\n      },\n\n      /**\n       * #action\n       */\n      center() {\n        const centerBp = self.totalBp / 2\n        const centerPx = centerBp / self.bpPerPx\n        self.scrollTo(centerPx - self.width / 2)\n      },\n    },\n  }\n})\n\nconst DotplotHView = Dotplot1DView.extend(self => ({\n  views: {\n    get width() {\n      return getParent<any>(self).viewWidth\n    },\n  },\n}))\n\nconst DotplotVView = Dotplot1DView.extend(self => ({\n  views: {\n    get width() {\n      return getParent<any>(self).viewHeight\n    },\n  },\n}))\n\nexport { Dotplot1DView, DotplotHView, DotplotVView }\nexport type Dotplot1DViewModel = Instance<typeof Dotplot1DView>\n","import RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\nimport { checkStopToken } from '@jbrowse/core/util/stopToken'\n\nimport { Dotplot1DView } from './DotplotView/model.ts'\n\nimport type { Dotplot1DViewModel } from './DotplotView/model.ts'\nimport type { Feature, Region } from '@jbrowse/core/util'\n\n// Copied types from linear-comparative-view to avoid cross-package imports\ninterface AlignmentData {\n  queryRefName: string\n  refRefName: string\n  queryStart: number\n  queryEnd: number\n  refStart: number\n  refEnd: number\n  strand: number\n}\n\ninterface DiagonalizationResult {\n  newRegions: Region[]\n  stats: {\n    totalAlignments: number\n    regionsProcessed: number\n    regionsReordered: number\n    regionsReversed: number\n  }\n}\n\ntype ProgressCallback = (progress: number, message: string) => void\n\n/**\n * Diagonalize a set of regions based on alignment data.\n * Copied from linear-comparative-view to avoid cross-package imports.\n */\nasync function diagonalizeRegions(\n  alignments: AlignmentData[],\n  currentRegions: Region[],\n  progressCallback?: ProgressCallback,\n): Promise<DiagonalizationResult> {\n  const updateProgress = (progress: number, message: string) => {\n    if (progressCallback) {\n      progressCallback(progress, message)\n    }\n  }\n\n  updateProgress(20, `Grouping ${alignments.length} alignments...`)\n\n  // Group alignments by the second view's refName (mate.refName)\n  const queryGroups = new Map<\n    string,\n    {\n      refAlignments: Map<string, { bases: number; positions: number[] }>\n      strandWeightedSum: number\n    }\n  >()\n\n  for (const aln of alignments) {\n    const targetRefName = aln.refRefName\n\n    if (!queryGroups.has(targetRefName)) {\n      queryGroups.set(targetRefName, {\n        refAlignments: new Map(),\n        strandWeightedSum: 0,\n      })\n    }\n\n    const group = queryGroups.get(targetRefName)!\n    const alnLength = Math.abs(aln.queryEnd - aln.queryStart)\n\n    if (!group.refAlignments.has(aln.queryRefName)) {\n      group.refAlignments.set(aln.queryRefName, {\n        bases: 0,\n        positions: [],\n      })\n    }\n\n    const refData = group.refAlignments.get(aln.queryRefName)!\n    refData.bases += alnLength\n    refData.positions.push((aln.queryStart + aln.queryEnd) / 2)\n\n    const direction = aln.strand >= 0 ? 1 : -1\n    group.strandWeightedSum += direction * alnLength\n  }\n\n  updateProgress(50, 'Determining optimal ordering and orientation...')\n\n  // Determine ordering and orientation for query regions\n  const queryOrdering: {\n    refName: string\n    bestRefName: string\n    bestRefPos: number\n    shouldReverse: boolean\n  }[] = []\n\n  for (const [targetRefName, group] of queryGroups) {\n    let bestRefName = ''\n    let maxBases = 0\n    let bestPositions: number[] = []\n\n    for (const [firstViewRefName, data] of group.refAlignments) {\n      if (data.bases > maxBases) {\n        maxBases = data.bases\n        bestRefName = firstViewRefName\n        bestPositions = data.positions\n      }\n    }\n\n    const bestRefPos =\n      bestPositions.reduce((a, b) => a + b, 0) / bestPositions.length\n    const shouldReverse = group.strandWeightedSum < 0\n\n    queryOrdering.push({\n      refName: targetRefName,\n      bestRefName,\n      bestRefPos,\n      shouldReverse,\n    })\n  }\n\n  updateProgress(70, `Sorting ${queryOrdering.length} query regions...`)\n\n  queryOrdering.sort((a, b) => {\n    if (a.bestRefName !== b.bestRefName) {\n      return a.bestRefName.localeCompare(b.bestRefName)\n    }\n    return a.bestRefPos - b.bestRefPos\n  })\n\n  updateProgress(85, 'Building new region layout...')\n\n  const newQueryRegions: Region[] = []\n  let regionsReversed = 0\n\n  for (const { refName, shouldReverse } of queryOrdering) {\n    const region = currentRegions.find(r => r.refName === refName)\n    if (region) {\n      newQueryRegions.push({\n        ...region,\n        reversed: shouldReverse,\n      })\n      if (shouldReverse !== region.reversed) {\n        regionsReversed++\n      }\n    }\n  }\n\n  // Preserve regions without alignments at the end\n  const regionsWithoutAlignments = currentRegions.filter(\n    r => !newQueryRegions.some(nr => nr.refName === r.refName),\n  )\n\n  updateProgress(100, 'Diagonalization complete!')\n\n  return {\n    newRegions: [...newQueryRegions, ...regionsWithoutAlignments],\n    stats: {\n      totalAlignments: alignments.length,\n      regionsProcessed: queryOrdering.length,\n      regionsReordered: newQueryRegions.length,\n      regionsReversed,\n    },\n  }\n}\n\ninterface DiagonalizeDotplotArgs {\n  sessionId: string\n  view: {\n    hview: { displayedRegions: Region[] }\n    vview: { displayedRegions: Region[] }\n  }\n  adapterConfig: Record<string, unknown>\n  stopToken?: string\n  statusCallback?: (message: string) => void\n}\n\n/**\n * RPC method to diagonalize a dotplot view on the webworker\n */\nexport default class DiagonalizeDotplotRpc extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'DiagonalizeDotplot'\n\n  async execute(args: DiagonalizeDotplotArgs, rpcDriverClassName: string) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { view, sessionId, adapterConfig, stopToken, statusCallback } =\n      deserializedArgs\n\n    if (!sessionId) {\n      throw new Error('must pass a unique session id')\n    }\n\n    statusCallback?.('Initializing diagonalization...')\n\n    // Create view instances on the worker to access features\n    const dimensions = [800, 800] // Dummy dimensions, we only need features\n    const views = [view.hview, view.vview].map((snap, idx) => {\n      const v = Dotplot1DView.create(snap)\n      v.setVolatileWidth(dimensions[idx]!)\n      return v\n    }) as [Dotplot1DViewModel, Dotplot1DViewModel]\n\n    const targetView = views[0]\n\n    checkStopToken(stopToken)\n    statusCallback?.('Getting renderer...')\n\n    // Get the renderer to access features\n    const rendererType = this.pluginManager.getRendererType('DotplotRenderer')\n    if (!rendererType) {\n      throw new Error('DotplotRenderer not found')\n    }\n\n    checkStopToken(stopToken)\n    statusCallback?.('Fetching features...')\n\n    // Get features from adapter - DotplotRenderer extends ComparativeRenderer\n    // which has getFeatures method\n    const feats = await (\n      rendererType as unknown as {\n        getFeatures: (args: {\n          regions: Region[]\n          adapterConfig: Record<string, unknown>\n          sessionId: string\n        }) => Promise<Map<string, Feature>>\n      }\n    ).getFeatures({\n      regions: targetView.dynamicBlocks.contentBlocks,\n      adapterConfig,\n      sessionId,\n    })\n\n    checkStopToken(stopToken)\n    statusCallback?.('Extracting alignment data...')\n\n    // Extract alignment data from features\n    const alignments: AlignmentData[] = []\n\n    for (const feat of feats.values()) {\n      const mate = feat.get('mate') as\n        | {\n            refName: string\n            start: number\n            end: number\n          }\n        | undefined\n\n      if (mate) {\n        alignments.push({\n          queryRefName: feat.get('refName'),\n          refRefName: mate.refName,\n          queryStart: feat.get('start'),\n          queryEnd: feat.get('end'),\n          refStart: mate.start,\n          refEnd: mate.end,\n          strand: (feat.get('strand') as number) || 1,\n        })\n      }\n    }\n\n    if (alignments.length === 0) {\n      throw new Error('No alignments found to diagonalize')\n    }\n\n    statusCallback?.(\n      `Running diagonalization on ${alignments.length} alignments...`,\n    )\n\n    // Run diagonalization algorithm with progress callback\n    const result = await diagonalizeRegions(\n      alignments,\n      view.vview.displayedRegions,\n      (progress, message) => {\n        checkStopToken(stopToken)\n        statusCallback?.(message)\n      },\n    )\n\n    statusCallback?.('Diagonalization complete!')\n    return result\n  }\n}\n","import type { CSSProperties } from 'react'\n\nimport { ErrorMessage, LoadingEllipses } from '@jbrowse/core/ui'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { observer } from 'mobx-react'\n\nconst useStyles = makeStyles()(theme => {\n  const bg = theme.palette.action.disabledBackground\n  return {\n    loading: {\n      paddingLeft: '0.6em',\n      backgroundColor: theme.palette.background.default,\n      backgroundImage: `repeating-linear-gradient(45deg, transparent, transparent 5px, ${bg} 5px, ${bg} 10px)`,\n      textAlign: 'center',\n    },\n  }\n})\n\nfunction LoadingMessage() {\n  const { classes } = useStyles()\n  return (\n    <div className={classes.loading}>\n      <LoadingEllipses />\n    </div>\n  )\n}\n\nfunction BlockMessage({ messageText }: { messageText: string }) {\n  const { classes } = useStyles()\n  return (\n    <div className={classes.loading}>\n      <LoadingEllipses message={messageText} />\n    </div>\n  )\n}\n\nfunction BlockError({ error }: { error: unknown }) {\n  return <ErrorMessage error={error} />\n}\n\nconst ServerSideRenderedDotplotContent = observer(\n  function ServerSideRenderedDotplotContent({\n    model,\n    style,\n  }: {\n    model: {\n      error?: unknown\n      message?: string\n      filled?: boolean\n      shouldDisplay?: boolean\n      reactElement?: React.ReactElement\n    }\n    style: CSSProperties\n  }) {\n    if (model.error) {\n      return <BlockError error={model.error} data-testid=\"reload_button\" />\n    } else if (model.message) {\n      return <BlockMessage messageText={model.message} />\n    } else if (!model.filled) {\n      return <LoadingMessage />\n    } else if (model.shouldDisplay) {\n      return <div style={style}>{model.reactElement}</div>\n    }\n    return null\n  },\n)\n\nexport default ServerSideRenderedDotplotContent\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n} from '@jbrowse/core/util'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport { getSnapshot } from '@jbrowse/mobx-state-tree'\n\nimport type { DotplotViewModel } from '../DotplotView/model.ts'\nimport type { IAnyStateTreeNode } from '@jbrowse/mobx-state-tree'\n\nexport function renderBlockData(self: IAnyStateTreeNode) {\n  const { rpcManager } = getSession(self)\n  const { rendererType } = self\n  const { adapterConfig } = self\n  const parent = getContainingView(self) as DotplotViewModel\n\n  // Alternative to readConfObject(config) is below used because renderProps is\n  // something under our control.  Compare to serverSideRenderedBlock\n  readConfObject(self.configuration)\n  getSnapshot(parent)\n\n  // Access alpha, minAlignmentLength, and colorBy to make reaction reactive to changes\n  if (parent.initialized) {\n    const { viewWidth, viewHeight, borderSize, borderX, borderY } = parent\n    return {\n      rendererType,\n      rpcManager,\n      renderProps: {\n        ...self.renderProps(),\n        view: structuredClone(getSnapshot(parent)),\n        width: viewWidth,\n        height: viewHeight,\n        borderSize,\n        borderX,\n        borderY,\n        adapterConfig,\n        rendererType: rendererType.name,\n        sessionId: getRpcSessionId(self),\n        trackInstanceId: getContainingTrack(self).id,\n        timeout: 1000000, // 10000,\n        alpha: self.alpha,\n        minAlignmentLength: self.minAlignmentLength,\n        colorBy: self.colorBy,\n      },\n      renderingProps: self.renderingProps?.() as\n        | Record<string, unknown>\n        | undefined,\n    }\n  }\n  return undefined\n}\n\nexport async function renderBlockEffect(\n  props?: ReturnType<typeof renderBlockData>,\n) {\n  if (!props) {\n    return\n  }\n\n  const { rendererType, rpcManager, renderProps, renderingProps } = props\n  const { reactElement, ...data } = await rendererType.renderInClient(\n    rpcManager,\n    { ...renderProps, renderingProps },\n  )\n  return {\n    reactElement,\n    data,\n    renderingComponent: rendererType.ReactComponent,\n  }\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport {\n  ReactRendering,\n  getContainingView,\n  makeAbortableReaction,\n} from '@jbrowse/core/util'\nimport { getParentRenderProps } from '@jbrowse/core/util/tracks'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport ServerSideRenderedBlockContent from '../ServerSideRenderedBlockContent.tsx'\nimport { renderBlockData, renderBlockEffect } from './renderDotplotBlock.ts'\n\nimport type {\n  DotplotViewModel,\n  ExportSvgOptions,\n} from '../DotplotView/model.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { ThemeOptions } from '@mui/material'\n\n/**\n * #stateModel DotplotDisplay\n * #category display\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'DotplotDisplay',\n      BaseDisplay,\n      types\n        .model({\n          /**\n           * #property\n           */\n          type: types.literal('DotplotDisplay'),\n          /**\n           * #property\n           */\n          configuration: ConfigurationReference(configSchema),\n          /**\n           * #property\n           * color by setting that overrides the config setting\n           */\n          colorBy: types.optional(types.string, 'default'),\n        })\n        .volatile(() => ({\n          /**\n           * #volatile\n           */\n          stopToken: undefined as StopToken | undefined,\n          /**\n           * #volatile\n           */\n          warnings: [] as { message: string; effect: string }[],\n          /**\n           * #volatile\n           */\n          filled: false,\n          /**\n           * #volatile\n           */\n          data: undefined as any,\n          /**\n           * #volatile\n           */\n          reactElement: undefined as React.ReactElement | undefined,\n          /**\n           * #volatile\n           */\n          message: undefined as string | undefined,\n          /**\n           * #volatile\n           */\n          renderingComponent: undefined as any,\n          /**\n           * #volatile\n           */\n          ReactComponent2:\n            ServerSideRenderedBlockContent as unknown as React.FC<any>,\n          /**\n           * #volatile\n           * alpha transparency value for synteny drawing (0-1)\n           */\n          alpha: 1,\n          /**\n           * #volatile\n           * minimum alignment length to display (in bp)\n           */\n          minAlignmentLength: 0,\n        })),\n    )\n    .views(self => ({\n      get shouldDisplay() {\n        const { vview, hview } = getContainingView(self) as DotplotViewModel\n        return (\n          vview.bpPerPx === self.data.bpPerPxY &&\n          hview.bpPerPx === self.data.bpPerPxX\n        )\n      },\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return getConf(self, ['renderer', 'type'])\n      },\n      /**\n       * #method\n       */\n      renderProps() {\n        return {\n          ...getParentRenderProps(self),\n          rpcDriverName: self.rpcDriverName,\n          config: self.configuration.renderer,\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      async renderSvg(opts: ExportSvgOptions & { theme?: ThemeOptions }) {\n        const props = renderBlockData(self)\n        if (!props) {\n          return null\n        }\n\n        const { rendererType, rpcManager, renderProps, renderingProps } = props\n        const rendering = await rendererType.renderInClient(rpcManager, {\n          ...renderProps,\n          renderingProps,\n          exportSVG: opts,\n          theme: opts.theme || renderProps.theme,\n        })\n        const { hview, vview } = getContainingView(self) as DotplotViewModel\n        const offX = -hview.offsetPx + rendering.offsetX\n        const offY = -vview.offsetPx + rendering.offsetY\n        return (\n          <g transform={`translate(${offX} ${-offY})`}>\n            <ReactRendering rendering={rendering} />\n          </g>\n        )\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        makeAbortableReaction(\n          self,\n          () => renderBlockData(self),\n          blockData => renderBlockEffect(blockData),\n          {\n            name: `${self.type} ${self.id} rendering`,\n            delay: 500,\n            fireImmediately: true,\n          },\n          this.setLoading,\n          this.setRendered,\n          this.setError,\n        )\n      },\n      /**\n       * #action\n       */\n      setLoading(stopToken?: StopToken) {\n        self.filled = false\n        self.message = undefined\n        self.reactElement = undefined\n        self.data = undefined\n        self.error = undefined\n        self.renderingComponent = undefined\n        self.stopToken = stopToken\n      },\n      /**\n       * #action\n       */\n      setMessage(messageText: string) {\n        self.message = messageText\n      },\n      /**\n       * #action\n       */\n      setRendered(args?: {\n        data: any\n        reactElement: React.ReactElement\n        renderingComponent: React.Component\n      }) {\n        if (args === undefined) {\n          return\n        }\n        const { data, reactElement, renderingComponent } = args\n        self.warnings = data.warnings\n        self.filled = true\n        self.message = undefined\n        self.reactElement = reactElement\n        self.data = data\n        self.error = undefined\n        self.renderingComponent = renderingComponent\n        self.stopToken = undefined\n      },\n      /**\n       * #action\n       */\n      setError(error: unknown) {\n        console.error(error)\n        // the rendering failed for some reason\n        self.filled = false\n        self.message = undefined\n        self.reactElement = undefined\n        self.data = undefined\n        self.error = error\n        self.renderingComponent = undefined\n        self.stopToken = undefined\n      },\n      /**\n       * #action\n       */\n      setAlpha(value: number) {\n        self.alpha = value\n      },\n      /**\n       * #action\n       */\n      setMinAlignmentLength(value: number) {\n        self.minAlignmentLength = value\n      },\n      /**\n       * #action\n       */\n      setColorBy(value: string) {\n        self.colorBy = value\n      },\n    }))\n}\n\nexport type DotplotDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type DotplotDisplayModel = Instance<DotplotDisplayStateModel>\n","import { getConf } from '@jbrowse/core/configuration'\nimport { gatherOverlaps, getSession, sum } from '@jbrowse/core/util'\nimport { MismatchParser } from '@jbrowse/plugin-alignments'\n\nimport type { ReducedFeature } from '../util.ts'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { LinearPileupDisplayModel } from '@jbrowse/plugin-alignments'\n\nconst { featurizeSA, getClip, getLength, getLengthSansClipping } =\n  MismatchParser\n\nexport function onClick(feature: Feature, self: LinearPileupDisplayModel) {\n  const session = getSession(self)\n  try {\n    const cigar = feature.get('CIGAR')\n    const clipLengthAtStartOfRead = getClip(cigar, 1)\n    const flags = feature.get('flags')\n    const strand = feature.get('strand')\n    const readName = feature.get('name')\n    const readAssembly = `${readName}_assembly_${Date.now()}`\n    const { parentTrack } = self\n    const [trackAssembly] = getConf(parentTrack, 'assemblyNames')\n    const assemblyNames = [trackAssembly, readAssembly]\n    const trackId = `track-${Date.now()}`\n    const trackName = `${readName}_vs_${trackAssembly}`\n    const SA = feature.get('tags')?.SA as string\n    const SA2 = featurizeSA(SA, feature.id(), strand, readName, true)\n\n    // if secondary alignment or supplementary, calculate length from SA[0]'s\n    // CIGAR which is the primary alignments. otherwise it is the primary\n    // alignment just use seq.length if primary alignment\n    const totalLength = getLength(flags & 2048 ? SA2[0]!.CIGAR : cigar)\n\n    const features = (\n      [\n        {\n          ...feature.toJSON(),\n          strand: 1,\n          mate: {\n            refName: readName,\n            start: clipLengthAtStartOfRead,\n            end: clipLengthAtStartOfRead + getLengthSansClipping(cigar),\n          },\n        },\n        ...SA2,\n      ] as ReducedFeature[]\n    ).sort((a, b) => a.clipLengthAtStartOfRead - b.clipLengthAtStartOfRead)\n\n    session.addView('DotplotView', {\n      type: 'DotplotView',\n      hview: {\n        offsetPx: 0,\n        bpPerPx: sum(features.map(a => a.end - a.start)) / 800,\n        displayedRegions: gatherOverlaps(\n          features.map((f, index) => {\n            const { start, end, refName } = f\n            return {\n              start,\n              end,\n              refName,\n              index,\n              assemblyName: trackAssembly,\n            }\n          }),\n        ),\n      },\n      vview: {\n        offsetPx: 0,\n        bpPerPx: totalLength / 400,\n        minimumBlockWidth: 0,\n        interRegionPaddingWidth: 0,\n        displayedRegions: [\n          {\n            assemblyName: readAssembly,\n            start: 0,\n            end: totalLength,\n            refName: readName,\n          },\n        ],\n      },\n\n      viewTrackConfigs: [\n        {\n          type: 'SyntenyTrack',\n          assemblyNames,\n          adapter: {\n            type: 'FromConfigAdapter',\n            features,\n          },\n          trackId,\n          name: trackName,\n        },\n      ],\n      assemblyNames,\n      tracks: [\n        {\n          configuration: trackId,\n          type: 'SyntenyTrack',\n          displays: [\n            {\n              type: 'DotplotDisplay',\n              configuration: `${trackId}-DotplotDisplay`,\n            },\n          ],\n        },\n      ],\n\n      displayName: `${readName} vs ${trackAssembly}`,\n    })\n  } catch (e) {\n    console.error(e)\n    session.notifyError(`${e}`, e)\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport ServerSideRenderer from '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType'\nimport {\n  dedupe,\n  getSerializedSvg,\n  renameRegionsIfNeeded,\n  renderToAbstractCanvas,\n} from '@jbrowse/core/util'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\nimport { firstValueFrom } from 'rxjs'\nimport { filter, toArray } from 'rxjs/operators'\n\nimport { Dotplot1DView } from '../DotplotView/model.ts'\n\nimport type { Dotplot1DViewModel } from '../DotplotView/model.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\nimport type {\n  RenderArgs as ServerSideRenderArgs,\n  RenderArgsDeserialized as ServerSideRenderArgsDeserialized,\n  RenderArgsSerialized as ServerSideRenderArgsSerialized,\n  ResultsDeserialized as ServerSideResultsDeserialized,\n  ResultsSerialized as ServerSideResultsSerialized,\n} from '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType'\nimport type SerializableFilterChain from '@jbrowse/core/pluggableElementTypes/renderers/util/serializableFilterChain'\nimport type RpcManager from '@jbrowse/core/rpc/RpcManager'\nimport type { Region } from '@jbrowse/core/util'\n\nexport interface RenderArgs extends ServerSideRenderArgs {\n  blockKey: string\n}\n\nexport interface RenderArgsSerialized extends ServerSideRenderArgsSerialized {\n  blockKey: string\n}\n\nexport interface RenderArgsDeserialized extends ServerSideRenderArgsDeserialized {\n  blockKey: string\n}\n\nexport type ResultsSerialized = ServerSideResultsSerialized\n\nexport interface ResultsDeserialized extends ServerSideResultsDeserialized {\n  blockKey: string\n}\n\nexport interface DotplotRenderArgsDeserialized extends RenderArgsDeserialized {\n  adapterConfig: AnyConfigurationModel\n  height: number\n  width: number\n  highResolutionScaling: number\n  view: {\n    hview: Dotplot1DViewModel\n    vview: Dotplot1DViewModel\n  }\n}\n\nexport interface DotplotRenderArgs extends RenderArgs {\n  adapterConfig: AnyConfigurationModel\n  sessionId: string\n  view: {\n    hview: { displayedRegions: Region[] }\n    vview: { displayedRegions: Region[] }\n  }\n}\n\ninterface ResultsSerializedSvgExport extends ResultsSerialized {\n  canvasRecordedData: unknown\n  width: number\n  height: number\n}\n\nfunction isCanvasRecordedSvgExport(\n  e: ResultsSerialized,\n): e is ResultsSerializedSvgExport {\n  return 'canvasRecordedData' in e\n}\n\nfunction normalizeRegion(r: Region) {\n  return {\n    ...r,\n    start: Math.floor(r.start),\n    end: Math.ceil(r.end),\n  }\n}\n\nexport default class DotplotRenderer extends ServerSideRenderer {\n  supportsSVG = true\n\n  async renameRegionsIfNeeded(args: DotplotRenderArgs) {\n    const pm = this.pluginManager\n    const assemblyManager = pm.rootModel?.session?.assemblyManager\n\n    const { view, sessionId, adapterConfig } = args\n\n    async function process(regions?: Region[]) {\n      if (!assemblyManager) {\n        throw new Error('No assembly manager provided')\n      }\n      const result = await renameRegionsIfNeeded(assemblyManager, {\n        sessionId,\n        adapterConfig,\n        regions,\n      })\n      return result.regions\n    }\n\n    view.hview.displayedRegions = await process(view.hview.displayedRegions)\n    view.vview.displayedRegions = await process(view.vview.displayedRegions)\n\n    return args\n  }\n\n  serializeArgsInClient(args: RenderArgs) {\n    const { displayModel, ...serializable } = args\n    return super.serializeArgsInClient(serializable)\n  }\n\n  deserializeResultsInClient(\n    result: ResultsSerialized,\n    args: RenderArgs,\n  ): ResultsDeserialized {\n    return {\n      ...super.deserializeResultsInClient(result, args),\n      blockKey: args.blockKey,\n    }\n  }\n\n  async renderInClient(rpcManager: RpcManager, args: RenderArgs) {\n    const results = (await rpcManager.call(\n      args.sessionId,\n      'ComparativeRender',\n      args,\n    )) as ResultsSerialized\n\n    if (isCanvasRecordedSvgExport(results)) {\n      const { reactElement: _, ...rest } = results\n      return {\n        ...rest,\n        html: await getSerializedSvg(results),\n      }\n    }\n    return results\n  }\n\n  async getFeatures(renderArgs: {\n    regions: Region[]\n    sessionId: string\n    adapterConfig: AnyConfigurationModel\n    filters?: SerializableFilterChain\n  }) {\n    const { regions, sessionId, adapterConfig, filters } = renderArgs\n    const { dataAdapter } = await getAdapter(\n      this.pluginManager,\n      sessionId,\n      adapterConfig,\n    )\n    const res = await firstValueFrom(\n      (dataAdapter as BaseFeatureDataAdapter)\n        .getFeaturesInMultipleRegions(\n          regions.map(r => normalizeRegion(r)),\n          renderArgs,\n        )\n        .pipe(\n          filter(f => (filters ? filters.passes(f, renderArgs) : true)),\n          toArray(),\n        ),\n    )\n\n    // dedupe needed xref https://github.com/GMOD/jbrowse-components/pull/3404/\n    return dedupe(res, f => f.id())\n  }\n\n  async render(renderProps: DotplotRenderArgsDeserialized) {\n    const {\n      width,\n      height,\n      view: { hview, vview },\n    } = renderProps\n    const dimensions = [width, height]\n    const views = [hview, vview].map((snap, idx) => {\n      const view = Dotplot1DView.create(snap)\n      view.setVolatileWidth(dimensions[idx]!)\n      return view\n    })\n    const target = views[0]!\n    const feats = await this.getFeatures({\n      ...renderProps,\n      regions: target.dynamicBlocks.contentBlocks,\n    })\n    target.setFeatures(feats)\n\n    const { drawDotplot } = await import('./drawDotplot.ts')\n    const ret = await renderToAbstractCanvas(width, height, renderProps, ctx =>\n      drawDotplot(ctx, { ...renderProps, views }),\n    )\n\n    const serialized = {\n      ...ret,\n      height,\n      width,\n      offsetX: views[0]!.dynamicBlocks.blocks[0]?.offsetPx || 0,\n      offsetY: views[1]!.dynamicBlocks.blocks[0]?.offsetPx || 0,\n      bpPerPxX: views[0]!.bpPerPx,\n      bpPerPxY: views[1]!.bpPerPx,\n    }\n\n    return rpcResult(serialized, collectTransferables(ret))\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config DotplotRenderer\n * #category renderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default ConfigurationSchema(\n  'DotplotRenderer',\n  {\n    /**\n     * #slot\n     */\n    color: {\n      type: 'color',\n      description:\n        'the color of each feature in a synteny, used with colorBy:default',\n      defaultValue: '#f0f',\n      contextVariable: ['feature'],\n    },\n\n    /**\n     * #slot\n     */\n    posColor: {\n      type: 'color',\n      description: 'the color for forward alignments, used with colorBy:strand',\n      defaultValue: 'blue',\n    },\n    /**\n     * #slot\n     */\n    negColor: {\n      type: 'color',\n      description: 'the color for reverse alignments, used with colorBy:strand',\n      defaultValue: 'red',\n    },\n\n    /**\n     * #slot\n     */\n    lineWidth: {\n      type: 'number',\n      description: 'width of the lines to be drawn',\n      defaultValue: 2.5, // 2.5 is similar to D-GENIES\n    },\n\n    /**\n     * #slot\n     */\n    colorBy: {\n      type: 'stringEnum',\n      model: types.enumeration('colorBy', [\n        'identity',\n        'meanQueryIdentity',\n        'mappingQuality',\n        'strand',\n        'default',\n      ]),\n      description: `Color by options:<br/>\n<ul>\n  <li>\"identity\" - the identity of the particular hit, similar to D-GENIES, use the other config slots 'thresholds' and 'thresholdsPalette' to define colors for this setting</li>\n  <li>\"meanQueryIdentity\" - calculates the weighted mean identity (weighted by alignment length) of all the hits that the query maps to (e.g. if the query is split aligned to many target, uses their weighted mean. can help show patterns of more related and distant synteny after WGD)</li>\n  <li>\"mappingQuality\" - uses mapping quality from PAF, some adapters don't have this setting</li>\n  <li>\"strand\" - colors negative alignments with negColor and positive alignments with posColor</li>\n  <li>\"default\" - uses the 'color' config slot</li>\n</ul>`,\n      defaultValue: 'default',\n    },\n\n    /**\n     * #slot\n     */\n    thresholdsPalette: {\n      type: 'stringArray',\n      defaultValue: ['#094b09', '#2ebd40', '#d5670b', '#ffd84b'],\n      description: 'threshold colors, used with colorBy:identity',\n    },\n\n    /**\n     * #slot\n     */\n    thresholds: {\n      type: 'stringArray',\n      defaultValue: ['0.75', '0.5', '0.25', '0'],\n      description: 'threshold breakpoints, used with colorBy:identity',\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import type React from 'react'\nimport { lazy } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport BaseViewModel from '@jbrowse/core/pluggableElementTypes/models/BaseViewModel'\nimport { TrackSelector as TrackSelectorIcon } from '@jbrowse/core/ui/Icons'\nimport {\n  getSession,\n  getTickDisplayStr,\n  isSessionModelWithWidgets,\n  localStorageGetBoolean,\n  localStorageGetItem,\n  max,\n  measureText,\n  minmax,\n} from '@jbrowse/core/util'\nimport {\n  getParentRenderProps,\n  hideTrackGeneric,\n  showTrackGeneric,\n  toggleTrackGeneric,\n} from '@jbrowse/core/util/tracks'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport {\n  addDisposer,\n  cast,\n  getParent,\n  getSnapshot,\n  types,\n} from '@jbrowse/mobx-state-tree'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport PhotoCameraIcon from '@mui/icons-material/PhotoCamera'\nimport { autorun, observable } from 'mobx'\n\nimport { Dotplot1DView, DotplotHView, DotplotVView } from './1dview.ts'\nimport { getBlockLabelKeysToHide, makeTicks } from './components/util.ts'\n\nimport type { DotplotViewInit, ImportFormSyntenyTrack } from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\nimport type { BaseBlock } from '@jbrowse/core/util/blockTypes'\nimport type { Instance, SnapshotIn } from '@jbrowse/mobx-state-tree'\n\n// lazies\nconst ExportSvgDialog = lazy(() => import('./components/ExportSvgDialog.tsx'))\nconst ReturnToImportFormDialog = lazy(\n  () => import('@jbrowse/core/ui/ReturnToImportFormDialog'),\n)\ntype Coord = [number, number]\n\n// defaults for postProcessSnapshot filtering\nconst defaultHeight = 600\nconst defaultBorderSize = 20\nconst defaultTickSize = 5\nconst defaultHtextRotation = -90\nconst defaultFontSize = 15\n\nexport interface ExportSvgOptions {\n  rasterizeLayers?: boolean\n  filename?: string\n  Wrapper?: React.FC<{ children: React.ReactNode }>\n  themeName?: string\n}\n\nfunction stringLenPx(a: string) {\n  return measureText(a.slice(0, 30))\n}\n\nfunction pxWidthForBlocks(\n  blocks: BaseBlock[],\n  bpPerPx: number,\n  hide: Set<string>,\n) {\n  return max([\n    ...blocks.filter(b => !hide.has(b.key)).map(b => stringLenPx(b.refName)),\n    ...blocks\n      .filter(b => !hide.has(b.key))\n      .map(b => stringLenPx(getTickDisplayStr(b.end, bpPerPx))),\n  ])\n}\n\n/**\n * #stateModel DotplotView\n * #category view\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nexport default function stateModelFactory(pm: PluginManager) {\n  return types\n    .compose(\n      'DotplotView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        id: ElementId,\n        /**\n         * #property\n         */\n        type: types.literal('DotplotView'),\n        /**\n         * #property\n         */\n        height: defaultHeight,\n        /**\n         * #property\n         */\n        borderSize: defaultBorderSize,\n        /**\n         * #property\n         */\n        tickSize: defaultTickSize,\n        /**\n         * #property\n         */\n        vtextRotation: 0,\n        /**\n         * #property\n         */\n        htextRotation: defaultHtextRotation,\n        /**\n         * #property\n         */\n        fontSize: defaultFontSize,\n        /**\n         * #property\n         */\n        trackSelectorType: 'hierarchical',\n        /**\n         * #property\n         */\n        assemblyNames: types.array(types.string),\n        /**\n         * #property\n         */\n        drawCigar: true,\n        /**\n         * #property\n         */\n        hview: types.optional(DotplotHView, {}),\n        /**\n         * #property\n         */\n        vview: types.optional(DotplotVView, {}),\n\n        /**\n         * #property\n         */\n        tracks: types.array(pm.pluggableMstType('track', 'stateModel')),\n\n        /**\n         * #property\n         * this represents tracks specific to this view specifically used\n         * for read vs ref dotplots where this track would not really apply\n         * elsewhere\n         */\n        viewTrackConfigs: types.array(pm.pluggableConfigSchemaType('track')),\n        /**\n         * #property\n         * used for initializing the view from a session snapshot\n         */\n        init: types.frozen<DotplotViewInit | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      volatileWidth: undefined as number | undefined,\n      /**\n       * #volatile\n       */\n      volatileError: undefined as unknown,\n\n      /**\n       * #volatile\n       * these are 'personal preferences', stored in volatile and\n       * loaded/written to localStorage\n       */\n      cursorMode: localStorageGetItem('dotplot-cursorMode') || 'crosshair',\n      /**\n       * #volatile\n       */\n      showPanButtons: localStorageGetBoolean('dotplot-showPanbuttons', true),\n      /**\n       * #volatile\n       */\n      wheelMode: localStorageGetItem('dotplot-wheelMode') || 'zoom',\n      /**\n       * #volatile\n       */\n      borderX: 100,\n      /**\n       * #volatile\n       */\n      borderY: 100,\n      /**\n       * #volatile\n       */\n      importFormSyntenyTrackSelections:\n        observable.array<ImportFormSyntenyTrack>(),\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      importFormRemoveRow(idx: number) {\n        self.importFormSyntenyTrackSelections.splice(idx, 1)\n      },\n      /**\n       * #action\n       */\n      clearImportFormSyntenyTracks() {\n        self.importFormSyntenyTrackSelections.clear()\n      },\n      /**\n       * #action\n       */\n      setImportFormSyntenyTrack(arg: number, val: ImportFormSyntenyTrack) {\n        self.importFormSyntenyTrackSelections[arg] = val\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get width(): number {\n        if (!self.volatileWidth) {\n          throw new Error('width not initialized')\n        }\n        return self.volatileWidth\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get assemblyErrors() {\n        const { assemblyManager } = getSession(self)\n        return self.assemblyNames\n          .map(a => assemblyManager.get(a)?.error)\n          .filter(f => !!f)\n          .join(', ')\n      },\n      /**\n       * #getter\n       */\n      get assembliesInitialized() {\n        const { assemblyManager } = getSession(self)\n        return self.assemblyNames.every(\n          n => assemblyManager.get(n)?.initialized ?? true,\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get initialized() {\n        return (\n          self.volatileWidth !== undefined &&\n          self.hview.displayedRegions.length > 0 &&\n          self.vview.displayedRegions.length > 0 &&\n          self.assembliesInitialized\n        )\n      },\n      /**\n       * #getter\n       */\n      get hticks() {\n        const { hview } = self\n        const { dynamicBlocks, staticBlocks, bpPerPx } = hview\n        return dynamicBlocks.contentBlocks.length > 5\n          ? []\n          : makeTicks(staticBlocks.contentBlocks, bpPerPx)\n      },\n      /**\n       * #getter\n       */\n      get vticks() {\n        const { vview } = self\n        const { dynamicBlocks, staticBlocks, bpPerPx } = vview\n        return dynamicBlocks.contentBlocks.length > 5\n          ? []\n          : makeTicks(staticBlocks.contentBlocks, bpPerPx)\n      },\n      /**\n       * #getter\n       */\n      get hasSomethingToShow() {\n        return self.assemblyNames.length > 0 || !!self.init\n      },\n      /**\n       * #getter\n       * Whether to show a loading indicator instead of the import form or view\n       */\n      get showLoading() {\n        return (\n          this.hasSomethingToShow &&\n          !this.initialized &&\n          !self.volatileError &&\n          !self.assemblyErrors\n        )\n      },\n      /**\n       * #getter\n       * Whether to show the import form\n       */\n      get showImportForm() {\n        return !this.hasSomethingToShow || !!self.volatileError\n      },\n\n      /**\n       * #getter\n       */\n      get loadingMessage() {\n        return this.showLoading ? 'Loading' : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get viewWidth() {\n        return self.width - self.borderX\n      },\n      /**\n       * #getter\n       */\n      get viewHeight() {\n        return self.height - self.borderY\n      },\n      /**\n       * #getter\n       */\n      get views() {\n        return [self.hview, self.vview]\n      },\n\n      /**\n       * #method\n       */\n      renderProps() {\n        const session = getSession(self)\n        return {\n          ...getParentRenderProps(self),\n          drawCigar: self.drawCigar,\n          highResolutionScaling: getConf(session, 'highResolutionScaling'),\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setShowPanButtons(flag: boolean) {\n        self.showPanButtons = flag\n      },\n      /**\n       * #action\n       */\n      setWheelMode(str: string) {\n        self.wheelMode = str\n      },\n      /**\n       * #action\n       */\n      setCursorMode(str: string) {\n        self.cursorMode = str\n      },\n      /**\n       * #action\n       */\n      setDrawCigar(flag: boolean) {\n        self.drawCigar = flag\n      },\n      /**\n       * #action\n       * returns to the import form\n       */\n      clearView() {\n        self.hview.setDisplayedRegions([])\n        self.vview.setDisplayedRegions([])\n        self.assemblyNames = cast([])\n        self.tracks.clear()\n      },\n      /**\n       * #action\n       */\n      setBorderX(n: number) {\n        self.borderX = n\n      },\n      /**\n       * #action\n       */\n      setBorderY(n: number) {\n        self.borderY = n\n      },\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.volatileWidth = newWidth\n        return self.volatileWidth\n      },\n      /**\n       * #action\n       */\n      setHeight(newHeight: number) {\n        self.height = newHeight\n        return self.height\n      },\n\n      /**\n       * #action\n       */\n      setError(e: unknown) {\n        self.volatileError = e\n      },\n\n      /**\n       * #action\n       */\n      setInit(init?: DotplotViewInit) {\n        self.init = init\n      },\n\n      /**\n       * #action\n       */\n      zoomOut() {\n        self.hview.zoomOut()\n        self.vview.zoomOut()\n        // Center when zoomed out to show all content\n        if (self.hview.bpPerPx >= self.hview.maxBpPerPx * 0.99) {\n          self.hview.center()\n        }\n        if (self.vview.bpPerPx >= self.vview.maxBpPerPx * 0.99) {\n          self.vview.center()\n        }\n      },\n      /**\n       * #action\n       */\n      zoomIn() {\n        self.hview.zoomIn()\n        self.vview.zoomIn()\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      activateTrackSelector() {\n        if (self.trackSelectorType === 'hierarchical') {\n          const session = getSession(self)\n          if (isSessionModelWithWidgets(session)) {\n            const selector = session.addWidget(\n              'HierarchicalTrackSelectorWidget',\n              'hierarchicalTrackSelector',\n              { view: self },\n            )\n            session.showWidget(selector)\n            return selector\n          }\n        }\n        throw new Error(`invalid track selector type ${self.trackSelectorType}`)\n      },\n\n      /**\n       * #action\n       */\n      showTrack(trackId: string, initialSnapshot = {}) {\n        return showTrackGeneric(self, trackId, initialSnapshot)\n      },\n\n      /**\n       * #action\n       */\n      hideTrack(trackId: string) {\n        return hideTrackGeneric(self, trackId)\n      },\n      /**\n       * #action\n       */\n      toggleTrack(trackId: string) {\n        toggleTrackGeneric(self, trackId)\n      },\n      /**\n       * #action\n       */\n      setAssemblyNames(target: string, query: string) {\n        self.assemblyNames = cast([target, query])\n        // Clear displayed regions to trigger re-initialization with the new\n        // assemblies. The dotplotRegionsAutorun will re-populate them.\n        self.hview.setDisplayedRegions([])\n        self.vview.setDisplayedRegions([])\n      },\n      /**\n       * #action\n       */\n      setViews(arr: SnapshotIn<Base1DViewModel>[]) {\n        self.hview = cast(arr[0])\n        self.vview = cast(arr[1])\n      },\n\n      /**\n       * #action\n       */\n      getCoords(mousedown: Coord, mouseup: Coord) {\n        const [xmin, xmax] = minmax(mouseup[0], mousedown[0])\n        const [ymin, ymax] = minmax(mouseup[1], mousedown[1])\n        return Math.abs(xmax - xmin) > 3 && Math.abs(ymax - ymin) > 3\n          ? [\n              self.hview.pxToBp(xmin),\n              self.hview.pxToBp(xmax),\n              self.vview.pxToBp(self.viewHeight - ymin),\n              self.vview.pxToBp(self.viewHeight - ymax),\n            ]\n          : undefined\n      },\n\n      /**\n       * #action\n       * zooms into clicked and dragged region\n       */\n      zoomInToMouseCoords(mousedown: Coord, mouseup: Coord) {\n        const result = this.getCoords(mousedown, mouseup)\n        if (result) {\n          const [x1, x2, y1, y2] = result\n          self.hview.moveTo(x1, x2)\n          self.vview.moveTo(y2, y1)\n        }\n      },\n      /**\n       * #action\n       * Calculate borders synchronously for a given zoom level\n       */\n      calculateBorders() {\n        if (self.volatileWidth === undefined) {\n          return { borderX: self.borderX, borderY: self.borderY }\n        }\n        const { vview, hview, viewHeight, viewWidth } = self\n        const padding = 40\n        const vblocks = vview.dynamicBlocks.contentBlocks\n        const hblocks = hview.dynamicBlocks.contentBlocks\n        const hoffset = hview.offsetPx\n        const voffset = vview.offsetPx\n\n        const vhide = getBlockLabelKeysToHide(vblocks, viewHeight, voffset)\n        const hhide = getBlockLabelKeysToHide(hblocks, viewWidth, hoffset)\n        const by = pxWidthForBlocks(hblocks, vview.bpPerPx, hhide)\n        const bx = pxWidthForBlocks(vblocks, hview.bpPerPx, vhide)\n\n        return {\n          borderX: Math.max(bx + padding, 50),\n          borderY: Math.max(by + padding, 50),\n        }\n      },\n      /**\n       * #action\n       */\n      showAllRegions() {\n        // First zoom to max to trigger border recalculation\n        self.hview.zoomTo(self.hview.maxBpPerPx)\n        self.vview.zoomTo(self.vview.maxBpPerPx)\n\n        // Calculate what borders should be at this zoom level\n        const { borderX, borderY } = this.calculateBorders()\n\n        // Apply calculated borders\n        self.setBorderX(borderX)\n        self.setBorderY(borderY)\n\n        // Now zoom again with updated borders/dimensions and center\n        self.hview.zoomTo(self.hview.maxBpPerPx)\n        self.vview.zoomTo(self.vview.maxBpPerPx)\n        self.vview.center()\n        self.hview.center()\n      },\n      /**\n       * #action\n       */\n      initializeDisplayedRegions() {\n        const { hview, vview, assemblyNames } = self\n        if (hview.displayedRegions.length && vview.displayedRegions.length) {\n          return\n        }\n        const { assemblyManager } = getSession(self)\n        hview.setDisplayedRegions(\n          assemblyManager.get(assemblyNames[0]!)?.regions || [],\n        )\n        vview.setDisplayedRegions(\n          assemblyManager.get(assemblyNames[1]!)?.regions || [],\n        )\n        this.showAllRegions()\n      },\n      /**\n       * #action\n       * creates a linear synteny view from the clicked and dragged region\n       */\n      onDotplotView(mousedown: Coord, mouseup: Coord) {\n        const result = this.getCoords(mousedown, mouseup)\n        if (result) {\n          const [x1, x2, y1, y2] = result\n          const session = getSession(self)\n\n          const d1 = Dotplot1DView.create({\n            ...getSnapshot(self.hview),\n            minimumBlockWidth: 0,\n            interRegionPaddingWidth: 0,\n          })\n          const d2 = Dotplot1DView.create({\n            ...getSnapshot(self.vview),\n            minimumBlockWidth: 0,\n            interRegionPaddingWidth: 0,\n          })\n          d1.setVolatileWidth(self.hview.width)\n          d2.setVolatileWidth(self.vview.width)\n          d1.moveTo(x1, x2)\n          d2.moveTo(y2, y1)\n          d1.zoomTo(d1.bpPerPx / (self.width / self.hview.width), 0)\n          d2.zoomTo(d2.bpPerPx / (self.width / self.vview.width), 0)\n\n          // add the specific evidence tracks to the LGVs in the split view\n          // note: scales the bpPerPx by scaling proportional of the dotplot\n          // width to the eventual lgv width\n          const tracks = self.tracks\n            .map(track =>\n              track.configuration.displays.find(\n                (display: { type: string }) =>\n                  display.type === 'LinearSyntenyDisplay',\n              ),\n            )\n            .filter(f => !!f)\n            .map(displayConf => {\n              const trackConf = getParent<AnyConfigurationModel>(displayConf, 2)\n              return {\n                type: trackConf.type,\n                configuration: getSnapshot(trackConf),\n                displays: [\n                  {\n                    type: displayConf.type,\n                    configuration: getSnapshot(displayConf),\n                  },\n                ],\n              }\n            })\n\n          const { id: _unused1, ...rest1 } = getSnapshot(d1)\n          const { id: _unused2, ...rest2 } = getSnapshot(d2)\n          const viewSnapshot = {\n            type: 'LinearSyntenyView',\n            views: [\n              {\n                type: 'LinearGenomeView',\n                tracks: [],\n                hideHeader: true,\n                ...rest1,\n              },\n              {\n                type: 'LinearGenomeView',\n                tracks: [],\n                hideHeader: true,\n                ...rest2,\n              },\n            ],\n            tracks,\n          }\n\n          session.addView('LinearSyntenyView', viewSnapshot)\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * creates an svg export and save using FileSaver\n       */\n      async exportSvg(opts: ExportSvgOptions = {}) {\n        const { renderToSvg } =\n          await import('./svgcomponents/SVGDotplotView.tsx')\n        const html = await renderToSvg(self as DotplotViewModel, opts)\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        const { saveAs } = await import('file-saver-es')\n        saveAs(\n          new Blob([html], { type: 'image/svg+xml' }),\n          opts.filename || 'image.svg',\n        )\n      },\n      // if any of our assemblies are temporary assemblies\n      beforeDestroy() {\n        const session = getSession(self)\n        for (const name of self.assemblyNames) {\n          session.removeTemporaryAssembly?.(name)\n        }\n      },\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function dotplotInitAutorun() {\n              const { init, volatileWidth } = self\n              if (!volatileWidth || !init) {\n                return\n              }\n\n              const session = getSession(self)\n\n              // Set assembly names from init\n              const assemblyNames = init.views.map(v => v.assembly)\n              self.setAssemblyNames(assemblyNames[0]!, assemblyNames[1]!)\n\n              // Show tracks\n              if (init.tracks) {\n                for (const trackId of init.tracks) {\n                  try {\n                    self.showTrack(trackId)\n                  } catch (e) {\n                    console.error(e)\n                    session.notifyError(`${e}`, e)\n                  }\n                }\n              }\n\n              // Clear init state\n              self.setInit(undefined)\n            },\n            { name: 'DotplotInit' },\n          ),\n        )\n        addDisposer(\n          self,\n          autorun(\n            function dotplotLocalStorageAutorun() {\n              const s = (s: unknown) => JSON.stringify(s)\n              const { showPanButtons, wheelMode, cursorMode } = self\n              if (typeof localStorage !== 'undefined') {\n                localStorage.setItem(\n                  'dotplot-showPanbuttons',\n                  s(showPanButtons),\n                )\n                localStorage.setItem('dotplot-cursorMode', cursorMode)\n                localStorage.setItem('dotplot-wheelMode', wheelMode)\n              }\n            },\n            { name: 'DotplotLocalStorage' },\n          ),\n        )\n        addDisposer(\n          self,\n          autorun(\n            function dotplotRegionsAutorun() {\n              // IMPORTANT: Must actually read assemblyNames array (via slice) to\n              // force MobX to track it. Just referencing it without reading won't\n              // make the autorun re-run when assembly names change. This ensures\n              // the autorun fires when setAssemblyNames is called with different\n              // assemblies, which is critical for re-initializing displayed regions\n              void self.assemblyNames.slice()\n              if (\n                self.volatileWidth !== undefined &&\n                self.assembliesInitialized\n              ) {\n                self.initializeDisplayedRegions()\n              }\n            },\n            { delay: 1000, name: 'DotplotRegions' },\n          ),\n        )\n        addDisposer(\n          self,\n          autorun(\n            function dotplotBorderAutorun() {\n              // make sure we have a width on the view before trying to load\n              if (self.volatileWidth === undefined) {\n                return\n              }\n\n              // Calculate and apply borders\n              const { borderX, borderY } = self.calculateBorders()\n              self.setBorderX(borderX)\n              self.setBorderY(borderY)\n            },\n            { name: 'DotplotBorder' },\n          ),\n        )\n      },\n      /**\n       * #action\n       */\n      squareView() {\n        const { hview, vview } = self\n        const avg = (hview.bpPerPx + vview.bpPerPx) / 2\n        const hpx = hview.pxToBp(hview.width / 2)\n        const vpx = vview.pxToBp(vview.width / 2)\n        hview.setBpPerPx(avg)\n        hview.centerAt(hpx.coord, hpx.refName, hpx.index)\n        vview.setBpPerPx(avg)\n        vview.centerAt(vpx.coord, vpx.refName, vpx.index)\n      },\n      /**\n       * #action\n       */\n      squareViewProportional() {\n        const { hview, vview } = self\n        const ratio = hview.width / vview.width\n        const avg = (hview.bpPerPx + vview.bpPerPx) / 2\n        const hpx = hview.pxToBp(hview.width / 2)\n        const vpx = vview.pxToBp(vview.width / 2)\n        hview.setBpPerPx(avg / ratio)\n        hview.centerAt(hpx.coord, hpx.refName, hpx.index)\n        vview.setBpPerPx(avg)\n        vview.centerAt(vpx.coord, vpx.refName, vpx.index)\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      menuItems() {\n        const session = getSession(self)\n        return [\n          {\n            label: 'Return to import form',\n            icon: FolderOpenIcon,\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                ReturnToImportFormDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n          {\n            label: 'Export SVG',\n            icon: PhotoCameraIcon,\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                ExportSvgDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n          },\n          ...(isSessionModelWithWidgets(session)\n            ? [\n                {\n                  label: 'Open track selector',\n                  onClick: self.activateTrackSelector,\n                  icon: TrackSelectorIcon,\n                },\n              ]\n            : []),\n        ]\n      },\n      /**\n       * #getter\n       */\n      get error(): unknown {\n        return self.volatileError || self.assemblyErrors\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        init,\n        height,\n        borderSize,\n        tickSize,\n        vtextRotation,\n        htextRotation,\n        fontSize,\n        trackSelectorType,\n        drawCigar,\n        assemblyNames,\n        viewTrackConfigs,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(height !== defaultHeight ? { height } : {}),\n        ...(borderSize !== defaultBorderSize ? { borderSize } : {}),\n        ...(tickSize !== defaultTickSize ? { tickSize } : {}),\n        ...(vtextRotation ? { vtextRotation } : {}),\n        ...(htextRotation !== defaultHtextRotation ? { htextRotation } : {}),\n        ...(fontSize !== defaultFontSize ? { fontSize } : {}),\n        ...(trackSelectorType !== 'hierarchical' ? { trackSelectorType } : {}),\n        ...(!drawCigar ? { drawCigar } : {}),\n        ...(assemblyNames.length ? { assemblyNames } : {}),\n        ...(viewTrackConfigs.length ? { viewTrackConfigs } : {}),\n      } as typeof snap\n    })\n}\n\nexport type DotplotViewStateModel = ReturnType<typeof stateModelFactory>\nexport type DotplotViewModel = Instance<DotplotViewStateModel>\n\nexport { Dotplot1DView, type Dotplot1DViewModel } from './1dview.ts'\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport TimelineIcon from '@mui/icons-material/Timeline'\n\nimport ComparativeRenderer from './ComparativeRenderer/index.ts'\nimport DiagonalizeDotplotRpc from './DiagonalizeDotplotRpc.ts'\nimport DotplotDisplayF from './DotplotDisplay/index.ts'\nimport DotplotReadVsRefMenuItem from './DotplotReadVsRef/index.ts'\nimport DotplotRendererF from './DotplotRenderer/index.ts'\nimport DotplotViewF from './DotplotView/index.ts'\nimport LaunchDotplotViewF from './LaunchDotplotView.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport type { DotplotImportFormSyntenyOption } from './DotplotView/components/ImportForm/TrackSelector'\n\nexport default class DotplotPlugin extends Plugin {\n  name = 'DotplotPlugin'\n\n  install(pluginManager: PluginManager) {\n    DotplotViewF(pluginManager)\n    DotplotDisplayF(pluginManager)\n    DotplotRendererF(pluginManager)\n    LaunchDotplotViewF(pluginManager)\n    DotplotReadVsRefMenuItem(pluginManager)\n\n    // install our comparative rendering rpc callback\n    pluginManager.addRpcMethod(() => new ComparativeRenderer(pluginManager))\n    pluginManager.addRpcMethod(() => new DiagonalizeDotplotRpc(pluginManager))\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['Add'], {\n        label: 'Dotplot view',\n        icon: TimelineIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('DotplotView', {})\n        },\n      })\n    }\n  }\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { stateModelFactory } from './stateModelFactory.tsx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function DotplotDisplayF(pm: PluginManager) {\n  pm.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pm)\n    return new DisplayType({\n      name: 'DotplotDisplay',\n      displayName: 'Dotplot display',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'SyntenyTrack',\n      viewType: 'DotplotView',\n      ReactComponent: lazy(() => import('./components/DotplotDisplay.tsx')),\n    })\n  })\n}\n\n/**\n * #config DotplotDisplay\n */\nexport function configSchemaFactory(pm: any) {\n  return ConfigurationSchema(\n    'DotplotDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: types.optional(pm.pluggableConfigSchemaType('renderer'), {\n        type: 'DotplotRenderer',\n      }),\n    },\n    {\n      /**\n       * #identifier\n       */\n      explicitIdentifier: 'displayId',\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\n\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function DotplotViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'DotplotView',\n      displayName: 'Dotplot view',\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/DotplotView.tsx')),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport DotplotRenderer from './DotplotRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function DotplotRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new DotplotRenderer({\n        name: 'DotplotRenderer',\n        configSchema: configSchema,\n        ReactComponent: lazy(() => import('./components/DotplotRendering.tsx')),\n        pluginManager,\n      }),\n  )\n}\n","import type { DotplotViewModel } from './DotplotView/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default function LaunchDotplotView(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-DotplotView',\n    // @ts-expect-error\n    async ({\n      session,\n      views,\n      tracks = [],\n    }: {\n      session: AbstractSessionModel\n      views: { assembly: string }[]\n      tracks?: string[]\n    }) => {\n      // Use the init property to let the model handle initialization\n      session.addView('DotplotView', {\n        init: {\n          views: views.map(v => ({ assembly: v.assembly })),\n          tracks,\n        },\n      }) as DotplotViewModel\n    },\n  )\n}\n","import AddIcon from '@mui/icons-material/Add'\n\nimport { onClick } from './DotplotReadVsRef.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  DisplayType,\n  PluggableElementType,\n} from '@jbrowse/core/pluggableElementTypes'\nimport type { LinearPileupDisplayModel } from '@jbrowse/plugin-alignments'\n\nexport default function DotplotReadVsRefMenuItem(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-extendPluggableElement',\n    (pluggableElement: PluggableElementType) => {\n      if (pluggableElement.name === 'LinearPileupDisplay') {\n        const { stateModel } = pluggableElement as DisplayType\n        const newStateModel = stateModel.extend(\n          (self: LinearPileupDisplayModel) => {\n            const superContextMenuItems = self.contextMenuItems\n            return {\n              views: {\n                contextMenuItems() {\n                  const feature = self.contextMenuFeature\n                  return [\n                    ...superContextMenuItems(),\n                    ...(feature\n                      ? [\n                          {\n                            label: 'Dotplot of read vs ref',\n                            icon: AddIcon,\n                            onClick: () => {\n                              onClick(feature, self)\n                            },\n                          },\n                        ]\n                      : []),\n                  ]\n                },\n              },\n            }\n          },\n        )\n\n        ;(pluggableElement as DisplayType).stateModel = newStateModel\n      }\n      return pluggableElement\n    },\n  )\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\n\nfunction stringifyBedGraph({ features }: { features: Feature[] }) {\n  return features\n    .map(\n      f =>\n        `${f.get('refName')}\\t${f.get('start')}\\t${f.get('end')}\\t${f.get('score') ?? 0}`,\n    )\n    .join('\\n')\n}\n\nexport default function GCContentTrackF(pm: PluginManager) {\n  pm.addTrackType(() => {\n    const configSchema = configSchemaF(pm)\n    return new TrackType({\n      name: 'GCContentTrack',\n      displayName: 'GCContent track',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pm,\n        'GCContentTrack',\n        configSchema,\n      ).views(() => ({\n        saveTrackFileFormatOptions() {\n          return {\n            bedGraph: {\n              name: 'BedGraph',\n              extension: 'bedgraph',\n              callback: stringifyBedGraph,\n            },\n          }\n        },\n      })),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { getConf } from '@jbrowse/core/configuration'\nimport { getSession } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { linearWiggleDisplayModelFactory } from '@jbrowse/plugin-wiggle'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\nconst EditGCContentParamsDialog = lazy(\n  () => import('./components/EditGCContentParams.tsx'),\n)\n\n/**\n * #stateModel SharedGCContentModel\n * #category display\n * extends\n * - [LinearWiggleDisplay](../linearwiggledisplay)\n */\nexport default function SharedModelF(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'SharedGCContentModel',\n      linearWiggleDisplayModelFactory(pluginManager, configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        windowSize: types.maybe(types.number),\n        /**\n         * #property\n         */\n        windowDelta: types.maybe(types.number),\n      }),\n    )\n    .actions(self => ({\n      setGCContentParams({\n        windowSize,\n        windowDelta,\n      }: {\n        windowSize: number\n        windowDelta: number\n      }) {\n        self.windowSize = windowSize\n        self.windowDelta = windowDelta\n      },\n    }))\n    .views(self => ({\n      get windowSizeSetting() {\n        return self.windowSize ?? getConf(self, 'windowSize')\n      },\n      get windowDeltaSetting() {\n        return self.windowDelta ?? getConf(self, 'windowDelta')\n      },\n    }))\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        adapterProps: superAdapterProps,\n      } = self\n      return {\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Change GC parameters',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  EditGCContentParamsDialog,\n                  { model: self, handleClose },\n                ])\n              },\n            },\n          ]\n        },\n        /**\n         * #method\n         * retrieves the sequence adapter from parent track, and puts it as a\n         * subadapter on a GCContentAdapter\n         */\n        adapterProps() {\n          const sequenceAdapter = getConf(self.parentTrack, 'adapter')\n          return {\n            ...superAdapterProps(),\n            adapterConfig: {\n              type: 'GCContentAdapter',\n              sequenceAdapter,\n              windowSize: self.windowSizeSetting,\n              windowDelta: self.windowDeltaSetting,\n            },\n          }\n        },\n      }\n    })\n}\n","import { lazy } from 'react'\n\nimport { DisplayType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchemaFactory1 from './config1.ts'\nimport configSchemaFactory2 from './config2.ts'\nimport stateModelF1 from './stateModel1.ts'\nimport stateModelF2 from './stateModel2.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst LazyWiggleDisplayComponent = lazy(() =>\n  import('@jbrowse/plugin-wiggle').then(m => ({\n    default: m.LinearWiggleDisplayReactComponent,\n  })),\n)\n\nexport default function LinearGCContentDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory1(pluginManager)\n    const stateModel = stateModelF1(pluginManager, configSchema)\n    return new DisplayType({\n      name: 'LinearGCContentDisplay',\n      configSchema,\n      stateModel,\n      displayName: 'GC content display',\n      trackType: 'ReferenceSequenceTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: LazyWiggleDisplayComponent,\n    })\n  })\n\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory2(pluginManager)\n    const stateModel = stateModelF2(pluginManager, configSchema)\n    return new DisplayType({\n      name: 'LinearGCContentTrackDisplay',\n      configSchema,\n      stateModel,\n      displayName: 'GC content display',\n      trackType: 'GCContentTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: LazyWiggleDisplayComponent,\n    })\n  })\n}\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport GCContentAdapterF from './GCContentAdapter/index.ts'\nimport GCContentTrackF from './GCContentTrack/index.ts'\nimport LinearGCContentDisplayF from './LinearGCContentDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class GCContentPlugin extends Plugin {\n  name = 'GCContentPlugin'\n\n  install(pluginManager: PluginManager) {\n    GCContentAdapterF(pluginManager)\n    GCContentTrackF(pluginManager)\n    LinearGCContentDisplayF(pluginManager)\n  }\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function GCContentAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'GCContentAdapter',\n        displayName: 'GC content adapter',\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n        configSchema: configSchemaF(pluginManager),\n        getAdapterClass: () =>\n          import('./GCContentAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config GCContentAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst GCContentAdapterF = (_pluginManager: PluginManager) => {\n  return ConfigurationSchema(\n    'GCContentAdapter',\n    {\n      /**\n       * #slot\n       */\n      sequenceAdapter: {\n        type: 'frozen',\n        defaultValue: null,\n      },\n      /**\n       * #slot\n       */\n      windowSize: {\n        type: 'number',\n        defaultValue: 100,\n      },\n      /**\n       * #slot\n       */\n      windowDelta: {\n        type: 'number',\n        defaultValue: 100,\n      },\n    },\n    { explicitlyTyped: true },\n  )\n}\n\nexport default GCContentAdapterF\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config GCContentTrack\n * used for having a gc content track outside of the \"reference sequence display\"\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) =>\n  ConfigurationSchema(\n    'GCContentTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearGCContentDisplay\n * #category display\n * extends LinearWiggleDisplay\n */\nexport default function LinearGCContentDisplay(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearGCContentDisplay',\n    {\n      windowSize: {\n        type: 'number',\n        defaultValue: 100,\n      },\n      windowDelta: {\n        type: 'number',\n        defaultValue: 100,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: pluginManager.getDisplayType('LinearWiggleDisplay')!\n        .configSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport SharedModelF from './shared.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearGCContentDisplay\n * #category display\n * base model `SharedGCContentModel`\n */\nexport default function stateModelF(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types.compose(\n    'LinearGCContentDisplay',\n    SharedModelF(pluginManager, configSchema),\n    types.model({\n      type: types.literal('LinearGCContentDisplay'),\n    }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearGCContentTrackDisplay\n * #category display\n * extends LinearWiggleDisplay, used specifically for GCContentTrack\n */\nexport default function LinearGCContentTrackDisplayF(\n  pluginManager: PluginManager,\n) {\n  return ConfigurationSchema(\n    'LinearGCContentTrackDisplay',\n    {\n      windowSize: {\n        type: 'number',\n        defaultValue: 100,\n      },\n      windowDelta: {\n        type: 'number',\n        defaultValue: 100,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: pluginManager.getDisplayType('LinearWiggleDisplay')!\n        .configSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport SharedModelF from './shared.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearGCContentTrackDisplay\n * #category display\n *\n * used on GCContentTrack, separately from the display type on the\n * ReferenceSequenceTrack\n *\n * extends\n * - [SharedGCContentModel](../sharedgccontentmodel)\n */\nexport default function stateModelF(\n  pluginManager: PluginManager,\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types.compose(\n    'LinearGCContentTrackDisplay',\n    SharedModelF(pluginManager, configSchema),\n    types.model({\n      type: types.literal('LinearGCContentTrackDisplay'),\n    }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config Gff3Adapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst Gff3Adapter = ConfigurationSchema(\n  'Gff3Adapter',\n  {\n    /**\n     * #slot\n     */\n    gffLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.gff',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     *\n     * ```json\n     * {\n     *   \"type\": \"Gff3Adapter\",\n     *   \"uri\": \"yourfile.gff3\",\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            gffLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default Gff3Adapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config Gff3TabixAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst Gff3TabixAdapter = ConfigurationSchema(\n  'Gff3TabixAdapter',\n  {\n    /**\n     * #slot\n     */\n    gffGzLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.gff.gz',\n        locationType: 'UriLocation',\n      },\n    },\n\n    index: ConfigurationSchema('Gff3TabixIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['TBI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'TBI',\n      },\n      /**\n       * #slot index.indexType\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.gff.gz.tbi',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n    /**\n     * #slot\n     * the Gff3TabixAdapter has to \"redispatch\" if it fetches a region and\n     * features it finds inside that region extend outside the region we requested.\n     * you can disable this for certain feature types to avoid fetching e.g. the\n     * entire chromosome\n     */\n    dontRedispatch: {\n      type: 'stringArray',\n      defaultValue: ['chromosome', 'region', 'contig'],\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes tbi index at\n     * yourfile.gff3.gz.tbi:\n     *\n     * ```json\n     * {\n     *   \"type\": \"Gff3TabixAdapter\",\n     *   \"uri\": \"yourfile.gff3.gz\",\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            gffGzLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.tbi`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default Gff3TabixAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport Gff3AdapterF from './Gff3Adapter/index.ts'\nimport Gff3TabixAdapterF from './Gff3TabixAdapter/index.ts'\nimport GuessGff3F from './GuessGff3/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class GFF3Plugin extends Plugin {\n  name = 'GFF3Plugin'\n\n  install(pluginManager: PluginManager) {\n    Gff3TabixAdapterF(pluginManager)\n    Gff3AdapterF(pluginManager)\n    GuessGff3F(pluginManager)\n  }\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function Gff3TabixAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'Gff3TabixAdapter',\n        displayName: 'GFF3 tabix adapter',\n        configSchema,\n        getAdapterClass: () =>\n          import('./Gff3TabixAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function Gff3AdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'Gff3Adapter',\n        displayName: 'GFF3 adapter',\n        configSchema,\n        getAdapterClass: () => import('./Gff3Adapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport {\n  getFileName,\n  makeIndex,\n  makeIndexType,\n} from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AdapterGuesser } from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessGff3F(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        const indexName = index && getFileName(index)\n        if (\n          testAdapter(\n            fileName,\n            /\\.gff3?\\.b?gz$/i,\n            adapterHint,\n            'Gff3TabixAdapter',\n          )\n        ) {\n          return {\n            type: 'Gff3TabixAdapter',\n            bamLocation: file,\n            gffGzLocation: file,\n            index: {\n              location: index || makeIndex(file, '.tbi'),\n              indexType: makeIndexType(indexName, 'CSI', 'TBI'),\n            },\n          }\n        } else if (\n          testAdapter(fileName, /\\.gff3?$/i, adapterHint, 'Gff3Adapter')\n        ) {\n          return {\n            type: 'Gff3Adapter',\n            gffLocation: file,\n          }\n        } else {\n          return adapterGuesser(file, index, adapterHint)\n        }\n      }\n    },\n  )\n}\n","import { Fragment, useEffect } from 'react'\n\nimport CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\nimport { getSession, notEmpty } from '@jbrowse/core/util'\nimport { colord } from '@jbrowse/core/util/colord'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport BookmarkIcon from '@mui/icons-material/Bookmark'\nimport { Tooltip } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { GridBookmarkModel, IExtendedLGV } from '../../model.ts'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\n\ntype LGV = IExtendedLGV\n\nconst useStyles = makeStyles()({\n  bookmarkButton: {\n    overflow: 'hidden',\n    position: 'absolute',\n    zIndex: 800,\n  },\n  highlight: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'absolute',\n  },\n})\n\nconst Highlight = observer(function Highlight({ model }: { model: LGV }) {\n  const { classes } = useStyles()\n  const session = getSession(model) as SessionWithWidgets\n  const { assemblyManager } = session\n  const { bookmarkHighlightsVisible, bookmarkLabelsVisible } = model\n\n  const bookmarkWidget = session.widgets.get('GridBookmark') as\n    | GridBookmarkModel\n    | undefined\n\n  useEffect(() => {\n    if (!bookmarkWidget) {\n      session.addWidget('GridBookmarkWidget', 'GridBookmark')\n    }\n  }, [session, bookmarkWidget])\n\n  const set = new Set(model.assemblyNames)\n\n  return bookmarkHighlightsVisible && bookmarkWidget?.bookmarks\n    ? bookmarkWidget.bookmarks\n        .filter(value => set.has(value.assemblyName))\n        .map(r => {\n          const asm = assemblyManager.get(r.assemblyName)\n          const refName = asm?.getCanonicalRefName(r.refName) ?? r.refName\n          const s = model.bpToPx({ refName, coord: r.start })\n          const e = model.bpToPx({ refName, coord: r.end })\n          return s && e\n            ? {\n                width: Math.max(Math.abs(e.offsetPx - s.offsetPx), 3),\n                left: Math.min(s.offsetPx, e.offsetPx) - model.offsetPx,\n                highlight: r.highlight,\n                label: r.label,\n                bookmark: r,\n              }\n            : undefined\n        })\n        .filter(notEmpty)\n        .map(({ left, width, highlight, label, bookmark }, idx) => (\n          /* biome-ignore lint/suspicious/noArrayIndexKey: */\n          <Fragment key={`${left}_${width}_${idx}`}>\n            <div\n              className={classes.highlight}\n              id=\"highlight\"\n              style={{\n                left,\n                width,\n                background: highlight,\n              }}\n            />\n            {bookmarkLabelsVisible && width > 20 ? (\n              <div className={classes.bookmarkButton} style={{ left }}>\n                <CascadingMenuButton\n                  menuItems={[\n                    {\n                      label: 'Open bookmark widget',\n                      onClick: () => {\n                        session.showWidget(bookmarkWidget)\n                      },\n                    },\n                    {\n                      label: 'Turn off highlights',\n                      onClick: () => {\n                        bookmarkWidget.setBookmarkHighlightsVisible(false)\n                      },\n                    },\n\n                    {\n                      label: 'Remove bookmark',\n                      onClick: () => {\n                        bookmarkWidget.removeBookmarkObject(bookmark)\n                      },\n                    },\n                  ]}\n                >\n                  <Tooltip title={label} arrow>\n                    <BookmarkIcon\n                      fontSize=\"small\"\n                      sx={{\n                        color:\n                          colord(highlight).alpha() !== 0\n                            ? colord(highlight).alpha(0.8).toRgbString()\n                            : colord(highlight).alpha(0).toRgbString(),\n                      }}\n                    />\n                  </Tooltip>\n                </CascadingMenuButton>\n              </div>\n            ) : null}\n          </Fragment>\n        ))\n    : null\n})\n\nexport default Highlight\n","import { useEffect } from 'react'\n\nimport { getSession, notEmpty } from '@jbrowse/core/util'\nimport { makeStyles } from '@jbrowse/core/util/tss-react'\nimport { Tooltip } from '@mui/material'\nimport { observer } from 'mobx-react'\n\nimport type { GridBookmarkModel, IExtendedLGV } from '../../model.ts'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\ntype LGV = IExtendedLGV\n\nconst useStyles = makeStyles()({\n  highlight: {\n    height: '100%',\n    position: 'absolute',\n    left: 0,\n  },\n})\n\nconst OverviewHighlight = observer(function OverviewHighlight({\n  model,\n  overview,\n}: {\n  model: LGV\n  overview: Base1DViewModel\n}) {\n  const { cytobandOffset } = model\n  const session = getSession(model) as SessionWithWidgets\n  const { classes } = useStyles()\n  const { assemblyManager } = session\n  const { bookmarkHighlightsVisible, bookmarkLabelsVisible } = model\n  const bookmarkWidget = session.widgets.get('GridBookmark') as\n    | GridBookmarkModel\n    | undefined\n\n  useEffect(() => {\n    if (!bookmarkWidget) {\n      session.addWidget('GridBookmarkWidget', 'GridBookmark')\n    }\n  }, [session, bookmarkWidget])\n\n  const assemblyNames = new Set(model.assemblyNames)\n  return bookmarkHighlightsVisible && bookmarkWidget?.bookmarks\n    ? bookmarkWidget.bookmarks\n        .filter(r => assemblyNames.has(r.assemblyName))\n        .map(r => {\n          const asm = assemblyManager.get(r.assemblyName)\n          const refName = asm?.getCanonicalRefName(r.refName) ?? r.refName\n          const rev = r.reversed\n          const s = overview.bpToPx({ refName, coord: rev ? r.end : r.start })\n          const e = overview.bpToPx({ refName, coord: rev ? r.start : r.end })\n          return s !== undefined && e !== undefined\n            ? {\n                width: Math.abs(e - s),\n                left: s + cytobandOffset,\n                highlight: r.highlight,\n                label: r.label,\n              }\n            : undefined\n        })\n        .filter(notEmpty)\n        .map((obj, idx) => {\n          const { left, width, highlight, label } = obj\n          return (\n            <Tooltip\n              key={`${JSON.stringify(obj)}-${idx}`}\n              title={bookmarkLabelsVisible ? label : ''}\n              arrow\n            >\n              <div\n                className={classes.highlight}\n                style={{\n                  transform: `translateX(${left}px)`,\n                  width,\n                  background: highlight,\n                  borderLeft: `1px solid ${highlight}`,\n                  borderRight: `1px solid ${highlight}`,\n                }}\n              />\n            </Tooltip>\n          )\n        })\n    : null\n})\n\nexport default OverviewHighlight\n","import {\n  getSession,\n  localStorageGetItem,\n  localStorageSetItem,\n} from '@jbrowse/core/util'\nimport { ElementId, Region as RegionModel } from '@jbrowse/core/util/types/mst'\nimport { addDisposer, cast, types } from '@jbrowse/mobx-state-tree'\nimport { autorun } from 'mobx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Region } from '@jbrowse/core/util/types'\nimport type { IMSTArray, Instance, SnapshotIn } from '@jbrowse/mobx-state-tree'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nconst LabeledRegionModel = types\n  .compose(\n    RegionModel,\n    types.model('Label', {\n      label: types.optional(types.string, ''),\n      highlight: types.optional(types.string, 'rgba(247, 129, 192, 0.35)'),\n    }),\n  )\n  .actions(self => ({\n    setLabel(label: string) {\n      self.label = label\n    },\n    setHighlight(color: string) {\n      self.highlight = color\n    },\n  }))\n\nconst SharedBookmarksModel = types.model('SharedBookmarksModel', {\n  sharedBookmarks: types.maybe(types.array(LabeledRegionModel)),\n})\n\nexport interface IExtendedLGV extends LinearGenomeViewModel {\n  bookmarkHighlightsVisible: boolean\n  bookmarkLabelsVisible: boolean\n  setBookmarkHighlightsVisible: (arg: boolean) => void\n  setBookmarkLabelsVisible: (arg: boolean) => void\n}\n\nexport interface ILabeledRegionModel extends SnapshotIn<\n  typeof LabeledRegionModel\n> {\n  refName: string\n  start: number\n  end: number\n  reversed: boolean\n  highlight: string\n  assemblyName: string\n  label: string\n  setRefName: (newRefName: string) => void\n  setLabel: (label: string) => void\n  setHighlight: (color: string) => void\n}\n\nexport interface IExtendedLabeledRegionModel extends ILabeledRegionModel {\n  id: number\n  correspondingObj: ILabeledRegionModel\n}\n\nconst localStorageKeyF = () =>\n  typeof window !== 'undefined'\n    ? `bookmarks-${[window.location.host + window.location.pathname].join('-')}`\n    : 'empty'\n\n/**\n * #stateModel GridBookmarkWidgetModel\n */\nexport default function f(_pluginManager: PluginManager) {\n  return types\n    .model('GridBookmarkModel', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal('GridBookmarkWidget'),\n      /**\n       * #property\n       * removed by postProcessSnapshot, only loaded from localStorage\n       */\n      bookmarks: types.optional(types.array(LabeledRegionModel), () =>\n        JSON.parse(localStorageGetItem(localStorageKeyF()) || '[]'),\n      ),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      selectedBookmarks: [] as IExtendedLabeledRegionModel[],\n      /**\n       * #volatile\n       */\n      selectedAssembliesPre: undefined as string[] | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get bookmarkAssemblies() {\n        return [...new Set(self.bookmarks.map(r => r.assemblyName))]\n      },\n      /**\n       * #getter\n       */\n      get validAssemblies() {\n        const { assemblyManager } = getSession(self)\n        return new Set(\n          this.bookmarkAssemblies.filter(a => assemblyManager.get(a)),\n        )\n      },\n      /**\n       * #getter\n       */\n      get areBookmarksHighlightedOnAllOpenViews() {\n        const { views } = getSession(self)\n        return views.every(v =>\n          'bookmarkHighlightsVisible' in v ? v.bookmarkHighlightsVisible : true,\n        )\n      },\n      /**\n       * #getter\n       */\n      get areBookmarksHighlightLabelsOnAllOpenViews() {\n        const { views } = getSession(self)\n        return views.every(v =>\n          'bookmarkLabelsVisible' in v ? v.bookmarkLabelsVisible : true,\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get bookmarksWithValidAssemblies() {\n        return self.bookmarks.filter(e =>\n          self.validAssemblies.has(e.assemblyName),\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get sharedBookmarksModel() {\n        // requires cloning bookmarks with JSON.stringify/parse to avoid duplicate\n        // reference to same object in the same state tree, will otherwise error\n        // when performing share\n        return SharedBookmarksModel.create({\n          sharedBookmarks: JSON.parse(JSON.stringify(self.selectedBookmarks)),\n        })\n      },\n      /**\n       * #getter\n       */\n      get allBookmarksModel() {\n        // requires cloning bookmarks with JSON.stringify/parse to avoid duplicate\n        // reference to same object in the same state tree, will otherwise error\n        // when performing share\n        return SharedBookmarksModel.create({\n          sharedBookmarks: JSON.parse(\n            JSON.stringify(self.bookmarksWithValidAssemblies),\n          ),\n        })\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setSelectedAssemblies(assemblies?: string[]) {\n        self.selectedAssembliesPre = assemblies\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get selectedAssemblies() {\n        return (\n          self.selectedAssembliesPre?.filter(f =>\n            self.validAssemblies.has(f),\n          ) ?? [...self.validAssemblies]\n        )\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      importBookmarks(regions: Region[]) {\n        self.bookmarks = cast([...self.bookmarks, ...regions])\n      },\n      /**\n       * #action\n       */\n      addBookmark(region: Region) {\n        self.bookmarks.push(region)\n      },\n      /**\n       * #action\n       */\n      removeBookmark(index: number) {\n        self.bookmarks.splice(index, 1)\n      },\n      /**\n       * #action\n       */\n      updateBookmarkLabel(\n        bookmark: IExtendedLabeledRegionModel,\n        label: string,\n      ) {\n        bookmark.correspondingObj.setLabel(label)\n      },\n      /**\n       * #action\n       */\n      updateBookmarkHighlight(\n        bookmark: IExtendedLabeledRegionModel,\n        color: string,\n      ) {\n        bookmark.correspondingObj.setHighlight(color)\n      },\n      /**\n       * #action\n       */\n      updateBulkBookmarkHighlights(color: string) {\n        for (const bookmark of self.selectedBookmarks) {\n          this.updateBookmarkHighlight(bookmark, color)\n        }\n      },\n      /**\n       * #action\n       */\n      setSelectedBookmarks(bookmarks: IExtendedLabeledRegionModel[]) {\n        self.selectedBookmarks = bookmarks\n      },\n      /**\n       * #action\n       */\n      setBookmarkedRegions(regions: IMSTArray<typeof LabeledRegionModel>) {\n        self.bookmarks = cast(regions)\n      },\n      /**\n       * #action\n       */\n      setBookmarkHighlightsVisible(arg: boolean) {\n        const { views } = getSession(self)\n        // hacky, but mst walk() on session leads to 'too much recursion'\n        for (const view of views) {\n          // @ts-expect-error\n          view.setBookmarkHighlightsVisible?.(arg)\n          // @ts-expect-error\n          view.views?.map(view => {\n            view.setBookmarkHighlightsVisible?.(arg)\n          })\n        }\n      },\n      /**\n       * #action\n       */\n      setBookmarkLabelsVisible(arg: boolean) {\n        const { views } = getSession(self)\n        // hacky, but mst walk() on session leads to 'too much recursion'\n        for (const view of views) {\n          // @ts-expect-error\n          view.setBookmarkLabelsVisible?.(arg)\n          // @ts-expect-error\n          view.views?.map(view => {\n            view.setBookmarkHighlightsVisible?.(arg)\n          })\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      clearAllBookmarks() {\n        self.setBookmarkedRegions(\n          self.bookmarks.filter(\n            bookmark => !self.validAssemblies.has(bookmark.assemblyName),\n          ) as IMSTArray<typeof LabeledRegionModel>,\n        )\n      },\n      /**\n       * #action\n       */\n      clearSelectedBookmarks() {\n        for (const bookmark of self.selectedBookmarks) {\n          self.bookmarks.remove(bookmark.correspondingObj)\n        }\n        self.selectedBookmarks = []\n      },\n\n      removeBookmarkObject(arg: Instance<typeof LabeledRegionModel>) {\n        self.bookmarks.remove(arg)\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        const key = localStorageKeyF()\n        function handler(e: StorageEvent) {\n          if (e.key === key) {\n            const localStorage = JSON.parse(localStorageGetItem(key) || '[]')\n            self.setBookmarkedRegions(localStorage)\n          }\n        }\n        window.addEventListener('storage', handler)\n        addDisposer(self, () => {\n          window.removeEventListener('storage', handler)\n        })\n        addDisposer(\n          self,\n          autorun(\n            function bookmarkLocalStorageAutorun() {\n              localStorageSetItem(key, JSON.stringify(self.bookmarks))\n            },\n            { name: 'BookmarkLocalStorage' },\n          ),\n        )\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      const { bookmarks: _, ...rest } = snap as Omit<typeof snap, symbol>\n      return rest\n    })\n}\n\nexport type GridBookmarkStateModel = ReturnType<typeof f>\nexport type GridBookmarkModel = Instance<GridBookmarkStateModel>\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport AddHighlightModelF from './components/Highlight/index.tsx'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('GridBookmarkWidget', {})\n\nexport default function GridBookmarkWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'GridBookmarkWidget',\n      heading: 'Bookmarked regions',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/GridBookmarkWidget.tsx')),\n    })\n  })\n  AddHighlightModelF(pluginManager)\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport {\n  getSession,\n  isAbstractMenuManager,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport BookmarkIcon from '@mui/icons-material/Bookmark'\nimport BookmarksIcon from '@mui/icons-material/Bookmarks'\nimport HighlightIcon from '@mui/icons-material/Highlight'\nimport LabelIcon from '@mui/icons-material/Label'\n\nimport GridBookmarkWidgetF from './GridBookmarkWidget/index.ts'\n\nimport type { GridBookmarkModel } from './GridBookmarkWidget/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  PluggableElementType,\n  ViewType,\n} from '@jbrowse/core/pluggableElementTypes'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\nimport type { LinearGenomeViewStateModel } from '@jbrowse/plugin-linear-genome-view'\n\nexport default class GridBookmarkPlugin extends Plugin {\n  name = 'GridBookmarkPlugin'\n\n  install(pluginManager: PluginManager) {\n    GridBookmarkWidgetF(pluginManager)\n\n    pluginManager.addToExtensionPoint(\n      'Core-extendPluggableElement',\n      (pluggableElement: PluggableElementType) => {\n        if (pluggableElement.name === 'LinearGenomeView') {\n          const { stateModel } = pluggableElement as ViewType\n          const lgv = stateModel as LinearGenomeViewStateModel\n          const newStateModel = lgv\n            .props({\n              /**\n               * #property\n               */\n              bookmarkHighlightsVisible: true,\n              /**\n               * #property\n               */\n              bookmarkLabelsVisible: true,\n            })\n            .actions(self => ({\n              /**\n               * #action\n               */\n              setBookmarkHighlightsVisible(arg: boolean) {\n                self.bookmarkHighlightsVisible = arg\n              },\n              /**\n               * #action\n               */\n              setBookmarkLabelsVisible(arg: boolean) {\n                self.bookmarkLabelsVisible = arg\n              },\n              /**\n               * #action\n               */\n              activateBookmarkWidget() {\n                const session = getSession(self)\n                if (isSessionModelWithWidgets(session)) {\n                  let bookmarkWidget = session.widgets.get('GridBookmark')\n                  if (!bookmarkWidget) {\n                    bookmarkWidget = session.addWidget(\n                      'GridBookmarkWidget',\n                      'GridBookmark',\n                    )\n                  }\n\n                  session.showWidget(bookmarkWidget)\n                  return session.widgets.get(\n                    'GridBookmark',\n                  ) as GridBookmarkModel\n                }\n\n                throw new Error('Could not open bookmark widget')\n              },\n            }))\n            .actions(self => ({\n              /**\n               * #action\n               */\n              navigateNewestBookmark() {\n                const session = getSession(self)\n                const bookmarkWidget = self.activateBookmarkWidget()\n                if (bookmarkWidget.bookmarks.length) {\n                  self.navTo(bookmarkWidget.bookmarks.at(-1)!)\n                } else {\n                  session.notify(\n                    'There are no recent bookmarks to navigate to.',\n                    'info',\n                  )\n                }\n              },\n\n              /**\n               * #action\n               */\n              bookmarkCurrentRegion() {\n                if (self.id === getSession(self).focusedViewId) {\n                  const selectedRegions = self.getSelectedRegions(\n                    undefined,\n                    undefined,\n                  )\n                  const bookmarkWidget = self.activateBookmarkWidget()\n                  if (!selectedRegions.length) {\n                    throw new Error('no region selected')\n                  } else {\n                    bookmarkWidget.addBookmark(selectedRegions[0]!)\n                  }\n                }\n              },\n            }))\n            .views(self => {\n              const superMenuItems = self.menuItems\n              const superRubberBandMenuItems = self.rubberBandMenuItems\n              return {\n                /**\n                 * #method\n                 */\n                menuItems() {\n                  return [\n                    ...superMenuItems(),\n                    {\n                      label: 'Bookmarks',\n                      icon: BookmarksIcon,\n                      subMenu: [\n                        {\n                          label: 'Open bookmark widget',\n                          icon: BookmarksIcon,\n                          onClick: () => self.activateBookmarkWidget(),\n                        },\n                        {\n                          label: 'Bookmark current region',\n                          icon: BookmarkIcon,\n                          onClick: () => {\n                            self.bookmarkCurrentRegion()\n                          },\n                        },\n                        {\n                          label: 'Toggle bookmark highlights',\n                          icon: HighlightIcon,\n                          type: 'checkbox',\n                          checked: self.bookmarkHighlightsVisible,\n                          onClick: () => {\n                            self.setBookmarkHighlightsVisible(\n                              !self.bookmarkHighlightsVisible,\n                            )\n                          },\n                        },\n                        {\n                          label: 'Toggle bookmark labels',\n                          icon: LabelIcon,\n                          type: 'checkbox',\n                          checked: self.bookmarkLabelsVisible,\n                          onClick: () => {\n                            self.setBookmarkLabelsVisible(\n                              !self.bookmarkLabelsVisible,\n                            )\n                          },\n                        },\n                      ],\n                    },\n                  ]\n                },\n\n                /**\n                 * #method\n                 */\n                rubberBandMenuItems() {\n                  return [\n                    ...superRubberBandMenuItems(),\n                    {\n                      label: 'Bookmark region',\n                      icon: BookmarkIcon,\n                      onClick: () => {\n                        const { leftOffset, rightOffset } = self\n                        const selectedRegions = self.getSelectedRegions(\n                          leftOffset,\n                          rightOffset,\n                        )\n                        const bookmarkWidget = self.activateBookmarkWidget()\n                        if (!selectedRegions.length) {\n                          throw new Error('no regions selected')\n                        } else {\n                          bookmarkWidget.addBookmark(selectedRegions[0]!)\n                        }\n                      },\n                    },\n                  ]\n                },\n              }\n            })\n            .actions(self => {\n              const keydownListener = (e: KeyboardEvent) => {\n                const activationSequence =\n                  (e.ctrlKey || e.metaKey) && e.shiftKey\n                // ctrl+shift+d or cmd+shift+d\n                if (activationSequence && e.code === 'KeyD') {\n                  e.preventDefault()\n                  self.activateBookmarkWidget()\n                  self.bookmarkCurrentRegion()\n                  getSession(self).notify('Bookmark created.', 'success')\n                }\n                // ctrl+shift+m or cmd+shift+m\n                if (activationSequence && e.code === 'KeyM') {\n                  e.preventDefault()\n                  self.navigateNewestBookmark()\n                }\n              }\n              return {\n                afterCreate() {\n                  document.addEventListener('keydown', keydownListener)\n                },\n                beforeDestroy() {\n                  document.removeEventListener('keydown', keydownListener)\n                },\n              }\n            })\n            .postProcessSnapshot(snap => {\n              // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n              if (!snap) {\n                return snap\n              }\n              const {\n                bookmarkHighlightsVisible,\n                bookmarkLabelsVisible,\n                ...rest\n              } = snap as unknown as Record<string, unknown>\n              return {\n                ...rest,\n                ...(bookmarkHighlightsVisible === false\n                  ? { bookmarkHighlightsVisible }\n                  : {}),\n                ...(bookmarkLabelsVisible === false\n                  ? { bookmarkLabelsVisible }\n                  : {}),\n              } as typeof snap\n            })\n\n          ;(pluggableElement as ViewType).stateModel = newStateModel\n        }\n        return pluggableElement\n      },\n    )\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToMenu('Tools', {\n        label: 'Bookmarks',\n        icon: BookmarksIcon,\n        onClick: (session: SessionWithWidgets) => {\n          let bookmarkWidget = session.widgets.get('GridBookmark')\n          if (!bookmarkWidget) {\n            bookmarkWidget = session.addWidget(\n              'GridBookmarkWidget',\n              'GridBookmark',\n            )\n          }\n          session.showWidget(bookmarkWidget)\n        },\n      })\n    }\n  }\n}\n","import Highlight from './Highlight.tsx'\nimport OverviewHighlight from './OverviewHighlight.tsx'\n\nimport type { IExtendedLGV } from '../../model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Base1DViewModel } from '@jbrowse/core/util/Base1DViewModel'\n\nexport default function AddHighlightModelF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LinearGenomeView-TracksContainerComponent',\n    // @ts-expect-error\n    (\n      rest: React.ReactNode[] | undefined,\n      { model }: { model: IExtendedLGV },\n    ) => {\n      return [\n        ...(rest || []),\n        <Highlight key=\"highlight_grid_bookmark\" model={model} />,\n      ]\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'LinearGenomeView-OverviewScalebarComponent',\n    // @ts-expect-error\n    (\n      rest: React.ReactNode[] | undefined,\n      { model, overview }: { model: IExtendedLGV; overview: Base1DViewModel },\n    ) => {\n      return [\n        ...(rest || []),\n        <OverviewHighlight\n          key=\"overview_highlight_grid_bookmark\"\n          model={model}\n          overview={overview}\n        />,\n      ]\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config GtfAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst GtfAdapter = ConfigurationSchema(\n  'GtfAdapter',\n  {\n    /**\n     * #slot\n     */\n    gtfLocation: {\n      type: 'fileLocation',\n      description: 'path to gtf file, also allows for gzipped gtf',\n      defaultValue: {\n        uri: '/path/to/my.gtf',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    aggregateField: {\n      type: 'string',\n      description:\n        'field used to aggregate multiple transcripts into a single parent gene feature',\n      defaultValue: 'gene_name',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"GtfAdapter\",\n     *   \"uri\": \"yourfile.gtf\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            gtfLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default GtfAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport GtfAdapterF from './GtfAdapter/index.ts'\nimport GuessAdapterF from './GuessAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class GtfPlugin extends Plugin {\n  name = 'GTFPlugin'\n\n  install(pluginManager: PluginManager) {\n    GtfAdapterF(pluginManager)\n    GuessAdapterF(pluginManager)\n  }\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function GtfAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'GtfAdapter',\n        displayName: 'GTF adapter',\n        configSchema,\n        getAdapterClass: () => import('./GtfAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport { getFileName } from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AdapterGuesser } from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAdapterF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n\n        return testAdapter(\n          fileName,\n          /\\.gtf(\\.gz)?$/i,\n          adapterHint,\n          'GtfAdapter',\n        )\n          ? {\n              type: 'GtfAdapter',\n              gtfLocation: file,\n            }\n          : adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config HicAdapter\n * #category adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst HicAdapter = ConfigurationSchema(\n  'HicAdapter',\n  {\n    /**\n     * #slot\n     */\n    hicLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.hic',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    resolutionMultiplier: {\n      type: 'number',\n      defaultValue: 1,\n      description: 'Initial resolution multiplier',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"HicAdapter\",\n     *   \"uri\": \"file.hic\",\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            hicLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default HicAdapter\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport ServerSideRendererType from '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\nimport { renderToAbstractCanvas } from '@jbrowse/core/util/offscreenCanvasUtils'\n\nimport type { MultiRegionContactRecord } from '../HicAdapter/HicAdapter.ts'\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { RenderArgsDeserialized as ServerSideRenderArgsDeserialized } from '@jbrowse/core/pluggableElementTypes/renderers/ServerSideRendererType'\nimport type { Region } from '@jbrowse/core/util/types'\n\nexport type HicFeature = MultiRegionContactRecord\n\nexport interface RenderArgsDeserialized extends ServerSideRenderArgsDeserialized {\n  regions: Region[]\n  bpPerPx: number\n  highResolutionScaling: number\n  resolution: number\n  adapterConfig: AnyConfigurationModel\n  displayHeight?: number\n  useLogScale?: boolean\n  colorScheme?: string\n}\n\nexport interface RenderArgsDeserializedWithFeatures extends RenderArgsDeserialized {\n  features: HicFeature[]\n  statusCallback?: (arg: string) => void\n}\n\ninterface HicAdapter {\n  getMultiRegionContactRecords: (\n    regions: Region[],\n    opts: Record<string, unknown>,\n  ) => Promise<MultiRegionContactRecord[]>\n}\n\nexport default class HicRenderer extends ServerSideRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const { displayHeight, regions, bpPerPx, colorScheme, useLogScale } =\n      renderProps\n\n    // Calculate total width across all regions\n    let totalWidthBp = 0\n    for (const region of regions) {\n      totalWidthBp += region.end - region.start\n    }\n    const width = totalWidthBp / bpPerPx\n    const hyp = width / 2\n    const height = displayHeight ?? hyp\n    const features = await this.getFeatures(renderProps)\n    const yScalar = height / Math.max(height, hyp)\n\n    const { makeImageData } = await import('./makeImageData.ts')\n\n    const res = await renderToAbstractCanvas(width, height, renderProps, ctx =>\n      makeImageData(ctx, {\n        ...renderProps,\n        yScalar,\n        features,\n        pluginManager: this.pluginManager,\n      }),\n    )\n\n    const serialized = {\n      ...res,\n      height,\n      width,\n      yScalar,\n      colorScheme,\n      useLogScale,\n    }\n    return rpcResult(serialized, collectTransferables(serialized))\n  }\n\n  async getFeatures(args: RenderArgsDeserialized) {\n    const { regions, sessionId, adapterConfig } = args\n    const { dataAdapter } = await getAdapter(\n      this.pluginManager,\n      sessionId,\n      adapterConfig,\n    )\n    return (dataAdapter as unknown as HicAdapter).getMultiRegionContactRecords(\n      regions,\n      args,\n    )\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config HicRenderer\n * #category renderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst HicRenderer = ConfigurationSchema(\n  'HicRenderer',\n  {\n    /**\n     * #slot\n     */\n    baseColor: {\n      type: 'color',\n      description: 'base color to be used in the hic alignment',\n      defaultValue: '#f00',\n    },\n    /**\n     * #slot\n     */\n    color: {\n      type: 'color',\n      description: 'the color of each feature in a hic alignment',\n      defaultValue: 'jexl:interpolate(count,scale)',\n      contextVariable: ['count', 'maxScore', 'baseColor', 'scale'],\n    },\n\n    /**\n     * #slot\n     */\n    maxHeight: {\n      type: 'integer',\n      description: 'the maximum height to be used in a hic rendering',\n      defaultValue: 600,\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default HicRenderer\n","import type React from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport {\n  FeatureDensityMixin,\n  NonBlockCanvasDisplayMixin,\n  TrackHeightMixin,\n} from '@jbrowse/plugin-linear-genome-view'\n\nimport type { HicFlatbushItem } from '../HicRenderer/types.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type {\n  ExportSvgDisplayOptions,\n  LegendItem,\n} from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #stateModel LinearHicDisplay\n * #category display\n * Non-block-based Hi-C display that renders to a single canvas\n * extends\n * - [BaseDisplay](../basedisplay)\n * - [TrackHeightMixin](../trackheightmixin)\n * - [FeatureDensityMixin](../featuredensitymixin)\n * - [NonBlockCanvasDisplayMixin](../nonblockcanvasdisplaymixin)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function stateModelFactory(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearHicDisplay',\n      BaseDisplay,\n      TrackHeightMixin(),\n      FeatureDensityMixin(),\n      NonBlockCanvasDisplayMixin(),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearHicDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        resolution: types.optional(types.number, 1),\n        /**\n         * #property\n         */\n        useLogScale: false,\n        /**\n         * #property\n         */\n        colorScheme: types.maybe(types.string),\n        /**\n         * #property\n         */\n        activeNormalization: 'KR',\n        /**\n         * #property\n         */\n        mode: 'triangular',\n        /**\n         * #property\n         */\n        showLegend: types.maybe(types.boolean),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      availableNormalizations: undefined as string[] | undefined,\n      /**\n       * #volatile\n       */\n      flatbush: undefined as ArrayBufferLike | undefined,\n      /**\n       * #volatile\n       */\n      flatbushItems: [] as HicFlatbushItem[],\n      /**\n       * #volatile\n       */\n      maxScore: 0,\n      /**\n       * #volatile\n       */\n      yScalar: 1,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return 'HicRenderer'\n      },\n\n      get rendererConfig() {\n        return {\n          ...getConf(self, 'renderer'),\n          ...(self.colorScheme\n            ? { color: 'jexl:interpolate(count,scale)' }\n            : {}),\n        }\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            config: self.rendererConfig,\n            resolution: self.resolution,\n            useLogScale: self.useLogScale,\n            colorScheme: self.colorScheme,\n            normalization: self.activeNormalization,\n            displayHeight: self.mode === 'adjust' ? self.height : undefined,\n          }\n        },\n\n        /**\n         * #method\n         * Returns legend items for the Hi-C color scale\n         */\n        legendItems(): LegendItem[] {\n          const colorScheme = self.colorScheme ?? 'juicebox'\n          const displayMax = self.useLogScale\n            ? self.maxScore\n            : Math.round(self.maxScore / 20)\n          const minLabel = self.useLogScale ? '1' : '0'\n          const maxLabel = `${displayMax.toLocaleString()}${self.useLogScale ? ' (log)' : ''}`\n\n          return [\n            {\n              label: `${minLabel} - ${maxLabel} (${colorScheme})`,\n            },\n          ]\n        },\n\n        /**\n         * #method\n         * Returns the width needed for the SVG legend if showLegend is enabled.\n         */\n        svgLegendWidth(): number {\n          // Hi-C legend is a fixed width gradient bar (120px + margin)\n          // Only show when we have data (maxScore > 0)\n          return self.showLegend && self.maxScore > 0 ? 140 : 0\n        },\n      }\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setFlatbushData(\n        flatbush: ArrayBufferLike | undefined,\n        items: HicFlatbushItem[],\n        maxScore: number,\n        yScalar: number,\n      ) {\n        self.flatbush = flatbush\n        self.flatbushItems = items\n        self.maxScore = maxScore\n        self.yScalar = yScalar\n      },\n      /**\n       * #action\n       */\n      reload() {\n        self.error = undefined\n      },\n      /**\n       * #action\n       */\n      setResolution(n: number) {\n        self.resolution = n\n      },\n      /**\n       * #action\n       */\n      setUseLogScale(f: boolean) {\n        self.useLogScale = f\n      },\n      /**\n       * #action\n       */\n      setColorScheme(f?: string) {\n        self.colorScheme = f\n      },\n      /**\n       * #action\n       */\n      setActiveNormalization(f: string) {\n        self.activeNormalization = f\n      },\n      /**\n       * #action\n       */\n      setAvailableNormalizations(f: string[]) {\n        self.availableNormalizations = f\n      },\n      /**\n       * #action\n       */\n      setMode(arg: string) {\n        self.mode = arg\n      },\n      /**\n       * #action\n       */\n      setShowLegend(arg: boolean) {\n        self.showLegend = arg\n      },\n    }))\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Use log scale',\n              type: 'checkbox',\n              checked: self.useLogScale,\n              onClick: () => {\n                self.setUseLogScale(!self.useLogScale)\n              },\n            },\n            {\n              label: 'Show legend',\n              type: 'checkbox',\n              checked: self.showLegend,\n              onClick: () => {\n                self.setShowLegend(!self.showLegend)\n              },\n            },\n            {\n              label: 'Rendering mode',\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Triangular',\n                  type: 'radio',\n                  checked: self.mode === 'triangular',\n                  onClick: () => {\n                    self.setMode('triangular')\n                  },\n                },\n                {\n                  label: 'Adjust to height of display',\n                  type: 'radio',\n                  checked: self.mode === 'adjust',\n                  onClick: () => {\n                    self.setMode('adjust')\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Color scheme',\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Fall',\n                  type: 'radio',\n                  checked: self.colorScheme === 'fall',\n                  onClick: () => {\n                    self.setColorScheme('fall')\n                  },\n                },\n                {\n                  label: 'Viridis',\n                  type: 'radio',\n                  checked: self.colorScheme === 'viridis',\n                  onClick: () => {\n                    self.setColorScheme('viridis')\n                  },\n                },\n                {\n                  label: 'Juicebox',\n                  type: 'radio',\n                  checked: self.colorScheme === 'juicebox',\n                  onClick: () => {\n                    self.setColorScheme('juicebox')\n                  },\n                },\n                {\n                  label: 'Default',\n                  type: 'radio',\n                  checked: self.colorScheme === undefined,\n                  onClick: () => {\n                    self.setColorScheme(undefined)\n                  },\n                },\n              ],\n            },\n\n            {\n              label: 'Resolution',\n              subMenu: [\n                {\n                  label: 'Finer resolution',\n                  onClick: () => {\n                    self.setResolution(self.resolution * 2)\n                  },\n                },\n                {\n                  label: 'Coarser resolution',\n                  onClick: () => {\n                    self.setResolution(self.resolution / 2)\n                  },\n                },\n              ],\n            },\n            ...(self.availableNormalizations\n              ? [\n                  {\n                    label: 'Normalization scheme',\n                    subMenu: self.availableNormalizations.map(norm => ({\n                      label: norm,\n                      type: 'radio',\n                      checked: norm === self.activeNormalization,\n                      onClick: () => {\n                        self.setActiveNormalization(norm)\n                      },\n                    })),\n                  },\n                ]\n              : []),\n          ]\n        },\n\n        /**\n         * #method\n         */\n        async renderSvg(\n          opts: ExportSvgDisplayOptions,\n        ): Promise<React.ReactNode> {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self as LinearHicDisplayModel, opts)\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttach } = await import('./afterAttach.ts')\n            doAfterAttach(self)\n          } catch (e) {\n            console.error(e)\n            self.setError(e)\n          }\n        })()\n      },\n    }))\n}\n\nexport type LinearHicDisplayStateModel = ReturnType<typeof stateModelFactory>\nexport type LinearHicDisplayModel = Instance<LinearHicDisplayStateModel>\n","import Plugin from '@jbrowse/core/Plugin'\nimport { colord } from '@jbrowse/core/util/colord'\n\nimport GuessAdapterF from './GuessAdapter/index.ts'\nimport HicAdapterF from './HicAdapter/index.ts'\nimport HicRendererF from './HicRenderer/index.ts'\nimport HicTrackF from './HicTrack/index.ts'\nimport LinearHicDisplayF from './LinearHicDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Colord } from '@jbrowse/core/util/colord'\n\nexport default class HicPlugin extends Plugin {\n  name = 'HicPlugin'\n\n  install(pluginManager: PluginManager) {\n    HicAdapterF(pluginManager)\n    HicRendererF(pluginManager)\n    HicTrackF(pluginManager)\n    LinearHicDisplayF(pluginManager)\n    GuessAdapterF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    const { jexl } = pluginManager\n    jexl.addFunction('alpha', (color: Colord, n: number) => color.alpha(n))\n    jexl.addFunction('hsl', (color: Colord) => colord(color.toHsl()))\n    jexl.addFunction('colorString', (color: Colord) => color.toHex())\n    jexl.addFunction(\n      'interpolate',\n      (count: number, scale: (n: number) => string) => scale(count),\n    )\n  }\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function HicAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'HicAdapter',\n        displayName: 'Hi-C adapter',\n        configSchema,\n        getAdapterClass: () => import('./HicAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport HicRenderer from './HicRenderer.tsx'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function HicRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new HicRenderer({\n        name: 'HicRenderer',\n        ReactComponent: lazy(() => import('./components/HicRendering.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function HicTrackF(pluginManager: PluginManager) {\n  pluginManager.addTrackType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new TrackType({\n      name: 'HicTrack',\n      displayName: 'Hi-C track',\n      configSchema,\n      stateModel: createBaseTrackModel(pluginManager, 'HicTrack', configSchema),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config HicTrack\n * #category track\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) =>\n  ConfigurationSchema(\n    'HicTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n\nexport default configSchema\n","import { lazy } from 'react'\n\nimport { DisplayType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchemaFactory from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearHicDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearHicDisplay',\n      displayName: 'Hi-C contact matrix display',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'HicTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(() => import('./components/ReactComponent.tsx')),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config LinearHicDisplay\n * #category display\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst HicTrackConfigFactory = (pluginManager: PluginManager) => {\n  return ConfigurationSchema(\n    'LinearHicDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: pluginManager.getRendererType('HicRenderer')!.configSchema,\n      /**\n       * #slot\n       */\n      height: {\n        type: 'number',\n        defaultValue: 300,\n        description: 'default height for the Hi-C track',\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport type HicTrackConfigModel = ReturnType<typeof HicTrackConfigFactory>\nexport type HicTrackConfig = Instance<HicTrackConfigModel>\nexport default HicTrackConfigFactory\n","import { getFileName } from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessAdapterF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        return (/\\.hic$/i.test(fileName) && !adapterHint) ||\n          adapterHint === 'HicAdapter'\n          ? {\n              type: 'HicAdapter',\n              hicLocation: file,\n            }\n          : adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) =>\n        adapterName === 'HicAdapter'\n          ? 'HicTrack'\n          : trackTypeGuesser(adapterName)\n    },\n  )\n}\n","import { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel\n */\nexport const Job = types\n  .model('Job', {\n    /**\n     * #property\n     */\n    name: types.string,\n    /**\n     * #property\n     */\n    statusMessage: types.maybe(types.string),\n    /**\n     * #property\n     */\n    progressPct: types.number,\n  })\n  .volatile(() => ({\n    cancelCallback() {},\n  }))\n  .actions(self => ({\n    /**\n     * #action\n     */\n    setCancelCallback(cancelCallback: () => void) {\n      self.cancelCallback = cancelCallback\n    },\n\n    /**\n     * #action\n     */\n    setStatusMessage(message?: string) {\n      self.statusMessage = message\n    },\n\n    /**\n     * #action\n     */\n    setProgressPct(pct: number) {\n      self.progressPct = pct\n    },\n  }))\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\n\nimport { stateModelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nexport const configSchema = ConfigurationSchema('JobsListWidget', {})\n\nexport default function JobsListWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'JobsListWidget',\n      heading: 'Jobs list',\n      configSchema,\n      stateModel: stateModelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/JobsListWidget.tsx')),\n    })\n  })\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport { Indexing } from '@jbrowse/core/ui/Icons'\nimport {\n  isAbstractMenuManager,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\n\nimport JobsListWidgetF from './JobsListWidget/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\n\nexport type { JobsListModel } from './JobsListWidget/model.ts'\n\nexport default class JobsManagementPlugin extends Plugin {\n  name = 'JobsManagementPlugin'\n\n  install(pluginManager: PluginManager) {\n    JobsListWidgetF(pluginManager)\n  }\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToMenu('Tools', {\n        label: 'Jobs list',\n        icon: Indexing, // TODO: pick a better icon\n        onClick: (session: SessionWithWidgets) => {\n          if (isSessionModelWithWidgets(session)) {\n            const { widgets } = session\n            let jobStatusWidget = widgets.get('JobsList')\n            if (!jobStatusWidget) {\n              jobStatusWidget = session.addWidget('JobsListWidget', 'JobsList')\n              session.showWidget(jobStatusWidget)\n            } else {\n              session.showWidget(jobStatusWidget)\n            }\n          }\n        },\n      })\n    }\n  }\n}\n","import { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { Job } from './jobModel.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance, SnapshotIn } from '@jbrowse/mobx-state-tree'\n\nexport interface NewJob extends SnapshotIn<typeof Job> {\n  cancelCallback(): void\n  setStatusMessage(msg?: string): void\n}\n\n/**\n * #stateModel JobsListModel\n */\nexport function stateModelFactory(_pluginManager: PluginManager) {\n  return types\n    .model('JobsListModel', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: types.literal('JobsListWidget'),\n      /**\n       * #property\n       */\n      jobs: types.array(Job),\n      /**\n       * #property\n       */\n      finished: types.array(Job),\n      /**\n       * #property\n       */\n      queued: types.array(Job),\n      /**\n       * #property\n       */\n      aborted: types.array(Job),\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      addJob(job: NewJob) {\n        const { cancelCallback, name } = job\n        const existing = self.jobs.find(job => job.name === name)\n        if (existing) {\n          return existing\n        }\n        const length = self.jobs.push(job)\n        const addedJob = self.jobs[length - 1]!\n        addedJob.setCancelCallback(cancelCallback)\n        return addedJob\n      },\n      /**\n       * #action\n       */\n      removeJob(jobName: string) {\n        const index = self.jobs.findIndex(job => job.name === jobName)\n        if (index === -1) {\n          return undefined\n        }\n        const removed = self.jobs.splice(index, 1)\n        return removed[0]\n      },\n      /**\n       * #action\n       */\n      addFinishedJob(job: NewJob) {\n        const existing = self.finished.find(\n          finishedJob => finishedJob.name === job.name,\n        )\n        if (existing) {\n          return existing\n        }\n        const length = self.finished.push(job)\n        return self.finished[length - 1]\n      },\n      /**\n       * #action\n       */\n      addQueuedJob(job: NewJob) {\n        const existing = self.queued.find(\n          queuedJob => queuedJob.name === job.name,\n        )\n        if (existing) {\n          return existing\n        }\n        const length = self.queued.push(job)\n        return self.queued[length - 1]\n      },\n      /**\n       * #action\n       */\n      addAbortedJob(job: NewJob) {\n        const existing = self.aborted.find(\n          abortedJob => abortedJob.name === job.name,\n        )\n        if (existing) {\n          return existing\n        }\n        const length = self.aborted.push(job)\n        return self.aborted[length - 1]\n      },\n      /**\n       * #action\n       */\n      removeQueuedJob(jobName: string) {\n        const index = self.queued.findIndex(job => job.name === jobName)\n        if (index === -1) {\n          return undefined\n        }\n        const removed = self.queued.splice(index, 1)\n        return removed[0]\n      },\n      /**\n       * #action\n       */\n      updateJobStatusMessage(jobName: string, message?: string) {\n        const job = self.jobs.find(job => job.name === jobName)\n        if (!job) {\n          throw new Error(`No job found with name ${jobName}`)\n        }\n        job.setStatusMessage(message)\n      },\n      /**\n       * #action\n       */\n      updateJobProgressPct(jobName: string, pct: number) {\n        const job = self.jobs.find(job => job.name === jobName)\n        if (!job) {\n          throw new Error(`No job found with name ${jobName}`)\n        }\n        job.setProgressPct(pct)\n      },\n    }))\n}\n\nexport type JobsListStateModel = ReturnType<typeof stateModelFactory>\nexport type JobsListModel = Instance<JobsListStateModel>\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseConnectionConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\n/**\n * #config JBrowse1Connection\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst JBrowse1Connection = ConfigurationSchema(\n  'JBrowse1Connection',\n  {\n    /**\n     * #slot\n     */\n    dataDirLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'http://mysite.com/jbrowse/data/',\n        locationType: 'UriLocation',\n      },\n      description:\n        'the location of the JBrowse 1 data directory, often something like http://mysite.com/jbrowse/data/',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      description:\n        'name of the assembly the connection belongs to, should be a single entry',\n      type: 'stringArray',\n      defaultValue: [],\n    },\n  },\n  {\n    /**\n     * #baseConfiguration\n     */\n    baseConfiguration: baseConnectionConfig,\n  },\n)\n\nexport default JBrowse1Connection\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseConnectionModelFactory } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getSession } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .compose(\n      'JBrowse1Connection',\n      BaseConnectionModelFactory(pluginManager),\n      types.model({\n        configuration: ConfigurationReference(configSchema),\n        type: types.literal('JBrowse1Connection'),\n      }),\n    )\n\n    .actions(self => ({\n      async connect() {\n        const session = getSession(self)\n        try {\n          const dataDirLocation = getConf(self, 'dataDirLocation')\n          const { fetchJb1 } = await import('./jb1ConfigLoad.ts')\n          const { convertTrackConfig } = await import('./jb1ToJb2.ts')\n          const config = await fetchJb1(dataDirLocation)\n          const assemblyName = getConf(self, 'assemblyNames')[0]\n          if (!assemblyName) {\n            throw new Error('assembly name required for JBrowse 1 connection')\n          }\n          // @ts-expect-error\n          const jb2Tracks = config.tracks?.map(jb1Track => ({\n            ...convertTrackConfig(jb1Track, config.dataRoot || ''),\n            assemblyNames: [assemblyName],\n          }))\n\n          self.setTrackConfs(jb2Tracks)\n        } catch (error) {\n          console.error(error)\n          session.notifyError(\n            `There was a problem connecting to the JBrowse 1 data directory \"${self.name}\". Please make sure you have entered a valid location. The error that was thrown is: \"${error}\"`,\n            error,\n          )\n          session.breakConnection?.(self.configuration)\n        }\n      },\n    }))\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config JBrowse1TextSearchAdapter\n * note: metadata about tracks and assemblies covered by text search adapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default ConfigurationSchema(\n  'JBrowse1TextSearchAdapter',\n  {\n    /**\n     * #slot\n     */\n    namesIndexLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/volvox/names', locationType: 'UriLocation' },\n      description: 'the location of the JBrowse1 names index data directory',\n    },\n    /**\n     * #slot\n     */\n    tracks: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'List of tracks covered by text search adapter',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'List of assemblies covered by text search adapter',\n    },\n  },\n  {\n    explicitlyTyped: true,\n    /**\n     * #identifier\n     */\n    explicitIdentifier: 'textSearchAdapterId',\n  },\n)\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config NCListAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst NCListAdapter = ConfigurationSchema(\n  'NCListAdapter',\n  {\n    /**\n     * #slot\n     */\n    rootUrlTemplate: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my/{refseq}/trackData.json',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    refNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'List of refNames used by the NCList used for aliasing',\n    },\n  },\n  {\n    explicitlyTyped: true,\n  },\n)\nexport default NCListAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport GuessNCListF from './GuessNCList/index.ts'\nimport JBrowse1ConnectionF from './JBrowse1Connection/index.ts'\nimport JBrowse1TextSearchAdapterF from './JBrowse1TextSearchAdapter/index.ts'\nimport NCListAdapterF from './NCListAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class LegacyJBrowsePlugin extends Plugin {\n  name = 'LegacyJBrowsePlugin'\n\n  install(pluginManager: PluginManager) {\n    NCListAdapterF(pluginManager)\n    GuessNCListF(pluginManager)\n    JBrowse1TextSearchAdapterF(pluginManager)\n    JBrowse1ConnectionF(pluginManager)\n  }\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function NCListAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'NCListAdapter',\n        displayName: 'NCList adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Uncommon',\n        },\n        getAdapterClass: () =>\n          import('./NCListAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { getFileName } from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AdapterGuesser } from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function GuessNCListF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        return (/trackData.jsonz?$/i.test(fileName) && !adapterHint) ||\n          adapterHint === 'NCListAdapter'\n          ? {\n              type: 'NCListAdapter',\n              rootUrlTemplate: file,\n            }\n          : adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n}\n","import TextSearchAdapterType from '@jbrowse/core/pluggableElementTypes/TextSearchAdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function JBrowse1TextSearchAdapterF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addTextSearchAdapterType(\n    () =>\n      new TextSearchAdapterType({\n        name: 'JBrowse1TextSearchAdapter',\n        configSchema,\n        description: 'A JBrowse 1 text search adapter',\n        getAdapterClass: () =>\n          import('./JBrowse1TextSearchAdapter.ts').then(t => t.default),\n      }),\n  )\n}\n","import ConnectionType from '@jbrowse/core/pluggableElementTypes/ConnectionType'\n\nimport configSchema from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function JBrowse1ConnectionF(pluginManager: PluginManager) {\n  pluginManager.addConnectionType(\n    () =>\n      new ConnectionType({\n        name: 'JBrowse1Connection',\n        configSchema,\n        stateModel: modelFactory(pluginManager),\n        displayName: 'JBrowse 1 Data',\n        description: 'A JBrowse 1 data directory',\n        url: '//jbrowse.org/',\n      }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { assembleLocString, toLocale } from '@jbrowse/core/util'\nimport { linearPileupDisplayConfigSchemaFactory } from '@jbrowse/plugin-alignments'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\n\n/**\n * #config LGVSyntenyDisplay\n * extends config\n * - [LinearPileupDisplay](../linearpileupdisplay)\n */\nfunction configSchemaF(pluginManager: PluginManager) {\n  pluginManager.jexl.addFunction('lgvSyntenyTooltip', (f: Feature) => {\n    const mate = f.get('mate')\n    const l1name = f.get('name') || f.get('id')\n    const l2name = mate?.name || mate?.id\n    return [\n      l1name ? `Name1: ${l1name}` : '',\n      l2name ? `Name2: ${l2name}` : '',\n      `Loc1: ${assembleLocString({\n        refName: f.get('refName'),\n        start: f.get('start'),\n        end: f.get('end'),\n      })} (${toLocale(f.get('end') - f.get('start'))}bp)`,\n      `Loc2: ${assembleLocString({\n        refName: mate.refName,\n        start: mate.start,\n        end: mate.end,\n      })} (${toLocale(mate.end - mate.start)}bp)`,\n    ]\n      .filter(f => !!f)\n      .join('<br/>')\n  })\n  return ConfigurationSchema(\n    'LGVSyntenyDisplay',\n    {\n      mouseover: {\n        type: 'string',\n        defaultValue: 'jexl:lgvSyntenyTooltip(feature)',\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearPileupDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaF\n","import { lazy } from 'react'\n\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport {\n  getContainingTrack,\n  getContainingView,\n  getSession,\n  isSessionModelWithWidgets,\n} from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { SharedLinearPileupDisplayMixin } from '@jbrowse/plugin-alignments'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\nconst LaunchSyntenyViewDialog = lazy(\n  () => import('./components/LaunchSyntenyViewDialog.tsx'),\n)\n\n/**\n * #stateModel LGVSyntenyDisplay\n * displays location of \"synteny\" feature in a plain LGV, allowing linking out\n * to external synteny views\n *\n * extends\n * - [SharedLinearPileupDisplayMixin](../sharedlinearpileupdisplaymixin)\n */\nfunction stateModelFactory(schema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LGVSyntenyDisplay',\n      SharedLinearPileupDisplayMixin(schema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LGVSyntenyDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(schema),\n      }),\n    )\n    .views(self => {\n      const superContextMenuItems = self.contextMenuItems\n      return {\n        /**\n         * #method\n         */\n        contextMenuItems() {\n          const feature = self.contextMenuFeature\n          return [\n            ...superContextMenuItems(),\n            ...(feature\n              ? [\n                  {\n                    label: 'Launch synteny view for this position',\n                    onClick: () => {\n                      getSession(self).queueDialog(handleClose => [\n                        LaunchSyntenyViewDialog,\n                        {\n                          view: getContainingView(self) as LGV,\n                          trackId: getConf(getContainingTrack(self), 'trackId'),\n                          handleClose,\n                          session: getSession(self),\n                          feature,\n                        },\n                      ])\n                    },\n                  },\n                ]\n              : []),\n          ]\n        },\n      }\n    })\n    .views(self => {\n      const {\n        trackMenuItems: superTrackMenuItems,\n        colorSchemeSubMenuItems: superColorSchemeSubMenuItems,\n      } = self\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Color scheme',\n              subMenu: [...superColorSchemeSubMenuItems()],\n            },\n          ]\n        },\n      }\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      selectFeature(feature: Feature) {\n        const session = getSession(self)\n        if (isSessionModelWithWidgets(session)) {\n          const r2 = getContainingView(self)\n          let r3 = r2\n          try {\n            r3 = getContainingView(r3)\n          } catch (e) {}\n          const featureWidget = session.addWidget(\n            'SyntenyFeatureWidget',\n            'syntenyFeature',\n            {\n              featureData: feature.toJSON(),\n              view: r3,\n              track: getContainingTrack(self),\n            },\n          )\n          session.showWidget(featureWidget)\n        }\n        session.setSelection(feature)\n      },\n      afterCreate() {\n        // use color by strand to help indicate inversions better on first load,\n        // otherwise use selected orientation\n        if (!self.colorBySetting && self.colorBy.type === 'normal') {\n          self.setColorScheme({ type: 'strand' })\n        }\n      },\n    }))\n}\n\nexport default stateModelFactory\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config LinearComparativeDisplay\n */\nfunction configSchemaFactory(_pluginManager: any) {\n  return ConfigurationSchema(\n    'LinearComparativeDisplay',\n    {},\n    {\n      explicitlyTyped: true,\n\n      /**\n       * #identifier\n       */\n      explicitIdentifier: 'displayId',\n    },\n  )\n}\n\nexport default configSchemaFactory\n","import {\n  ConfigurationReference,\n  readConfObject,\n} from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport {\n  dedupe,\n  getContainingView,\n  getSession,\n  makeAbortableReaction,\n} from '@jbrowse/core/util'\nimport { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport { getRpcSessionId } from '@jbrowse/core/util/tracks'\nimport { getParent, getSnapshot, types } from '@jbrowse/mobx-state-tree'\n\nimport type { LinearComparativeViewModel } from '../LinearComparativeView/model.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel LinearComparativeDisplay\n * extends\n * - [BaseDisplay](../basedisplay)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearComparativeDisplay',\n      BaseDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearComparativeDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      renderInProgress: undefined as string | undefined,\n      /**\n       * #volatile\n       */\n      features: undefined as Feature[] | undefined,\n      /**\n       * #volatile\n       */\n      message: undefined as string | undefined,\n      /**\n       * #volatile\n       */\n      loadingStatus: undefined as string | undefined,\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #getter\n         */\n        get level() {\n          return getParent<{ height: number; level: number }>(self, 4).level\n        },\n        /**\n         * #getter\n         */\n        get height() {\n          return getParent<{ height: number; level: number }>(self, 4).height\n        },\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n          }\n        },\n      }\n    })\n    .actions(self => {\n      let stopToken: undefined | string\n\n      return {\n        /**\n         * #action\n         * controlled by a reaction\n         */\n        setLoading(newStopToken: string) {\n          self.message = undefined\n          self.error = undefined\n          stopToken = newStopToken\n        },\n\n        /**\n         * #action\n         * controlled by a reaction\n         */\n        setMessage(messageText: string) {\n          self.message = messageText\n          self.error = undefined\n          stopToken = undefined\n        },\n\n        /**\n         * #action\n         * controlled by a reaction\n         */\n        setLoadingStatus(messageText: string) {\n          self.loadingStatus = messageText\n        },\n\n        /**\n         * #action\n         * controlled by a reaction\n         */\n        setRendered(args?: { features: Feature[] }) {\n          if (!args) {\n            return\n          }\n          const { features } = args\n          const existingFeatures = self.features || []\n\n          const featIds = new Set(existingFeatures.map(f => f.id()))\n          const newFeatIds = new Set(features.map(f => f.id()))\n\n          let foundNewFeatureNotInExistingMap = false\n          let foundExistingFeatureNotInNewMap = false\n          for (const feat of features) {\n            if (!featIds.has(feat.id())) {\n              foundNewFeatureNotInExistingMap = true\n              break\n            }\n          }\n          for (const existingFeat of existingFeatures) {\n            if (!newFeatIds.has(existingFeat.id())) {\n              foundExistingFeatureNotInNewMap = true\n              break\n            }\n          }\n\n          self.message = undefined\n          self.error = undefined\n          stopToken = undefined\n\n          if (\n            foundNewFeatureNotInExistingMap ||\n            foundExistingFeatureNotInNewMap ||\n            !self.features\n          ) {\n            self.features = features\n          }\n        },\n\n        /**\n         * #action\n         * controlled by a reaction\n         */\n        setError(error: unknown) {\n          console.error(error)\n          if (stopToken !== undefined) {\n            stopStopToken(stopToken)\n          }\n          // the rendering failed for some reason\n          self.message = undefined\n          self.error = error\n          stopToken = undefined\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        makeAbortableReaction(\n          // @ts-expect-error\n          self,\n          renderBlockData,\n          renderBlockEffect,\n          {\n            name: `${self.type} ${self.id} rendering`,\n            delay: 1000,\n            fireImmediately: true,\n          },\n          self.setLoading,\n          self.setRendered,\n          self.setError,\n        )\n      },\n    }))\n}\nfunction renderBlockData(self: LinearComparativeDisplay) {\n  const { rpcManager } = getSession(self)\n  const display = self\n\n  // Alternative to readConfObject(config) is below used because\n  // renderProps is something under our control.  Compare to\n  // serverSideRenderedBlock\n  readConfObject(self.configuration)\n\n  const { level, adapterConfig } = self\n  const parent = getContainingView(self) as LinearComparativeViewModel\n  const sessionId = getRpcSessionId(self)\n  getSnapshot(parent)\n  return parent.initialized\n    ? {\n        rpcManager,\n        renderProps: {\n          ...(display.renderProps() as Record<string, unknown>),\n          model: display,\n          level,\n          view: parent,\n          adapterConfig,\n          sessionId,\n          timeout: 1000000,\n          self,\n        },\n      }\n    : undefined\n}\n\nasync function renderBlockEffect(props: ReturnType<typeof renderBlockData>) {\n  if (!props) {\n    return\n  }\n\n  const { rpcManager, renderProps } = props\n  const { model, sessionId, adapterConfig, level } = renderProps\n  const view = renderProps.view.views[level]!\n  return {\n    features: dedupe(\n      (await rpcManager.call(sessionId, 'CoreGetFeatures', {\n        regions: view.staticBlocks.contentBlocks,\n        sessionId,\n        adapterConfig,\n        statusCallback: (arg: string) => {\n          model.setLoadingStatus(arg)\n        },\n      })) as Feature[],\n      f => f.id(),\n    ),\n  }\n}\n\nexport default stateModelFactory\nexport type LinearComparativeDisplayModel = ReturnType<typeof stateModelFactory>\nexport type LinearComparativeDisplay = Instance<LinearComparativeDisplayModel>\n","import { lazy } from 'react'\n\nimport BaseViewModel from '@jbrowse/core/pluggableElementTypes/models/BaseViewModel'\nimport { avg, getSession, isSessionModelWithWidgets } from '@jbrowse/core/util'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport {\n  addDisposer,\n  addMiddleware,\n  cast,\n  getPath,\n  types,\n} from '@jbrowse/mobx-state-tree'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport { autorun } from 'mobx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { Instance, SnapshotIn } from '@jbrowse/mobx-state-tree'\nimport type {\n  LinearGenomeViewModel,\n  LinearGenomeViewStateModel,\n} from '@jbrowse/plugin-linear-genome-view'\n\n// lazies\nconst ReturnToImportFormDialog = lazy(\n  () => import('@jbrowse/core/ui/ReturnToImportFormDialog'),\n)\n\n/**\n * #stateModel LinearComparativeView\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nfunction stateModelFactory(pluginManager: PluginManager) {\n  const LinearSyntenyViewHelper = pluginManager.getViewType(\n    'LinearSyntenyViewHelper',\n  )?.stateModel\n  return types\n    .compose(\n      'LinearComparativeView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        id: ElementId,\n        /**\n         * #property\n         */\n        type: types.literal('LinearComparativeView'),\n        /**\n         * #property\n         */\n        trackSelectorType: 'hierarchical',\n        /**\n         * #property\n         */\n        showIntraviewLinks: true,\n        /**\n         * #property\n         */\n        linkViews: false,\n        /**\n         * #property\n         */\n        interactiveOverlay: false,\n        /**\n         * #property\n         */\n        showDynamicControls: true,\n        /**\n         * #property\n         */\n        levels: types.array(LinearSyntenyViewHelper!),\n        /**\n         * #property\n         * currently this is limited to an array of two\n         */\n        views: types.array(\n          pluginManager.getViewType('LinearGenomeView')!\n            .stateModel as LinearGenomeViewStateModel,\n        ),\n\n        /**\n         * #property\n         * this represents tracks specific to this view specifically used for\n         * read vs ref dotplots where this track would not really apply\n         * elsewhere\n         */\n        viewTrackConfigs: types.array(\n          pluginManager.pluggableConfigSchemaType('track'),\n        ),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      width: undefined as number | undefined,\n      /**\n       * #volatile\n       * Set to true when the view is being initialized from a launch spec to\n       * avoid showing the import form during loading\n       */\n      isLoading: false,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get initialized() {\n        return (\n          // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n          self.width !== undefined &&\n          self.views.length > 0 &&\n          self.views.every(view => view.initialized)\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get refNames() {\n        return self.views.map(v => [\n          ...new Set(v.staticBlocks.map(m => m.refName)),\n        ])\n      },\n\n      /**\n       * #getter\n       */\n      get assemblyNames() {\n        return [...new Set(self.views.flatMap(v => v.assemblyNames))]\n      },\n\n      /**\n       * #getter\n       */\n      get loadingMessage() {\n        return this.showLoading ? 'Loading' : undefined\n      },\n\n      /**\n       * #getter\n       * Whether to show a loading indicator instead of the import form or view\n       */\n      get showLoading() {\n        return self.isLoading || (!this.initialized && self.views.length > 0)\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          addMiddleware(self, (rawCall, next) => {\n            if (rawCall.type === 'action' && rawCall.id === rawCall.rootId) {\n              // doesn't link showTrack/hideTrack, doesn't make sense in\n              // synteny views most time\n              const syncActions = [\n                'horizontalScroll',\n                'zoomTo',\n                'setScaleFactor',\n              ]\n\n              if (self.linkViews && syncActions.includes(rawCall.name)) {\n                const sourcePath = getPath(rawCall.context)\n                next(rawCall)\n                // Sync to all other views\n                for (const view of self.views) {\n                  const viewPath = getPath(view)\n                  if (viewPath !== sourcePath) {\n                    // @ts-expect-error\n                    view[rawCall.name](rawCall.args[0])\n                  }\n                }\n                return\n              }\n            }\n            next(rawCall)\n          }),\n        )\n      },\n\n      // automatically removes session assemblies associated with this view\n      // e.g. read vs ref\n      beforeDestroy() {\n        const session = getSession(self)\n        for (const name of self.assemblyNames) {\n          session.removeTemporaryAssembly?.(name)\n        }\n      },\n\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.width = newWidth\n      },\n\n      /**\n       * #action\n       */\n      setIsLoading(arg: boolean) {\n        self.isLoading = arg\n      },\n\n      /**\n       * #action\n       */\n      setViews(views: SnapshotIn<LinearGenomeViewModel>[]) {\n        self.views = cast(views)\n        const levels = []\n        for (let i = 0; i < views.length - 1; i++) {\n          levels.push({ level: i })\n        }\n        self.levels = cast(levels)\n      },\n\n      /**\n       * #action\n       */\n      removeView(view: LinearGenomeViewModel) {\n        self.views.remove(view)\n      },\n\n      /**\n       * #action\n       */\n      setLevelHeight(newHeight: number, level = 0) {\n        const l = self.levels[level]!\n        l.setHeight(newHeight)\n        return l.height\n      },\n      /**\n       * #action\n       */\n      setLinkViews(arg: boolean) {\n        self.linkViews = arg\n      },\n      /**\n       * #action\n       */\n      setShowDynamicControls(arg: boolean) {\n        self.showDynamicControls = arg\n      },\n      /**\n       * #action\n       */\n      activateTrackSelector(level: number) {\n        if (self.trackSelectorType === 'hierarchical') {\n          const session = getSession(self)\n          if (isSessionModelWithWidgets(session)) {\n            const selector = session.addWidget(\n              'HierarchicalTrackSelectorWidget',\n              'hierarchicalTrackSelector',\n              {\n                view: self.levels[level],\n              },\n            )\n            session.showWidget(selector)\n            return selector\n          }\n        }\n        throw new Error(`invalid track selector type ${self.trackSelectorType}`)\n      },\n\n      /**\n       * #action\n       */\n      toggleTrack(trackId: string, level = 0) {\n        self.levels[level]?.toggleTrack(trackId)\n      },\n\n      /**\n       * #action\n       */\n      showTrack(trackId: string, level = 0, initialSnapshot = {}) {\n        if (!self.levels[level]) {\n          self.levels[level] = cast({ level })\n        }\n        self.levels[level].showTrack(trackId, initialSnapshot)\n      },\n\n      /**\n       * #action\n       */\n      hideTrack(trackId: string, level = 0) {\n        self.levels[level]?.hideTrack(trackId)\n      },\n      /**\n       * #action\n       */\n      squareView() {\n        const average = avg(self.views.map(v => v.bpPerPx))\n        for (const view of self.views) {\n          const center = view.pxToBp(view.width / 2)\n          view.setNewView(average, view.offsetPx)\n          if (center.refName) {\n            view.centerAt(center.coord, center.refName, center.index)\n          }\n        }\n      },\n      /**\n       * #action\n       */\n      clearView() {\n        self.views = cast([])\n        self.levels = cast([])\n      },\n    }))\n    .views(() => ({\n      /**\n       * #method\n       * includes a subset of view menu options because the full list is a\n       * little overwhelming. overridden by subclasses\n       */\n      headerMenuItems(): MenuItem[] {\n        return []\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      menuItems(): MenuItem[] {\n        return [\n          {\n            label: 'Return to import form',\n            onClick: () => {\n              getSession(self).queueDialog(handleClose => [\n                ReturnToImportFormDialog,\n                {\n                  model: self,\n                  handleClose,\n                },\n              ])\n            },\n            icon: FolderOpenIcon,\n          },\n        ]\n      },\n      /**\n       * #method\n       */\n      rubberBandMenuItems() {\n        return [\n          {\n            label: 'Zoom to region(s)',\n            onClick: () => {\n              for (const view of self.views) {\n                const { leftOffset, rightOffset } = view\n                if (leftOffset && rightOffset) {\n                  view.moveTo(leftOffset, rightOffset)\n                }\n              }\n            },\n          },\n        ]\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function comparativeViewWidthAutorun() {\n              if (self.width) {\n                for (const view of self.views) {\n                  view.setWidth(self.width)\n                }\n              }\n            },\n            { name: 'ComparativeViewWidth' },\n          ),\n        )\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // @ts-expect-error\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      const { tracks, levels = [{ tracks, level: 0 }], ...rest } = snap || {}\n      return {\n        ...rest,\n        levels,\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        trackSelectorType,\n        showIntraviewLinks,\n        linkViews,\n        interactiveOverlay,\n        showDynamicControls,\n        viewTrackConfigs,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(trackSelectorType !== 'hierarchical' ? { trackSelectorType } : {}),\n        ...(!showIntraviewLinks ? { showIntraviewLinks } : {}),\n        ...(linkViews ? { linkViews } : {}),\n        ...(interactiveOverlay ? { interactiveOverlay } : {}),\n        ...(!showDynamicControls ? { showDynamicControls } : {}),\n        ...(viewTrackConfigs.length ? { viewTrackConfigs } : {}),\n      } as typeof snap\n    })\n}\n\nexport type LinearComparativeViewStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearComparativeViewModel =\n  Instance<LinearComparativeViewStateModel>\n\nexport default stateModelFactory\n","import { lazy } from 'react'\n\nimport { getContainingTrack, getSession } from '@jbrowse/core/util'\nimport AddIcon from '@mui/icons-material/Add'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { PluggableElementType } from '@jbrowse/core/pluggableElementTypes'\nimport type DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nconst ReadVsRefDialog = lazy(() => import('./LinearReadVsRef.tsx'))\n\nfunction isDisplay(elt: { name: string }): elt is DisplayType {\n  return elt.name === 'LinearPileupDisplay'\n}\n\nexport default function LinearReadVsRefMenuItemF(pm: PluginManager) {\n  pm.addToExtensionPoint(\n    'Core-extendPluggableElement',\n    (pluggableElement: PluggableElementType) => {\n      if (!isDisplay(pluggableElement)) {\n        return pluggableElement\n      }\n      pluggableElement.stateModel = pluggableElement.stateModel.extend(self => {\n        const superContextMenuItems = self.contextMenuItems\n        return {\n          views: {\n            contextMenuItems() {\n              const feature = self.contextMenuFeature\n              const track = getContainingTrack(self)\n              return [\n                ...superContextMenuItems(),\n                ...(feature\n                  ? [\n                      {\n                        label: 'Linear read vs ref',\n                        icon: AddIcon,\n                        onClick: () => {\n                          getSession(self).queueDialog(handleClose => [\n                            ReadVsRefDialog,\n                            {\n                              track,\n                              feature,\n                              handleClose,\n                            },\n                          ])\n                        },\n                      },\n                    ]\n                  : []),\n              ]\n            },\n          },\n        }\n      })\n      return pluggableElement\n    },\n  )\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport { applyAlpha, colorSchemes, getQueryColor } from './drawSyntenyUtils.ts'\nimport baseModelFactory from '../LinearComparativeDisplay/stateModelFactory.ts'\n\nimport type { ColorScheme } from './drawSyntenyUtils.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\ninterface Pos {\n  offsetPx: number\n}\n\nexport interface FeatPos {\n  p11: Pos\n  p12: Pos\n  p21: Pos\n  p22: Pos\n  f: Feature\n  cigar: string[]\n}\n\n/**\n * #stateModel LinearSyntenyDisplay\n * extends\n * - [LinearComparativeDisplay](../linearcomparativedisplay)\n */\nfunction stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearSyntenyDisplay',\n      baseModelFactory(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearSyntenyDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         * color scheme to use for rendering synteny features\n         */\n        colorBy: types.optional(types.string, 'default'),\n        /**\n         * #property\n         * alpha transparency value for synteny drawing (0-1)\n         */\n        alpha: types.optional(types.number, 0.2),\n        /**\n         * #property\n         * minimum alignment length to display (in bp)\n         */\n        minAlignmentLength: types.optional(types.number, 0),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       * canvas used for drawing visible screen\n       */\n      mainCanvas: null as HTMLCanvasElement | null,\n\n      /**\n       * #volatile\n       * canvas used for drawing click map with feature ids this renders a\n       * unique color per alignment, so that it can be re-traced after a\n       * feature click with getImageData at that pixel\n       */\n      clickMapCanvas: null as HTMLCanvasElement | null,\n\n      /**\n       * #volatile\n       * canvas used for drawing click map with cigar data this can show if you\n       * are mousing over a insertion/deletion. it is similar in purpose to the\n       * clickMapRef but was not feasible to pack this into the clickMapRef\n       */\n      cigarClickMapCanvas: null as HTMLCanvasElement | null,\n\n      /**\n       * #volatile\n       * canvas for drawing mouseover shading this is separate from the other\n       * code for speed: don't have to redraw entire canvas to do a feature's\n       * mouseover shading\n       */\n      mouseoverCanvas: null as HTMLCanvasElement | null,\n\n      /**\n       * #volatile\n       * assigned by reaction\n       */\n      featPositions: [] as FeatPos[],\n\n      /**\n       * #volatile\n       * currently mouse'd over feature\n       */\n      mouseoverId: undefined as string | undefined,\n\n      /**\n       * #volatile\n       * currently click'd over feature\n       */\n      clickId: undefined as string | undefined,\n\n      /**\n       * #volatile\n       * currently mouseover'd CIGAR subfeature\n       */\n      cigarMouseoverId: -1,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setFeatPositions(arg: FeatPos[]) {\n        self.featPositions = arg\n      },\n      /**\n       * #action\n       */\n      setMainCanvasRef(ref: HTMLCanvasElement | null) {\n        self.mainCanvas = ref\n      },\n      /**\n       * #action\n       */\n      setClickMapCanvasRef(ref: HTMLCanvasElement | null) {\n        self.clickMapCanvas = ref\n      },\n      /**\n       * #action\n       */\n      setCigarClickMapCanvasRef(ref: HTMLCanvasElement | null) {\n        self.cigarClickMapCanvas = ref\n      },\n      /**\n       * #action\n       */\n      setMouseoverCanvasRef(ref: HTMLCanvasElement | null) {\n        self.mouseoverCanvas = ref\n      },\n      /**\n       * #action\n       */\n      setMouseoverId(arg?: string) {\n        self.mouseoverId = arg\n      },\n      /**\n       * #action\n       */\n      setCigarMouseoverId(arg: number) {\n        self.cigarMouseoverId = arg\n      },\n      /**\n       * #action\n       */\n      setClickId(arg?: string) {\n        self.clickId = arg\n      },\n      /**\n       * #action\n       */\n      setAlpha(value: number) {\n        self.alpha = value\n      },\n      /**\n       * #action\n       */\n      setMinAlignmentLength(value: number) {\n        self.minAlignmentLength = value\n      },\n      /**\n       * #action\n       */\n      setColorBy(value: string) {\n        self.colorBy = value\n      },\n    }))\n\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get adapterConfig() {\n        return {\n          name: self.parentTrack.configuration.adapter.type,\n          assemblyNames: getConf(self, 'assemblyNames'),\n          ...getConf(self.parentTrack, 'adapter'),\n        }\n      },\n\n      /**\n       * #getter\n       */\n      get trackIds() {\n        return getConf(self, 'trackIds') as string[]\n      },\n\n      /**\n       * #getter\n       */\n      get numFeats() {\n        return self.featPositions.length\n      },\n\n      /**\n       * #getter\n       * used for synteny svg rendering\n       */\n      get ready() {\n        return this.numFeats > 0\n      },\n\n      /**\n       * #getter\n       */\n      get featMap() {\n        return Object.fromEntries(self.featPositions.map(f => [f.f.id(), f]))\n      },\n\n      /**\n       * #getter\n       * cached color scheme config based on colorBy\n       */\n      get colorSchemeConfig() {\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        return colorSchemes[self.colorBy as ColorScheme] || colorSchemes.default\n      },\n\n      /**\n       * #getter\n       * cached CIGAR colors with alpha applied\n       */\n      get colorMapWithAlpha() {\n        const { alpha } = self\n        const activeColorMap = this.colorSchemeConfig.cigarColors\n        return {\n          I: applyAlpha(activeColorMap.I, alpha),\n          N: applyAlpha(activeColorMap.N, alpha),\n          D: applyAlpha(activeColorMap.D, alpha),\n          X: applyAlpha(activeColorMap.X, alpha),\n          M: applyAlpha(activeColorMap.M, alpha),\n          '=': applyAlpha(activeColorMap['='], alpha),\n        }\n      },\n\n      /**\n       * #getter\n       * cached positive strand color with alpha\n       */\n      get posColorWithAlpha() {\n        const posColor =\n          self.colorBy === 'strand' ? colorSchemes.strand.posColor : 'red'\n        return applyAlpha(posColor, self.alpha)\n      },\n\n      /**\n       * #getter\n       * cached negative strand color with alpha\n       */\n      get negColorWithAlpha() {\n        const negColor =\n          self.colorBy === 'strand' ? colorSchemes.strand.negColor : 'blue'\n        return applyAlpha(negColor, self.alpha)\n      },\n\n      /**\n       * #getter\n       * cached query colors with alpha - returns a function that caches results\n       */\n      get queryColorWithAlphaMap() {\n        const { alpha } = self\n        const cache = new Map<string, string>()\n        return (queryName: string) => {\n          if (!cache.has(queryName)) {\n            const color = getQueryColor(queryName)\n            cache.set(queryName, applyAlpha(color, alpha))\n          }\n          return cache.get(queryName)!\n        }\n      },\n\n      /**\n       * #getter\n       * cached query total lengths for minAlignmentLength filtering\n       */\n      get queryTotalLengths() {\n        if (self.minAlignmentLength <= 0) {\n          return undefined\n        }\n        const lengths = new Map<string, number>()\n        for (const { f } of self.featPositions) {\n          const queryName = f.get('name') || f.get('id') || f.id()\n          const alignmentLength = Math.abs(f.get('end') - f.get('start'))\n          const currentTotal = lengths.get(queryName) || 0\n          lengths.set(queryName, currentTotal + alignmentLength)\n        }\n        return lengths\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { doAfterAttach } = await import('./afterAttach.ts')\n            doAfterAttach(self)\n          } catch (e) {\n            console.error(e)\n            self.setError(e)\n          }\n        })()\n      },\n    }))\n}\n\nexport type LinearSyntenyDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearSyntenyDisplayModel = Instance<LinearSyntenyDisplayStateModel>\n\nexport default stateModelFactory\n","import { SvgIcon } from '@mui/material'\n\nimport type { SvgIconProps } from '@mui/material'\n\nexport function Curves(props: SvgIconProps) {\n  return (\n    <SvgIcon {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M16.5,21C13.5,21 12.31,16.76 11.05,12.28C10.14,9.04 9,5 7.5,5C4.11,5 4,11.93 4,12H2C2,11.63 2.06,3 7.5,3C10.5,3 11.71,7.25 12.97,11.74C13.83,14.8 15,19 16.5,19C19.94,19 20.03,12.07 20.03,12H22.03C22.03,12.37 21.97,21 16.5,21Z\"\n      />\n    </SvgIcon>\n  )\n}\n\nexport function StraightLines(props: SvgIconProps) {\n  return (\n    <SvgIcon {...props}>\n      <path\n        fill=\"currentColor\"\n        d=\"M22 12L17 22L7.1 6.04L4.24 12H2L7 2L16.9 17.96L19.76 12H22Z\"\n      />\n    </SvgIcon>\n  )\n}\n","import { lazy } from 'react'\n\nimport { getSession } from '@jbrowse/core/util'\nimport { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport CropFreeIcon from '@mui/icons-material/CropFree'\nimport LinkIcon from '@mui/icons-material/Link'\nimport PhotoCameraIcon from '@mui/icons-material/PhotoCamera'\nimport ShuffleIcon from '@mui/icons-material/Shuffle'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { autorun, observable, when } from 'mobx'\n\nimport { Curves } from './components/Icons.tsx'\nimport baseModel from '../LinearComparativeView/model.ts'\n\nimport type {\n  ExportSvgOptions,\n  ImportFormSyntenyTrack,\n  LinearSyntenyViewInit,\n} from './types.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n// lazies\nconst ExportSvgDialog = lazy(() => import('./components/ExportSvgDialog.tsx'))\nconst DiagonalizationProgressDialog = lazy(\n  () => import('./components/DiagonalizationProgressDialog.tsx'),\n)\n\n/**\n * #stateModel LinearSyntenyView\n * extends\n * - [LinearComparativeView](../linearcomparativeview)\n */\nexport default function stateModelFactory(pluginManager: PluginManager) {\n  return types\n    .compose(\n      'LinearSyntenyView',\n      baseModel(pluginManager),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearSyntenyView'),\n        /**\n         * #property/\n         */\n        drawCIGAR: true,\n        /**\n         * #property/\n         */\n        drawCIGARMatchesOnly: false,\n        /**\n         * #property\n         */\n        drawCurves: false,\n        /**\n         * #property\n         */\n        drawLocationMarkers: false,\n        /**\n         * #property\n         * used for initializing the view from a session snapshot\n         * example:\n         * ```json\n         * {\n         *   views: [\n         *     { loc: \"chr1:1-100\", assembly: \"hg38\", tracks: [\"genes\"] },\n         *     { loc: \"chr1:1-100\", assembly: \"mm39\" }\n         *   ],\n         *   tracks: [\"hg38_vs_mm39_synteny\"]\n         * }\n         * ```\n         */\n        init: types.frozen<LinearSyntenyViewInit | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      importFormSyntenyTrackSelections:\n        observable.array<ImportFormSyntenyTrack>(),\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get hasSomethingToShow() {\n        return self.views.length > 0 || !!self.init\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       * Whether to show a loading indicator instead of the import form or view\n       */\n      get showLoading() {\n        return self.isLoading || (!self.initialized && self.hasSomethingToShow)\n      },\n      /**\n       * #getter\n       * Whether to show the import form\n       */\n      get showImportForm() {\n        return !self.hasSomethingToShow\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      importFormRemoveRow(idx: number) {\n        self.importFormSyntenyTrackSelections.splice(idx, 1)\n      },\n      /**\n       * #action\n       */\n      clearImportFormSyntenyTracks() {\n        self.importFormSyntenyTrackSelections.clear()\n      },\n      /**\n       * #action\n       */\n      setImportFormSyntenyTrack(arg: number, val: ImportFormSyntenyTrack) {\n        self.importFormSyntenyTrackSelections[arg] = val\n      },\n      /**\n       * #action\n       */\n      setDrawCurves(arg: boolean) {\n        self.drawCurves = arg\n      },\n      /**\n       * #action\n       */\n      setDrawCIGAR(arg: boolean) {\n        self.drawCIGAR = arg\n      },\n      /**\n       * #action\n       */\n      setDrawCIGARMatchesOnly(arg: boolean) {\n        self.drawCIGARMatchesOnly = arg\n      },\n      /**\n       * #action\n       */\n      setDrawLocationMarkers(arg: boolean) {\n        self.drawLocationMarkers = arg\n      },\n      /**\n       * #action\n       */\n      showAllRegions() {\n        for (const view of self.views) {\n          view.showAllRegionsInAssembly()\n        }\n      },\n      /**\n       * #action\n       */\n      setInit(init?: LinearSyntenyViewInit) {\n        self.init = init\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      async exportSvg(opts: ExportSvgOptions) {\n        const { renderToSvg } =\n          await import('./svgcomponents/SVGLinearSyntenyView.tsx')\n        const html = await renderToSvg(self as LinearSyntenyViewModel, opts)\n        // eslint-disable-next-line @typescript-eslint/no-deprecated\n        const { saveAs } = await import('file-saver-es')\n\n        saveAs(\n          new Blob([html], { type: 'image/svg+xml' }),\n          opts.filename || 'image.svg',\n        )\n      },\n    }))\n    .views(self => {\n      const superHeaderMenuItems = self.headerMenuItems\n      const superMenuItems = self.menuItems\n      return {\n        /**\n         * #method\n         * includes a subset of view menu options because the full list is a\n         * little overwhelming\n         */\n        headerMenuItems() {\n          return [\n            ...superHeaderMenuItems(),\n            {\n              label: 'Square view',\n              onClick: self.squareView,\n              description:\n                'Makes both views use the same zoom level, adjusting to the average of each',\n              icon: CropFreeIcon,\n              helpText:\n                'Square view synchronizes the zoom levels of both genome views by calculating the average zoom level and applying it to both panels. This helps ensure features are displayed at comparable scales, making it easier to compare syntenic regions visually.',\n            },\n            {\n              label: 'Re-order chromosomes',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  DiagonalizationProgressDialog,\n                  {\n                    handleClose,\n                    model: self,\n                  },\n                ])\n              },\n              icon: ShuffleIcon,\n              description:\n                \"Reorder and reorient query regions to minimize crossing lines, also known as 'diagonalizing'\",\n              helpText:\n                \"This operation 'diagonalizes' the data which algorithmically reorders and reorients chromosomes to minimize crossing synteny lines, creating a more diagonal pattern. This makes it easier to identify large-scale genomic rearrangements, inversions, and translocations. The process may take a few moments for large genomes.\",\n            },\n            {\n              label: 'Show...',\n              subMenu: [\n                {\n                  label: 'Show all regions',\n                  onClick: self.showAllRegions,\n                  description: 'Show entire genome assemblies',\n                  icon: VisibilityIcon,\n                  helpText:\n                    'This command will zoom out all views to display the entire genome assemblies. This is useful when you want to get a high-level overview of syntenic relationships across whole genomes or when you need to reset the view after zooming into specific regions.',\n                },\n                {\n                  label: 'Show dynamic controls',\n                  type: 'checkbox',\n                  checked: self.showDynamicControls,\n                  onClick: () => {\n                    self.setShowDynamicControls(!self.showDynamicControls)\n                  },\n                  helpText:\n                    'Toggle visibility of dynamic controls like opacity and minimum length sliders. These controls allow you to adjust synteny visualization parameters in real-time.',\n                },\n                {\n                  label: 'Show CIGAR insertions/deletions',\n                  checked: self.drawCIGAR,\n                  type: 'checkbox',\n                  description:\n                    'If disabled, only shows the broad scale CIGAR match',\n                  onClick: () => {\n                    self.setDrawCIGAR(!self.drawCIGAR)\n                  },\n                  helpText:\n                    'CIGAR strings encode detailed alignment information including matches, insertions, and deletions. When enabled, this option visualizes the fine-scale variations in syntenic alignments. Disable this for a cleaner view that shows only broad syntenic blocks.',\n                },\n                {\n                  label: 'Show CIGAR matches only',\n                  checked: self.drawCIGARMatchesOnly,\n                  type: 'checkbox',\n                  description:\n                    'If enabled, hides the insertions and deletions in the CIGAR strings',\n                  onClick: () => {\n                    self.setDrawCIGARMatchesOnly(!self.drawCIGARMatchesOnly)\n                  },\n                  helpText:\n                    'When comparing divergent genomes, showing all insertions and deletions can clutter the view. This option filters the CIGAR visualization to show only the matching regions, providing a cleaner view of conserved syntenic blocks while hiding small-scale indels.',\n                },\n                {\n                  label: 'Show curved lines',\n                  type: 'checkbox',\n                  checked: self.drawCurves,\n                  icon: Curves,\n                  onClick: () => {\n                    self.setDrawCurves(!self.drawCurves)\n                  },\n                  helpText:\n                    'Toggle between straight lines and smooth bezier curves for synteny connections. Curved lines can make the visualization more aesthetically pleasing and may help reduce visual clutter when many syntenic regions are displayed. Straight lines provide a more direct representation.',\n                },\n                {\n                  label: 'Show location markers',\n                  type: 'checkbox',\n                  checked: self.drawLocationMarkers,\n                  description:\n                    'Draw periodic markers to show location within large matches',\n                  onClick: () => {\n                    self.setDrawLocationMarkers(!self.drawLocationMarkers)\n                  },\n                  helpText:\n                    'Location markers add periodic visual indicators along long syntenic blocks, helping you track position and scale within large conserved regions. This is particularly useful when examining very long syntenic matches where it can be difficult to gauge relative position.',\n                },\n              ],\n            },\n            {\n              label: 'Link views',\n              type: 'checkbox',\n              checked: self.linkViews,\n              icon: LinkIcon,\n              onClick: () => {\n                self.setLinkViews(!self.linkViews)\n              },\n              helpText:\n                'When linked, panning and zooming in one genome view will automatically adjust the other view to maintain the correspondence shown by synteny lines. This makes it easier to explore syntenic regions interactively. Unlink views to navigate each genome independently.',\n            },\n            {\n              label: 'Export SVG',\n              icon: PhotoCameraIcon,\n              onClick: (): void => {\n                getSession(self).queueDialog(handleClose => [\n                  ExportSvgDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n        /**\n         * #method\n         */\n        menuItems() {\n          return [\n            ...superMenuItems(),\n            {\n              label: 'Export SVG',\n              icon: PhotoCameraIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  ExportSvgDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n      }\n    })\n    .actions(self => ({\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            async function initAutorun() {\n              const { init, width } = self\n              if (!width || !init) {\n                return\n              }\n\n              const session = getSession(self)\n              const { assemblyManager } = session\n\n              try {\n                // Wait for all assemblies to be ready and get their regions\n                const assemblies = await Promise.all(\n                  init.views.map(async v => {\n                    const asm = await assemblyManager.waitForAssembly(\n                      v.assembly,\n                    )\n                    if (!asm) {\n                      throw new Error(`Assembly ${v.assembly} failed to load`)\n                    }\n                    return asm\n                  }),\n                )\n\n                // Set up the views with displayed regions (not using init)\n                self.setViews(\n                  assemblies.map(asm => ({\n                    type: 'LinearGenomeView' as const,\n                    bpPerPx: 1,\n                    offsetPx: 0,\n                    hideHeader: true,\n                    displayedRegions: asm.regions,\n                  })),\n                )\n\n                // Wait for child views to initialize\n                await Promise.all(\n                  self.views.map(view => when(() => view.initialized)),\n                )\n\n                // Navigate to locations and show tracks on child views\n                await Promise.all(\n                  init.views.map(async (viewInit, idx) => {\n                    const view = self.views[idx]\n                    if (!view) {\n                      return\n                    }\n                    if (viewInit.loc) {\n                      await view.navToLocString(viewInit.loc, viewInit.assembly)\n                    } else {\n                      view.showAllRegionsInAssembly(viewInit.assembly)\n                    }\n                    if (viewInit.tracks) {\n                      for (const trackId of viewInit.tracks) {\n                        view.showTrack(trackId)\n                      }\n                    }\n                  }),\n                )\n\n                // Show synteny tracks\n                if (init.tracks) {\n                  for (const trackId of init.tracks) {\n                    self.showTrack(trackId)\n                  }\n                }\n\n                // Clear init state\n                self.setInit(undefined)\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n                self.setInit(undefined)\n              }\n            },\n            { name: 'LinearSyntenyViewInit' },\n          ),\n        )\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        init,\n        drawCIGAR,\n        drawCIGARMatchesOnly,\n        drawCurves,\n        drawLocationMarkers,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(!drawCIGAR ? { drawCIGAR } : {}),\n        ...(drawCIGARMatchesOnly ? { drawCIGARMatchesOnly } : {}),\n        ...(drawCurves ? { drawCurves } : {}),\n        ...(drawLocationMarkers ? { drawLocationMarkers } : {}),\n      } as typeof snap\n    })\n}\nexport type LinearSyntenyViewStateModel = ReturnType<typeof stateModelFactory>\nexport type LinearSyntenyViewModel = Instance<LinearSyntenyViewStateModel>\n","import {\n  hideTrackGeneric,\n  showTrackGeneric,\n  toggleTrackGeneric,\n} from '@jbrowse/core/util/tracks'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { getParent, types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nexport function linearSyntenyViewHelperModelFactory(\n  pluginManager: PluginManager,\n) {\n  return types\n    .model('LinearSyntenyViewHelper', {\n      /**\n       * #property\n       */\n      id: ElementId,\n      /**\n       * #property\n       */\n      type: 'LinearSyntenyViewHelper',\n      /**\n       * #property\n       */\n      tracks: types.array(\n        pluginManager.pluggableMstType('track', 'stateModel'),\n      ),\n      /**\n       * #property\n       */\n      height: 100,\n      /**\n       * #property\n       */\n      level: types.number,\n    })\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setHeight(n: number) {\n        self.height = n\n        return self.height\n      },\n\n      /**\n       * #action\n       */\n      showTrack(trackId: string, initialSnapshot = {}) {\n        return showTrackGeneric(self, trackId, initialSnapshot)\n      },\n\n      /**\n       * #action\n       */\n      hideTrack(trackId: string) {\n        return hideTrackGeneric(self, trackId)\n      },\n      /**\n       * #action\n       */\n      toggleTrack(trackId: string) {\n        toggleTrackGeneric(self, trackId)\n      },\n    }))\n    .views(self => ({\n      get assemblyNames() {\n        const p = getParent<{ views: LinearGenomeViewModel[] }>(self, 2)\n        return [\n          p.views[self.level]!.assemblyNames[0],\n          p.views[self.level + 1]!.assemblyNames[0],\n        ]\n      },\n    }))\n}\n\nexport type LinearSyntenyViewHelperStateModel = ReturnType<\n  typeof linearSyntenyViewHelperModelFactory\n>\nexport type LinearSyntenyViewHelperModel =\n  Instance<LinearSyntenyViewHelperStateModel>\n","import ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\n\nimport { linearSyntenyViewHelperModelFactory } from './stateModelFactory.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nfunction UnusedComponent() {\n  return <div />\n}\n\nexport default function LinearSyntenyViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'LinearSyntenyViewHelper',\n      displayName: 'Linear synteny view (helper)',\n      viewMetadata: {\n        hiddenFromGUI: true,\n      },\n      stateModel: linearSyntenyViewHelperModelFactory(pluginManager),\n      ReactComponent: UnusedComponent,\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { stateModelFactory as BaseFeatureWidgetStateModelF } from '@jbrowse/core/BaseFeatureWidget'\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport WidgetType from '@jbrowse/core/pluggableElementTypes/WidgetType'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('SyntenyFeatureWidget', {})\n\nfunction stateModelF(pluginManager: PluginManager) {\n  return types.compose(\n    BaseFeatureWidgetStateModelF(pluginManager),\n    types.model('SyntenyFeatureWidget', {\n      /**\n       * #property\n       */\n      type: types.literal('SyntenyFeatureWidget'),\n      /**\n       * #property\n       */\n      level: types.maybe(types.number),\n    }),\n  )\n}\n\nexport default function SyntenyFeatureWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(\n    () =>\n      new WidgetType({\n        name: 'SyntenyFeatureWidget',\n        heading: 'Synteny feature details',\n        configSchema,\n        stateModel: stateModelF(pluginManager),\n        ReactComponent: lazy(() => import('./SyntenyFeatureDetail.tsx')),\n      }),\n  )\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport CalendarIcon from '@mui/icons-material/CalendarViewDay'\n\nimport LGVSyntenyDisplayF from './LGVSyntenyDisplay/index.ts'\nimport LaunchLinearSyntenyViewF from './LaunchLinearSyntenyView.ts'\nimport LinearComparativeDisplayF from './LinearComparativeDisplay/index.ts'\nimport LinearComparativeViewF from './LinearComparativeView/index.ts'\nimport LinearReadVsRefMenuItemF from './LinearReadVsRef/index.ts'\nimport LinearSyntenyDisplayF from './LinearSyntenyDisplay/index.ts'\nimport LinearSyntenyViewF from './LinearSyntenyView/index.ts'\nimport LinearSyntenyViewHelperF from './LinearSyntenyViewHelper/index.tsx'\nimport SyntenyFeatureWidgetF from './SyntenyFeatureDetail/index.ts'\nimport SyntenyTrackF from './SyntenyTrack/index.tsx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport type { LinearSyntenyImportFormSyntenyOption } from './LinearSyntenyView/components/ImportForm/ImportSyntenyTrackSelectorArea.tsx'\nexport type { LinearSyntenyViewModel } from './LinearSyntenyView/model.ts'\n\nexport default class LinearComparativeViewPlugin extends Plugin {\n  name = 'LinearComparativeViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    LinearSyntenyViewHelperF(pluginManager)\n    LinearComparativeViewF(pluginManager)\n    LinearSyntenyViewF(pluginManager)\n    LinearComparativeDisplayF(pluginManager)\n    LinearSyntenyDisplayF(pluginManager)\n    SyntenyFeatureWidgetF(pluginManager)\n    LGVSyntenyDisplayF(pluginManager)\n    LaunchLinearSyntenyViewF(pluginManager)\n    SyntenyTrackF(pluginManager)\n    LinearReadVsRefMenuItemF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['Add'], {\n        label: 'Linear synteny view',\n        icon: CalendarIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('LinearSyntenyView', {})\n        },\n      })\n    }\n  }\n}\n","import { lazy } from 'react'\n\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\n\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearComparativeViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'LinearComparativeView',\n      viewMetadata: {\n        hiddenFromGUI: true,\n      },\n      displayName: 'Linear comparative view',\n      stateModel: modelFactory(pluginManager),\n      ReactComponent: lazy(\n        () => import('./components/LinearComparativeView.tsx'),\n      ),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\n\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearSyntenyViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'LinearSyntenyView',\n      displayName: 'Linear synteny view',\n      stateModel: modelFactory(pluginManager),\n      ReactComponent: lazy(() => import('./components/LinearSyntenyView.tsx')),\n    })\n  })\n}\n","import DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchemaF.ts'\nimport stateModelFactory from './stateModelFactory.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearComparativeDisplayF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearComparativeDisplay',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'SyntenyTrack',\n      viewType: 'LinearComparativeView',\n      ReactComponent: () => {\n        return null\n      },\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './configSchemaF.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearSyntenyDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new DisplayType({\n      name: 'LinearSyntenyDisplay',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'SyntenyTrack',\n      viewType: 'LinearSyntenyViewHelper',\n      ReactComponent: lazy(() => import('./components/Component.tsx')),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport baseConfigFactory from '../LinearComparativeDisplay/configSchemaF.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearSyntenyDisplay\n */\nfunction configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearSyntenyDisplay',\n    {\n      /**\n       * #slot\n       * currently unused\n       */\n      trackIds: {\n        type: 'stringArray',\n        defaultValue: [],\n      },\n\n      /**\n       * #slot\n       * currently unused\n       */\n      middle: {\n        type: 'boolean',\n        defaultValue: true,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       * this refers to the LinearComparativeDisplay\n       */\n      baseConfiguration: baseConfigFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaFactory\n","import DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\n\nimport configSchemaF from './configSchemaF.ts'\nimport stateModelF from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LGVSyntenyDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    const stateModel = stateModelF(configSchema)\n    return new DisplayType({\n      name: 'LGVSyntenyDisplay',\n      configSchema,\n      stateModel,\n      trackType: 'SyntenyTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n","import type { LinearSyntenyViewModel } from './LinearSyntenyView/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\ntype LSV = LinearSyntenyViewModel\n\ninterface ViewData {\n  loc?: string\n  assembly: string\n  tracks?: string[]\n}\n\nexport default function LaunchLinearSyntenyView(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-LinearSyntenyView',\n    // @ts-expect-error\n    async ({\n      session,\n      views,\n      tracks = [],\n    }: {\n      session: AbstractSessionModel\n      views: ViewData[]\n      tracks?: string[] | string[][]\n    }) => {\n      // Flatten tracks array if it's 2D (for backwards compatibility)\n      const flatTracks = Array.isArray(tracks[0])\n        ? (tracks as string[][]).flat()\n        : (tracks as string[])\n\n      // Use the init property to let the model handle initialization\n      session.addView('LinearSyntenyView', {\n        init: {\n          views: views.map(v => ({\n            loc: v.loc,\n            assembly: v.assembly,\n            tracks: v.tracks,\n          })),\n          tracks: flatTracks,\n        },\n      }) as LSV\n    },\n  )\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function registerSyntenyTrack(pluginManager: PluginManager) {\n  pluginManager.addTrackType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new TrackType({\n      name: 'SyntenyTrack',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pluginManager,\n        'SyntenyTrack',\n        configSchema,\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config SyntenyTrack\n * extends\n * - [BaseTrack](../basetrack)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = (pluginManager: PluginManager) =>\n  ConfigurationSchema(\n    'SyntenyTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n\nexport default configSchema\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { BaseLinearDisplay } from '@jbrowse/plugin-linear-genome-view'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\n\n/**\n * #stateModel LinearLollipopDisplay\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearLollipopDisplay',\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearLollipopDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #getter\n         */\n        get blockType() {\n          return 'dynamicBlocks'\n        },\n        /**\n         * #getter\n         */\n        get renderDelay() {\n          return 500\n        },\n        /**\n         * #method\n         */\n        renderProps() {\n          return {\n            ...superRenderProps(),\n            config: self.configuration.renderer,\n          }\n        },\n        /**\n         * #getter\n         */\n        get rendererTypeName() {\n          return self.configuration.renderer.type\n        },\n      }\n    })\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\n\nexport default class LollipopRenderer extends FeatureRendererType {}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'LollipopRenderer',\n  {\n    strokeColor: {\n      type: 'color',\n      description: 'the outer color of each lollipop',\n      defaultValue: 'green',\n      contextVariable: ['feature'],\n    },\n    innerColor: {\n      type: 'color',\n      description: 'the inner color of each lollipop',\n      defaultValue: '#7fc75f',\n      contextVariable: ['feature'],\n    },\n    strokeWidth: {\n      type: 'number',\n      description: 'width of the stroked border',\n      defaultValue: 4,\n      contextVariable: ['feature'],\n    },\n    radius: {\n      type: 'number',\n      description: 'radius in pixels of each lollipop body',\n      defaultValue: `jexl:sqrt(max(3, (get(feature,'score')*10)/3.14))`,\n      contextVariable: ['feature'],\n    },\n    caption: {\n      type: 'string',\n      description:\n        'the tooltip caption displayed when the mouse hovers over a lollipop',\n      defaultValue: `jexl:get(feature,'name')`,\n      contextVariable: ['feature'],\n    },\n    minStickLength: {\n      type: 'number',\n      description: 'minimum lollipop \"stick\" length, in pixels',\n      defaultValue: 5,\n    },\n    stickColor: {\n      type: 'color',\n      description: 'color of the lollipop stick',\n      defaultValue: 'black',\n      contextVariable: ['feature'],\n    },\n    stickWidth: {\n      type: 'number',\n      description: 'width in pixels of the lollipop stick',\n      defaultValue: 2,\n      contextVariable: ['feature'],\n    },\n    score: {\n      type: 'number',\n      description:\n        'the \"score\" of each lollipop, displayed as a number in the center of the circle',\n      defaultValue: `jexl:get(feature,'score')`,\n      contextVariable: ['feature'],\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport LinearLollipopDisplayF from './LinearLollipopDisplay/index.ts'\nimport LollipopRendererF from './LollipopRenderer/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class LollipopPlugin extends Plugin {\n  name = 'LollipopPlugin'\n\n  install(pluginManager: PluginManager) {\n    LollipopRendererF(pluginManager)\n    LinearLollipopDisplayF(pluginManager)\n  }\n}\n","import { lazy } from 'react'\n\nimport LollipopRenderer from './LollipopRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LollipopRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new LollipopRenderer({\n        name: 'LollipopRenderer',\n        ReactComponent: lazy(\n          () => import('./components/LollipopRendering.tsx'),\n        ),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { DisplayType } from '@jbrowse/core/pluggableElementTypes'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\n\nimport { configSchemaFactory } from './configSchema.ts'\nimport { stateModelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearLollipopDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'LinearLollipopDisplay',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'LollipopTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearLollipopDisplay\n */\nexport function configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearLollipopDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: pluginManager.pluggableConfigSchemaType('renderer'),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('AboutWidget', {})\n\nconst stateModel = types.model('AboutWidget', {\n  id: ElementId,\n  type: types.literal('AboutWidget'),\n})\n\nexport default function AboutWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'AboutWidget',\n      heading: 'About',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(() => import('./components/AboutWidget.tsx')),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('HelpWidget', {})\n\nconst stateModel = types.model('HelpWidget', {\n  id: ElementId,\n  type: types.literal('HelpWidget'),\n})\n\nexport default function HelpWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'HelpWidget',\n      heading: 'Help',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(() => import('./components/HelpWidget.tsx')),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nconst configSchema = ConfigurationSchema('ImportSessionWidget', {})\n\nconst stateModel = types.model('ImportSessionWidget', {\n  id: ElementId,\n  type: types.literal('ImportSessionWidget'),\n})\n\nexport default function ImportSessionWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'ImportSessionWidget',\n      heading: 'Import session',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(\n        () => import('./components/ImportSessionWidget.tsx'),\n      ),\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { WidgetType } from '@jbrowse/core/pluggableElementTypes'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport const configSchema = ConfigurationSchema('SessionManager', {})\n\nexport const stateModel = types.model('SessionManager', {\n  id: ElementId,\n  type: types.literal('SessionManager'),\n})\n\nexport default function SessionManagerF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(() => {\n    return new WidgetType({\n      name: 'SessionManager',\n      heading: 'Recent sessions',\n      configSchema,\n      stateModel,\n      ReactComponent: lazy(() => import('./components/SessionManager.tsx')),\n    })\n  })\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport HelpIcon from '@mui/icons-material/Help'\nimport InfoIcon from '@mui/icons-material/Info'\n\nimport AboutWidgetF from './AboutWidget/index.ts'\nimport HelpWidgetF from './HelpWidget/index.ts'\nimport ImportSessionWidgetF from './ImportSessionWidget/index.ts'\nimport SessionManagerF from './SessionManager/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { SessionWithWidgets } from '@jbrowse/core/util'\n\nexport default class MenusPlugin extends Plugin {\n  name = 'MenusPlugin'\n\n  install(pluginManager: PluginManager) {\n    AboutWidgetF(pluginManager)\n    HelpWidgetF(pluginManager)\n    ImportSessionWidgetF(pluginManager)\n    SessionManagerF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToMenu('Help', {\n        label: 'About',\n        icon: InfoIcon,\n        onClick: (session: SessionWithWidgets) => {\n          const widget = session.addWidget('AboutWidget', 'aboutWidget')\n          session.showWidget(widget)\n        },\n      })\n      pluginManager.rootModel.appendToMenu('Help', {\n        label: 'Help',\n        icon: HelpIcon,\n        onClick: (session: SessionWithWidgets) => {\n          const widget = session.addWidget('HelpWidget', 'helpWidget')\n          session.showWidget(widget)\n        },\n      })\n    }\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport default ConfigurationSchema(\n  'SPARQLAdapter',\n  {\n    endpoint: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'https://somesite.com/sparql',\n        locationType: 'UriLocation',\n      },\n      description: 'URL of the SPARQL endpoint',\n    },\n    queryTemplate: {\n      type: 'text',\n      defaultValue: '',\n      description:\n        'SPARQL query where {start} {end} and {refName} will get replaced for each call',\n    },\n    refNamesQueryTemplate: {\n      type: 'text',\n      defaultValue: '',\n      description:\n        'SPARQL query that returns the possible refNames in a ?refName column',\n    },\n    refNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Possible refNames used by the SPARQL endpoint (ignored if \"refNamesQueryTemplate\" is provided)',\n    },\n    additionalQueryParams: {\n      type: 'stringArray',\n      defaultValue: [],\n      description:\n        'Additional parameters to add to the query, e.g. \"format=JSON\"',\n    },\n  },\n  { explicitlyTyped: true },\n)\n","import Plugin from '@jbrowse/core/Plugin'\nimport { getFileName } from '@jbrowse/core/util/tracks'\n\nimport SPARQLAdapterF from './SPARQLAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AdapterGuesser } from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default class RdfPlugin extends Plugin {\n  name = 'RdfPlugin'\n\n  install(pluginManager: PluginManager) {\n    SPARQLAdapterF(pluginManager)\n    pluginManager.addToExtensionPoint(\n      'Core-guessAdapterForLocation',\n      (adapterGuesser: AdapterGuesser) => {\n        return (\n          file: FileLocation,\n          index?: FileLocation,\n          adapterHint?: string,\n        ) => {\n          const regexGuess = /\\/sparql$/i\n          const adapterName = 'SPARQLAdapter'\n          const fileName = getFileName(file)\n          if (regexGuess.test(fileName) || adapterHint === adapterName) {\n            return {\n              type: adapterName,\n              endpoint: file,\n            }\n          }\n          return adapterGuesser(file, index, adapterHint)\n        }\n      },\n    )\n  }\n}\n","import { AdapterType } from '@jbrowse/core/pluggableElementTypes'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function SPARQLAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'SPARQLAdapter',\n        displayName: 'SPARQL adapter',\n        configSchema,\n        adapterMetadata: {\n          category: 'Uncommon',\n        },\n        getAdapterClass: () =>\n          import('./SPARQLAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n/**\n * #config BgzipFastaAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst BgzipFastaAdapter = ConfigurationSchema(\n  'BgzipFastaAdapter',\n  {\n    /**\n     * #slot\n     */\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.gz', locationType: 'UriLocation' },\n    },\n    /**\n     * #slot\n     */\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/seq.fa.gz.fai',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    metadataLocation: {\n      description: 'Optional metadata file',\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/fa.metadata.yaml',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    gziLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/seq.fa.gz.gzi',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes yourfile.fa.fai and yourfile.fa.gzi:\n     * ```json\n     * {\n     *   \"type\": \"BgzipFastaAdapter\",\n     *   \"uri\": \"yourfile.fa\"\n     * }\n     * ```\n     */\n\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            fastaLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            faiLocation: {\n              uri: `${snap.uri}.fai`,\n              baseUri: snap.baseUri,\n            },\n            gziLocation: {\n              uri: `${snap.uri}.gzi`,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default BgzipFastaAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config ChromSizesAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst ChromSizesAdapter = ConfigurationSchema(\n  'ChromSizesAdapter',\n  {\n    /**\n     * #slot\n     */\n    chromSizesLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/species.chrom.sizes',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"ChromSizesAdapter\",\n     *   \"uri\": \"yourfile.chrom.sizes\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            chromSizesLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default ChromSizesAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config DivSequenceRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst DivSequenceRenderer = ConfigurationSchema(\n  'DivSequenceRenderer',\n  {\n    /**\n     * #slot\n     */\n    height: {\n      type: 'number',\n      description: 'height in pixels of each line of sequence',\n      defaultValue: 16,\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default DivSequenceRenderer\n","import { lazy } from 'react'\n\nimport FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport { expandRegion } from '@jbrowse/core/pluggableElementTypes/renderers/util'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Region } from '@jbrowse/core/util/types'\n\nclass DivSequenceRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  getExpandedRegion(region: Region) {\n    return expandRegion(region, 3)\n  }\n}\n\nexport default function DivSequenceRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(\n    () =>\n      new DivSequenceRenderer({\n        name: 'DivSequenceRenderer',\n        ReactComponent: lazy(\n          () => import('./components/DivSequenceRendering.tsx'),\n        ),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config IndexedFastaAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst IndexedFastaAdapter = ConfigurationSchema(\n  'IndexedFastaAdapter',\n  {\n    /**\n     * #slot\n     */\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa', locationType: 'UriLocation' },\n    },\n    /**\n     * #slot\n     */\n    faiLocation: {\n      type: 'fileLocation',\n      defaultValue: { uri: '/path/to/seq.fa.fai', locationType: 'UriLocation' },\n    },\n    /**\n     * #slot\n     */\n    metadataLocation: {\n      description: 'Optional metadata file',\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/fa.metadata.yaml',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes yourfile.fa.fai:\n     * ```json\n     * {\n     *   \"type\": \"IndexedFastaAdapter\",\n     *   \"uri\": \"yourfile.fa\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            fastaLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            faiLocation: {\n              uri: `${snap.uri}.fai`,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default IndexedFastaAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport divSequenceRendererConfigSchema from '../DivSequenceRenderer/configSchema.ts'\n\n/**\n * #config LinearReferenceSequenceDisplay\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport const configSchema = ConfigurationSchema(\n  'LinearReferenceSequenceDisplay',\n  {\n    /**\n     * #slot\n     */\n    renderer: divSequenceRendererConfigSchema,\n  },\n  { explicitIdentifier: 'displayId', explicitlyTyped: true },\n)\n","import type { Feature } from '@jbrowse/core/util'\n\nexport function stringifyFASTA({ features }: { features: Feature[] }) {\n  return features\n    .map(feature => {\n      const refName = feature.get('refName')\n      const start = Math.floor(feature.get('start'))\n      const end = Math.floor(feature.get('end'))\n      const seq = feature.get('seq') ?? ''\n      const header = `>${refName}:${start + 1}-${end}`\n      const wrappedSeq = seq.match(/.{1,80}/g)?.join('\\n') ?? ''\n      return `${header}\\n${wrappedSeq}`\n    })\n    .join('\\n')\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config SequenceSearchAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'SequenceSearchAdapter',\n  {\n    /**\n     * #slot\n     */\n    search: {\n      type: 'string',\n      defaultValue: '',\n      description: 'Search string or regex to search for',\n    },\n    /**\n     * #slot\n     */\n    sequenceAdapter: {\n      type: 'frozen',\n      defaultValue: null,\n    },\n    /**\n     * #slot\n     */\n    searchForward: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    searchReverse: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n    /**\n     * #slot\n     */\n    caseInsensitive: {\n      type: 'boolean',\n      defaultValue: true,\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config TwoBitAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst TwoBitAdapter = ConfigurationSchema(\n  'TwoBitAdapter',\n  {\n    /**\n     * #slot\n     */\n    twoBitLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.2bit',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    chromSizesLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/default.chrom.sizes',\n        locationType: 'UriLocation',\n      },\n      description:\n        'An optional chrom.sizes file can be supplied to speed up loading since parsing the twobit file can take time',\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config (note that adding chromSizes improves speed, otherwise has to read a lot of the twobit file to calculate chromosome names and sizes):\n     *\n     * ```json\n     * {\n     *   \"type\": \"TwoBitAdapter\",\n     *   \"uri\": \"yourfile.2bit\"\n     *   \"chromSizes\":\"yourfile.chrom.sizes\"\n     * }\n     *\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            twoBitLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            ...(snap.chromSizes\n              ? {\n                  chromSizesLocation: {\n                    uri: snap.chromSizes,\n                    baseUri: snap.baseUri,\n                  },\n                }\n              : {}),\n          }\n        : snap\n    },\n  },\n)\n\nexport default TwoBitAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config UnindexedFastaAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst UnindexedFastaAdapter = ConfigurationSchema(\n  'UnindexedFastaAdapter',\n  {\n    /**\n     * #slot\n     */\n    rewriteRefNames: {\n      type: 'string',\n      defaultValue: '',\n      contextVariable: ['refName'],\n    },\n    /**\n     * #slot\n     */\n    fastaLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/seq.fa',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    metadataLocation: {\n      description: 'Optional metadata file',\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/fa.metadata.yaml',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"UnindexedFastaAdapter\",\n     *   \"uri\": \"yourfile.fa\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            fastaLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\nexport default UnindexedFastaAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport BgzipFastaAdapterF from './BgzipFastaAdapter/index.ts'\nimport ChromSizesAdapterF from './ChromSizesAdapter/index.ts'\nimport DivSequenceRendererF from './DivSequenceRenderer/index.ts'\nimport IndexedFastaAdapterF from './IndexedFastaAdapter/index.ts'\nimport LinearReferenceSequenceDisplayF from './LinearReferenceSequenceDisplay/index.ts'\nimport ReferenceSequenceTrackF from './ReferenceSequenceTrack/index.ts'\nimport SequenceSearchAdapterF from './SequenceSearchAdapter/index.ts'\nimport TwoBitAdapterF from './TwoBitAdapter/index.ts'\nimport UnindexedFastaAdapterF from './UnindexedFastaAdapter/index.ts'\nimport createExtensionPoints from './createExtensionPoints.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class SequencePlugin extends Plugin {\n  name = 'SequencePlugin'\n\n  install(pluginManager: PluginManager) {\n    DivSequenceRendererF(pluginManager)\n    TwoBitAdapterF(pluginManager)\n    BgzipFastaAdapterF(pluginManager)\n    ChromSizesAdapterF(pluginManager)\n    IndexedFastaAdapterF(pluginManager)\n    UnindexedFastaAdapterF(pluginManager)\n    SequenceSearchAdapterF(pluginManager)\n    ReferenceSequenceTrackF(pluginManager)\n    LinearReferenceSequenceDisplayF(pluginManager)\n    createExtensionPoints(pluginManager)\n  }\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function TwoBitAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'TwoBitAdapter',\n        displayName: 'TwoBit adapter',\n        configSchema,\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n        getAdapterClass: () =>\n          import('./TwoBitAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function BgzipFastaAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'BgzipFastaAdapter',\n      displayName: 'Bgzip-indexed FASTA adapter',\n      configSchema,\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n      getAdapterClass: () =>\n        import('./BgzipFastaAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function ChromSizesAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'ChromSizesAdapter',\n        displayName: 'Chrom sizes adapter',\n        configSchema,\n        adapterMetadata: {\n          hiddenFromGUI: true,\n        },\n        getAdapterClass: () =>\n          import('./ChromSizesAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function IndexedFastaAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'IndexedFastaAdapter',\n      displayName: 'Indexed FASTA adapter',\n      configSchema,\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n\n      getAdapterClass: () =>\n        import('./IndexedFastaAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function UnindexedFastaAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'UnindexedFastaAdapter',\n      displayName: 'Unindexed FASTA adapter',\n      configSchema,\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n      getAdapterClass: () =>\n        import('./UnindexedFastaAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function SequenceSearchAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(() => {\n    return new AdapterType({\n      name: 'SequenceSearchAdapter',\n      displayName: 'Sequence search adapter',\n      adapterMetadata: {\n        hiddenFromGUI: true,\n      },\n      configSchema,\n      getAdapterClass: () =>\n        import('./SequenceSearchAdapter.ts').then(r => r.default),\n    })\n  })\n}\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport { createReferenceSeqTrackConfig } from './configSchema.ts'\nimport { stringifyFASTA } from '../saveTrackFormats/fasta.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function ReferenceSequenceTrackF(pluginManager: PluginManager) {\n  pluginManager.addTrackType(() => {\n    const configSchema = createReferenceSeqTrackConfig(pluginManager)\n\n    return new TrackType({\n      name: 'ReferenceSequenceTrack',\n      displayName: 'Reference sequence track',\n      configSchema,\n      stateModel: createBaseTrackModel(\n        pluginManager,\n        'ReferenceSequenceTrack',\n        configSchema,\n      ).views(() => ({\n        saveTrackFileFormatOptions() {\n          return {\n            fasta: {\n              name: 'FASTA',\n              extension: 'fa',\n              callback: stringifyFASTA,\n            },\n          }\n        },\n      })),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n// Note: this is primarily a copy of createBaseTrackConfig, except with a\n// subset of the config slots, to avoid including fields that don't make sense\n// for the ReferenceSequenceTrack\n\n/**\n * #config ReferenceSequenceTrack\n * used to display base level DNA sequence tracks\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport function createReferenceSeqTrackConfig(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'ReferenceSequenceTrack',\n    {\n      /**\n       * #slot\n       * configuration for track adapter\n       */\n      adapter: pluginManager.pluggableConfigSchemaType('adapter'),\n\n      /**\n       * #slot\n       * configuration for the displays e.g. LinearReferenceSequenceDisplay\n       */\n      displays: types.array(pluginManager.pluggableConfigSchemaType('display')),\n\n      /**\n       * #slot\n       */\n      name: {\n        type: 'string',\n        description:\n          'optional track name, otherwise uses the \"Reference sequence (assemblyName)\"',\n        defaultValue: '',\n      },\n\n      /**\n       * #slot\n       */\n      sequenceType: {\n        type: 'string',\n        description: 'either dna or pep',\n        defaultValue: 'dna',\n      },\n\n      /**\n       * #slot\n       */\n      description: {\n        description: 'a description of the track',\n        type: 'string',\n        defaultValue: '',\n      },\n\n      /**\n       * #slot\n       */\n      metadata: {\n        type: 'frozen',\n        description: 'anything to add about this track',\n        defaultValue: {},\n      },\n\n      formatAbout: ConfigurationSchema('FormatAbout', {\n        /**\n         * #slot formatAbout.config\n         */\n        config: {\n          type: 'frozen',\n          description: 'formats configuration in about dialog',\n          defaultValue: {},\n          contextVariable: ['config'],\n        },\n\n        /**\n         * #slot formatAbout.hideUris\n         */\n        hideUris: {\n          type: 'boolean',\n          defaultValue: false,\n        },\n      }),\n    },\n    {\n      preProcessSnapshot: s => {\n        const snap = JSON.parse(JSON.stringify(s))\n        const displayTypes = new Set()\n        const { displays = [] } = snap\n        if (snap.trackId !== 'placeholderId') {\n          // Gets the displays on the track snapshot and the possible displays\n          // from the track type and adds any missing possible displays to the\n          // snapshot\n          for (const d of displays) {\n            if (d) {\n              displayTypes.add(d.type)\n            }\n          }\n          const trackType = pluginManager.getTrackType(snap.type)\n          for (const displayType of trackType?.displayTypes || []) {\n            if (!displayTypes.has(displayType.name)) {\n              displays.push({\n                displayId: `${snap.trackId}-${displayType.name}`,\n                type: displayType.name,\n              })\n            }\n          }\n        }\n        return { ...snap, displays }\n      },\n      /**\n       * #identifier\n       * all tracks have a globally unique 'trackId'\n       */\n      explicitIdentifier: 'trackId',\n      explicitlyTyped: true,\n      actions: (self: any) => ({\n        addDisplayConf(displayConf: { type: string; displayId: string }) {\n          const { type } = displayConf\n          if (!type) {\n            throw new Error(`unknown display type ${type}`)\n          }\n          const display = self.displays.find(\n            (d: any) => d?.displayId === displayConf.displayId,\n          )\n          if (display) {\n            return display\n          }\n          const length = self.displays.push(displayConf)\n          return self.displays[length - 1]\n        },\n      }),\n    },\n  )\n}\n","import { DisplayType } from '@jbrowse/core/pluggableElementTypes'\nimport { BaseLinearDisplayComponent } from '@jbrowse/plugin-linear-genome-view'\n\nimport { configSchema } from './configSchema.ts'\nimport { modelFactory } from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearReferenceSequenceDisplayF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addDisplayType(() => {\n    const stateModel = modelFactory(configSchema)\n    return new DisplayType({\n      name: 'LinearReferenceSequenceDisplay',\n      configSchema,\n      stateModel,\n      displayName: 'Reference sequence display',\n      trackType: 'ReferenceSequenceTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: BaseLinearDisplayComponent,\n    })\n  })\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { getContainingTrack, getContainingView } from '@jbrowse/core/util'\nimport { getParentRenderProps } from '@jbrowse/core/util/tracks'\nimport { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport { BaseLinearDisplay } from '@jbrowse/plugin-linear-genome-view'\nimport { autorun } from 'mobx'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\ntype LGV = LinearGenomeViewModel\n\n/**\n * #stateModel LinearReferenceSequenceDisplay\n * base model `BaseLinearDisplay`\n */\nexport function modelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'LinearReferenceSequenceDisplay',\n      BaseLinearDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearReferenceSequenceDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n        /**\n         * #property\n         */\n        showForward: true,\n        /**\n         * #property\n         */\n        showReverse: true,\n        /**\n         * #property\n         */\n        showTranslation: true,\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #property\n       */\n      rowHeight: 15,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get sequenceType() {\n        return getConf(getContainingTrack(self), 'sequenceType')\n      },\n\n      /**\n       * #getter\n       * showReverse setting, it is NOT disabled for non-dna sequences\n       */\n      get showForwardActual() {\n        return self.showForward\n      },\n\n      /**\n       * #getter\n       * showReverse setting, is disabled for non-dna sequences\n       */\n      get showReverseActual() {\n        return this.sequenceType === 'dna' ? self.showReverse : false\n      },\n\n      /**\n       * #getter\n       * showTranslation setting is disabled for non-dna sequences\n       */\n      get showTranslationActual() {\n        return this.sequenceType === 'dna' ? self.showTranslation : false\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get sequenceHeight() {\n        const {\n          rowHeight,\n          showTranslationActual,\n          showReverseActual,\n          showForwardActual,\n        } = self\n        const r1 =\n          showReverseActual && showTranslationActual ? rowHeight * 3 : 0\n        const r2 =\n          showForwardActual && showTranslationActual ? rowHeight * 3 : 0\n        const t = r1 + r2\n        const r = showReverseActual ? rowHeight : 0\n        const s = showForwardActual ? rowHeight : 0\n        return t + r + s\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n      return {\n        /**\n         * #method\n         */\n        renderProps() {\n          const {\n            rpcDriverName,\n            showForwardActual,\n            showReverseActual,\n            showTranslationActual,\n            rowHeight,\n            sequenceHeight,\n            sequenceType,\n          } = self\n          return {\n            ...superRenderProps(),\n            ...getParentRenderProps(self),\n            config: self.configuration.renderer,\n            rpcDriverName,\n            showForward: showForwardActual,\n            showReverse: showReverseActual,\n            showTranslation: showTranslationActual,\n            sequenceType,\n            rowHeight,\n            sequenceHeight,\n          }\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #method\n       */\n      regionCannotBeRendered(/* region */) {\n        const view = getContainingView(self) as LGV\n        return view.bpPerPx > 3 ? 'Zoom in to see sequence' : undefined\n      },\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return self.configuration.renderer.type\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      toggleShowForward() {\n        self.showForward = !self.showForward\n      },\n      /**\n       * #action\n       */\n      toggleShowReverse() {\n        self.showReverse = !self.showReverse\n      },\n      /**\n       * #action\n       */\n      toggleShowTranslation() {\n        self.showTranslation = !self.showTranslation\n      },\n      afterAttach() {\n        addDisposer(\n          self,\n          autorun(\n            function sequenceHeightAutorun() {\n              const view = getContainingView(self) as LGV\n              if (view.bpPerPx > 3) {\n                self.setHeight(50)\n              } else {\n                self.setHeight(self.sequenceHeight)\n              }\n            },\n            { name: 'SequenceHeight' },\n          ),\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      trackMenuItems() {\n        return [\n          ...(self.sequenceType === 'dna'\n            ? [\n                {\n                  label: 'Show forward',\n                  type: 'checkbox',\n                  checked: self.showForward,\n                  onClick: () => {\n                    self.toggleShowForward()\n                  },\n                },\n                {\n                  label: 'Show reverse',\n                  type: 'checkbox',\n                  checked: self.showReverse,\n                  onClick: () => {\n                    self.toggleShowReverse()\n                  },\n                },\n                {\n                  label: 'Show translation',\n                  type: 'checkbox',\n                  checked: self.showTranslation,\n                  onClick: () => {\n                    self.toggleShowTranslation()\n                  },\n                },\n              ]\n            : []),\n        ]\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { showForward, showReverse, showTranslation, ...rest } =\n        snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(!showForward ? { showForward } : {}),\n        ...(!showReverse ? { showReverse } : {}),\n        ...(!showTranslation ? { showTranslation } : {}),\n      } as typeof snap\n    })\n}\n","import { getFileName, makeIndex } from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function ExtensionPointsF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const regexGuess = /\\.2bit$/i\n        const adapterName = 'TwoBitAdapter'\n        const fileName = getFileName(file)\n        const obj = {\n          type: adapterName,\n          twoBitLocation: file,\n        }\n        if (regexGuess.test(fileName) && !adapterHint) {\n          return obj\n        }\n        if (adapterHint === adapterName) {\n          return obj\n        }\n        return adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        if (adapterName === 'TwoBitAdapter') {\n          return 'ReferenceSequenceTrack'\n        }\n        return trackTypeGuesser(adapterName)\n      }\n    },\n  )\n\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const regexGuess = /\\.(fa|fasta|fas|fna|mfa)$/i\n        const adapterName = 'IndexedFastaAdapter'\n        const fileName = getFileName(file)\n        const obj = {\n          type: adapterName,\n          fastaLocation: file,\n          faiLocation: index || makeIndex(file, '.fai'),\n        }\n\n        if (regexGuess.test(fileName) && !adapterHint) {\n          return obj\n        }\n        if (adapterHint === adapterName) {\n          return obj\n        }\n        return adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        if (adapterName === 'IndexedFastaAdapter') {\n          return 'ReferenceSequenceTrack'\n        }\n        return trackTypeGuesser(adapterName)\n      }\n    },\n  )\n\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const regexGuess = /\\.(fa|fasta|fas|fna|mfa)\\.b?gz$/i\n        const adapterName = 'BgzipFastaAdapter'\n        const fileName = getFileName(file)\n        const obj = {\n          type: adapterName,\n          faiLocation: makeIndex(file, '.fai'),\n          gziLocation: makeIndex(file, '.gzi'),\n        }\n\n        if (regexGuess.test(fileName) && !adapterHint) {\n          return obj\n        }\n        if (adapterHint === adapterName) {\n          return obj\n        }\n        return adapterGuesser(file, index, adapterHint)\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        if (adapterName === 'BgzipFastaAdapter') {\n          return 'ReferenceSequenceTrack'\n        }\n        return trackTypeGuesser(adapterName)\n      }\n    },\n  )\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { getEnv, getSession } from '@jbrowse/core/util'\nimport { openLocation } from '@jbrowse/core/util/io'\nimport { getTrackName } from '@jbrowse/core/util/tracks'\nimport { getParent, types } from '@jbrowse/mobx-state-tree'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { FileLocation } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nconst IMPORT_SIZE_LIMIT = 100_000_000\n\nconst fileTypes = ['VCF', 'BED', 'BEDPE', 'STAR-Fusion']\nconst fileTypeParsers = {\n  VCF: () =>\n    import('./importAdapters/VcfImport.ts').then(r => r.parseVcfBuffer),\n  BED: () =>\n    import('./importAdapters/BedImport.ts').then(r => r.parseBedBuffer),\n  BEDPE: () =>\n    import('./importAdapters/BedpeImport.ts').then(r => r.parseBedPEBuffer),\n  'STAR-Fusion': () =>\n    import('./importAdapters/STARFusionImport.ts').then(\n      r => r.parseSTARFusionBuffer,\n    ),\n}\n\nconst adapterTypeMap: Record<\n  string,\n  { fileType: string; locationKey: string }\n> = {\n  VcfAdapter: { fileType: 'VCF', locationKey: 'vcfLocation' },\n  VcfTabixAdapter: { fileType: 'VCF', locationKey: 'vcfGzLocation' },\n  BedAdapter: { fileType: 'BED', locationKey: 'bedLocation' },\n  BedTabixAdapter: { fileType: 'BED', locationKey: 'bedGzLocation' },\n  BedpeAdapter: { fileType: 'BEDPE', locationKey: 'bedpeLocation' },\n}\n\nfunction getAdapterInfo(adapter: Record<string, unknown>) {\n  const entry = adapterTypeMap[adapter.type as string]\n  if (!entry) {\n    return undefined\n  }\n  const loc =\n    (adapter[entry.locationKey] as FileLocation | undefined) ??\n    (adapter as unknown as FileLocation)\n  return { fileType: entry.fileType, loc }\n}\n\n// regexp used to guess the type of a file or URL from its file extension\nconst fileTypesRegexp = new RegExp(\n  String.raw`\\.(${fileTypes.join('|')})(\\.gz)?$`,\n  'i',\n)\n\n/**\n * #stateModel SpreadsheetImportWizard\n * #category view\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function stateModelFactory() {\n  return types\n    .model('SpreadsheetImportWizard', {\n      /**\n       * #property\n       */\n      fileType: types.optional(types.enumeration(fileTypes), 'VCF'),\n      /**\n       * #property\n       */\n      hasColumnNameLine: true,\n      /**\n       * #property\n       */\n      columnNameLineNumber: 1,\n      /**\n       * #property\n       */\n      selectedAssemblyName: types.maybe(types.string),\n\n      /**\n       * #property\n       * used specifically for UriLocation's\n       */\n      cachedFileLocation: types.frozen<FileLocation | undefined>(),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      fileTypes,\n      /**\n       * #volatile\n       */\n      fileSource: undefined as any,\n      /**\n       * #volatile\n       */\n      error: undefined as unknown,\n      /**\n       * #volatile\n       */\n      loading: false,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get isReadyToOpen() {\n        return (\n          self.fileSource &&\n          (self.fileSource.blobId ||\n            self.fileSource.localPath ||\n            self.fileSource.uri)\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get fileName() {\n        return (\n          self.fileSource.uri ||\n          self.fileSource.localPath ||\n          (self.fileSource.blobId && self.fileSource.name)\n        )\n      },\n\n      /**\n       * #getter\n       */\n      get requiresUnzip() {\n        return this.fileName.endsWith('gz')\n      },\n\n      /**\n       * #method\n       */\n      isValidRefName(refName: string, assemblyName?: string) {\n        const { assemblyManager } = getSession(self)\n        return !assemblyName\n          ? false\n          : assemblyManager.isValidRefName(refName, assemblyName)\n      },\n\n      /**\n       * #method\n       */\n      tracksForAssembly(selectedAssembly: string) {\n        const session = getSession(self)\n        const { tracks, sessionTracks = [] } = session\n        const allTracks = [\n          ...tracks,\n          ...sessionTracks,\n        ] as AnyConfigurationModel[]\n        return allTracks\n          .flatMap(track => {\n            const assemblyNames = readConfObject(track, 'assemblyNames') ?? []\n            if (!assemblyNames.includes(selectedAssembly)) {\n              return []\n            }\n            const adapter = readConfObject(track, 'adapter')\n            const info = getAdapterInfo(adapter)\n            if (!info) {\n              return []\n            }\n            const category = readConfObject(track, 'category') ?? []\n            const categoryStr = category.join(',')\n            return {\n              track,\n              label: [\n                categoryStr ? `[${categoryStr}]` : '',\n                getTrackName(track, session),\n              ]\n                .filter(f => !!f)\n                .join(' '),\n              assemblyNames,\n              type: info.fileType,\n              loc: info.loc,\n            }\n          })\n          .sort((a, b) => a.label.localeCompare(b.label))\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setSelectedAssemblyName(s: string) {\n        self.selectedAssemblyName = s\n      },\n      /**\n       * #action\n       */\n      setFileSource(newSource: unknown) {\n        self.fileSource = newSource\n        self.error = undefined\n\n        if (self.fileSource) {\n          // try to autodetect the file type, ignore errors\n          const name = self.fileName\n\n          if (name) {\n            const firstMatch = fileTypesRegexp.exec(name)?.[1]\n            if (firstMatch) {\n              self.fileType =\n                firstMatch === 'tsv' && name.includes('star-fusion')\n                  ? 'STAR-Fusion'\n                  : firstMatch.toUpperCase()\n            }\n          }\n        }\n      },\n\n      /**\n       * #action\n       */\n      setColumnNameLineNumber(newnumber: number) {\n        if (newnumber > 0) {\n          self.columnNameLineNumber = newnumber\n        }\n      },\n\n      /**\n       * #action\n       */\n      setFileType(typeName: string) {\n        self.fileType = typeName\n      },\n\n      /**\n       * #action\n       */\n      setError(error: unknown) {\n        self.error = error\n      },\n\n      /**\n       * #action\n       */\n      setLoading(arg: boolean) {\n        self.loading = arg\n      },\n\n      /**\n       * #action\n       */\n      cancelButton() {\n        self.error = undefined\n        getParent<any>(self).setDisplayMode()\n      },\n      /**\n       * #action\n       */\n      setCachedFileHandle(arg: FileLocation) {\n        self.cachedFileLocation = arg\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       * fetch and parse the file, make a new Spreadsheet model for it, then set\n       * the parent to display it\n       */\n      async import(assemblyName: string) {\n        if (!self.fileSource) {\n          return\n        }\n\n        self.selectedAssemblyName = assemblyName\n        const type = self.fileType as keyof typeof fileTypeParsers\n        const typeParser = await fileTypeParsers[type]()\n\n        const { fetchAndMaybeUnzip } = await import('@jbrowse/core/util')\n        const { pluginManager } = getEnv(self)\n        const filehandle = openLocation(self.fileSource, pluginManager)\n        self.setLoading(true)\n        try {\n          const stat = await filehandle.stat()\n          if (stat.size > IMPORT_SIZE_LIMIT) {\n            self.setError(\n              `File is too big. Tabular files are limited to at most ${(\n                IMPORT_SIZE_LIMIT / 1000\n              ).toLocaleString()}kb.`,\n            )\n            return\n          }\n        } catch (e) {\n          // not required for stat to succeed to proceed, but it is helpful\n          console.warn(e)\n        } finally {\n          self.setLoading(false)\n        }\n\n        self.setLoading(true)\n        try {\n          if (self.fileSource.uri) {\n            self.setCachedFileHandle({\n              uri: self.fileSource.uri,\n              baseUri: self.fileSource.baseUri,\n              locationType: 'UriLocation',\n            })\n          }\n          const data = await fetchAndMaybeUnzip(filehandle)\n          getParent<any>(self).displaySpreadsheet({\n            ...typeParser(data),\n            assemblyName,\n          })\n        } catch (e) {\n          console.error(e)\n          self.setError(e)\n        } finally {\n          self.setLoading(false)\n        }\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // just a one-time thing on load\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            if (self.cachedFileLocation && self.selectedAssemblyName) {\n              self.setFileSource(self.cachedFileLocation)\n              await self.import(self.selectedAssemblyName)\n            }\n          } catch (e) {\n            console.error(e)\n            getSession(self).notifyError(`${e}`, e)\n          }\n        })()\n      },\n    }))\n}\nexport type ImportWizardStateModel = ReturnType<typeof stateModelFactory>\nexport type ImportWizardModel = Instance<ImportWizardStateModel>\n","import type { AbstractSessionModel } from '@jbrowse/core/util'\nimport type { LinearGenomeViewModel } from '@jbrowse/plugin-linear-genome-view'\n\nexport function locationLinkClick({\n  assemblyName,\n  session,\n  locString,\n  spreadsheetViewId,\n}: {\n  assemblyName: string\n  session: AbstractSessionModel\n  locString: string\n  spreadsheetViewId: string\n}) {\n  const newViewId = `${spreadsheetViewId}_${assemblyName}`\n  let view = session.views.find(v => v.id === newViewId) as\n    | LinearGenomeViewModel\n    | undefined\n  if (!view) {\n    view = session.addView('LinearGenomeView', {\n      id: newViewId,\n    }) as LinearGenomeViewModel\n  }\n  return view.navToLocString(locString, assemblyName)\n}\n","import { lazy } from 'react'\n\nimport CascadingMenuButton from '@jbrowse/core/ui/CascadingMenuButton'\nimport { SimpleFeature, assembleLocStringFast } from '@jbrowse/core/util'\nimport ArrowDropDownIcon from '@mui/icons-material/ArrowDropDown'\n\nimport { locationLinkClick } from '../util.ts'\n\nimport type {\n  AbstractSessionModel,\n  SimpleFeatureSerialized,\n} from '@jbrowse/core/util'\n\nconst BreakpointSplitViewChoiceDialog = lazy(\n  () => import('./BreakpointSplitViewChoiceDialog.tsx'),\n)\n\nexport default function FeatureMenu({\n  assemblyName,\n  session,\n  spreadsheetViewId,\n  feature,\n}: {\n  spreadsheetViewId: string\n  assemblyName: string\n  session: AbstractSessionModel\n  feature: SimpleFeatureSerialized\n}) {\n  return (\n    <CascadingMenuButton\n      menuItems={[\n        {\n          label: 'Open in linear genome view',\n          onClick: async () => {\n            try {\n              await locationLinkClick({\n                spreadsheetViewId,\n                assemblyName,\n                session,\n                locString: assembleLocStringFast(feature),\n              })\n            } catch (e) {\n              console.error(e)\n              session.notifyError(`${e}`, e)\n            }\n          },\n        },\n        {\n          label: 'Open in breakpoint split view',\n          onClick: () => {\n            session.queueDialog(handleClose => [\n              BreakpointSplitViewChoiceDialog,\n              {\n                handleClose,\n                session,\n                stableViewId: `${spreadsheetViewId}_${assemblyName}_breakpointsplitview`,\n                feature: new SimpleFeature(feature),\n                assemblyName,\n              },\n            ])\n          },\n        },\n      ]}\n    >\n      <ArrowDropDownIcon />\n    </CascadingMenuButton>\n  )\n}\n","import { assembleLocString, getSession } from '@jbrowse/core/util'\nimport { getParent } from '@jbrowse/mobx-state-tree'\nimport { Link } from '@mui/material'\n\nimport { locationLinkClick } from '../util.ts'\nimport FeatureMenu from './FeatureMenu.tsx'\n\nimport type { SimpleFeatureSerialized } from '@jbrowse/core/util'\n\nexport default function LocationCell({\n  model,\n  feature,\n}: {\n  model: { assemblyName?: string }\n  feature: SimpleFeatureSerialized\n}) {\n  return (\n    <>\n      <FeatureMenu\n        session={getSession(model)}\n        spreadsheetViewId={getParent<any>(model).id}\n        assemblyName={model.assemblyName!}\n        feature={feature}\n      />\n      <Link\n        href=\"#\"\n        onClick={async event => {\n          try {\n            event.preventDefault()\n            await locationLinkClick({\n              spreadsheetViewId: getParent<any>(model).id,\n              session: getSession(model),\n              locString: assembleLocString(feature),\n              assemblyName: model.assemblyName!,\n            })\n          } catch (e) {\n            console.error(e)\n            getSession(model).notifyError(`${e}`, e)\n          }\n        }}\n      >\n        {assembleLocString(feature)}\n      </Link>\n    </>\n  )\n}\n","import { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getSession } from '@jbrowse/core/util'\nimport { addDisposer, cast, types } from '@jbrowse/mobx-state-tree'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport { autorun } from 'mobx'\n\nimport ImportWizard from './ImportWizard.ts'\nimport Spreadsheet from './SpreadsheetModel.tsx'\n\nimport type { SpreadsheetModel } from './SpreadsheetModel.tsx'\nimport type { MenuItem } from '@jbrowse/core/ui'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport interface SpreadsheetViewInit {\n  assembly: string\n  uri: string\n  fileType?: string\n}\n\nconst minHeight = 40\nconst defaultHeight = 440\n\n/**\n * #stateModel SpreadsheetView\n * #category view\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function stateModelFactory() {\n  const ImportWizardModel = ImportWizard()\n  return types\n    .compose(\n      BaseViewModel,\n      types\n        .model('SpreadsheetView', {\n          /**\n           * #property\n           */\n          type: types.literal('SpreadsheetView'),\n          /**\n           * #property\n           */\n          offsetPx: 0,\n          /**\n           * #property\n           */\n          height: types.optional(types.number, defaultHeight),\n          /**\n           * #property\n           */\n          hideVerticalResizeHandle: false,\n          /**\n           * #property\n           */\n          hideFilterControls: false,\n\n          /**\n           * #property\n           */\n          importWizard: types.optional(ImportWizardModel, () =>\n            ImportWizardModel.create(),\n          ),\n          /**\n           * #property\n           */\n          spreadsheet: types.maybe(Spreadsheet()),\n          /**\n           * #property\n           * used for initializing the view from a session snapshot\n           */\n          init: types.frozen<SpreadsheetViewInit | undefined>(),\n        })\n        .volatile(() => ({\n          /**\n           * #volatile\n           */\n          width: 400,\n          /**\n           * #volatile\n           */\n          rowMenuItems: [] as MenuItem[],\n        }))\n        .views(self => ({\n          /**\n           * #getter\n           */\n          get assembly() {\n            const name = self.spreadsheet?.assemblyName\n            return name\n              ? getSession(self).assemblyManager.get(name)?.configuration\n              : undefined\n          },\n        }))\n        .actions(self => ({\n          /**\n           * #action\n           */\n          setRowMenuItems(newItems: MenuItem[]) {\n            self.rowMenuItems = newItems\n          },\n          /**\n           * #action\n           */\n          setWidth(newWidth: number) {\n            self.width = newWidth\n            return self.width\n          },\n          /**\n           * #action\n           */\n          setHeight(newHeight: number) {\n            self.height = Math.max(newHeight, minHeight)\n            return self.height\n          },\n          /**\n           * #action\n           */\n          resizeHeight(distance: number) {\n            const oldHeight = self.height\n            const newHeight = this.setHeight(self.height + distance)\n            return newHeight - oldHeight\n          },\n          /**\n           * #action\n           */\n          resizeWidth(distance: number) {\n            const oldWidth = self.width\n            const newWidth = this.setWidth(self.width + distance)\n            return newWidth - oldWidth\n          },\n\n          /**\n           * #action\n           * load a new spreadsheet and set our mode to display it\n           */\n          displaySpreadsheet(spreadsheet?: SpreadsheetModel) {\n            self.spreadsheet = cast(spreadsheet)\n          },\n\n          /**\n           * #action\n           */\n          setInit(init?: SpreadsheetViewInit) {\n            self.init = init\n          },\n        }))\n        .actions(self => ({\n          afterAttach() {\n            addDisposer(\n              self,\n              autorun(\n                async function spreadsheetViewInitAutorun() {\n                  const { init, width } = self\n                  if (!width || !init) {\n                    return\n                  }\n\n                  const session = getSession(self)\n\n                  try {\n                    const exts = init.uri.split('.')\n                    let ext = exts.pop()?.toUpperCase()\n                    if (ext === 'GZ') {\n                      ext = exts.pop()?.toUpperCase()\n                    }\n\n                    self.importWizard.setFileType(init.fileType || ext || '')\n                    self.importWizard.setSelectedAssemblyName(init.assembly)\n                    self.importWizard.setFileSource({\n                      uri: init.uri,\n                      locationType: 'UriLocation',\n                    })\n                    await self.importWizard.import(init.assembly)\n                  } catch (e) {\n                    console.error(e)\n                    session.notifyError(`${e}`, e)\n                  } finally {\n                    self.setInit(undefined)\n                  }\n                },\n                { name: 'SpreadsheetViewInit' },\n              ),\n            )\n          },\n        }))\n        .views(self => ({\n          /**\n           * #method\n           */\n          menuItems() {\n            return [\n              {\n                label: 'Return to import form',\n                icon: FolderOpenIcon,\n                onClick: () => {\n                  self.displaySpreadsheet(undefined)\n                },\n              },\n            ]\n          },\n        })),\n    )\n    .postProcessSnapshot(snap => {\n      const { init, importWizard, spreadsheet, ...rest } = snap as Omit<\n        typeof snap,\n        symbol\n      >\n      if (importWizard.cachedFileLocation && spreadsheet) {\n        // don't serialize spreadsheet rows if we have the importForm\n        // xref for Omit https://github.com/mobxjs/mobx-state-tree/issues/1524\n        const { rowSet, ...spreadsheetRest } = spreadsheet as Omit<\n          typeof spreadsheet,\n          symbol\n        >\n\n        return {\n          ...rest,\n          importWizard,\n          spreadsheet: spreadsheetRest,\n        }\n      } else if (spreadsheet) {\n        // don't serialize spreadsheet rows if we have the importForm\n        const { rowSet, ...spreadsheetRest } = spreadsheet as Omit<\n          typeof spreadsheet,\n          symbol\n        >\n        // check stringified length of rows if it is a localfile or similar.\n        // try not to exceed localstorage limits\n        return rowSet && JSON.stringify(rowSet).length > 1_000_000\n          ? {\n              ...rest,\n              importWizard,\n              spreadsheet: spreadsheetRest,\n            }\n          : { ...rest, importWizard, spreadsheet }\n      }\n      return { ...rest, importWizard }\n    })\n}\n\nexport type SpreadsheetViewStateModel = ReturnType<typeof stateModelFactory>\nexport type SpreadsheetViewModel = Instance<SpreadsheetViewStateModel>\n","import {\n  assembleLocStringFast,\n  getSession,\n  measureGridWidth,\n  toLocale,\n} from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport LocationCell from './components/LocationCell.tsx'\n\nimport type { SimpleFeatureSerialized } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { GridColDef } from '@mui/x-data-grid'\n\nexport interface Row {\n  // optional feature per-row\n  feature?: SimpleFeatureSerialized\n\n  // new style: object with key->name values\n  cellData?: Record<string, unknown>\n\n  // old style: array of cells\n  cells?: {\n    text: unknown\n  }[]\n}\n\nexport interface RowSet {\n  rows: Row[]\n}\n\n/**\n * #stateModel SpreadsheetViewSpreadsheet\n * #category view\n */\nexport default function stateModelFactory() {\n  return types\n    .model('Spreadsheet', {\n      /**\n       * #property\n       */\n      rowSet: types.frozen<RowSet | undefined>(),\n      /**\n       * #property\n       */\n      columns: types.frozen<{ name: string }[]>(),\n      /**\n       * #property\n       */\n      assemblyName: types.maybe(types.string),\n      /**\n       * #property\n       */\n      visibleColumns: types.frozen<Record<string, boolean>>(),\n    })\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      visibleRowFlags: undefined as Record<number, boolean> | undefined,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get rows() {\n        return self.rowSet?.rows.map((row, i) => ({\n          id: i,\n          feature: row.feature,\n          ...Object.fromEntries(\n            self.columns.map((c, idx) => [\n              c.name,\n              row.cellData?.[c.name] ?? row.cells?.[idx]?.text,\n            ]),\n          ),\n        }))\n      },\n\n      /**\n       * #getter\n       */\n      get initialized() {\n        const session = getSession(self)\n        const name = self.assemblyName\n        return (\n          self.rowSet &&\n          (name ? session.assemblyManager.get(name)?.initialized : false)\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get dataGridColumns() {\n        const { rows } = self\n        return rows\n          ? [\n              {\n                field: 'Location',\n                width:\n                  measureGridWidth(\n                    rows.map(row =>\n                      row.feature ? assembleLocStringFast(row.feature) : 0,\n                    ),\n                  ) + 40,\n                renderCell: ({ row }) => {\n                  const { feature } = row\n                  return feature ? (\n                    <LocationCell model={self} feature={feature} />\n                  ) : (\n                    'N/A'\n                  )\n                },\n              } satisfies GridColDef,\n              {\n                field: 'Length',\n                type: 'number',\n                width: measureGridWidth(\n                  rows.map(row => {\n                    const { feature } = row\n                    return feature ? feature.end - feature.start : 0\n                  }),\n                ),\n                valueGetter: (\n                  _val: unknown,\n                  row: { feature?: SimpleFeatureSerialized },\n                ) => {\n                  const { feature } = row\n                  return feature ? feature.end - feature.start : undefined\n                },\n                valueFormatter: arg => toLocale(arg),\n              } satisfies GridColDef,\n\n              ...self.columns.map(\n                f =>\n                  ({\n                    field: f.name,\n                    width: measureGridWidth(\n                      // @ts-expect-error\n                      [...rows.map(r => r[f.name]), f.name],\n                      { minWidth: 20 },\n                    ),\n                    type:\n                      // @ts-expect-error\n                      typeof rows[0][f.name] === 'number'\n                        ? 'number'\n                        : undefined,\n                  }) satisfies GridColDef,\n              ),\n            ]\n          : undefined\n      },\n    }))\n    .views(self => ({\n      get visibleRows() {\n        const { visibleRowFlags } = self\n        return visibleRowFlags\n          ? self.rows?.filter((_f, idx) => visibleRowFlags[idx] !== false)\n          : self.rows\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setVisibleRows(arg?: Record<number, boolean>) {\n        self.visibleRowFlags = arg\n      },\n      /**\n       * #action\n       */\n      setVisibleColumns(arg: Record<string, boolean>) {\n        self.visibleColumns = arg\n      },\n    }))\n    .preProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      return snap\n        ? {\n            ...snap,\n            // @ts-expect-error no longer support derived columns\n            columns: snap.columns.filter(f => !f.isDerived),\n            rowSet: snap.rowSet\n              ? {\n                  ...snap.rowSet,\n                  rows: snap.rowSet.rows.map(r => ({\n                    ...r,\n                    feature:\n                      r.feature ??\n                      // @ts-expect-error\n                      (r.extendedData?.vcfFeature as SimpleFeatureSerialized),\n                  })),\n                }\n              : undefined,\n          }\n        : snap\n    })\n}\n\nexport type SpreadsheetStateModel = ReturnType<typeof stateModelFactory>\nexport type SpreadsheetModel = Instance<SpreadsheetStateModel>\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util'\nimport ViewComfyIcon from '@mui/icons-material/ViewComfy'\n\nimport LaunchSpreadsheetViewF from './LaunchSpreadsheetView/index.ts'\nimport SpreadsheetViewF from './SpreadsheetView/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default class SpreadsheetViewPlugin extends Plugin {\n  name = 'SpreadsheetViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    SpreadsheetViewF(pluginManager)\n    LaunchSpreadsheetViewF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    const { rootModel } = pluginManager\n    if (isAbstractMenuManager(rootModel)) {\n      rootModel.appendToSubMenu(['Add'], {\n        label: 'Spreadsheet view',\n        icon: ViewComfyIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('SpreadsheetView', {})\n        },\n      })\n    }\n  }\n}\n\nexport {\n  type SpreadsheetViewModel,\n  type SpreadsheetViewStateModel,\n} from './SpreadsheetView/index.ts'\n","import { lazy } from 'react'\n\nimport { ViewType } from '@jbrowse/core/pluggableElementTypes'\n\nimport stateModelFactory from './SpreadsheetViewModel.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function SpreadsheetViewF(pluginManager: PluginManager) {\n  pluginManager.addViewType(() => {\n    return new ViewType({\n      name: 'SpreadsheetView',\n      displayName: 'Spreadsheet view',\n      stateModel: stateModelFactory(),\n      ReactComponent: lazy(() => import('./components/SpreadsheetView.tsx')),\n    })\n  })\n}\n\nexport type {\n  SpreadsheetViewModel,\n  SpreadsheetViewStateModel,\n} from './SpreadsheetViewModel.ts'\n","import type { SpreadsheetViewModel } from '../SpreadsheetView/index.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default function LaunchSpreadsheetViewF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-SpreadsheetView',\n    // @ts-expect-error\n    async ({\n      session,\n      assembly,\n      uri,\n      fileType,\n    }: {\n      session: AbstractSessionModel\n      assembly: string\n      uri: string\n      fileType?: string\n    }) => {\n      // Use the init property to let the model handle initialization\n      session.addView('SpreadsheetView', {\n        init: {\n          assembly,\n          uri,\n          fileType,\n        },\n      }) as SpreadsheetViewModel\n    },\n  )\n}\n","import { readConfObject } from '@jbrowse/core/configuration'\nimport { BaseViewModel } from '@jbrowse/core/pluggableElementTypes/models'\nimport { getSession } from '@jbrowse/core/util'\nimport { ElementId } from '@jbrowse/core/util/types/mst'\nimport { addDisposer, types } from '@jbrowse/mobx-state-tree'\nimport FolderOpenIcon from '@mui/icons-material/FolderOpen'\nimport { autorun, reaction } from 'mobx'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Region } from '@jbrowse/core/util'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { CircularViewStateModel } from '@jbrowse/plugin-circular-view'\nimport type { SpreadsheetViewStateModel } from '@jbrowse/plugin-spreadsheet-view'\n\ninterface SvInspectorViewInit {\n  assembly: string\n  uri: string\n  fileType?: string\n}\n\n/**\n * #stateModel SvInspectorView\n * #category view\n * does not extend, but is a combination of a\n * - [SpreadsheetView](../spreadsheetview)\n * - [CircularView](../circularview)\n *\n * extends\n * - [BaseViewModel](../baseviewmodel)\n */\nfunction SvInspectorViewF(pluginManager: PluginManager) {\n  const SpreadsheetViewType = pluginManager.getViewType('SpreadsheetView')!\n  const CircularViewType = pluginManager.getViewType('CircularView')!\n\n  const SpreadsheetModel =\n    SpreadsheetViewType.stateModel as SpreadsheetViewStateModel\n  const CircularModel = CircularViewType.stateModel as CircularViewStateModel\n\n  const minHeight = 400\n  const defaultHeight = 550\n  const headerHeight = 52\n  const circularViewOptionsBarHeight = 52\n  return types\n    .compose(\n      'SvInspectorView',\n      BaseViewModel,\n      types.model({\n        /**\n         * #property\n         */\n        id: ElementId,\n        /**\n         * #property\n         */\n        type: types.literal('SvInspectorView'),\n\n        /**\n         * #property\n         */\n        height: types.optional(types.number, defaultHeight),\n        /**\n         * #property\n         */\n        onlyDisplayRelevantRegionsInCircularView: false,\n        /**\n         * #property\n         */\n        spreadsheetView: types.optional(SpreadsheetModel, () =>\n          SpreadsheetModel.create({\n            type: 'SpreadsheetView',\n            hideVerticalResizeHandle: true,\n          }),\n        ),\n        /**\n         * #property\n         */\n        circularView: types.optional(CircularModel, () =>\n          CircularModel.create({\n            type: 'CircularView',\n            hideVerticalResizeHandle: true,\n            hideTrackSelectorButton: true,\n            disableImportForm: true,\n          }),\n        ),\n        /**\n         * #property\n         * used for initializing the view from a session snapshot\n         */\n        init: types.frozen<SvInspectorViewInit | undefined>(),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      width: 800,\n      /**\n       * #volatile\n       */\n      SpreadsheetViewReactComponent: SpreadsheetViewType.ReactComponent,\n      /**\n       * #volatile\n       */\n      CircularViewReactComponent: CircularViewType.ReactComponent,\n      /**\n       * #volatile\n       */\n      circularViewOptionsBarHeight,\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get assemblyName() {\n        const { assembly } = self.spreadsheetView\n        return assembly\n          ? (readConfObject(assembly, 'name') as string)\n          : undefined\n      },\n      /**\n       * #getter\n       */\n      get showCircularView() {\n        return !!self.spreadsheetView.spreadsheet?.rowSet\n      },\n\n      /**\n       * #getter\n       */\n      get features() {\n        return (\n          structuredClone(self.spreadsheetView.spreadsheet?.visibleRows)\n            ?.map(row => row.feature)\n            .filter(f => !!f) || []\n        )\n      },\n      /**\n       * #getter\n       */\n      get featuresAdapterConfigSnapshot() {\n        return {\n          type: 'FromConfigAdapter',\n          features: this.features,\n        }\n      },\n      /**\n       * #getter\n       */\n      get featureRefNames() {\n        return [\n          ...new Set(\n            [\n              ...this.features.map(r => r.refName),\n              // @ts-expect-error\n              ...this.features.flatMap(r => r.INFO?.CHR2),\n              // @ts-expect-error\n              ...this.features.flatMap(r => r.mate?.refName),\n            ].filter(f => !!f),\n          ),\n        ]\n      },\n      get currentAssembly() {\n        const { assemblyManager } = getSession(self)\n        return this.assemblyName\n          ? assemblyManager.get(this.assemblyName)\n          : undefined\n      },\n\n      /**\n       * #getter\n       */\n      get canonicalFeatureRefNameSet() {\n        const asm = this.currentAssembly\n        return new Set(\n          asm?.initialized\n            ? this.featureRefNames.map(r => asm.getCanonicalRefName(r) || r)\n            : [],\n        )\n      },\n      /**\n       * #getter\n       */\n      get featuresCircularTrackConfiguration() {\n        return {\n          type: 'VariantTrack',\n          trackId: `sv-inspector-variant-track-${self.id}`,\n          name: 'features from tabular data',\n          adapter: this.featuresAdapterConfigSnapshot,\n          assemblyNames: [this.assemblyName],\n          displays: [\n            {\n              type: 'ChordVariantDisplay',\n              displayId: `sv-inspector-variant-track-chord-display-${self.id}`,\n              onChordClick:\n                'jexl:defaultOnChordClick(feature, track, pluginManager)',\n              renderer: {\n                type: 'StructuralVariantChordRenderer',\n              },\n            },\n          ],\n        }\n      },\n    }))\n\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setWidth(newWidth: number) {\n        self.width = newWidth\n      },\n      /**\n       * #action\n       */\n      setHeight(newHeight: number) {\n        self.height = Math.max(newHeight, minHeight)\n        return self.height\n      },\n\n      /**\n       * #action\n       */\n      setDisplayedRegions(regions: Region[]) {\n        self.circularView.setDisplayedRegions(regions)\n      },\n      /**\n       * #action\n       */\n      setOnlyDisplayRelevantRegionsInCircularView(val: boolean) {\n        self.onlyDisplayRelevantRegionsInCircularView = val\n      },\n\n      /**\n       * #action\n       */\n      setInit(init?: SvInspectorViewInit) {\n        self.init = init\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      menuItems() {\n        return [\n          {\n            label: 'Return to import form',\n            icon: FolderOpenIcon,\n            onClick: () => {\n              self.spreadsheetView.displaySpreadsheet(undefined)\n            },\n          },\n        ]\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      resizeHeight(distance: number) {\n        const oldHeight = self.height\n        const newHeight = self.setHeight(self.height + distance)\n        return newHeight - oldHeight\n      },\n      afterAttach() {\n        // Init autorun for initializing from session snapshot\n        addDisposer(\n          self,\n          autorun(\n            async function svInspectorViewInitAutorun() {\n              const { init, width } = self\n              if (!width || !init) {\n                return\n              }\n\n              const session = getSession(self)\n\n              try {\n                const exts = init.uri.split('.')\n                let ext = exts.pop()?.toUpperCase()\n                if (ext === 'GZ') {\n                  ext = exts.pop()?.toUpperCase()\n                }\n\n                self.spreadsheetView.importWizard.setFileType(\n                  init.fileType || ext || '',\n                )\n                self.spreadsheetView.importWizard.setSelectedAssemblyName(\n                  init.assembly,\n                )\n                self.spreadsheetView.importWizard.setFileSource({\n                  uri: init.uri,\n                  locationType: 'UriLocation',\n                })\n                await self.spreadsheetView.importWizard.import(init.assembly)\n\n                // Clear init state\n                self.setInit(undefined)\n              } catch (e) {\n                console.error(e)\n                session.notifyError(`${e}`, e)\n                self.setInit(undefined)\n              }\n            },\n            { name: 'SvInspectorViewInit' },\n          ),\n        )\n\n        // synchronize subview widths\n        addDisposer(\n          self,\n          autorun(\n            () => {\n              const borderWidth = 1\n              if (self.showCircularView) {\n                const spreadsheetWidth = Math.round(self.width * 0.66)\n                const circularViewWidth = self.width - spreadsheetWidth\n                self.spreadsheetView.setWidth(spreadsheetWidth - borderWidth)\n                self.circularView.setWidth(circularViewWidth)\n              } else {\n                self.spreadsheetView.setWidth(self.width)\n              }\n            },\n            { name: 'SvInspectorView width binding' },\n          ),\n        )\n        // synchronize subview heights\n        addDisposer(\n          self,\n          autorun(\n            () => {\n              self.spreadsheetView.setHeight(self.height - headerHeight)\n              self.circularView.setHeight(\n                self.height - headerHeight - circularViewOptionsBarHeight,\n              )\n            },\n            {\n              name: 'SvInspectorView height binding',\n            },\n          ),\n        )\n\n        // bind circularview displayedRegions to spreadsheet assembly, mediated\n        // by the onlyRelevantRegions toggle\n        addDisposer(\n          self,\n          autorun(\n            async () => {\n              const {\n                onlyDisplayRelevantRegionsInCircularView,\n                circularView,\n                canonicalFeatureRefNameSet,\n                currentAssembly,\n              } = self\n              if (!circularView.initialized || !currentAssembly?.regions) {\n                return\n              } else if (onlyDisplayRelevantRegionsInCircularView) {\n                if (circularView.tracks.length === 1) {\n                  try {\n                    circularView.setDisplayedRegions(\n                      structuredClone(\n                        currentAssembly.regions.filter(r =>\n                          canonicalFeatureRefNameSet.has(r.refName),\n                        ),\n                      ),\n                    )\n                  } catch (e) {\n                    console.error(e)\n                    getSession(self).notifyError(`${e}`, e)\n                  }\n                }\n              } else {\n                circularView.setDisplayedRegions(currentAssembly.regions)\n              }\n            },\n            { name: 'SvInspectorView displayed regions bind' },\n          ),\n        )\n\n        // bind circularview tracks to our track snapshot view\n        addDisposer(\n          self,\n          reaction(\n            () => ({\n              generatedTrackConf: self.featuresCircularTrackConfiguration,\n              assemblyName: self.assemblyName,\n            }),\n            data => {\n              // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n              if (!data) {\n                return\n              }\n              const { assemblyName, generatedTrackConf } = data\n              const { circularView } = self\n              // hide any visible tracks\n              for (const t of circularView.tracks) {\n                circularView.hideTrack(t.configuration.trackId)\n              }\n\n              // put our track in as the only track\n              if (assemblyName) {\n                // @ts-expect-error\n                circularView.addTrackConf(generatedTrackConf, {\n                  assemblyName,\n                })\n              }\n            },\n            {\n              name: 'SvInspectorView track configuration binding',\n              fireImmediately: true,\n            },\n          ),\n        )\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      const { init, circularView, ...rest } = snap as Omit<typeof snap, symbol>\n      return rest as Omit<typeof rest, symbol>\n    })\n}\n\nexport type SvInspectorViewStateModel = ReturnType<typeof SvInspectorViewF>\nexport type SvInspectorViewModel = Instance<SvInspectorViewStateModel>\n\nexport default SvInspectorViewF\n","import { lazy } from 'react'\n\nimport ViewType from '@jbrowse/core/pluggableElementTypes/ViewType'\nimport { getContainingView, getSession } from '@jbrowse/core/util'\nimport { type IAnyStateTreeNode, getParent } from '@jbrowse/mobx-state-tree'\n\nimport stateModelFactory from './model.ts'\n\nimport type { SvInspectorViewModel } from './model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { CircularViewModel } from '@jbrowse/plugin-circular-view'\n\nconst BreakpointSplitViewChoiceDialog = lazy(\n  () => import('./BreakpointSplitViewChoiceDialog.tsx'),\n)\n\nfunction defaultOnChordClick(feature: Feature, chordTrack: IAnyStateTreeNode) {\n  const session = getSession(chordTrack)\n  try {\n    session.setSelection(feature)\n    const view = getContainingView(chordTrack) as CircularViewModel\n    const parentView = getParent<any>(view) as SvInspectorViewModel\n    const stableViewId = `${parentView.id}_spawned`\n    const assemblyName = view.assemblyNames[0]!\n    session.queueDialog(handleClose => [\n      BreakpointSplitViewChoiceDialog,\n      {\n        handleClose,\n        session,\n        feature,\n        stableViewId,\n        assemblyName,\n      },\n    ])\n  } catch (e) {\n    console.error(e)\n    session.notifyError(`${e}`, e)\n  }\n}\n\nexport default function SvInspectorViewF(pluginManager: PluginManager) {\n  pluginManager.jexl.addFunction('defaultOnChordClick', defaultOnChordClick)\n\n  pluginManager.addViewType(() => {\n    const stateModel = stateModelFactory(pluginManager)\n    return new ViewType({\n      name: 'SvInspectorView',\n      displayName: 'SV inspector',\n      stateModel,\n      ReactComponent: lazy(() => import('./components/SvInspectorView.tsx')),\n    })\n  })\n}\n","import Plugin from '@jbrowse/core/Plugin'\nimport { isAbstractMenuManager } from '@jbrowse/core/util/types'\nimport TableChartIcon from '@mui/icons-material/TableChart'\n\nimport LaunchSvInspectorViewF from './LaunchSvInspectorView/index.ts'\nimport SvInspectorViewF from './SvInspectorView/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util/types'\n\nexport default class SvInspectorViewPlugin extends Plugin {\n  name = 'SvInspectorViewPlugin'\n\n  install(pluginManager: PluginManager) {\n    SvInspectorViewF(pluginManager)\n    LaunchSvInspectorViewF(pluginManager)\n  }\n\n  configure(pluginManager: PluginManager) {\n    if (isAbstractMenuManager(pluginManager.rootModel)) {\n      pluginManager.rootModel.appendToSubMenu(['Add'], {\n        label: 'SV inspector',\n        icon: TableChartIcon,\n        onClick: (session: AbstractSessionModel) => {\n          session.addView('SvInspectorView', {})\n        },\n      })\n    }\n  }\n}\n","import type { SvInspectorViewModel } from '../SvInspectorView/model.ts'\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { AbstractSessionModel } from '@jbrowse/core/util'\n\nexport default function LaunchSvInspectorViewF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'LaunchView-SvInspectorView',\n    // @ts-expect-error\n    async ({\n      session,\n      assembly,\n      uri,\n      fileType,\n    }: {\n      session: AbstractSessionModel\n      assembly: string\n      uri: string\n      fileType?: string\n    }) => {\n      // Use the init property to let the model handle initialization\n      session.addView('SvInspectorView', {\n        init: {\n          assembly,\n          uri,\n          fileType,\n        },\n      }) as SvInspectorViewModel\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config TrixTextSearchAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst TrixTextSearchAdapter = ConfigurationSchema(\n  'TrixTextSearchAdapter',\n  {\n    /**\n     * #slot\n     */\n    ixFilePath: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'out.ix',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    ixxFilePath: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'out.ixx',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    metaFilePath: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: 'meta.json',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    tracks: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'List of tracks covered by text search adapter',\n    },\n    /**\n     * #slot\n     */\n    assemblyNames: {\n      type: 'stringArray',\n      defaultValue: [],\n      description: 'List of assemblies covered by text search adapter',\n    },\n  },\n  {\n    explicitlyTyped: true,\n    /**\n     * #identifier\n     */\n    explicitIdentifier: 'textSearchAdapterId',\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes file.ixx also exists:\n     * ```json\n     * {\n     *   \"type\": \"TrixTextSearchAdapter\",\n     *   \"uri\": \"file.ix\",\n     *   \"assemblyNames\": [\"hg19\"],\n     *   \"textSearchAdapterId\": \"hg19SearchIndex\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      return snap.uri\n        ? {\n            ...snap,\n            ixFilePath: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            ixxFilePath: {\n              uri: `${snap.uri}x`,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default TrixTextSearchAdapter\n","import Plugin from '@jbrowse/core/Plugin'\nimport TextSearchAdapterType from '@jbrowse/core/pluggableElementTypes/TextSearchAdapterType'\n\nimport configSchema from './TrixTextSearchAdapter/configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class TrixPlugin extends Plugin {\n  name = 'TrixPlugin'\n\n  install(pluginManager: PluginManager) {\n    pluginManager.addTextSearchAdapterType(() => {\n      return new TextSearchAdapterType({\n        name: 'TrixTextSearchAdapter',\n        displayName: 'Trix text search adapter',\n        configSchema,\n        description: 'Trix text search adapter',\n        getAdapterClass: () =>\n          import('./TrixTextSearchAdapter/TrixTextSearchAdapter.ts').then(\n            d => d.default,\n          ),\n      })\n    })\n  }\n}\n","import { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport { BaseDisplay } from '@jbrowse/core/pluggableElementTypes/models'\nimport {\n  getContainingView,\n  getEnv,\n  getSession,\n  isFeature,\n  makeAbortableReaction,\n} from '@jbrowse/core/util'\nimport {\n  getParentRenderProps,\n  getRpcSessionId,\n  getTrackAssemblyNames,\n} from '@jbrowse/core/util/tracks'\nimport { getParent, isAlive, types } from '@jbrowse/mobx-state-tree'\n\nimport { renderReactionData, renderReactionEffect } from './renderReaction.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { AnyReactComponentType, Feature } from '@jbrowse/core/util'\nimport type {\n  CircularViewModel,\n  ExportSvgOptions,\n} from '@jbrowse/plugin-circular-view'\nimport type { ThemeOptions } from '@mui/material'\n\n/**\n * #stateModel ChordVariantDisplay\n * extends\n * - [BaseDisplay](../basedisplay)\n */\nconst stateModelFactory = (configSchema: AnyConfigurationSchemaType) => {\n  return types\n    .compose(\n      'ChordVariantDisplay',\n      BaseDisplay,\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('ChordVariantDisplay'),\n        /**\n         * #property\n         */\n        bezierRadiusRatio: 0.1,\n        /**\n         * #property\n         */\n        assemblyName: types.maybe(types.string),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      filled: false,\n      /**\n       * #volatile\n       */\n      reactElement: undefined as React.ReactElement | undefined,\n      /**\n       * #volatile\n       */\n      data: undefined,\n      /**\n       * #volatile\n       */\n      html: undefined as string | undefined,\n      /**\n       * #volatile\n       */\n      message: '',\n      /**\n       * #volatile\n       */\n      renderingComponent: undefined as undefined | AnyReactComponentType,\n      /**\n       * #volatile\n       */\n      refNameMap: undefined as Record<string, string> | undefined,\n    }))\n    .actions(self => {\n      const { pluginManager } = getEnv(self)\n      const track = self\n      return {\n        /**\n         * #action\n         */\n        onChordClick(feature: Feature) {\n          getConf(self, 'onChordClick', { feature, track, pluginManager })\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get blockDefinitions() {\n        const view = getContainingView(self) as CircularViewModel\n        const origSlices = view.staticSlices\n        if (!self.refNameMap) {\n          return origSlices\n        }\n\n        const slices = structuredClone(origSlices)\n\n        for (const slice of slices) {\n          const regions = slice.region.elided\n            ? slice.region.regions\n            : [slice.region]\n          for (const region of regions) {\n            const renamed = self.refNameMap[region.refName]\n            if (renamed && region.refName !== renamed) {\n              region.refName = renamed\n            }\n          }\n        }\n        return slices\n      },\n\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return self.configuration.renderer.type\n      },\n\n      /**\n       * #getter\n       */\n      get rendererType() {\n        return getEnv(self).pluginManager.getRendererType(this.rendererTypeName)\n      },\n\n      /**\n       * #getter\n       */\n      get selectedFeatureId() {\n        if (!isAlive(self)) {\n          return undefined\n        }\n        const { selection } = getSession(self)\n        return isFeature(selection) ? selection.id() : undefined\n      },\n\n      /**\n       * #method\n       */\n      renderProps() {\n        const view = getContainingView(self) as CircularViewModel\n        return {\n          ...getParentRenderProps(self),\n          rpcDriverName: self.rpcDriverName,\n          bezierRadius: view.radiusPx * self.bezierRadiusRatio,\n          radius: view.radiusPx,\n          blockDefinitions: this.blockDefinitions,\n          config: self.configuration.renderer,\n          onChordClick: self.onChordClick,\n        }\n      },\n\n      /**\n       * #method\n       */\n      renderingProps() {\n        return {\n          displayModel: self,\n          onChordClick: (arg: Feature) => {\n            self.onChordClick(arg)\n          },\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      renderStarted() {\n        self.filled = false\n        self.message = ''\n        self.reactElement = undefined\n        self.data = undefined\n        self.html = undefined\n        self.error = undefined\n        self.renderingComponent = undefined\n      },\n      /**\n       * #action\n       */\n      renderSuccess({\n        message,\n        data,\n        reactElement,\n        html,\n        renderingComponent,\n      }: {\n        message?: string\n        data?: any\n        html?: string\n        reactElement?: React.ReactElement\n        renderingComponent?: AnyReactComponentType\n      }) {\n        if (message) {\n          self.filled = false\n          self.message = message\n          self.reactElement = undefined\n          self.data = undefined\n          self.html = undefined\n          self.error = undefined\n          self.renderingComponent = undefined\n        } else {\n          self.filled = true\n          self.message = ''\n          self.reactElement = reactElement\n          self.data = data\n          self.html = html\n          self.error = undefined\n          self.renderingComponent = renderingComponent\n        }\n      },\n      /**\n       * #action\n       */\n      renderError(error: unknown) {\n        console.error(error)\n        self.filled = false\n        self.message = ''\n        self.reactElement = undefined\n        self.html = undefined\n        self.data = undefined\n        self.error = error\n        self.renderingComponent = undefined\n      },\n\n      /**\n       * #action\n       */\n      setRefNameMap(refNameMap: Record<string, string>) {\n        self.refNameMap = refNameMap\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        makeAbortableReaction(\n          self,\n          renderReactionData,\n          renderReactionEffect,\n          {\n            name: `${self.type} ${self.id} rendering`,\n            fireImmediately: true,\n          },\n          self.renderStarted,\n          self.renderSuccess,\n          self.renderError,\n        )\n\n        makeAbortableReaction(\n          self,\n          () => {\n            return {\n              assemblyNames: getTrackAssemblyNames(self.parentTrack),\n              adapter: getConf(getParent<any>(self, 2), 'adapter'),\n              assemblyManager: getSession(self).assemblyManager,\n            } as const\n          },\n          async (args, stopToken) => {\n            return args\n              ? args.assemblyManager.getRefNameMapForAdapter(\n                  args.adapter,\n                  args.assemblyNames[0],\n                  {\n                    stopToken,\n                    sessionId: getRpcSessionId(self),\n                  },\n                )\n              : undefined\n          },\n          {\n            name: `${self.type} ${self.id} getting refNames`,\n            fireImmediately: true,\n          },\n          () => {},\n          refNameMap => {\n            if (refNameMap) {\n              self.setRefNameMap(refNameMap)\n            }\n          },\n          error => {\n            console.error(error)\n            self.setError(error)\n          },\n        )\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      async renderSvg(opts: ExportSvgOptions & { theme?: ThemeOptions }) {\n        const { renderSvg } = await import('./renderSvg.tsx')\n        return renderSvg(self, opts)\n      },\n    }))\n}\n\nexport default stateModelFactory\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nimport { baseLinearDisplayConfigSchema } from '../BaseLinearDisplay/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearFeatureDisplay\n * #category display\n */\nfunction configSchemaFactory(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearFeatureDisplay',\n    {\n      /**\n       * #slot\n       */\n      renderer: pluginManager.pluggableConfigSchemaType('renderer'),\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaFactory\n","import { ConfigurationReference } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\nimport { linearFeatureDisplayModelFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #stateModel LinearVariantDisplay\n * Similar to feature display, but provides custom widget on feature click.\n * Does not include gene glyph options since variants are not genes.\n * extends\n *\n * - [LinearFeatureDisplay](../linearfeaturedisplay)\n */\nexport default function stateModelFactory(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearVariantDisplay',\n      linearFeatureDisplayModelFactory(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearVariantDisplay'),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n      }),\n    )\n\n    .views(() => ({\n      /**\n       * #getter\n       */\n      get featureWidgetType() {\n        return {\n          type: 'VariantFeatureWidget',\n          id: 'variantFeature',\n        }\n      },\n    }))\n}\n\nexport type LinearVariantDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type LinearVariantDisplayModel = Instance<LinearVariantDisplayStateModel>\n","// @ts-nocheck\nfunction count(node) {\n  var sum = 0,\n      children = node.children,\n      i = children && children.length;\n  if (!i) sum = 1;\n  else while (--i >= 0) sum += children[i].value;\n  node.value = sum;\n}\n\nexport default function() {\n  return this.eachAfter(count);\n}\n","// @ts-nocheck\nimport node_count from \"./count.ts\";\nimport node_each from \"./each.ts\";\nimport node_eachBefore from \"./eachBefore.ts\";\nimport node_eachAfter from \"./eachAfter.ts\";\nimport node_find from \"./find.ts\";\nimport node_sum from \"./sum.ts\";\nimport node_sort from \"./sort.ts\";\nimport node_path from \"./path.ts\";\nimport node_ancestors from \"./ancestors.ts\";\nimport node_descendants from \"./descendants.ts\";\nimport node_leaves from \"./leaves.ts\";\nimport node_links from \"./links.ts\";\nimport node_iterator from \"./iterator.ts\";\n\nexport default function hierarchy(data, children) {\n  if (data instanceof Map) {\n    data = [undefined, data];\n    if (children === undefined) children = mapChildren;\n  } else if (children === undefined) {\n    children = objectChildren;\n  }\n\n  var root = new Node(data),\n      node,\n      nodes = [root],\n      child,\n      childs,\n      i,\n      n;\n\n  while (node = nodes.pop()) {\n    if ((childs = children(node.data)) && (n = (childs = Array.from(childs)).length)) {\n      node.children = childs;\n      for (i = n - 1; i >= 0; --i) {\n        nodes.push(child = childs[i] = new Node(childs[i]));\n        child.parent = node;\n        child.depth = node.depth + 1;\n      }\n    }\n  }\n\n  return root.eachBefore(computeHeight);\n}\n\nfunction node_copy() {\n  return hierarchy(this).eachBefore(copyData);\n}\n\nfunction objectChildren(d) {\n  return d.children;\n}\n\nfunction mapChildren(d) {\n  return Array.isArray(d) ? d[1] : null;\n}\n\nfunction copyData(node) {\n  if (node.data.value !== undefined) node.value = node.data.value;\n  node.data = node.data.data;\n}\n\nexport function computeHeight(node) {\n  var height = 0;\n  do node.height = height;\n  while ((node = node.parent) && (node.height < ++height));\n}\n\nexport function Node(data) {\n  this.data = data;\n  this.depth =\n  this.height = 0;\n  this.parent = null;\n}\n\nNode.prototype = hierarchy.prototype = {\n  constructor: Node,\n  count: node_count,\n  each: node_each,\n  eachAfter: node_eachAfter,\n  eachBefore: node_eachBefore,\n  find: node_find,\n  sum: node_sum,\n  sort: node_sort,\n  path: node_path,\n  ancestors: node_ancestors,\n  descendants: node_descendants,\n  leaves: node_leaves,\n  links: node_links,\n  copy: node_copy,\n  [Symbol.iterator]: node_iterator\n};\n","// @ts-nocheck\nfunction defaultSeparation(a, b) {\n  return a.parent === b.parent ? 1 : 2;\n}\n\nfunction meanX(children) {\n  return children.reduce(meanXReduce, 0) / children.length;\n}\n\nfunction meanXReduce(x, c) {\n  return x + c.x;\n}\n\nfunction maxY(children) {\n  return 1 + children.reduce(maxYReduce, 0);\n}\n\nfunction maxYReduce(y, c) {\n  return Math.max(y, c.y);\n}\n\nfunction leafLeft(node) {\n  var children;\n  while (children = node.children) node = children[0];\n  return node;\n}\n\nfunction leafRight(node) {\n  var children;\n  while (children = node.children) node = children[children.length - 1];\n  return node;\n}\n\nexport default function() {\n  var separation = defaultSeparation,\n      dx = 1,\n      dy = 1,\n      nodeSize = false;\n\n  function cluster(root) {\n    var previousNode,\n        x = 0;\n\n    // First walk, computing the initial x & y values.\n    root.eachAfter(function(node) {\n      var children = node.children;\n      if (children) {\n        node.x = meanX(children);\n        node.y = maxY(children);\n      } else {\n        node.x = previousNode ? x += separation(node, previousNode) : 0;\n        node.y = 0;\n        previousNode = node;\n      }\n    });\n\n    var left = leafLeft(root),\n        right = leafRight(root),\n        x0 = left.x - separation(left, right) / 2,\n        x1 = right.x + separation(right, left) / 2;\n\n    // Second walk, normalizing x & y to the desired size.\n    return root.eachAfter(nodeSize ? function(node) {\n      node.x = (node.x - root.x) * dx;\n      node.y = (root.y - node.y) * dy;\n    } : function(node) {\n      node.x = (node.x - x0) / (x1 - x0) * dx;\n      node.y = (1 - (root.y ? node.y / root.y : 1)) * dy;\n    });\n  }\n\n  cluster.separation = function(x) {\n    return arguments.length ? (separation = x, cluster) : separation;\n  };\n\n  cluster.size = function(x) {\n    return arguments.length ? (nodeSize = false, dx = +x[0], dy = +x[1], cluster) : (nodeSize ? null : [dx, dy]);\n  };\n\n  cluster.nodeSize = function(x) {\n    return arguments.length ? (nodeSize = true, dx = +x[0], dy = +x[1], cluster) : (nodeSize ? [dx, dy] : null);\n  };\n\n  return cluster;\n}\n","// @ts-nocheck\nexport default function(callback, that) {\n  let index = -1;\n  for (const node of this) {\n    callback.call(that, node, ++index, this);\n  }\n  return this;\n}\n","// @ts-nocheck\nexport default function(callback, that) {\n  var node = this, nodes = [node], next = [], children, i, n, index = -1;\n  while (node = nodes.pop()) {\n    next.push(node);\n    if (children = node.children) {\n      for (i = 0, n = children.length; i < n; ++i) {\n        nodes.push(children[i]);\n      }\n    }\n  }\n  while (node = next.pop()) {\n    callback.call(that, node, ++index, this);\n  }\n  return this;\n}\n","// @ts-nocheck\nexport default function(callback, that) {\n  var node = this, nodes = [node], children, i, index = -1;\n  while (node = nodes.pop()) {\n    callback.call(that, node, ++index, this);\n    if (children = node.children) {\n      for (i = children.length - 1; i >= 0; --i) {\n        nodes.push(children[i]);\n      }\n    }\n  }\n  return this;\n}\n","// @ts-nocheck\nexport default function(callback, that) {\n  let index = -1;\n  for (const node of this) {\n    if (callback.call(that, node, ++index, this)) {\n      return node;\n    }\n  }\n}\n","// @ts-nocheck\nexport default function(value) {\n  return this.eachAfter(function(node) {\n    var sum = +value(node.data) || 0,\n        children = node.children,\n        i = children && children.length;\n    while (--i >= 0) sum += children[i].value;\n    node.value = sum;\n  });\n}\n","// @ts-nocheck\nexport default function(compare) {\n  return this.eachBefore(function(node) {\n    if (node.children) {\n      node.children.sort(compare);\n    }\n  });\n}\n","// @ts-nocheck\nexport default function(end) {\n  var start = this,\n      ancestor = leastCommonAncestor(start, end),\n      nodes = [start];\n  while (start !== ancestor) {\n    start = start.parent;\n    nodes.push(start);\n  }\n  var k = nodes.length;\n  while (end !== ancestor) {\n    nodes.splice(k, 0, end);\n    end = end.parent;\n  }\n  return nodes;\n}\n\nfunction leastCommonAncestor(a, b) {\n  if (a === b) return a;\n  var aNodes = a.ancestors(),\n      bNodes = b.ancestors(),\n      c = null;\n  a = aNodes.pop();\n  b = bNodes.pop();\n  while (a === b) {\n    c = a;\n    a = aNodes.pop();\n    b = bNodes.pop();\n  }\n  return c;\n}\n","// @ts-nocheck\nexport default function() {\n  var node = this, nodes = [node];\n  while (node = node.parent) {\n    nodes.push(node);\n  }\n  return nodes;\n}\n","// @ts-nocheck\nexport default function() {\n  return Array.from(this);\n}\n","// @ts-nocheck\nexport default function() {\n  var leaves = [];\n  this.eachBefore(function(node) {\n    if (!node.children) {\n      leaves.push(node);\n    }\n  });\n  return leaves;\n}\n","// @ts-nocheck\nexport default function() {\n  var root = this, links = [];\n  root.each(function(node) {\n    if (node !== root) { // Dont include the roots parent, if any.\n      links.push({source: node.parent, target: node});\n    }\n  });\n  return links;\n}\n","// @ts-nocheck\nexport default function*() {\n  var node = this, current, next = [node], children, i, n;\n  do {\n    current = next.reverse(), next = [];\n    while (node = current.pop()) {\n      yield node;\n      if (children = node.children) {\n        for (i = 0, n = children.length; i < n; ++i) {\n          next.push(children[i]);\n        }\n      }\n    }\n  } while (next.length);\n}\n","import { lazy } from 'react'\n\nimport { fromNewick } from '@gmod/hclust'\nimport { ConfigurationReference, getConf } from '@jbrowse/core/configuration'\nimport SerializableFilterChain from '@jbrowse/core/pluggableElementTypes/renderers/util/serializableFilterChain'\nimport { set1 } from '@jbrowse/core/ui/colors'\nimport { getSession } from '@jbrowse/core/util'\nimport { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport { cast, isAlive, types } from '@jbrowse/mobx-state-tree'\nimport { linearBareDisplayStateModelFactory } from '@jbrowse/plugin-linear-genome-view'\nimport CategoryIcon from '@mui/icons-material/Category'\nimport FilterListIcon from '@mui/icons-material/FilterList'\nimport HeightIcon from '@mui/icons-material/Height'\nimport SplitscreenIcon from '@mui/icons-material/Splitscreen'\nimport VisibilityIcon from '@mui/icons-material/Visibility'\nimport { ascending } from '@mui/x-charts-vendor/d3-array'\nimport deepEqual from 'fast-deep-equal'\n\nimport {\n  NO_CALL_COLOR,\n  OTHER_ALT_COLOR,\n  REFERENCE_COLOR,\n  UNPHASED_COLOR,\n  getAltColorForDosage,\n} from './constants.ts'\nimport { getSources } from './getSources.ts'\nimport { cluster, hierarchy } from '../d3-hierarchy2/index.ts'\n\nimport type {\n  ClusterHierarchyNode,\n  HoveredTreeNode,\n} from './components/types.ts'\nimport type { SampleInfo, Source } from './types.ts'\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Feature } from '@jbrowse/core/util'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { LegendItem } from '@jbrowse/plugin-linear-genome-view'\n\n// lazies\nconst SetColorDialog = lazy(() => import('./components/SetColorDialog.tsx'))\nconst MAFFilterDialog = lazy(() => import('./components/MAFFilterDialog.tsx'))\nconst AddFiltersDialog = lazy(() => import('./components/AddFiltersDialog.tsx'))\nconst ClusterDialog = lazy(\n  () => import('./components/MultiVariantClusterDialog/ClusterDialog.tsx'),\n)\nconst SetRowHeightDialog = lazy(\n  () => import('./components/SetRowHeightDialog.tsx'),\n)\n\n/**\n * #stateModel MultiVariantBaseModel\n * extends\n * - [LinearBareDisplay](../linearbaredisplay)\n */\nexport default function MultiVariantBaseModelF(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearVariantMatrixDisplay',\n      linearBareDisplayStateModelFactory(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearVariantMatrixDisplay'),\n\n        /**\n         * #property\n         */\n        layout: types.optional(types.frozen<Source[]>(), []),\n        /**\n         * #property\n         */\n        configuration: ConfigurationReference(configSchema),\n\n        /**\n         * #property\n         */\n        minorAlleleFrequencyFilter: types.optional(types.number, 0),\n\n        /**\n         * #property\n         */\n        showSidebarLabelsSetting: types.optional(types.boolean, true),\n\n        /**\n         * #property\n         */\n        showTree: types.optional(types.boolean, true),\n\n        /**\n         * #property\n         */\n        renderingMode: types.optional(types.string, 'alleleCount'),\n\n        /**\n         * #property\n         * Controls row height: 'auto' calculates from available height,\n         * or a number specifies manual pixel height per row\n         */\n        rowHeightMode: types.optional(\n          types.union(types.literal('auto'), types.number),\n          'auto',\n        ),\n\n        /**\n         * #property\n         */\n        lengthCutoffFilter: types.optional(\n          types.number,\n          Number.MAX_SAFE_INTEGER,\n        ),\n\n        /**\n         * #property\n         */\n        jexlFilters: types.maybe(types.array(types.string)),\n\n        /**\n         * #property\n         */\n        referenceDrawingMode: types.optional(types.string, 'skip'),\n        /**\n         * #property\n         */\n        clusterTree: types.maybe(types.string),\n        /**\n         * #property\n         */\n        treeAreaWidth: types.optional(types.number, 80),\n        /**\n         * #property\n         * Height reserved for elements above the main display (e.g., connecting lines in matrix view)\n         */\n        lineZoneHeight: types.optional(types.number, 0),\n      }),\n    )\n    .volatile(() => ({\n      /**\n       * #volatile\n       */\n      sourcesLoadingStopToken: undefined as StopToken | undefined,\n      /**\n       * #volatile\n       */\n      simplifiedFeaturesStopToken: undefined as StopToken | undefined,\n      /**\n       * #volatile\n       */\n      featureUnderMouseVolatile: undefined as Feature | undefined,\n      /**\n       * #volatile\n       */\n      sourcesVolatile: undefined as Source[] | undefined,\n      /**\n       * #volatile\n       */\n      featuresVolatile: undefined as Feature[] | undefined,\n      /**\n       * #volatile\n       */\n      hasPhased: false,\n      /**\n       * #volatile\n       */\n      sampleInfo: undefined as undefined | Record<string, SampleInfo>,\n      /**\n       * #volatile\n       */\n      hoveredGenotype: undefined as\n        | { genotype: string; name: string }\n        | undefined,\n      /**\n       * #volatile\n       */\n      hoveredTreeNode: undefined as HoveredTreeNode | undefined,\n      /**\n       * #volatile\n       */\n      treeCanvas: undefined as HTMLCanvasElement | undefined,\n      /**\n       * #volatile\n       */\n      mouseoverCanvas: undefined as HTMLCanvasElement | undefined,\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setJexlFilters(f?: string[]) {\n        self.jexlFilters = cast(f)\n      },\n      /**\n       * #action\n       */\n      setRowHeight(arg: number | 'auto') {\n        self.rowHeightMode = arg\n      },\n      /**\n       * #action\n       */\n      setHoveredGenotype(arg?: { genotype: string; name: string }) {\n        self.hoveredGenotype = arg\n      },\n      /**\n       * #action\n       */\n      setHoveredTreeNode(node?: HoveredTreeNode) {\n        self.hoveredTreeNode = node\n      },\n      /**\n       * #action\n       */\n      setTreeCanvasRef(ref: HTMLCanvasElement | null) {\n        self.treeCanvas = ref || undefined\n      },\n      /**\n       * #action\n       */\n      setMouseoverCanvasRef(ref: HTMLCanvasElement | null) {\n        self.mouseoverCanvas = ref || undefined\n      },\n      /**\n       * #action\n       */\n      setTreeAreaWidth(width: number) {\n        self.treeAreaWidth = width\n      },\n      /**\n       * #action\n       */\n      setFeatures(f: Feature[]) {\n        self.featuresVolatile = f\n      },\n\n      /**\n       * #action\n       */\n      setLayout(layout: Source[], clearTree = true) {\n        const orderChanged =\n          clearTree &&\n          self.clusterTree &&\n          self.layout.length === layout.length &&\n          self.layout.some((source, idx) => source.name !== layout[idx]?.name)\n\n        self.layout = layout\n        if (orderChanged) {\n          self.clusterTree = undefined\n        }\n      },\n      /**\n       * #action\n       */\n      clearLayout() {\n        self.layout = []\n        self.clusterTree = undefined\n      },\n      /**\n       * #action\n       */\n      setClusterTree(tree?: string) {\n        self.clusterTree = tree\n      },\n      /**\n       * #action\n       */\n      setSourcesLoading(token: StopToken) {\n        if (self.sourcesLoadingStopToken) {\n          stopStopToken(self.sourcesLoadingStopToken)\n        }\n        self.sourcesLoadingStopToken = token\n      },\n      /**\n       * #action\n       */\n      setSimplifiedFeaturesLoading(token: StopToken) {\n        if (self.simplifiedFeaturesStopToken) {\n          stopStopToken(self.simplifiedFeaturesStopToken)\n        }\n        self.simplifiedFeaturesStopToken = token\n      },\n\n      /**\n       * #action\n       */\n      setSources(sources: Source[]) {\n        if (!deepEqual(sources, self.sourcesVolatile)) {\n          self.sourcesVolatile = sources\n        }\n      },\n      /**\n       * #action\n       */\n      setMafFilter(arg: number) {\n        self.minorAlleleFrequencyFilter = arg\n      },\n      /**\n       * #action\n       */\n      setShowSidebarLabels(arg: boolean) {\n        self.showSidebarLabelsSetting = arg\n      },\n      /**\n       * #action\n       */\n      setShowTree(arg: boolean) {\n        self.showTree = arg\n      },\n      /**\n       * #action\n       */\n      setPhasedMode(arg: string) {\n        if (self.renderingMode !== arg) {\n          self.layout = []\n          self.clusterTree = undefined\n        }\n        self.renderingMode = arg\n      },\n      /**\n       * #action\n       * Toggle auto height mode. When turning off, uses default of 10px per row.\n       */\n      setAutoHeight(auto: boolean) {\n        self.rowHeightMode = auto ? 'auto' : 10\n      },\n      /**\n       * #action\n       */\n      setHasPhased(arg: boolean) {\n        self.hasPhased = arg\n      },\n      /**\n       * #action\n       */\n      setSampleInfo(arg: Record<string, SampleInfo>) {\n        if (!deepEqual(arg, self.sampleInfo)) {\n          self.sampleInfo = arg\n        }\n      },\n      /**\n       * #action\n       */\n      setReferenceDrawingMode(arg: string) {\n        self.referenceDrawingMode = arg\n      },\n    }))\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get autoHeight() {\n        return self.rowHeightMode === 'auto'\n      },\n\n      /**\n       * #getter\n       */\n      get activeFilters() {\n        // config jexlFilters are deferred evaluated so they are prepended with\n        // jexl at runtime rather than being stored with jexl in the config\n        return (\n          self.jexlFilters ??\n          getConf(self, 'jexlFilters').map((r: string) => `jexl:${r}`)\n        )\n      },\n      get sourcesWithoutLayout() {\n        return self.sourcesVolatile\n          ? getSources({\n              sources: self.sourcesVolatile,\n              renderingMode: self.renderingMode,\n              sampleInfo: self.sampleInfo,\n            })\n          : undefined\n      },\n      /**\n       * #getter\n       */\n      get sources() {\n        return self.sourcesVolatile\n          ? getSources({\n              sources: self.sourcesVolatile,\n              layout: self.layout.length ? self.layout : undefined,\n              renderingMode: self.renderingMode,\n              sampleInfo: self.sampleInfo,\n            })\n          : undefined\n      },\n      /**\n       * #getter\n       */\n      get root() {\n        const newick = self.clusterTree\n        if (!newick) {\n          return undefined\n        }\n        const tree = fromNewick(newick)\n        return hierarchy(tree, (d: ClusterHierarchyNode) => d.children)\n          .sum((d: ClusterHierarchyNode) => (d.children ? 0 : 1))\n          .sort((a: ClusterHierarchyNode, b: ClusterHierarchyNode) =>\n            ascending(a.data.height || 1, b.data.height || 1),\n          )\n      },\n    }))\n    .views(self => {\n      const { renderProps: superRenderProps } = self\n\n      return {\n        /**\n         * #getter\n         */\n        get sourceMap() {\n          return self.sources\n            ? Object.fromEntries(\n                self.sources.map(source => [source.name, source]),\n              )\n            : undefined\n        },\n        /**\n         * #getter\n         * Available height for rows (total height minus lineZoneHeight)\n         */\n        get availableHeight() {\n          return self.height - self.lineZoneHeight\n        },\n        /**\n         * #getter\n         */\n        get nrow() {\n          return self.sources?.length || 1\n        },\n\n        /**\n         * #getter\n         */\n        get rowHeight() {\n          return self.rowHeightMode === 'auto'\n            ? this.availableHeight / this.nrow\n            : self.rowHeightMode\n        },\n        /**\n         * #getter\n         */\n        get hierarchy() {\n          const r = self.root\n          if (!r || !self.sources?.length) {\n            return undefined\n          }\n          const clust = cluster()\n          clust.size([this.rowHeight * this.nrow, self.treeAreaWidth])\n          clust.separation(() => 1)\n          clust(r)\n          return r\n        },\n        /**\n         * #method\n         */\n        adapterProps() {\n          return {\n            ...superRenderProps(),\n            config: self.rendererConfig,\n          }\n        },\n      }\n    })\n    .views(self => {\n      const { trackMenuItems: superTrackMenuItems } = self\n\n      return {\n        /**\n         * #method\n         */\n        trackMenuItems() {\n          return [\n            ...superTrackMenuItems(),\n            {\n              label: 'Show...',\n              icon: VisibilityIcon,\n              type: 'subMenu',\n              subMenu: [\n                {\n                  label: 'Show sidebar labels',\n                  type: 'checkbox',\n                  checked: self.showSidebarLabelsSetting,\n                  onClick: () => {\n                    self.setShowSidebarLabels(!self.showSidebarLabelsSetting)\n                  },\n                },\n                {\n                  label: `Show tree${!self.clusterTree ? ' (run clustering first)' : ''}`,\n                  type: 'checkbox',\n                  checked: self.showTree,\n                  disabled: !self.clusterTree,\n                  onClick: () => {\n                    self.setShowTree(!self.showTree)\n                  },\n                },\n                {\n                  label: 'Show reference alleles',\n                  helpText:\n                    'When this setting is off, the background is colored solid grey and only ALT alleles are colored on top of it. This makes it easier to see potentially overlapping structural variants',\n                  type: 'checkbox',\n                  checked: self.referenceDrawingMode !== 'skip',\n                  onClick: () => {\n                    self.setReferenceDrawingMode(\n                      self.referenceDrawingMode === 'skip' ? 'draw' : 'skip',\n                    )\n                  },\n                },\n                {\n                  label: 'Show legend',\n                  type: 'checkbox',\n                  checked: self.showLegend,\n                  onClick: () => {\n                    self.setShowLegend(!self.showLegend)\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Row height',\n              icon: HeightIcon,\n              subMenu: [\n                {\n                  label: 'Manually set row height',\n                  disabled: self.autoHeight,\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      SetRowHeightDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n                {\n                  label: 'Auto-adjust to display height',\n                  type: 'checkbox',\n                  checked: self.autoHeight,\n                  onClick: () => {\n                    self.setAutoHeight(!self.autoHeight)\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Rendering mode',\n              icon: SplitscreenIcon,\n              subMenu: [\n                {\n                  label: 'Allele count (dosage)',\n                  helpText:\n                    'Draws the color darker the more times this allele exists, so homozygous variants are darker than heterozygous. Works on polyploid also',\n                  type: 'radio',\n                  checked: self.renderingMode === 'alleleCount',\n                  onClick: () => {\n                    self.setPhasedMode('alleleCount')\n                  },\n                },\n                {\n                  label: `Phased${\n                    self.hasPhased\n                      ? ''\n                      : !self.featuresVolatile\n                        ? ' (checking for phased variants...)'\n                        : ' (disabled, no phased variants found)'\n                  }`,\n                  helpText:\n                    'Phased mode splits each sample into multiple rows representing each haplotype, and the phasing of the variants is used to color the variant in the individual haplotype rows. For example, a diploid sample SAMPLE1 will generate two rows SAMPLE1-HP0 and SAMPLE1 HP1 and a variant 1|0 will draw a box in the top row but not the bottom row',\n                  disabled: !self.hasPhased,\n                  checked: self.renderingMode === 'phased',\n                  type: 'radio',\n                  onClick: () => {\n                    self.setPhasedMode('phased')\n                  },\n                },\n              ],\n            },\n\n            {\n              label: 'Filter by',\n              icon: FilterListIcon,\n              subMenu: [\n                {\n                  label: 'Minor allele frequency',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      MAFFilterDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n                {\n                  label: 'Edit filters',\n                  onClick: () => {\n                    getSession(self).queueDialog(handleClose => [\n                      AddFiltersDialog,\n                      {\n                        model: self,\n                        handleClose,\n                      },\n                    ])\n                  },\n                },\n              ],\n            },\n            {\n              label: 'Cluster by genotype',\n              icon: CategoryIcon,\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  ClusterDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n            {\n              label: 'Edit group colors/arrangement...',\n              onClick: () => {\n                getSession(self).queueDialog(handleClose => [\n                  SetColorDialog,\n                  {\n                    model: self,\n                    handleClose,\n                  },\n                ])\n              },\n            },\n          ]\n        },\n      }\n    })\n    .views(self => ({\n      /**\n       * #getter\n       */\n      get canDisplayLabels() {\n        return self.rowHeight >= 6 && self.showSidebarLabelsSetting\n      },\n      /**\n       * #getter\n       */\n      get totalHeight() {\n        return self.rowHeight * (self.sources?.length || 1)\n      },\n      /**\n       * #getter\n       */\n      get featuresReady() {\n        return !!self.featuresVolatile\n      },\n      /**\n       * #method\n       */\n      getPortableSettings() {\n        // Note: rowHeightMode is intentionally excluded because Matrix and\n        // Regular displays have different defaults\n        return {\n          minorAlleleFrequencyFilter: self.minorAlleleFrequencyFilter,\n          showSidebarLabelsSetting: self.showSidebarLabelsSetting,\n          showTree: self.showTree,\n          renderingMode: self.renderingMode,\n          lengthCutoffFilter: self.lengthCutoffFilter,\n          jexlFilters: self.jexlFilters,\n          referenceDrawingMode: self.referenceDrawingMode,\n          clusterTree: self.clusterTree,\n          treeAreaWidth: self.treeAreaWidth,\n          layout: self.layout,\n          height: self.height,\n        }\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       */\n      renderProps() {\n        const superProps = self.adapterProps()\n        return {\n          ...superProps,\n          notReady: superProps.notReady || !self.sources || !self.featuresReady,\n          height: self.height,\n          totalHeight: self.totalHeight,\n          renderingMode: self.renderingMode,\n          minorAlleleFrequencyFilter: self.minorAlleleFrequencyFilter,\n          lengthCutoffFilter: self.lengthCutoffFilter,\n          rowHeight: self.rowHeight,\n          sources: self.sources,\n          scrollTop: self.scrollTop,\n          referenceDrawingMode: self.referenceDrawingMode,\n          filters: new SerializableFilterChain({\n            filters: self.activeFilters,\n          }),\n        }\n      },\n      /**\n       * #method\n       * Returns legend items for rendering colors based on current mode\n       */\n      legendItems(): LegendItem[] {\n        if (self.renderingMode === 'phased') {\n          let maxAltAlleles = 1\n          const features = self.featuresVolatile\n          if (features) {\n            for (const feature of features) {\n              const alt = feature.get('ALT') as string[] | undefined\n              if (alt && alt.length > maxAltAlleles) {\n                maxAltAlleles = alt.length\n              }\n            }\n          }\n          const items: LegendItem[] = [\n            { color: REFERENCE_COLOR, label: 'Reference' },\n            { color: set1[0], label: 'Alt allele 1' },\n          ]\n          if (maxAltAlleles >= 2) {\n            items.push({ color: set1[1], label: 'Alt allele 2' })\n          }\n          if (maxAltAlleles >= 3) {\n            items.push({ color: set1[2], label: 'Alt allele 3' })\n          }\n          items.push({ color: UNPHASED_COLOR, label: 'Unphased' })\n          return items\n        }\n        return [\n          { color: REFERENCE_COLOR, label: 'Homozygous reference' },\n          { color: getAltColorForDosage(0.5), label: 'Heterozygous alt' },\n          { color: getAltColorForDosage(1), label: 'Homozygous alt' },\n          { color: OTHER_ALT_COLOR, label: 'Other alt allele' },\n          { color: NO_CALL_COLOR, label: 'No call' },\n        ]\n      },\n    }))\n    .actions(self => ({\n      afterAttach() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            const { setupMultiVariantAutoruns } =\n              await import('./setupMultiVariantAutoruns.ts')\n            setupMultiVariantAutoruns(self)\n          } catch (e) {\n            if (isAlive(self)) {\n              console.error(e)\n              getSession(self).notifyError(`${e}`, e)\n            }\n          }\n        })()\n      },\n    }))\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const {\n        layout,\n        minorAlleleFrequencyFilter,\n        showSidebarLabelsSetting,\n        showTree,\n        renderingMode,\n        rowHeightMode,\n        lengthCutoffFilter,\n        jexlFilters,\n        referenceDrawingMode,\n        clusterTree,\n        treeAreaWidth,\n        lineZoneHeight,\n        ...rest\n      } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(layout.length ? { layout } : {}),\n        ...(minorAlleleFrequencyFilter ? { minorAlleleFrequencyFilter } : {}),\n        ...(!showSidebarLabelsSetting ? { showSidebarLabelsSetting } : {}),\n        ...(!showTree ? { showTree } : {}),\n        ...(renderingMode !== 'alleleCount' ? { renderingMode } : {}),\n        ...(rowHeightMode !== 'auto' ? { rowHeightMode } : {}),\n        ...(lengthCutoffFilter !== Number.MAX_SAFE_INTEGER\n          ? { lengthCutoffFilter }\n          : {}),\n        ...(jexlFilters?.length ? { jexlFilters } : {}),\n        ...(referenceDrawingMode !== 'skip' ? { referenceDrawingMode } : {}),\n        ...(clusterTree !== undefined ? { clusterTree } : {}),\n        ...(treeAreaWidth !== 80 ? { treeAreaWidth } : {}),\n        ...(lineZoneHeight ? { lineZoneHeight } : {}),\n      } as typeof snap\n    })\n}\n\nexport type MultiVariantBaseStateModel = ReturnType<\n  typeof MultiVariantBaseModelF\n>\nexport type MultiVariantBaseModel = Instance<MultiVariantBaseStateModel>\n","import { types } from '@jbrowse/mobx-state-tree'\n\nimport MultiVariantBaseModelF from '../shared/MultiVariantBaseModel.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { ExportSvgDisplayOptions } from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #stateModel MultiLinearVariantDisplay\n * extends\n * - [MultiVariantBaseModel](../linearbaredisplay)\n */\nexport function stateModelFactory(configSchema: AnyConfigurationSchemaType) {\n  return types\n    .compose(\n      'MultiLinearVariantDisplay',\n      MultiVariantBaseModelF(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('MultiLinearVariantDisplay'),\n      }),\n    )\n    .views(() => ({\n      /**\n       * #getter\n       */\n      get rendererTypeName() {\n        return 'MultiVariantRenderer'\n      },\n    }))\n    .actions(self => {\n      const { renderSvg: superRenderSvg } = self\n      return {\n        /**\n         * #action\n         */\n        async renderSvg(opts: ExportSvgDisplayOptions) {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self, opts, superRenderSvg)\n        },\n      }\n    })\n}\n\nexport type MultiLinearVariantDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type MultiLinearVariantDisplayModel =\n  Instance<MultiLinearVariantDisplayStateModel>\n\nexport default stateModelFactory\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config LinearVariantMatrixRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst LinearVariantMatrixRenderer = ConfigurationSchema(\n  'LinearVariantMatrixRenderer',\n  {},\n  { explicitlyTyped: true },\n)\nexport default LinearVariantMatrixRenderer\n","import { clamp } from '@jbrowse/core/util'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport MultiVariantBaseModelF from '../shared/MultiVariantBaseModel.ts'\n\nimport type { AnyConfigurationSchemaType } from '@jbrowse/core/configuration'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\nimport type { ExportSvgDisplayOptions } from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #stateModel LinearVariantMatrixDisplay\n * extends\n * - [MultiVariantBaseModel](../multivariantbasemodel)\n */\nexport default function stateModelFactory(\n  configSchema: AnyConfigurationSchemaType,\n) {\n  return types\n    .compose(\n      'LinearVariantMatrixDisplay',\n      MultiVariantBaseModelF(configSchema),\n      types.model({\n        /**\n         * #property\n         */\n        type: types.literal('LinearVariantMatrixDisplay'),\n        /**\n         * #property\n         */\n        lineZoneHeight: types.optional(types.number, 20),\n      }),\n    )\n    .views(() => ({\n      /**\n       * #getter\n       */\n      get blockType() {\n        return 'dynamicBlocks'\n      },\n\n      /**\n       * #getter\n       * positions multi-row below the tracklabel even if using overlap\n       * tracklabels\n       */\n      get prefersOffset() {\n        return true\n      },\n    }))\n    .views(self => ({\n      /**\n       * #method\n       * Override renderProps to pass the correct height for the matrix renderer\n       */\n      renderProps() {\n        const superProps = self.adapterProps()\n        return {\n          ...superProps,\n          notReady: superProps.notReady || !self.sources || !self.featuresReady,\n          renderingMode: self.renderingMode,\n          minorAlleleFrequencyFilter: self.minorAlleleFrequencyFilter,\n          lengthCutoffFilter: self.lengthCutoffFilter,\n          height: self.autoHeight ? self.totalHeight : self.availableHeight,\n          totalHeight: self.totalHeight,\n          rowHeight: self.rowHeight,\n          scrollTop: self.scrollTop,\n          sources: self.sources,\n        }\n      },\n    }))\n    .actions(self => ({\n      /**\n       * #action\n       */\n      setLineZoneHeight(n: number) {\n        self.lineZoneHeight = clamp(n, 10, 1000)\n        return self.lineZoneHeight\n      },\n    }))\n    .actions(self => {\n      const { renderSvg: superRenderSvg } = self\n      return {\n        /**\n         * #action\n         */\n        async renderSvg(opts: ExportSvgDisplayOptions) {\n          const { renderSvg } = await import('./renderSvg.tsx')\n          return renderSvg(self, opts, superRenderSvg)\n        },\n      }\n    })\n    .postProcessSnapshot(snap => {\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!snap) {\n        return snap\n      }\n      const { lineZoneHeight, ...rest } = snap as Omit<typeof snap, symbol>\n      return {\n        ...rest,\n        ...(lineZoneHeight !== 20 ? { lineZoneHeight } : {}),\n      } as typeof snap\n    })\n}\n\nexport type MultiLinearVariantMatrixDisplayStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type MultiLinearVariantMatrixDisplayModel =\n  Instance<MultiLinearVariantMatrixDisplayStateModel>\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport { renderToAbstractCanvas } from '@jbrowse/core/util'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\n\nimport type { RenderArgsDeserialized } from './types.ts'\n\nexport default class LinearVariantMatrixRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: RenderArgsDeserialized) {\n    const features = await this.getFeatures(renderProps)\n    const { height, regions, bpPerPx, scrollTop, rowHeight } = renderProps\n    const region = regions[0]!\n    const width = (region.end - region.start) / bpPerPx\n\n    const { makeImageData } = await import('./makeImageData.ts')\n    const { mafs, ...rest } = await renderToAbstractCanvas(\n      width,\n      height,\n      renderProps,\n      ctx =>\n        makeImageData({\n          ctx,\n          canvasWidth: width,\n          canvasHeight: height,\n          renderArgs: { ...renderProps, features },\n        }),\n    )\n\n    const serialized = {\n      ...rest,\n      simplifiedFeatures: mafs.map(({ feature }) => ({\n        uniqueId: feature.id(),\n        start: feature.get('start'),\n        end: feature.get('end'),\n        refName: feature.get('refName'),\n      })),\n      height,\n      width,\n      origScrollTop: scrollTop,\n      rowHeight,\n    }\n\n    return rpcResult(serialized, collectTransferables(rest))\n  }\n}\n","import FeatureRendererType from '@jbrowse/core/pluggableElementTypes/renderers/FeatureRendererType'\nimport { renderToAbstractCanvas } from '@jbrowse/core/util'\nimport { rpcResult } from '@jbrowse/core/util/librpc'\nimport { collectTransferables } from '@jbrowse/core/util/offscreenCanvasPonyfill'\n\nimport type { MultiRenderArgsDeserialized } from './types.ts'\n\nexport default class MultiVariantRenderer extends FeatureRendererType {\n  supportsSVG = true\n\n  async render(renderProps: MultiRenderArgsDeserialized) {\n    const features = await this.getFeatures(renderProps)\n    const { height, referenceDrawingMode, regions, bpPerPx, scrollTop } =\n      renderProps\n    const region = regions[0]!\n    const width = (region.end - region.start) / bpPerPx\n\n    const { makeImageData } = await import('./makeImageData.ts')\n\n    const ret = await renderToAbstractCanvas(\n      width,\n      height,\n      renderProps,\n      ctx => {\n        if (referenceDrawingMode === 'skip') {\n          ctx.fillStyle = '#ccc'\n          ctx.fillRect(0, 0, width, height)\n        }\n        return makeImageData(ctx, {\n          ...renderProps,\n          features,\n        })\n      },\n    )\n\n    const serialized = {\n      ...ret,\n      height,\n      width,\n      origScrollTop: scrollTop,\n    }\n\n    return rpcResult(serialized, collectTransferables(ret))\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config MultiVariantRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'MultiVariantRenderer',\n  {},\n  {\n    /**\n     * #baseConfiguration\n     */\n    explicitlyTyped: true,\n  },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config SplitVcfTabixAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst SplitVcfTabixAdapter = ConfigurationSchema(\n  'SplitVcfTabixAdapter',\n  {\n    /**\n     * #slot\n     * object like `{chr1:{uri:'url to file'}}`\n     */\n    vcfGzLocationMap: {\n      type: 'frozen',\n      defaultValue: {},\n    },\n    /**\n     * #slot\n     * object like `{chr1:{uri:'url to index'}}`\n     */\n    indexLocationMap: {\n      type: 'frozen',\n      defaultValue: {},\n    },\n\n    /**\n     * #slot\n     */\n    indexType: {\n      type: 'string',\n      defaultValue: 'TBI',\n    },\n\n    /**\n     * #slot\n     */\n    samplesTsvLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/samples.tsv',\n        description:\n          'tsv with header like \"name\\tpopulation\\tetc\" where the first column is required, and corresponds to the sample names in the VCF files',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n  },\n)\n\nexport default SplitVcfTabixAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n/**\n * #config StructuralVariantChordRenderer\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst configSchema = ConfigurationSchema(\n  'StructuralVariantChordRenderer',\n  {\n    /**\n     * #slot\n     */\n    strokeColor: {\n      type: 'color',\n      description: 'the line color of each arc',\n      defaultValue: 'rgba(255,133,0,0.32)',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    strokeColorSelected: {\n      type: 'color',\n      description: 'the line color of an arc that has been selected',\n      defaultValue: 'black',\n      contextVariable: ['feature'],\n    },\n    /**\n     * #slot\n     */\n    strokeColorHover: {\n      type: 'color',\n      description:\n        'the line color of an arc that is being hovered over with the mouse',\n      defaultValue: '#555',\n      contextVariable: ['feature'],\n    },\n  },\n  { explicitlyTyped: true },\n)\n\nexport default configSchema\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\nexport const configSchema = ConfigurationSchema('VariantFeatureWidget', {})\n","import { stateModelFactory as baseModelFactory } from '@jbrowse/core/BaseFeatureWidget'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport function stateModelFactory(pluginManager: PluginManager) {\n  const baseModel = baseModelFactory(pluginManager)\n  return types.compose(\n    baseModel,\n    types.model('VariantFeatureWidget', {\n      /**\n       * #property\n       */\n\n      type: types.literal('VariantFeatureWidget'),\n      /**\n       * #property\n       */\n      descriptions: types.frozen(),\n    }),\n  )\n}\n\nexport type VariantFeatureWidgetStateModel = ReturnType<\n  typeof stateModelFactory\n>\nexport type VariantFeatureWidgetModel = Instance<VariantFeatureWidgetStateModel>\n","import RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport type { ClusterGenotypeMatrixArgs } from './types.ts'\n\nexport class MultiVariantClusterGenotypeMatrix extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiVariantClusterGenotypeMatrix'\n\n  async execute(args: ClusterGenotypeMatrixArgs, rpcDriverClassName: string) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { executeClusterGenotypeMatrix } =\n      await import('./executeClusterGenotypeMatrix.ts')\n    return executeClusterGenotypeMatrix({\n      pluginManager: this.pluginManager,\n      args: deserializedArgs,\n    })\n  }\n}\n","import RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport { getGenotypeMatrix } from './getGenotypeMatrix.ts'\n\nimport type { GetGenotypeMatrixArgs } from './types.ts'\n\nexport class MultiVariantGetGenotypeMatrix extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiVariantGetGenotypeMatrix'\n\n  async execute(args: GetGenotypeMatrixArgs, rpcDriverClassName: string) {\n    return getGenotypeMatrix({\n      pluginManager: this.pluginManager,\n      args: await this.deserializeArguments(args, rpcDriverClassName),\n    })\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\nimport {\n  checkStopToken2,\n  createStopTokenChecker,\n} from '@jbrowse/core/util/stopToken'\nimport { firstValueFrom, toArray } from 'rxjs'\n\nimport { getFeaturesThatPassMinorAlleleFrequencyFilter } from '../shared/minorAlleleFrequencyUtils.ts'\n\nimport type { GetSimplifiedFeaturesArgs } from './types.ts'\nimport type { SampleInfo } from '../shared/types.ts'\nimport type { BaseFeatureDataAdapter } from '@jbrowse/core/data_adapters/BaseAdapter'\n\nexport class MultiVariantGetSimplifiedFeatures extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiVariantGetSimplifiedFeatures'\n\n  async execute(args: GetSimplifiedFeaturesArgs, rpcDriverClassName: string) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const {\n      lengthCutoffFilter,\n      minorAlleleFrequencyFilter,\n      regions,\n      adapterConfig,\n      stopToken,\n      sessionId,\n    } = deserializedArgs\n    const { dataAdapter } = await getAdapter(\n      this.pluginManager,\n      sessionId,\n      adapterConfig,\n    )\n\n    const rawFeatures = await firstValueFrom(\n      (dataAdapter as BaseFeatureDataAdapter)\n        .getFeaturesInMultipleRegions(regions, deserializedArgs)\n        .pipe(toArray()),\n    )\n\n    const sampleInfo = {} as Record<string, SampleInfo>\n    const genotypesCache = new Map<string, Record<string, string>>()\n    let hasPhased = false\n    const lastCheck = createStopTokenChecker(stopToken)\n\n    const features = getFeaturesThatPassMinorAlleleFrequencyFilter({\n      minorAlleleFrequencyFilter,\n      lengthCutoffFilter,\n      lastCheck,\n      features: rawFeatures,\n      genotypesCache,\n    })\n\n    for (const { feature } of features) {\n      const featureId = feature.id()\n      let samp = genotypesCache.get(featureId)\n      if (!samp) {\n        samp = feature.get('genotypes') as Record<string, string>\n        genotypesCache.set(featureId, samp)\n      }\n\n      for (const [key, val] of Object.entries(samp)) {\n        const isPhased = val.includes('|')\n        hasPhased ||= isPhased\n        let ploidy = 1\n        if (isPhased) {\n          for (const char of val) {\n            if (char === '|') {\n              ploidy++\n            }\n          }\n        }\n        const existing = sampleInfo[key]\n        sampleInfo[key] = {\n          maxPloidy: Math.max(existing?.maxPloidy ?? 0, ploidy),\n          isPhased: existing?.isPhased || isPhased,\n        }\n      }\n      checkStopToken2(lastCheck)\n    }\n    return {\n      hasPhased,\n      sampleInfo,\n      features: features.map(({ feature }) => ({\n        id: feature.id(),\n        data: {\n          start: feature.get('start'),\n          end: feature.get('end'),\n          refName: feature.get('refName'),\n          name: feature.get('name'),\n        },\n      })),\n    }\n  }\n}\n","import { getAdapter } from '@jbrowse/core/data_adapters/dataAdapterCache'\nimport RpcMethodTypeWithFiltersAndRenameRegions from '@jbrowse/core/pluggableElementTypes/RpcMethodTypeWithFiltersAndRenameRegions'\n\nimport type { AnyConfigurationModel } from '@jbrowse/core/configuration'\nimport type { Region } from '@jbrowse/core/util'\n\nexport class MultiVariantGetSources extends RpcMethodTypeWithFiltersAndRenameRegions {\n  name = 'MultiVariantGetSources'\n\n  async execute(\n    args: {\n      adapterConfig: AnyConfigurationModel\n      stopToken?: string\n      sessionId: string\n      headers?: Record<string, string>\n      regions: Region[]\n      bpPerPx: number\n    },\n    rpcDriverClassName: string,\n  ) {\n    const deserializedArgs = await this.deserializeArguments(\n      args,\n      rpcDriverClassName,\n    )\n    const { regions, adapterConfig, sessionId } = deserializedArgs\n    const { dataAdapter } = await getAdapter(\n      this.pluginManager,\n      sessionId,\n      adapterConfig,\n    )\n\n    // @ts-expect-error\n    return dataAdapter.getSources(regions, deserializedArgs)\n  }\n}\n","import type { Feature } from '@jbrowse/core/util'\n\nfunction generateINFO(feature: Feature) {\n  return Object.entries(feature.get('INFO'))\n    .map(([key, value]) => `${key}=${value}`)\n    .join(';')\n}\nexport function stringifyVCF({ features }: { features: Feature[] }) {\n  const fields = ['refName', 'start', 'name', 'REF', 'ALT', 'QUAL', 'FILTER']\n  return features\n    .map(feature => {\n      return `${fields\n        .map(field => feature.get(field) || '.')\n        .join('\\t')}\\t${generateINFO(feature)}`\n    })\n    .join('\\n')\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config VcfAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst VcfAdapter = ConfigurationSchema(\n  'VcfAdapter',\n  {\n    /**\n     * #slot\n     */\n    vcfLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.vcf',\n        locationType: 'UriLocation',\n      },\n    },\n    /**\n     * #slot\n     */\n    samplesTsvLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/samples.tsv',\n        description:\n          'tsv with header like name\\tpopulation\\tetc. where the first column is required, and is the sample names',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config:\n     * ```json\n     * {\n     *   \"type\": \"VcfAdapter\",\n     *   \"uri\": \"yourfile.vcf\"\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            vcfLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default VcfAdapter\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config VcfTabixAdapter\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst VcfTabixAdapter = ConfigurationSchema(\n  'VcfTabixAdapter',\n  {\n    /**\n     * #slot\n     */\n    vcfGzLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/my.vcf.gz',\n        locationType: 'UriLocation',\n      },\n    },\n\n    index: ConfigurationSchema('VcfIndex', {\n      /**\n       * #slot index.indexType\n       */\n      indexType: {\n        model: types.enumeration('IndexType', ['TBI', 'CSI']),\n        type: 'stringEnum',\n        defaultValue: 'TBI',\n      },\n      /**\n       * #slot index.location\n       */\n      location: {\n        type: 'fileLocation',\n        defaultValue: {\n          uri: '/path/to/my.vcf.gz.tbi',\n          locationType: 'UriLocation',\n        },\n      },\n    }),\n    /**\n     * #slot\n     */\n    samplesTsvLocation: {\n      type: 'fileLocation',\n      defaultValue: {\n        uri: '/path/to/samples.tsv',\n        description:\n          'tsv with header like name\\tpopulation\\tetc. where the first column is required, and is the sample names',\n        locationType: 'UriLocation',\n      },\n    },\n  },\n  {\n    explicitlyTyped: true,\n\n    /**\n     * #preProcessSnapshot\n     *\n     *\n     * preprocessor to allow minimal config, assumes tbi index at\n     * yourfile.vcf.gz.tbi:\n     *\n     * ```json\n     * {\n     *   \"type\": \"VcfTabixAdapter\",\n     *   \"uri\": \"yourfile.vcf.gz\",\n     * }\n     * ```\n     */\n    preProcessSnapshot: snap => {\n      // populate from just snap.uri\n      return snap.uri\n        ? {\n            ...snap,\n            vcfGzLocation: {\n              uri: snap.uri,\n              baseUri: snap.baseUri,\n            },\n            index: {\n              location: {\n                uri: `${snap.uri}.tbi`,\n                baseUri: snap.baseUri,\n              },\n            },\n          }\n        : snap\n    },\n  },\n)\n\nexport default VcfTabixAdapter\n","import Plugin from '@jbrowse/core/Plugin'\n\nimport ChordVariantDisplayF from './ChordVariantDisplay/index.ts'\nimport LinearVariantDisplayF from './LinearVariantDisplay/index.ts'\nimport MultiLinearVariantDisplayF from './MultiLinearVariantDisplay/index.ts'\nimport LinearVariantMatrixDisplayF from './MultiLinearVariantMatrixDisplay/index.ts'\nimport LinearVariantMatrixRendererF from './MultiLinearVariantMatrixRenderer/index.ts'\nimport MultiVariantRendererF from './MultiLinearVariantRenderer/index.ts'\nimport SplitVcfTabixAdapterF from './SplitVcfTabixAdapter/index.ts'\nimport StructuralVariantChordRendererF from './StructuralVariantChordRenderer/index.ts'\nimport VariantFeatureWidgetF from './VariantFeatureWidget/index.ts'\nimport { MultiVariantClusterGenotypeMatrix } from './VariantRPC/MultiVariantClusterGenotypeMatrix.ts'\nimport { MultiVariantGetGenotypeMatrix } from './VariantRPC/MultiVariantGetGenotypeMatrix.ts'\nimport { MultiVariantGetSimplifiedFeatures } from './VariantRPC/MultiVariantGetSimplifiedFeatures.ts'\nimport { MultiVariantGetSources } from './VariantRPC/MultiVariantGetSources.ts'\nimport VariantTrackF from './VariantTrack/index.ts'\nimport VcfAdapterF from './VcfAdapter/index.ts'\nimport ExtensionPointsF from './VcfExtensionPoints/index.ts'\nimport VcfTabixAdapterF from './VcfTabixAdapter/index.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default class VariantsPlugin extends Plugin {\n  name = 'VariantsPlugin'\n\n  install(pluginManager: PluginManager) {\n    VcfAdapterF(pluginManager)\n    VcfTabixAdapterF(pluginManager)\n    SplitVcfTabixAdapterF(pluginManager)\n    VariantFeatureWidgetF(pluginManager)\n    VariantTrackF(pluginManager)\n    ExtensionPointsF(pluginManager)\n    LinearVariantDisplayF(pluginManager)\n    LinearVariantMatrixDisplayF(pluginManager)\n    MultiLinearVariantDisplayF(pluginManager)\n    MultiVariantRendererF(pluginManager)\n    LinearVariantMatrixRendererF(pluginManager)\n    StructuralVariantChordRendererF(pluginManager)\n    ChordVariantDisplayF(pluginManager)\n\n    pluginManager.addRpcMethod(() => new MultiVariantGetSources(pluginManager))\n    pluginManager.addRpcMethod(\n      () => new MultiVariantGetGenotypeMatrix(pluginManager),\n    )\n    pluginManager.addRpcMethod(\n      () => new MultiVariantClusterGenotypeMatrix(pluginManager),\n    )\n    pluginManager.addRpcMethod(\n      () => new MultiVariantGetSimplifiedFeatures(pluginManager),\n    )\n  }\n}\n\nexport { default as VcfFeature } from './VcfFeature/index.ts'\n","import TrackType from '@jbrowse/core/pluggableElementTypes/TrackType'\nimport { createBaseTrackModel } from '@jbrowse/core/pluggableElementTypes/models'\n\nimport configSchemaF from './configSchema.ts'\nimport { stringifyVCF } from './saveTrackFormats/vcf.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function VariantTrackF(pm: PluginManager) {\n  pm.addTrackType(() => {\n    const configSchema = configSchemaF(pm)\n    return new TrackType({\n      name: 'VariantTrack',\n      displayName: 'Variant track',\n      configSchema,\n      stateModel: createBaseTrackModel(pm, 'VariantTrack', configSchema).views(\n        () => ({\n          saveTrackFileFormatOptions() {\n            return {\n              vcf: {\n                name: 'VCF',\n                extension: 'vcf',\n                callback: stringifyVCF,\n              },\n            }\n          },\n        }),\n      ),\n    })\n  })\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function VcfAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'VcfAdapter',\n        displayName: 'VCF adapter',\n        configSchema,\n        adapterCapabilities: ['exportData'],\n        getAdapterClass: () => import('./VcfAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport { default as configSchema } from './configSchema.ts'\n\nexport default function VcfTabixAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'VcfTabixAdapter',\n        displayName: 'VCF tabix adapter',\n        configSchema,\n        adapterCapabilities: ['exportData'],\n        getAdapterClass: () =>\n          import('./VcfTabixAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import AdapterType from '@jbrowse/core/pluggableElementTypes/AdapterType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport { default as configSchema } from './configSchema.ts'\n\nexport default function VcfTabixAdapterF(pluginManager: PluginManager) {\n  pluginManager.addAdapterType(\n    () =>\n      new AdapterType({\n        name: 'SplitVcfTabixAdapter',\n        displayName: 'VCF tabix adapter (split across multiple files)',\n        configSchema,\n        getAdapterClass: () =>\n          import('./SplitVcfTabixAdapter.ts').then(r => r.default),\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport WidgetType from '@jbrowse/core/pluggableElementTypes/WidgetType'\n\nimport { configSchema } from './configSchema.ts'\nimport { stateModelFactory } from './stateModelFactory.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function VariantFeatureWidgetF(pluginManager: PluginManager) {\n  pluginManager.addWidgetType(\n    () =>\n      new WidgetType({\n        name: 'VariantFeatureWidget',\n        heading: 'Feature details',\n        configSchema: configSchema,\n        stateModel: stateModelFactory(pluginManager),\n        ReactComponent: lazy(() => import('./VariantFeatureWidget.tsx')),\n      }),\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { createBaseTrackConfig } from '@jbrowse/core/pluggableElementTypes'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config VariantTrack\n * Mostly similar to feature track, but has `ChordDisplayType` registered to it,\n * and custom feature details in `LinearVariantDisplay`\n */\nexport default function VariantTrackF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'VariantTrack',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: createBaseTrackConfig(pluginManager),\n    },\n  )\n}\n","import { testAdapter } from '@jbrowse/core/util'\nimport {\n  getFileName,\n  makeIndex,\n  makeIndexType,\n} from '@jbrowse/core/util/tracks'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type {\n  AdapterGuesser,\n  TrackTypeGuesser,\n} from '@jbrowse/core/util/tracks'\nimport type { FileLocation } from '@jbrowse/core/util/types'\n\nexport default function VcfExtensionPointsF(pluginManager: PluginManager) {\n  pluginManager.addToExtensionPoint(\n    'Core-guessAdapterForLocation',\n    (adapterGuesser: AdapterGuesser) => {\n      return (\n        file: FileLocation,\n        index?: FileLocation,\n        adapterHint?: string,\n      ) => {\n        const fileName = getFileName(file)\n        const indexName = index && getFileName(index)\n        if (\n          testAdapter(fileName, /\\.vcf\\.b?gz$/i, adapterHint, 'VcfTabixAdapter')\n        ) {\n          return {\n            type: 'VcfTabixAdapter',\n            vcfGzLocation: file,\n            index: {\n              location: index || makeIndex(file, '.tbi'),\n              indexType: makeIndexType(indexName, 'CSI', 'TBI'),\n            },\n          }\n        } else if (\n          testAdapter(fileName, /\\.vcf(\\.gz)?$/i, adapterHint, 'VcfAdapter')\n        ) {\n          return {\n            type: 'VcfAdapter',\n            vcfLocation: file,\n          }\n        } else {\n          return adapterGuesser(file, index, adapterHint)\n        }\n      }\n    },\n  )\n  pluginManager.addToExtensionPoint(\n    'Core-guessTrackTypeForLocation',\n    (trackTypeGuesser: TrackTypeGuesser) => {\n      return (adapterName: string) => {\n        return ['VcfTabixAdapter', 'VcfAdapter'].includes(adapterName)\n          ? 'VariantTrack'\n          : trackTypeGuesser(adapterName)\n      }\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearVariantDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new DisplayType({\n      name: 'LinearVariantDisplay',\n      displayName: 'Variant display',\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'VariantTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(() =>\n        import('@jbrowse/plugin-linear-genome-view').then(m => ({\n          default: m.LinearBasicDisplayComponent,\n        })),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { linearFeatureDisplayConfigSchemaFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\n/**\n * #config LinearVariantDisplay\n *\n * Extends LinearFeatureDisplay (not LinearBasicDisplay) since variants\n * don't need gene glyph display options.\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearVariantDisplay',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearFeatureDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport type LinearVariantDisplayConfigModel = ReturnType<typeof configSchemaF>\nexport type LinearVariantDisplayConfig =\n  Instance<LinearVariantDisplayConfigModel>\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './configSchema.ts'\nimport stateModelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearVariantMatrixDisplayF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    return new DisplayType({\n      name: 'LinearVariantMatrixDisplay',\n      displayName: 'Multi-sample variant display (matrix)',\n      helpText:\n        'Draws multi-sample variant using a \"matrix\" where the visualization does not correspond to actual base pair coordinates, but uses lines to connect the columns of the matrix to their base pair coordinates',\n\n      configSchema,\n      stateModel: stateModelFactory(configSchema),\n      trackType: 'VariantTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/VariantDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { linearBasicDisplayConfigSchemaFactory } from '@jbrowse/plugin-linear-genome-view'\n\nimport configSchema from '../MultiLinearVariantMatrixRenderer/configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config LinearVariantMatrixDisplay\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'LinearVariantMatrixDisplay',\n    {\n      /**\n       * #slot\n       * MultiLinearVariantMatrixRenderer\n       */\n      renderer: configSchema,\n\n      /**\n       * #slot\n       */\n      height: {\n        type: 'number',\n        defaultValue: 250,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: linearBasicDisplayConfigSchemaFactory(pluginManager),\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaFactory from './configSchema.ts'\nimport modelFactory from './model.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiLinearVariantDisplayF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaFactory(pluginManager)\n    return new DisplayType({\n      name: 'MultiLinearVariantDisplay',\n      displayName: 'Multi-sample variant display (regular)',\n      helpText:\n        'Draws multi-sample variant data using a row for each sample in your dataset. The term \"regular\" is unfortunately vague but it just means drawing the variants at their actual base pair coordinates. The \"regular\" mode is notable for also being able to draw structural variants (SVs), including overlapping SVs. It will specifically skip drawing the \"reference\" alleles by default, allowing overlapping SVs to not cover each other up',\n      configSchema,\n      stateModel: modelFactory(configSchema),\n      trackType: 'VariantTrack',\n      viewType: 'LinearGenomeView',\n      ReactComponent: lazy(\n        () => import('./components/VariantDisplayComponent.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport sharedVariantConfigFactory from '../shared/SharedVariantConfigSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config MultiLinearVariantDisplay\n * extends\n * - [SharedVariantDisplay](../sharedvariantdisplay)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport default function VariantConfigFactory(pluginManager: PluginManager) {\n  const MultiVariantRendererConfigSchema = pluginManager.getRendererType(\n    'MultiVariantRenderer',\n  )!.configSchema\n\n  return ConfigurationSchema(\n    'MultiLinearVariantDisplay',\n    {\n      /**\n       * #slot\n       */\n      defaultRendering: {\n        type: 'stringEnum',\n        model: types.enumeration('Rendering', ['multivariant']),\n        defaultValue: 'multivariant',\n      },\n\n      /**\n       * #slot\n       */\n      renderers: ConfigurationSchema('RenderersConfiguration', {\n        MultiVariantRenderer: MultiVariantRendererConfigSchema,\n      }),\n\n      /**\n       * #slot\n       */\n      height: {\n        type: 'number',\n        defaultValue: 200,\n      },\n    },\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: sharedVariantConfigFactory(),\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { baseLinearDisplayConfigSchema } from '@jbrowse/plugin-linear-genome-view'\n\n/**\n * #config SharedVariantDisplay\n * extends\n * - [BaseLinearDisplay](../baselineardisplay)\n */\nexport default function sharedVariantConfigFactory() {\n  return ConfigurationSchema(\n    'SharedVariantDisplay',\n    {},\n    {\n      /**\n       * #baseConfiguration\n       */\n      baseConfiguration: baseLinearDisplayConfigSchema,\n      explicitlyTyped: true,\n    },\n  )\n}\n","import { lazy } from 'react'\n\nimport MultiVariantRenderer from './MultiVariantRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function MultiVariantRendererF(pluginManager: PluginManager) {\n  pluginManager.addRendererType(() => {\n    return new MultiVariantRenderer({\n      name: 'MultiVariantRenderer',\n      ReactComponent: lazy(\n        () => import('./components/MultiLinearVariantRendering.tsx'),\n      ),\n      configSchema,\n      pluginManager,\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport MultiLinearVariantMatrixRenderer from './MultiLinearVariantMatrixRenderer.ts'\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function LinearVariantMatrixRendererF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addRendererType(() => {\n    return new MultiLinearVariantMatrixRenderer({\n      name: 'LinearVariantMatrixRenderer',\n      displayName: 'Linear variant matrix renderer',\n      ReactComponent: lazy(\n        () => import('./components/MultiLinearVariantMatrixRendering.tsx'),\n      ),\n      configSchema,\n      pluginManager,\n    })\n  })\n}\n","import { lazy } from 'react'\n\nimport ChordRendererType from '@jbrowse/core/pluggableElementTypes/renderers/CircularChordRendererType'\n\nimport configSchema from './configSchema.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function StructuralVariantChordRendererF(\n  pluginManager: PluginManager,\n) {\n  pluginManager.addRendererType(\n    () =>\n      new ChordRendererType({\n        name: 'StructuralVariantChordRenderer',\n        displayName: 'SV chord renderer',\n        ReactComponent: lazy(() => import('./ReactComponent.tsx')),\n        configSchema,\n        pluginManager,\n      }),\n  )\n}\n","import { lazy } from 'react'\n\nimport DisplayType from '@jbrowse/core/pluggableElementTypes/DisplayType'\n\nimport configSchemaF from './models/configSchema.ts'\nimport stateModelF from './models/stateModelFactory.ts'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\nexport default function ChordVariantDisplayF(pluginManager: PluginManager) {\n  pluginManager.addDisplayType(() => {\n    const configSchema = configSchemaF(pluginManager)\n    const stateModel = stateModelF(configSchema)\n    return new DisplayType({\n      name: 'ChordVariantDisplay',\n      displayName: 'Chord variant display',\n      configSchema,\n      stateModel,\n      trackType: 'VariantTrack',\n      viewType: 'CircularView',\n      ReactComponent: lazy(\n        () => import('./components/ChordVariantDisplay.tsx'),\n      ),\n    })\n  })\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\nimport { types } from '@jbrowse/mobx-state-tree'\n\nimport type PluginManager from '@jbrowse/core/PluginManager'\n\n/**\n * #config ChordVariantDisplay\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nfunction configSchemaF(pluginManager: PluginManager) {\n  return ConfigurationSchema(\n    'ChordVariantDisplay',\n    {\n      /**\n       * #slot\n       */\n      onChordClick: {\n        type: 'boolean',\n        description:\n          'callback that should be run when a chord in the track is clicked',\n        defaultValue: false,\n        contextVariable: ['feature', 'track', 'pluginManager'],\n      },\n      /**\n       * #slot\n       */\n      renderer: types.optional(\n        pluginManager.pluggableConfigSchemaType('renderer'),\n        { type: 'StructuralVariantChordRenderer' },\n      ),\n    },\n    {\n      explicitIdentifier: 'displayId',\n      explicitlyTyped: true,\n    },\n  )\n}\n\nexport default configSchemaF\n","import Alignments from '@jbrowse/plugin-alignments'\nimport Arc from '@jbrowse/plugin-arc'\nimport Authentication from '@jbrowse/plugin-authentication'\nimport Bed from '@jbrowse/plugin-bed'\nimport BreakpointSplitView from '@jbrowse/plugin-breakpoint-split-view'\nimport Canvas from '@jbrowse/plugin-canvas'\nimport CircularView from '@jbrowse/plugin-circular-view'\nimport ComparativeAdapters from '@jbrowse/plugin-comparative-adapters'\nimport Config from '@jbrowse/plugin-config'\nimport DataManagement from '@jbrowse/plugin-data-management'\nimport DotplotView from '@jbrowse/plugin-dotplot-view'\nimport GCContent from '@jbrowse/plugin-gccontent'\nimport Gff3 from '@jbrowse/plugin-gff3'\nimport GridBookmarkPlugin from '@jbrowse/plugin-grid-bookmark'\nimport GtfPlugin from '@jbrowse/plugin-gtf'\nimport HicPlugin from '@jbrowse/plugin-hic'\nimport JobsManagementPlugin from '@jbrowse/plugin-jobs-management'\nimport LegacyJBrowse from '@jbrowse/plugin-legacy-jbrowse'\nimport LinearComparativeView from '@jbrowse/plugin-linear-comparative-view'\nimport LinearGenomeView from '@jbrowse/plugin-linear-genome-view'\nimport Lollipop from '@jbrowse/plugin-lollipop'\nimport Menus from '@jbrowse/plugin-menus'\nimport RDF from '@jbrowse/plugin-rdf'\nimport Sequence from '@jbrowse/plugin-sequence'\nimport SpreadsheetViewPlugin from '@jbrowse/plugin-spreadsheet-view'\nimport SvInspectorPlugin from '@jbrowse/plugin-sv-inspector'\nimport TrixPlugin from '@jbrowse/plugin-trix'\nimport Variants from '@jbrowse/plugin-variants'\nimport Wiggle from '@jbrowse/plugin-wiggle'\n\nconst corePlugins = [\n  Canvas,\n  LinearGenomeView,\n  Alignments,\n  Authentication,\n  Bed,\n  CircularView,\n  Config,\n  DataManagement,\n  DotplotView,\n  GtfPlugin,\n  Gff3,\n  JobsManagementPlugin,\n  LegacyJBrowse,\n  LinearComparativeView,\n  Lollipop,\n  Menus,\n  RDF,\n  Sequence,\n  Variants,\n  Wiggle,\n  GCContent,\n  SpreadsheetViewPlugin,\n  SvInspectorPlugin,\n  BreakpointSplitView,\n  HicPlugin,\n  TrixPlugin,\n  GridBookmarkPlugin,\n  ComparativeAdapters,\n  Arc,\n]\n\nexport default corePlugins\n","import type { Assembly } from '@jbrowse/core/assemblyManager/assembly'\n\nexport { fetchResults, splitLast } from '../../searchUtils.ts'\n\nexport function getRelativeX(\n  event: { clientX: number; target: EventTarget | null },\n  element: HTMLElement | null,\n) {\n  return event.clientX - (element?.getBoundingClientRect().left || 0)\n}\n\nexport function getCytobands(assembly: Assembly | undefined, refName: string) {\n  return (\n    assembly?.cytobands\n      ?.map(f => ({\n        refName:\n          assembly.getCanonicalRefName(f.get('refName')) || f.get('refName'),\n        start: f.get('start'),\n        end: f.get('end'),\n        type: f.get('gieStain') as string,\n        name: f.get('name'),\n      }))\n      .filter(f => f.refName === refName) || []\n  )\n}\n\nconst MIN_DRAG_DISTANCE = 30\n\nexport function shouldSwapTracks(\n  lastSwapY: number | undefined,\n  currentY: number,\n  movingDown: boolean,\n) {\n  return (\n    lastSwapY === undefined ||\n    (movingDown && currentY > lastSwapY + MIN_DRAG_DISTANCE) ||\n    (!movingDown && currentY < lastSwapY - MIN_DRAG_DISTANCE)\n  )\n}\n","import { cx, keyframes, makeStyles } from '@jbrowse/core/util/tss-react'\n\nconst useStyles = makeStyles()({\n  container: {\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    minHeight: 20,\n  },\n  overlay: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    backgroundColor: 'rgba(255, 255, 255, 0.15)',\n    backgroundImage:\n      'repeating-linear-gradient(45deg, transparent, transparent 8px, rgba(0, 0, 0, 0.05) 8px, rgba(0, 0, 0, 0.05) 16px)',\n    pointerEvents: 'none',\n    zIndex: 1,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    opacity: 0,\n  },\n  visible: {\n    opacity: 1,\n  },\n  dots: {\n    fontSize: '0.8rem',\n    fontWeight: 300,\n    '&::after': {\n      display: 'inline-block',\n      content: '\"\"',\n      width: '1em',\n      textAlign: 'left',\n      animation: `${keyframes`\n        0% { content: ''; }\n        25% { content: '.'; }\n        50% { content: '..'; }\n        75% { content: '...'; }\n      `} 1.2s infinite ease-in-out`,\n    },\n  },\n})\n\nexport default function LoadingOverlay({\n  statusMessage,\n  children,\n}: {\n  statusMessage?: string\n  children?: React.ReactNode\n}) {\n  const { classes } = useStyles()\n  const isLoading = !!statusMessage\n  return (\n    <div className={classes.container}>\n      {children}\n      <span\n        className={cx(classes.overlay, isLoading && classes.visible)}\n        data-testid={isLoading ? 'loading-overlay' : undefined}\n      >\n        <span className={classes.dots}>{statusMessage || 'Loading'}</span>\n      </span>\n    </div>\n  )\n}\n","import { Suspense, isValidElement, lazy } from 'react'\n\nimport { observer } from 'mobx-react'\n\nimport BlockMsg from './BlockMsg.tsx'\nimport LoadingOverlay from './LoadingOverlay.tsx'\n\nconst BlockErrorMessage = lazy(() => import('./BlockErrorMessage.tsx'))\n\nconst ServerSideRenderedBlockContent = observer(\n  function ServerSideRenderedBlockContent({\n    model,\n  }: {\n    model: {\n      error?: unknown\n      reload: () => void\n      message?: React.ReactNode\n      statusMessage?: string\n      reactElement?: React.ReactElement\n      isRenderingPending?: boolean\n    }\n  }) {\n    if (model.error) {\n      return (\n        <Suspense fallback={null}>\n          <BlockErrorMessage model={model} />\n        </Suspense>\n      )\n    } else if (model.message) {\n      return isValidElement(model.message) ? (\n        model.message\n      ) : (\n        <BlockMsg message={`${model.message}`} severity=\"info\" />\n      )\n    } else {\n      return (\n        <LoadingOverlay statusMessage={model.statusMessage}>\n          {model.reactElement}\n        </LoadingOverlay>\n      )\n    }\n  },\n)\n\nexport default ServerSideRenderedBlockContent\n","import type React from 'react'\n\nimport { readConfObject } from '@jbrowse/core/configuration'\nimport {\n  assembleLocString,\n  getContainingDisplay,\n  getSession,\n  makeAbortableReaction,\n} from '@jbrowse/core/util'\nimport { stopStopToken } from '@jbrowse/core/util/stopToken'\nimport {\n  getRpcSessionId,\n  getTrackAssemblyNames,\n} from '@jbrowse/core/util/tracks'\nimport { isRetryException } from '@jbrowse/core/util/types'\nimport { getParent, isAlive, types } from '@jbrowse/mobx-state-tree'\n\nimport ServerSideRenderedBlockContent from '../components/ServerSideRenderedBlockContent.tsx'\n\nimport type { Feature } from '@jbrowse/core/util'\nimport type { StopToken } from '@jbrowse/core/util/stopToken'\nimport type { AbstractDisplayModel, Region } from '@jbrowse/core/util/types'\nimport type { Instance } from '@jbrowse/mobx-state-tree'\n\nexport interface RenderedProps {\n  reactElement: React.ReactElement\n  features: Map<string, Feature>\n  layout: any\n  maxHeightReached: boolean\n  renderProps: any\n  renderArgs: Record<string, unknown>\n}\n// the MST state of a single server-side-rendered block in a display\nconst blockState = types\n  .model('BlockState', {\n    /**\n     * #property\n     */\n    key: types.string,\n    /**\n     * #property\n     */\n    region: types.frozen<Region>(),\n    /**\n     * #property\n     */\n    reloadFlag: 0,\n    /**\n     * #property\n     */\n    isLeftEndOfDisplayedRegion: false,\n    /**\n     * #property\n     */\n    isRightEndOfDisplayedRegion: false,\n  })\n  .volatile(() => ({\n    /**\n     * #volatile\n     */\n    stopToken: undefined as StopToken | undefined,\n    /**\n     * #volatile\n     */\n    filled: false,\n    /**\n     * #volatile\n     */\n    reactElement: undefined as React.ReactElement | undefined,\n    /**\n     * #volatile\n     */\n    features: undefined as Map<string, Feature> | undefined,\n    /**\n     * #volatile\n     */\n    layout: undefined as any,\n    /**\n     * #volatile\n     */\n    blockStatusMessage: '',\n    /**\n     * #volatile\n     */\n    error: undefined as unknown,\n    /**\n     * #volatile\n     */\n    message: undefined as string | undefined,\n    /**\n     * #volatile\n     */\n    maxHeightReached: false,\n    /**\n     * #volatile\n     */\n    ReactComponent: ServerSideRenderedBlockContent,\n    /**\n     * #volatile\n     */\n    renderProps: undefined as any,\n    /**\n     * #volatile\n     */\n    renderArgs: undefined as Record<string, unknown> | undefined,\n    /**\n     * #volatile\n     * Whether a render is currently in flight (but data is not ready yet)\n     */\n    isRenderingPending: true,\n    /**\n     * #volatile\n     * Cached reference to containing display for performance.\n     * Avoids expensive getContainingDisplay() tree traversal in statusMessage\n     * getter which is called frequently during rendering.\n     */\n    cachedDisplay: undefined as AbstractDisplayModel | undefined,\n  }))\n  .actions(self => {\n    function stopCurrentToken() {\n      if (self.stopToken !== undefined) {\n        stopStopToken(self.stopToken)\n        self.stopToken = undefined\n      }\n    }\n\n    function clearRenderState() {\n      self.filled = false\n      self.reactElement = undefined\n      self.features = undefined\n      self.layout = undefined\n      self.maxHeightReached = false\n      self.renderProps = undefined\n      self.renderArgs = undefined\n    }\n\n    return {\n      /**\n       * #action\n       */\n      doReload() {\n        self.reloadFlag = self.reloadFlag + 1\n      },\n\n      /**\n       * #action\n       */\n      setStatusMessage(message: string) {\n        self.blockStatusMessage = message\n      },\n      /**\n       * #action\n       */\n      setLoading(newStopToken: StopToken) {\n        stopCurrentToken()\n        self.isRenderingPending = true\n        self.error = undefined\n        self.message = undefined\n        // Note: We intentionally do NOT clear reactElement/features/layout here\n        // so that old content remains visible with a loading overlay while new\n        // content is being rendered\n        self.stopToken = newStopToken\n      },\n      /**\n       * #action\n       */\n      setMessage(messageText: string) {\n        stopCurrentToken()\n        self.isRenderingPending = false\n        self.message = messageText\n        self.error = undefined\n        clearRenderState()\n      },\n      /**\n       * #action\n       */\n      setRendered(props: RenderedProps | undefined) {\n        if (!props) {\n          return\n        }\n        const {\n          reactElement,\n          features,\n          layout,\n          maxHeightReached,\n          renderProps,\n          renderArgs,\n        } = props\n        self.filled = true\n        self.isRenderingPending = false\n        self.message = undefined\n        self.reactElement = reactElement\n        self.features = features\n        self.layout = layout\n        self.error = undefined\n        self.maxHeightReached = maxHeightReached\n        self.renderProps = renderProps\n        self.renderArgs = renderArgs\n        self.stopToken = undefined\n      },\n      /**\n       * #action\n       */\n      setError(error: unknown) {\n        console.error(error)\n        stopCurrentToken()\n        self.isRenderingPending = false\n        self.message = undefined\n        self.error = error\n        clearRenderState()\n        if (isRetryException(error as Error)) {\n          this.reload()\n        }\n      },\n      /**\n       * #action\n       */\n      reload() {\n        self.stopToken = undefined\n        self.isRenderingPending = false\n        self.error = undefined\n        self.message = undefined\n        self.ReactComponent = ServerSideRenderedBlockContent\n        clearRenderState()\n        getParent<any>(self, 2).reload()\n      },\n      setCachedDisplay(display: AbstractDisplayModel) {\n        self.cachedDisplay = display\n      },\n      beforeDestroy() {\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        ;(async () => {\n          try {\n            stopCurrentToken()\n            // use stored renderArgs from last successful render instead of\n            // recalculating via renderBlockData which is expensive\n            if (self.renderArgs && self.cachedDisplay) {\n              const { rpcManager } = getSession(self)\n              const { rendererType } = self.cachedDisplay\n              await rendererType.freeResourcesInClient(\n                rpcManager,\n                JSON.parse(JSON.stringify(self.renderArgs)),\n              )\n            }\n          } catch (e) {\n            console.error('Error while destroying block', e)\n          }\n        })()\n      },\n    }\n  })\n  .views(self => ({\n    get statusMessage() {\n      return self.isRenderingPending\n        ? self.blockStatusMessage ||\n            // @ts-expect-error\n            self.cachedDisplay?.statusMessage ||\n            'Loading'\n        : undefined\n    },\n  }))\n  .actions(self => ({\n    afterAttach() {\n      const display = self.cachedDisplay || getContainingDisplay(self)\n      setTimeout(() => {\n        if (isAlive(self)) {\n          makeAbortableReaction(\n            self as BlockModel,\n            renderBlockData,\n            renderBlockEffect,\n            {\n              name: `${display.id}/${assembleLocString(self.region)} rendering`,\n              delay: display.renderDelay,\n              fireImmediately: true,\n            },\n            self.setLoading,\n            self.setRendered,\n            self.setError,\n          )\n        }\n      }, display.renderDelay)\n    },\n  }))\n\nexport default blockState\nexport type BlockStateModel = typeof blockState\nexport type BlockModel = Instance<BlockStateModel>\n\n// calls the render worker to render the block content not using a flow for\n// this, because the flow doesn't work with autorun\nexport function renderBlockData(\n  self: BlockModel,\n  optDisplay?: AbstractDisplayModel,\n) {\n  try {\n    // Use optDisplay (for SVG export), cachedDisplay (set in addBlock), or\n    // fall back to tree traversal\n    const display = (optDisplay ||\n      self.cachedDisplay ||\n      getContainingDisplay(self)) as any\n    const { assemblyManager, rpcManager } = getSession(display)\n    const { adapterConfig, rendererType, error, parentTrack } = display\n    const assemblyNames = getTrackAssemblyNames(parentTrack)\n    const regionAsm = self.region.assemblyName\n    if (\n      !assemblyNames.includes(regionAsm) &&\n      !assemblyNames.some(name => assemblyManager.get(name)?.hasName(regionAsm))\n    ) {\n      throw new Error(\n        `region assembly (${regionAsm}) does not match track assemblies (${assemblyNames})`,\n      )\n    }\n\n    const renderProps = display.renderProps()\n    const renderingProps = display.renderingProps?.() as\n      | Record<string, unknown>\n      | undefined\n    const { config } = renderProps\n\n    // This line is to trigger the mobx reaction when the config changes It\n    // won't trigger the reaction if it doesn't think we're accessing it\n    readConfObject(config)\n\n    const sessionId = getRpcSessionId(display)\n    const trackInstanceId = parentTrack.id\n    const cannotBeRenderedReason = display.regionCannotBeRendered(self.region)\n\n    // Get seq adapter refName for sequence fetching (e.g., for peptide rendering)\n    const assembly = assemblyManager.get(self.region.assemblyName)\n    const seqAdapterRefName = assembly?.getSeqAdapterRefName(\n      self.region.refName,\n    )\n\n    return {\n      rendererType,\n      rpcManager,\n      renderProps,\n      renderingProps,\n      cannotBeRenderedReason,\n      displayError: error,\n      renderArgs: {\n        statusCallback: (message: string) => {\n          if (isAlive(self)) {\n            self.setStatusMessage(message)\n          }\n        },\n        assemblyName: self.region.assemblyName,\n        regions: [\n          {\n            ...(self.region as Omit<Region, symbol>),\n            seqAdapterRefName,\n          },\n        ],\n        adapterConfig,\n        rendererType: rendererType.name,\n        sessionId,\n        trackInstanceId,\n        blockKey: self.key,\n        reloadFlag: self.reloadFlag,\n        timeout: 1_000_000,\n      },\n    }\n  } catch (e) {\n    return {\n      displayError: e,\n    }\n  }\n}\n\nasync function renderBlockEffect(\n  props: ReturnType<typeof renderBlockData> | undefined,\n  stopToken: StopToken | undefined,\n  self: BlockModel,\n) {\n  if (!props || !isAlive(self)) {\n    return undefined\n  }\n  const {\n    rendererType,\n    renderProps,\n    renderingProps,\n    rpcManager,\n    renderArgs,\n    cannotBeRenderedReason,\n    displayError,\n  } = props\n  if (displayError) {\n    self.setError(displayError)\n    return undefined\n  }\n  if (cannotBeRenderedReason) {\n    self.setMessage(cannotBeRenderedReason)\n    return undefined\n  }\n  if (renderProps.notReady || !renderArgs) {\n    return undefined\n  }\n  const { reactElement, features, layout, maxHeightReached } =\n    await rendererType.renderInClient(rpcManager, {\n      ...renderArgs,\n      ...renderProps,\n      renderingProps,\n      stopToken,\n    })\n  return {\n    reactElement,\n    features,\n    layout,\n    maxHeightReached,\n    renderProps,\n    renderArgs,\n  }\n}\n","import { ConfigurationSchema } from '@jbrowse/core/configuration'\n\n/**\n * #config BaseLinearDisplay\n * #category display\n *\n * `BaseLinearDisplay` is a \"base\" config that is extended by other configs including\n * - `LinearBasicDisplay` (used for feature tracks, etc)\n * - `LinearBareDisplay` (more stripped down than even the basic display, not\n *   commonly used)\n */\nfunction x() {} // eslint-disable-line @typescript-eslint/no-unused-vars\n\nconst baseLinearDisplayConfigSchema = ConfigurationSchema(\n  'BaseLinearDisplay',\n  {\n    /**\n     * #slot\n     */\n    maxFeatureScreenDensity: {\n      type: 'number',\n      description:\n        'maximum features per pixel that is displayed in the view, used if byte size estimates not available',\n      defaultValue: 0.3,\n    },\n    /**\n     * #slot\n     */\n    fetchSizeLimit: {\n      type: 'number',\n      defaultValue: 1_000_000,\n      description:\n        \"maximum data to attempt to download for a given track, used if adapter doesn't specify one\",\n    },\n    /**\n     * #slot\n     */\n    height: {\n      type: 'number',\n      defaultValue: 100,\n      description: 'default height for the track',\n    },\n    /**\n     * #slot\n     */\n    mouseover: {\n      type: 'string',\n      description: 'text to display when the cursor hovers over a feature',\n      defaultValue: `jexl:mouseoverExtraInformation||get(feature,'_mouseOver')||get(feature,'name')||get(feature,'id')`,\n      contextVariable: ['feature', 'mouseoverExtraInformation'],\n    },\n    /**\n     * #slot\n     * config jexlFilters are deferred evaluated so they are prepended with\n     * jexl at runtime rather than being stored with jexl in the config\n     */\n    jexlFilters: {\n      type: 'stringArray',\n      description:\n        'default set of jexl filters to apply to a track. note: these do not use the jexl prefix because they have a deferred evaluation system',\n      defaultValue: [],\n    },\n  },\n  {\n    /**\n     * #identifier\n     */\n    explicitIdentifier: 'displayId',\n  },\n)\n\nexport default baseLinearDisplayConfigSchema\n","import PluggableElementBase from './PluggableElementBase.ts'\n\nimport type { AnyConfigurationSchemaType } from '../configuration/types.ts'\nimport type { IAnyModelType } from '@jbrowse/mobx-state-tree'\n\nexport default class InternetAccountType extends PluggableElementBase {\n  stateModel: IAnyModelType\n\n  configSchema: AnyConfigurationSchemaType\n\n  constructor(stuff: {\n    name: string\n    stateModel: IAnyModelType\n    configSchema: AnyConfigurationSchemaType\n  }) {\n    super(stuff)\n    this.stateModel = stuff.stateModel\n    this.configSchema = stuff.configSchema\n  }\n}\n"],"names":["inWebWorker","sessionStorage","InternetAccount","types","model","id","ElementId","type","string","configuration","ConfigurationReference","BaseInternetAccountConfig","views","self","name","getConf","description","internetAccountId","authHeader","tokenType","domains","toggleContents","SelectorComponent","selectorLabel","handlesLocation","location","some","domain","uri","includes","tokenKey","actions","getTokenFromUser","_resolve","_reject","Error","storeToken","token","setItem","removeToken","removeItem","retrieveToken","getItem","async","validateToken","_loc","tokenPromise","getToken","internetAccountPreAuthorization","authInfo","Promise","resolve","reject","error","addAuthHeaderToInit","init","headers","Headers","getPreAuthorizationInformation","authToken","validatedToken","internetAccountType","getFetcher","loc","input","newInit","fetch","openLocation","RemoteFileWithRangeCache","useStyles","makeStyles","theme","contentBlock","position","minHeight","boxSizing","whiteSpace","overflow","elidedBlock","backgroundColor","backgroundImage","interRegionPaddingBlock","palette","text","disabled","boundaryPaddingBlock","action","disabledBackground","ContentBlock","observer","block","children","classes","widthPx","_jsx","style","width","className","ElidedBlock","t0","$","_c","t1","t2","InterRegionPaddingBlock","boundary","undefined","t3","t4","t5","VIEW_HEADER_HEIGHT","axisPropsFromTickScale","scale","tickCount","range","values","ticks","format","tickFormat","copy","pluginManager","ConfigurationSchema","renderer","pluggableConfigSchemaType","baseConfiguration","baseLinearDisplayConfigSchema","explicitlyTyped","TrackType","PluggableElementBase","displayTypes","constructor","stuff","super","this","stateModel","configSchema","addDisplayType","display","push","calculateSvgLegendWidth","items","length","LEGEND_BOX_SIZE","Math","max","map","item","measureText","label","LEGEND_PADDING","props","regions","features","bpPerPx","height","displayModel","region","ref","useRef","getFeatureUnderMouse","eventClientX","offset","current","getBoundingClientRect","left","offsetX","px","reversed","clientBp","start","featureUnderMouse","feature","get","onMouseMove","e","setFeatureIdUnderMouse","clientX","onClick","featureId","selectFeatureById","catch","err","console","getSession","notifyError","onMouseLeave","PrerenderedCanvas","SAM_FLAG_PAIRED","SAM_FLAG_MATE_UNMAPPED","SAM_FLAG_MATE_REVERSE","SAM_FLAG_SECONDARY","SAM_FLAG_SUPPLEMENTARY","createBaseTrackConfig","defaultValue","assemblyNames","category","metadata","rpcDriverName","adapter","textSearching","indexingAttributes","indexingFeatureTypesToExclude","textSearchAdapter","displays","array","formatDetails","contextVariable","subfeatures","depth","maxDepth","formatAbout","config","hideUris","preProcessSnapshot","s2","snap","evaluateExtensionPoint","structuredClone","trackId","configDisplayTypes","Set","d","getTrackType","has","displayId","JSON","stringify","cause","explicitIdentifier","addDisplayConf","conf","find","configJsonLocation","locationType","baseConnectionConfig","baseUri","JB2TrackHubConnection","compose","BaseConnectionModelFactory","literal","connect","doConnect","JB2TrackHubConnectionF","addConnectionType","ConnectionType","stateModelFactory","displayName","url","AbortError","checkAbortSignal","signal","AbortSignal","TypeError","aborted","makeAbortError","abortBreakPoint","setTimeout","DOMException","code","observeAbortSignal","fromEvent","Observable","isAbortException","exception","test","message","fetchers","globalRangeCache","HttpRangeFetcher","end","options","fetcher","size","chunkSize","maxFetchSize","minimumTTL","RemoteFile","str","String","fetchBinaryRange","bind","rangeParse","exec","s","Number","parseInt","len","buffer","getRange","Response","status","requestDate","Date","res","responseDate","ok","errorMessage","hint","k","v","entries","arrayBuffer","Uint8Array","SetMinMaxDialog","lazy","SharedWiggleMixin","BaseLinearDisplay","selectedRendering","optional","resolution","number","fill","maybe","boolean","minSize","color","posColor","negColor","summaryScoreMode","rendererTypeNameState","autoscale","displayCrossHatches","constraints","min","volatile","stats","statsFetchInProgress","updateQuantitativeStats","statsRegion","currStatsBpPerPx","scoreMin","scoreMax","EPSILON","abs","setColor","setPosColor","setNegColor","setStatsLoading","arg","stopStopToken","selectFeature","session","isSelectionContainer","setSelection","setResolution","setFill","toggleLogScale","setScaleType","setSummaryScoreMode","val","setAutoscale","setMaxScore","setRendererType","setMinScore","toggleCrossHatches","setCrossHatches","cross","adapterTypeName","adapterConfig","rendererTypeNameSimple","filters","scaleType","maxScore","minScore","adapterCapabilities","getEnv","getAdapterType","rendererConfig","rendererTypeName","renderers","readConfObject","filled","autoscaleType","oldDomain","ret","getNiceDomain","bounds","MIN_VALUE","summaryScoreModeSetting","scaleOpts","inverted","canHaveFill","displayCrossHatchesSetting","hasResolution","hasGlobalStats","scoreTrackMenuItems","subMenu","elt","checked","queueDialog","handleClose","reload","superReload","setError","postProcessSnapshot","rest","locstr","view","includeAsm","assemblyName","refName","oob","pxToBp","coord","floor","toLocale","getBlockLabelKeysToHide","blocks","viewOffsetPx","blockLabelKeysToHide","sortedBlocks","sort","a","b","alen","occupiedPositions","key","offsetPx","y","round","labelStart","hasOverlap","i","add","makeTicks","emitMajor","emitMinor","gridPitch","minMajorPitchBp","majorPitch","toExponential","split","majorPitchPx","minorPitch","chooseGridPitch","iterPitch","index","minBase","maxBase","base","ceil","isViewContainer","thing","isStateTreeNode","isSessionModel","isSessionModelWithConfigEditing","t","isSessionWithAddTracks","disableAddTracks","isSessionWithShareURL","shareURL","isSessionModelWithWidgets","isSessionModelWithConnections","isSessionModelWithConnectionEditing","isSessionWithSessionPlugins","isViewModel","isTrackModel","isDisplayModel","isTrackViewModel","isAppRootModel","isRootModelWithInternetAccounts","isAbstractMenuManager","isUriLocation","isLocalPathLocation","localPath","isBlobLocation","blobId","AuthNeededError","Object","setPrototypeOf","prototype","RetryError","isAuthNeededException","isRetryException","getUri","isRelativeUrl","URL","startsWith","defaultVolatileState","trackData","indexTrackData","altAssemblyName","altTrackName","altTrackType","adapterHint","textIndexTrack","textIndexingConf","mixinData","f","safeReference","pluggableMstType","setMixinData","setAdapterHint","obj","setTextIndexingConf","setTextIndexTrack","flag","setTrackData","setIndexTrackData","setAssembly","setTrackName","setTrackType","clearData","trackAdapter","guessAdapter","trackName","getFileName","isFtp","trackUri","indexUri","isRelativeTrackUrl","isRelativeIndexUrl","trackHttp","indexHttp","wrongProtocol","window","protocol","unsupported","UNSUPPORTED","assembly","trackAdapterType","trackType","guessTrackType","getTrackConfig","timestamp","assemblyManager","deepmerge","toLowerCase","replaceAll","adminMode","join","warningMessage","AddTrackWidgetF","addWidgetType","WidgetType","heading","ReactComponent","confObject","slotPath","args","getSnapshot","slot","isMapType","getType","getValue","isConfigSlot","Array","isArray","slotName","newPath","slice","subConf","getTypeNamesFromExplicitlyTypedUnion","maybeUnionType","isType","resolveLateType","isUnionType","typeNames","getUnionSubTypes","typeName","getDefaultValue","isBareConfigurationSchemaType","isModelType","isLateType","isConfigurationSchemaType","every","isOptionalType","getSubType","isArrayType","configurationModelCache","WeakMap","isConfigurationModel","cached","set","isConfigurationSlotType","JexlF","j","Jexl","addFunction","data","parent","log","sqrt","log10","parseFloat","char","filter","charAt","charCodeAt","pos","codePointAt","search","endsWith","pad","padEnd","padStart","count","repeat","match","sub","replace","substring","toUpperCase","parse","trim","trimEnd","trimStart","tags","addBinaryOp","verticalGuidesZoomContainer","top","pointerEvents","verticalGuidesContainer","tick","majorTick","background","minorTick","divider","RenderedBlockLines","T0","majorTickClass","minorTickClass","ContentBlockComponent","x","RenderedVerticalGuides","staticBlocks","_Fragment","ElidedBlockComponent","InterRegionPaddingBlockComponent","variant","scaleFactor","transform","totalWidthPx","dragHandle","cursor","dragHandleIcon","verticalAlign","track","event","target","currentTarget","parentNode","dataTransfer","setDragImage","setDraggingTrackId","DragIcon","fontSize","draggable","onDragStart","onDragEnd","getContainingView","getMenuItems","useCallback","trackConf","minimized","pinned","isTopLevelView","trackMenuItems","saveTrackData","remainingTrackMenuItems","sessionItems","getTrackActionMenuItems","icon","LowPriorityIcon","priority","PushPinIcon","setPinned","AddIcon","MinimizeIcon","setMinimized","tracks","KeyboardDoubleArrowUpIcon","moveTrackToTop","KeyboardArrowUpIcon","moveTrackUp","KeyboardArrowDownIcon","moveTrackDown","KeyboardDoubleArrowDownIcon","moveTrackToBottom","CascadingMenuButton","menuItems","MoreVertIcon","root","zIndex","alpha","paper","margin","iconButton","padding","spacing","getTrackName","_jsxs","Paper","cx","stopPropagation","TrackLabelDragHandle","IconButton","hideTrack","title","CloseIcon","Typography","component","SanitizedHTML","html","TrackLabelMenu","trackLabel","trackLabelOffset","trackLabelOverlap","labelStyle","trackLabelsSetting","prefersOffset","TrackLabel","renderingComponentContainer","trackRenderingContainer","overflowY","overflowX","contain","RenderingComponent","DisplayBlurb","trackRefs","useEffect","onScroll","evt","setScrollTop","scrollTop","Suspense","fallback","LoadingEllipses","onHorizontalScroll","horizontalScroll","marginTop","unpinnedTrack","resizeHandle","draggingTrackId","showTrackOutlines","elevation","detail","featureIdUnderMouse","zoomTo","onDragOver","isAlive","draggingIdx","findIndex","movingDown","currentY","clientY","shouldSwapTracks","lastTrackDragY","setLastTrackDragY","moveTrack","Gridlines","TrackLabelContainer","ErrorBoundary","FallbackComponent","ErrorMessage","TrackRenderingContainer","ResizeHandle","onDrag","resizeHeight","guide","tooltipTarget","coordX","stickyViewHeaders","rubberbandTop","Tooltip","open","placement","arrow","useRangeSelect","shiftOnly","startX","setStartX","useState","currentX","setCurrentX","anchorPosition","setAnchorPosition","guideX","setGuideX","mouseDragging","Symbol","for","globalMouseMove","relativeX","getRelativeX","globalMouseUp","event_0","offsetX_0","isClick","scalebarRefNameClickPending","setScalebarRefNameClickPending","leftPx","rightPx","leftOffset","rightOffset","computeOffsets","setOffsets","addEventListener","removeEventListener","_temp","event_1","shiftKey","isScalebarRefNameMenuOpen","preventDefault","relativeX_0","mouseDown","event_2","mouseMove","mouseOut","t6","_","callback","handleMenuItemClick","Boolean","isClick_0","t7","clickBpOffset","t8","right","leftBpOffset","t9","rightBpOffset","numOfBpSelected","t10","t11","rubberbandOn","rubberbandControl","ControlComponent","RubberbandSpan","sticky","VerticalGuide","Menu","anchorReference","onMenuItemClick","onClose","rubberbandClickMenuItems","rubberBandMenuItems","onMouseDown","onMouseOut","flexShrink","justifyContent","lineHeight","ContentBlockLabels","getTickDisplayStr","refLabel","fontWeight","grey","b0","RefNameMenu","menuState","displayedRegions","regionNumber","numRegions","fromIndex","toIndex","removed","splice","setDisplayedRegions","moveRegion","regions_0","removeRegion","actionItems","__0","t12","t13","t14","t15","navTo","anchorEl","scalebarDisplayPrefix","setMenuState","setIsScalebarRefNameMenuOpen","lastLeftBlock","forEach","regionEndPx","Map","endPx","blockOffsetPx","isLeftEndOfDisplayedRegion","last","regEndPx","maxWidth","paddingLeft","container","zoomContainer","scalebar","other","ScalebarCoordinateLabels","ScalebarRefNameLabels","CenterLine","Highlight","tracksContainer","TracksContainer","mouseDown1","mouseUp","setMouseDragging","scheduled","prevX","cleanup","distance","requestAnimationFrame","dataset","resizer","button","useSideScroll","showGridlines","showCenterLine","mouseDown2","zoomDelta","scrollDelta","timeout","rafId","samples","curr","onWheel","ctrlKey","deltaY","averageDeltaY","sum","normalizer","setScaleFactor","clearTimeout","deltaX","passive","cancelAnimationFrame","useWheelScroll","additional","onMouseUp","Rubberband","Scalebar","SCALE_BAR_HEIGHT","HighlightGroup","highlight","idx","NoTracksActiveButton","header","pinnedTracks","rel","LinearGenomeViewContainer","pinnedTracksTop","unpinnedTracks","MiniControlsComponent","HeaderComponent","handleSelectView","Element","contains","setFocusedViewId","document","setHovered","c","hoverPosition","hoverFeature","TrackContainer","ImportForm","showLoading","showImportForm","loadingMessage","calcStdFromSums","sumSquares","n","population","variance","rectifyStats","scoreMean","scoreSum","featureCount","basesCovered","scoreStdDev","scoreSumSquares","featureDensity","scoresToStats","feats","seed","MAX_VALUE","found","firstValueFrom","pipe","reduce","acc","summary","blankStats","createCloudScale","minDistance","maxDistance","scaleLog","clamp","calculateCloudTicks","value","calculateCloudYOffsetsUtil","computedChains","cloudDomain","chainYOffsets","cloudMaxDistance","category10","dark2","set1","set2","tableau10","ggplot2Colors6","ggplot2Colors5","ggplot2Colors4","ggplot2Colors3","coarseStripHTML","result","inTag","l","configEditorComponent","CascadingMenuHelpDialog","helpText","DialogContent","Dialog","titleNode","_temp2","e_0","CascadingMenuHelpIconButton","helpDialogOpen","setHelpDialogOpen","marginLeft","HelpOutline","React","slotProps","menuItemEndDecoration","MenuItemEndDecoration","bb0","ArrowRightIcon","color_0","CheckBoxIcon","CheckBoxOutlineBlankIcon","RadioButtonCheckedIcon","RadioButtonUncheckedIcon","labelToTestId","CascadingSubmenu","Icon","inset","closeAfterItemClick","onCloseRoot","isOpen","onOpen","setAnchorEl","ListItemIcon","ListItemText","ChevronRight","MenuItem","vertical","horizontal","CascadingMenuList","HoverMenu","anchorOrigin","transformOrigin","openSubmenuIdx","setOpenSubmenuIdx","closeSubmenu","hasIcon","hasCheckboxOrRadioWithHelp","sortedItems","toSorted","_temp3","Divider","ListSubheader","actionItem","isCheckOrRadio","itemTestId","primary","secondary","subLabel","flexGrow","minWidth","m_0","m","CascadingMenu","marginThreshold","TOP","BOTTOM","heightFromSpecificLevel","level","getYPosOverride","getPxFromCoordinate","bpToPx","yPos","SNPCoverageDisplay","chunk","useNextFrame","variable","setNextFrameState","intersect","cb","a1","a2","ids","a12","calc","searchFeatureByID","getBlockFeatures","rpcManager","sessionId","getRpcSessionId","all","flatMap","call","contentBlocks","HeadingComponent","MultiLayout","subLayouts","SubLayoutClass","subLayoutConstructorArgs","getDataByID","layout","r","getSublayout","layoutName","subLayout","addRect","serializableData","discardRange","toJSON","sublayout","PairType","PROPER_PAIR","LONG_INSERT","SHORT_INSERT","INTER_CHROM","ABNORMAL_ORIENTATION","UNMAPPED_MATE","fillColor","color_fwd_strand_not_proper","color_rev_strand_not_proper","color_fwd_strand","color_rev_strand","color_fwd_missing_mate","color_rev_missing_mate","color_fwd_diff_chr","color_rev_diff_chr","color_pair_lr","color_pair_rr","color_pair_rl","color_pair_ll","color_nostrand","color_interchrom","color_longinsert","color_shortinsert","color_unmapped_mate","color_unknown","color_longread_rev_fwd","color_longread_fwd_rev","color_longread_same","color_supplementary","strokeColor","defaultColor","getPairedType","flags","orientationTypes","fr","pair_orientation","sameRef","next_ref","tlen","upper","lower","getPairedInsertSizeColor","getPairedOrientationColorOrDefault","type2","pairMap","getPairedOrientationColor","getPairedInsertSizeAndOrientationColor","getSingletonColor","getPairedColor","v0","f0","getDisplayStr","totalBytes","toPrecision","getId","notJest","jest","random","getFeatureDensityStatsPre","effectiveRpcDriverName","statusCallback","setStatusMessage","refTheme","createTheme","midnight","augmentColor","main","grape","forest","mandarin","lightgrey","bases","A","green","C","blue","G","orange","T","red","framesCDS","frames","stopCodon","startCodon","insertion","deletion","hardclip","softclip","skip","defaults","tertiary","quaternary","stockTheme","mode","components","MuiLink","styleOverrides","defaultThemes","default","lightStock","lightMinimal","darkMinimal","darkStock","MuiAppBar","defaultProps","enableColorOnDark","overwriteArrayMerge","sourceArray","createJBrowseBaseTheme","themeP","typography","MuiTooltip","tooltip","MuiButton","MuiAccordion","disableGutters","transition","unmountOnExit","MuiFilledInput","MuiFormControl","MuiFormHelperText","MuiIconButton","MuiInputBase","MuiAutocomplete","MuiInputLabel","MuiToolbar","MuiListItem","dense","MuiOutlinedInput","MuiFab","MuiTable","MuiPopover","transitionDuration","MuiMenu","MuiMenuItem","MuiTextField","MuiCheckbox","MuiRadio","MuiFormLabel","MuiAccordionSummary","content","contrastText","MuiToggleButtonGroup","MuiButtonBase","animationDuration","arrayMerge","themeCache","createJBrowseTheme","configTheme","themes","themeName","cacheKey","getThemeCacheKey","augmentThemeColors","addMissingColors","augmentedPalette","create","entry","paletteEntry","keys","FeatureRendererType","ServerSideRendererType","renderDirect","blockKey","serializeArgsInClient","deserializeResultsInClient","deserializedFeatures","SimpleFeature","fromJSON","serializeResultsInWorker","serialized","iterMap","getExpandedRegion","_renderArgs","getFeatures","renderArgs","pm","dataAdapter","getAdapter","isFeatureAdapter","requestRegions","normalizeRegion","featureObservable","getFeaturesInMultipleRegions","toArray","feat","featurePassesFilters","passes","render","heightOverflowed","borderBottom","textShadow","textAlign","memo","blockDefinitions","blockState","state","maxHeightReached","MaxHeightReached","getTotalHeight","linearBlocks","RenderedBlocks","contextCoord","contextMenuItems","setContextMenuFeature","onExit","clientRect","setClientRect","offsetMouseCoord","setOffsetMouseCoord","clientMouseCoord","setClientMouseCoord","setContextCoord","TooltipComponent","DisplayMessageComponent","showLegend","showTooltipsEnabled","useTheme","legendItems","onContextMenu","rect","LinearBlocks","FloatingLegend","mouseCoord","MenuPage","compilationCache","stringToJexlExpression","jexl","compiled","compile","createJexlInstance","initialized","colord","extend","mix","names","colordOriginal","cytobandLocation","CoreGetRefNames","RpcMethodType","execute","rpcDriver","deserializedArgs","deserializeArguments","sequenceAdapter","sequenceAdapterConfig","setSequenceAdapterConfig","getRefNames","CoreGetFeatureDetails","serializeArguments","rootModel","renamedArgs","renameRegionsIfNeeded","superArgs","rendererType","getRendererType","RendererType","getLayoutSession","cachedLayout","CoreGetMetadata","getMetadata","CoreGetFileInfo","getHeader","CoreGetFeatures","deserializeReturn","stopToken","opts","CoreGetSequence","getSequence","validateRendererType","CoreRender","executeDirect","renderInWorker","serializedReturn","des","CoreFreeResources","freeAdapterResources","getRendererTypes","freeResources","_rpcDriver","CoreGetFeatureDensityStats","getMultiRegionFeatureDensityStats","CoreGetRegions","isRegionsAdapter","getRegions","CoreGetExportData","formatType","getExportData","CorePlugin","Plugin","install","RpcMethod","coreRpcMethods","addRpcMethod","addAdapterType","AdapterType","adapterMetadata","hiddenFromGUI","getAdapterClass","then","CytobandAdapterF","PhasedScheduler","phaseCallbacks","phaseOrder","phase","run","phaseName","TypeRecord","registeredTypes","baseClass","PluginManager","plugins","pluginMetadata","runtimePluginDefinitions","elementCreationSchedule","glyphTypes","GlyphType","rendererTypes","adapterTypes","textSearchAdapterTypes","TextSearchAdapterType","trackTypes","DisplayType","connectionTypes","viewTypes","ViewType","widgetTypes","rpcMethods","addTrackWidgets","AddTrackWorkflowType","internetAccountTypes","InternetAccountType","configured","extensionPoints","initialPlugins","addPlugin","plugin","isCore","pluginConfigurationNamespacedSchemas","configurationSchemas","configurationSchema","pluginConfigurationUnnamespacedSchemas","configurationSchemaUnnamespaced","pluginConfigurationRootSchemas","rootConfigurationSchema","load","definition","getPlugin","p","hasPlugin","createPluggableElements","setRootModel","configure","getElementTypeRecord","groupName","addElementType","creationCallback","typeRecord","newElement","warn","getElementType","getElementTypesInGroup","getViewElements","getTrackElements","getConnectionElements","getAddTrackWorkflowElements","getRpcElements","getDisplayElements","getAdapterElements","fieldName","null","pluggableTypes","union","typeGroup","jbrequireCache","lib","ReExports","jbrequire","pack","getTextSearchAdapterType","getDisplayType","getViewType","getAddTrackWorkflow","getWidgetType","getConnectionType","getRpcMethodType","methodName","getInternetAccountType","addRendererType","addTextSearchAdapterType","addTrackType","addViewType","newView","viewType","extendedName","addInternetAccountType","addAddTrackWorkflowType","addGlyphType","getGlyphType","getGlyphTypes","addToExtensionPoint","extensionPointName","callbacks","extendee","accumulator","evaluateAsyncExtensionPoint","localStorageSetNumber","localStorageSetItem","featureData","frozen","formattedFields","unformattedFeatureData","sequenceFeatureDetails","showCoordinatesSetting","localStorageGetItem","intronBp","localStorageGetNumber","upDownBp","upperCaseCDS","localStorageGetBoolean","charactersPerRow","setFeature","setUpDownBp","setIntronBp","setUpperCaseCDS","setShowCoordinates","setMode","showCoordinates","showGenomicCoordsOption","hasCDS","featureType","hasExon","hasExonOrCDS","afterAttach","addDisposer","autorun","descriptions","setFeatureData","clearFeatureData","setFormattedData","setExtra","afterCreate","combine","arg2","__jbrowsefmt","formatSubfeatures","finalizedFeatureData","BaseViewModel","setDisplayName","setWidth","newWidth","Region","supportsSVG","reactElement","_args","SPLITTER","getGenotypeMatrix","sources","minorAlleleFrequencyFilter","lengthCutoffFilter","lastCheck","createStopTokenChecker","rows","fromEntries","splitCache","mafs","getFeaturesThatPassMinorAlleleFrequencyFilter","genotypes","alleles","nonRefCount","uncalledCount","allele","genotypeStatus","checkStopToken2","viewMetadata","makeHaplotypeSources","source","ploidy","results","baseName","HP","expandSourcesToHaplotypes","sampleInfo","maxPloidy","getSources","renderingMode","sourceMap","row","sampleName","baseSource","merged","adapterConfigCacheKey","idMaker","aggregateQuantitativeStats","sampleFeaturesForInterval","interval","sampleCenter","calculateFeatureDensityStats","refLen","expansionTime","lastTime","performance","now","POSITIVE_INFINITY","currTime","overview","useOffset","polygonColor","light","multiplier","interRegionPaddingWidth","dynamicBlocks","cytobandOffset","totalWidthPxWithoutBorders","first","at","topLeft","topRight","startPx","points","HEADER_BAR_HEIGHT","toString","getFillProps","getStrokeProps","intersection2","left1","right1","left2","right2","doesIntersect2","isContainedWithin","TextSearchManager","adapterCache","QuickLRU","maxSize","loadTextSearchAdapters","searchScope","relevantAdapters","adapterId","adapterType","adapterInstance","aggregateTextSearchAdapters","jbrowse","getAdaptersWithAssembly","getTrackAdaptersWithAssembly","confs","rankFn","search2","adapters","searchIndex","sortResults2","flat","uf","uFuzzy","haystack","getDisplayString","needle","queryString","idxs","info","order","element","filterText","clearFilterText","setFilterText","newText","PluginStoreWidgetF","isDetachedBuffer","byteLength","isArrayBufferLike","collectTransferables","transferables","imageData","flatbush","subfeatureFlatbush","ImageBitmap","bg","maxHeight","border","RedErrorMessageBox","ErrorMessageStackTraceDialog","iconFloat","float","ErrorButtons","onReset","showStack","setShowStack","ReportIcon","RefreshIcon","str2","indexOf","str3","snapshotError","findStr","match2","parseError","YSCALEBAR_LABEL_OFFSET","WIGGLE_COLOR_DEFAULT","getColorCallback","colorIsCallback","isCallback","pivotValue","_feature","score","getScale","scaleLinear","scaleQuantize","nice","rangeMin","rangeMax","reverse","getOrigin","getScaleType","toP","serializeWiggleFeature","uniqueId","WIGGLE_FUDGE_FACTOR","WIGGLE_CLIP_HEIGHT","getScaleValues","niceMin","niceMax","domainSpan","isLog","linearRatio","log2","logMin","logSpan","logRatio","fillRectCtx","ctx","fillStyle","fillRect","regionTooLargeReason","BlockMsg","severity","Button","setFeatureDensityStatsLimit","featureDensityStats","FeatureDensityMixin","userBpPerPxLimit","userByteSizeLimit","featureDensityStatsP","currentBytesRequested","bytes","currentFeatureScreenDensity","maxFeatureScreenDensity","featureDensityStatsReady","maxAllowableBytes","fetchSizeLimit","setCurrStatsBpPerPx","clearFeatureDensityStats","getFeatureDensityStats","setFeatureDensityStats","autorunFeatureDensityStats","setFeatureDensityStatsP","regionTooLarge","totalBp","req","featureDensityStatsReadyAndRegionNotTooLarge","regionCannotBeRenderedText","_region","regionCannotBeRendered","TooLargeMessage","createElementId","nanoid","identifier","horizontalHandle","verticalHandle","flexbox_verticalHandle","alignSelf","flexbox_horizontalHandle","originalClassName","flexbox","initialPosition","prevPos","getPosition","totalDistance","lastFrameDistance","pos_0","handleMouseDown","ReactRendering","rendering","isValidElement","dangerouslySetInnerHTML","__html","renderingToSvg","canvasRecordedData","getSerializedSvg","RubberbandTooltip","side","popper","modifiers","rubberband","rubberbandText","getBpDisplayStr","lazyMap","prefix","Component","forwardRef","lazyifyComponent","BaseFeatureDetail","Attributes","FeatureDetails","BaseCard","BaseAttributes","BaseCoreDetails","DataGridEntries","DataGrid","module","GridActionsCellItem","GridAddIcon","GridArrowDownwardIcon","GridArrowUpwardIcon","GridCellCheckboxForwardRef","GridCellCheckboxRenderer","GridCheckCircleIcon","GridCheckIcon","GridCloseIcon","GridColumnHeaderSeparator","GridColumnHeaderSortIcon","GridColumnIcon","GridColumnMenu","GridColumnMenuContainer","GridDragIcon","GridExpandMoreIcon","GridFilterAltIcon","GridFilterForm","GridFilterListIcon","GridFilterPanel","GridFooter","GridFooterContainer","GridHeader","GridHeaderCheckbox","GridKeyboardArrowRight","GridLoadIcon","GridLoadingOverlay","GridMenuIcon","GridMoreVertIcon","GridNoRowsOverlay","GridOverlay","GridPagination","GridPanel","GridPanelWrapper","GridRemoveIcon","GridRoot","GridRowCount","GridSearchIcon","GridSelectedRowCount","GridSeparatorIcon","GridTableRowsIcon","GridToolbarExportContainer","GridTripleDotsVerticalIcon","GridViewHeadlineIcon","GridViewStreamIcon","Entries","Accordion","AccordionActions","AccordionDetails","AccordionSummary","Alert","AlertTitle","Autocomplete","Avatar","AvatarGroup","Backdrop","Badge","Box","Breadcrumbs","ButtonGroup","Card","CardActions","CardActionArea","CardContent","CardHeader","CardMedia","CircularProgress","Collapse","ClickAwayListener","Chip","Checkbox","Container","DialogActions","DialogTitle","DialogContentText","Drawer","Fab","Fade","FilledInput","FormLabel","FormControl","FormControlLabel","FormHelperText","FormGroup","Grid","Grid2","Grow","Input","InputBase","InputLabel","InputAdornment","Link","LinearProgress","List","ListItem","ListItemAvatar","ListItemButton","ListItemSecondaryAction","MenuList","Modal","NativeSelect","OutlinedInput","Pagination","PaginationItem","Popover","Popper","Portal","Radio","RadioGroup","Rating","ScopedCssBaseline","Select","Skeleton","Slider","Snackbar","SnackbarContent","SpeedDial","SpeedDialAction","SpeedDialIcon","Stack","Step","StepButton","StepConnector","StepLabel","StepIcon","Stepper","SvgIcon","Switch","Tab","Table","TableBody","TableCell","TableContainer","TableFooter","TableHead","TablePagination","TableRow","TableSortLabel","Tabs","TextField","TextareaAutosize","ToggleButton","ToggleButtonGroup","Toolbar","SceneGraph","absoluteCache","dirty","addChild","nameOrSceneGraph","child","childLeft","childRight","childTop","bottom","childBottom","absolute","expand","getSubRecord","newLeft","newRight","newTop","newBottom","diff","walkParents","walkChildren","xOffset","yOffset","node","move","libs","mobx","mst","react","ReactJSXRuntime","ReactDom","ReactDomClient","mxreact","useGridApiContext","useGridApiRef","useGridRootProps","MUIUtils","keyframes","MUIStyles","Configuration","mstTypes","coreUi","coreTheme","coreUtil","coreColor","coreLayouts","trackUtils","Base1DView","coreIo","coreMstReflection","rxjs","pluggableElementTypes","pluggableElementTypeModels","CircularChordRendererType","BoxRendererType","BaseAdapterExports","libsList","inLibsOnly","mod","reExportsList","inReExportsOnly","getFeaturePositions","canonicalRefName","getCanonicalRefName","leftBpPx","rightBpPx","rightEstimate","leftEstimate","calculateFeaturePixelPositions","visibleRegions","minLeftPx","Infinity","maxRightPx","regionStart","regionEnd","calculateMultiRegionPositions","deduplicateFeatureLabels","layoutFeatures","featureLabels","topPx","floatingLabels","totalFeatureHeight","actualTopPx","featureWidth","totalLayoutWidth","featureStartBp","featureEndBp","effectiveTopPx","positions","existing","calculateFloatingLabelPosition","featureLeftPx","featureRightPx","labelWidth","viewportLeft","naturalX","maxX","renderProps","superRenderProps","getParentRenderProps","MAX_COLOR_RANGE","lineLimit","oobLimit","makeColor","g","unitMultiplier","getQueryColor","queryName","hash","hashString","defaultCigarColors","I","N","D","X","M","colorSchemes","cigarColors","strand","query","applyAlpha","toHex","RpcMethodTypeWithFiltersAndRenameRegions","rpcDriverClassName","SerializableFilterChain","CanvasSequence","getSvg","innerHTML","resolveUriLocation","href","isNode","isElectron","LocalFile","blob","getBlob","BlobFile","absoluteLocation","internetAccount","getInternetAccount","checkAuthNeededFetch","findAppropriateInternetAccount","response","TrackHeightMixin","heightPreConfig","refinement","setHeight","displayHeight","oldHeight","importFormEntry","onChange","selected","InputProps","TextFieldProps","localStorageKey","helperText","URLSearchParams","lastSelected","setLastSelected","useLocalStorage","host","pathname","selection","select","htmlInput","startClip","RegExp","endClip","parseCigar","currLen","CIGAR_CODE_TO_INDEX","parseCigar2","opIndex","Uint32Array","getMismatches","cigar","md","seq","qual","mismatches","ops","concat","roffset","soffset","hasRefAndSeq","op","altbase","insertlen","insertedBases","q","subarray","cliplen","cigarToMismatches","mdstring","cigarMismatches","mismatchRecords","opsLength","seqLength","hasQual","cigarLength","hasSkips","currStart","lastCigar","lastTemplateOffset","lastRefOffset","lastSkipPos","num","delLen","letter","mismatch","templateOffset","refOffset","mdToMismatches","getLengthOnRef","cigarOps","lengthOnRef","getLength","getLengthSansClipping","getClip","getTag","tag","featurizeSA","SA","readName","normalize","aln","saRef","saStart","saStrand","saCigar","saLengthOnRef","saLength","saLengthSansClipping","saStrandNormalized","saClipPos","saRealStart","clipLengthAtStartOfRead","CIGAR","mate","onClickExtra","setOpen","ButtonComponent","isDisabled","hubTxtLocation","UCSCTrackHubConnection","UCSCTrackHubConnectionF","modificationRegex","bigWigLocation","resolutionMultiplier","ConfirmDialog","DensityRenderer","makeImageData","clipColor","bicolorPivot","enumeration","bicolorPivotValue","baseWiggleRendererConfigSchema","LinePlotRenderer","sharedWiggleConfigFactory","minimalTicks","numStdDev","MultiDensityPlotRenderer","MultiLineRenderer","randomColor","SetColorDialog","WiggleClusterDialog","_pluginManager","showSidebar","sourcesLoadingStopToken","featureUnderMouseVolatile","sourcesVolatile","setShowSidebar","setSourcesLoading","setLayout","clearLayout","setSources","deepEqual","setFeatureUnderMouse","graphType","needsFullHeightScalebar","isMultiRow","needsCustomLegend","renderColorBoxes","sourcesWithoutLayout","iter","colors","quantitativeStatsReady","rowHeight","rowHeightTooSmallForScalebar","useMinimalTicks","adapterProps","quantitativeStatsRelevantToCurrentZoom","legendFontSize","canDisplayLegendLabels","superProps","notReady","renderingProps","fillSetting","superTrackMenuItems","hasRenderings","VisibilityIcon","setShowTooltips","EqualizerIcon","renderSvg","superRenderSvg","getMultiWiggleSourcesAutorun","getQuantitativeStatsAutorun","stringifyBedGraph","MultiRowLineRenderer","MultiRowXYPlotRenderer","subadapters","bigWigs","MultiXYPlotRenderer","WiggleGetGlobalQuantitativeStats","getGlobalStats","WiggleGetMultiRegionQuantitativeStats","renamedStaticBlocks","getMultiRegionQuantitativeStats","MultiWiggleGetSources","MultiWiggleGetScoreMatrix","getScoreMatrix","MultiWiggleClusterScoreMatrix","executeClusterScoreMatrix","XYPlotRenderer","WigglePlugin","configSchemaF","createBaseTrackModel","saveTrackFileFormatOptions","bedGraph","extension","QuantitativeTrackF","MultiQuantitativeTrackF","XYPlotRendererConfigSchema","DensityRendererConfigSchema","LinePlotRendererConfigSchema","defaultRendering","configSchemaFactory","modelFactory","LinearWiggleDisplayF","MultiXYPlotRendererConfigSchema","MultiDensityRendererConfigSchema","MultiRowXYPlotRendererConfigSchema","MultiLineRendererConfigSchema","MultiRowLineRendererConfigSchema","MultiDensityRenderer","MultiLinearWiggleDisplayF","LinePlotRendererF","XYPlotRendererF","DensityRendererF","MultiXYPlotRendererF","MultiRowXYPlotRendererF","MultiDensityRendererF","MultiLineRendererF","MultiRowLineRendererF","MultiWiggleAddTrackWorkflowF","arg1","trackIds","addTrackConf","showTrack","makeTrack","CreateMultiWiggleExtensionF","file","fileName","testAdapter","trackTypeGuesser","adapterName","GuessAdapterF","exports","LinearWiggleDisplayReactComponent","XYPlotRendererReactComponent","linearWiggleDisplayModelFactory","xyPlotRendererConfigSchema","utils","BaseSequenceAdapter","BaseFeatureDataAdapter","expandRegion","grow","minBound","maxBound","minMajorPitchPx","minMinorPitchPx","generateLocations","asmName","asm","waitForAssembly","parentRegion","expanded","parseLocStrings","isValidRefName","inputs","parseLocString","isInteger","calculateVisibleLocStrings","isSingleAssemblyName","assembleLocString","useMeasure","dims","setDims","RS","ResizeObserver","contentRect","observe","disconnect","adapterConfigSnapshot","dataAdapterType","getSubAdapter","sessionIds","getAdapterPre","specKeys","cacheEntryP","cacheEntry","delete","renderReactionData","trackInstanceId","getContainingTrack","renderReactionEffect","cannotBeRenderedReason","exportSVG","radius","renderInClient","renderingComponent","AddTrackWorkflow","bpExpansion","fetchFeatureByIdRpc","parentFeatureId","lookupId","findSubfeatureById","targetId","hasIntrons","transcripts","subs","transcript","mergeIntervals","getTranscripts","featureHasExonsOrCDS","drawCanvasImageData","canvas","getContext","resetTransform","clearRect","drawImage","SetMaxHeightDialog","AddFiltersDialog","trackShowLabels","trackShowDescriptions","trackDisplayMode","trackMaxHeight","jexlFilters","activeFilters","getParent","showLabels","showDescriptions","displayMode","setJexlFilters","cast","toggleShowLabels","toggleShowDescriptions","setDisplayMode","setMaxHeight","superRenderingProps","onFeatureClick","parentTrack","clearFeatureSelection","onFeatureContextMenu","reaction","delay","crypto","getRandomValues","byte","createSvgExportElement","hasPreRenderedContent","createNormalElement","ServerSideRenderer","isRpcResult","unwrapped","resultRest","deserializeArgsInWorker","args2","updateStatus","checkStopToken","freeResourcesInClient","serializedArgs","isRangeClear","intervals","low","high","mid","PileupLayout","rowMaxEnd","rectangles","lastLeft","lastRow","featureHeight","maxRows","startRow","paddedRight","findFreeRow","h","originalHeight","addToRow","rowIdx","findInsertionPoint","insertInterval","collides","_rect","_top","addRectToBitmap","maxRow","getRectangles","newIntervals","maxEnd","serializeRegion","x1","x2","regionRectangles","totalHeight","classnames","cls","toAdd","FeatureRenderer","filterChain","inputFilter","expr","eval","json","AdapterClass","trackLabels","BaseLinearDisplayComponent","YScaleBar","hasPairedReads","chains","alphaColor","baseColor","toHslString","defaultFilterFlags","flagInclude","flagExclude","isDefaultFilterFlags","filterBy","tagFilter","negFlags","posFlags","cacheGetter","ctor","prop","getter","getOwnPropertyDescriptor","defineProperty","filterReadFlag","filterTagValue","readVal","filterVal","shouldRenderChevrons","CHEVRON_WIDTH","parseSamHeader","samHeader","idToName","nameToId","readGroups","refId","rgId","line","datum","getColorBaseMap","getContrastBaseMap","getContrastText","shouldDrawSNPsMuted","shouldDrawIndels","setAlignmentFont","font","getCharWidthHeight","charWidth","charHeight","isTypedArray","ArrayBuffer","isView","DataView","convertTagsToPlainArrays","buildMismatchMap","featureStart","mismatchMap","forEachMismatch","mismatchStart","_len","MISMATCH_TYPE","_subtype","_subType","subType","unionType","_types","getPropertyType","propertyName","properties","_defaultValue","getEnumerationValues","maybeLate","HelpDialog","HelpAdornment","isHelpDialogDisplayed","setHelpDialogDisplayed","HelpIcon","EndAdornment","showHelp","marginRight","SearchIcon","headerRefName","textSearchManager","rankSearchResults","RefNameAutocomplete","onSelect","option","hasLocation","navToOption","setSearchResults","getLabel","handleSelectedRegion","notify","fetchResults","SPACING","WIDGET_HEIGHT","endAdornment","BaseAdapter","_opts","getFeaturesInRegion","ObservableCreate","hasDataForRefName","subscribe","complete","merge","getRegionQuantitativeStats","statsEstimationMode","getRegionFeatureDensityStats","region2","opts2","_regions","_formatType","draw","getChildFeatures","getHeightMultiplier","getSubfeatureMouseover","LayoutRow","setAllFilled","allFilled","getIntervals","getItemAt","oldLen","newData","intervalData","GranularRectLayout","pitchX","pitchY","hardRowLimit","bitmap","pTotalHeight","startingRow","storedRec","pLeft","trunc","pRight","pHeight","rectangle","maxTop","outer","maxY","yEnd","hasSeen","getByCoord","pY","pX","getByID","getSerializableDataByID","y1","y2","added","full","raw","pre","linkify","escapeHTML","dompurify","sanitize","addHook","tagName","setAttribute","time","iters","createStopToken","createObjectURL","Blob","isSharedArrayBuffer","SharedArrayBuffer","Atomics","store","Int32Array","revokeObjectURL","WorkerGlobalScope","xhr","XMLHttpRequest","send","backoff","checkInterval","checkIters","forEachWithStopTokenCheck","durationMs","isFeature","isSimpleFeatureSerialized","parentHandle","aliases","parentId","isImageBitmap","drawImageOntoCanvasContext","context","serializedCommands","createCanvas","OffscreenCanvas","nodeCreateCanvas","createImageBitmap","transferToImageBitmap","dataUri","toDataURL","img","nodeImage","onload","onerror","src","COORD_REGEX","ASSEMBLY_REGEX","parseLocStringOneBased","locString","assemblyMatch","lastColonIdx","lastIndexOf","suffix","prefixValid","locationValid","coords","startStr","endStr","trailing","parseCoords","parsed","BlockSet","iterator","lastBlock","getBlocks","toRegion","func","thisarg","total","BaseBlock","assign","elidedBlockCount","otherBlock","getRowStr","facet","AutocompleteTextField","inputBoxVal","params","setInputValue","setCurrentSearch","inputRef","restInputProps","restParams","_InputProps","onBlur","placeholder","loaded","setLoaded","currentSearch","inputValue","searchOptions","setSearchOptions","debouncedSearch","useDebounce","coarseVisibleLocStrings","hasDisplayedRegions","isCurrent","cancelled","displayString","aggregateResults","BaseResult","getDeduplicatedResult","regionOptions","useMemo","RefSequenceResult","matchedAttribute","disableListWrap","disableClearable","freeSolo","includeInputInList","selectOnFocus","loading","onInputChange","_event","newInputValue","loadingText","selectedOption","getOptionDisabled","group","filterOptions","filtered","searchQuery","toLocaleLowerCase","matchedObject","getFiltered","renderInput","getOptionLabel","opt","INSERTION_TYPE","DELETION_TYPE","SKIP_TYPE","SOFTCLIP_TYPE","HARDCLIP_TYPE","INTERBASE_MASK","DELSKIP_MASK","MISMATCH_MAP","MISMATCH_REV_MAP","EmptyConfig","static","HEADER_OVERVIEW_HEIGHT","RESIZE_HANDLE_HEIGHT","INTER_REGION_PADDING_WIDTH","FlatQueue","clear","parentValue","pop","halfLen","peek","peekValue","shrink","ARRAY_TYPES","Int8Array","Uint8ClampedArray","Int16Array","Uint16Array","Float32Array","Float64Array","Flatbush","from","byteOffset","magic","versionAndType","version","ArrayType","nodeSize","numItems","ArrayBufferType","isNaN","numNodes","_levelBounds","IndexArrayType","arrayTypeIndex","nodesByteSize","BYTES_PER_ELEMENT","_boxes","_indices","_pos","minX","minY","_queue","boxes","finish","hilbertValues","scaleX","scaleY","offsetY","hilbert","indices","stack","insertionSort","pivot","swap","nodeIndex","nodeMinX","nodeMinY","nodeMaxX","nodeMaxY","x0","y0","filterFn","queue","upperBound","neighbors","maxResults","maxDistSquared","dx","dy","dist","arr","tempVal","tempIdx","tempA","tempB","tempC","tempD","dst","temp","B","i0","i1","CompositeMap","submaps","submap","CollapseIntronsDialog","BaseDisplay","BlockState","showTooltips","mouseoverExtraInformation","subfeatureIdUnderMouse","contextMenuFeature","blockType","renderDelay","_theme","svgLegendWidth","selectedFeatureId","featureWidgetType","featureMaps","getFeatureById","getFeatureOverlapping","getFeatureByID","floatingLabelData","addBlock","blockInstance","setCachedDisplay","deleteBlock","showWidget","addWidget","navToFeature","clearSelection","setSubfeatureIdUnderMouse","subfeatureId","setMouseoverExtraInformation","extra","setShowLegend","doReload","flow","topLevelFeatureId","rpcParentId","setContextMenuFeatureById","MenuOpenIcon","CenterFocusStrongIcon","ContentCopyIcon","CloseFullscreenIcon","renderBaseLinearDisplaySvg","isMinimized","newKeys","makeAbortableReaction","dataFunction","asyncReactionFunction","reactionOptions","startedFunction","successFunction","errorFunction","inProgress","handleError","mobxReactionHandle","modificationData","o","getModificationName","dedupe","list","hasher","clone","lookup","hashed","subDisplay","statusMessage","parentDisplay","parentType","viewMenuActions","setRpcDriverName","__rpcResult","LayoutSession","update","makeLayout","cachedLayoutIsValid","layoutSessions","createLayoutSession","getLayoutId","getWorkerSession","maxFeatureGlyphExpansion","deserializeLayoutInClient","PrecomputedLayout","createLayoutInWorker","serializeLayout","resultLayout","FactoryResetDialog","onFactoryReset","handleDialogClose","ResetComponent","resetButtonText","dialogOpen","setDialogOpen","FatalErrorDialog","componentStack","rightRoundedRect","leftTriangle","_y","rightTriangle","colorMap","gneg","gpos25","gpos33","gpos50","gpos66","gpos100","gpos75","gvar","stalk","acen","cytobands","getCytobands","lcap","rcap","centromereSeen","w","createCssAndCx","cache","css","serializeStyles","registered","insertStyles","matchCSSObject","increaseSpecificityToTakePrecedenceOverMediaQueries","saveClassNameCSSObjectMapping","feat27FixedClassnames","fixClassName","registeredStyles","rawClassName","getRegisteredStyles","cssObjectMapByCache","cssObject","cssObjectMap","classNameCSSObjects","isThereAnyMediaQueriesInPreviousClasses","out","fix","classNameOrCSSObject","useContextualCache","__unsafe_useEmotionCache","useCssAndCx","useCache","createUseCssAndCx","cssObjectByRuleNameOrGetCssObjectByRuleName","getCssObjectByRuleName","_params","muiStyleOverridesParams","cssObjectByRuleName","ruleName","propsClasses","propsClassesRef","typeofValue","getDependencyArrayRef","mergedClasses","classesFromUseStyles","classesOverrides","overrideKeys","mergeClasses","createMakeStyles","convertCodingSequenceToPeptides","cds","sequence","codonTable","stitch","protein","NoAssemblyRegion","setRefName","newRefName","LocalPathLocation","BlobLocation","UriLocationRaw","UriLocation","snapshotProcessor","postProcessor","FileLocation","preProcessor","AddConnectionWidgetF","minimumBlockWidth","volatileWidth","setBpPerPx","setVolatileWidth","displayedRegionsTotalPx","maxOffset","minOffset","calculateDynamicBlocks","calculateStaticBlocks","currBp","setFeatures","showAllRegions","zoomOut","zoomIn","newBpPerPx","minBpPerPx","maxBpPerPx","oldBpPerPx","scrollTo","newOffsetPx","centerAt","centerPx","scroll","oldOffsetPx","moveTo","getColors","forrest","gray","Logomark","viewBox","LogoFull","Text","trackAssemblyNamesCache","getTrackAssemblyNames","getConfAssemblyNames","trackAssemblyNames","thisNode","highestRpcSessionId","isRoot","rpcSessionId","currentNode","UNKNOWN","blobMap","getBlobMap","setBlobMap","counter","storeBlobLocation","makeIndex","makeIndexType","typeA","typeB","_file","_index","_adapterHint","adapterGuesser","_adapterName","generateUnsupportedTrackConf","trackUrl","categories","objectHash","generateUnknownTrackConf","assemblies","showTrackGeneric","initialSnapshot","displayInitialSnapshot","getTracksById","supportedDisplays","displayConf","displayType","hideTrackGeneric","remove","toggleTrackGeneric","hashCode","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","namedColorToHex","isNamedColor","contrastingTextColor","getLuminance","convertedColor","muiGetLuminance","emphasize","coefficient","muiEmphasize","makeContrasting","foreground","minContrastRatio","convertedForeground","convertedBackground","backgroundLuminance","contrastRatio","getContrastRatio","originalColor","darken","lighten","borderRadius","shape","common","fontFamily","wordWrap","BaseTooltip","clientPoint","clientPointCoords","popperTheme","MuiPopper","refs","floatingStyles","useFloating","strategy","middleware","useClientPoint","getFloatingProps","useInteractions","setFloating","visibility","r0","r0len","groups","groupBy","r0Start","invBpPerPx","fstart","fend","endX","mapObjectSkip","isObject","isObjectCustom","WeakSet","globalThis","$$typeof","asymmetricMatch","_mapObject","object","mapper","isSeen","deep","includeSymbols","processOptions","mapArray","getEnumerableKeys","getOwnPropertySymbols","symbol","enumerable","mapResult","newKey","newValue","shouldRecurse","augmentLocationObjects","serializeNewAuthArguments","_rpcDriverClassName","account","supportsDirectExecution","serializeReturn","originalReturn","retryAccount","createEphemeralInternetAccount","origin","internetAccounts","uris","mapperWithRoot","mapObject","invertedSetting","setInverted","wiggleBaseTrackMenuItems","wiggleOnlyTrackMenuItems","PaletteIcon","overlay","FixedLabel","isOverlay","labelClass","overlayClass","FloatingLabel","fixedLabels","labelData","featureVisualBottom","floatingLabel","relativeY","textWidth","labelKey","onMouseOver","FloatingLabels","stringifyBED","fields","field","coreFields","blank","retitle","fmt","formatTags","relativeStart","relativeEnd","formatCDS","formatFeatWithSubfeatures","locstrand","formatFeat","sansCDS","newParentId","newParentType","newParentStrand","stringifyGBK","l1","contig","fetchSequence","alias","gap","derives_from","note","dbxref","ontology_term","is_circular","formatAttributes","attributes","formattedVal","formatMultiLevelFeat","parentRef","featureRefName","stringifyGFF3","SaveTrackDataDlg","getDisplayConf","baseTrackConfig","canConfigure","sessionTracks","showDisplay","hideDisplay","displaysToRemove","replaceDisplay","oldDisplayId","newDisplayId","gff3","genbank","bed","shownId","compatDisp","compatTypes","getCompatibleDisplays","Save","getPortableSettings","getUniqueModifications","orientation","fg","isLeft","range0","range1","textAnchor","strokeWidth","stroke","isFinite","paintOrder","LazyConfigurationEditorComponent","implicitIdentifier","useNameOverride","refNameColumn","refNameColumnHeaderName","ConfigurationPlugin","FromConfigAdapterF","FromConfigRegionsAdapterF","FromConfigSequenceAdapterF","RefNameAliasAdapterF","setTarget","newTarget","snapshot","updateTrackConf","ConfigurationEditorWidgetF","NcbiSequenceReportAliasAdapterF","isSequenceAdapter","isRefNameAliasAdapter","isTextSearchAdapter","relevance","getRenderingComponent","getTrackId","getScore","updateScore","newScore","getLocation","getComboResults","findNonSparseKeys","matches","queryLower","findSubCategories","paths","hasSubs","findTopLevelCategories","nonMetadataKeys","filterTracks","viewAssemblyNames","getCanonicalAssemblyName","notEmpty","viewDisplaysSet","trackConfigAssemblyNames","trackCanonicalAssemblyNames","trackSelectorAnyOverlap","s1","hasAnyOverlap","hasAllOverlap","generateHierarchy","trackConfs","noCategories","hierarchy","activeSortTrackNames","activeSortCategories","leafCounts","categoryMaps","sortNames","sortCategories","localeCompare","sortConfs","isSessionTrack","baseCategories","currLevel","nestingLevel","categoryPath","category_","categoryMap","leafCount","keyConfigPostFix","getItemHeight","recentlyUsedK","favoritesK","collapsedK","localStorageGetJSON","localStorageSetJSON","stateTreeFactory","faceted","showSparse","showFilters","showOptions","panelWidth","visible","useShoppingCart","observable","setFilter","setPanelWidth","setUseShoppingCart","setShowSparse","setShowOptions","setShowFilters","setVisible","allTrackConfigurations","filteredNonMetadataKeys","metadataKeys","getRootKeys","filteredMetadataKeys","filteredRows","arrFilters","favorites","recentlyUsed","sortTrackNames","collapsed","recentlyUsedCounter","favoritesCounter","shownTrackIds","selectionSet","favoritesSet","recentlyUsedSet","setSortTrackNames","setSortCategories","addToSelection","removeFromSelection","addToFavorites","removeFromFavorites","clearFavorites","setRecentlyUsedCounter","setRecentlyUsed","setFavorites","setFavoritesCounter","addToRecentlyUsed","clearRecentlyUsed","setView","toggleCategory","pathName","setCategoryCollapsed","expandAllCategories","setCollapsedCategories","isSelected","isFavorite","isRecentlyUsed","getRefSeqTrackConf","configAndSessionTrackConfigurations","connectionInstances","allTrackConfigurationTrackIdSet","favoriteTracks","recentlyUsedTracks","allTracks","flattenedItems","flatten","flattenedItemOffsets","offsets","cumulativeHeight","itemOffsets","startIndex","endIndex","findIndexAtOffset","targetHeight","overscan","collapseSubCategories","path","collapseTopLevelCategories","trackGroups","hasAnySubcategories","lc","elision","displayedRegionLeftPx","windowLeftPx","windowRightPx","displayedRegionRightPx","regionWidthPx","isRightEndOfDisplayedRegion","blockData","assembleLocStringFast","f2","REFERENCE_COLOR","NO_CALL_COLOR","UNPHASED_COLOR","ALT_COLOR_HUE","ALT_COLOR_SATURATION","OTHER_ALT_COLOR","getAltColorForDosage","dosage","filename","setLocation","needToReload","fullWidth","hidden","files","webUtils","require","getPathForFile","flexDirection","alignItems","LocationInput","toggleButtonValue","selectedAccount","inline","UrlChooser","LocalFileChooser","shorten","ToggleButtonWithTooltip","HiddenAccountsMenu","hiddenAccountIds","accountMap","SourceTypeSelector","shownAccountIds","onHiddenAccountSelect","accountName","ArrowDropDownIcon","exclusive","id_0","setToggleButtonValue","getInitialToggleValue","accounts","a_0","sortedIds","useInternetAccounts","setLocationWithAccount","selectSourceType","ellipses","textOverflow","bpSoFar","lengthBetween","numBlocksWideEnough","targetBpPerPx","extraBp","bpToStart","scrollPos","bp","interRegionPaddingBp","currBlock","paddingStart","nextR","renderToAbstractCanvas","highResolutionScaling","safeWidth","safeHeight","rasterizeLayers","blobToDataURL","convertToBlob","fakeCtx","navToLocString","allRefs","allRefNamesWithLowerCase","lastIndex","splitLast","checkRef","searchType","textSearchResults","refNameResults","allRefNames","FileReader","readAsDataURL","ExternalLink","OpenInNewIcon","legend","marginBottom","colorBox","closeButton","errorBox","DialogError","MUIDialog","ThemeProvider","getTagAlt","alt","F1R2","F2R1","F1F2","F2F1","R1R2","R2R1","R1F2","R2F1","rf","ff","LR","LL","RR","RL","originalRefName","createAutorun","getColorForModification","inputBase","inputRoot","inputFocused","borderStyle","borderWidth","setValue","ref2","editedValue","setEditedValue","inputNode","setInputNode","focused","blur","inputProps","onKeyDown","_stopToken","dots","animation","indexData","buildIndex","_data","_left","_right","typeModels","stringArray","stringArrayMap","numberMap","_str","integer","fileLocation","fallbackDefaults","literalJSON","valueJSON","objectJSON","typeModelExtensions","removeAtIndex","setAtIndex","addToKey","ar","removeAtKeyIndex","setAtKeyIndex","JexlStringType","ConfigSlot","configSlotModelName","newVal","reset","convertToCallback","convertToValue","funcResult","completeModel","isEmptyObject","isEmptyArray","modelName","inputSchemaDefinition","inputOptions","schemaDefinition","jbrowseSchemaDefinition","jbrowseSchemaOptions","preprocessConfigurationSchemaArguments","schemaType","modelDefinition","volatileConstants","isJBrowseConfigurationSchema","jbrowseSchema","slotDefinition","setSubschema","newSchema","identifierDefault","modelDefault","defaultSnap","newSnap","matchesDefault","makeConfigurationSchemaModel","trackRef","reference","resolveIdentifier","getRoot","dispatcher","TrackConfigurationReference","displayRef","DisplayConfigurationReference","_arg","addTrackConfs","setTrackConfs","modelWidth","windowLeftBp","windowRightBp","blockSizePx","blockSizeBp","invBlockSizeBp","regionBpOffset","regionBlockCount","windowRightBlockNum","windowLeftBlockNum","blockNum","componentDidCatch","errorInfo","setState","subfeats","getItemId","filterSuccessiveElementsWithSameStartAndEndCoord","ary","revlist","seqlen","calculateUTRs","exons","firstCds","lastCds","firstCdsIdx","exon","lastCdsIdx","lastCdsExon","firstCdsExon","calculateUTRs2","parentFeat","slug","replaceUndefinedWithNull","currentDepth","returnObj","maybeDisplayName","HierarchicalTrackSelectorWidgetF","showSoftClip","done","setDone","featureCanvas","findSubMenu","LinearFeatureDisplayModelFactory","trackGeneGlyphMode","trackSubfeatureLabels","trackDisplayDirectionalChevrons","geneGlyphMode","subfeatureLabels","displayDirectionalChevrons","setGeneGlyphMode","setSubfeatureLabels","toggleDisplayDirectionalChevrons","showMenu","filtersMenu","geneFilter","currentFilters","RegionWidthEditorDialog","slider","ValueLabelComponent","enterTouchDelay","HeaderZoomControls","effectiveBpPerPx","zoomInDisabled","zoomOutDisabled","zoom","ZoomOut","onChangeCommitted","valueLabelDisplay","valueLabelFormat","slots","valueLabel","ZoomIn","MoreVert","panButton","HeaderPanControls","slide","ArrowBackIcon","ArrowForwardIcon","HeaderRegionWidth","effectiveTotalBpDisplayStr","toggleButton","HeaderTrackSelectorButton","activateTrackSelector","TrackSelectorIcon","toRgbString","borderLeft","borderRight","OverviewHighlight","OverviewRubberbandHoverTooltip","cytoband","OverviewRubberband","controlsRef","click","globalKeyDown","scalebarLabel","OverviewScalebarTickLabels","refNameColor","getRefNameColor","tickLabels","offsetLabel","tickLabel","labelIdx","scalebarBorder","scalebarContig","scalebarContigForward","backgroundRepeat","scalebarContigReverse","scalebarRefName","scalebarVisibleRegion","overviewSvg","OverviewBox","showCytobands","canDisplayCytobands","borderColor","Cytobands","VisibleRegionBox","scalebarColor","firstOverviewPx","lastOverviewPx","transparency","overviewVisibleRegions","OverviewScalebar","modWidth","OverviewScalebarPolygon","headerBar","headerForm","flexWrap","spacer","Controls","SearchBox","LinearGenomeViewHeader","hideHeader","hideHeaderOverview","focusedBackground","MiniControls","focusedViewId","ArrowDown","ReturnToImportFormDialog","SequenceSearchDialog","ExportSvgDialog","GetSequenceDialog","toLocaleRounded","rewriteOnClicks","holdOnClick","apply","SearchResultsDialog","hideNoTracksActive","trackSelectorType","showCytobandsSetting","colorByCDS","volatileError","coarseDynamicBlocks","coarseTotalBp","sessionSetting","assemblyDisplayNames","isSessionWithMultipleViews","Header","assembliesNotFound","assemblyErrors","assembliesInitialized","hasSomethingToShow","scalebarHeight","headerHeight","trackHeights","trackHeightsWithResizeHandles","includeAggregateIndexes","trackMap","getTrack","trackTypeActions","allActions","setShowTrackOutlines","setColorByCDS","setShowCytobands","pending","setHideHeader","setHideHeaderOverview","setHideNoTracksActive","setShowGridlines","addToHighlights","setHighlight","removeHighlight","centerAtOffset","searchResults","setNewView","horizontallyFlip","movingId","oldIndex","newIndex","toggleTrack","setTrackLabels","setting","setShowCenterLine","selector","getSelectedRegions","simView","center","totalPaddingPx","targetOffsetPx","showAllRegionsInAssembly","factor","setTargetBpPerPx","clearView","setInit","exportSvg","renderToSvg","saveAs","cancelLastAnimation","viewWidths","animate","cancelAnimation","springAnimate","intendedFactor","effectiveTarget","targetScaleFactor","canShowCytobands","anyCytobandsExist","FolderOpenIcon","PhotoCameraIcon","SyncAltIcon","LabelIcon","buildMenuItems","currentlyCalculatedStaticBlocks","currentBlockKeys","newBlocks","roundedDynamicBlocks","visibleLocStrings","coarseTotalBpDisplayStr","effectiveTotalBp","setCoarseDynamicBlocks","optAssemblyName","navToLocations","navToSearchString","navToLocation","parsedLocString","when","locations","navToMultiple","firstLocation","lastLocation","defaultAssemblyName","firstAssembly","firstRefName","firstRegion","lastAssembly","lastRefName","lastRegion","findLast","firstStart","firstEnd","lastStart","lastEnd","firstIndex","startDisplayedRegion","endDisplayedRegion","startOffset","endOffset","leftRef","rightRef","leftCoord","rightCoord","rangeString","ZoomInIcon","buildRubberBandMenuItems","centerLineInfo","clickOffset","buildRubberbandClickMenuItems","handler","metaKey","setupKeyboardHandler","tracklist","currentWidth","idsNotFound","nav","setupInitAutorun","setupCoarseDynamicBlocksAutorun","setupLocalStorageAutorun","doAfterAttach","LinearGenomeViewPlugin","ZoomControls","LinearGenomeView","BasicTrackF","LinearBasicDisplayF","LinearGenomeViewF","LinearBareDisplayF","addView","LaunchLinearGenomeViewF","appendToSubMenu","LineStyleIcon","calculateAlleleCounts","cacheSplit","alleleCounts","vals","genotype","calculateMinorAlleleFrequency","firstMax","secondMax","getMostFrequentAlt","mostFrequentAlt","altCount","genotypesCache","baseModelFactory","AlignmentFeatureDetailsF","qualToPhred","fromCharCode","stringifySAM","lines","register","sam","linearAlignmentsDisplay","bamLocation","indexType","BamAdapterF","cramLocation","craiLocation","CramAdapterF","GuessAlignmentsTypesF","indexName","htsgetBase","htsgetTrackId","HtsgetBamAdapterF","getLowerPanelDisplays","lowerPanel","PileupDisplay","snpCovHeight","userFeatureScreenDensity","lowerPanelType","LinearAlignmentsDisplayMixin","setSNPCoverageHeight","pileupWidth","snpCovWidth","pileupConf","sortedBy","coverageConf","setSNPCoverageDisplay","setPileupDisplay","setLowerPanelType","setConfig","colorBy","setColorScheme","setFilterBy","LinearAlignmentsDisplayF","pileupDisplay","snpCoverageDisplay","PileupRenderer","linearBasicDisplayConfigSchemaFactory","LinearPileupDisplayBlurb","supplementaryItem","unmappedMateItem","orientationItems","insertSizeItems","normalInsertItem","orientationLegendItems","insertSizeLegendItems","insertSizeAndOrientationLegendItems","getBaseItems","getReadDisplayLegendItems","visibleModifications","colorType","FilterByTagDialog","SetModificationThresholdDialog","getModificationsSubMenu","includeMethylation","modificationThreshold","modificationsReady","visibleModificationTypes","modifications","threshold","isolatedModification","twoColor","getModificationsMenuItem","getColorSchemeMenuItem","baseItems","modificationsItem","hasModificationsSupport","getFilterByMenuItem","FilterListIcon","getEditFiltersMenuItem","drawSingletons","setDrawSingletons","drawProperPairs","setDrawProperPairs","getMismatchDisplayMenuItem","hideMismatches","hideSmallIndels","hideLargeIndels","setHideMismatches","setHideSmallIndels","setHideLargeIndels","ColorByTagDialog","SetFeatureHeightDialog","SharedLinearPileupDisplayMixin","noSpacing","fadeLikelihood","colorBySetting","filterBySetting","hideSmallIndelsSetting","hideMismatchesSetting","hideLargeIndelsSetting","colorTagMap","tagsReady","autorunReady","setTagsReady","setFeatureHeight","setNoSpacing","colorScheme","updateColorTagMap","uniqueTag","colorPalette","totalKeys","featureWidget","copyFeatureToClipboard","featureHeightSetting","noSpacingSetting","renderReady","getPileupLegendItems","showSubMenuItems","viewName","adapterRenderProps","colorSchemeSubMenuItems","sharedDoAfterAttach","SharedModificationsMixin","simplexModifications","updateVisibleModifications","uniqueModifications","modification","setSimplexModifications","simplex","currentSet","setModificationsReady","SortByTagDialog","GroupByDialog","showSoftClipping","mismatchAlpha","sortReady","currSortBpPerPx","setCurrSortBpPerPx","setSortReady","clearSelected","toggleSoftClipping","toggleMismatchAlpha","setSortedBy","centerBp","setSortedByAtPosition","superRenderReady","mismatchAlphaSetting","superAdapterRenderProps","superColorSchemeSubMenuItems","superShowSubMenuItems","SwapVertIcon","ColorLensIcon","WorkspacesIcon","lineWidth","jitter","NonBlockCanvasDisplayMixin","lastDrawnOffsetPx","renderingImageData","renderingStopToken","drawn","setLastDrawnOffsetPx","setLoading","setRef","setRenderingImageData","setRenderingStopToken","msg","beforeDestroy","LinearReadDisplayBaseMixin","chainData","lastDrawnBpPerPx","setLastDrawnBpPerPx","setChainData","drawInter","drawLongRange","setDrawInter","setDrawLongRange","setLineWidth","setJitter","lineWidthSetting","jitterVal","doAfterAttachRPC","stateModelF","minSubfeatureWidth","featureLayout","mouseoverRef","featuresForFlatbush","mismatchLayout","mismatchItems","setFeatureLayout","setMouseoverRef","setFeaturesForFlatbush","setMismatchLayout","setMismatchItems","flipStrandLongReadChains","setFlipStrandLongReadChains","drawCloud","showYScalebar","showOutline","layoutHeight","dataTestId","cloudTicks","setLayoutHeight","setCloudMaxDistance","setShowYScalebar","show","setShowOutline","chain","syntheticFeature","firstFeat","next_pos","chainToSimpleFeature","setDrawCloud","setSelectedFeatureId","FilterArcsByScoreDialog","showInterbaseCounts","showInterbaseIndicators","showArcs","minArcScore","superAdapterProps","showArcsSetting","skipFeatures","skipFeaturesMap","showInterbaseCountsSetting","showInterbaseIndicatorsSetting","setShowInterbaseIndicators","setShowInterbaseCounts","setShowArcs","setMinArcScore","renderSNPCoverageSvg","subadapter","getSNPCoverageLegendItems","multiTicks","SNPCoverageRenderer","PileupBaseRPC","PileupGetGlobalValueForTag","featuresArray","getModTypes","mm","mods","modsLen","basemod","typesLen","PileupGetVisibleModifications","mmTag","minusStrandMods","detectSimplexModifications","modificationsForDisplay","PileupRPCMethodsF","PileupLayoutSession","maxClippingSize","featureNames","serializedLayout","rpcResult","orientationType","largeInsertionIndicatorScale","RenderLinearReadArcsDisplay","renamed","executeRenderLinearReadArcsDisplay","LinearReadArcsDisplayRPCMethodsF","RenderLinearReadCloudDisplay","executeRenderLinearReadCloudDisplay","LinearReadCloudDisplayRPCMethodsF","SNPCoverageAdapterF","deserialized","skipFeature","renderSNPCoverageToCanvas","indicatorThreshold","AlignmentsPlugin","LinearPileupDisplayF","LinearSNPCoverageDisplayF","AlignmentsTrackF","PileupRendererF","SNPCoverageRendererF","LinearReadArcsDisplayF","LinearReadCloudDisplayF","AlignmentsFeatureWidgetF","ArcRenderer","thickness","caption","displayModeSetting","superMenuItems","renderArcSvg","ArcPlugin","ArcRendererF","LinearArcDisplayF","LinearPairedArcDisplayF","attributeName","authEndpoint","tokenEndpoint","needsPKCE","clientId","scopes","responseType","OAuthConfigSchema","DropboxIcon","getResponseError","reason","statusText","getError","dropboxErrorMessages","shared_link_not_found","shared_link_access_denied","unsupported_link_type","shared_link_is_directory","getDescriptiveErrorMessage","fixup","buf","processError","invalidErrorCb","error_description","processTokenResponse","storeRefreshTokenCb","refresh_token","access_token","named","codeVerifier","codeVerifierPKCE","uint8array","output","btoa","encode","refreshTokenKey","storeRefreshToken","refreshToken","localStorage","removeRefreshToken","retrieveRefreshToken","exchangeAuthorizationForAccessToken","redirectUri","grant_type","client_id","redirect_uri","code_verifier","method","body","exchangeRefreshForAccessToken","listener","exchangedTokenPromise","addMessageChannel","finishOAuthWindow","deleteMessageChannel","redirectUriWithInfo","fixedQueryString","redirectUrl","queryStringSearch","urlParams","useEndpointForAuthorization","response_type","token_access_type","scope","code_challenge","sha256","generateChallenge","code_challenge_method","eventName","ipcRenderer","invoke","eventFromDesktop","MessageEvent","doUserFlow","newToken","superGetFetcher","baseModel","append","Authorization","validateWithHEAD","ExternalTokenEntryForm","setToken","required","doneCallback","GoogleDriveFile","statsPromise","metadataOnly","stat","GoogleDriveIcon","driveUrl","searchParams","credentials","HTTPBasicLoginForm","username","setUsername","password","setPassword","autoComplete","onSubmit","AuthenticationPlugin","OAuthInternetAccountModelFactory","ExternalTokenConfigSchema","ExternalTokenInternetAccountModelFactory","HTTPBasicConfigSchema","HTTPBasicInternetAccountModelFactory","DropboxOAuthConfigSchema","DropboxOAuthInternetAccountModelFactory","GoogleDriveOAuthConfigSchema","GoogleDriveOAuthInternetAccountModelFactory","bedLocation","columnNames","scoreColumn","autoSql","colRef","colStart","colEnd","bedGraphLocation","bedGraphGzLocation","bedGzLocation","bedpeLocation","bigBedLocation","aggregateField","BedPlugin","BigBedAdapterF","BedAdapterF","BedpeAdapterF","BedTabixAdapterF","BedGraphAdapterF","BedGraphTabixAdapterF","BedpeAdapter","BedGraphAdapter","BedGraphTabixAdapter","BreakpointGetFeatures","ALT","INFO","showIntraviewLinks","linkViews","interactiveOverlay","showHeader","matchedTrackFeatures","matchedTracks","getMatchedTracks","trackConfigId","hasTranslocations","getTrackFeatures","hasPairedFeatures","getMatchedFeaturesInLayout","addMiddleware","rawCall","next","rootId","syncActions","sourcePath","getPath","setInteractiveOverlay","setShowIntraviewLinks","setLinkViews","setShowHeader","setMatchedTrackFeatures","reverseViewOrder","setViews","viewInits","viewInit","LinkIcon","PhotoCamera","BreakpointSplitViewPlugin","BreakpointSplitViewF","BreakpointAlignmentsWidgetF","LaunchBreakpointSplitViewF","BreakpointGetFeaturesF","readCachedConfig","createCachedConfig","configSlot","UTR_REGEX","getEffectiveStrand","getStrandAwareX","pxPerBp","effectiveStrand","truncateLabel","maxLength","isOffScreen","canvasWidth","isUTR","getBoxColor","configContext","color1","color3","featureStrand","featurePhase","featureEnd","frame","getFrame","frameColor","getStrokeColor","color2","stripAlpha","createFeatureFloatingLabels","nameColor","descriptionColor","rawName","rawDescription","fontHeight","shouldShowLabel","shouldShowDescription","actualFontHeight","createTranscriptFloatingLabel","displayLabel","truncatedName","getStrandArrowPadding","visualSide","layoutChild","parentFeature","glyphType","heightPx","baseHeightPx","childStart","childEnd","parentStart","parentEnd","totalLayoutHeight","leftPadding","drawConnectingLine","centerY","strokeStyle","beginPath","lineTo","drawStrandArrowAtPosition","reverseFlip","arrowOffset","arrowX","arrowSize","closePath","drawStrandArrow","dc","drawSegmentedFeature","boxGlyph","cdsGlyph","halfSize","numChevrons","drawChevrons","childLayout","baseHeight","isTopLevel","arrowPadding","screenWidth","leftWithinBlock","widthWithinBlock","outline","strokeRect","shouldRenderPeptideBackground","peptideDataMap","peptideData","aggregatedAminoAcids","g2p","aggregated","currentElt","currentAminoAcid","aminoAcid","proteinIndex","aggregateAminos","genomeToTranscriptSeqMapping","prepareAminoAcidData","baseHex","aa","bgColor","rectLeft","rectWidth","drawCDSBackground","shouldRenderPeptideText","textBaseline","yCenter","isNonTriplet","fillText","drawPeptidesOnCDS","MATURE_PROTEIN_COLORS","MATURE_PROTEIN_TYPES","getMatureProteinChildren","matureProteinRegionGlyph","hasIndexableChildren","product","proteinId","parts","sortedChildren","aStart","bStart","boxHeight","sortedChild","arrowColor","drawMatureProteinBox","boxTop","getSubparts","hasUTRs","isTranscript","subparts","haveLeftUTR","haveRightUTR","codeStart","codeEnd","NEGATIVE_INFINITY","subpart","unshift","makeUTRs","subpartFilter","confKey","lowerRet","makeSubpartsFilter","processedTranscriptGlyph","transcriptTypes","childType","REPEAT_COLOR_MAP","CACTA_TIR_transposon","centromeric_repeat","Copia_LTR_retrotransposon","Gypsy_LTR_retrotransposon","hAT_TIR_transposon","helitron","knob","L1_LINE_retrotransposon","LINE_element","long_terminal_repeat","low_complexity","LTR_retrotransposon","Mutator_TIR_transposon","PIF_Harbinger_TIR_transposon","rDNA_intergenic_spacer_element","repeat_region","RTE_LINE_retrotransposon","subtelomere","target_site_duplication","Tc1_Mariner_TIR_transposon","repeatRegionGlyph","aType","bType","drawRepeatBox","origHeight","segmentsGlyph","containerTypes","hasNestedSubfeatures","applyLabelDimensions","isNested","isTranscriptChild","labelAllowed","effectiveShowLabels","effectiveShowDescriptions","shouldShowName","extraHeightPx","maxLabelWidthPx","childGlyphs","findChildGlyph","findGlyph","CODING_TYPES","hasCodingSubfeature","builtinGlyphs","featureBp","codingStatus","aHasCDS","bHasCDS","transcriptSubfeatures","candidates","codingCandidates","filterByGeneGlyphMode","currentYPx","isChildTranscript","childBp","xRelativePx","totalHeightPx","glyphs","findPluggableGlyph","glyph","layoutFeature","pluggableGlyph","heightMultiplier","layoutArgs","glyphMap","drawFeature","drawContext","topLevel","createSubfeatureLabelMetadata","convertToCanvasCoords","canvasX","canvasY","buildChildrenIndex","subfeatureCoords","subfeatureInfos","labelColor","parentTooltip","addChildrenRecursive","isGene","matchingGlyph","builtinMatch","pluggableMatch","findMatchingGlyph","hasTranscriptChildren","showSubfeatureLabels","childFeature","bottomPx","glyphMouseover","buildFlatbush","fb","DEFAULT_TRANSCRIPT_TYPES","isTranscriptType","hasCDSSubfeatures","fetchTranscriptPeptides","seqAdapterRefName","extractCDSRegions","revcom","seqLen","sequenceData","generateCodonTable","defaultCodonTable","doAll","createRenderConfigContext","layoutRecords","layoutStart","layoutEnd","subfeature","findTranscriptsWithCDS","fetchPeptideData","record","recordTopPx","canvasLayout","startBp","endBp","CanvasFeatureRenderer","mouseover","subfeatureMouseover","labels","subParts","impliedUTRs","CanvasPlugin","configSchema2","CanvasFeatureRendererF","findCircleIntersectionX","cy","resultArray","solution","findCircleIntersectionY","cartesianToPolar","rho","theta","atan","PI","cartesianToTheta","twoPi","Slice","offsetRadians","radianWidth","bpPerRadian","flipped","startRadians","endRadians","widthBp","freeze","bpToXY","radiusPx","offsetBp","elided","totalRadians","polarToCartesian","defaultOffsetRadians","hideVerticalResizeHandle","hideTrackSelectorButton","lockedFitToWindow","disableImportForm","scrollX","scrollY","minimumRadiusPx","spacingPx","paddingPx","lockedPaddingPx","minVisibleWidth","visibleSection","viewSides","circleCenter","circleRadius","viewL","viewR","viewT","viewB","vertices","maxRho","reflect","rhoMin","rhoMax","thetaMin","thetaMax","vx","vy","viewportVisibleSection","centerXY","circumferencePx","elidedBp","elidedRegions","pxPerRadian","maximumRadiusPx","minCircumferencePx","maxCircumferencePx","atMaxBpPerPx","atMinBpPerPx","tooSmallToLock","figureDimensions","figureWidth","figureHeight","lastVisible","displayedRegion","showView","staticSlices","slices","currentRadianOffset","calculateStaticSlices","visibleStaticSlices","visibleThetaMin","visibleThetaMax","r1start","r2start","r2length","r1length","sliceIsVisible","newHeight","setModelViewWhenAdjust","resizeWidth","oldWidth","rotateClockwiseButton","rotateClockwise","rotateCounterClockwiseButton","rotateCounterClockwise","zoomInButton","zoomOutButton","secondCondition","previouslyEmpty","toggleFitToWindowLock","CircularViewPlugin","CircularViewF","LaunchCircularViewF","DataUsageIcon","targetAssembly","queryAssembly","blastTableLocation","columns","chainLocation","syntenyTypes","pairwiseTypes","mcscanTypes","ComparativeAddTrackComponent","deltaLocation","MCScanAddTrackComponent","mcscanAnchorsLocation","bed1Location","bed2Location","bed1","bed2","mcscanSimpleAnchorsLocation","outLocation","pafLocation","pifGzLocation","ComparativeAdaptersPlugin","PAFAdapterF","PairwiseIndexedPAFAdapterF","DeltaAdapterF","ChainAdapterF","MCScanAnchorsAdapterF","MCScanSimpleAnchorsAdapterF","MashMapAdapterF","BlastTabularAdapter","comp","ComparativeAddTrackComponentF","MCScanAddTrackComponentF","ComparativeRender","rend","getRenderer","Dotplot1DView","box","contentPx","viewWidth","DotplotHView","DotplotVView","viewHeight","DiagonalizeDotplotRpc","dimensions","targetView","hview","vview","alignments","queryRefName","refRefName","queryStart","queryEnd","refStart","refEnd","currentRegions","progressCallback","updateProgress","progress","queryGroups","targetRefName","refAlignments","strandWeightedSum","alnLength","refData","direction","queryOrdering","bestRefName","maxBases","bestPositions","firstViewRefName","bestRefPos","shouldReverse","newQueryRegions","regionsReversed","regionsWithoutAlignments","nr","newRegions","totalAlignments","regionsProcessed","regionsReordered","diagonalizeRegions","LoadingMessage","BlockMessage","messageText","BlockError","ServerSideRenderedDotplotContent","shouldDisplay","renderBlockData","borderSize","borderX","borderY","minAlignmentLength","warnings","ReactComponent2","ServerSideRenderedBlockContent","bpPerPxY","bpPerPxX","offX","offY","renderBlockEffect","fireImmediately","setRendered","setMessage","setAlpha","setMinAlignmentLength","setColorBy","MismatchParser","DotplotRenderer","process","serializable","drawDotplot","thresholdsPalette","thresholds","stringLenPx","pxWidthForBlocks","hide","DotplotPlugin","tickSize","vtextRotation","htextRotation","drawCigar","viewTrackConfigs","cursorMode","showPanButtons","wheelMode","importFormSyntenyTrackSelections","importFormRemoveRow","clearImportFormSyntenyTracks","setImportFormSyntenyTrack","hticks","vticks","setShowPanButtons","setWheelMode","setCursorMode","setDrawCigar","setBorderX","setBorderY","setAssemblyNames","getCoords","mousedown","mouseup","xmin","xmax","minmax","ymin","ymax","zoomInToMouseCoords","calculateBorders","vblocks","hblocks","hoffset","voffset","vhide","hhide","by","bx","initializeDisplayedRegions","onDotplotView","d1","d2","_unused1","rest1","_unused2","rest2","viewSnapshot","removeTemporaryAssembly","squareView","avg","hpx","vpx","squareViewProportional","ratio","DotplotViewF","DotplotRendererF","LaunchDotplotViewF","pluggableElement","newStateModel","superContextMenuItems","readAssembly","trackAssembly","SA2","totalLength","gatherOverlaps","DotplotReadVsRefMenuItem","ComparativeRenderer","TimelineIcon","EditGCContentParamsDialog","SharedModelF","windowSize","windowDelta","setGCContentParams","windowSizeSetting","windowDeltaSetting","LazyWiggleDisplayComponent","GCContentPlugin","GCContentAdapterF","configSchemaFactory1","stateModelF1","configSchemaFactory2","stateModelF2","LinearGCContentDisplayF","gffLocation","gffGzLocation","dontRedispatch","GFF3Plugin","Gff3TabixAdapterF","Gff3AdapterF","GuessGff3F","bookmarkButton","bookmarkHighlightsVisible","bookmarkLabelsVisible","bookmarkWidget","widgets","bookmarks","bookmark","Fragment","setBookmarkHighlightsVisible","removeBookmarkObject","BookmarkIcon","sx","rev","LabeledRegionModel","RegionModel","setLabel","SharedBookmarksModel","sharedBookmarks","localStorageKeyF","GridBookmarkPlugin","selectedBookmarks","selectedAssembliesPre","bookmarkAssemblies","validAssemblies","areBookmarksHighlightedOnAllOpenViews","areBookmarksHighlightLabelsOnAllOpenViews","bookmarksWithValidAssemblies","sharedBookmarksModel","allBookmarksModel","setSelectedAssemblies","selectedAssemblies","importBookmarks","addBookmark","removeBookmark","updateBookmarkLabel","correspondingObj","updateBookmarkHighlight","updateBulkBookmarkHighlights","setSelectedBookmarks","setBookmarkedRegions","setBookmarkLabelsVisible","clearAllBookmarks","clearSelectedBookmarks","AddHighlightModelF","GridBookmarkWidgetF","activateBookmarkWidget","navigateNewestBookmark","bookmarkCurrentRegion","selectedRegions","superRubberBandMenuItems","BookmarksIcon","HighlightIcon","keydownListener","activationSequence","appendToMenu","gtfLocation","GtfPlugin","GtfAdapterF","hicLocation","HicRenderer","useLogScale","totalWidthBp","hyp","yScalar","getMultiRegionContactRecords","activeNormalization","availableNormalizations","flatbushItems","normalization","displayMax","toLocaleString","setFlatbushData","setUseLogScale","setActiveNormalization","setAvailableNormalizations","norm","HicPlugin","HicAdapterF","HicRendererF","HicTrackF","LinearHicDisplayF","toHsl","Job","progressPct","cancelCallback","setCancelCallback","setProgressPct","pct","JobsManagementPlugin","jobs","finished","queued","addJob","job","addedJob","removeJob","jobName","addFinishedJob","finishedJob","addQueuedJob","queuedJob","addAbortedJob","abortedJob","removeQueuedJob","updateJobStatusMessage","updateJobProgressPct","JobsListWidgetF","Indexing","jobStatusWidget","dataDirLocation","fetchJb1","convertTrackConfig","jb2Tracks","jb1Track","dataRoot","breakConnection","namesIndexLocation","rootUrlTemplate","refNames","LegacyJBrowsePlugin","NCListAdapterF","GuessNCListF","JBrowse1TextSearchAdapterF","JBrowse1ConnectionF","LaunchSyntenyViewDialog","setLoadingStatus","renderInProgress","loadingStatus","newStopToken","existingFeatures","featIds","newFeatIds","foundNewFeatureNotInExistingMap","foundExistingFeatureNotInNewMap","existingFeat","LinearSyntenyViewHelper","showDynamicControls","levels","isLoading","setIsLoading","removeView","setLevelHeight","setShowDynamicControls","average","headerMenuItems","ReadVsRefDialog","mainCanvas","clickMapCanvas","cigarClickMapCanvas","mouseoverCanvas","featPositions","mouseoverId","clickId","cigarMouseoverId","setFeatPositions","setMainCanvasRef","setClickMapCanvasRef","setCigarClickMapCanvasRef","setMouseoverCanvasRef","setMouseoverId","setCigarMouseoverId","setClickId","numFeats","ready","featMap","colorSchemeConfig","colorMapWithAlpha","activeColorMap","posColorWithAlpha","negColorWithAlpha","queryColorWithAlphaMap","queryTotalLengths","lengths","alignmentLength","currentTotal","Curves","DiagonalizationProgressDialog","drawCIGAR","drawCIGARMatchesOnly","drawCurves","drawLocationMarkers","setDrawCurves","setDrawCIGAR","setDrawCIGARMatchesOnly","setDrawLocationMarkers","superHeaderMenuItems","CropFreeIcon","ShuffleIcon","linearSyntenyViewHelperModelFactory","UnusedComponent","BaseFeatureWidgetStateModelF","LinearComparativeViewPlugin","LinearSyntenyViewHelperF","LinearComparativeViewF","LinearSyntenyViewF","LinearComparativeDisplayF","middle","baseConfigFactory","LinearSyntenyDisplayF","SyntenyFeatureWidgetF","l1name","l2name","linearPileupDisplayConfigSchemaFactory","schema","r3","LGVSyntenyDisplayF","flatTracks","LaunchLinearSyntenyViewF","SyntenyTrackF","CalendarIcon","LollipopRenderer","innerColor","minStickLength","stickColor","stickWidth","LollipopPlugin","LollipopRendererF","LinearLollipopDisplayF","MenusPlugin","AboutWidgetF","HelpWidgetF","ImportSessionWidgetF","SessionManagerF","InfoIcon","widget","endpoint","queryTemplate","refNamesQueryTemplate","additionalQueryParams","RdfPlugin","SPARQLAdapterF","fastaLocation","faiLocation","metadataLocation","gziLocation","chromSizesLocation","DivSequenceRenderer","divSequenceRendererConfigSchema","stringifyFASTA","searchForward","searchReverse","caseInsensitive","twoBitLocation","chromSizes","rewriteRefNames","SequencePlugin","DivSequenceRendererF","TwoBitAdapterF","BgzipFastaAdapterF","ChromSizesAdapterF","IndexedFastaAdapterF","UnindexedFastaAdapterF","SequenceSearchAdapterF","sequenceType","createReferenceSeqTrackConfig","fasta","ReferenceSequenceTrackF","showForward","showReverse","showTranslation","showForwardActual","showReverseActual","showTranslationActual","sequenceHeight","toggleShowForward","toggleShowReverse","toggleShowTranslation","LinearReferenceSequenceDisplayF","createExtensionPoints","fileTypes","fileTypeParsers","VCF","parseVcfBuffer","BED","parseBedBuffer","BEDPE","parseBedPEBuffer","STAR-Fusion","parseSTARFusionBuffer","adapterTypeMap","VcfAdapter","fileType","locationKey","VcfTabixAdapter","BedAdapter","BedTabixAdapter","fileTypesRegexp","locationLinkClick","spreadsheetViewId","newViewId","BreakpointSplitViewChoiceDialog","FeatureMenu","stableViewId","LocationCell","ImportWizardModel","hasColumnNameLine","columnNameLineNumber","selectedAssemblyName","cachedFileLocation","fileSource","isReadyToOpen","requiresUnzip","tracksForAssembly","selectedAssembly","getAdapterInfo","categoryStr","setSelectedAssemblyName","setFileSource","newSource","firstMatch","setColumnNameLineNumber","newnumber","setFileType","cancelButton","setCachedFileHandle","import","typeParser","fetchAndMaybeUnzip","filehandle","displaySpreadsheet","hideFilterControls","importWizard","spreadsheet","rowSet","visibleColumns","visibleRowFlags","cellData","cells","dataGridColumns","measureGridWidth","renderCell","valueGetter","_val","valueFormatter","visibleRows","_f","setVisibleRows","setVisibleColumns","isDerived","extendedData","vcfFeature","rowMenuItems","setRowMenuItems","newItems","exts","ext","spreadsheetRest","SpreadsheetViewPlugin","SpreadsheetViewF","LaunchSpreadsheetViewF","ViewComfyIcon","defaultOnChordClick","chordTrack","SvInspectorViewPlugin","SpreadsheetViewType","CircularViewType","SpreadsheetModel","CircularModel","onlyDisplayRelevantRegionsInCircularView","spreadsheetView","circularView","SpreadsheetViewReactComponent","CircularViewReactComponent","circularViewOptionsBarHeight","showCircularView","featuresAdapterConfigSnapshot","featureRefNames","CHR2","currentAssembly","canonicalFeatureRefNameSet","featuresCircularTrackConfiguration","onChordClick","setOnlyDisplayRelevantRegionsInCircularView","spreadsheetWidth","circularViewWidth","generatedTrackConf","SvInspectorViewF","LaunchSvInspectorViewF","TableChartIcon","ixFilePath","ixxFilePath","metaFilePath","TrixPlugin","bezierRadiusRatio","refNameMap","origSlices","bezierRadius","renderStarted","renderSuccess","renderError","setRefNameMap","getRefNameMapForAdapter","linearFeatureDisplayModelFactory","mapChildren","objectChildren","childs","Node","nodes","eachBefore","computeHeight","copyData","defaultSeparation","meanXReduce","maxYReduce","eachAfter","each","that","compare","ancestor","aNodes","ancestors","bNodes","leastCommonAncestor","descendants","leaves","links","MAFFilterDialog","ClusterDialog","SetRowHeightDialog","MultiVariantBaseModelF","linearBareDisplayStateModelFactory","showSidebarLabelsSetting","showTree","rowHeightMode","MAX_SAFE_INTEGER","referenceDrawingMode","clusterTree","treeAreaWidth","lineZoneHeight","simplifiedFeaturesStopToken","featuresVolatile","hasPhased","hoveredGenotype","hoveredTreeNode","treeCanvas","setRowHeight","setHoveredGenotype","setHoveredTreeNode","setTreeCanvasRef","setTreeAreaWidth","clearTree","orderChanged","setClusterTree","tree","setSimplifiedFeaturesLoading","setMafFilter","setShowSidebarLabels","setShowTree","setPhasedMode","setAutoHeight","auto","setHasPhased","setSampleInfo","setReferenceDrawingMode","autoHeight","newick","fromNewick","ascending","availableHeight","nrow","clust","separation","cluster","previousNode","meanX","leafLeft","leafRight","arguments","HeightIcon","SplitscreenIcon","CategoryIcon","canDisplayLabels","featuresReady","maxAltAlleles","setupMultiVariantAutoruns","setLineZoneHeight","LinearVariantMatrixRenderer","canvasHeight","simplifiedFeatures","origScrollTop","MultiVariantRenderer","vcfGzLocationMap","indexLocationMap","samplesTsvLocation","strokeColorSelected","strokeColorHover","MultiVariantClusterGenotypeMatrix","executeClusterGenotypeMatrix","MultiVariantGetGenotypeMatrix","MultiVariantGetSimplifiedFeatures","rawFeatures","samp","isPhased","MultiVariantGetSources","stringifyVCF","generateINFO","vcfLocation","vcfGzLocation","VariantsPlugin","VcfAdapterF","VcfTabixAdapterF","SplitVcfTabixAdapterF","VariantFeatureWidgetF","vcf","ExtensionPointsF","linearFeatureDisplayConfigSchemaFactory","LinearBasicDisplayComponent","LinearVariantDisplayF","LinearVariantMatrixDisplayF","MultiVariantRendererConfigSchema","MultiLinearVariantDisplayF","MultiVariantRendererF","MultiLinearVariantMatrixRenderer","LinearVariantMatrixRendererF","ChordRendererType","StructuralVariantChordRendererF","ChordVariantDisplayF","Canvas","Alignments","Authentication","Bed","CircularView","Config","DataManagement","DotplotView","Gff3","LegacyJBrowse","LinearComparativeView","Lollipop","Menus","RDF","Sequence","Variants","Wiggle","GCContent","SvInspectorPlugin","BreakpointSplitView","ComparativeAdapters","Arc","lastSwapY","opacity","LoadingOverlay","BlockErrorMessage","reloadFlag","blockStatusMessage","isRenderingPending","cachedDisplay","stopCurrentToken","clearRenderState","getContainingDisplay","optDisplay","regionAsm","hasName","getSeqAdapterRefName","displayError"],"ignoreList":[],"sourceRoot":""}