"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[3526],{3526:(e,n,t)=>{t.r(n),t.d(n,{default:()=>V});var o=t(67758),l=t(7552),s=t(67112),r=t(66395),c=t(99546),i=t(53435),a=t(75785),d=t(69500);const u=(0,a.n9)()({cell:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}});function m(e){const n=(0,o.c)(34),{rows:t,onChange:a,setSelected:m}=e,{classes:f}=u();let x,p;if(n[0]!==t[0]){const{id:e,name:o,label:l,color:s,baseUri:r,HP:c,...i}=t[0];x=i,n[0]=t[0],n[1]=x}else x=n[1];n[2]===Symbol.for("react.memo_cache_sentinel")?(p={idx:0,field:null},n[2]=p):p=n[2];const[j,g]=(0,l.useState)(p);let b,C,w,S,v,y,A,k,_,M,T;return n[3]===Symbol.for("react.memo_cache_sentinel")?(b={height:400,width:"100%"},n[3]=b):b=n[3],n[4]!==m?(C=e=>{m([...e.ids])},n[4]=m,n[5]=C):C=n[5],n[6]!==a||n[7]!==t?(w={field:"color",headerName:"Color",renderCell:e=>{const{value:n,id:o}=e;return(0,d.jsx)(r.Ay,{color:n||"blue",onChange:e=>{const n=t.find(e=>e.name===o);n&&(n.color=e),a([...t])}})}},n[6]=a,n[7]=t,n[8]=w):w=n[8],n[9]!==t?(S=(0,c.measureGridWidth)(t.map(h)),n[9]=t,n[10]=S):S=n[10],n[11]!==S?(v={field:"label",headerName:"Name",width:S},n[11]=S,n[12]=v):v=n[12],n[13]!==x?(y=Object.keys(x),n[13]=x,n[14]=y):y=n[14],n[15]!==f||n[16]!==t||n[17]!==y?(A=y.map(e=>({field:e,renderCell:e=>{const{value:n}=e;return(0,d.jsx)("div",{className:f.cell,children:(0,d.jsx)(s.SanitizedHTML,{html:(0,c.getStr)(n)})})},width:(0,c.measureGridWidth)(t.map(n=>`${n[e]}`))})),n[15]=f,n[16]=t,n[17]=y,n[18]=A):A=n[18],n[19]!==w||n[20]!==v||n[21]!==A?(k=[w,v,...A],n[19]=w,n[20]=v,n[21]=A,n[22]=k):k=n[22],n[23]===Symbol.for("react.memo_cache_sentinel")?(_=[],n[23]=_):_=n[23],n[24]!==j.field||n[25]!==j.idx||n[26]!==a||n[27]!==t?(M=e=>{const n=e[0],o=(j.idx+1)%2,l=n.field||j.field;g({idx:o,field:l}),a(l?[...t].sort((e,n)=>{const t=(0,c.getStr)(e[l]),s=(0,c.getStr)(n[l]);return 1===o?t.localeCompare(s):s.localeCompare(t)}):t)},n[24]=j.field,n[25]=j.idx,n[26]=a,n[27]=t,n[28]=M):M=n[28],n[29]!==t||n[30]!==M||n[31]!==C||n[32]!==k?(T=(0,d.jsx)("div",{style:b,children:(0,d.jsx)(i.z,{checkboxSelection:!0,disableRowSelectionOnClick:!0,onRowSelectionModelChange:C,rows:t,rowHeight:25,columnHeaderHeight:33,columns:k,sortModel:_,onSortModelChange:M})}),n[29]=t,n[30]=M,n[31]=C,n[32]=k,n[33]=T):T=n[33],T}function h(e){return e.label}var f=t(5986),x=t(85179),p=t(85161),j=t(11496),g=t(69092);function b(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>e-n);let l=0;for(const n of o){const o=Math.max(l,n-t);o>=l&&e.splice(o,0,e.splice(n,1)[0]),l+=1}return e}function C(e,n,t=1){const o=n.map(n=>e.findIndex(e=>e.name===n)).sort((e,n)=>n-e);let l=e.length-1;for(const n of o){const o=Math.min(l,n+t);o<=l&&e.splice(o,0,e.splice(n,1)[0]),l-=1}return e}function w(e){const n=(0,o.c)(55),{selected:t,onChange:s,rows:c,showTips:i}=e,[a,u]=(0,l.useState)(null),[m,h]=(0,l.useState)("blue"),w=!t.length;let S,v,y;n[0]===Symbol.for("react.memo_cache_sentinel")?(S=e=>{u(e.currentTarget)},n[0]=S):S=n[0],n[1]!==w?(v=(0,d.jsx)(g.A,{disabled:w,onClick:S,children:"Change color of selected items"}),n[1]=w,n[2]=v):v=n[2],n[3]!==s||n[4]!==c||n[5]!==t?(y=()=>{s(b([...c],t))},n[3]=s,n[4]=c,n[5]=t,n[6]=y):y=n[6];const A=!t.length;let k;n[7]===Symbol.for("react.memo_cache_sentinel")?(k=(0,d.jsx)(x.A,{}),n[7]=k):k=n[7];const _=i?"Move selected items up":null;let M,T;n[8]!==y||n[9]!==A||n[10]!==_?(M=(0,d.jsxs)(g.A,{onClick:y,disabled:A,children:[k,_]}),n[8]=y,n[9]=A,n[10]=_,n[11]=M):M=n[11],n[12]!==s||n[13]!==c||n[14]!==t?(T=()=>{s(C([...c],t))},n[12]=s,n[13]=c,n[14]=t,n[15]=T):T=n[15];const E=!t.length;let F;n[16]===Symbol.for("react.memo_cache_sentinel")?(F=(0,d.jsx)(f.A,{}),n[16]=F):F=n[16];const H=i?"Move selected items down":null;let N,O;n[17]!==E||n[18]!==H||n[19]!==T?(N=(0,d.jsxs)(g.A,{onClick:T,disabled:E,children:[F,H]}),n[17]=E,n[18]=H,n[19]=T,n[20]=N):N=n[20],n[21]!==s||n[22]!==c||n[23]!==t?(O=()=>{s(b([...c],t,c.length))},n[21]=s,n[22]=c,n[23]=t,n[24]=O):O=n[24];const R=!t.length;let L;n[25]===Symbol.for("react.memo_cache_sentinel")?(L=(0,d.jsx)(j.A,{}),n[25]=L):L=n[25];const G=i?"Move selected items to top":null;let B,P;n[26]!==O||n[27]!==R||n[28]!==G?(B=(0,d.jsxs)(g.A,{onClick:O,disabled:R,children:[L,G]}),n[26]=O,n[27]=R,n[28]=G,n[29]=B):B=n[29],n[30]!==s||n[31]!==c||n[32]!==t?(P=()=>{s(C([...c],t,c.length))},n[30]=s,n[31]=c,n[32]=t,n[33]=P):P=n[33];const I=!t.length;let W;n[34]===Symbol.for("react.memo_cache_sentinel")?(W=(0,d.jsx)(p.A,{}),n[34]=W):W=n[34];const z=i?"Move selected items to bottom":null;let D,K,U,V,Y;return n[35]!==P||n[36]!==I||n[37]!==z?(D=(0,d.jsxs)(g.A,{onClick:P,disabled:I,children:[W,z]}),n[35]=P,n[36]=I,n[37]=z,n[38]=D):D=n[38],n[39]!==s||n[40]!==c||n[41]!==t?(K=e=>{h(e);for(const n of t){const t=c.find(e=>e.name===n);t&&(t.color=e)}s([...c])},n[39]=s,n[40]=c,n[41]=t,n[42]=K):K=n[42],n[43]===Symbol.for("react.memo_cache_sentinel")?(U=()=>{u(null)},n[43]=U):U=n[43],n[44]!==a||n[45]!==K||n[46]!==m?(V=(0,d.jsx)(r.FO,{anchorEl:a,color:m,onChange:K,onClose:U}),n[44]=a,n[45]=K,n[46]=m,n[47]=V):V=n[47],n[48]!==N||n[49]!==B||n[50]!==D||n[51]!==V||n[52]!==v||n[53]!==M?(Y=(0,d.jsxs)(d.Fragment,{children:[v,M,N,B,D,V]}),n[48]=N,n[49]=B,n[50]=D,n[51]=V,n[52]=v,n[53]=M,n[54]=Y):Y=n[54],Y}const S=function(e){const n=(0,o.c)(12),{rows:t,onChange:s,showTips:r}=e;let c;n[0]===Symbol.for("react.memo_cache_sentinel")?(c=[],n[0]=c):c=n[0];const[i,a]=(0,l.useState)(c);let u,h,f;return n[1]!==s||n[2]!==t||n[3]!==i||n[4]!==r?(u=(0,d.jsx)(w,{selected:i,rows:t,showTips:r,onChange:s}),n[1]=s,n[2]=t,n[3]=i,n[4]=r,n[5]=u):u=n[5],n[6]!==s||n[7]!==t?(h=t.length?(0,d.jsx)(m,{rows:t,onChange:s,setSelected:a}):(0,d.jsx)("div",{children:"No rows"}),n[6]=s,n[7]=t,n[8]=h):h=n[8],n[9]!==u||n[10]!==h?(f=(0,d.jsxs)("div",{children:[u,h]}),n[9]=u,n[10]=h,n[11]=f):f=n[11],f};var v=t(36157),y=t(76218),A=t(30698),k=t(61282),_=t(93062);const M=(0,a.n9)()({textAreaFont:{fontFamily:"Courier New"}});function T(e){const n=(0,o.c)(29),{onClose:t,currLayout:r}=e,{classes:c}=M(),[i,a]=(0,l.useState)(""),[u,m]=(0,l.useState)();let h,f,x,p,j,b,C,w,S,v,T;return n[0]===Symbol.for("react.memo_cache_sentinel")?(h=(0,d.jsx)(k.A,{children:'Paste CSV or TSV. If a header column is present. First line is a header. If a column called "name" is present, it uses that to connect to IDs in the table, otherwise it uses the first column no.'}),n[0]=h):h=n[0],n[1]!==u?(f=u?(0,d.jsx)(s.ErrorMessage,{error:u}):null,n[1]=u,n[2]=f):f=n[2],n[3]===Symbol.for("react.memo_cache_sentinel")?(x=e=>{a(e.target.value)},n[3]=x):x=n[3],n[4]!==c.textAreaFont?(p={input:{classes:{input:c.textAreaFont}}},n[4]=c.textAreaFont,n[5]=p):p=n[5],n[6]!==p||n[7]!==i?(j=(0,d.jsx)(_.A,{variant:"outlined",multiline:!0,minRows:5,placeholder:"name,population\nHG00098,GBR\nHG00101,GBR\nHG00459,CHS\n...",maxRows:10,fullWidth:!0,value:i,onChange:x,slotProps:p}),n[6]=p,n[7]=i,n[8]=j):j=n[8],n[9]!==f||n[10]!==j?(b=(0,d.jsxs)(y.A,{children:[h,f,j]}),n[9]=f,n[10]=j,n[11]=b):b=n[11],n[12]!==r||n[13]!==t||n[14]!==i?(C=(0,d.jsx)(g.A,{variant:"contained",color:"secondary",onClick:()=>{const e=i.split("\n").map(R).filter(O),n=e[0].split(/[,\t]/gm);if(n.includes("name")){m("");const o=Object.fromEntries(r.map(N)),l=Object.fromEntries(e.slice(1).map(e=>{const t=e.split(/[,\t]/gm),l=Object.fromEntries(t.map((e,t)=>[n[t],e]));return[l.name,{...l,...o[l.name]}]}));t(r.map(e=>({...e,...l[e.name]})))}else m(new Error('No "name" column found on line 1'))},children:"Update rows"}),n[12]=r,n[13]=t,n[14]=i,n[15]=C):C=n[15],n[16]!==r||n[17]!==t||n[18]!==i?(w=(0,d.jsx)(g.A,{variant:"contained",color:"primary",onClick:()=>{const e=i.split("\n").map(H).filter(F),n=e[0].split(/[,\t]/gm);if(n.includes("name")){m("");const o=Object.fromEntries(r.map(E)),l=Object.fromEntries(e.slice(1).map(e=>{const t=e.split(/[,\t]/gm),l=Object.fromEntries(t.map((e,t)=>[n[t],e]));return[l.name,{...l,...o[l.name]}]}));t(r.map(e=>({...l[e.name]})))}else m(new Error('No "name" column found on line 1'))},children:"Replace rows"}),n[16]=r,n[17]=t,n[18]=i,n[19]=w):w=n[19],n[20]!==t?(S=(0,d.jsx)(g.A,{variant:"contained",color:"inherit",onClick:()=>{t()},children:"Cancel"}),n[20]=t,n[21]=S):S=n[21],n[22]!==C||n[23]!==w||n[24]!==S?(v=(0,d.jsxs)(A.A,{children:[C,w,S]}),n[22]=C,n[23]=w,n[24]=S,n[25]=v):v=n[25],n[26]!==v||n[27]!==b?(T=(0,d.jsxs)(d.Fragment,{children:[b,v]}),n[26]=v,n[27]=b,n[28]=T):T=n[28],T}function E(e){return[e.name,e]}function F(e){return!!e}function H(e){return e.trim()}function N(e){return[e.name,e]}function O(e){return!!e}function R(e){return e.trim()}function L(){const e=(0,o.c)(1);let n;return e[0]===Symbol.for("react.memo_cache_sentinel")?(n=(0,d.jsxs)(d.Fragment,{children:["Helpful tips",(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:"You can select rows in the table with the checkboxes"}),(0,d.jsx)("li",{children:"Multi-select is enabled with shift-click and control-click"}),(0,d.jsx)("li",{children:'The "Move selected items up/down" can re-arrange subtracks'}),(0,d.jsx)("li",{children:"Sorting the data grid itself can also re-arrange subtracks"}),(0,d.jsx)("li",{children:"Changes are applied when you hit Submit"}),(0,d.jsx)("li",{children:"You can click and drag the dialog box to move it on the screen"}),(0,d.jsx)("li",{children:"Columns in the table can be hidden using a vertical '...' menu on the right side of each column"})]})]}),e[0]=n):n=e[0],n}var G=t(40898),B=t(80208);function P(e){const n=(0,o.c)(12),{setCurrLayout:t,currLayout:l}=e;if(!l.length||!l[0])return null;let s;n[0]!==l[0]?(s=Object.keys(l[0]).filter(D),n[0]=l[0],n[1]=s):s=n[1];const r=s;let c,i,a;return n[2]!==l||n[3]!==r||n[4]!==t?(c=r.map(e=>(0,d.jsx)(g.A,{variant:"contained",color:"inherit",onClick:()=>{const n=new Map;for(const t of l){const o=n.get(t[e]);o?n.set(t[e],o+1):n.set(t[e],1)}const o=Object.fromEntries([...n.entries()].sort(z).map(W));t(l.map(n=>({...n,color:o[n[e]]})))},children:e},e)),n[2]=l,n[3]=r,n[4]=t,n[5]=c):c=n[5],n[6]!==l||n[7]!==t?(i=(0,d.jsx)(g.A,{onClick:()=>{t(l.map(I))},children:"Clear colors"}),n[6]=l,n[7]=t,n[8]=i):i=n[8],n[9]!==c||n[10]!==i?(a=(0,d.jsxs)("div",{children:["Create color palette based on...",c,i]}),n[9]=c,n[10]=i,n[11]=a):a=n[11],a}function I(e){return{...e,color:void 0}}function W(e,n){return[e[0],G.set1[n]||(0,B.randomColor)(e[0])]}function z(e,n){return e[1]-n[1]}function D(e){return"name"!==e&&"color"!==e&&"label"!==e&&"id"!==e&&"HP"!==e}const K=(0,a.n9)()({content:{minWidth:800},fr:{float:"right",display:"flex",gap:8}});function U(e){const n=(0,o.c)(19),{model:t,handleClose:s,title:r,enableBulkEdit:i,enableRowPalettizer:a,showTipsStorageKey:u,SourcesGridComponent:m}=e,h=void 0===r?"Color/arrangement editor":r,f=void 0!==i&&i,x=void 0!==a&&a,p=void 0===u?"setColorDialog-showTips":u,{classes:j}=K(),{sources:b}=t,[C,w]=(0,l.useState)(!1);let S,k;n[0]!==b?(S=b||[],n[0]=b,n[1]=S):S=n[1],n[2]!==S?(k=structuredClone(S),n[2]=S,n[3]=k):k=n[3];const[_,M]=(0,l.useState)(k),[E,F]=(0,c.useLocalStorage)(p,!1);let H,N;return n[4]!==m||n[5]!==j||n[6]!==_||n[7]!==f||n[8]!==x||n[9]!==s||n[10]!==t||n[11]!==F||n[12]!==C||n[13]!==E?(H=C&&f?(0,d.jsx)(T,{currLayout:_,onClose:e=>{e&&M(e),w(!1)}}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)(y.A,{className:j.content,children:[(0,d.jsxs)("div",{className:j.fr,children:[(0,d.jsx)(g.A,{variant:"contained",onClick:()=>{F(!E)},children:E?"Hide tips":"Show tips"}),f?(0,d.jsx)(g.A,{color:"secondary",variant:"contained",onClick:()=>{w(!C)},children:"Show Bulk row editor"}):null]}),E?(0,d.jsx)(L,{}):null,x?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("br",{}),(0,d.jsx)(P,{currLayout:_,setCurrLayout:M})]}):null,(0,d.jsx)(m,{rows:_,onChange:M,showTips:E})]}),(0,d.jsxs)(A.A,{children:[(0,d.jsx)(g.A,{variant:"contained",type:"submit",color:"inherit",onClick:()=>{t.clearLayout(),M(t.sources||[])},children:"Clear custom settings"}),(0,d.jsx)(g.A,{variant:"contained",color:"secondary",onClick:()=>{s(),M([...t.sources||[]])},children:"Cancel"}),(0,d.jsx)(g.A,{variant:"contained",color:"primary",type:"submit",onClick:()=>{t.setLayout(_),s()},children:"Submit"})]})]}),n[4]=m,n[5]=j,n[6]=_,n[7]=f,n[8]=x,n[9]=s,n[10]=t,n[11]=F,n[12]=C,n[13]=E,n[14]=H):H=n[14],n[15]!==s||n[16]!==H||n[17]!==h?(N=(0,d.jsx)(v.A,{open:!0,onClose:s,maxWidth:"xl",title:h,children:H}),n[15]=s,n[16]=H,n[17]=h,n[18]=N):N=n[18],N}function V(e){const n=(0,o.c)(3),{model:t,handleClose:l}=e,s=t;let r;return n[0]!==l||n[1]!==s?(r=(0,d.jsx)(U,{model:s,handleClose:l,title:"Multi-sample variant display - Color/arrangement editor",enableBulkEdit:!0,enableRowPalettizer:!0,showTipsStorageKey:"multivariant-showTips",SourcesGridComponent:S}),n[0]=l,n[1]=s,n[2]=r):r=n[2],r}},36157:(e,n,t)=>{t.d(n,{A:()=>C});var o=t(67758),l=t(7552),s=t(84340),r=t(95054),c=t(48768),i=t(87626),a=t(59130),d=t(89870),u=t(41450),m=t(68446),h=t(21254),f=t.n(h),x=t(75785),p=t(69500);const j=(0,x.n9)()(e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}));function g(e){const n=(0,o.c)(2),t=(0,l.useRef)(null);let s;return n[0]!==e?(s=(0,p.jsx)(f(),{nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',onStart:b,children:(0,p.jsx)(r.A,{ref:t,...e})}),n[0]=e,n[1]=s):s=n[1],s}function b(e){return`${e.target?.className}`.includes("MuiDialogTitle")}const C=(0,m.observer)(function(e){const{classes:n}=j(),{title:t,children:o,onClose:l}=e;return(0,p.jsx)(c.A,{...e,PaperComponent:g,children:(0,p.jsxs)(i.A,{children:[(0,p.jsxs)(a.A,{style:{cursor:"move"},children:[t,l?(0,p.jsx)(d.A,{className:n.closeButton,onClick:()=>{l()},children:(0,p.jsx)(s.A,{})}):null]}),(0,p.jsx)(u.A,{}),o]})})})}}]);
//# sourceMappingURL=3526.12a2b873.chunk.js.map