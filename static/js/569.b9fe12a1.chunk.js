"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[569],{569:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ge});var n=s(7552),o=s(67112),i=s(42489),r=s(68446),a=s(75785),l=s(91392),c=s(86495),d=s(99546),m=s(61282),h=s(23758),u=s(90542),x=s(41545),p=s(29743),f=s(2020),y=s(24e3),b=s(17914),g=s(1485),j=s(89870),v=s(67758),w=s(94874),k=s(69500);function S(e){const t=(0,v.c)(3);let s,n;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s=(0,k.jsx)("path",{fill:"currentColor",d:"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z"}),t[0]=s):s=t[0],t[1]!==e?(n=(0,k.jsx)(w.A,{...e,children:s}),t[1]=e,t[2]=n):n=t[2],n}function A(e){const t=(0,v.c)(3);let s,n;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s=(0,k.jsx)("path",{fill:"currentColor",d:"M10.07,14.27C10.57,14.03 11.16,14.25 11.4,14.75L13.7,19.74L15.5,18.89L13.19,13.91C12.95,13.41 13.17,12.81 13.67,12.58L13.95,12.5L16.25,12.05L8,5.12V15.9L9.82,14.43L10.07,14.27M13.64,21.97C13.14,22.21 12.54,22 12.31,21.5L10.13,16.76L7.62,18.78C7.45,18.92 7.24,19 7,19A1,1 0 0,1 6,18V3A1,1 0 0,1 7,2C7.24,2 7.47,2.09 7.64,2.23L7.65,2.22L19.14,11.86C19.57,12.22 19.62,12.85 19.27,13.27C19.12,13.45 18.91,13.57 18.7,13.61L15.54,14.23L17.74,18.96C18,19.46 17.76,20.05 17.26,20.28L13.64,21.97Z"}),t[0]=s):s=t[0],t[1]!==e?(n=(0,k.jsx)(w.A,{...e,children:s}),t[1]=e,t[2]=n):n=t[2],n}const L=(0,r.observer)(function({model:e}){return(0,k.jsxs)("div",{children:[(0,k.jsx)(j.A,{onClick:()=>{e.zoomOut()},children:(0,k.jsx)(g.A,{})}),(0,k.jsx)(j.A,{onClick:()=>{e.zoomIn()},children:(0,k.jsx)(b.A,{})}),(0,k.jsx)(j.A,{onClick:()=>e.activateTrackSelector(),title:"Open track selector",children:(0,k.jsx)(u.xU,{})}),(0,k.jsx)(h.A,{menuItems:[{label:"Square view - same bp per pixel",icon:x.A,onClick:()=>{e.squareView()}},{label:"Rectangular view - same total bp",icon:p.A,onClick:()=>{e.squareViewProportional()}},{label:"Show all regions",icon:y.A,onClick:()=>{e.showAllRegions()}},{type:"checkbox",label:"Draw CIGAR",checked:e.drawCigar,onClick:()=>{e.setDrawCigar(!e.drawCigar)}},{label:"Show pan buttons",type:"checkbox",checked:e.showPanButtons,onClick:()=>{e.setShowPanButtons(!e.showPanButtons)}},{label:"Click and drag mode",subMenu:[{label:"Pan by default, select region when ctrl/cmd key is held",icon:S,type:"radio",checked:"move"===e.cursorMode,onClick:()=>{e.setCursorMode("move")}},{label:"Select region by default, pan when ctrl/cmd key is held",icon:A,type:"radio",checked:"crosshair"===e.cursorMode,onClick:()=>{e.setCursorMode("crosshair")}}]},{label:"Wheel scroll mode",subMenu:[{label:"Pans view",type:"radio",checked:"pan"===e.wheelMode,onClick:()=>{e.setWheelMode("pan")}},{label:"Zooms view",type:"radio",checked:"zoom"===e.wheelMode,onClick:()=>{e.setWheelMode("zoom")}},{label:"Disable",type:"radio",checked:"none"===e.wheelMode,onClick:()=>{e.setWheelMode("none")}}]}],children:(0,k.jsx)(f.A,{})})]})});var C=s(28194),P=s(69092);const N=(0,n.lazy)(()=>Promise.all([s.e(2407),s.e(4132),s.e(7884)]).then(s.bind(s,75083))),M=(0,r.observer)(function({model:e}){const t=e.tracks.filter(e=>e.displays[0].warnings?.length),[s,o]=(0,n.useState)(!1),[i,r]=(0,n.useState)(!1);return t.length&&!i?(0,k.jsxs)(C.A,{severity:"warning",children:["Warnings during render"," ",(0,k.jsx)(P.A,{onClick:()=>{o(!0)},children:"More info"}),s?(0,k.jsx)(N,{trackWarnings:t,handleClose:()=>{o(!1)}}):null,(0,k.jsx)(P.A,{variant:"contained",onClick:()=>{r(!0)},children:"Dismiss"})]}):null});var F=s(61968),z=s(25237),B=s(34836),I=s(68527),T=s(95054);const O=(0,a.n9)()({dpad:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",margin:0,position:"absolute",right:50,zIndex:500,top:50},icon:{padding:0,margin:0}}),E=(0,r.observer)(function({model:e}){const{classes:t}=O();return(0,k.jsxs)(T.A,{className:t.dpad,elevation:6,children:[(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.vview.scroll(100)},children:(0,k.jsx)(z.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.hview.scroll(-100)},children:(0,k.jsx)(B.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.hview.scroll(100)},children:(0,k.jsx)(I.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.vview.scroll(-100)},children:(0,k.jsx)(F.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.zoomIn()},children:(0,k.jsx)(b.A,{})}),(0,k.jsx)("div",{}),(0,k.jsx)(j.A,{className:t.icon,onClick:()=>{e.zoomOut()},children:(0,k.jsx)(g.A,{})})]})}),R=(0,a.n9)()({bp:{display:"flex",alignItems:"center",marginLeft:10},spacer:{flexGrow:1},headerBar:{display:"flex",position:"relative"}}),$=(0,r.observer)(function({model:e,selection:t}){const{classes:s}=R(),{hview:n,vview:o,showPanButtons:i}=e;return(0,k.jsxs)("div",{className:s.headerBar,children:[(0,k.jsx)(L,{model:e}),(0,k.jsxs)(m.A,{className:s.bp,variant:"body2",color:"textSecondary",children:["x: ",n.assemblyNames.join(",")," ",(0,d.getBpDisplayStr)(n.currBp),(0,k.jsx)("br",{}),"y: ",o.assemblyNames.join(",")," ",(0,d.getBpDisplayStr)(o.currBp)]}),t?(0,k.jsxs)(m.A,{className:s.bp,variant:"body2",color:"textSecondary",children:[`width:${(0,d.getBpDisplayStr)(n.bpPerPx*t.width)}`," ",(0,k.jsx)("br",{}),`height:${(0,d.getBpDisplayStr)(o.bpPerPx*t.height)}`]}):null,(0,k.jsx)("div",{className:s.spacer}),(0,k.jsx)(M,{model:e}),i?(0,k.jsx)(E,{model:e}):null]})});var D=s(59570),V=s(92826),H=s(91818),q=s(51870),W=s(94540),_=s(7946),Y=s(94332);function J({radioOption:e,assembly1:t,assembly2:s,fileLocation:n,indexFileLocation:o,bed1Location:i,bed2Location:r}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:n,queryAssembly:t,targetAssembly:s};if(".out"===e)return{type:"MashMapAdapter",outLocation:n,queryAssembly:t,targetAssembly:s};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:n,queryAssembly:t,targetAssembly:s};if(".chain"===e)return{type:"ChainAdapter",chainLocation:n,queryAssembly:t,targetAssembly:s};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:n,bed1Location:i,bed2Location:r,assemblyNames:[t,s]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:n,bed1Location:i,bed2Location:r,assemblyNames:[t,s]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:n,index:{location:o},assemblyNames:[t,s]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}var X=s(15897),K=s(37962);const U={".paf":"minimap2 target.fa query.fa",".pif.gz":"minimap2 target.fa query.fa",".out":"mashmap target.fa query.fa",".delta":"mummer target.fa query.fa",".chain":"e.g. queryToTarget.chain"},Z=(0,a.n9)()({row:{display:"flex",gap:20},swap:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"}}),G=(0,r.observer)(function({assembly1:e,assembly2:t,swap:s,setSwap:n,radioOption:o,helpContent:i,text1:r,text2:a}){const{classes:l}=Z();return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{children:["Verify or click swap",(0,k.jsx)(K.A,{title:i||(0,k.jsx)("code",{children:U[o]}),children:(0,k.jsx)(X.A,{})})]}),(0,k.jsxs)("div",{className:l.row,children:[(0,k.jsxs)("div",{className:l.swap,children:[(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:s?t:e})}),(0,k.jsx)("div",{children:r}),(0,k.jsx)("div",{children:(0,k.jsx)("i",{children:s?e:t})}),(0,k.jsx)("div",{children:a})]}),(0,k.jsx)(P.A,{variant:"contained",onClick:()=>{n&&n(!s)},children:"Swap?"})]})]})}),Q=(0,r.observer)(function({assembly1:e,assembly2:t,swap:s,setSwap:n,fileLocation:i,setFileLocation:r,bed1Location:a,setBed1Location:l,bed2Location:c,setBed2Location:d,radioOption:m}){return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{style:{margin:20},children:["Open the ",m," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,k.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)(o.FileSelector,{inline:!0,name:m,location:i,setLocation:e=>{r(e)}}),(0,k.jsx)(o.FileSelector,{inline:!0,name:"genome 1 .bed (left column of anchors file)",description:"",location:a,setLocation:e=>{l&&l(e)}}),(0,k.jsx)(o.FileSelector,{inline:!0,name:"genome 2 .bed (right column of anchors file)",description:"",location:c,setLocation:e=>{d&&d(e)}})]}),(0,k.jsx)(G,{swap:s,radioOption:m,assembly1:e,assembly2:t,setSwap:n,text1:"bed 1 assembly",text2:"bed 2 assembly"})]})}),ee=(0,r.observer)(function({assembly1:e,assembly2:t,swap:s,setSwap:n,fileLocation:i,setFileLocation:r,indexFileLocation:a,setIndexFileLocation:l=()=>{},radioOption:c}){return(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{style:{margin:20},children:["Open the ",c," and .pif.gz and index file (.pif.gz.tbi or .pif.gz.csi) files for created by `jbrowse make-pif`"]}),(0,k.jsxs)("div",{style:{maxWidth:400,margin:"0 auto"},children:[(0,k.jsx)(o.FileSelector,{name:`${c} location`,inline:!0,description:"",location:i,setLocation:r}),(0,k.jsx)(o.FileSelector,{name:`${c} index location (.tbi or .csi)`,inline:!0,description:"",location:a,setLocation:l}),(0,k.jsx)(G,{swap:s,radioOption:c,assembly1:e,assembly2:t,setSwap:n,text1:"query assembly",text2:"target assembly"})]})]})}),te=(0,a.n9)()({container:{display:"flex",flexDirection:"column",gap:10}}),se=(0,r.observer)(function({assembly1:e,assembly2:t,swap:s,setSwap:n,fileLocation:i,setFileLocation:r,radioOption:a}){const{classes:l}=te();return(0,k.jsxs)("div",{className:l.container,children:[(0,k.jsx)(o.FileSelector,{name:`${a} location`,inline:!0,description:"",location:i,setLocation:e=>{r(e)}}),(0,k.jsx)(G,{assembly1:e,assembly2:t,swap:s,setSwap:n,radioOption:a,text1:"query assembly",text2:"target assembly"})]})}),ne=(0,r.observer)(function({model:e,assembly1:t,assembly2:s}){const[i,r]=(0,n.useState)(!1),[a,l]=(0,n.useState)(),[c,d]=(0,n.useState)(),[h,u]=(0,n.useState)(),[x,p]=(0,n.useState)(),[f,y]=(0,n.useState)(""),[b,g]=(0,n.useState)(),j=(v=h)?v.uri||v.localPath||v.name:void 0;var v;const w=f||(j?function(e){const t=e.split(".").pop();return t?`.${t}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(j)):"");return(0,n.useEffect)(()=>{try{if(h){const n=j?j.split("#")[0].split("?")[0].split("/").pop():"MyTrack",o=`${n}-${Date.now()}-sessionTrack`;g(void 0),e.setImportFormSyntenyTrack(0,{type:"userOpened",value:{trackId:o,name:n,assemblyNames:[s,t],type:"SyntenyTrack",adapter:J({radioOption:w,assembly1:i?s:t,assembly2:i?t:s,fileLocation:h,indexFileLocation:x,bed1Location:c,bed2Location:a})}})}}catch(e){console.error(e),g(e)}},[i,e,j,t,s,c,a,h,x,w]),(0,k.jsxs)(T.A,{style:{padding:12},children:[b?(0,k.jsx)(o.ErrorMessage,{error:b}):null,(0,k.jsx)(m.A,{style:{textAlign:"center"},children:"Add a .paf (minimap2), .delta (Mummer), .chain (UCSC liftover), .anchors or .anchors.simple (MCScan), or .pif.gz (jbrowse CLI make-pif) file to view. These file types can also be gzipped."}),(0,k.jsx)(W.A,{value:w,onChange:e=>{y(e.target.value)},children:(0,k.jsx)(V.A,{container:!0,justifyContent:"center",children:[".paf",".delta",".out",".chain",".anchors",".anchors.simple",".pif.gz"].map(e=>(0,k.jsx)(_.A,{value:e,control:(0,k.jsx)(Y.A,{}),label:e},e))})}),(0,k.jsx)(V.A,{container:!0,justifyContent:"center",children:".paf"===w||".out"===w||".delta"===w||".chain"===w?(0,k.jsx)(se,{radioOption:w,fileLocation:h,setFileLocation:u,assembly1:t,assembly2:s,swap:i,setSwap:r}):".anchors"===w||".anchors.simple"===w?(0,k.jsx)(Q,{radioOption:w,fileLocation:h,setFileLocation:u,assembly1:t,assembly2:s,swap:i,setSwap:r,bed1Location:c,setBed1Location:d,bed2Location:a,setBed2Location:l}):".pif.gz"===w?(0,k.jsx)(ee,{radioOption:w,fileLocation:h,setFileLocation:u,assembly1:t,assembly2:s,swap:i,setSwap:r,indexFileLocation:x,setIndexFileLocation:p}):null})]})});var oe=s(68584),ie=s(91468),re=s(21049),ae=s(10240);const le=(0,r.observer)(function({model:e,assembly1:t,assembly2:s}){const i=(0,d.getSession)(e),{tracks:r,sessionTracks:a}=i,l=[...r,...a||[]].filter(e=>function(e,t,s){const n=(0,oe.readConfObject)(e,"assemblyNames");return n.includes(t)&&n.includes(s)&&e.type.includes("Synteny")}(e,s,t)),c=l[0]?.trackId||"",[h,x]=(0,n.useState)(c);return(0,n.useEffect)(()=>{x(c)},[c]),(0,n.useEffect)(()=>{e.setImportFormSyntenyTrack(0,{type:"preConfigured",value:h})},[e,h]),(0,k.jsxs)(T.A,{style:{padding:12},children:[(0,k.jsxs)(m.A,{children:['Select a track from the select box below, the track will be shown when you hit "Launch". Note: there is a track selector ',(0,k.jsx)("i",{children:"inside"})," the DotplotView, which can turn on one or more SyntenyTracks (more than one can be displayed at once). Look for the track selector icon"," ",(0,k.jsx)(u.xU,{})]}),l.length?(0,k.jsx)(re.A,{value:h,onChange:e=>{x(e.target.value)},children:l.map(e=>(0,k.jsx)(ae.A,{value:e.trackId,children:(0,ie.getTrackName)(e,i)},e.trackId))}):(0,k.jsx)(o.ErrorMessage,{error:`No synteny tracks found for ${t},${s}`})]})}),ce=(0,r.observer)(function({assembly1:e,assembly2:t,model:s}){const[o,i]=(0,n.useState)("tracklist");return(0,n.useEffect)(()=>{"none"===o&&s.setImportFormSyntenyTrack(0,{type:"none"})},[s,o]),(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(H.A,{children:[(0,k.jsx)(q.A,{id:"group-label",children:"(Optional) Select or add a synteny track"}),(0,k.jsxs)(W.A,{row:!0,value:o,onChange:e=>{i(e.target.value)},"aria-labelledby":"group-label",children:[(0,k.jsx)(_.A,{value:"none",control:(0,k.jsx)(Y.A,{}),label:"None"}),(0,k.jsx)(_.A,{value:"tracklist",control:(0,k.jsx)(Y.A,{}),label:"Existing track"}),(0,k.jsx)(_.A,{value:"custom",control:(0,k.jsx)(Y.A,{}),label:"New track"})]})]}),"custom"===o?(0,k.jsx)(ne,{model:s,assembly2:t,assembly1:e}):null,"tracklist"===o?(0,k.jsx)(le,{model:s,assembly1:e,assembly2:t}):null]})}),de=(0,a.n9)()(e=>({importFormContainer:{padding:e.spacing(4),margin:"0 auto"},assemblySelector:{width:"75%",margin:"0 auto"}})),me=(0,r.observer)(function({model:e}){const{classes:t}=de(),s=(0,d.getSession)(e),{assemblyNames:r}=s,[a,l]=(0,n.useState)(r[0]||""),[c,h]=(0,n.useState)(r[0]||""),[u,x]=(0,n.useState)(),p=u||e.error;return(0,k.jsxs)(D.A,{className:t.importFormContainer,children:[p?(0,k.jsx)(o.ErrorMessage,{error:p}):null,(0,k.jsxs)(T.A,{style:{padding:12},children:[(0,k.jsx)(m.A,{style:{textAlign:"center"},children:"Select assemblies for dotplot view"}),(0,k.jsxs)(V.A,{container:!0,spacing:1,justifyContent:"center",alignItems:"center",children:[(0,k.jsx)(o.AssemblySelector,{helperText:"x-axis assembly",selected:a,session:s,onChange:e=>{l(e)}}),(0,k.jsx)(o.AssemblySelector,{helperText:"y-axis assembly",selected:c,session:s,onChange:e=>{h(e)}}),(0,k.jsx)(H.A,{children:(0,k.jsx)(P.A,{onClick:()=>{(async()=>{try{x(void 0),function({model:e,assembly1:t,assembly2:s}){const n=(0,d.getSession)(e),{importFormSyntenyTrackSelections:o}=e;e.setError(void 0),(0,i.transaction)(()=>{(0,d.isSessionWithAddTracks)(n)&&(0,i.toJS)(o).map((t,s)=>{"userOpened"===t.type?(n.addTrackConf(t.value),e.toggleTrack(t.value?.trackId)):"preConfigured"===t.type&&e.showTrack(t.value,s)}),e.showAllRegions(),e.setAssemblyNames(s,t)})}({assembly1:c,assembly2:a,model:e})}catch(e){console.error(e),x(e)}})()},variant:"contained",color:"primary",children:"Launch"})})]}),(0,k.jsx)(ce,{assembly2:a,assembly1:c,model:e})]})]})}),he=(0,n.lazy)(()=>s.e(1304).then(s.bind(s,81304))),ue=(0,n.lazy)(()=>s.e(1051).then(s.bind(s,21051))),xe={left:0,top:0,width:0,height:0},pe=(0,a.n9)()(e=>({spacer:{gridColumn:"1/2",gridRow:"2/2"},root:{position:"relative",marginBottom:e.spacing(1),overflow:"hidden"},container:{display:"grid",padding:5,position:"relative"},overlay:{pointerEvents:"none",overflow:"hidden",display:"flex",width:"100%",gridRow:"1/2",gridColumn:"2/2",zIndex:100,"& path":{cursor:"crosshair",fill:"none"}},content:{position:"relative",gridColumn:"2/2",gridRow:"1/2"},resizeHandle:{height:4,background:"#ccc",boxSizing:"border-box",borderTop:"1px solid #fafafa"}}));function fe(e,t){return e&&[e[0]-t.left,e[1]-t.top]}const ye=(0,r.observer)(({model:e})=>{const{classes:t}=pe();return(0,k.jsx)("div",{className:t.overlay,children:e.tracks.map(e=>{const[t]=e.displays,{RenderingComponent:s}=t;return s?(0,k.jsx)(s,{model:t},e.configuration.trackId):null})})}),be=(0,r.observer)(function({model:e}){const{classes:t}=pe(),[s,r]=(0,n.useState)(),[a,d]=(0,n.useState)(),[m,h]=(0,n.useState)(!1),[u,x]=(0,n.useState)(),p=(0,n.useRef)(null),f=(0,n.useRef)(null),y=(0,n.useRef)(0),b=(0,n.useRef)(0),g=(0,n.useRef)(!1),[j,v]=(0,n.useState)(!1),[w,S]=(0,n.useState)(!1),A=p.current?.getBoundingClientRect()||xe,L=p.current?.getBoundingClientRect()||xe,C=fe(a,A),P=fe(s,A),N=fe(u,A),M=N||P,F=u||s,z=C&&M?M[0]-C[0]:0,B=C&&M?M[1]-C[1]:0,{hview:I,vview:T,wheelMode:O,cursorMode:E}=e,R="move"===E&&!j||"crosshair"===E&&j,D="move"===E&&j||"crosshair"===E&&!j;return(0,n.useEffect)(()=>{function e(e){e.preventDefault(),y.current+=e.deltaX,b.current-=e.deltaY,g.current||(g.current=!0,window.requestAnimationFrame(()=>{(0,i.transaction)(()=>{if("pan"===O)I.scroll(y.current/3),T.scroll(b.current/10);else if("zoom"===O&&Math.abs(b.current)>2*Math.abs(y.current)&&P){const e=b.current<0?1.1:.9;I.zoomTo(I.bpPerPx*e,P[0]),T.zoomTo(T.bpPerPx*e,L.height-P[1])}}),g.current=!1,y.current=0,b.current=0}))}if(p.current){const t=p.current;return t.addEventListener("wheel",e),()=>{t.removeEventListener("wheel",e)}}return()=>{}},[I,T,O,P,L.height]),(0,n.useEffect)(()=>{function e(e){r([e.clientX,e.clientY]),s&&a&&R&&!u&&(I.scroll(-e.clientX+s[0]),T.scroll(e.clientY-s[1]))}return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}},[R,s,a,u,I,T]),(0,n.useEffect)(()=>{function e(e){(e.metaKey||e.ctrlKey)&&S(!0)}function t(e){e.metaKey||e.ctrlKey||S(!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",t),()=>{window.removeEventListener("keydown",e),window.addEventListener("keyup",t)}},[]),(0,n.useEffect)(()=>{function e(e){Math.abs(z)>3&&Math.abs(B)>3&&D?x([e.clientX,e.clientY]):d(void 0)}return C&&!N?(window.addEventListener("mouseup",e,!0),()=>{window.removeEventListener("mouseup",e,!0)}):()=>{}},[D,C,N,z,B]),(0,k.jsxs)("div",{children:[(0,k.jsx)($,{model:e,selection:D&&C&&M?{width:Math.abs(z),height:Math.abs(B)}:void 0}),(0,k.jsxs)("div",{ref:f,className:t.root,onMouseLeave:()=>{h(!1)},onMouseEnter:()=>{h(!0)},children:[(0,k.jsxs)("div",{className:t.container,children:[(0,k.jsx)(l.en,{model:e}),(0,k.jsx)(l.KM,{model:e}),(0,k.jsxs)("div",{ref:p,className:t.content,children:[m&&D?(0,k.jsx)(n.Suspense,{fallback:null,children:(0,k.jsx)(ue,{model:e,mouserect:M,mouserectClient:F,xdistance:z})}):null,D?(0,k.jsx)(n.Suspense,{fallback:null,children:(0,k.jsx)(he,{model:e,mousedown:C,mousedownClient:a,xdistance:z,ydistance:B})}):null,(0,k.jsx)("div",{style:{cursor:w?"pointer":E},onMouseDown:e=>{if(0===e.button){const{clientX:t,clientY:s}=e;d([t,s]),r([t,s]),v(w)}},children:(0,k.jsx)(c.A,{model:e,children:D&&C&&M?(0,k.jsx)("rect",{fill:"rgba(255,0,0,0.3)",x:Math.min(M[0],C[0]),y:Math.min(M[1],C[1]),width:Math.abs(z),height:Math.abs(B)}):null})}),(0,k.jsx)("div",{className:t.spacer})]}),(0,k.jsx)(ye,{model:e}),(0,k.jsx)(o.Menu,{open:Boolean(N),onMenuItemClick:(e,t)=>{t(),x(void 0),d(void 0)},onClose:()=>{x(void 0),d(void 0)},anchorReference:"anchorPosition",anchorPosition:u?{top:u[1]+50,left:u[0]+50}:void 0,style:{zIndex:800},menuItems:[{label:"Zoom in",onClick:()=>{C&&N&&e.zoomInToMouseCoords(C,N),h(!1)}},{label:"Open linear synteny view",onClick:()=>{C&&N&&e.onDotplotView(C,N),h(!1)}}]})]}),(0,k.jsx)(o.ResizeHandle,{onDrag:t=>e.setHeight(e.height+t),className:t.resizeHandle})]})]})}),ge=(0,r.observer)(function({model:e}){const{initialized:t,loading:s,error:n}=e;return!t&&!s||n?(0,k.jsx)(me,{model:e}):s?(0,k.jsx)(o.LoadingEllipses,{variant:"h6"}):(0,k.jsx)(be,{model:e})})},86495:(e,t,s)=>{s.d(t,{A:()=>c,z:()=>l});var n=s(67758),o=s(99546),i=s(51414),r=s(68446),a=s(69500);const l=(0,r.observer)(function({model:e,children:t}){const{viewWidth:s,viewHeight:n,hview:r,vview:l}=e,c=r.dynamicBlocks.contentBlocks,d=l.dynamicBlocks.contentBlocks;if(!c.length||!d.length)return null;const m=r.displayedRegionsTotalPx-r.offsetPx,h=l.displayedRegionsTotalPx-l.offsetPx,u=c[0].offsetPx-r.offsetPx,x=d[0].offsetPx-l.offsetPx,p=(0,i.A)(),f=p.palette.divider,y=Math.max(u,0),b=Math.max(n-h,0),g=Math.min(m-u,s),j=Math.min(n-x-b,n);let v=Number.POSITIVE_INFINITY,w=Number.POSITIVE_INFINITY;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("rect",{x:y,y:b,width:g,height:j,...(0,o.getFillProps)(p.palette.background.default)}),(0,a.jsxs)("g",{children:[c.map(e=>{const t=e.offsetPx-r.offsetPx,s=Math.floor(t)!==Math.floor(v);return s&&(v=t),s?(0,a.jsx)("line",{x1:t,y1:0,x2:t,y2:n,...(0,o.getStrokeProps)(f)},JSON.stringify(e)):null}),d.map(e=>{const t=n-(e.offsetPx-l.offsetPx),i=Math.floor(t)!==Math.floor(w);return i&&(w=t),i?(0,a.jsx)("line",{x1:0,y1:t,x2:s,y2:t,...(0,o.getStrokeProps)(f)},JSON.stringify(e)):null}),(0,a.jsx)("line",{x1:m,y1:0,x2:m,y2:n,...(0,o.getStrokeProps)(f)}),(0,a.jsx)("line",{x1:0,y1:n-h,x2:s,y2:n-h,...(0,o.getStrokeProps)(f)})]}),t]})});function c(e){const t=(0,n.c)(8),{model:s,children:o}=e,{viewWidth:i,viewHeight:r}=s;let c,d,m;return t[0]===Symbol.for("react.memo_cache_sentinel")?(c={background:"rgba(0,0,0,0.12)"},t[0]=c):c=t[0],t[1]!==o||t[2]!==s?(d=(0,a.jsx)(l,{model:s,children:o}),t[1]=o,t[2]=s,t[3]=d):d=t[3],t[4]!==d||t[5]!==r||t[6]!==i?(m=(0,a.jsx)("svg",{width:i,height:r,style:c,children:d}),t[4]=d,t[5]=r,t[6]=i,t[7]=m):m=t[7],m}},91392:(e,t,s)=>{s.d(t,{KM:()=>h,en:()=>x,kb:()=>p,se:()=>u});var n=s(99546),o=s(95095),i=s(51414),r=s(68446),a=s(36422),l=s(75785),c=s(90257),d=s(69500);const m=(0,l.n9)()(()=>({vtext:{gridColumn:"1/2",gridRow:"1/2",pointerEvents:"none",userSelect:"none"},htext:{gridColumn:"2/2",gridRow:"2/2",pointerEvents:"none",userSelect:"none"}})),h=(0,r.observer)(function({model:e}){const{viewWidth:t,borderY:s}=e,{classes:n}=m();return(0,d.jsx)("svg",{width:t,height:s,className:n.htext,children:(0,d.jsx)(u,{model:e})})}),u=(0,r.observer)(function({model:e}){const{viewWidth:t,borderX:s,borderY:r,hview:l,htextRotation:m,hticks:h}=e,{offsetPx:u,width:x,dynamicBlocks:p,bpPerPx:f}=l,y=p.contentBlocks,b=(0,c.rQ)(y,t,u),g=(0,i.A)(),j={...(0,a.getSnapshot)(l),width:x,staticBlocks:l.staticBlocks},v=h.map(e=>[e,(0,o.eB)({refName:e.refName,coord:e.base,self:j})?.offsetPx]).filter(e=>void 0!==e[1]).map(e=>[e[0],e[1]-u]);return(0,d.jsxs)(d.Fragment,{children:[y.filter(e=>!b.has(e.key)).map(e=>{const t=e.offsetPx,s=Math.floor(t-l.offsetPx);return(0,d.jsx)("text",{transform:`rotate(${m},${s},0)`,x:s,y:1,fontSize:11,dominantBaseline:"hanging",textAnchor:"end",...(0,n.getFillProps)(g.palette.text.primary),children:e.refName},JSON.stringify(e))}),v.map(([e,t])=>t>0&&t<x?(0,d.jsx)("line",{x1:t,x2:t,y1:0,y2:"major"===e.type?6:4,strokeWidth:1,...(0,n.getFillProps)(g.palette.text.primary)},`line-${JSON.stringify(e)}`):null),v.filter(e=>"major"===e[0].type).map(([e,t])=>t>10&&t<x?(0,d.jsx)("text",{x:t-7,y:0,transform:`rotate(${m},${t},0)`,fontSize:11,dominantBaseline:"middle",textAnchor:"end",...(0,n.getFillProps)(g.palette.text.primary),children:(0,n.getTickDisplayStr)(e.base+1,f)},`text-${JSON.stringify(e)}`):null),(0,d.jsx)("text",{y:r-12,x:(t-s)/2,textAnchor:"middle",fontSize:11,dominantBaseline:"hanging",...(0,n.getFillProps)(g.palette.text.primary),children:l.assemblyNames.join(",")})]})}),x=(0,r.observer)(function({model:e}){const{borderX:t,viewHeight:s}=e,{classes:n}=m();return(0,d.jsx)("svg",{className:n.vtext,width:t,height:s,children:(0,d.jsx)(p,{model:e})})}),p=(0,r.observer)(function({model:e}){const{viewHeight:t,borderX:s,borderY:r,vview:l,vtextRotation:m,vticks:h}=e,{offsetPx:u,width:x,dynamicBlocks:p,bpPerPx:f}=l,y=p.contentBlocks,b=(0,c.rQ)(y,t,u),g=(0,i.A)(),j={...(0,a.getSnapshot)(l),width:x,staticBlocks:l.staticBlocks},v=h.map(e=>[e,(0,o.eB)({refName:e.refName,coord:e.base,self:j})?.offsetPx]).filter(e=>void 0!==e[1]).map(e=>[e[0],e[1]-u]);return(0,d.jsxs)(d.Fragment,{children:[y.filter(e=>!b.has(e.key)).map(e=>{const o=e.offsetPx,i=s,r=Math.floor(t-o+u);return(0,d.jsx)("text",{transform:`rotate(${m},${i},${o})`,x:i,y:r,fontSize:11,textAnchor:"end",...(0,n.getFillProps)(g.palette.text.primary),children:e.refName},JSON.stringify(e))}),v.map(([e,o])=>o>0?(0,d.jsx)("line",{y1:t-o,y2:t-o,x1:s,x2:s-("major"===e.type?6:4),strokeWidth:1,...(0,n.getStrokeProps)(g.palette.grey[400])},`line-${JSON.stringify(e)}`):null),v.filter(e=>"major"===e[0].type).map(([e,o])=>o>10&&o<t?(0,d.jsx)("text",{y:t-o-3,x:s-7,textAnchor:"end",dominantBaseline:"hanging",fontSize:11,...(0,n.getFillProps)(g.palette.text.primary),children:(0,n.getTickDisplayStr)(e.base+1,f)},`text-${JSON.stringify(e)}`):null),(0,d.jsx)("text",{y:(t-r)/2,x:12,transform:`rotate(-90,12,${(t-r)/2})`,textAnchor:"middle",fontSize:11,...(0,n.getFillProps)(g.palette.text.primary),children:l.assemblyNames.join(",")})]})})}}]);
//# sourceMappingURL=569.b9fe12a1.chunk.js.map