"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7691],{7691:(e,n,o)=>{o.r(n),o.d(n,{default:()=>k});var t=o(7552),r=o(99546),i=o(49204),c=o(85059),s=o(27897),a=o(96403),l=o(22133),d=o(5401),u=o(68446),g=o(75785),p=o(49823),m=o(59099),f=o(69500);const h=(0,u.observer)((function({connectionType:e,model:n,session:o}){const r=e.configEditorComponent||m.S;return(0,f.jsx)(t.Suspense,{fallback:(0,f.jsx)(p.LoadingEllipses,{}),children:(0,f.jsx)(r,{model:{target:n},session:o})})})),C=(0,o(74893).A)((0,f.jsx)("path",{d:"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3z"}),"OpenInNew");var v=o(1343),b=o(61723),j=o(29629);const w=(0,u.observer)((function({connectionTypeChoices:e,connectionType:n,setConnectionType:o}){const r=e[0];return(0,t.useEffect)((()=>{n||o(r)}),[n,r,o]),(0,f.jsx)("form",{autoComplete:"off",children:n?(0,f.jsx)(v.A,{value:n.name,label:"connectionType",helperText:n.description?(0,f.jsxs)(f.Fragment,{children:[n.description,n.url?(0,f.jsx)(b.A,{href:n.url,rel:"noopener noreferrer",target:"_blank",children:(0,f.jsx)(C,{})}):null]}):null,select:!0,fullWidth:!0,onChange:n=>{o(e.find((e=>e.name===n.target.value)))},variant:"outlined",children:e.map((e=>(0,f.jsx)(j.A,{value:e.name,children:e.displayName||e.name},e.name)))}):null})})),x=(0,g.n9)()((e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginTop:e.spacing(1),marginRight:e.spacing(1)},actionsContainer:{marginBottom:e.spacing(2)}}))),y=["Select a Connection Type","Configure Connection"],k=(0,u.observer)((function({model:e}){const[n,o]=(0,t.useState)(),[u,g]=(0,t.useState)(),[p,m]=(0,t.useState)(0),{classes:C}=x(),v=(0,r.getSession)(e),{pluginManager:b}=(0,r.getEnv)(v),j=(0,t.useMemo)((()=>n?.configSchema.create({connectionId:u},(0,r.getEnv)(e))),[u,n,e]);return(0,f.jsx)("div",{className:C.root,children:(0,f.jsx)(c.A,{className:C.stepper,activeStep:p,orientation:"vertical",children:y.map((t=>(0,f.jsxs)(s.A,{children:[(0,f.jsx)(a.A,{children:t}),(0,f.jsxs)(l.A,{children:[0===p?(0,f.jsx)(w,{connectionTypeChoices:b.getConnectionElements(),connectionType:n,setConnectionType:e=>{o(e),e&&g(`${e.name}-${Date.now()}`)}}):n&&j?(0,f.jsx)(h,{connectionType:n,model:j,session:v}):null,(0,f.jsxs)("div",{className:C.actionsContainer,children:[(0,f.jsx)(d.A,{disabled:0===p,onClick:()=>{m(p-1)},className:C.button,children:"Back"}),(0,f.jsx)(d.A,{disabled:!(0===p&&n||1===p&&j),variant:"contained",color:"primary",onClick:()=>{if(p===y.length-1){if(j&&(0,i.M)(v)){const e=v.addConnectionConf(j);v.makeConnection(e)}else v.notify("No config model to add");(0,r.isSessionModelWithWidgets)(v)&&v.hideWidget(e)}else m(p+1)},className:C.button,"data-testid":"addConnectionNext",children:p===y.length-1?"Connect":"Next"})]})]})]},t)))})})}))},45858:(e,n,o)=>{o.d(n,{DH:()=>i,qk:()=>c});var t=o(8832);if(8792==o.j)var r=o(36422);function i(e){return r.types.model({id:t.ElementId,name:r.types.string,margin:0}).volatile((()=>({selection:void 0,hovered:void 0}))).views((e=>({get root(){return(0,r.getParent)(e)}}))).views((e=>({get jbrowse(){return e.root.jbrowse},get rpcManager(){return e.root.rpcManager},get configuration(){return this.jbrowse.configuration},get adminMode(){return e.root.adminMode},get textSearchManager(){return e.root.textSearchManager}}))).views((e=>({get assemblies(){return e.jbrowse.assemblies}}))).actions((e=>({setSelection(n){e.selection=n},clearSelection(){e.selection=void 0},setHovered(n){e.hovered=n}})))}function c(e){return"id"in e&&"name"in e&&"root"in e}},49204:(e,n,o)=>{o.d(n,{F:()=>c,M:()=>s});var t=o(68584);if(8792==o.j)var r=o(36422);var i=o(45858);function c(e){return r.types.model({connectionInstances:r.types.array(e.pluggableMstType("connection","stateModel"))}).views((e=>({get connections(){const{jbrowse:n}=e;return n.connections}}))).actions((n=>({makeConnection(o,r={}){const i=o.type;if(!i)throw new Error("track configuration has no `type` listed");const c=(0,t.readConfObject)(o,"name");if(!e.getConnectionType(i))throw new Error(`unknown connection type ${i}`);const s=n.connectionInstances.push({...r,name:c,type:i,configuration:o});return n.connectionInstances[s-1]},prepareToBreakConnection(e){const o=n,r=[],i={},c=(0,t.readConfObject)(e,"name"),s=n.connectionInstances.find((e=>e.name===c));if(s){for(const e of s.tracks){const n=o.getReferring(e);o.removeReferring(n,e,r,i)}return[()=>{r.forEach((e=>{e()})),this.breakConnection(e)},i]}},breakConnection(e){const o=(0,t.readConfObject)(e,"name"),r=n.connectionInstances.find((e=>e.name===o));if(!r)throw new Error(`no connection found with name ${o}`);n.connectionInstances.remove(r)},deleteConnection(e){const{jbrowse:o}=n;return o.deleteConnectionConf(e)},addConnectionConf(e){const{jbrowse:o}=n;return o.addConnectionConf(e)},clearConnections(){n.connectionInstances.clear()}})))}function s(e){return(0,i.qk)(e)&&"connectionInstances"in e}}}]);
//# sourceMappingURL=7691.0ca9d047.chunk.js.map