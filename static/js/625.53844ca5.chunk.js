"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[625],{9807(e,t,o){o.d(t,{A:()=>m});var n=o(42918),r=o(77251),s=o(64074),i=o(30936),l=o(38715),a=o(52061),c=o(32118);const d=e=>{const t=(0,i.c)(11),{x:o,y:n,width:s,height:d,color:h}=e,u=(0,l.A)();let p,x,m;return t[0]!==h||t[1]!==u?(p=h||(0,a.X4)(u.palette.background.paper,.8),t[0]=h,t[1]=u,t[2]=p):p=t[2],t[3]!==p?(x=(0,r.getFillProps)(p),t[3]=p,t[4]=x):x=t[4],t[5]!==d||t[6]!==x||t[7]!==s||t[8]!==o||t[9]!==n?(m=(0,c.jsx)("rect",{pointerEvents:"auto",x:o,y:n,width:s,height:d,...x}),t[5]=d,t[6]=x,t[7]=s,t[8]=o,t[9]=n,t[10]=m):m=t[10],m},h=function(e){const t=(0,i.c)(4),{source:o,idx:n,rowHeight:r}=e,{color:s}=o;let l;return t[0]!==s||t[1]!==n||t[2]!==r?(l=s?(0,c.jsx)(d,{y:n*r,x:0,width:15.5,height:r+.5,color:s}):null,t[0]=s,t[1]=n,t[2]=r,t[3]=l):l=t[3],l},u=function(e){const t=(0,i.c)(6),{source:o,idx:n,rowHeight:r,textFillProps:s}=e,{color:l,name:a}=o,d=Math.min(r,12),h=(n+.5)*r,u=l?17:0;let p;return t[0]!==a||t[1]!==d||t[2]!==h||t[3]!==u||t[4]!==s?(p=(0,c.jsx)("text",{y:h,x:u,fontSize:d,dominantBaseline:"central",...s,children:a}),t[0]=a,t[1]=d,t[2]=h,t[3]=u,t[4]=s,t[5]=p):p=t[5],p},p=(0,s.observer)(function({model:e,labelWidth:t}){const{canDisplayLabels:o,rowHeight:s,sources:i}=e,a=(0,l.A)(),p=t+((0,n.useMemo)(()=>i?.some(e=>e.color)??!1,[i])?20:0),x=(0,n.useMemo)(()=>(0,r.getFillProps)(a.palette.text.primary),[a.palette.text.primary]);return i?(0,c.jsxs)(c.Fragment,{children:[o?(0,c.jsx)(d,{y:0,x:0,width:p,height:(i.length+.25)*s}):null,i.map((e,t)=>(0,c.jsx)(h,{source:e,idx:t,rowHeight:s},`${e.name}-${t}`)),o?i.map((e,t)=>(0,c.jsx)(u,{source:e,idx:t,rowHeight:s,textFillProps:x},`${e.name}-text-${t}`)):null]}):null}),x=(0,s.observer)(function({children:e,model:t,exportSVG:o}){const{id:n,scrollTop:s,height:i,hierarchy:l,treeAreaWidth:a,showTree:d}=t,h=`legend-${"undefined"==typeof jest?n:"test"}`,u=l&&d?a:0;return o?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("defs",{children:(0,c.jsx)("clipPath",{id:h,children:(0,c.jsx)("rect",{x:0,y:0,width:1e3,height:i})})}),(0,c.jsx)("g",{clipPath:`url(#${h})`,children:(0,c.jsx)("g",{transform:`translate(0,${-s})`,children:e})})]}):(0,c.jsx)("svg",{style:{position:"absolute",top:0,left:u,zIndex:100,pointerEvents:"none",height:t.totalHeight,width:(0,r.getContainingView)(t).width},children:e})}),m=(0,s.observer)(function(e){const{model:t}=e,{canDisplayLabels:o,rowHeight:s,sources:i}=t,l=Math.min(s,12),a=(0,n.useMemo)(()=>{if(!i)return 0;let e=0;for(const t of i){const n=o?(0,r.measureText)(t.name,l)+10:20;n>e&&(e=n)}return e},[i,l,o]);return i?(0,c.jsx)(x,{...e,children:(0,c.jsx)(p,{model:t,labelWidth:a})}):null})},14972(e,t,o){o.d(t,{A:()=>s});var n=o(30936),r=o(42918);function s(e){const t=(0,n.c)(6),o=(0,r.useRef)(void 0),[s,i]=(0,r.useState)();let l;t[0]!==e?(l=t=>{o.current&&cancelAnimationFrame(o.current);const n=t.clientX,r=t.clientY;o.current=requestAnimationFrame(()=>{const t=e.current?.getBoundingClientRect();t&&i({x:n-t.left,y:r-t.top,offsetX:t.left,offsetY:t.top})})},t[0]=e,t[1]=l):l=t[1];const a=l;let c;t[2]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{o.current&&cancelAnimationFrame(o.current),i(void 0)},t[2]=c):c=t[2];const d=c;let h;return t[3]!==a||t[4]!==s?(h={mouseState:s,handleMouseMove:a,handleMouseLeave:d},t[3]=a,t[4]=s,t[5]=h):h=t[5],h}},90625(e,t,o){o.r(t),o.d(t,{default:()=>c});var n=o(42918),r=o(64074),s=o(98234),i=o(95766),l=o(14972),a=o(32118);const c=(0,r.observer)(function(e){const{model:t}=e,{height:o}=t,r=(0,n.useRef)(null),{mouseState:c,handleMouseMove:d,handleMouseLeave:h}=(0,l.A)(r);return(0,a.jsxs)("div",{ref:r,style:{position:"relative",height:o},onMouseMove:d,onMouseLeave:h,children:[(0,a.jsx)(i.A,{model:t}),c?(0,a.jsx)(s.A,{mouseX:c.x,mouseY:c.y,offsetX:c.offsetX,offsetY:c.offsetY,model:t}):null]})})},95766(e,t,o){o.d(t,{A:()=>g});var n=o(18769),r=o(64074),s=o(9807),i=o(42918),l=o(28397),a=o(77251),c=o(57141),d=o(65045),h=o(52061),u=o(38567),p=o(32118);const x=(0,d.n)()(e=>({resizeHandle:{position:"absolute",top:0,height:"100%",width:4,zIndex:101,background:"transparent","&:hover":{background:e.palette.divider}},treeBackground:{position:"absolute",top:0,left:0,background:(0,h.X4)(e.palette.background.paper,.8)}}));function m(e){return e.children?.length?e.children.flatMap(e=>m(e)):[e.data.name]}const f=(0,r.observer)(function({model:e}){const{classes:t}=x(),{width:o}=(0,a.getContainingView)(e),[n,r]=(0,i.useState)(null),[s,d]=(0,i.useState)([]),{hierarchy:h,treeAreaWidth:f,height:g,scrollTop:v,showTree:w,sources:b}=e,y=(0,i.useCallback)(t=>{e.setTreeCanvasRef(t)},[e,f,g]),j=(0,i.useCallback)(t=>{e.setMouseoverCanvasRef(t)},[e,o,g]);(0,i.useEffect)(()=>(0,u.autorun)(function(){const{treeAreaWidth:t,hierarchy:o,totalHeight:n}=e;if(!o)return r(null),void d([]);const s=o.descendants().filter(e=>e.children?.length),i=new c.A(s.length);for(const e of s){const t=e.y,o=e.x;i.add(t-8,o-8,t+8,o+8)}i.finish(),r(i),d(s)},{name:"TreeSpatialIndex"}),[e]);const k=(0,i.useCallback)(t=>{if(!h||!n)return;const o=t.currentTarget.getBoundingClientRect(),r=t.clientX-o.left,i=t.clientY-o.top+v,l=n.search(r,i,r,i),a=l.length>0?s[l[0]]:void 0;a?e.setHoveredTreeNode({node:a,descendantNames:m(a)}):e.setHoveredTreeNode(void 0)},[h,n,s,v,e]),M=(0,i.useCallback)(()=>{e.setHoveredTreeNode(void 0)},[e]);return h&&w&&b?.length?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{position:"sticky",top:0,left:0,height:0,zIndex:100},children:[(0,p.jsx)("div",{className:t.treeBackground,style:{width:f,height:g}}),(0,p.jsx)("canvas",{ref:y,width:2*f,height:2*g,style:{width:f,height:g,position:"absolute",top:0,left:0,pointerEvents:"none"}}),(0,p.jsx)("canvas",{ref:j,width:o,height:g,style:{position:"absolute",top:0,left:0,zIndex:1,pointerEvents:"none"}}),(0,p.jsx)("div",{onMouseMove:k,onMouseLeave:M,style:{position:"absolute",top:0,left:0,width:f,height:g,zIndex:2,cursor:"pointer"}})]}),(0,p.jsx)(l.A,{onDrag:t=>{e.setTreeAreaWidth(Math.max(50,f+t))},className:t.resizeHandle,style:{left:f},vertical:!0})]}):null}),g=(0,r.observer)(function({model:e,topOffset:t=0,testId:o}){const{setScrollTop:r,autoHeight:i,availableHeight:l}=e;return(0,p.jsxs)("div",{"data-testid":o,style:{position:"absolute",top:t,height:l,width:"100%",overflowY:i?"hidden":"auto",overflowX:"hidden"},onScroll:e=>{r(e.currentTarget.scrollTop)},children:[(0,p.jsx)(f,{model:e}),(0,p.jsx)(s.A,{model:e}),(0,p.jsx)("div",{style:{position:"absolute",left:0,width:"100%"},children:(0,p.jsx)(n.Ay,{model:e})})]})})},98234(e,t,o){o.d(t,{A:()=>m});var n=o(42918),r=o(77251),s=o(65045),i=o(64074),l=o(30936),a=o(52061),c=o(86077),d=o(32118);const h=(0,s.n)()(e=>({tooltip:{position:"fixed",top:0,left:0,pointerEvents:"none",backgroundColor:(0,a.X4)(e.palette.grey[700],.9),borderRadius:e.shape.borderRadius,color:e.palette.common.white,fontFamily:e.typography.fontFamily,padding:"4px 8px",fontSize:e.typography.fontSize,maxWidth:300,wordWrap:"break-word",zIndex:1e5},row:{whiteSpace:"nowrap"},colorBox:{width:10,height:10,display:"inline-block",marginRight:4}})),u=new Set(["color","HP","name","baseName","id"]),p=(0,n.memo)(function(e){const t=(0,l.c)(17),{source:o,x:n,y:r}=e,{classes:s}=h(),i=s.tooltip,a=`translate(${n+10}px, ${r+10}px)`;let p,x,m,f,g;return t[0]!==a?(p={transform:a},t[0]=a,t[1]=p):p=t[1],t[2]!==s.colorBox||t[3]!==o.color?(x=o.color?(0,d.jsx)("div",{className:s.colorBox,style:{backgroundColor:o.color}}):null,t[2]=s.colorBox,t[3]=o.color,t[4]=x):x=t[4],t[5]!==s.row||t[6]!==o.name?(m=o.name?(0,d.jsx)("div",{className:s.row,children:o.name}):null,t[5]=s.row,t[6]=o.name,t[7]=m):m=t[7],t[8]!==s.row||t[9]!==o?(f=Object.entries(o).map(e=>{const[t,o]=e;return u.has(t)||void 0===o?null:(0,d.jsxs)("div",{className:s.row,children:[t,": ",String(o)]},t)}),t[8]=s.row,t[9]=o,t[10]=f):f=t[10],t[11]!==s.tooltip||t[12]!==p||t[13]!==x||t[14]!==m||t[15]!==f?(g=(0,d.jsx)(c.A,{children:(0,d.jsxs)("div",{className:i,style:p,children:[x,m,f]})}),t[11]=s.tooltip,t[12]=p,t[13]=x,t[14]=m,t[15]=f,t[16]=g):g=t[16],g}),x=(0,s.n)()(e=>({container:{position:"absolute",top:0,left:0,pointerEvents:"none",zIndex:800},horizontalLine:{position:"absolute",left:0,height:1,backgroundColor:e.palette.text.primary,pointerEvents:"none"},verticalLine:{position:"absolute",top:0,width:1,backgroundColor:e.palette.text.primary,pointerEvents:"none"}})),m=(0,i.observer)(function({mouseX:e,mouseY:t,model:o,offsetX:s,offsetY:i}){const{classes:l}=x(),{hoveredGenotype:a,height:c,sourceMap:h}=o,{width:u}=(0,r.getContainingView)(o),m=(0,n.useMemo)(()=>{if(!a)return;const e=h?.[a.name];return e?{...e,...a}:void 0},[a,h]);return(0,d.jsxs)("div",{className:l.container,style:{width:u,height:c},children:[(0,d.jsx)("div",{className:l.horizontalLine,style:{transform:`translateY(${t}px)`,width:u}}),(0,d.jsx)("div",{className:l.verticalLine,style:{transform:`translateX(${e}px)`,height:c}}),m?(0,d.jsx)(p,{source:m,x:s+e,y:i+t}):null]})})}}]);
//# sourceMappingURL=625.53844ca5.chunk.js.map