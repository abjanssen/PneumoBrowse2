"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[4933],{44933(t,e,a){a.d(e,{default:()=>p});var s=a(90946),r=a(57379),i=a(43921),n=a(23886),o=a(43102),c=a(25529),u=a(55774),l=a(43073);function g(t){const e=t.slice(t.lastIndexOf("/")+1);return e.slice(0,e.lastIndexOf("."))}class p extends s.L{static capabilities=["hasResolution","hasLocalStats","hasGlobalStats"];async getAdapters(){return this.adaptersP||(this.adaptersP=this.getAdaptersImpl()),this.adaptersP}async getAdaptersImpl(){const t=this.getSubAdapter;if(!t)throw new Error("no getSubAdapter available");let e=this.getConf("subadapters");return e?.length||(e=this.getConf("bigWigs").map(t=>({type:"BigWigAdapter",source:g(t),bigWigLocation:{uri:t}}))),Promise.all(e.map(async e=>{const a=(await t(e)).dataAdapter,s=e.source||e.name||function(t){try{if("BigWigAdapter"===t.type&&t.bigWigLocation){const e=t.bigWigLocation;if("uri"in e&&e.uri)return g(e.uri);if("localPath"in e&&e.localPath)return g(e.localPath);if("blob"in e&&e.blob){const t=e.blob;return t.name?g(t.name):void 0}}return}catch(t){return}}(e)||a.id;return{...e,dataAdapter:a,source:s}}))}async getRefNames(t){const e=await this.getAdapters(),a=await Promise.all(e.map(e=>e.dataAdapter.getRefNames(t)));return[...new Set(a.flat())]}async getGlobalStats(t){const e=await this.getAdapters(),a=(await Promise.all(e.map(e=>e.dataAdapter.getGlobalStats?.(t)))).filter(t=>!!t);return{scoreMin:(0,n.min)(a.map(t=>t.scoreMin)),scoreMax:(0,n.max)(a.map(t=>t.scoreMax))}}getFeatures(t,e={}){return(0,c.ObservableCreate)(async a=>{let s=await this.getAdapters();if(e.sources?.length){const t=new Set(e.sources.map(t=>t.name));s=s.filter(e=>t.has(e.source))}(0,u.h)(...s.map(a=>{const{source:s,dataAdapter:r}=a;return r.getFeatures(t,e).pipe((0,l.T)(t=>{if(t.get("source"))return t;const e=t.toJSON();return e.uniqueId=`${s}-${t.id()}`,e.source=s,new o.A(e)}))})).subscribe(a)},e.stopToken)}async getRegionQuantitativeStats(t,e){const a=await this.getAdapters(),s=await Promise.all(a.map(async a=>{const{dataAdapter:s}=a;return s.getRegionQuantitativeStats(t,e)}));return(0,r.iz)(s.filter(Boolean))}async getMultiRegionFeatureDensityStats(t){return{featureDensity:0}}async getMultiRegionQuantitativeStats(t=[],e={}){if(!t.length)return(0,i.Yv)();const a=await this.getAdapters(),s=await Promise.all(a.map(async a=>{const{dataAdapter:s}=a;return s.getMultiRegionQuantitativeStats(t,e)}));return(0,r.iz)(s.filter(Boolean))}async getSources(t){return(await this.getAdapters()).map(({type:t,bigWigLocation:e,dataAdapter:a,...s})=>({...s,name:s.source}))}}}}]);
//# sourceMappingURL=4933.dba65ffa.chunk.js.map