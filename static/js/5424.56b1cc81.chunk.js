"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5424],{55187(e,t,r){r.d(t,{A:()=>l});var n=r(30936),i=r(77251),s=r(32118);function l(e){const t=(0,n.c)(12),{items:r,width:i,legendAreaWidth:l}=e;if(0===r.length)return null;const a=14*r.length+6;let c;t[0]!==r?(c=Math.max(...r.map(o)),t[0]=r,t[1]=c):c=t[1];const d=20+c+6,h=`translate(${l?i+10:i-d-10}, 10)`;let x,f,g;if(t[2]!==a||t[3]!==d?(x=(0,s.jsx)("rect",{x:0,y:0,width:d,height:a,fill:"rgba(255,255,255,0.9)",stroke:"#ccc",strokeWidth:1,rx:4}),t[2]=a,t[3]=d,t[4]=x):x=t[4],t[5]!==r){let e;t[7]===Symbol.for("react.memo_cache_sentinel")?(e=(e,t)=>(0,s.jsxs)("g",{transform:`translate(3, ${3+14*t})`,children:[e.color?(0,s.jsx)("rect",{x:0,y:0,width:12,height:12,fill:e.color}):null,(0,s.jsx)("text",{x:18,y:10,fontSize:10,fill:"black",children:e.label})]},`legend-${t}`),t[7]=e):e=t[7],f=r.map(e),t[5]=r,t[6]=f}else f=t[6];return t[8]!==h||t[9]!==x||t[10]!==f?(g=(0,s.jsxs)("g",{transform:h,children:[x,f]}),t[8]=h,t[9]=x,t[10]=f,t[11]=g):g=t[11],g}function o(e){return(0,i.measureText)(e.label,10)}},75424(e,t,r){r.d(t,{renderBaseLinearDisplaySvg:()=>u});var n=r(42918),i=r(17868),s=r(77251),l=r(28423),o=r(55187),a=r(98445),c=r(15705),d=r(30936),h=r(32118);function x(e){const t=(0,d.c)(9),{error:r,width:n,height:i}=e;let s;t[0]!==i||t[1]!==n?(s=(0,h.jsx)("rect",{x:0,y:0,width:n,height:i,fill:"#ffdddd"}),t[0]=i,t[1]=n,t[2]=s):s=t[2];const l=i/2,o=`${r}`;let a,c;return t[3]!==l||t[4]!==o?(a=(0,h.jsx)("text",{x:10,y:l,fill:"#cc0000",fontSize:14,children:o}),t[3]=l,t[4]=o,t[5]=a):a=t[5],t[6]!==s||t[7]!==a?(c=(0,h.jsxs)(h.Fragment,{children:[s,a]}),t[6]=s,t[7]=a,t[8]=c):c=t[8],c}const f=new Map;function g(e,t){const r=`${e}:${t}`;let n=f.get(r);if(void 0===n){if(n=(0,s.measureText)(e,t),f.size>500){const e=f.keys().next().value;e&&f.delete(e)}f.set(r,n)}return n}async function u(e,t){const{height:r,id:d}=e,{overrideHeight:f}=t,u=(0,s.getContainingView)(e),{offsetPx:m,roundedDynamicBlocks:j,width:p}=u;if(e.error)return(0,h.jsx)(x,{error:e.error,width:p,height:r});const y=await Promise.all(j.map(async r=>{const n=a.A.create({key:r.key,region:r}),i=e.regionCannotBeRenderedText(r)||e.regionCannotBeRendered(r);if(i)return[r,{reactElement:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("rect",{x:0,y:0,width:p,height:20,fill:"#aaa"}),(0,h.jsx)("text",{x:0,y:15,children:i})]})}];const{rpcManager:s,renderArgs:l,renderProps:o,renderingProps:c,rendererType:d}=(0,a.s)(n,e);return[r,await d.renderInClient(s,{...l,...o,renderingProps:c,exportSVG:t,theme:t.theme||o.theme})]})),{assemblyManager:w}=(0,s.getSession)(e),{offsetPx:b}=u,P=u.assemblyNames[0],k=P?w.get(P):void 0,$=function(e,t,r,n){if(!r)return[];const i=[];for(const[l,o]of e.layoutFeatures.entries()){if(!o?.[4])continue;const[e,,a,c,d]=o,{refName:h,description:x,label:f,totalLayoutWidth:u}=d;if(!f)continue;const m=r.getCanonicalRefName2(h),j=t.bpToPx({refName:m,coord:e})?.offsetPx,p=t.bpToPx({refName:m,coord:a})?.offsetPx;if(void 0===j)continue;const y=void 0!==p?Math.min(j,p):j,w=void 0!==p?Math.max(j,p):j,b=g(f,11),P=void 0!==u?y+u:w,k=(0,s.clamp)(0,y-n,P-n-b),$=c-14*(+!!x+ +!!f);i.push({key:l,label:f,description:x||"",leftPos:k,topPos:$})}return i}(e,u,k,b),v=(0,c.OX)(d,"labels"),T=(0,i.createJBrowseTheme)(t.theme),C=e.showLegend?e.legendItems(T):[];return(0,h.jsxs)(h.Fragment,{children:[y.map(([e,t],i)=>{const{offsetPx:s,widthPx:o}=e,a=s-m,x=(0,c.OX)(d,i);return(0,h.jsxs)(n.Fragment,{children:[(0,h.jsx)("defs",{children:(0,h.jsx)("clipPath",{id:x,children:(0,h.jsx)("rect",{x:0,y:0,width:o,height:f||r})})}),(0,h.jsx)("g",{transform:`translate(${a} 0)`,children:(0,h.jsx)("g",{clipPath:`url(#${x})`,children:(0,h.jsx)(l.aE,{rendering:t})})})]},`frag-${i}`)}),(0,h.jsx)("defs",{children:(0,h.jsx)("clipPath",{id:v,children:(0,h.jsx)("rect",{x:0,y:0,width:p,height:f||r})})}),(0,h.jsx)("g",{clipPath:`url(#${v})`,children:$.map(({key:e,label:t,description:r,leftPos:n,topPos:i})=>(0,h.jsxs)("g",{transform:`translate(${n}, ${i})`,children:[(0,h.jsx)("text",{x:0,y:11,fontSize:11,fill:"currentColor",children:t}),r?(0,h.jsx)("text",{x:0,y:25,fontSize:11,fill:"blue",children:r}):null]},`label-${e}`))}),C.length>0?(0,h.jsx)(o.A,{items:C,width:p,legendAreaWidth:t.legendWidth}):null]})}}}]);
//# sourceMappingURL=5424.56b1cc81.chunk.js.map