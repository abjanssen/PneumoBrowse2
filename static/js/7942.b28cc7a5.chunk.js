"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[7942],{59773:(e,t,n)=>{n.d(t,{Ay:()=>m,Cx:()=>c,Nz:()=>u,lc:()=>d,rE:()=>l});var o=n(45103),r=n.n(o),s=n(12678),a=n(2862),i=n(99546);function l(e){return(void 0!==e.umdUrl||void 0!==e.url||void 0!==e.umdLoc)&&void 0!==e.name}function c(e){return void 0!==e.esmUrl||void 0!==e.esmLoc}function u(e){return void 0!==e.cjsUrl}function d(e){return l(e)?`UMD plugin ${e.name}`:c(e)?`ESM plugin ${e.esmUrl||e.esmLoc.uri}`:u(e)?`CJS plugin ${e.cjsUrl}`:"unknown plugin"}class m{definitions=[];constructor(e=[],t){this.fetchESM=t?.fetchESM,this.fetchCJS=t?.fetchCJS,this.definitions=JSON.parse(JSON.stringify(e))}async loadCJSPlugin(e,t){const n=new URL(e.cjsUrl,t);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`Cannot load plugins using protocol "${n.protocol}"`);if(!this.fetchCJS)throw new Error("No fetchCJS callback provided");return this.fetchCJS(n.href)}async loadESMPlugin(e,t){const n="esmUrl"in e?new URL(e.esmUrl,t):new URL(e.esmLoc.uri,e.esmLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`cannot load plugins using protocol "${n.protocol}"`);if(!this.fetchESM)throw new Error("No ESM fetcher installed");const o=await this.fetchESM(n.href);if(!o)throw new Error(`Could not load ESM plugin: ${n}`);return o}async loadUMDPlugin(e,t){const n="url"in e?new URL(e.url,t):"umdUrl"in e?new URL(e.umdUrl,t):new URL(e.umdLoc.uri,e.umdLoc.baseUri);if("http:"!==n.protocol&&"https:"!==n.protocol)throw new Error(`cannot load plugins using protocol "${n.protocol}"`);const o=e.name,a=`JBrowsePlugin${o}`;"undefined"==typeof jest?await async function(e){if(!Boolean("WorkerGlobalScope"in globalThis))return t=e,new Promise(((e,n)=>{r()(t,((t,o)=>{t?n(t):e(o.src)}))}));var t;if(!globalThis.importScripts)throw new Error("cannot figure out how to load external JS scripts in this environment");await globalThis.importScripts(e)}(n.href):globalThis[a]={default:s.A};const i=globalThis[a];if(!i)throw new Error(`Failed to load UMD bundle for ${o}, ${a} is undefined`);return i}async loadPlugin(e,t){let n;if(i.isElectron&&u(e))n=await this.loadCJSPlugin(e,t);else if(c(e))n=await this.loadESMPlugin(e,t);else{if(!l(e))throw!i.isElectron&&u(e)?new Error(`CommonJS plugin found, but not in a NodeJS environment: ${JSON.stringify(e)}`):new Error(`Could not determine plugin type: ${JSON.stringify(e)}`);n=await this.loadUMDPlugin(e,t)}if(!n.default)throw new Error(`${d(e)} does not have a default export, cannot load`);return n.default}installGlobalReExports(e){return e.JBrowseExports=Object.fromEntries(Object.entries(a.A).map((([e,t])=>[e,t]))),this}async load(e){return Promise.all(this.definitions.map((async t=>({plugin:await this.loadPlugin(t,e),definition:t}))))}}},68584:(e,t,n)=>{n.r(t),n.d(t,{ConfigurationReference:()=>o.A,ConfigurationSchema:()=>o.S,getConf:()=>r.FI,getTypeNamesFromExplicitlyTypedUnion:()=>r.JC,isBareConfigurationSchemaType:()=>r.C$,isConfigurationModel:()=>r.wo,isConfigurationSchemaType:()=>r.oG,isConfigurationSlotType:()=>r.Rg,readConfObject:()=>r.QZ});var o=n(42498),r=n(35254)},3496:(e,t,n)=>{n.d(t,{LS:()=>r,cK:()=>a,pZ:()=>i});var o=n(26257);function r(e={}){return`${(0,o.A)(e)}`}let s={};async function a(e,t,n){const o=r(n);if(!s[o]){const r=n?.type;if(!r)throw new Error(`could not determine adapter type from adapter config snapshot ${JSON.stringify(n)}`);const i=e.getAdapterType(r);if(!i)throw new Error(`unknown data adapter type ${r}`);const l=i.configSchema.create(n,{pluginManager:e}),c=a.bind(null,e,t),u=new(await i.getAdapterClass())(l,c,e);s[o]={dataAdapter:u,sessionIds:new Set([t])}}const i=s[o];return i.sessionIds.add(t),i}function i(e){let t=0;const n=Object.keys(e);if(1===n.length&&"sessionId"===n[0]){const{sessionId:n}=e;Object.entries(s).forEach((([e,o])=>{o.sessionIds.delete(n),0===o.sessionIds.size&&(t+=1,delete s[e])}))}else Object.values(s).forEach((t=>{const n=e.regions||(e.region?[e.region]:[]);for(const e of n)void 0!==e.refName&&t.dataAdapter.freeResources(e)}));return t}},85206:(e,t,n)=>{n.d(t,{A:()=>A});var o=n(7552),r=n(68850),s=n(29629),a=n(66765),i=n(81453),l=n(2051),c=n(24387),u=n(55851),d=n(63672),m=n(45266),p=n(8463);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},f.apply(null,arguments)}const g=o.createContext({parentPopupState:null,rootPopupState:null});function h({onClick:e,closeAfterItemClick:t,...n}){const{rootPopupState:r}=(0,o.useContext)(g);if(!r)throw new Error("must be used inside a CascadingMenu");return o.createElement(s.A,f({},n,{onClick:n=>{t&&r.close(),e?.(n)}}))}function y({title:e,Icon:t,inset:n,popupId:l,...c}){const{parentPopupState:u}=(0,o.useContext)(g),d=(0,m.T6)({popupId:l,variant:"popover",parentPopupState:u});return o.createElement(o.Fragment,null,o.createElement(s.A,f({},(0,m._k)(d),(0,m.oe)(d)),t?o.createElement(a.A,null,o.createElement(t,null)):null,o.createElement(i.A,{primary:e,inset:n}),o.createElement(r.A,null)),o.createElement(w,f({},c,{anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},popupState:d})))}function w({popupState:e,onMenuItemClick:t,menuItems:n,classes:r,...s}){const{rootPopupState:a}=(0,o.useContext)(g),i=(0,o.useMemo)((()=>({rootPopupState:a||e,parentPopupState:e})),[a,e]);return o.createElement(g.Provider,{value:i},o.createElement(d.A,f({},s,(0,m.NA)(e))))}function b({popupState:e,onMenuItemClick:t,menuItems:n,...r}){const{rootPopupState:s}=(0,o.useContext)(g),a=(0,o.useMemo)((()=>({rootPopupState:s||e,parentPopupState:e})),[s,e]);return o.createElement(g.Provider,{value:a},o.createElement(l.A,f({},r,(0,m.NA)(e))))}function v({item:e}){return"subMenu"in e?o.createElement(p.m,{type:"subMenu"}):"checkbox"===e.type||"radio"===e.type?o.createElement(p.m,{type:e.type,checked:e.checked,disabled:e.disabled}):null}function C({onMenuItemClick:e,closeAfterItemClick:t,menuItems:n,...r}){const s=n.some((e=>"icon"in e&&e.icon));return o.createElement(o.Fragment,null,n.sort(((e,t)=>(t.priority||0)-(e.priority||0))).map(((n,l)=>{return"subMenu"in n?o.createElement(y,{key:`subMenu-${n.label}-${l}`,popupId:`subMenu-${n.label}`,title:n.label,Icon:n.icon,inset:s&&!n.icon,onMenuItemClick:e,menuItems:n.subMenu},o.createElement(C,f({},r,{closeAfterItemClick:t,onMenuItemClick:e,menuItems:n.subMenu}))):"divider"===n.type?o.createElement(c.A,{key:`divider-${JSON.stringify(n)}-${l}`,component:"li"}):"subHeader"===n.type?o.createElement(u.A,{key:`subHeader-${n.label}-${l}`},n.label):o.createElement(h,{key:`${n.label}-${l}`,closeAfterItemClick:t,onClick:"onClick"in n?(d=n.onClick,t=>{e(t,d)}):void 0,disabled:Boolean(n.disabled)},n.icon?o.createElement(a.A,null,o.createElement(n.icon,null)):null," ",o.createElement(i.A,{primary:n.label,secondary:n.subLabel,inset:s&&!n.icon}),o.createElement("div",{style:{flexGrow:1,minWidth:10}}),o.createElement(v,{item:n}));var d})))}const A=function(e){const{closeAfterItemClick:t=!0,...n}=e;return o.createElement(b,n,o.createElement(C,f({},n,{closeAfterItemClick:t})))}},92562:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(7552),r=n(57468),s=n(30157),a=n(48231),i=n(40985),l=n(2187),c=n(43163),u=n(61723),d=n(24387),m=n(20139),p=n(89022),f=n(68446),g=n(75785),h=n(38033),y=n(13476);const w=(0,g.n9)()((e=>({closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}})));function b({error:e}){return o.createElement("div",{style:{width:800,margin:40}},o.createElement(h.A,{error:e}))}const v=(0,f.observer)((function(e){const{classes:t}=w(),{title:n,header:f,children:g,onClose:h}=e,v=(0,a.A)();return o.createElement(i.A,e,o.createElement(l.A,null,o.isValidElement(f)?f:o.createElement(c.A,null,o.createElement(y.A,{html:n||""}),h?o.createElement(u.A,{className:t.closeButton,onClick:()=>{h()}},o.createElement(s.A,null)):null),o.createElement(d.A,null),o.createElement(r.t,{FallbackComponent:b},o.createElement(m.A,{theme:(0,p.A)(v,{components:{MuiInputBase:{styleOverrides:{input:{boxSizing:"content-box!important"}}}}})},g))))}))},88373:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(7552),r=n(40085),s=n(48231),a=n(36715),i=n(98879);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},l.apply(null,arguments)}const c=(0,n(75785).n9)()((e=>({input:{},inputBase:{},typography:{top:6,left:2,position:"absolute",whiteSpace:"nowrap",visibility:"hidden"},inputRoot:{padding:e.spacing(.5)},inputFocused:{borderStyle:"solid",borderWidth:2}}))),u=o.forwardRef((function(e,t){const{value:n,setValue:u,variant:d,...m}=e,[p,{width:f}]=(0,r.A)(),[g,h]=(0,o.useState)(),[y,w]=(0,o.useState)(null),[b,v]=(0,o.useState)(!1);(0,o.useEffect)((()=>{b&&(y?.blur(),v(!1))}),[b,y]);const{classes:C}=c(e,{props:e}),A=(0,s.A)(),S=void 0===g?n:g;return o.createElement("div",l({},m,{ref:t}),o.createElement("div",{style:{position:"relative"}},o.createElement(a.A,{ref:p,component:"span",variant:d,className:C.typography},S)),o.createElement(i.Ay,{inputRef:e=>{w(e)},className:C.inputBase,inputProps:{style:{width:f,...d&&"inherit"!==d?A.typography[d]:{}}},classes:{input:C.input,root:C.inputRoot,focused:C.inputFocused},value:S,onChange:e=>{h(e.target.value)},onKeyDown:e=>{"Enter"===e.key?y?.blur():"Escape"===e.key&&(h(void 0),v(!0))},onBlur:()=>{u(g||n||""),h(void 0)}}))}))},38033:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(7552),r=n(4902),s=n(71627),a=n(89003),i=n(61723),l=n(75785),c=n(21311);const u=(0,o.lazy)((()=>Promise.all([n.e(1631),n.e(4630)]).then(n.bind(n,74630)))),d=(0,l.n9)()((e=>({bg:{background:e.palette.divider,border:"1px solid black",margin:20},iconFloat:{float:"right",marginLeft:100}})));function m({error:e,onReset:t}){const{classes:n}=d(),[l,c]=(0,o.useState)(!1);return o.createElement("div",{className:n.iconFloat},"object"==typeof e&&e&&"stack"in e?o.createElement(a.A,{title:"Get stack trace"},o.createElement(i.A,{onClick:()=>{c(!0)},color:"primary"},o.createElement(s.A,null))):null,t?o.createElement(a.A,{title:"Retry"},o.createElement(i.A,{onClick:t,color:"primary"},o.createElement(r.A,null))):null,l?o.createElement(o.Suspense,{fallback:null},o.createElement(u,{error:e,onClose:()=>{c(!1)}})):null)}const p=function({error:e,onReset:t}){const{classes:n}=d(),r=`${e}`,s=r.indexOf("expected an instance of"),a=-1!==s?r.slice(0,s):r,i=function(e){let t="";const n=e.indexOf("is not assignable");if(-1!==n){const o=e.slice(0,n+17),r=/.*at path "(.*)" snapshot `(.*)` is not assignable/m.exec(o);r&&(e=`Failed to load element at ${r[1]}...Failed element had snapshot`,t=r[2]);const s=/.*snapshot `(.*)` is not assignable/.exec(o);s&&(e="Failed to load element...Failed element had snapshot",t=s[1])}return t}(r);return o.createElement(c.A,null,a.slice(0,1e4),o.createElement(m,{error:e,onReset:t}),i?o.createElement("pre",{className:n.bg},JSON.stringify(JSON.parse(i),null,2)):null)}},69941:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var o=n(7552),r=n(92562),s=n(29499),a=n(99123),i=n(58507),l=n(5401);function c({onClose:e,open:t,onFactoryReset:n}){function c(t){"reset"===t&&n(),e()}return o.createElement(r.A,{title:"Reset",onClose:()=>{c()},open:t},o.createElement(s.A,null,o.createElement(a.A,null,"Are you sure you want to reset? This will restore the default configuration.")),o.createElement(i.A,null,o.createElement(l.A,{onClick:()=>{c()},color:"primary"},"Cancel"),o.createElement(l.A,{onClick:()=>{c("reset")},color:"primary",variant:"contained"},"OK")))}},90542:(e,t,n)=>{n.d(t,{A8:()=>c,PM:()=>s,jT:()=>a,uB:()=>l,xU:()=>i});var o=n(7552),r=n(2859);function s(e){return o.createElement(r.A,e,o.createElement("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"}))}function a(e){return o.createElement(r.A,e,o.createElement("path",{d:"M19.31 18.9L22.39 22L21 23.39L17.88 20.32C17.19 20.75 16.37 21 15.5 21C13 21 11 19 11 16.5C11 14 13 12 15.5 12C18 12 20 14 20 16.5C20 17.38 19.75 18.21 19.31 18.9M15.5 19C16.88 19 18 17.88 18 16.5C18 15.12 16.88 14 15.5 14C14.12 14 13 15.12 13 16.5C13 17.88 14.12 19 15.5 19M21 4V6H3V4H21M3 16V14H9V16H3M3 11V9H21V11H18.97C17.96 10.37 16.77 10 15.5 10C14.23 10 13.04 10.37 12.03 11H3Z"}))}function i(e){return o.createElement(r.A,e,o.createElement("path",{d:"M21 19v-2H8v2h13m0-6v-2H8v2h13M8 7h13V5H8v2M4 5v2h2V5H4M3 5a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V5m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2m1 6v2h2v-2H4m-1 0a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1v-2z"}))}function l(e){return o.createElement(r.A,e,o.createElement("path",{fill:"currentColor",d:"M4,2H6V4C6,5.44 6.68,6.61 7.88,7.78C8.74,8.61 9.89,9.41 11.09,10.2L9.26,11.39C8.27,10.72 7.31,10 6.5,9.21C5.07,7.82 4,6.1 4,4V2M18,2H20V4C20,6.1 18.93,7.82 17.5,9.21C16.09,10.59 14.29,11.73 12.54,12.84C10.79,13.96 9.09,15.05 7.88,16.22C6.68,17.39 6,18.56 6,20V22H4V20C4,17.9 5.07,16.18 6.5,14.79C7.91,13.41 9.71,12.27 11.46,11.16C13.21,10.04 14.91,8.95 16.12,7.78C17.32,6.61 18,5.44 18,4V2M14.74,12.61C15.73,13.28 16.69,14 17.5,14.79C18.93,16.18 20,17.9 20,20V22H18V20C18,18.56 17.32,17.39 16.12,16.22C15.26,15.39 14.11,14.59 12.91,13.8L14.74,12.61M7,3H17V4L16.94,4.5H7.06L7,4V3M7.68,6H16.32C16.08,6.34 15.8,6.69 15.42,7.06L14.91,7.5H9.07L8.58,7.06C8.2,6.69 7.92,6.34 7.68,6M9.09,16.5H14.93L15.42,16.94C15.8,17.31 16.08,17.66 16.32,18H7.68C7.92,17.66 8.2,17.31 8.58,16.94L9.09,16.5M7.06,19.5H16.94L17,20V21H7V20L7.06,19.5Z"}))}function c(e){return o.createElement(r.A,e,o.createElement("path",{d:"M20 5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v1h-1v4c0 .55.45 1 1 1h1v7c0 1.1-.9 2-2 2s-2-.9-2-2V7c0-2.21-1.79-4-4-4S5 4.79 5 7v7H4c-.55 0-1 .45-1 1v4h1v1c0 .55.45 1 1 1h2c.55 0 1-.45 1-1v-1h1v-4c0-.55-.45-1-1-1H7V7c0-1.1.9-2 2-2s2 .9 2 2v10c0 2.21 1.79 4 4 4s4-1.79 4-4v-7h1c.55 0 1-.45 1-1V5h-1z"}))}},34895:(e,t,n)=>{n.d(t,{P:()=>a,R:()=>s});var o=n(7552);function r(e){return"black"===e?{midnight:"#808080",forrest:"#666666",grape:"#4d4d4d",mandarin:"#333333",gray:"#1a1a1a"}:"white"===e?{midnight:"#ffffff",forrest:"#e6e6e6",grape:"#cccccc",mandarin:"#b3b3b3",gray:"#999999"}:{midnight:"#0d233f",forrest:"#135560",grape:"#721e63",mandarin:"#ffb11d",gray:"#dadada"}}function s({variant:e}){return o.createElement("svg",{viewBox:"0 0 175 175"},o.createElement(i,{variant:e}))}function a({variant:e}){return o.createElement("svg",{viewBox:"0 0 641 175"},o.createElement(l,{variant:e}),o.createElement(i,{variant:e}))}function i({variant:e}){const t=r(e);return o.createElement(o.Fragment,null,o.createElement("path",{style:{fill:t.midnight},d:"M120.5,57.5c.168,0,.333.012.5.013V40.506c-.167,0-.333-.006-.5-.006a98.325,98.325,0,0,0-77.4,37.565q-2.664,3.378-5.023,6.994l14.206,9.327Q54.043,91.709,56,89.179A81.363,81.363,0,0,1,120.5,57.5Z"}),o.createElement("path",{style:{fill:t.forrest},d:"M148.668,86.223c.308.133.6.283.908.42l6.746-15.618c-.153-.067-.3-.143-.454-.21a81.36,81.36,0,0,0-71.777,3.5q-2.8,1.544-5.469,3.309l9.249,14.054A63.93,63.93,0,0,1,148.668,86.223Z"}),o.createElement("path",{style:{fill:t.grape},d:"M170.894,109.37A63.929,63.929,0,0,0,113.4,88.861l2.336,15.474a48.456,48.456,0,0,1,44.322,15.42c.111.125.214.255.324.381l11.16-10C171.323,109.879,171.118,109.62,170.894,109.37Z"}),o.createElement("path",{style:{fill:t.mandarin},d:"M150.921,150.314c.04.163.07.326.107.489l16.509-4.058c-.039-.163-.067-.326-.107-.489A48.457,48.457,0,0,0,135.575,111.8l-5.515,15.591A32.466,32.466,0,0,1,150.921,150.314Z"}),o.createElement("path",{style:{fill:t.gray},d:"M134.1,138.129l-9.779,13.213a32.486,32.486,0,0,1,7.823,14.463l15.147.852c.012-.166.032-.331.041-.5A32.464,32.464,0,0,0,134.1,138.129Z"}))}function l({variant:e}){const t=r(e);return o.createElement("g",{"aria-label":"JBrowse",transform:"translate(213.084 144.241)",style:{fill:t.midnight}},o.createElement("path",{d:"m 26.355,-71.505 v 54.075 2.835 q 0,6.825 -0.42,10.185 -0.735,5.67 -2.835,9.135 -3.255,5.355 -8.505,8.4 -4.83,2.73 -11.55,3.57 L 1.47,11.76 Q 7.35,10.185 9.24,4.2 10.605,-0.105 10.605,-9.975 v -5.565 -55.965 q 1.785,0 4.62,0.315 2.835,0.21 3.255,0.21 1.785,0 2.94,-0.105 4.515,-0.42 4.935,-0.42 z"}),o.createElement("path",{d:"m 60.68836,-65.415 v 24.78 h 3.255 q 2.94,0 4.935,-0.525 2.1,-0.525 3.885,-2.1 2.31,-1.995 3.36,-4.83 1.155,-2.835 1.155,-6.09 0,-5.565 -2.94,-8.61 -2.94,-3.045 -8.295,-3.045 -2.52,0 -5.355,0.42 z m 0,30.87 V -6.09 h 5.25 q 4.725,0 8.505,-3.675 3.885,-3.78 3.885,-10.08 0,-8.19 -4.62,-11.655 -4.095,-3.045 -13.02,-3.045 z M 44.93836,0 v -71.505 h 27.09 q 9.135,0 14.385,3.255 6.51,3.99 6.51,12.6 0,7.035 -5.25,11.655 -4.62,4.095 -11.97,5.145 v 0.945 q 7.56,0.735 12.285,3.99 6.615,4.62 6.615,13.335 0,10.185 -7.98,15.75 -6.93,4.83 -17.43,4.83 z"}),o.createElement("path",{d:"M 109.44281,0.525 V -50.4 q 1.785,0.21 3.99,0.42 2.31,0.105 3.255,0.105 2.31,0 4.2,-0.21 1.89,-0.21 3.045,-0.315 v 13.02 q 1.89,-6.51 5.46,-9.87 4.41,-4.095 11.655,-4.095 -0.315,2.73 -0.42,6.825 -0.105,3.99 -0.105,7.455 l -0.945,0.84 q -0.945,-0.735 -2.415,-1.05 -1.47,-0.315 -2.94,-0.315 -3.57,0 -6.195,1.89 -2.52,1.785 -3.465,5.04 -0.42,1.155 -0.525,3.15 -0.105,1.89 -0.105,4.515 v 4.515 19.005 q -1.785,-0.21 -2.625,-0.21 -3.675,-0.315 -4.62,-0.315 -2.31,0 -4.2,0.21 -1.89,0.21 -3.045,0.315 z"}),o.createElement("path",{d:"m 173.77337,1.47 q -11.655,0 -18.585,-6.825 -6.93,-6.825 -6.93,-18.48 0,-12.6 6.72,-20.055 6.825,-7.455 18.9,-7.455 11.97,0 18.9,6.72 6.93,6.72 6.93,18.48 0,12.285 -6.72,19.74 -7.14,7.875 -19.215,7.875 z m 0.735,-48.09 q -5.88,0 -8.505,6.51 -2.205,5.565 -2.205,15.96 0,8.19 1.47,12.915 2.415,7.98 8.505,7.98 5.565,0 8.19,-7.875 2.205,-6.51 2.205,-16.695 0,-8.505 -2.1,-13.23 -2.52,-5.565 -7.56,-5.565 z"}),o.createElement("path",{d:"m 222.03563,-50.4 10.5,36.015 q 3.675,-11.235 5.67,-17.85 2.415,-8.085 5.04,-18.165 1.05,0.105 3.045,0.315 2.1,0.21 2.835,0.21 1.995,0 3.15,-0.105 1.26,-0.21 2.73,-0.42 l 10.71,36.015 q 5.88,-17.43 10.71,-36.015 l 4.2,0.315 4.095,-0.315 q -5.145,13.125 -9.135,24.57 -5.04,14.28 -8.505,26.355 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.205,-0.105 -1.89,0 -3.36,0.21 -1.365,0.21 -2.31,0.315 l -10.605,-34.755 q -4.41,13.65 -6.72,21.105 -2.31,7.35 -4.095,13.65 -1.89,-0.21 -3.36,-0.42 -1.365,-0.105 -2.31,-0.105 -1.995,0 -3.465,0.21 -1.365,0.21 -2.31,0.315 -3.78,-12.81 -5.04,-17.01 -2.205,-7.245 -5.46,-17.01 -2.835,-8.4 -5.88,-16.905 1.575,0 4.305,0.315 2.73,0.21 3.36,0.21 1.47,0 4.305,-0.21 2.835,-0.315 3.465,-0.315 z"}),o.createElement("path",{d:"m 292.84172,-12.81 h 2.625 q 1.47,4.095 4.62,6.51 3.15,2.415 7.35,2.415 2.94,0 5.46,-1.785 2.625,-1.89 2.625,-4.62 0,-3.885 -6.195,-6.615 -10.395,-4.62 -11.655,-5.46 -6.405,-4.515 -6.405,-12.285 0,-7.77 5.25,-12.18 5.25,-4.515 12.81,-4.515 3.99,0 8.085,1.365 4.095,1.26 7.14,3.57 l -2.52,9.24 h -2.94 q -0.63,-3.57 -3.57,-6.195 -2.835,-2.625 -6.405,-2.625 -3.15,0 -5.46,1.575 -2.31,1.47 -2.31,4.515 0,3.885 6.405,6.51 10.185,4.095 11.865,5.25 6.405,4.41 6.405,12.81 0,7.455 -5.46,12.18 -5.355,4.62 -14.805,4.62 -8.19,0 -14.49,-4.305 z"}),o.createElement("path",{d:"m 349.61228,-29.925 h 15.54 q 0,-6.51 -1.05,-10.395 -1.68,-6.3 -5.88,-6.3 -5.04,0 -7.14,6.195 -1.47,4.305 -1.47,10.5 z m 30.03,5.04 h -30.03 q 0,9.135 3.045,13.86 3.57,5.67 11.55,5.67 3.255,0 6.405,-1.26 3.15,-1.26 5.88,-3.465 l 1.26,0.945 -2.31,5.88 q -6.72,4.725 -15.015,4.725 -12.915,0 -19.635,-7.245 -6.72,-7.245 -6.72,-20.37 0,-11.235 6.405,-18.165 6.51,-7.035 17.64,-7.035 11.655,0 16.905,7.56 4.62,6.615 4.62,18.9 z"}))}},8463:(e,t,n)=>{n.d(t,{A:()=>k,m:()=>A});var o=n(7552),r=n(12756),s=n(49296),a=n(23224),i=n(69381),l=n(70996),c=n(6679),u=n(24387),d=n(55851),m=n(66765),p=n(29629),f=n(81453),g=n(4407),h=n(943),y=n(9555),w=n(75785),b=n(99546);function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},v.apply(null,arguments)}const C=(0,w.n9)()({paper:{position:"fixed",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",top:0,left:0,outline:0},menuItemEndDecoration:{padding:0,margin:0,height:16}});function A(e){const{classes:t}=C(),{type:n}=e;let c,u,d;switch("checked"in e&&({checked:c,disabled:u}=e),n){case"subMenu":d=o.createElement(r.A,{color:"action"});break;case"checkbox":if(c){const e=u?"inherit":void 0;d=o.createElement(s.A,{color:e})}else d=o.createElement(a.A,{color:"action"});break;case"radio":if(c){const e=u?"inherit":void 0;d=o.createElement(i.A,{color:e})}else d=o.createElement(l.A,{color:"action"})}return o.createElement("div",{className:t.menuItemEndDecoration},d)}function S(e){return"divider"!==e.type&&"subHeader"!==e.type&&!e.disabled}const E=o.forwardRef((function(e,t){const[n,r]=(0,o.useState)(),[s,a]=(0,o.useState)(),[i,l]=(0,o.useState)(!1),[y,w]=(0,o.useState)(),[v,k]=(0,o.useState)(),M=(0,o.useRef)(null),{classes:T}=C(),{menuItems:P,onMenuItemClick:I,open:N,onClose:x,anchorEl:R,top:D=!1}=e;(0,o.useEffect)((()=>{N||(r(void 0),a(void 0))}),[N]),(0,o.useEffect)((()=>{const e=N&&Boolean(n);let t;return e&&!i?t=setTimeout((()=>{l(!0)}),300):!e&&i&&(t=setTimeout((()=>{l(!1)}),300)),()=>{clearTimeout(t)}}),[i,N,n]),(0,o.useEffect)((()=>{if(R){const e=R.getBoundingClientRect();v&&e.top===v.top&&e.left+e.width===v.left||k({top:e.top,left:e.left+e.width})}else v||k({})}),[v,R]);const O=P.some((e=>"icon"in e&&e.icon)),L={},j=o.createElement(o.Fragment,null,o.createElement(c.A,{autoFocusItem:N&&!i,dense:!0},P.sort(((e,t)=>(t.priority||0)-(e.priority||0))).map(((e,t)=>{if("divider"===e.type)return o.createElement(u.A,{key:`divider-${JSON.stringify(e)}-${t}`,component:"li"});if("subHeader"===e.type)return o.createElement(d.A,{key:`subHeader-${e.label}-${t}`},e.label);let n=null,i=null;if(e.icon){const t=e.icon;n=o.createElement(m.A,null,o.createElement(t,null))}"subMenu"in e?i=o.createElement(A,{type:"subMenu"}):"checkbox"!==e.type&&"radio"!==e.type||(i=o.createElement(A,{type:e.type,checked:e.checked,disabled:e.disabled}));const c="onClick"in e?(g=e.onClick,e=>{I(e,g)}):void 0;var g;return o.createElement(p.A,{key:e.id||String(e.label),style:L,selected:t===y,onClick:c,onMouseMove:n=>{n.currentTarget!==document.activeElement&&(n.currentTarget.focus(),w(t)),"subMenu"in e?s!==t&&(r(n.currentTarget),a(t)):(r(void 0),a(void 0))},onKeyDown:n=>{switch(n.key){case"ArrowLeft":case"Escape":x?.(n,"escapeKeyDown");break;case"ArrowUp":w(function(e,t){return(0,b.findLastIndex)(e.slice(0,t),S)}(P,t));break;case"ArrowDown":{const e=function(e,t){const n=e.slice(t+1).findIndex(S);return-1===n?n:t+1+n}(P,t);w(e);break}default:!("subMenu"in e)||"ArrowRight"!==n.key&&"Enter"!==n.key||(r(n.currentTarget),a(t),l(!0))}},disabled:Boolean(e.disabled)},n,o.createElement(f.A,{primary:e.label,secondary:e.subLabel,inset:O&&!e.icon}),i)}))),P.map(((e,t)=>{let a=null;return"subMenu"in e&&(a=o.createElement(E,{key:e.id||String(e.label),anchorEl:n,open:i&&s===t,onClose:()=>{l(!1),r(void 0)},onMenuItemClick:I,menuItems:e.subMenu})),a})));return D?j:o.createElement(g.A,{in:N,style:{transformOrigin:"0 0 0"},ref:t},o.createElement(h.A,{elevation:8,ref:M,className:T.paper,style:{...v}},j))})),k=function(e){const{open:t,onClose:n,menuItems:r,onMenuItemClick:s,...a}=e;return o.createElement(y.Ay,v({open:t,onClose:n,anchorOrigin:{vertical:"bottom",horizontal:"right",...a.anchorOrigin},transformOrigin:{vertical:"top",horizontal:"left",...a.transformOrigin}},a),o.createElement(E,{open:t,onClose:n,menuItems:r,onMenuItemClick:s,top:!0}))}},66684:(e,t,n)=>{n.d(t,{A:()=>a});var o=n(7552);function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r.apply(null,arguments)}const s=(0,n(75785).n9)()({horizontalHandle:{cursor:"row-resize",width:"100%"},verticalHandle:{cursor:"col-resize",height:"100%"},flexbox_verticalHandle:{cursor:"col-resize",alignSelf:"stretch"},flexbox_horizontalHandle:{cursor:"row-resize",alignSelf:"stretch"}}),a=function({onDrag:e,vertical:t=!1,flexbox:n=!1,className:a,onMouseDown:i,...l}){const[c,u]=(0,o.useState)(!1),d=(0,o.useRef)(0),m=(0,o.useRef)(0),{classes:p,cx:f}=s();let g;return(0,o.useEffect)((()=>{function n(n){n.preventDefault();const o=t?n.clientX:n.clientY,r=d.current-o,s=o-m.current;m.current=o,e(s,r)}function o(){u(!1)}return c?(window.addEventListener("mousemove",n,!0),window.addEventListener("mouseup",o,!0),()=>{window.removeEventListener("mousemove",n,!0),window.removeEventListener("mouseup",o,!0)}):()=>{}}),[c,e,t]),g=n?t?p.flexbox_verticalHandle:p.flexbox_horizontalHandle:t?p.verticalHandle:p.horizontalHandle,o.createElement("div",r({"data-resizer":"true",onMouseDown:e=>{e.preventDefault();const n=t?e.clientX:e.clientY;d.current=n,m.current=n,u(!0),i?.(e)},className:f(g,a)},l))}},87686:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var o=n(7552),r=n(29499),s=n(36715),a=n(58507),i=n(5401),l=n(68446),c=n(92562);const u=(0,l.observer)((function({model:e,handleClose:t}){return o.createElement(c.A,{maxWidth:"xl",open:!0,onClose:t,title:"Reference sequence"},o.createElement(r.A,null,o.createElement(s.A,null,"Are you sure you want to return to the import form? This will lose your current view")),o.createElement(a.A,null,o.createElement(i.A,{onClick:()=>{e.clearView(),t()},variant:"contained",color:"primary",autoFocus:!0},"OK"),o.createElement(i.A,{onClick:()=>{t()},color:"secondary",variant:"contained"},"Cancel")))}))},13476:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(7552),r=n(80592),s=n(10424),a=n.n(s),i=n(99546);let l=!1;const c=new RegExp(["a","b","br","code","div","em","h1","h2","h3","h4","h5","h6","i","img","li","p","pre","span","small","strong","table","tbody","sup","sub","td","tfoot","th","thead","tr","u","ul"].map((e=>`<${e}\\b[^>]*>`)).join("|"),"i");function u({html:e,className:t}){const n=(0,i.linkify)(e),s=(u=n,c.test(u)?n:a()(n));var u;return l||(l=!0,r.A.addHook("afterSanitizeAttributes",(e=>{"A"===e.tagName&&(e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"))}))),o.createElement("span",{className:t,dangerouslySetInnerHTML:{__html:r.A.sanitize(s)}})}},49823:(e,t,n)=>{n.r(t),n.d(t,{AssemblySelector:()=>z,CascadingMenu:()=>W.A,Dialog:()=>V.A,EditableTypography:()=>U.A,ErrorMessage:()=>F.A,FactoryResetDialog:()=>B.default,FatalErrorDialog:()=>H.A,FileSelector:()=>ce,LoadingEllipses:()=>ue.A,LogoFull:()=>P.P,Logomark:()=>P.R,Menu:()=>de.A,MenuItemEndDecoration:()=>de.m,PrerenderedCanvas:()=>pe,ResizeHandle:()=>ge.A,ReturnToImportFormDialog:()=>fe.default,SanitizedHTML:()=>he.A,createJBrowseBaseTheme:()=>k,createJBrowseTheme:()=>M,defaultThemes:()=>S});var o=n(53954),r=n(46033),s=n(37231),a=n(8998),i=n(55194),l=n(89022),c=n(35068),u=n.n(c);const d=(0,l.A)(),m="#0D233F",p="#721E63",f=d.palette.augmentColor({color:{main:"#135560"}}),g=d.palette.augmentColor({color:{main:"#FFB11D"}}),h=d.palette.augmentColor({color:{main:"#aaa"}}),y={A:d.palette.augmentColor({color:o.A}),C:d.palette.augmentColor({color:r.A}),G:d.palette.augmentColor({color:s.A}),T:d.palette.augmentColor({color:a.A})},w=[null,d.palette.augmentColor({color:{main:"#FF8080"}}),d.palette.augmentColor({color:{main:"#80FF80"}}),d.palette.augmentColor({color:{main:"#8080FF"}}),d.palette.augmentColor({color:{main:"#8080FF"}}),d.palette.augmentColor({color:{main:"#80FF80"}}),d.palette.augmentColor({color:{main:"#FF8080"}})],b=[null,d.palette.augmentColor({color:{main:"#8f8f8f"}}),d.palette.augmentColor({color:{main:"#adadad"}}),d.palette.augmentColor({color:{main:"#d8d8d8"}}),d.palette.augmentColor({color:{main:"#d8d8d8"}}),d.palette.augmentColor({color:{main:"#adadad"}}),d.palette.augmentColor({color:{main:"#8f8f8f"}})],v="#e22",C="#3e3";function A(){return{palette:{mode:void 0,primary:{main:m},secondary:{main:p},tertiary:f,quaternary:g,highlight:g,stopCodon:v,startCodon:C,bases:y,frames:b,framesCDS:w},components:{MuiLink:{styleOverrides:{root:({theme:e})=>({color:e.palette.tertiary.main})}}}}}const S={default:{...A(),name:"Default (from config)"},lightStock:{...A(),name:"Light (stock)"},lightMinimal:{name:"Light (minimal)",palette:{primary:{main:i.A[900]},secondary:{main:i.A[800]},tertiary:d.palette.augmentColor({color:{main:i.A[900]}}),quaternary:g,highlight:g,stopCodon:v,startCodon:C,bases:y,frames:b,framesCDS:w}},darkMinimal:{name:"Dark (minimal)",palette:{mode:"dark",primary:{main:i.A[700]},secondary:{main:i.A[800]},tertiary:d.palette.augmentColor({color:{main:i.A[900]}}),quaternary:g,highlight:g,stopCodon:v,startCodon:C,bases:y,frames:b,framesCDS:w}},darkStock:{name:"Dark (stock)",palette:{mode:"dark",primary:{main:m},secondary:{main:p},tertiary:f,quaternary:g,highlight:g,stopCodon:v,startCodon:C,bases:y,frames:b,framesCDS:w},components:{MuiAppBar:{defaultProps:{enableColorOnDark:!0},styleOverrides:{root:({theme:e})=>e.palette.primary.main}}}}};function E(e,t){return t}function k(e){const t={palette:e?.palette,typography:{fontSize:12},spacing:4,components:{MuiButton:{defaultProps:{size:"small"},styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.primary}:void 0}},MuiAccordion:{defaultProps:{disableGutters:!0,slotProps:{transition:{timeout:150,unmountOnExit:!0}}}},MuiFilledInput:{defaultProps:{margin:"dense"}},MuiFormControl:{defaultProps:{margin:"dense",size:"small"}},MuiFormHelperText:{defaultProps:{margin:"dense"}},MuiIconButton:{defaultProps:{size:"small"}},MuiInputBase:{defaultProps:{margin:"dense"}},MuiAutocomplete:{defaultProps:{size:"small"}},MuiInputLabel:{defaultProps:{margin:"dense"}},MuiToolbar:{defaultProps:{variant:"dense"}},MuiListItem:{defaultProps:{dense:!0}},MuiOutlinedInput:{defaultProps:{margin:"dense"}},MuiFab:{defaultProps:{size:"small"},styleOverrides:{secondary:{backgroundColor:e?.palette?.quaternary?.main}}},MuiTable:{defaultProps:{size:"small"}},MuiPopover:{defaultProps:{transitionDuration:0}},MuiMenu:{defaultProps:{transitionDuration:0}},MuiMenuItem:{defaultProps:{dense:!0}},MuiTextField:{defaultProps:{margin:"dense",variant:"standard"}},MuiLink:{styleOverrides:{root:({theme:e})=>({color:e.palette.text.secondary})}},MuiCheckbox:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-checked":{color:e.palette.text.secondary}}:void 0}},MuiRadio:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-checked":{color:e.palette.text.secondary}}:void 0}},MuiFormLabel:{styleOverrides:{root:({theme:e})=>"dark"===e.palette.mode?{color:e.palette.text.secondary,"&.Mui-focused":{color:e.palette.text.secondary}}:void 0}},MuiAccordionSummary:{styleOverrides:{root:{backgroundColor:e?.palette?.tertiary?.main},content:{color:e?.palette?.tertiary?.contrastText}}},MuiToggleButtonGroup:{defaultProps:{size:"small"}}}};return u()(t,e||{},{arrayMerge:E})}function M(e={},t=S,n="default"){return(0,l.A)(k("default"===n?u()(t.default,T(e),{arrayMerge:E}):function(e={}){return T(u()(e,{palette:{quaternary:e.palette?.quaternary||h,tertiary:e.palette?.tertiary||h,highlight:e.palette?.highlight||g}}))}(t[n])))}function T(e={}){for(const t of["tertiary","quaternary","highlight"])e.palette?.[t]&&(e=u()(e,{palette:{[t]:d.palette.augmentColor("color"in e.palette[t]?e.palette[t]:{color:e.palette[t]})}}));return e}var P=n(34895),I=n(7552),N=n(1343),x=n(29629),R=n(68446),D=n(75785),O=n(68584),L=n(99546);function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},j.apply(null,arguments)}const $=(0,D.n9)()({importFormEntry:{minWidth:180}}),z=(0,R.observer)((function({session:e,onChange:t,selected:n,InputProps:o,TextFieldProps:r,localStorageKey:s,helperText:a="Select assembly to view"}){const{classes:i}=$(),{assemblyNames:l,assemblyManager:c}=e,u=new URLSearchParams(window.location.search).get("config"),[d,m]="undefined"==typeof jest&&s?(0,L.useLocalStorage)(`lastAssembly-${[window.location.host+window.location.pathname,u,s].join("-")}`,n):(0,I.useState)(n),p=l.includes(d||"")?d:n;(0,I.useEffect)((()=>{p&&p!==n&&t(p)}),[p,t,n]);const f=l.length?"":"No configured assemblies";return I.createElement(N.A,j({select:!0,label:"Assembly",variant:"outlined",helperText:f||a,value:p||"",onChange:e=>{m(e.target.value)},error:!!f,disabled:!!f,className:i.importFormEntry},r,{slotProps:{input:o,htmlInput:{"data-testid":"assembly-selector"}}}),l.map((e=>{const t=c.get(e),n=t?(0,O.getConf)(t,"displayName"):"";return I.createElement(x.A,{key:e,value:e},n||e)})))}));var W=n(85206),V=n(92562),U=n(88373),F=n(38033),B=n(69941),H=n(56174),G=n(32813),q=n(89003),_=n(82620),J=n(6024),Q=n(17125),K=n(83867),Z=n(43787),Y=n(25467),X=n(2051),ee=n(43550),te=n(14862),ne=n(92516);function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},oe.apply(null,arguments)}function re(e){const{title:t,children:n,...o}=e;return I.createElement(q.A,{title:t||""},I.createElement(_.A,o,n))}function se(e,t){return"string"==typeof e&&e.length>t?`${e.slice(0,Math.max(0,t))}â€¦`:e}function ae({children:e}){return I.createElement("div",{style:{display:"flex",gap:4}},e)}function ie({children:e}){return I.createElement(J.A,{display:"flex",flexDirection:"row"},I.createElement(J.A,null,e))}function le(e){const{setLocation:t,inline:n,toggleButtonValue:o,selectedAccount:r}=e;return I.createElement(I.Fragment,null,r?.SelectorComponent?I.createElement(r.SelectorComponent,oe({},e,{setLocation:t})):"url"===o?I.createElement(te.A,oe({},e,{setLocation:t,label:r?.selectorLabel,style:n?{margin:0}:void 0})):"file"===o?I.createElement(ee.A,e):null)}const ce=(0,R.observer)((function(e){const{inline:t,location:n,name:o,description:r,rootModel:s,setLocation:a}=e,i=!n||(0,ne.C1)(n)?"url":"file",[l,c]=(0,I.useState)(n&&"internetAccountId"in n&&n.internetAccountId?n.internetAccountId:i),u=(0,ne.bV)(s)?s.internetAccounts.filter((e=>"HTTPBasicInternetAccount"!==e.type)):[],[d,m]=(0,L.useLocalStorage)("fileSelector-recentlyUsedInternetAccounts",[]),p=Object.fromEntries(u.map((e=>[e.internetAccountId,e]))),f=[...new Set(u.map((e=>e.internetAccountId)))].sort(((e,t)=>d.indexOf(e)-d.indexOf(t))),g=f.slice(0,2),h=f.slice(2),[y,w]=(0,I.useState)(null),b=p[l],v=(0,I.useCallback)((e=>{a({...e,...b&&(0,ne.C1)(e)?{internetAccountId:b.internetAccountId}:{}})}),[a,b]);(0,I.useEffect)((()=>{b&&(0,ne.C1)(n)&&n.internetAccountId!==b.internetAccountId&&v(n)}),[n,b,v]);const C=t?ae:ie;return I.createElement(I.Fragment,null,I.createElement(J.A,{display:"flex"},I.createElement(Q.A,{shrink:!0},o)),I.createElement(K.A,null,I.createElement(C,null,I.createElement(Z.A,{value:l,exclusive:!0,size:"small",onChange:(e,t)=>{m([...new Set([t,...d].filter(L.notEmpty))]),t&&c(t),(0,ne.C1)(n)&&v(n)},"aria-label":"file, url, or account picker"},new URLSearchParams(window.location.search).get("adminKey")?null:I.createElement(_.A,{size:"small",value:"file","aria-label":"local file"},"File"),I.createElement(_.A,{size:"small",value:"url","aria-label":"url"},"URL"),g.map((e=>{const{internetAccountId:t,name:n,toggleContents:o}=p[e];return I.createElement(re,{key:e,value:t,title:n},"string"==typeof o?se(o,5):o||se(n,5))})),h.length>0?I.createElement(_.A,{onClick:e=>{w(e.target)},selected:!1},"More",I.createElement(G.A,null)):null),t?I.createElement(le,oe({},e,{toggleButtonValue:l,selectedAccount:b,setLocation:v})):null),t?null:I.createElement(le,oe({},e,{toggleButtonValue:l,selectedAccount:b,setLocation:v}))),I.createElement(Y.A,null,r),y?I.createElement(X.A,{open:!0,anchorEl:y,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},onClose:()=>{w(null)}},h.map((e=>{const{internetAccountId:t,name:n}=p[e];return I.createElement(x.A,{key:e,value:t,onClick:()=>{m([...new Set([t,...d].filter(L.notEmpty))]),c(t),w(null)}},n)}))):null)}));var ue=n(37565),de=n(8463),me=n(18010);const pe=function(e){const{width:t,height:n,highResolutionScaling:o=1,style:r={},imageData:s,blockKey:a,showSoftClip:i}=e,[l,c]=(0,I.useState)(!1),u=(0,I.useRef)(null);return(0,I.useEffect)((()=>{if(!s)return;const e=u.current;if(!e)return;const t=e.getContext("2d");t&&((0,me.pv)(s,t),c(!0))}),[s]),I.createElement("canvas",{"data-testid":["prerendered_canvas",i?"softclipped":"",a,l?"done":""].filter((e=>!!e)).join("_"),ref:u,width:t*o,height:n*o,style:{width:t,height:n,...r}})};var fe=n(87686),ge=n(66684),he=n(13476)},43334:(e,t,n)=>{n.d(t,{A:()=>o});class o extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)||(yield e)}for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)||(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const o="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:o}):this._set(e,{value:t,expiry:o})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;this._deleteIfExpired(t,n)||(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;this.cache.has(t)||this._deleteIfExpired(t,n)||(yield[t,n.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[o,r]=n;this._deleteIfExpired(o,r)||(yield[o,r.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[o,r]=n;this.cache.has(o)||this._deleteIfExpired(o,r)||(yield[o,r.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,o]of this.entriesAscending())e.call(t,o,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}},99546:(e,t,n)=>{n.r(t),n.d(t,{AuthNeededError:()=>m._u,ImageBitmapType:()=>h.bV,ReactRendering:()=>y.aE,RetryError:()=>m.J_,SimpleFeature:()=>w.A,TextSearchManager:()=>m.rz,abortBreakPoint:()=>C.Yo,assembleLocString:()=>R,assembleLocStringFast:()=>D,avg:()=>ze,blobToDataURL:()=>b.y,bpSpanPx:()=>_,bpToPx:()=>W,bytesForRegions:()=>be,cartesianToPolar:()=>G,checkAbortSignal:()=>C.pB,clamp:()=>z,coarseStripHTML:()=>Ie,compareLocStrings:()=>$,compareLocs:()=>j,complement:()=>ae,complementTable:()=>oe,createCanvas:()=>h.Nw,createImageBitmap:()=>h.T9,dedupe:()=>g.Q,defaultCodonTable:()=>pe,defaultStarts:()=>de,defaultStops:()=>me,degToRad:()=>B,doesIntersect2:()=>f.R6,drawImageOntoCanvasContext:()=>h.pv,featureSpanPx:()=>q,fetchAndMaybeUnzip:()=>Je,findLast:()=>K,findLastIndex:()=>Q,findParentThat:()=>k,findParentThatIs:()=>T,gatherOverlaps:()=>Fe,generateCodonTable:()=>fe,getBpDisplayStr:()=>Ce,getContainingDisplay:()=>x,getContainingTrack:()=>N,getContainingView:()=>I,getEnv:()=>Re,getFillProps:()=>Ge,getFrame:()=>ue,getLayoutId:()=>ke,getSerializedSvg:()=>y.Jy,getSession:()=>P,getStr:()=>Pe,getStrokeProps:()=>He,getTickDisplayStr:()=>Se,getUriLink:()=>Te,getViewParams:()=>Ee,groupBy:()=>We,hashCode:()=>ye,intersection2:()=>f.ky,isAbortException:()=>C.Kp,isAbstractMenuManager:()=>m.Nh,isAppRootModel:()=>m.bV,isAuthNeededException:()=>m.ZL,isBlobLocation:()=>m.rF,isContainedWithin:()=>f.Xx,isDisplayModel:()=>m.Uy,isElectron:()=>ne,isFeature:()=>w.l,isGzip:()=>_e,isLocalPathLocation:()=>m.EV,isRetryException:()=>m.yH,isRootModelWithInternetAccounts:()=>m.lL,isSelectionContainer:()=>m.mY,isSessionModel:()=>m.Y$,isSessionModelWithConfigEditing:()=>m.u3,isSessionModelWithConnectionEditing:()=>m.gx,isSessionModelWithConnections:()=>m.BY,isSessionModelWithWidgets:()=>m.lO,isSessionWithAddTracks:()=>m.QW,isSessionWithSessionPlugins:()=>m.zA,isSessionWithShareURL:()=>m.xv,isSupportedIndexingAdapter:()=>ve,isTrackModel:()=>m.xU,isTrackViewModel:()=>m.EO,isUriLocation:()=>m.C1,isViewContainer:()=>m.DW,isViewModel:()=>m.Tl,iterMap:()=>J,linkify:()=>Ne,localStorageGetItem:()=>De,localStorageSetItem:()=>Oe,makeAbortError:()=>C.zm,makeAbortableReaction:()=>v.I,max:()=>Le,measureGridWidth:()=>xe,measureText:()=>ce,mergeIntervals:()=>Ue,min:()=>je,minmax:()=>X,notEmpty:()=>Ve,objectHash:()=>we,observeAbortSignal:()=>C.R1,parseLocString:()=>L,parseLocStringOneBased:()=>O,polarToCartesian:()=>H,rIC:()=>ie,radToDeg:()=>F,renameRegionIfNeeded:()=>Z,renameRegionsIfNeeded:()=>Y,renderToAbstractCanvas:()=>y.u1,renderToStaticMarkup:()=>qe,revcom:()=>re,reverse:()=>se,shorten:()=>ee,springAnimate:()=>M,stringify:()=>te,stripAlpha:()=>Be,sum:()=>$e,toLocale:()=>Ae,updateStatus:()=>ge,updateStatus2:()=>he,useDebounce:()=>A,useDebouncedCallback:()=>E,useLocalStorage:()=>Me,useWidthSetter:()=>S,when:()=>p.z});var o=n(7552),r=n(70798),s=n(40085),a=n(503),i=n.n(a),l=n(36422),c=n(28485),u=n(87485),d=n(37347),m=n(92516),p=n(1864),f=n(32595),g=n(3519),h=n(18010),y=n(98506),w=n(6434),b=n(31673),v=n(56133),C=n(20166);function A(e,t){const[n,r]=(0,o.useState)(e);return(0,o.useEffect)((()=>{const n=setTimeout((()=>{r(e)}),t);return()=>{clearTimeout(n)}}),[e,t]),n}function S(e,t){const[n,{width:r}]=(0,s.A)();return(0,o.useEffect)((()=>{r&&(0,l.isAlive)(e)&&requestAnimationFrame((()=>{e.setWidth(r-2*Number.parseInt(t,10))}))}),[t,e,r]),n}function E(e,t=400){const n=(0,o.useRef)(),r=(0,o.useRef)();return(0,o.useEffect)((()=>{r.current&&clearTimeout(r.current)}),[]),function(...o){n.current=o,r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{n.current&&e(...n.current)}),t)}}function k(e,t){if(!(0,l.hasParent)(e))throw new Error("node does not have parent");let n=(0,l.getParent)(e);for(;n&&(0,l.isAlive)(n);){if(t(n))return n;if(!(0,l.hasParent)(n))break;n=(0,l.getParent)(n)}throw new Error("no matching node found")}function M(e,t,n,o=()=>{},r=0,s=400,a=20,i=!0){let l;function c(u){const d=Date.now();let m=u.lastPosition,p=u.lastTime||d,f=u.lastVelocity||0;d>p+64&&(p=d);const g=Math.floor(d-p);for(let e=0;e<g;++e)f+=(-s*(m-t)+-a*f)/1*1/1e3,m+=1*f/1e3;const h=Math.abs(f)<=r,y=0===s||Math.abs(t-m)<=r;i&&0!==s&&(e<t?m>t:m<t)||h&&y?(n(t),o()):(n(m),l=requestAnimationFrame((()=>{c({lastPosition:m,lastTime:d,lastVelocity:f})})))}return r||(r=Math.abs(t-e)/1e3),[()=>{c({lastPosition:e})},()=>{cancelAnimationFrame(l)}]}function T(e,t){return k(e,t)}function P(e){try{return T(e,m.Y$)}catch(e){throw new Error("no session model found!")}}function I(e){try{return T(e,m.Tl)}catch(e){throw new Error("no containing view found")}}function N(e){try{return T(e,m.xU)}catch(e){throw new Error("no containing track found")}}function x(e){try{return T(e,m.Uy)}catch(e){throw new Error("no containing display found")}}function R(e){return D(e,Ae)}function D(e,t=e=>e){const{assemblyName:n,refName:o,start:r,end:s,reversed:a}=e,i=n?`{${n}}`:"";let l,c;l=void 0!==r?`:${t(r+1)}`:void 0!==s?":1":"",c=void 0!==s?void 0!==r&&r+1===s?"":`..${t(s)}`:void 0!==r?"..":"";let u="";return a&&(u="[rev]"),`${i}${o}${l}${c}${u}`}function O(e,t){if(!e)throw new Error("no location string provided, could not parse");let n=!1;e.endsWith("[rev]")&&(n=!0,e=e.replace(/\[rev]$/,"")),e=e.replace(/\s/,"");const o=/({(.+)})?(.+)/.exec(e);if(!o)throw new Error(`invalid location string: "${e}"`);const[,,r,s]=o,a=r,i=s;if(!a&&i.startsWith("{}"))throw new Error(`no assembly name was provided in location "${i}"`);const l=i.lastIndexOf(":");if(-1===l){if(t(i,a))return{assemblyName:a,refName:i,reversed:n};throw new Error(`Unknown reference sequence "${i}"`)}const c=i.slice(0,l),u=i.slice(l+1);if(t(c,a)&&t(i,a))throw new Error(`ambiguous location string: "${e}"`);if(t(c,a)){if(!u)return{assemblyName:a,refName:c,reversed:n};{const t=/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)(-?(\d+|\d{1,3}(,\d{3})*))$/.exec(u),o=/^(-?(\d+|\d{1,3}(,\d{3})*))(\.\.|-)?$/.exec(u);if(t){const[,e,,,,o]=t;if(void 0!==e&&void 0!==o)return{assemblyName:a,refName:c,start:+e.replaceAll(",",""),end:+o.replaceAll(",",""),reversed:n}}else{if(!o)throw new Error(`could not parse range "${u}" on location "${e}"`);{const[,e,,,t]=o;if(void 0!==e)return t?{assemblyName:a,refName:c,start:+e.replaceAll(",",""),reversed:n}:{assemblyName:a,refName:c,start:+e.replaceAll(",",""),end:+e.replaceAll(",",""),reversed:n}}}}}else if(t(i,a))return{assemblyName:a,refName:i,reversed:n};throw new Error(`unknown reference sequence name in location "${e}"`)}function L(e,t){const n=O(e,t);return"number"==typeof n.start&&(n.start-=1),n}function j(e,t){const n=e.assemblyName||t.assemblyName?(e.assemblyName||"").localeCompare(t.assemblyName||""):0;if(n)return n;const o=e.refName||t.refName?(e.refName||"").localeCompare(t.refName||""):0;if(o)return o;if(void 0!==e.start&&void 0!==t.start){const n=e.start-t.start;if(n)return n}if(void 0!==e.end&&void 0!==t.end){const n=e.end-t.end;if(n)return n}return 0}function $(e,t,n){return j(L(e,n),L(t,n))}function z(e,t,n){return e<t?t:e>n?n:e}function W(e,{reversed:t,end:n=0,start:o=0},r){return s=(t?n-e:e-o)/r,Math.round(10*s)/10;var s}const V=180/Math.PI,U=Math.PI/180;function F(e){return e*V%360}function B(e){return e*U%(2*Math.PI)}function H(e,t){return[e*Math.cos(t),e*Math.sin(t)]}function G(e,t){return[Math.sqrt(e*e+t*t),Math.atan(t/e)]}function q(e,t,n){return _(e.get("start"),e.get("end"),t,n)}function _(e,t,n,o){const r=W(e,n,o),s=W(t,n,o);return n.reversed?[s,r]:[r,s]}function J(e,t,n){const o=Array.from({length:n||0});let r=0;for(const n of e)o[r]=t(n),r+=1;return o}function Q(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return n;return-1}function K(e,t){let n=e.length;for(;n--;)if(t(e[n],n,e))return e[n]}function Z(e,t){if((0,l.isStateTreeNode)(t)&&!(0,l.isAlive)(t))return t;if(e?.[t.refName]){const n=e[(t=(0,l.isStateTreeNode)(t)?{...(0,l.getSnapshot)(t)}:{...t}).refName];if(n)return{...t,refName:n,originalRefName:t.refName}}return t}async function Y(e,t){const{regions:n=[],adapterConfig:o}=t;if(!t.sessionId)throw new Error("sessionId is required");const r=n.map((e=>e.assemblyName)),s=Object.fromEntries(await Promise.all([...new Set(r)].map((async n=>[n,await e.getRefNameMapForAdapter(o,n,t)]))));return{...t,regions:n.map(((e,t)=>Z(s[r[t]],e)))}}function X(e,t){return[Math.min(e,t),Math.max(e,t)]}function ee(e,t=70,n=30){return e.length>t?`${e.slice(0,n)}...${e.slice(-n)}`:e}function te({refName:e,coord:t,assemblyName:n,oob:o},r){return[n&&r?`{${n}}`:"",e?`${ee(e)}:${Ae(t)}${o?" (out of bounds)":""}`:""].join("")}const ne=/electron/i.test("undefined"!=typeof navigator?navigator.userAgent:""),oe={S:"S",w:"w",T:"A",r:"y",a:"t",N:"N",K:"M",x:"x",d:"h",Y:"R",V:"B",y:"r",M:"K",h:"d",k:"m",C:"G",g:"c",t:"a",A:"T",n:"n",W:"W",X:"X",m:"k",v:"b",B:"V",s:"s",H:"D",c:"g",D:"H",b:"v",R:"Y",G:"C"};function re(e){let t="";for(let n=e.length-1;n>=0;n--)t+=oe[e[n]]??e[n];return t}function se(e){let t="";for(let n=e.length-1;n>=0;n--)t+=e[n];return t}function ae(e){let t="";for(let n=0;n<e.length;n++)t+=oe[e[n]]??e[n];return t}const ie="undefined"==typeof jest?"undefined"!=typeof window&&window.requestIdleCallback?window.requestIdleCallback:e=>setTimeout((()=>{e()}),1):e=>{e()},le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2796875,.2765625,.3546875,.5546875,.5546875,.8890625,.665625,.190625,.3328125,.3328125,.3890625,.5828125,.2765625,.3328125,.2765625,.3015625,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.5546875,.2765625,.2765625,.584375,.5828125,.584375,.5546875,1.0140625,.665625,.665625,.721875,.721875,.665625,.609375,.7765625,.721875,.2765625,.5,.665625,.5546875,.8328125,.721875,.7765625,.665625,.7765625,.721875,.665625,.609375,.721875,.665625,.94375,.665625,.665625,.609375,.2765625,.3546875,.2765625,.4765625,.5546875,.3328125,.5546875,.5546875,.5,.5546875,.5546875,.2765625,.5546875,.5546875,.221875,.240625,.5,.221875,.8328125,.5546875,.5546875,.5546875,.5546875,.3328125,.5,.2765625,.5546875,.5,.721875,.5,.5,.5,.3546875,.259375,.353125,.5890625];function ce(e,t=10){const n=String(e);let o=0;for(let e=0;e<n.length;e++){const t=n.charCodeAt(e);o+=le[t]??.5279276315789471}return o*t}function ue(e,t,n,o){return 1===n?(e+o)%3+1:(t-o)%3*-1-1}const de=["ATG"],me=["TAA","TAG","TGA"],pe={TCA:"S",TCC:"S",TCG:"S",TCT:"S",TTC:"F",TTT:"F",TTA:"L",TTG:"L",TAC:"Y",TAT:"Y",TAA:"*",TAG:"*",TGC:"C",TGT:"C",TGA:"*",TGG:"W",CTA:"L",CTC:"L",CTG:"L",CTT:"L",CCA:"P",CCC:"P",CCG:"P",CCT:"P",CAC:"H",CAT:"H",CAA:"Q",CAG:"Q",CGA:"R",CGC:"R",CGG:"R",CGT:"R",ATA:"I",ATC:"I",ATT:"I",ATG:"M",ACA:"T",ACC:"T",ACG:"T",ACT:"T",AAC:"N",AAT:"N",AAA:"K",AAG:"K",AGC:"S",AGT:"S",AGA:"R",AGG:"R",GTA:"V",GTC:"V",GTG:"V",GTT:"V",GCA:"A",GCC:"A",GCG:"A",GCT:"A",GAC:"D",GAT:"D",GAA:"E",GAG:"E",GGA:"G",GGC:"G",GGG:"G",GGT:"G"};function fe(e){const t={};return Object.keys(e).forEach((n=>{const o=e[n],r=[];for(let e=0;e<3;e++){const t=n.charAt(e);r[e]=[],r[e][0]=t.toUpperCase(),r[e][1]=t.toLowerCase()}for(let e=0;e<2;e++){const n=r[0][e];for(let e=0;e<2;e++){const s=r[1][e];for(let e=0;e<2;e++){const a=r[2][e];t[n+s+a]=o}}}})),t}async function ge(e,t,n){t(e);const o=await n();return t(""),o}async function he(e,t,n,o){t(e);const r=await o();return(0,d.SW)(n),t(""),r}function ye(e){let t=0;if(0===e.length)return t;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return t}function we(e){return`${ye(JSON.stringify(e))}`}async function be(e,t){return(await Promise.all(e.map((e=>t.blocksForRange(e.refName,e.start,e.end))))).flat().map((e=>({start:e.minv.blockPosition,end:e.maxv.blockPosition+65535}))).reduce(((e,t)=>e+t.end-t.start),0)}function ve(e=""){return["Gff3TabixAdapter","VcfTabixAdapter","Gff3Adapter","VcfAdapter"].includes(e)}function Ce(e){return Math.floor(e/1e6)>0?`${Number.parseFloat((e/1e6).toPrecision(3))}Mbp`:Math.floor(e/1e3)>0?`${Number.parseFloat((e/1e3).toPrecision(3))}Kbp`:`${Ae(Math.floor(e))}bp`}function Ae(e){return e.toLocaleString("en-US")}function Se(e,t){return Math.floor(t/1e3)>0?`${Ae(Number.parseFloat((e/1e6).toFixed(2)))}M`:Ae(Math.floor(e))}function Ee(e,t){const{dynamicBlocks:n,staticBlocks:o,offsetPx:r}=I(e),s=n?.contentBlocks[0]||{},a=o?.contentBlocks[0]||{},i=o?.contentBlocks[1]||{};return{offsetPx:t?0:r-a.offsetPx,offsetPx1:t?0:r-i.offsetPx,start:s.start,end:s.end}}function ke({sessionId:e,layoutId:t}){return`${e}-${t}`}function Me(e,t){const[n,r]=(0,o.useState)((()=>{if("undefined"==typeof window)return t;try{const n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(e){return console.error(e),t}}));return[n,t=>{try{const o=t instanceof Function?t(n):t;r(o),"undefined"!=typeof window&&window.localStorage.setItem(e,JSON.stringify(o))}catch(e){console.error(e)}}]}function Te(e){const{uri:t,baseUri:n=""}=e;let o;try{o=new URL(t,n).href}catch(e){o=t}return o}function Pe(e){return i()(e)?(0,m.C1)(e)?Te(e):JSON.stringify(e):String(e)}function Ie(e){return e.replaceAll(/(<([^>]+)>)/gi,"")}function Ne(e){return e.replaceAll(/(^|[\s\n]|<[A-Za-z]*\/?>)((?:https?|ftp):\/\/[-A-Z0-9+\u0026\u2019@#/%?=()~_|!:,.;]*[-A-Z0-9+\u0026@#/%=~()_|])/gi,"$1<a href='$2' target=\"_blank\">$2</a>")}function xe(e,t){const{padding:n=30,minWidth:o=80,fontSize:r=12,maxWidth:s=1e3,stripHTML:a=!1}=t||{};return Le(e.map((e=>Pe(e))).map((e=>a?Ie(e):e)).map((e=>ce(e,r))).map((e=>Math.min(Math.max(e+n,o),s))))}function Re(e){return(0,l.getEnv)(e)}function De(e){return"undefined"!=typeof localStorage?localStorage.getItem(e):void 0}function Oe(e,t){"undefined"!=typeof localStorage&&localStorage.setItem(e,t)}function Le(e,t=Number.NEGATIVE_INFINITY){let n=t;for(const t of e)n=Math.max(t,n);return n}function je(e,t=Number.POSITIVE_INFINITY){let n=t;for(const t of e)n=Math.min(t,n);return n}function $e(e){let t=0;for(const n of e)t+=n;return t}function ze(e){return $e(e)/e.length}function We(e,t){const n={};for(const o of e){const e=t(o);n[e]||(n[e]=[]),n[e].push(o)}return n}function Ve(e){return null!=e}function Ue(e,t=5e3){if(e.length<=1)return e;const n=[];let o=null;e=e.sort(((e,t)=>e.start-t.start)),n.push(e[0]);for(let r=1;r<e.length;r++)o=n.at(-1),o.end+t<e[r].start-t?n.push(e[r]):o.end<e[r].end&&(o.end=Math.max(o.end,e[r].end),n.pop(),n.push(o));return n}function Fe(e,t=5e3){const n={};for(const t of e)n[t.refName]||(n[t.refName]=[]),n[t.refName].push(t);return Object.values(n).flatMap((e=>Ue(e.sort(((e,t)=>e.start-t.start)),t)))}function Be(e){return(0,u.M)(e).alpha(1).toHex()}function He(e){const t=(0,u.M)(e);return{strokeOpacity:t.alpha(),stroke:t.alpha(1).toHex()}}function Ge(e){const t=(0,u.M)(e);return{fillOpacity:t.alpha(),fill:t.alpha(1).toHex()}}function qe(e,t){const n=document.createElement("div");return(0,c.flushSync)((()=>{t?t(n).render(e):(0,c.render)(e,n)})),n.innerHTML.replaceAll(/\brgba\((.+?),[^,]+?\)/g,"rgb($1)")}function _e(e){return 31===e[0]&&139===e[1]&&8===e[2]}async function Je(e,t){const{statusCallback:n=()=>{}}=t||{},o=await ge("Downloading file",n,(()=>e.readFile(t)));return _e(o)?await ge("Unzipping",n,(()=>(0,r.$1)(o))):o}},91468:(e,t,n)=>{n.r(t),n.d(t,{UNKNOWN:()=>u,UNSUPPORTED:()=>d,generateUnknownTrackConf:()=>E,generateUnsupportedTrackConf:()=>S,getBlob:()=>p,getBlobMap:()=>f,getConfAssemblyNames:()=>i,getFileName:()=>v,getParentRenderProps:()=>c,getRpcSessionId:()=>l,getTrackAssemblyNames:()=>a,getTrackName:()=>k,guessAdapter:()=>C,guessTrackType:()=>A,makeIndex:()=>w,makeIndexType:()=>b,setBlobMap:()=>g,storeBlobLocation:()=>y});var o=n(36422),r=n(99546),s=n(68584);function a(e){return i(e.configuration)}function i(e){const t=(0,s.readConfObject)(e,"assemblyNames");if(!t){const t=(0,o.getParent)(e);if("sequence"in t)return[(0,s.readConfObject)(t,"name")];throw new Error("unknown assembly names")}return t}function l(e){let t;for(let n=e;!(0,o.isRoot)(n);n=(0,o.getParent)(n))"rpcSessionId"in n&&(t=n.rpcSessionId);if(!t)throw new Error("getRpcSessionId failed, no parent node in the state tree has an `rpcSessionId` attribute");return t}function c(e){for(let t=(0,o.getParent)(e);!(0,o.isRoot)(t);t=(0,o.getParent)(t))if("renderProps"in t)return t.renderProps();return{}}const u="UNKNOWN",d="UNSUPPORTED";let m={};function p(e){return m[e]}function f(){return m}function g(e){m=e}let h=0;function y(e){if("blob"in e){const t=`b${+Date.now()}-${h++}`;return m[t]=e.blob,{name:e.blob.name,blobId:t,locationType:"BlobLocation"}}return e}function w(e,t){return"uri"in e?{uri:e.uri+t,locationType:"UriLocation"}:"localPath"in e?{localPath:e.localPath+t,locationType:"LocalPathLocation"}:e}function b(e,t,n){return e?.toUpperCase().endsWith(t)?t:n}function v(e){const t="uri"in e?e.uri:void 0,n="localPath"in e?e.localPath:void 0,o="blobId"in e?e:void 0;return o?.name||t?.slice(t.lastIndexOf("/")+1)||n?.slice(n.replace(/\\/g,"/").lastIndexOf("/")+1)||""}function C(e,t,n,o){if(o){const{pluginManager:s}=(0,r.getEnv)(o),a=s.evaluateExtensionPoint("Core-guessAdapterForLocation",((e,t,n)=>{}))(e,t,n);if(a)return a}return{type:u}}function A(e,t){if(t){const n=(0,r.getSession)(t),o=(0,r.getEnv)(n).pluginManager.evaluateExtensionPoint("Core-guessTrackTypeForLocation",(e=>{}))(e);if(o)return o}return"FeatureTrack"}function S(e,t,n){const o={type:"FeatureTrack",name:`${e} (Unsupported)`,description:`Support not yet implemented for "${t}"`,category:n,trackId:""};return o.trackId=(0,r.objectHash)(o),o}function E(e,t,n){const o={type:"FeatureTrack",name:`${e} (Unknown)`,description:`Could not determine track type for "${t}"`,category:n,trackId:""};return o.trackId=(0,r.objectHash)(o),o}function k(e,t){const n=(0,s.readConfObject)(e,"name");if(!n&&"ReferenceSequenceTrack"===(0,s.readConfObject)(e,"type")){const n=t.assemblies.find((t=>t.sequence===e));return n?`Reference sequence (${(0,s.readConfObject)(n,"displayName")||(0,s.readConfObject)(n,"name")})`:"Reference sequence"}return n}},8832:(e,t,n)=>{n.r(t),n.d(t,{BlobLocation:()=>c,ElementId:()=>s,FileLocation:()=>m,LocalPathLocation:()=>l,NoAssemblyRegion:()=>a,Region:()=>i,UriLocation:()=>d,UriLocationRaw:()=>u});var o=n(36422),r=n(32761);const s=o.types.optional(o.types.identifier,(()=>(0,r.Ak)())),a=o.types.model("NoAssemblyRegion",{refName:o.types.string,start:o.types.number,end:o.types.number,reversed:o.types.optional(o.types.boolean,!1)}).actions((e=>({setRefName(t){e.refName=t}}))),i=o.types.compose("Region",a,o.types.model({assemblyName:o.types.string})),l=o.types.model("LocalPathLocation",{locationType:o.types.literal("LocalPathLocation"),localPath:o.types.string}),c=o.types.model("BlobLocation",{locationType:o.types.literal("BlobLocation"),name:o.types.string,blobId:o.types.string}),u=o.types.model("UriLocation",{locationType:o.types.literal("UriLocation"),uri:o.types.string,baseUri:o.types.maybe(o.types.string),internetAccountId:o.types.maybe(o.types.string),internetAccountPreAuthorization:o.types.maybe(o.types.model("InternetAccountPreAuthorization",{internetAccountType:o.types.string,authInfo:o.types.frozen()}))}),d=o.types.snapshotProcessor(u,{postProcessor:e=>{const{baseUri:t,...n}=e;return t?e:n}}),m=o.types.snapshotProcessor(o.types.union(l,d,c),{preProcessor(e){if(!e)return;const{locationType:t,...n}=e;if(!t){const{uri:e,localPath:t,blob:o}=n;let r="";return void 0!==e?r="UriLocation":void 0!==t?r="LocalPathLocation":void 0!==o&&(r="BlobLocation"),{...n,locationType:r}}return e}})},45858:(e,t,n)=>{n.d(t,{DH:()=>s,qk:()=>a});var o=n(8832),r=n(36422);function s(e){return r.types.model({id:o.ElementId,name:r.types.string,margin:0}).volatile((()=>({selection:void 0,hovered:void 0}))).views((e=>({get root(){return(0,r.getParent)(e)}}))).views((e=>({get jbrowse(){return e.root.jbrowse},get rpcManager(){return e.root.rpcManager},get configuration(){return this.jbrowse.configuration},get adminMode(){return e.root.adminMode},get textSearchManager(){return e.root.textSearchManager}}))).views((e=>({get assemblies(){return e.jbrowse.assemblies}}))).actions((e=>({setSelection(t){e.selection=t},clearSelection(){e.selection=void 0},setHovered(t){e.hovered=t}})))}function a(e){return"id"in e&&"name"in e&&"root"in e}},49204:(e,t,n)=>{n.d(t,{F:()=>a,M:()=>i});var o=n(68584),r=n(36422),s=n(45858);function a(e){return r.types.model({connectionInstances:r.types.array(e.pluggableMstType("connection","stateModel"))}).views((e=>({get connections(){const{jbrowse:t}=e;return t.connections}}))).actions((t=>({makeConnection(n,r={}){const s=n.type;if(!s)throw new Error("track configuration has no `type` listed");const a=(0,o.readConfObject)(n,"name");if(!e.getConnectionType(s))throw new Error(`unknown connection type ${s}`);const i=t.connectionInstances.push({...r,name:a,type:s,configuration:n});return t.connectionInstances[i-1]},prepareToBreakConnection(e){const n=t,r=[],s={},a=(0,o.readConfObject)(e,"name"),i=t.connectionInstances.find((e=>e.name===a));if(i){for(const e of i.tracks){const t=n.getReferring(e);n.removeReferring(t,e,r,s)}return[()=>{r.forEach((e=>{e()})),this.breakConnection(e)},s]}},breakConnection(e){const n=(0,o.readConfObject)(e,"name"),r=t.connectionInstances.find((e=>e.name===n));if(!r)throw new Error(`no connection found with name ${n}`);t.connectionInstances.remove(r)},deleteConnection(e){const{jbrowse:n}=t;return n.deleteConnectionConf(e)},addConnectionConf(e){const{jbrowse:n}=t;return n.addConnectionConf(e)},clearConnections(){t.connectionInstances.clear()}})))}function i(e){return(0,s.qk)(e)&&"connectionInstances"in e}},16574:(e,t,n)=>{n.d(t,{A:()=>d,m:()=>u});var o=n(7552),r=n(12678),s=n(69426),a=n(62367),i=n(68384),l=n(679),c=n(31756);const u=(0,o.lazy)((()=>Promise.all([n.e(8565),n.e(8237),n.e(427)]).then(n.bind(n,18009))));class d extends r.A{name="DataManagementPlugin";exports={AssemblyManager:u};install(e){(0,c.A)(e),(0,a.A)(e),(0,i.Ay)(e),(0,s.A)(e),(0,l.A)(e)}configure(e){}}},99021:(e,t,n)=>{n.r(t),n.d(t,{Loader:()=>Yt,default:()=>nn});var o=n(7552),r=n(49823),s=n(57468),a=n(68446),i=n(430),l=n(83504),c=(n(39975),n(30157)),u=n(42418),d=n(9937),m=n(5401),p=n(61723);const f=(0,a.observer)((function({session:e}){const{snackbarMessages:t}=e,n=t.at(-1),r=(t,n)=>{"clickaway"!==n&&e.popSnackbarMessage()};return n?o.createElement(u.A,{open:!0,onClose:r,anchorOrigin:{vertical:"bottom",horizontal:"center"}},o.createElement(d.A,{onClose:r,action:n.action?o.createElement(o.Fragment,null,o.createElement(m.A,{color:"inherit",onClick:e=>{n.action?.onClick(),r()}},n.action.name),o.createElement(p.A,{color:"inherit",onClick:r},o.createElement(c.A,null))):null,severity:n.level||"warning"},n.message)):null}));var g=n(27281),h=n(75785),y=n(67386),w=n(89003),b=n(62859);const v=(0,h.n9)()((e=>({left:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),left:e.spacing(2)},right:{zIndex:1e4,position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}))),C=(0,a.observer)((function({session:e}){const{minimized:t,activeWidgets:n,drawerPosition:r}=e,{classes:s}=v();return n.size>0&&t?o.createElement(w.A,{title:"Open drawer widget"},o.createElement(b.A,{className:"right"===r?s.right:s.left,color:"primary","data-testid":"drawer-maximize",onClick:()=>{e.showWidgetDrawer()}},o.createElement(y.A,null))):null}));var A=n(68584),S=n(34895);const E=(0,a.observer)((function({session:e}){const{configuration:t}=e,n=(0,A.readConfObject)(t,"logoPath");return n?.uri?o.createElement("img",{src:n.uri,alt:"Custom logo"}):o.createElement(S.P,{variant:"white"})}));var k=n(32813),M=n(963),T=n(8463);const P=(0,h.n9)()((e=>({buttonRoot:{"&:hover":{backgroundColor:(0,M.X4)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}}}))),I=(0,a.observer)((function({menuTitle:e,session:t,menuItems:n}){const[r,s]=(0,o.useState)(!1),a=(0,o.useRef)(null),{classes:i}=P();function l(){s(!1)}return o.createElement(o.Fragment,null,o.createElement(m.A,{ref:a,onClick:()=>{s(!r)},color:"inherit","data-testid":"dropDownMenuButton",classes:{root:i.buttonRoot}},e,o.createElement(k.A,null)),o.createElement(T.A,{anchorEl:a.current,anchorOrigin:{vertical:"bottom",horizontal:"left"},onMenuItemClick:(e,n)=>{n(t),l()},open:r,onClose:l,menuItems:n}))}));var N=n(88373),x=n(17515);const R=(0,h.n9)()((e=>({grow:{flexGrow:1},inputBase:{color:e.palette.primary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.primary.light}},inputFocused:{borderColor:e.palette.secondary.main,backgroundColor:e.palette.primary.light}}))),D=(0,a.observer)((function({session:e,HeaderButtons:t=o.createElement("div",null)}){const{classes:n}=R(),{name:r,menus:s}=e;return o.createElement(x.A,null,s().map((t=>o.createElement(I,{key:t.label,menuTitle:t.label,menuItems:t.menuItems,session:e}))),o.createElement("div",{className:n.grow}),o.createElement(w.A,{title:"Rename session",arrow:!0},o.createElement(N.A,{value:r,variant:"body1",classes:{inputBase:n.inputBase,inputRoot:n.inputRoot,inputFocused:n.inputFocused},setValue:t=>{e.renameCurrentSession(t)}})),t,o.createElement("div",{className:n.grow}),o.createElement("div",{style:{width:150,maxHeight:48}},o.createElement(E,{session:e})))})),O=(0,a.observer)((function({session:e}){const{DialogComponent:t,DialogProps:n}=e;return t?o.createElement(o.Suspense,{fallback:null},o.createElement(t,n)):null}));var L=n(99546),j=n(943),$=n(36715),z=n(48171),W=n(98360),V=n(29629);const U=(0,h.n9)()((e=>({selectPaper:{padding:e.spacing(4)},m2:{margin:2}}))),F=(0,a.observer)((({session:e})=>{const{classes:t}=U(),{pluginManager:n}=(0,L.getEnv)(e),r=n.getViewElements(),[s,a]=(0,o.useState)(r[0]?.name||"");return o.createElement(j.A,{className:t.selectPaper},o.createElement($.A,null,"Select a view to launch"),o.createElement(z.A,{className:t.m2},o.createElement(W.A,{value:s,onChange:e=>{a(e.target.value)}},r.filter((({viewMetadata:e})=>!e.hiddenFromGUI)).map((({displayName:e,name:t})=>o.createElement(V.A,{key:t,value:t},e))))),o.createElement(z.A,{className:t.m2},o.createElement(m.A,{onClick:()=>e.addView(s,{}),variant:"contained",color:"primary"},"Launch view")))}));var B=n(38033),H=n(37565),G=n(48231),q=n(374),_=n(51469),J=n(16217);const Q=(0,h.n9)()((e=>({input:{paddingBottom:0,paddingTop:2},inputBase:{color:e.palette.secondary.contrastText},inputRoot:{"&:hover":{backgroundColor:e.palette.secondary.light}},inputFocused:{borderColor:e.palette.primary.main,backgroundColor:e.palette.secondary.light}}))),K=(0,a.observer)((function({view:e}){const{classes:t}=Q();return o.createElement(w.A,{title:"Rename view",arrow:!0},o.createElement(N.A,{value:e.displayName||`${e.assemblyNames?.join(",")||"Untitled view"}${e.minimized?" (minimized)":""}`,setValue:t=>{e.setDisplayName(t)},variant:"body2",classes:{input:t.input,inputBase:t.inputBase,inputRoot:t.inputRoot,inputFocused:t.inputFocused}}))}));var Z=n(85206),Y=n(66195),X=n(21430),ee=n(91388),te=n(42281),ne=n(922),oe=n(45266);function re(){return re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},re.apply(null,arguments)}const se=(0,a.observer)((function({model:e,IconButtonProps:t,IconProps:n}){const r=(0,L.getSession)(e),s=(0,oe.T6)({popupId:"viewMenu",variant:"popover"});return o.createElement(o.Fragment,null,o.createElement(p.A,re({},t,(0,oe.cO)(s),{"data-testid":"view_menu_icon"}),o.createElement(ne.A,re({},n,{fontSize:"small"}))),o.createElement(Z.A,re({},(0,oe.dB)(s),{onMenuItemClick:(e,t)=>{t()},menuItems:[...r.views.length>1?[{label:"View order",type:"subMenu",subMenu:[...r.views.length>2?[{label:"Move view to top",icon:te.A,onClick:()=>{r.moveViewToTop(e.id)}}]:[],{label:"Move view up",icon:X.A,onClick:()=>{r.moveViewUp(e.id)}},{label:"Move view down",icon:Y.A,onClick:()=>{r.moveViewDown(e.id)}},...r.views.length>2?[{label:"Move view to bottom",icon:ee.A,onClick:()=>{r.moveViewToBottom(e.id)}}]:[]]}]:[],...e.menuItems()],popupState:s})))})),ae=(0,h.n9)()((e=>({icon:{color:e.palette.secondary.contrastText},grow:{flexGrow:1},viewHeader:{display:"flex"},viewTitle:{display:"flex",alignItems:"center"}}))),ie=(0,a.observer)((function({view:e,onClose:t,onMinimize:n}){const{classes:r}=ae();return o.createElement(o.Fragment,null,o.createElement(p.A,{"data-testid":"minimize_view",onClick:n},e.minimized?o.createElement(q.A,{className:r.icon,fontSize:"small"}):o.createElement(J.A,{className:r.icon,fontSize:"small"})),o.createElement(p.A,{"data-testid":"close_view",onClick:t},o.createElement(c.A,{className:r.icon,fontSize:"small"})))})),le=(0,a.observer)((function({view:e,onClose:t,onMinimize:n}){const{classes:r}=ae(),s=(0,o.useRef)(null),a=(0,L.getSession)(e);return(0,o.useEffect)((()=>{"undefined"==typeof jest&&s.current?.scrollIntoView({block:"center"})}),[]),o.createElement("div",{ref:s,className:r.viewHeader},o.createElement(se,{model:e,IconProps:{className:r.icon}}),o.createElement("div",{className:r.grow}),o.createElement("div",{className:r.viewTitle},a.focusedViewId===e.id?o.createElement(_.A,{className:r.icon,fontSize:"small"}):null,o.createElement(K,{view:e})),o.createElement("div",{className:r.grow}),o.createElement(ie,{onClose:t,onMinimize:n,view:e}))})),ce=(0,h.n9)()((e=>({viewContainer:{overflow:"hidden",margin:e.spacing(.5),padding:`0 ${e.spacing(1)} ${e.spacing(1)}`},focusedView:{background:e.palette.secondary.main},unfocusedView:{background:e.palette.secondary.dark}}))),ue=(0,a.observer)((function({view:e,onClose:t,onMinimize:n,children:r}){const s=(0,G.A)(),a=(0,L.useWidthSetter)(e,s.spacing(1)),{classes:i,cx:l}=ce(),c=(0,L.getSession)(e);return(0,o.useEffect)((()=>{function t(t){t.target instanceof Element&&a.current?.contains(t.target)&&c.setFocusedViewId(e.id)}return document.addEventListener("mousedown",t),document.addEventListener("keydown",t),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("keydown",t)}}),[a,c,e]),o.createElement(j.A,{ref:a,elevation:12,className:l(i.viewContainer,c.focusedViewId===e.id?i.focusedView:i.unfocusedView)},o.createElement(le,{view:e,onClose:t,onMinimize:n}),o.createElement(j.A,null,r))})),de=(0,a.observer)((function({view:e,session:t}){const{pluginManager:n}=(0,L.getEnv)(t),r=n.getViewType(e.type);if(!r)throw new Error(`unknown view type ${e.type}`);const{ReactComponent:a}=r;return o.createElement(ue,{view:e,onClose:()=>{t.removeView(e)},onMinimize:()=>{e.setMinimized(!e.minimized)}},!e.minimized&&o.createElement(s.t,{FallbackComponent:({error:e})=>o.createElement(B.A,{error:e})},o.createElement(o.Suspense,{fallback:o.createElement(H.A,{variant:"h6"})},o.createElement(a,{model:e,session:t}))))})),me=(0,h.n9)()({viewsContainer:{overflowY:"auto",gridRow:"components"}}),pe=(0,a.observer)((function(e){const{session:t}=e,{views:n}=t,{classes:r}=me();return o.createElement("div",{className:r.viewsContainer},n.length>0?n.map((e=>o.createElement(de,{key:`view-${e.id}`,view:e,session:t}))):o.createElement(F,e),o.createElement("div",{style:{height:300}}))})),fe=(0,o.lazy)((()=>n.e(8076).then(n.bind(n,88076)))),ge=(0,h.n9)()((e=>({root:{display:"grid",height:"100vh",width:"100%",colorScheme:e.palette.mode},appContainer:{gridColumn:"main",display:"grid",gridTemplateRows:"[menubar] min-content [components] auto",height:"100vh"},appBar:{flexGrow:1,gridRow:"menubar"}}))),he=(0,a.observer)((function(e){const{session:t}=e;return o.createElement(o.Suspense,{fallback:null},o.createElement(fe,{session:t}))})),ye=(0,a.observer)((function(e){const{session:t}=e,{classes:n}=ge(),{minimized:r,visibleWidget:s,drawerWidth:a,drawerPosition:i}=t,l=s&&!r,c=l?`[drawer] ${a}px`:void 0,u="right"===i?["[main] 1fr",c]:[c,"[main] 1fr"];return o.createElement("div",{className:n.root,style:{gridTemplateColumns:u.filter((e=>!!e)).join(" ")}},l&&"left"===i?o.createElement(he,{session:t}):null,o.createElement(O,{session:t}),o.createElement("div",{className:n.appContainer},o.createElement(g.A,{className:n.appBar,position:"static"},o.createElement(D,e)),o.createElement(pe,e)),o.createElement(C,{session:t}),l&&"right"===i?o.createElement(he,{session:t}):null,o.createElement(f,{session:t}))}));var we=n(36422);const be=we.types.model("TimeTraveller",{undoIdx:-1,targetPath:""}).volatile((()=>({history:[],notTrackingUndo:!1}))).views((e=>({get canUndo(){return e.undoIdx>0&&!e.notTrackingUndo},get canRedo(){return e.undoIdx<e.history.length-1&&!e.notTrackingUndo}}))).actions((e=>{let t,n,o=!1;return{stopTrackingUndo(){e.notTrackingUndo=!0},resumeTrackingUndo(){e.notTrackingUndo=!1},addUndoState(t){e.notTrackingUndo||(o?o=!1:(e.history.splice(e.undoIdx+1),e.history.push(t),e.history.length>20&&e.history.shift(),e.undoIdx=e.history.length-1))},beforeDestroy(){n()},initialize(){if(t=e.targetPath?(0,we.resolvePath)(e,e.targetPath):(0,we.getEnv)(e).targetStore,!t)throw new Error("Failed to find target store for TimeTraveller. Please provide `targetPath` property, or a `targetStore` in the environment");n=(0,we.onSnapshot)(t,function(e,t=300){let n;return(...o)=>{clearTimeout(n),n=setTimeout((()=>{e(...o)}),t)}}((e=>{this.addUndoState(e)}),300)),0===e.history.length&&this.addUndoState((0,we.getSnapshot)(t))},undo(){e.undoIdx--,o=!0,t&&(0,we.applySnapshot)(t,e.history[e.undoIdx])},redo(){e.undoIdx++,o=!0,t&&(0,we.applySnapshot)(t,e.history[e.undoIdx])}}}));var ve=n(42489);function Ce(e){return!("function"==typeof e||e instanceof Error)}class Ae{constructor(e){this.driver=e}async getWorker(){return this.workerP||(this.workerP=this.driver.makeWorker().catch((e=>{throw this.workerP=void 0,e}))),this.workerP}}class Se{lastWorkerAssignment=-1;workerAssignments=new Map;maxPingTime=3e4;workerCheckFrequency=5e3;constructor(e){this.config=e.config}filterArgs(e,t){if(Array.isArray(e))return e.filter((e=>Ce(e))).map((e=>this.filterArgs(e,t)));if("object"==typeof e&&null!==e){if((0,we.isStateTreeNode)(e)&&!(0,we.isAlive)(e))throw new Error("dead state tree node passed to RPC call");return e instanceof File?e:Object.fromEntries(Object.entries(e).filter((e=>Ce(e[1]))).map((([e,n])=>[e,this.filterArgs(n,t)])))}return e}async remoteAbort(e,t,n){const o=await this.getWorker(e);await o.call(t,{stopTokenId:n},{timeout:1e6,rpcDriverClassName:this.name})}createWorkerPool(){const e=function(){const e="undefined"!=typeof window,t=e&&"hardwareConcurrency"in window.navigator;return e&&t?window.navigator.hardwareConcurrency:1}(),t=(0,A.readConfObject)(this.config,"workerCount")||(0,L.clamp)(1,Math.max(1,e-1),5),n=[];for(let e=0;e<t;e++)n.push(new Ae(this));return n}getWorkerPool(){if(!this.workerPool){const e=this.createWorkerPool();return this.workerPool=e,e}return this.workerPool}async getWorker(e){const t=this.getWorkerPool();let n=this.workerAssignments.get(e);if(void 0===n){const o=(this.lastWorkerAssignment+1)%t.length;this.workerAssignments.set(e,o),this.lastWorkerAssignment=o,n=o}return t[n].getWorker()}async call(e,t,n,o,r={}){if(!t)throw new TypeError("sessionId is required");const s=await this.getWorker(t),a=e.evaluateExtensionPoint("Core-extendWorker",s),i=e.getRpcMethodType(n);if(!i)throw new Error(`unknown RPC method ${n}`);const l=await i.serializeArguments(o,this.name),c=this.filterArgs(l,t),u=await a.call(n,c,{timeout:3e5,statusCallback:o.statusCallback,rpcDriverClassName:this.name,...r});return i.deserializeReturn(u,o,this.name)}}class Ee{destroy(){}async call(e,t,n={}){}}class ke extends Se{name="MainThreadRpcDriver";constructor(e){super(e),this.makeWorker=async()=>new Ee}async call(e,t,n,o){if(!t)throw new TypeError("sessionId is required");const r=e.getRpcMethodType(n);if(!r)throw new Error(`unknown RPC method ${n}`);const s=await r.serializeArguments(o,this.name),a=await r.execute(s,this.name);return r.deserializeReturn(a,o,this.name)}}var Me=n(76519),Te=n(39154),Pe=n(32761);class Ie extends Me.A.Client{destroy(){this.workers[0].terminate()}async call(e,t,n){const{statusCallback:o,rpcDriverClassName:r}=n,s=`message-${(0,Pe.Ak)()}`,a=e=>{o?.(e)};this.on(s,a);const i=await super.call(e,{...t,channel:s,rpcDriverClassName:r},n);return this.off(s,a),i}}class Ne extends Se{name="WebWorkerRpcDriver";constructor(e,t){super(e),this.workerBootConfiguration=t,this.makeWorkerInstance=e.makeWorkerInstance}async makeWorker(){const e=this.makeWorkerInstance(),t=new Ie({workers:[e]});return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&console.log("console logging the webworker handle avoids the track going into an infinite loading state, this is a hacky workaround for safari",e),new Promise(((e,n)=>{const o=r=>{switch(r.data.message){case"ready":e(t),t.workers[0].removeEventListener("message",o);break;case"readyForConfig":t.workers[0].postMessage({message:"config",config:this.workerBootConfiguration});break;case"error":n((0,Te.deserializeError)(r.data.error))}};t.workers[0].addEventListener("message",o)}))}}const xe=(0,A.ConfigurationSchema)("BaseRpcDriver",{workerCount:{type:"number",description:"The number of workers to use. If 0 (the default) JBrowse will decide how many workers to use.",defaultValue:0}},{explicitlyTyped:!0}),Re=(0,A.ConfigurationSchema)("MainThreadRpcDriver",{},{baseConfiguration:xe,explicitlyTyped:!0}),De=(0,A.ConfigurationSchema)("WebWorkerRpcDriver",{},{baseConfiguration:xe,explicitlyTyped:!0}),Oe=(0,A.ConfigurationSchema)("RpcOptions",{defaultDriver:{type:"string",description:"the RPC driver to use for tracks and tasks that are not configured to use a specific RPC backend",defaultValue:"MainThreadRpcDriver"},drivers:we.types.optional(we.types.map(we.types.union(Re,De)),{MainThreadRpcDriver:{type:"MainThreadRpcDriver"},WebWorkerRpcDriver:{type:"WebWorkerRpcDriver"}})},{actions:e=>({addDriverConfig(t,n){e.drivers.set(t,n)}})});class Le{static configSchema=Oe;constructor(e,t,n){this.pluginManager=e,this.mainConfiguration=t,this.backendConfigurations=n,this.driverObjects=new Map}getDriver(e){const t=this.driverObjects.get(e);if(t)return t;const n=this.mainConfiguration.drivers.get("WebWorkerRpcDriver");if("MainThreadRpcDriver"===e){const t=this.backendConfigurations.MainThreadRpcDriver;if(!t)throw new Error(`requested RPC driver "${e}" is missing config`);const o=new ke({...t,config:n});return this.driverObjects.set(e,o),o}if("WebWorkerRpcDriver"===e){const t=this.backendConfigurations.WebWorkerRpcDriver;if(!t)throw new Error(`requested RPC driver "${e}" is missing config`);const o=new Ne({...t,config:n},{plugins:this.pluginManager.runtimePluginDefinitions,windowHref:window.location.href});return this.driverObjects.set(e,o),o}throw new Error(`requested RPC driver "${e}" is not installed`)}async getDriverForCall(e,t,n){const o=n.rpcDriverName||(0,A.readConfObject)(this.mainConfiguration,"defaultDriver");return this.getDriver(o)}async call(e,t,n,o={}){if(!e)throw new Error("sessionId is required");return(await this.getDriverForCall(e,t,n)).call(this.pluginManager,e,t,n,o)}}function je({menus:e,menuName:t}){return e.push({label:t,menuItems:[]})}function $e({menus:e,menuName:t,position:n}){return e.splice((n<0?e.length:0)+n,0,{label:t,menuItems:[]}),e.length}function ze({menus:e,menuName:t,menuItem:n}){const o=e.find((e=>e.label===t));return o?o.menuItems.push(n):(e.push({label:t,menuItems:[n]}),1)}function We({menus:e,menuName:t,menuItem:n,position:o}){const r=e.find((e=>e.label===t));if(!r)return e.push({label:t,menuItems:[n]}),1;const s=o<0?r.menuItems.length+o:o;return r.menuItems.splice(s,0,n),r.menuItems.length}function Ve({menus:e,menuPath:t,menuItem:n}){let o=e.find((e=>e.label===t[0]));o||(o=e[je({menus:e,menuName:t[0]})-1]);let{menuItems:r}=o;const s=[t[0]];return t.slice(1).forEach((e=>{s.push(e);let t=r.find((t=>"label"in t&&t.label===e));if(!t){const n=r.push({label:e,subMenu:[]});t=r[n-1]}if(!("subMenu"in t))throw new Error(`"${e}" in path "${s}" is not a subMenu`);r=t.subMenu})),r.push(n)}function Ue({menus:e,menuPath:t,menuItem:n,position:o}){let r=e.find((e=>e.label===t[0]));r||(r=e[je({menus:e,menuName:t[0]})-1]);let{menuItems:s}=r;const a=[t[0]];return t.slice(1).forEach((e=>{a.push(e);let t=s.find((t=>"label"in t&&t.label===e));if(!t){const n=s.push({label:e,subMenu:[]});t=s[n-1]}if(!("subMenu"in t))throw new Error(`"${e}" in path "${a}" is not a subMenu`);s=t.subMenu})),s.splice(o,0,n),s.length}var Fe=n(20139),Be=n(16179),He=n(37702);const Ge=(0,h.n9)()((e=>({shareDiv:{textAlign:"center",paddingLeft:"2px"},shareButton:{backgroundColor:(0,M.X4)(e.palette.primary.contrastText,e.palette.action.hoverOpacity),"&:hover":{"@media (hover: none)":{backgroundColor:"transparent"}}}}))),qe=(0,o.lazy)((()=>n.e(7663).then(n.bind(n,47663)))),_e=(0,a.observer)((function(e){const[t,n]=(0,o.useState)(!1),{session:r}=e,{classes:s}=Ge();return o.createElement("div",{className:s.shareDiv},o.createElement(m.A,{onClick:async()=>{n(!0)},size:"small",color:"inherit",startIcon:o.createElement(He.A,null),classes:{root:s.shareButton}},"Share"),t?o.createElement(o.Suspense,{fallback:null},o.createElement(qe,{handleClose:()=>{n(!1)},session:r})):null)})),Je=(0,a.observer)((function({pluginManager:e}){const[t]=(0,i.useQueryParam)("adminKey",i.StringParam),[n]=(0,i.useQueryParam)("adminServer",i.StringParam),[r]=(0,i.useQueryParam)("config",i.StringParam),[,s]=(0,i.useQueryParam)("session",i.StringParam),{rootModel:a}=e,{error:l,jbrowse:c}=a||{},u=a?.session,d=u?.id;if((0,o.useEffect)((()=>{s(`local-${d}`,"replaceIn"),window.JBrowseRootModel=a,window.JBrowseSession=u}),[d,a,u,s]),(0,o.useEffect)((()=>{if(c&&t)return(0,we.onSnapshot)(c,(async e=>{try{const o=await fetch(n||"/updateConfig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({adminKey:t,configPath:r,config:e})});if(!o.ok){const e=await o.text();throw new Error(`HTTP ${o.status} (${e})`)}}catch(e){u?.notify(`Admin server error: ${e}`)}}))}),[c,u,t,n,r]),l)throw l;if(!a)throw new Error("No rootModel found");if(!u)throw new Error("No session found");return o.createElement(Fe.A,{theme:u.theme},o.createElement(Be.Ay,null),o.createElement(ye,{session:u,HeaderButtons:o.createElement(_e,{session:u})}))}));var Qe=n(25122),Ke=n(59773),Ze=n(99834),Ye=n(17765),Xe=n(49409);const et=we.types.model({configPath:we.types.maybe(we.types.string),sessionQuery:we.types.maybe(we.types.string),password:we.types.maybe(we.types.string),adminKey:we.types.maybe(we.types.string),loc:we.types.maybe(we.types.string),sessionTracks:we.types.maybe(we.types.string),assembly:we.types.maybe(we.types.string),tracks:we.types.maybe(we.types.string),tracklist:we.types.maybe(we.types.boolean),highlight:we.types.maybe(we.types.string),nav:we.types.maybe(we.types.boolean),initialTimestamp:we.types.number}).volatile((()=>({sessionTriaged:void 0,configSnapshot:void 0,sessionSnapshot:void 0,sessionSpec:void 0,blankSession:!1,runtimePlugins:[],sessionPlugins:[],sessionError:void 0,configError:void 0,bc1:window.BroadcastChannel?new window.BroadcastChannel("jb_request_session"):void 0,bc2:window.BroadcastChannel?new window.BroadcastChannel("jb_respond_session"):void 0}))).views((e=>({get isSharedSession(){return!!e.sessionQuery?.startsWith("share-")},get isSpecSession(){return!!e.sessionQuery?.startsWith("spec-")},get isJb1StyleSession(){return!!e.loc},get isEncodedSession(){return!!e.sessionQuery?.startsWith("encoded-")},get isJsonSession(){return!!e.sessionQuery?.startsWith("json-")},get isLocalSession(){return!!e.sessionQuery?.startsWith("local-")},get ready(){return Boolean(this.isSessionLoaded&&!e.configError)},get error(){return e.configError||e.sessionError},get isSessionLoaded(){return Boolean(e.sessionError||e.sessionSnapshot||e.blankSession||e.sessionSpec)},get isConfigLoaded(){return Boolean(e.configError||e.configSnapshot)},get sessionTracksParsed(){return e.sessionTracks?JSON.parse(e.sessionTracks):[]}}))).actions((e=>({setSessionQuery(t){e.sessionQuery=t},setConfigError(t){e.configError=t},setSessionError(t){e.sessionError=t},setRuntimePlugins(t){e.runtimePlugins=t},setSessionPlugins(t){e.sessionPlugins=t},setConfigSnapshot(t){e.configSnapshot=t},setBlankSession(t){e.blankSession=t},setSessionTriaged(t){e.sessionTriaged=t},setSessionSnapshotSuccess(t){e.sessionSnapshot=t}}))).actions((e=>({async fetchPlugins(t){try{const n=new Ke.Ay(t.plugins,{fetchESM:e=>import(e)});n.installGlobalReExports(window);const o=await n.load(window.location.href);e.setRuntimePlugins([...o])}catch(t){console.error(t),e.setConfigError(t)}},async fetchSessionPlugins(t){try{const n=new Ke.Ay(t.sessionPlugins||[],{fetchESM:e=>import(e)});n.installGlobalReExports(window);const o=await n.load(window.location.href);e.setSessionPlugins([...o])}catch(t){console.error(t),e.setConfigError(t)}},async setSessionSnapshot(t,n){try{const{sessionPlugins:o=[]}=t;await(0,Xe.pS)(o)||n?(await this.fetchSessionPlugins(t),e.setSessionSnapshotSuccess(t)):e.setSessionTriaged({snap:t,origin:"session",reason:o})}catch(t){console.error(t),e.setConfigError(t)}},async fetchConfig(){let{configPath:t=window.__jbrowseConfigPath||"config.json"}=e;window.__jbrowseCacheBuster&&(t+=`?rand=${Math.random()}`);const n=await(0,Ze.openLocation)({uri:t,locationType:"UriLocation"}).readFile("utf8"),o=JSON.parse(n),r=new URL(t,window.location.href);if((0,Xe.XE)(o,r),r.hostname!==window.location.hostname){const t=o.plugins||[];if(!await(0,Xe.pS)(t))return void e.setSessionTriaged({snap:o,origin:"config",reason:t})}await this.fetchPlugins(o),e.setConfigSnapshot(o)},async fetchSessionStorageSession(){const t=sessionStorage.getItem("current"),n=e.sessionQuery.replace("local-","");if(t){const e=JSON.parse(t).session||{};if(n===e.id)return this.setSessionSnapshot(e)}if(e.bc1){e.bc1.postMessage(n);try{const t=await new Promise(((t,n)=>{e.bc2&&(e.bc2.onmessage=e=>{t(e.data)}),setTimeout((()=>{n(new Error("timeout"))}),1e3)}));await this.setSessionSnapshot({...t,id:(0,Pe.Ak)()})}catch(e){}}throw new Error("Local storage session not found")},async fetchSharedSession(){const t=await(0,Ye.Z)(`${(0,Xe.Vr)(e.configSnapshot,"shareURL","https://share.jbrowse.org/api/v1/")}load`,e.sessionQuery||"",e.password||""),n=JSON.parse(await(0,Xe.LP)(t));await this.setSessionSnapshot({...n,id:(0,Pe.Ak)()})},async decodeEncodedUrlSession(){const t=JSON.parse(await(0,Xe.LP)(e.sessionQuery.replace("encoded-","")));await this.setSessionSnapshot({...t,id:(0,Pe.Ak)()})},decodeSessionSpec(){e.sessionQuery&&(e.sessionSpec=JSON.parse(e.sessionQuery.replace("spec-","")))},decodeJb1StyleSession(){const{loc:t,tracks:n,assembly:o,tracklist:r,nav:s,highlight:a,sessionTracksParsed:i}=e;t&&(e.sessionSpec={sessionTracks:i,views:[{type:"LinearGenomeView",tracks:n?.split(","),sessionTracks:i,loc:t,assembly:o,tracklist:r,nav:s,highlight:a?.split(" ")}]})},async decodeJsonUrlSession(){const t=JSON.parse(e.sessionQuery.replace("json-",""));await this.setSessionSnapshot({...t.session,id:(0,Pe.Ak)()})},afterCreate(){(async()=>{try{await this.fetchConfig(),(0,we.addDisposer)(e,(0,ve.autorun)((async()=>{try{const{isLocalSession:t,isEncodedSession:n,isSpecSession:o,isSharedSession:r,isJsonSession:s,isJb1StyleSession:a,sessionQuery:i,configSnapshot:l}=e;if(!l)return;if(e.bc1&&(e.bc1.onmessage=t=>{const n=JSON.parse(sessionStorage.getItem("current")||"{}").session||{};n.id===t.data&&e.bc2&&e.bc2.postMessage(n)}),r)await this.fetchSharedSession();else if(o)this.decodeSessionSpec();else if(a)this.decodeJb1StyleSession();else if(n)await this.decodeEncodedUrlSession();else if(s)await this.decodeJsonUrlSession();else if(t)await this.fetchSessionStorageSession();else{if(i)throw new Error("unrecognized session format");e.setBlankSession(!0)}}catch(t){console.error(t),e.setSessionError(t)}})))}catch(t){return console.error(t),void e.setConfigError(t)}})()}})));var tt=n(55252);function nt({error:e}){return/HTTP 404 fetching config.json/.exec(`${e}`)?o.createElement("div",null,o.createElement("h1",null,"It worked!"),o.createElement("p",{style:{margin:8,padding:8,background:"#9f9",border:"1px solid green"}},"JBrowse 2 is installed. Your next step is to add and configure an assembly. Follow our"," ",o.createElement("a",{href:"https://jbrowse.org/jb2/docs/quickstart_web/"},"quick start guide")," ","to continue or browse the sample data"," ",o.createElement("a",{href:"?config=test_data/volvox/config.json"},"here"),"."),null):o.createElement("div",null,o.createElement("h1",null,"JBrowse Error"),o.createElement(r.ErrorMessage,{error:e}))}var ot=n(70129);var rt=n(66514),st=n(83059);var at=n(90542),it=n(16574),lt=n(47046),ct=n(3496),ut=n(43334);const dt=new RegExp("[0-9A-Za-z!#$%&+./:;?@^_|~-][0-9A-Za-z!#$%&*+./:;=?@^_|~-]*"),mt=["rgb(153, 102, 0)","rgb(102, 102, 0)","rgb(153, 153, 30)","rgb(204, 0, 0)","rgb(255, 0, 0)","rgb(255, 0, 204)","rgb(165, 132, 132)","rgb(204, 122, 0)","rgb(178, 142, 0)","rgb(153, 153, 0)","rgb(122, 153, 0)","rgb(0, 165, 0)","rgb(53, 128, 0)","rgb(0, 0, 204)","rgb(96, 145, 242)","rgb(107, 142, 178)","rgb(0, 165, 165)","rgb(122, 153, 153)","rgb(153, 0, 204)","rgb(204, 51, 255)","rgb(173, 130, 216)","rgb(102, 102, 102)","rgb(145, 145, 145)","rgb(142, 142, 142)","rgb(142, 142, 107)","rgb(96, 163, 48)"];function pt(e){if(!dt.test(e))throw new Error(`Encountered invalid refName: "${e}"`)}function ft(e,t){const n=new lt.A({cache:new ut.A({maxSize:1e3}),async fill(e,t,n){const{adapterConf:o,self:r,options:s}=e;return async function(e,t,n){const{sessionId:o}=n;await(0,L.when)((()=>!(!e.regions||!e.refNameAliases)),{name:"when assembly ready"});const r=await e.rpcManager.call(o||"assemblyRpc","CoreGetRefNames",{adapterConfig:t,stopToken:void 0,...n},{timeout:1e6}),{refNameAliases:s}=e;if(!s)throw new Error(`error loading assembly ${e.name}'s refNameAliases`);const a=Object.fromEntries(r.map((t=>(pt(t),[e.getCanonicalRefName(t),t]))));return{forwardMap:a,reverseMap:Object.fromEntries(Object.entries(a).map((([e,t])=>[t,e])))}}(r,o,{...s,statusCallback:n})}});return we.types.model({configuration:we.types.safeReference(e)}).volatile((()=>({error:void 0,loadingP:void 0,volatileRegions:void 0,refNameAliases:void 0,lowerCaseRefNameAliases:void 0,cytobands:void 0}))).views((e=>({getConf:t=>e.configuration?(0,A.getConf)(e,t):void 0}))).views((e=>({get initialized(){return e.load(),!!e.refNameAliases},get name(){return e.getConf("name")||""},get regions(){return e.load(),e.volatileRegions},get aliases(){return e.getConf("aliases")||[]},get displayName(){return e.getConf("displayName")},hasName(e){return this.allAliases.includes(e)},get allAliases(){return[this.name,...this.aliases]},get allRefNames(){return e.refNameAliases?Object.keys(e.refNameAliases):void 0},get lowerCaseRefNames(){return e.lowerCaseRefNameAliases?Object.keys(e.lowerCaseRefNameAliases):void 0},get allRefNamesWithLowerCase(){return this.allRefNames&&this.lowerCaseRefNames?[...new Set([...this.allRefNames,...this.lowerCaseRefNames])]:void 0},get rpcManager(){return(0,we.getParent)(e,2).rpcManager},get refNameColors(){const t=e.getConf("refNameColors")||[];return 0===t.length?mt:t}}))).views((e=>({get refNames(){return e.regions?.map((e=>e.refName))}}))).views((e=>({getCanonicalRefName(t){if(!e.refNameAliases||!e.lowerCaseRefNameAliases)throw new Error("aliases not loaded, we expect them to be loaded before getCanonicalRefName can be called");return e.refNameAliases[t]||e.lowerCaseRefNameAliases[t]},getRefNameColor(t){if(!e.refNames)return;const n=e.refNames.indexOf(t);return-1===n?void 0:e.refNameColors[n%e.refNameColors.length]},isValidRefName(t){if(!e.refNameAliases)throw new Error("isValidRefName cannot be called yet, the assembly has not finished loading");return!!this.getCanonicalRefName(t)}}))).actions((e=>({setLoaded({regions:e,refNameAliases:t,lowerCaseRefNameAliases:n,cytobands:o}){this.setRegions(e),this.setRefNameAliases(t,n),this.setCytobands(o)},setError(t){e.error=t},setRegions(t){e.volatileRegions=t},setRefNameAliases(t,n){e.refNameAliases=t,e.lowerCaseRefNameAliases=n},setCytobands(t){e.cytobands=t},setLoadingP(t){e.loadingP=t},load(){return e.loadingP||(e.loadingP=this.loadPre().catch((e=>{this.setLoadingP(void 0),this.setError(e)}))),e.loadingP},async loadPre(){const n=e.configuration,o=n?.refNameAliases?.adapter,r=n?.cytobands?.adapter,s=n?.sequence.adapter,a=e.name,i=await async function({config:e,pluginManager:t,stopToken:n}){const o=t.getAdapterType(e.type);return new(await o.getAdapterClass())(e,void 0,t).getRegions({stopToken:n})}({config:s,pluginManager:t}),l=i.map((e=>(pt(e.refName),{...e,assemblyName:a}))),c={},u=await async function({config:e,pluginManager:t,stopToken:n}){const o=t.getAdapterType(e.type);return new(await o.getAdapterClass())(e,void 0,t).getRefNameAliases({stopToken:n})}({config:o,pluginManager:t});for(const{refName:e,aliases:t,override:n}of u){for(const n of t)pt(n),c[n]=e;n&&(c[e]=e)}for(const e of l)c[e.refName]||=e.refName;const d=Object.fromEntries(Object.entries(c).map((([e,t])=>[e.toLowerCase(),t])));this.setLoaded({refNameAliases:c,regions:l.map((e=>({...e,refName:c[e.refName]||e.refName}))),lowerCaseRefNameAliases:d,cytobands:await gt({config:r,pluginManager:t})})}}))).views((e=>({getAdapterMapEntry(t,o){const{stopToken:r,statusCallback:s,...a}=o;if(!o.sessionId)throw new Error("sessionId is required");return n.get((0,ct.LS)(t),{adapterConf:t,self:e,options:a},void 0,s)},async getRefNameMapForAdapter(e,t){if(!t.sessionId)throw new Error("sessionId is required");return(await this.getAdapterMapEntry(e,t)).forwardMap},async getReverseRefNameMapForAdapter(e,t){return(await this.getAdapterMapEntry(e,t)).reverseMap}})))}async function gt({config:e,pluginManager:t}){const n=t.getAdapterType(e.type);return new(await n.getAdapterClass())(e,void 0,t).getData()}var ht=n(96757),yt=n(39548),wt=n(29078),bt=n(29417),vt=n(91194),Ct=n(550),At=n(83105),St=n(22168),Et=n(1185),kt=n(62424),Mt=n(73299),Tt=n(55078),Pt=n(45465),It=n(9452),Nt=n(81886);function xt(){return new Worker(new URL(n.p+n.u(2047),n.b))}window.getSnapshot=we.getSnapshot,window.resolveIdentifier=we.resolveIdentifier;const Rt=(0,o.lazy)((()=>n.e(9675).then(n.bind(n,79675)))),Dt=(0,o.lazy)((()=>n.e(2928).then(n.bind(n,62928))));function Ot({pluginManager:e,sessionModelFactory:t,adminMode:n=!1}){const o=function(e){return(0,A.ConfigurationSchema)("BaseAssembly",{aliases:{type:"stringArray",defaultValue:[],description:"Other possible names for the assembly"},sequence:e.getTrackType("ReferenceSequenceTrack").configSchema,refNameColors:{type:"stringArray",defaultValue:[],description:"Define custom colors for each reference sequence. Will cycle through this list if there are not enough colors for every sequence."},refNameAliases:(0,A.ConfigurationSchema)("RefNameAliases",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"RefNameAliasAdapter"}}}),cytobands:(0,A.ConfigurationSchema)("Cytoband",{adapter:e.pluggableConfigSchemaType("adapter")},{preProcessSnapshot:e=>e.adapter?e:{adapter:{type:"CytobandAdapter"}}}),displayName:{type:"string",defaultValue:"",description:'A human readable display name for the assembly e.g. "Homo sapiens (hg38)" while the assembly name may just be "hg38"'}},{explicitIdentifier:"name"})}(e),r=function({pluginManager:e,assemblyConfigSchema:t}){return we.types.snapshotProcessor(function({pluginManager:e,assemblyConfigSchema:t}){return function({pluginManager:e,assemblyConfigSchema:t}){return we.types.model("JBrowseConfig",{configuration:(0,A.ConfigurationSchema)("Root",{rpc:Le.configSchema,highResolutionScaling:{type:"number",defaultValue:2},formatDetails:(0,A.ConfigurationSchema)("FormatDetails",{feature:{type:"frozen",description:"adds extra fields to the feature details",defaultValue:{},contextVariable:["feature"]},subfeatures:{type:"frozen",description:"adds extra fields to the subfeatures of a feature",defaultValue:{},contextVariable:["feature"]},depth:{type:"number",defaultValue:2,description:"depth to iterate the formatDetails->subfeatures callback on subfeatures (used for example to only apply the callback to the first layer of subfeatures)"},maxDepth:{type:"number",defaultValue:1e4,description:"hide subfeatures greater than a certain depth"}}),formatAbout:(0,A.ConfigurationSchema)("FormatAbout",{config:{type:"frozen",description:"formats configuration object in about dialog",defaultValue:{},contextVariable:["config"]},hideUris:{type:"boolean",defaultValue:!1}}),shareURL:{type:"string",defaultValue:"https://share.jbrowse.org/api/v1/"},disableAnalytics:{type:"boolean",defaultValue:!1},hierarchical:(0,A.ConfigurationSchema)("hierarchical",{sort:(0,A.ConfigurationSchema)("hierarchicalSort",{trackNames:{type:"boolean",defaultValue:!1},categories:{type:"boolean",defaultValue:!1}}),defaultCollapsed:(0,A.ConfigurationSchema)("defaultCollapsed",{categoryNames:{type:"stringArray",defaultValue:[]},topLevelCategories:{type:"boolean",defaultValue:!1},subCategories:{type:"boolean",defaultValue:!1}})}),theme:{type:"frozen",defaultValue:{}},extraThemes:{type:"frozen",defaultValue:{}},logoPath:{type:"fileLocation",defaultValue:{uri:"",locationType:"UriLocation"}},...e.pluginConfigurationSchemas()}),plugins:we.types.array(we.types.frozen()),assemblies:we.types.array(t),tracks:we.types.array(e.pluggableConfigSchemaType("track")),internetAccounts:we.types.array(e.pluggableConfigSchemaType("internet account")),aggregateTextSearchAdapters:we.types.array(e.pluggableConfigSchemaType("text search adapter")),connections:we.types.array(e.pluggableConfigSchemaType("connection")),defaultSession:we.types.optional(we.types.frozen(),{name:"New Session"}),preConfiguredSessions:we.types.array(we.types.frozen())})}({pluginManager:e,assemblyConfigSchema:t}).views((e=>({get assemblyNames(){return e.assemblies.map((e=>(0,A.readConfObject)(e,"name")))},get rpcManager(){return(0,we.getParent)(e).rpcManager}}))).actions((e=>({addAssemblyConf(t){const{name:n}=t;if(!n)throw new Error('Can\'t add assembly with no "name"');if(e.assemblyNames.includes(n))throw new Error(`Can't add assembly with name "${n}", an assembly with that name already exists`);const o=e.assemblies.push({...t,sequence:{type:"ReferenceSequenceTrack",trackId:`${n}-${Date.now()}`,...t.sequence}});return e.assemblies[o-1]},removeAssemblyConf(t){const n=e.assemblies.find((e=>e.name===t));n&&e.assemblies.remove(n)},addTrackConf(t){const{type:n}=t;if(!n)throw new Error(`unknown track type ${n}`);const o=e.tracks.push(t);return e.tracks[o-1]},addConnectionConf(t){const{type:n}=t;if(!n)throw new Error(`unknown connection type ${n}`);const o=e.connections.push(t);return e.connections[o-1]},deleteConnectionConf(t){const n=e.connections.find((e=>e.id===t.id));return e.connections.remove(n)},deleteTrackConf(t){const n=e.tracks.find((e=>e.trackId===t.trackId));return e.tracks.remove(n)},addPlugin(t){e.plugins.push(t),(0,we.getParent)(e).setPluginsUpdated(!0)},removePlugin(t){e.plugins=(0,we.cast)(e.plugins.filter((e=>e.url!==t.url||e.umdUrl!==t.umdUrl||e.cjsUrl!==t.cjsUrl||e.esmUrl!==t.esmUrl))),(0,we.getParent)(e).setPluginsUpdated(!0)},setDefaultSessionConf(t){const n=(0,we.getParent)(e).session.name===t.name?(0,we.getSnapshot)(t):(0,ve.toJS)(t);if(!n.name)throw new Error(`unable to set default session to ${n.name}`);e.defaultSession=(0,we.cast)(n)},addInternetAccountConf(t){const{type:n}=t;if(!n)throw new Error(`unknown internetAccount type ${n}`);const o=e.internetAccounts.push(t);return e.internetAccounts[o-1]},deleteInternetAccountConf(t){const n=e.internetAccounts.find((e=>e.id===t.id));return e.internetAccounts.remove(n)}})))}({pluginManager:e,assemblyConfigSchema:t}),{postProcessor:e=>(0,Xe.K$)(structuredClone(e),"baseUri")})}({pluginManager:e,assemblyConfigSchema:o}),s=t({pluginManager:e,assemblyConfigSchema:o});return we.types.compose(function({pluginManager:e,jbrowseModelType:t,sessionModelType:n,assemblyConfigSchema:o}){return we.types.model("BaseRootModel",{jbrowse:t,session:we.types.maybe(n),sessionPath:we.types.optional(we.types.string,""),assemblyManager:we.types.optional((r=o,s=e,we.types.model({assemblies:we.types.array(ft(r,s))}).views((e=>({get assemblyNameMap(){const t={};for(const n of e.assemblies)for(const e of n.allAliases)t[e]=n;return t}}))).views((e=>({get:t=>e.assemblyNameMap[t],get assemblyNamesList(){return this.assemblyList.map((e=>e.name))},get assemblyList(){const{jbrowse:{assemblies:t},session:{sessionAssemblies:n=[],temporaryAssemblies:o=[]}={}}=(0,we.getParent)(e);return[...t,...n,...o]},get rpcManager(){return(0,we.getParent)(e).rpcManager}}))).views((e=>({async waitForAssembly(t){if(!t)throw new Error("no assembly name supplied to waitForAssembly");let n=e.get(t);if(!n)try{await(0,L.when)((()=>Boolean(e.get(t))),{timeout:1e3}),n=e.get(t)}catch(e){}if(n){if(await n.load(),await(0,L.when)((()=>!(!n.regions||!n.refNameAliases)||!!n.error)),n.error)throw n.error;return n}},async getRefNameMapForAdapter(e,t,n){if(t){const o=await this.waitForAssembly(t);return o?.getRefNameMapForAdapter(e,n)}return{}},async getReverseRefNameMapForAdapter(e,t,n){if(t){const o=await this.waitForAssembly(t);return o?.getReverseRefNameMapForAdapter(e,n)}return{}},isValidRefName(t,n){const o=e.get(n);if(o)return o.isValidRefName(t);throw new Error(`Failed to look up refName ${t} on ${n} because assembly does not exist`)}}))).actions((e=>({afterAttach(){(0,we.addDisposer)(e,(0,ve.reaction)((()=>e.assemblyList),(t=>{for(const t of e.assemblies)t.configuration||this.removeAssembly(t);for(const n of t){const t=(0,A.readConfObject)(n,"name");e.assemblies.some((e=>e.name===t))||this.addAssembly(n)}}),{fireImmediately:!0,name:"assemblyManagerAfterAttach"}))},removeAssembly(t){e.assemblies.remove(t)},addAssembly(t){e.assemblies.push({configuration:t})}})))),{})}).volatile((t=>({rpcManager:new Le(e,t.jbrowse.configuration.rpc,{MainThreadRpcDriver:{}}),adminMode:!1,error:void 0,textSearchManager:new st.A(e),pluginManager:e}))).actions((e=>({setError(t){e.error=t},setSession(t){e.session=(0,we.cast)(t)},setDefaultSession(){this.setSession(e.jbrowse.defaultSession)},setSessionPath(t){e.sessionPath=t},renameCurrentSession(t){e.session&&this.setSession({...(0,we.getSnapshot)(e.session),name:t})}})));var r,s}({pluginManager:e,jbrowseModelType:r,sessionModelType:s,assemblyConfigSchema:o}),function(e){return we.types.model({internetAccounts:we.types.array(e.pluggableMstType("internet account","stateModel"))}).actions((t=>({initializeInternetAccount(n,o={}){if(!e.getInternetAccountType(n.type))throw new Error(`unknown internet account type ${n.type}`);const r=t.internetAccounts.push({...o,type:n.type,configuration:n});return t.internetAccounts[r-1]},createEphemeralInternetAccount(n,o,r){let s;try{s=new URL(r).origin}catch(e){}const a=n.split("-"),i={type:a[0],internetAccountId:n,name:a.slice(1).join("-"),description:"",domains:s?[s]:[]},l=e.getInternetAccountType(i.type).stateModel.create({...o,type:i.type,configuration:i});return t.internetAccounts.push(l),l},findAppropriateInternetAccount(e){const n=e.internetAccountId;if(n){const e=t.internetAccounts.find((e=>e.internetAccountId===n));if(e)return e}for(const n of t.internetAccounts)if(n.handlesLocation(e))return n;return n?this.createEphemeralInternetAccount(n,{},e.uri):null}}))).actions((e=>({afterCreate(){(0,we.addDisposer)(e,(0,ve.autorun)((()=>{const{jbrowse:t}=e;t.internetAccounts.forEach(e.initializeInternetAccount)})))}})))}(e),we.types.model({history:we.types.optional(be,{targetPath:"../session"})}).actions((e=>({afterCreate(){document.addEventListener("keydown",(t=>{e.history.canRedo&&((t.ctrlKey||t.metaKey)&&t.shiftKey&&"KeyZ"===t.code||t.ctrlKey&&!t.shiftKey&&"KeyY"===t.code)&&"INPUT"!==document.activeElement?.tagName.toUpperCase()&&e.history.redo(),e.history.canUndo&&(t.ctrlKey||t.metaKey)&&!t.shiftKey&&"KeyZ"===t.code&&"INPUT"!==document.activeElement?.tagName.toUpperCase()&&e.history.undo()})),(0,we.addDisposer)(e,(0,ve.autorun)((()=>{const{session:t}=e;t&&e.history.initialize()})))}}))),we.types.model({}).volatile((()=>({mutableMenuActions:[]}))).actions((e=>({setMenus(t){e.mutableMenuActions=[...e.mutableMenuActions,{type:"setMenus",newMenus:t}]},appendMenu(t){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendMenu",menuName:t}]},insertMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"insertMenu",menuName:t,position:n}]},appendToMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendToMenu",menuName:t,menuItem:n}]},insertInMenu(t,n,o){e.mutableMenuActions.push({type:"insertInMenu",menuName:t,menuItem:n,position:o})},appendToSubMenu(t,n){e.mutableMenuActions=[...e.mutableMenuActions,{type:"appendToSubMenu",menuPath:t,menuItem:n}]},insertInSubMenu(t,n,o){e.mutableMenuActions=[...e.mutableMenuActions,{type:"insertInSubMenu",menuPath:t,menuItem:n,position:o}]}})))).props({configPath:we.types.maybe(we.types.string)}).volatile((t=>({adminMode:n,sessionDB:void 0,version:"2.18.0",hydrateFn:Nt.c,createRootFn:Nt.H,pluginsUpdated:!1,rpcManager:new Le(e,t.jbrowse.configuration.rpc,{WebWorkerRpcDriver:{makeWorkerInstance:xt},MainThreadRpcDriver:{}}),savedSessionMetadata:void 0,textSearchManager:new st.A(e),error:void 0}))).actions((e=>({setSavedSessionMetadata(t){e.savedSessionMetadata=t},async fetchSessionMetadata(){if(e.sessionDB){const t=await e.sessionDB.getAll("metadata");this.setSavedSessionMetadata(t.filter((t=>t.configPath===(e.configPath||""))).sort(((e,t)=>+t.createdAt-+e.createdAt)))}},setSessionDB(t){e.sessionDB=t}}))).actions((e=>({afterCreate(){(async()=>{try{const t=await(0,It.P2)("sessionsDB",2,{upgrade(e){e.createObjectStore("metadata"),e.createObjectStore("sessions")}});e.setSessionDB(t),(0,we.addDisposer)(e,(0,ve.autorun)((async()=>{if(e.session)try{const n=e.session;if(e.sessionDB){await t.put("sessions",(0,we.getSnapshot)(n),n.id);const o=await e.sessionDB.get("metadata",n.id);await t.put("metadata",{...o,favorite:o?.favorite||!1,name:n.name,id:n.id,createdAt:new Date,configPath:e.configPath||""},n.id)}await e.fetchSessionMetadata()}catch(t){console.error(t),e.session?.notifyError(`${t}`,t)}}),{delay:400}))}catch(t){console.error(t),e.session?.notifyError(`${t}`,t)}(0,we.addDisposer)(e,(0,ve.autorun)((async()=>{e.session&&(sessionStorage.setItem("current",JSON.stringify({session:(0,we.getSnapshot)(e.session),createdAt:new Date})),e.pluginsUpdated&&window.location.reload())}),{delay:400}))})()},setSession(t){const n=e.session;if(e.session=(0,we.cast)(t),e.session)try{(0,Xe.pK)(e.session,(0,we.getType)(e.session))}catch(t){throw e.session=n,t}},setPluginsUpdated(t){e.pluginsUpdated=t},setDefaultSession(){const{defaultSession:t}=e.jbrowse;this.setSession({...t,name:`${t.name} ${(new Date).toLocaleString()}`})},async activateSession(t){const n=await(e.sessionDB?.get("sessions",t));n?this.setSession(n):e.session.notifyError("Session not found")},async favoriteSavedSession(t){if(e.sessionDB){const n=e.savedSessionMetadata.find((e=>e.id===t));n&&(await e.sessionDB.put("metadata",{...n,favorite:!0},n.id),await e.fetchSessionMetadata())}},async unfavoriteSavedSession(t){if(e.sessionDB){const n=e.savedSessionMetadata.find((e=>e.id===t));n&&await e.sessionDB.put("metadata",{...n,favorite:!1},n.id),await e.fetchSessionMetadata()}},async deleteSavedSession(t){e.sessionDB&&(await e.sessionDB.delete("metadata",t),await e.sessionDB.delete("sessions",t),await e.fetchSessionMetadata())},renameCurrentSession(t){this.setSession({...(0,we.getSnapshot)(e.session),name:t})},setError(t){e.error=t}}))).views((e=>({menus(){const t=(0,A.readConfObject)(e.jbrowse,"preConfiguredSessions"),o=e.savedSessionMetadata?.filter((e=>e.favorite)).slice(0,5),r=e.savedSessionMetadata?.filter((e=>!e.favorite)).slice(0,5);return function(e,t){for(const n of t)"setMenus"===n.type?e=n.newMenus:"appendMenu"===n.type?je({menus:e,...n}):"insertMenu"===n.type?$e({menus:e,...n}):"insertInSubMenu"===n.type?Ue({menus:e,...n}):"appendToSubMenu"===n.type?Ve({menus:e,...n}):"appendToMenu"===n.type?ze({menus:e,...n}):"insertInMenu"===n.type&&We({menus:e,...n});return e}([{label:"File",menuItems:[{label:"New session",icon:q.A,onClick:()=>{e.setDefaultSession()}},{label:"Import session...",icon:Ct.A,onClick:e=>{const t=e.addWidget("ImportSessionWidget","importSessionWidget");e.showWidget(t)}},{label:"Export session",icon:vt.A,onClick:e=>{(0,Pt.saveAs)(new Blob([JSON.stringify({session:(0,we.getSnapshot)(e)},null,2)],{type:"text/plain;charset=utf-8"}),"session.json")}},{label:"Duplicate session",icon:wt.A,onClick:()=>{const{id:t,...n}=(0,we.getSnapshot)(e.session);e.setSession(n)}},...t?.length?[{label:"Pre-configured sessions...",subMenu:t.map((t=>({label:t.name,onClick:()=>{e.setSession(t)}})))}]:[],...o?.length?[{label:"Favorite sessions...",subMenu:[...o.slice(0,5).map((t=>({label:`${t.name} (${t.id===e.session.id?"current":(0,Tt.m)(t.createdAt,{addSuffix:!0})})`,disabled:t.id===e.session.id,icon:Et.A,onClick:()=>{(async()=>{try{await e.activateSession(t.id)}catch(t){e.session.notifyError(`${t}`,t)}})()}}))),{label:"More...",icon:bt.A,onClick:e=>{const t=e.addWidget("SessionManager","sessionManager");e.showWidget(t)}}]}]:[],{label:"Recent sessions...",type:"subMenu",subMenu:r?.length?[...r.map((t=>({label:`${t.name} (${t.id===e.session.id?"current":(0,Tt.m)(t.createdAt,{addSuffix:!0})})`,disabled:t.id===e.session.id,onClick:()=>{(async()=>{try{await e.activateSession(t.id)}catch(t){e.session.notifyError(`${t}`,t)}})()}}))),{label:"More...",icon:bt.A,onClick:e=>{const t=e.addWidget("SessionManager","sessionManager");e.showWidget(t)}}]:[{label:"No autosaves found",onClick:()=>{}}]},{type:"divider"},{label:"Open track...",icon:kt.A,onClick:e=>{if(0===e.views.length)e.notify("Please open a view to add a track first");else if(e.views.length>0){const t=e.addWidget("AddTrackWidget","addTrackWidget",{view:e.views[0].id});e.showWidget(t),e.views.length>1&&e.notify("This will add a track to the first view. Note: if you want to open a track in a specific view open the track selector for that view and use the add track (plus icon) in the bottom right")}}},{label:"Open connection...",icon:at.A8,onClick:e=>{e.showWidget(e.addWidget("AddConnectionWidget","addConnectionWidget"))}},{type:"divider"},{label:"Return to splash screen",icon:ht.A,onClick:()=>{e.setSession(void 0)}}]},...n?[{label:"Admin",menuItems:[{label:"Set default session",onClick:()=>{e.session.queueDialog((t=>[Rt,{rootModel:e,onClose:t}]))}}]}]:[],{label:"Add",menuItems:[]},{label:"Tools",menuItems:[{label:"Undo",icon:Mt.A,onClick:()=>{e.history.canUndo&&e.history.undo()}},{label:"Redo",icon:At.A,onClick:()=>{e.history.canRedo&&e.history.redo()}},{type:"divider"},{label:"Plugin store",icon:yt.A,onClick:()=>{e.session&&e.session.showWidget(e.session.addWidget("PluginStoreWidget","pluginStoreWidget"))}},{label:"Assembly manager",icon:at.uB,onClick:()=>{e.session.queueDialog((t=>[it.m,{onClose:t,session:e.session,rootModel:e}]))}},{label:"Preferences",icon:St.A,onClick:()=>{e.session&&e.session.queueDialog((t=>[Dt,{session:e.session,handleClose:t}]))}}]}],e.mutableMenuActions)}})))}var Lt=n(71627);const jt=(0,o.lazy)((()=>Promise.all([n.e(1631),n.e(4630)]).then(n.bind(n,74630))));function $t(e){return we.types.model("ReferenceManagementSessionMixin",{}).views((e=>({getReferring(t){const n=[];return(0,we.walk)((0,we.getParent)(e),(e=>{if((0,we.isModelType)((0,we.getType)(e))){const o=(0,we.getMembers)(e);Object.entries(o.properties).forEach((([o,r])=>{(0,we.isReferenceType)(r)&&e[o]===t&&n.push({node:e,key:o})}))}})),n}}))).actions((e=>({removeReferring(t,n,o,r){t.forEach((({node:t})=>{let s=!1;try{const e="open track(s)",a=(0,L.getContainingView)(t);o.push((()=>{a.hideTrack(n.trackId)})),s=!0,r[e]||(r[e]=0),r[e]+=1}catch(e){}if((0,L.isSessionModelWithWidgets)(e)&&e.widgets.has(t.id)){const n="configuration editor widget(s)";(0,L.isSessionModelWithWidgets)(e)&&o.push((()=>{e.hideWidget(t)})),s=!0,r[n]||(r[n]=0),r[n]+=1}if(!s)throw new Error(`Error when closing this connection, the following node is still referring to a track configuration: ${JSON.stringify((0,we.getSnapshot)(t))}`)}))}})))}function zt(e){const t=e.pluggableMstType("widget","stateModel");return we.types.model({drawerPosition:we.types.optional(we.types.string,(()=>(0,L.localStorageGetItem)("drawerPosition")||"right")),drawerWidth:we.types.optional(we.types.refinement(we.types.integer,(e=>e>=128)),384),widgets:we.types.map(t),activeWidgets:we.types.map(we.types.safeReference(t)),minimized:we.types.optional(we.types.boolean,!1)}).views((e=>({get visibleWidget(){if((0,we.isAlive)(e))return[...e.activeWidgets.values()][e.activeWidgets.size-1]}}))).actions((t=>({setDrawerPosition(e){t.drawerPosition=e,localStorage.setItem("drawerPosition",e)},updateDrawerWidth(e){if(e===t.drawerWidth)return t.drawerWidth;let n=e;return n<128&&(n=128),t.drawerWidth=n,n},resizeDrawer(e){"left"===t.drawerPosition&&(e*=-1);const n=t.drawerWidth;return n-this.updateDrawerWidth(n-e)},addWidget(n,o,r={},s){if(!e.getElementType("widget",n))throw new Error(`unknown widget type ${n}`);const a={...r,id:o,type:n,configuration:s||{type:n}};return t.widgets.set(o,a),t.widgets.get(o)},showWidget(e){t.activeWidgets.has(e.id)&&t.activeWidgets.delete(e.id),t.activeWidgets.set(e.id,e),t.minimized=!1},hasWidget:e=>t.activeWidgets.has(e.id),hideWidget(e){t.activeWidgets.delete(e.id)},minimizeWidgetDrawer(){t.minimized=!0},showWidgetDrawer(){t.minimized=!1},hideAllWidgets(){t.activeWidgets.clear()},editConfiguration(e){if(!(0,A.isConfigurationModel)(e))throw new Error("must pass a configuration model to editConfiguration");const t=this.addWidget("ConfigurationEditorWidget","configEditor",{target:e});this.showWidget(t)},afterAttach(){(0,we.addDisposer)(t,(0,ve.autorun)((()=>{(0,L.localStorageSetItem)("drawerPosition",t.drawerPosition)})))}})))}var Wt=n(45858);var Vt=n(25762),Ut=n(36993),Ft=n(49204);const Bt=(0,o.lazy)((()=>Promise.all([n.e(8565),n.e(8237),n.e(3011),n.e(6157),n.e(1081),n.e(965)]).then(n.bind(n,40965))));function Ht({pluginManager:e,assemblyConfigSchema:t}){const n=we.types.compose("WebCoreSessionModel",we.types.compose("WebCoreSessionModelGroupA",$t(),zt(e),we.types.model("DialogQueueSessionMixin",{}).volatile((()=>({queueOfDialogs:[]}))).views((e=>({get DialogComponent(){return e.queueOfDialogs[0]?.[0]},get DialogProps(){return e.queueOfDialogs[0]?.[1]}}))).actions((e=>({removeActiveDialog(){e.queueOfDialogs=e.queueOfDialogs.slice(1)},queueDialog(t){const[n,o]=t((()=>{this.removeActiveDialog()}));e.queueOfDialogs=[...e.queueOfDialogs,[n,o]]}}))),we.types.model({}).volatile((()=>({sessionThemeName:(0,L.localStorageGetItem)("themeName")||"default"}))).views((e=>({allThemes(){const t=e,n=(0,A.getConf)(t.jbrowse,"extraThemes");return{...r.defaultThemes,...n}},get themeName(){const{sessionThemeName:t}=e;return this.allThemes()[t]?t:"default"},get theme(){const t=e,n=(0,A.getConf)(t.jbrowse,"theme"),o=this.allThemes();return(0,r.createJBrowseTheme)(n,o,this.themeName)}}))).actions((e=>({setThemeName(t){e.sessionThemeName=t},afterAttach(){(0,we.addDisposer)(e,(0,ve.autorun)((()=>{(0,L.localStorageSetItem)("themeName",e.themeName)})))}}))),function(e){return we.types.compose((0,Wt.DH)(e),zt(e)).props({views:we.types.array(e.pluggableMstType("view","stateModel"))}).actions((t=>({moveViewDown(e){const n=t.views.findIndex((t=>t.id===e));-1!==n&&n<t.views.length-1&&t.views.splice(n,2,t.views[n+1],t.views[n])},moveViewUp(e){const n=t.views.findIndex((t=>t.id===e));n>0&&t.views.splice(n-1,2,t.views[n],t.views[n-1])},moveViewToTop(e){const n=t.views.findIndex((t=>t.id===e));t.views=(0,we.cast)([t.views[n],...t.views.filter((t=>t.id!==e))])},moveViewToBottom(e){const n=t.views.findIndex((t=>t.id===e));t.views=(0,we.cast)([...t.views.filter((t=>t.id!==e)),t.views[n]])},addView(n,o={}){if(!e.getElementType("view",n))throw new Error(`unknown view type ${n}`);const r=t.views.push({...o,type:n});return t.views[r-1]},removeView(e){for(const[,n]of t.activeWidgets)n.view&&n.view.id===e.id&&t.hideWidget(n);t.views.remove(e)},addLinearGenomeViewOfAssembly(e,t={}){return this.addViewOfAssembly("LinearGenomeView",e,t)},addViewOfAssembly(e,n,o={}){const r=t.assemblies.find((e=>(0,A.readConfObject)(e,"name")===n));if(!r)throw new Error(`Could not add view of assembly "${n}", assembly name not found`);return this.addView(e,{...o,displayRegionsFromAssemblyName:(0,A.readConfObject)(r,"name")})},addViewFromAnotherView(e,t,n={}){const o={...n};return o.displayedRegions=(0,we.getSnapshot)(t.displayedRegions),this.addView(e,o)}})))}(e)),we.types.compose("WebCoreSessionModelGroupB",function(e){return function(e){return we.types.compose("TracksManagerSessionMixin",(0,Wt.DH)(e),$t()).views((e=>({get tracks(){return e.jbrowse.tracks}}))).actions((e=>({addTrackConf:t=>e.jbrowse.addTrackConf(t),deleteTrackConf(t){const n=[],o=e.getReferring(t);if(e.removeReferring(o,t,n,{}),n.forEach((e=>{e()})),e.adminMode)return e.jbrowse.deleteTrackConf(t)}})))}(e).named("SessionTracksManagerSessionMixin").props({sessionTracks:we.types.array(e.pluggableConfigSchemaType("track"))}).views((e=>({get tracks(){return[...e.sessionTracks,...e.jbrowse.tracks]}}))).actions((e=>{const{addTrackConf:t,deleteTrackConf:n}=e;return{addTrackConf(n){if(e.adminMode)return t(n);const{trackId:o,type:r}=n;if(!r)throw new Error(`unknown track type ${r}`);const s=e.sessionTracks.find((e=>e.trackId===o));if(s)return s;const a=e.sessionTracks.push(n);return e.sessionTracks[a-1]},deleteTrackConf(t){const o=n(t);if(o)return o;const{trackId:r}=t,s=e.sessionTracks.findIndex((e=>e.trackId===r));return-1!==s?e.sessionTracks.splice(s,1):void 0}}}))}(e),(s=t,we.types.model({sessionAssemblies:we.types.array(s)}).actions((e=>{const t=e;return{addSessionAssembly(e){const n=t.sessionAssemblies.find((t=>t.name===e.name));if(n)return console.warn(`Assembly ${e.name} already exists`),n;const o=t.sessionAssemblies.push(e);return t.sessionAssemblies[o-1]},addAssembly(e){t.adminMode?t.jbrowse.addAssemblyConf(e):this.addSessionAssembly(e)},removeAssembly(e){t.adminMode?t.jbrowse.removeAssemblyConf(e):this.removeSessionAssembly(e)},removeSessionAssembly(e){const n=t.sessionAssemblies.find((t=>t.name===e));n&&t.sessionAssemblies.remove(n)}}}))),function(e,t=we.types.frozen()){return we.types.model({temporaryAssemblies:we.types.array(t)}).actions((e=>{const t=e;return{addTemporaryAssembly(e){const n=t.temporaryAssemblies.find((t=>t.name===e.name));if(n)return console.warn(`Assembly ${e.name} was already existing`),n;const o=t.temporaryAssemblies.push(e);return t.temporaryAssemblies[o-1]},removeTemporaryAssembly(e){const n=t.temporaryAssemblies.find((t=>t.name===e));n&&t.temporaryAssemblies.remove(n)}}}))}(0,t),function(e){return we.types.compose("SessionConnectionsManagement",(0,Ft.F)(e),we.types.model({sessionConnections:we.types.array(e.pluggableConfigSchemaType("connection"))})).actions((e=>{const t=e,n=t.deleteConnection,o=t.addConnectionConf;return{addConnectionConf(e){if(t.adminMode)return o(e);const{connectionId:n,type:r}=e;if(!r)throw new Error(`unknown connection type ${r}`);const s=t.sessionTracks.find((e=>e.connectionId===n));if(s)return s;const a=t.sessionConnections.push(e);return t.sessionConnections[a-1]},deleteConnection(e){let o;if(t.adminMode&&(o=n(e)),!o){const{connectionId:n}=e,o=t.sessionConnections.findIndex((e=>e.connectionId===n));if(-1===o)return;return t.sessionConnections.splice(o,1)}return o}}}))}(e),we.types.model({focusedViewId:we.types.maybe(we.types.string)}).actions((e=>({setFocusedViewId(t){e.focusedViewId=t}}))),we.types.model({}).volatile((()=>({snackbarMessages:ve.observable.array()}))).views((e=>({get snackbarMessageSet(){return new Map(e.snackbarMessages.map((e=>[e.message,e])))}}))).actions((e=>({notify(e,t,n){this.pushSnackbarMessage(e,t,n),"info"!==t&&"success"!==t||setTimeout((()=>{this.removeSnackbarMessage(e)}),5e3)},notifyError(t,n,r){this.notify(t,"error",{name:o.createElement(Lt.A,null),onClick:()=>{e.queueDialog((e=>[jt,{onClose:e,error:n,extra:r}]))}})},pushSnackbarMessage(t,n,o){!o&&e.snackbarMessageSet.has(t)||e.snackbarMessages.push({message:t,level:n,action:o})},popSnackbarMessage:()=>e.snackbarMessages.pop(),removeSnackbarMessage(t){const n=e.snackbarMessageSet.get(t);void 0!==n&&e.snackbarMessages.remove(n)}}))))).props({margin:0,sessionPlugins:we.types.array(we.types.frozen())}).volatile((()=>({sessionThemeName:(0,L.localStorageGetItem)("themeName")||"default",task:void 0}))).views((e=>({get tracks(){return[...e.sessionTracks,...e.jbrowse.tracks]},get root(){return(0,we.getParent)(e)},get assemblies(){return[...e.jbrowse.assemblies,...e.sessionAssemblies]},get connections(){return[...e.jbrowse.connections,...e.sessionConnections]}}))).actions((e=>({setName(t){e.name=t}}))).views((e=>({get assemblyNames(){return e.assemblies.map((e=>(0,A.readConfObject)(e,"name")))},get version(){return e.root.version},get shareURL(){return(0,A.getConf)(e.jbrowse,"shareURL")},get textSearchManager(){return e.root.textSearchManager},get assemblyManager(){return e.root.assemblyManager},get savedSessionMetadata(){return e.root.savedSessionMetadata},get previousAutosaveId(){return e.root.previousAutosaveId},get history(){return e.root.history},renderProps:()=>({theme:e.theme,highResolutionScaling:(0,A.getConf)(e,"highResolutionScaling")})}))).actions((e=>({addAssemblyConf(t){e.jbrowse.addAssemblyConf(t)},addSessionPlugin(t){if(e.sessionPlugins.some((e=>e.name===t.name)))throw new Error("session plugin cannot be installed twice");e.sessionPlugins.push(t),e.root.setPluginsUpdated(!0)},removeSessionPlugin(t){e.sessionPlugins=(0,we.cast)(e.sessionPlugins.filter((e=>e.url!==t.url||e.umdUrl!==t.umdUrl||e.cjsUrl!==t.cjsUrl||e.esmUrl!==t.esmUrl))),(0,we.getParent)(e).setPluginsUpdated(!0)},addSavedSession:t=>e.root.addSavedSession(t),deleteSavedSession:t=>e.root.deleteSavedSession(t),favoriteSavedSession:t=>e.root.favoriteSavedSession(t),unfavoriteSavedSession:t=>e.root.unfavoriteSavedSession(t),renameCurrentSession:t=>e.root.renameCurrentSession(t),duplicateCurrentSession:()=>e.root.duplicateCurrentSession(),activateSession:t=>e.root.activateSession(t),setDefaultSession:()=>e.root.setDefaultSession(),saveSessionToLocalStorage:()=>e.root.saveSessionToLocalStorage(),loadAutosaveSession:()=>e.root.loadAutosaveSession(),setSession:t=>e.root.setSession(t)}))).actions((e=>({editTrackConfiguration(t){const{adminMode:n,sessionTracks:o}=e;if(!n&&!o.includes(t))throw new Error("Can't edit the configuration of a non-session track");e.editConfiguration(t)}}))).views((e=>({getTrackActionMenuItems(t){const{adminMode:n,sessionTracks:o}=e,r=n||o.find((e=>e.trackId===t.trackId)),s="ReferenceSequenceTrack"===t.type;return[{label:"About track",priority:1002,onClick:()=>{e.queueDialog((e=>[Bt,{config:t,handleClose:e}]))},icon:Ut.A},{label:"Settings",priority:1001,disabled:!r,icon:St.A,onClick:()=>{e.editTrackConfiguration(t)}},{label:"Delete track",priority:1e3,disabled:!r||s,icon:Vt.A,onClick:()=>{e.deleteTrackConf(t)}},{label:"Copy track",priority:999,disabled:s,onClick:()=>{const n=structuredClone((0,we.getSnapshot)(t)),o=Date.now();n.trackId+=`-${o}`,n.displays.forEach((e=>{e.displayId+=`-${o}`})),e.adminMode||(n.trackId+="-sessionTrack",n.category=void 0),n.name+=" (copy)",e.addTrackConf(n)},icon:wt.A}]},menus:()=>e.root.menus()}))).actions((e=>({afterAttach(){(0,we.addDisposer)(e,(0,ve.autorun)((()=>{(0,L.localStorageSetItem)("drawerPosition",e.drawerPosition),(0,L.localStorageSetItem)("themeName",e.themeName)})))}})));var s;const a=e.evaluateExtensionPoint("Core-extendSession",n);return we.types.snapshotProcessor(a,{preProcessor(e){const{connectionInstances:t,...n}=e||{};return Array.isArray(t)?e:n}})}function Gt({pluginManager:e,assemblyConfigSchema:t}){return Ht({pluginManager:e,assemblyConfigSchema:t})}function qt(e){const t=new ot.A([...rt.A.map((e=>({plugin:new e,metadata:{isCore:!0}}))),...e.runtimePlugins.map((({plugin:e,definition:t})=>({plugin:new e,definition:t,metadata:{url:t.url}}))),...e.sessionPlugins.map((({plugin:e,definition:t})=>({plugin:new e,definition:t,metadata:{url:t.url}})))]);t.createPluggableElements();const n=Ot({pluginManager:t,sessionModelFactory:Gt,adminMode:!!e.adminKey});if(!e.configSnapshot)return;const o=n.create({jbrowse:e.configSnapshot,configPath:e.configPath},{pluginManager:t});e.configSnapshot.configuration?.rpc?.defaultDriver||o.jbrowse.configuration.rpc.defaultDriver.set("WebWorkerRpcDriver");let r=()=>{};try{if(e.sessionError)throw e.sessionError;e.sessionSnapshot?o.setSession(e.sessionSnapshot):e.sessionSpec?r=function({views:e,sessionTracks:t=[]},n){return async()=>{const{rootModel:o}=n;if(!o)throw new Error("rootModel not initialized");try{o.setSession({name:`New session ${(new Date).toLocaleString()}`}),t.forEach((e=>o.session.addTrackConf(e))),await Promise.all(e.map((e=>n.evaluateAsyncExtensionPoint(`LaunchView-${e.type}`,{...e,session:o.session}))))}catch(e){console.error(e),o.session?.notify(`${e}`)}}}(e.sessionSpec,t):o.jbrowse.defaultSession?.views?.length&&o.setDefaultSession()}catch(t){o.setDefaultSession();const n=`${t}`.replace("[mobx-state-tree] ","").replace(/\(.+/,""),r=n.length>1e3?`${n.slice(0,1e3)}...see more in console`:n,s=r.startsWith("Error:")?r:`Error: ${r}`;o.session?.notifyError(`${s}. If you received this URL from another user, request that they send you a session generated with the "Share" button instead of copying and pasting their URL`,e.sessionError,e.sessionSnapshot),console.error(t)}return function(e,t,n){e&&!(0,A.readConfObject)(e.jbrowse.configuration,"disableAnalytics")&&(async function(e,t,n){try{const o="https://analytics.jbrowse.org/api/v1",r=e.jbrowse.tracks.filter((e=>((0,A.readConfObject)(e,"assemblyNames")||[]).length>1)).length,s=Object.keys(localStorage).filter((e=>e.includes("localSaved-"))).length,{jbrowse:a,session:i,version:l}=e,{tracks:c,assemblies:u,plugins:d}=a,m={ver:l,"plugins-count":d?.length||0,"plugin-names":d?.map((e=>e.name)).join(","),"assemblies-count":u.length,"tracks-count":c.length,"session-tracks-count":i?.sessionTracks.length||0,"open-views":i?.views.length||0,"synteny-tracks-count":r,"saved-sessions-count":s,"existing-session-param-type":n?.split("-")[0]||"none","scn-h":window.screen.height,"scn-w":window.screen.width,"win-h":window.innerHeight,"win-w":window.innerWidth,electron:L.isElectron,loadTime:(Date.now()-t)/1e3,jb2:!0};c.forEach((e=>{const t=`track-types-${e.type}`;m[t]=m[t]+1||1})),i?.sessionTracks.forEach((e=>{const t=`sessionTrack-types-${e.type}`;m[t]=m[t]+1||1}));const p=Object.keys(m).map((e=>`${e}=${m[e]}`)).join("&");await fetch(`${o}?${p}`)}catch(e){console.error("Failed to write analytics to AWS.",e)}}(e,t,n),async function(e,t){const n={"tracks-count":e.jbrowse.tracks.length,ver:e.version,electron:L.isElectron,loadTime:Date.now()-t,pluginNames:e.jbrowse.plugins?.map((e=>e.name))||""};let o="(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){";o+="(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),",o+="m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)",o+="})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');",o+="ga('create', 'UA-7115575-5', 'auto', 'jbrowseTracker');";const r={};"tracks-count ver electron loadTime pluginNames".split(/\s+/).forEach(((e,t)=>{r[`dimension${t+1}`]=n[e]})),r.metric1=Math.round(n.loadTime),o+=`ga('jbrowseTracker.send', 'pageview',${JSON.stringify(r)});`;const s=document.createElement("script");s.innerHTML=o,document.getElementsByTagName("head")[0].append(s)}(e,t))}(o,e.initialTimestamp,e.sessionQuery),t.setRootModel(o),t.configure(),r(),t}function _t(){return _t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)({}).hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_t.apply(null,arguments)}const Jt=(0,o.lazy)((()=>n.e(3116).then(n.bind(n,93116)))),Qt=(0,o.lazy)((()=>n.e(7564).then(n.bind(n,7564)))),Kt=(0,o.lazy)((()=>n.e(4246).then(n.bind(n,84246))));function Zt(e){return null===e?void 0:e}function Yt({initialTimestamp:e=Date.now()}){const t=i.StringParam,[n]=(0,i.useQueryParam)("config",t),[r]=(0,i.useQueryParam)("session",t),[s]=(0,i.useQueryParam)("adminKey",t),[a,l]=(0,i.useQueryParam)("password",t),[c,u]=(0,i.useQueryParam)("loc",t),[d,m]=(0,i.useQueryParam)("sessionTracks",t),[p,f]=(0,i.useQueryParam)("assembly",t),[g,h]=(0,i.useQueryParam)("tracks",t),[y,w]=(0,i.useQueryParam)("highlight",t),[b,v]=(0,i.useQueryParam)("nav",t),[C,A]=(0,i.useQueryParam)("tracklist",t),S=et.create({configPath:Zt(n),sessionQuery:Zt(r),password:Zt(a),adminKey:Zt(s),loc:Zt(c),assembly:Zt(p),tracks:Zt(g),sessionTracks:Zt(d),tracklist:JSON.parse(Zt(C)||"false"),highlight:Zt(y),nav:JSON.parse(Zt(b)||"true"),initialTimestamp:e});return(0,o.useEffect)((()=>{u(void 0,"replaceIn"),h(void 0,"replaceIn"),f(void 0,"replaceIn"),l(void 0,"replaceIn"),m(void 0,"replaceIn"),A(void 0,"replaceIn"),v(void 0,"replaceIn"),w(void 0,"replaceIn")}),[f,u,v,A,h,l,m,w]),o.createElement(tn,{loader:S})}const Xt=(0,a.observer)((function({sessionTriaged:e,loader:t}){return o.createElement(o.Suspense,{fallback:null},"session"===e.origin?o.createElement(Qt,{loader:t,handleClose:()=>{t.setSessionTriaged(void 0)}}):o.createElement(Jt,{loader:t,handleClose:()=>{t.setSessionTriaged(void 0)}}))})),en=(0,a.observer)((function({pluginManager:e}){const{rootModel:t}=e;return t?.session?o.createElement(Je,{pluginManager:e}):o.createElement(o.Suspense,{fallback:o.createElement(r.LoadingEllipses,null)},o.createElement(Kt,{rootModel:t,onFactoryReset:tt.A}))})),tn=(0,a.observer)((function({loader:e}){const{configError:t,ready:n,sessionTriaged:r}=e,[s,a]=(0,o.useState)(),[i,l]=(0,o.useState)();(0,o.useEffect)((()=>{let t;try{if(!n)return;t=qt(e),a(t)}catch(e){console.error(e),l(e)}}),[e,n]);const c=t||i;return c?o.createElement(nt,{error:c}):r?o.createElement(Xt,{loader:e,sessionTriaged:r}):s?o.createElement(en,{pluginManager:s}):o.createElement(Qe.A,null)})),nn=function({initialTimestamp:e}){return o.createElement(s.t,{FallbackComponent:e=>o.createElement(r.FatalErrorDialog,_t({},e,{resetButtonText:"Reset Session",onFactoryReset:tt.A}))},o.createElement(i.QueryParamProvider,{adapter:l.Q},o.createElement(Yt,{initialTimestamp:e})))}},55252:(e,t,n)=>{async function o(){window.location=window.location.pathname}n.d(t,{A:()=>o})},17765:(e,t,n)=>{n.d(t,{J:()=>i,Z:()=>l});var o=n(49409);const r=async(e,t)=>(await Promise.all([n.e(7753),n.e(9831),n.e(5156)]).then(n.t.bind(n,29831,23))).encrypt(e,t).toString(),s=async(e,t)=>{const o=await Promise.all([n.e(7753),n.e(9831),n.e(5156)]).then(n.t.bind(n,29831,23)),r=await Promise.all([n.e(7753),n.e(6235)]).then(n.t.bind(n,12598,23));return o.decrypt(e,t).toString(r)};function a(e){try{return JSON.parse(e).message}catch(t){return e}}async function i(e,t,n){const s=await(0,o.eW)(JSON.stringify(e)),i=window.btoa([...window.crypto.getRandomValues(new Uint8Array(10))].map((e=>String.fromCharCode(e))).join("")).replaceAll(/[+/]/g,"").slice(0,5);const l=await r(s,i),c=new FormData;c.append("session",l),c.append("dateShared",`${Date.now()}`),c.append("referer",n);const u=await fetch(`${t}share`,{method:"POST",mode:"cors",body:c});if(!u.ok){const e=await u.text();throw new Error(a(e))}return{json:await u.json(),encryptedSession:l,password:i}}async function l(e,t,n,o){const r=t.split("share-")[1],i=`${e}?sessionId=${encodeURIComponent(r)}`,l=await fetch(i,{signal:o});if(!l.ok){const e=await l.text();throw new Error(a(e))}const c=await l.json();return s(c.session,n)}},49409:(e,t,n)=>{n.d(t,{K$:()=>d,LP:()=>s,Vr:()=>c,XE:()=>l,eW:()=>a,pK:()=>i,pS:()=>u});var o=n(59773),r=n(36422);async function s(e){const t=function(e){let t=0;switch(e.length%4){case 3:t=1;break;case 2:t=2;break;case 0:t=0;break;default:throw new Error("base64 not a valid length")}return e+"=".repeat(t)}(e.replaceAll("-","+").replaceAll("_","/")),{toByteArray:o}=await Promise.resolve().then(n.t.bind(n,47130,19)),{inflate:r}=await Promise.resolve().then(n.t.bind(n,57864,23)),s=r(o(t));return new TextDecoder("utf8").decode(s)}async function a(e){const t=(new TextEncoder).encode(e),{deflate:o}=await Promise.resolve().then(n.t.bind(n,57864,23)),{fromByteArray:r}=await Promise.resolve().then(n.t.bind(n,47130,19)),s=r(o(t)),a=s.indexOf("=");return a>0?s.slice(0,a).replaceAll("+","-").replaceAll("/","_"):s.replaceAll("+","-").replaceAll("/","_")}function i(e,t){if(void 0!==e)if((0,r.isArrayType)(t)){const t=e,n=(0,r.getChildType)(e);if((0,r.isReferenceType)(n))for(let e=0;e<t.length;)(0,r.isValidReference)((()=>t[e]))?e+=1:t.splice(e,1);t.forEach((e=>{i(e,n)}))}else if((0,r.isMapType)(t)){const t=e,n=(0,r.getChildType)(t);if((0,r.isReferenceType)(n))for(const e in t.keys())(0,r.isValidReference)((()=>t.get(e)))||t.delete(e);t.forEach((e=>{i(e,n)}))}else if((0,r.isModelType)(t)){const{properties:t}=(0,r.getPropertyMembers)(e);Object.entries(t).forEach((([t,n])=>{i(e[t],n)}))}}function l(e,t){if("object"==typeof e&&null!==e)for(const n of Object.keys(e))"object"==typeof e[n]&&null!==e[n]?l(e[n],t):"uri"===n&&(e.baseUri=t.href)}function c({configuration:e},t,n){return e?.[t]||n}async function u(e){if(0===e.length)return!0;const t=await async function(){const e=await fetch("https://jbrowse.org/plugin-store/plugins.json");if(!e.ok)throw new Error(`HTTP ${e.status} ${e.statusText} fetching plugins`);return e.json()}();return e.every((e=>(0,o.rE)(e)?t.plugins.some((t=>(0,o.rE)(e)&&("url"in t&&"url"in e&&e.url===t.url||"umdUrl"in t&&"umdUrl"in e&&e.umdUrl===t.umdUrl))):(0,o.Cx)(e)?t.plugins.some((t=>(0,o.Cx)(e)&&"esmUrl"in e&&e.esmUrl===t.esmUrl)):!!(0,o.Nz)(e)&&t.plugins.some((t=>(0,o.Nz)(e)&&e.cjsUrl===t.cjsUrl))))}function d(e,t){for(const n in e)n===t?delete e[n]:"object"==typeof e[n]&&d(e[n],t);return e}}}]);
//# sourceMappingURL=7942.b28cc7a5.chunk.js.map