"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8383],{48383(e,s,t){t.r(s),t.d(s,{default:()=>J});var n=t(30128),a=t(62088),o=t(23886),i=t(46625),l=t(21988),r=t(69566),c=t(55614),d=t(1241),m=t(34823),y=t(78921),p=t(69590),b=t(72484),u=t(69301),h=t(54825),f=t(49186);function x({radioOption:e,assembly1:s,assembly2:t,fileLocation:n,indexFileLocation:a,bed1Location:o,bed2Location:i}){if(".paf"===e)return{type:"PAFAdapter",pafLocation:n,queryAssembly:s,targetAssembly:t};if(".out"===e)return{type:"MashMapAdapter",outLocation:n,queryAssembly:s,targetAssembly:t};if(".delta"===e)return{type:"DeltaAdapter",deltaLocation:n,queryAssembly:s,targetAssembly:t};if(".chain"===e)return{type:"ChainAdapter",chainLocation:n,queryAssembly:s,targetAssembly:t};if(".anchors"===e)return{type:"MCScanAnchorsAdapter",mcscanAnchorsLocation:n,bed1Location:o,bed2Location:i,assemblyNames:[s,t]};if(".anchors.simple"===e)return{type:"MCScanSimpleAnchorsAdapter",mcscanSimpleAnchorsLocation:n,bed1Location:o,bed2Location:i,assemblyNames:[s,t]};if(".pif.gz"===e)return{type:"PairwiseIndexedPAFAdapter",pifGzLocation:n,index:{location:a},assemblyNames:[s,t]};throw new Error(`Unknown to detect type ${e} from filename (select radio button to clarify)`)}var j=t(28318),g=t(30097);const w={".paf":"minimap2 target.fa query.fa",".pif.gz":"minimap2 target.fa query.fa",".out":"mashmap target.fa query.fa",".delta":"mummer target.fa query.fa",".chain":"e.g. queryToTarget.chain"};var v=t(35703),A=t(44460);const S=(0,i.n)()({row:{display:"flex",gap:20},swap:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:4,alignItems:"center"}}),L=(0,r.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:n,radioOption:a,helpContent:o,text1:i,text2:l}){const{classes:r}=S();return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{children:["Verify or click swap",(0,A.jsx)(g.A,{title:o||(0,A.jsx)("code",{children:w[a]}),children:(0,A.jsx)(j.A,{})})]}),(0,A.jsxs)("div",{className:r.row,children:[(0,A.jsxs)("div",{className:r.swap,children:[(0,A.jsx)("div",{children:(0,A.jsx)("i",{children:t?s:e})}),(0,A.jsx)("div",{children:i}),(0,A.jsx)("div",{children:(0,A.jsx)("i",{children:t?e:s})}),(0,A.jsx)("div",{children:l})]}),(0,A.jsx)(v.A,{variant:"contained",onClick:()=>{n&&n(!t)},children:"Swap?"})]})]})}),k=(0,r.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:n,fileLocation:a,setFileLocation:o,radioOption:i}){return(0,A.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,A.jsx)(b.A,{name:`${i} location`,inline:!0,description:"",location:a,setLocation:o}),(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{children:["Verify or click swap",(0,A.jsx)(g.A,{title:(0,A.jsx)("code",{children:w[i]}),children:(0,A.jsx)(j.A,{})})]}),(0,A.jsx)(L,{swap:t,radioOption:i,assembly1:e,assembly2:s,setSwap:n,text1:"query assembly",text2:"target assembly"})]})]})}),C=(0,r.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:n,fileLocation:a,setFileLocation:o,indexFileLocation:i,setIndexFileLocation:l=()=>{},radioOption:r}){return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{style:{margin:20},children:["Open the ",r," and .pif.gz and index file (.pif.gz.tbi or .pif.gz.csi) files for created by `jbrowse make-pif`"]}),(0,A.jsxs)("div",{style:{maxWidth:400,margin:"0 auto"},children:[(0,A.jsx)(b.A,{name:`${r} location`,inline:!0,description:"",location:a,setLocation:o}),(0,A.jsx)(b.A,{name:`${r} index location`,inline:!0,description:"",location:i,setLocation:l}),(0,A.jsx)(L,{swap:t,radioOption:r,assembly1:e,assembly2:s,setSwap:n,text1:"query assembly",text2:"target assembly"})]})]})}),N=(0,r.observer)(function({assembly1:e,assembly2:s,swap:t,setSwap:n,fileLocation:a,setFileLocation:o,bed1Location:i,setBed1Location:l=()=>{},bed2Location:r,setBed2Location:c=()=>{},radioOption:d}){return(0,A.jsxs)("div",{children:[(0,A.jsxs)("div",{style:{margin:20},children:["Open the ",d," and .bed files for both genome assemblies from the MCScan (Python version) pipeline"," ",(0,A.jsx)("a",{href:"https://github.com/tanghaibao/jcvi/wiki/MCscan-(Python-version)",children:"(more info)"})]}),(0,A.jsxs)("div",{style:{maxWidth:400,margin:"0 auto"},children:[(0,A.jsx)(b.A,{inline:!0,name:d,location:a,setLocation:o}),(0,A.jsx)(b.A,{inline:!0,name:"genome 1 .bed (left column of anchors file)",description:"",location:i,setLocation:l}),(0,A.jsx)(b.A,{inline:!0,name:"genome 2 .bed (right column of anchors file)",description:"",location:r,setLocation:c}),(0,A.jsx)(L,{swap:t,radioOption:d,assembly1:e,assembly2:s,setSwap:n,text1:"bed 1 assembly",text2:"bed 2 assembly"})]})]})}),F=(0,r.observer)(function({model:e,assembly1:s,assembly2:t,selectedRow:o}){const[i,l]=(0,n.useState)(!1),[r,c]=(0,n.useState)(),[d,j]=(0,n.useState)(),[g,w]=(0,n.useState)(),[v,S]=(0,n.useState)(),[L,F]=(0,n.useState)(""),[T,R]=(0,n.useState)(),I=(O=g)?O.uri||O.localPath||O.name:void 0;var O;const P=L||(I?function(e){const s=e.split(".").pop();return s?`.${s}`:""}(function(e){return e.endsWith(".gz")?e.slice(0,-3):e}(I)):"");return(0,n.useEffect)(()=>{try{if(g){const n=I?I.split("#")[0].split("?")[0].split("/").pop():"MyTrack",a=`${n}-${Date.now()}-sessionTrack`;R(void 0),e.setImportFormSyntenyTrack(o,{type:"userOpened",value:{trackId:a,name:n,assemblyNames:[t,s],type:"SyntenyTrack",adapter:x({radioOption:P,assembly1:i?t:s,assembly2:i?s:t,fileLocation:g,indexFileLocation:v,bed1Location:d,bed2Location:r})}})}}catch(e){console.error(e),R(e)}},[i,e,o,I,s,t,d,r,g,v,P]),(0,A.jsxs)(u.A,{style:{padding:12},children:[T?(0,A.jsx)(a.A,{error:T}):null,(0,A.jsx)(h.A,{style:{textAlign:"center"},children:"Add a .paf (minimap2), .delta (Mummer), .chain (UCSC liftover), .anchors or .anchors.simple (MCScan), or .pif.gz (jbrowse CLI make-pif) file to view. These file types can also be gzipped."}),(0,A.jsx)(m.A,{value:P,onChange:e=>{F(e.target.value)},children:(0,A.jsx)(f.A,{container:!0,justifyContent:"center",children:[".paf",".delta",".out",".chain",".anchors",".anchors.simple",".pif.gz"].map(e=>(0,A.jsx)(y.A,{value:e,control:(0,A.jsx)(p.A,{}),label:e},e))})}),(0,A.jsx)(f.A,{container:!0,justifyContent:"center",children:".paf"===P||".out"===P||".delta"===P||".chain"===P?(0,A.jsx)(k,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:g,setFileLocation:w,radioOption:P}):".pif.gz"===P?(0,A.jsx)(C,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:g,setFileLocation:w,indexFileLocation:v,setIndexFileLocation:S,radioOption:P}):".anchors"===L||".anchors.simple"===L?(0,A.jsx)(N,{assembly1:s,assembly2:t,swap:i,setSwap:l,fileLocation:g,setFileLocation:w,bed1Location:d,setBed1Location:j,bed2Location:r,setBed2Location:c,radioOption:L}):(0,A.jsx)(b.A,{name:L?`${L} location`:"",description:"",location:g,setLocation:e=>{w(e)}})})]})});var T=t(17378),R=t(19608),I=t(84037),O=t(79291);const P=(0,r.observer)(function({model:e,selectedRow:s,assembly1:t,assembly2:i}){const l=(0,o.getSession)(e),{importFormSyntenyTrackSelections:r}=e,{tracks:c,sessionTracks:d=[]}=l,m=[...c,...d].filter(e=>{const s=(0,T.QZ)(e,"assemblyNames");return s.includes(t)&&s.includes(i)&&e.type.includes("Synteny")}),y=m[0]?.trackId||"",p=r[s],b="preConfigured"===p?.type?p.value:void 0;return(0,n.useEffect)(()=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:y})},[i,t,y,s,e]),(0,A.jsxs)(u.A,{style:{padding:12},children:[(0,A.jsx)(h.A,{children:'Select a track from the select box below, the track will be shown when you hit "Launch".'}),b&&m.map(e=>e.trackId).includes(b)?(0,A.jsx)(I.A,{value:b,onChange:t=>{e.setImportFormSyntenyTrack(s,{type:"preConfigured",value:t.target.value})},children:m.map(e=>(0,A.jsx)(O.A,{value:e.trackId,children:(0,R.getTrackName)(e,l)},e.trackId))}):(0,A.jsx)(a.A,{error:`No synteny tracks found for ${t},${i}`})]})});function $(e){const s=(0,c.c)(45),{model:t,assembly1:a,assembly2:i,selectedRow:l}=e,{pluginManager:r}=(0,o.getEnv)(t),[b,u]=(0,n.useState)("tracklist"),h=r.evaluateExtensionPoint("LinearSyntenyView-ImportFormSyntenyOptions",[],{model:t,assembly1:a,assembly2:i,selectedRow:l});let f;s[0]!==b?(f=e=>e.value===b,s[0]=b,s[1]=f):f=s[1];const x=h.find(f);let j,g;s[2]!==b||s[3]!==t||s[4]!==l?(j=()=>{"none"!==b&&"custom"!==b||t.setImportFormSyntenyTrack(l,{type:"none"})},g=[b,t,l],s[2]=b,s[3]=t,s[4]=l,s[5]=j,s[6]=g):(j=s[5],g=s[6]),(0,n.useEffect)(j,g);const w=d.A,v=m.A;let S,L,k,C;s[7]===Symbol.for("react.memo_cache_sentinel")?(S=e=>{u(e.target.value)},s[7]=S):S=s[7],s[8]===Symbol.for("react.memo_cache_sentinel")?(L=(0,A.jsx)(y.A,{value:"none",control:(0,A.jsx)(p.A,{}),label:"None"}),s[8]=L):L=s[8],s[9]===Symbol.for("react.memo_cache_sentinel")?(k=(0,A.jsx)(y.A,{value:"tracklist",control:(0,A.jsx)(p.A,{}),label:"Existing track"}),s[9]=k):k=s[9],s[10]===Symbol.for("react.memo_cache_sentinel")?(C=(0,A.jsx)(y.A,{value:"custom",control:(0,A.jsx)(p.A,{}),label:"New track"}),s[10]=C):C=s[10];const N=h.map(_);let T,R,I,O,$,q;return s[11]!==v||s[12]!==b||s[13]!==N||s[14]!==S||s[15]!==L||s[16]!==k||s[17]!==C?(T=(0,A.jsxs)(v,{row:!0,value:b,"aria-labelledby":"group-label",onChange:S,children:[L,k,C,N]}),s[11]=v,s[12]=b,s[13]=N,s[14]=S,s[15]=L,s[16]=k,s[17]=C,s[18]=T):T=s[18],s[19]!==w||s[20]!==T?(R=(0,A.jsx)(w,{children:T}),s[19]=w,s[20]=T,s[21]=R):R=s[21],s[22]!==a||s[23]!==i||s[24]!==b||s[25]!==t||s[26]!==l?(I="custom"===b?(0,A.jsx)(F,{model:t,selectedRow:l,assembly2:i,assembly1:a}):null,s[22]=a,s[23]=i,s[24]=b,s[25]=t,s[26]=l,s[27]=I):I=s[27],s[28]!==a||s[29]!==i||s[30]!==b||s[31]!==t||s[32]!==l?(O="tracklist"===b?(0,A.jsx)(P,{model:t,selectedRow:l,assembly1:a,assembly2:i}):null,s[28]=a,s[29]=i,s[30]=b,s[31]=t,s[32]=l,s[33]=O):O=s[33],s[34]!==a||s[35]!==i||s[36]!==t||s[37]!==x||s[38]!==l?($=x?(0,A.jsx)(x.ReactComponent,{model:t,assembly1:a,assembly2:i,selectedRow:l}):null,s[34]=a,s[35]=i,s[36]=t,s[37]=x,s[38]=l,s[39]=$):$=s[39],s[40]!==R||s[41]!==I||s[42]!==O||s[43]!==$?(q=(0,A.jsxs)("div",{children:[R,I,O,$]}),s[40]=R,s[41]=I,s[42]=O,s[43]=$,s[44]=q):q=s[44],q}function _(e){return(0,A.jsx)(y.A,{value:e.value,control:(0,A.jsx)(p.A,{}),label:e.label},e.value)}var q=t(27305),z=t(64261),M=t(35962),E=t(20449),B=t(59705);const V=(0,i.n)()(e=>({mb:{marginBottom:10},button:{margin:e.spacing(2)},rel:{position:"relative"},synbutton:{position:"absolute",top:30},synbuttonNeedsConfig:{color:e.palette.warning.main},bg:{background:e.palette.divider}}));function W(e,s){const t=e.importFormSyntenyTrackSelections[s];return!t||"preConfigured"===t.type&&!t.value}const G=(0,r.observer)(function({selectedRow:e,selectedAssemblyNames:s,setSelectedRow:t,setSelectedAssemblyNames:n,model:a}){const{classes:i}=V(),l=(0,o.getSession)(a);return s.map((r,c)=>(0,A.jsxs)("div",{className:i.rel,children:[(0,A.jsxs)("span",{children:["Row ",c+1,": "]}),(0,A.jsx)(B.A,{disabled:s.length<=2,onClick:()=>{a.importFormRemoveRow(c),n(s.map((e,s)=>s===c?void 0:e).filter(o.notEmpty)),e>=s.length-2&&t(0)},children:(0,A.jsx)(E.A,{})}),(0,A.jsx)(q.A,{helperText:"",selected:r,onChange:e=>{n(s.map((s,t)=>t===c?e:s))},session:l}),c!==s.length-1?(0,A.jsx)(g.A,{title:"Click to configure synteny track for this row pair",children:(0,A.jsx)(B.A,{"data-testid":"synbutton",className:(0,z.cx)(i.synbutton,c===e?i.bg:void 0,W(a,c)?i.synbuttonNeedsConfig:void 0),onClick:()=>{t(c)},children:(0,A.jsx)(M.A,{})})}):null]},`${r}-${c}`))}),D=(0,r.observer)(function({model:e,selectedAssemblyNames:s,setSelectedAssemblyNames:t,selectedRow:n,setSelectedRow:a,defaultAssemblyName:o,onLaunch:i}){const{classes:l}=V(),r=s.length-1,c=!Array.from({length:r},(e,s)=>s).some(s=>W(e,s));return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)("div",{className:l.mb,children:"Select assemblies for linear synteny view"}),(0,A.jsx)(G,{model:e,selectedAssemblyNames:s,setSelectedAssemblyNames:t,selectedRow:n,setSelectedRow:a}),(0,A.jsxs)("div",{children:[(0,A.jsx)(v.A,{className:l.button,variant:"contained",color:"secondary",onClick:()=>{t([...s,o])},children:"Add row"}),(0,A.jsx)(v.A,{className:l.button,disabled:!c,onClick:i,variant:"contained",color:"primary",children:"Launch"})]})]})});var Q=t(16640),U=t(44934);const H=(0,i.n)()(e=>({importFormContainer:{padding:e.spacing(4)},flex:{display:"flex",gap:90},rightPanel:{flexGrow:11},leftPanel:{flexGrow:4,flexShrink:0}})),J=(0,r.observer)(function({model:e}){const{classes:s}=H(),t=(0,o.getSession)(e),{assemblyNames:i}=t,r=i[0]||"",[c,d]=(0,n.useState)(0),[m,y]=(0,n.useState)([r,r]),[p,b]=(0,n.useState)();return(0,A.jsxs)(l.A,{className:s.importFormContainer,children:[p?(0,A.jsx)(a.A,{error:p}):null,(0,A.jsxs)("div",{className:s.flex,children:[(0,A.jsx)("div",{className:s.leftPanel,children:(0,A.jsx)(D,{model:e,selectedAssemblyNames:m,setSelectedAssemblyNames:y,selectedRow:c,setSelectedRow:d,defaultAssemblyName:r,onLaunch:()=>{(async()=>{try{b(void 0),await async function({selectedAssemblyNames:e,model:s}){const t=(0,o.getSession)(s),{assemblyManager:n}=t,{importFormSyntenyTrackSelections:a}=s;s.setViews(await Promise.all(e.map(async e=>{const s=await n.waitForAssembly(e);if(!s)throw new Error(`Assembly "${e}" failed to load`);return{type:"LinearGenomeView",bpPerPx:1,offsetPx:0,hideHeader:!0,displayedRegions:s.regions}})));for(const e of s.views)e.setWidth(s.width),e.showAllRegions();(0,Q.QW)(t)?(0,U.toJS)(a).map((e,n)=>{"userOpened"===e.type?(t.addTrackConf(e.value),s.toggleTrack(e.value?.trackId,n)):"preConfigured"===e.type&&s.showTrack(e.value,n)}):t.notify("Can't add tracks","warning"),s.clearImportFormSyntenyTracks()}({selectedAssemblyNames:m,model:e})}catch(e){console.error(e),b(e)}})()}})}),(0,A.jsxs)("div",{className:s.rightPanel,children:[(0,A.jsxs)("div",{children:["Synteny dataset to display between row ",c+1," and"," ",c+2]}),(0,A.jsx)($,{model:e,selectedRow:c,assembly1:m[c],assembly2:m[c+1]})]})]})]})})}}]);
//# sourceMappingURL=8383.52981be5.chunk.js.map