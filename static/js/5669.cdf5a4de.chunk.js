"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[5669],{45669:(e,t,r)=>{r.r(t),r.d(t,{default:()=>C});var n=r(67758),s=r(7552),o=r(68446),a=r(99546),c=r(373);const l="rgb(220,220,180)",d="rgba(250,200,200)";function i({str:e,charactersPerRow:t,showCoordinates:r,currRemainder:n=0,splitSize:s=10}){const o=Math.ceil(e.length/t),a=new Array(o);let c=n%10,l=0,d=0;for(;l<o+1;++l){const o=0===l?t-n:t,i=e.slice(d,d+o);if(!i)break;if(r){let e="";for(let t=0,r=c;t<i.length;t++,r++)r%s===0&&(e+=" ",r=0),e+=i[t];e&&(a[l]=e)}else a[l]=i;c=0,d+=o}return{segments:a,remainder:((a.at(-1)?.replaceAll(" ","").length||0)+(l<2?n:0))%t}}var u=r(69500);const h=(0,o.observer)((function({chunks:e,start:t,color:r,strand:n=1,coordStart:o=t,model:a}){const{charactersPerRow:c,showCoordinates:l}=a;return e.map(((a,d)=>{const i=0===d&&t%c===0||d>0?`${(""+(o-t%c+d*n*c)).padStart(4)}   `:"",h=d===e.length-1&&(e.at(-1)?.replaceAll(" ","").length||0)+(0===d?t%c:0)!==c?null:l?" \n":"";return(0,u.jsxs)(s.Fragment,{children:[l?i:null,(0,u.jsx)("span",{style:{background:r},children:a}),h]},`${a}-${d}`)}))})),m=(0,o.observer)((function({utr:e,cds:t,exons:r,sequence:n,upstream:s,downstream:o,feature:a,includeIntrons:c,collapseIntron:m,model:g}){const{upperCaseCDS:w,intronBp:f,charactersPerRow:p,showCoordinates:x,showCoordinatesSetting:b}=g,j=t.length>0,C=(t.length?[...t,...e].sort(((e,t)=>e.start-t.start)):r).filter((e=>e.start!==e.end)),S=e=>w?e.toLowerCase():e,k=e=>w?e.toUpperCase():e,q=-1===a.strand?-1:1,R="genomic"===b&&c&&!m,y=R?q:1;let v=R?q>0?a.start+1-(s?.length||0):a.end+(s?.length||0):0,_=0,P=0,$=null;if(s){const{segments:e,remainder:t}=i({str:S(s),charactersPerRow:p,showCoordinates:x});$=(0,u.jsx)(h,{model:g,color:d,strand:y,start:_,coordStart:v,chunks:e}),P=t,_+=s.length*y,v+=s.length*y}const I=[];for(let e=0;e<C.length;e++){const t=C[e],r=n.slice(t.end,C[e+1]?.start),s=n.slice(t.start,t.end),{segments:o,remainder:a}=i({str:j?"CDS"===t.type?k(s):S(s):k(s),charactersPerRow:p,currRemainder:P,showCoordinates:x});if(I.push((0,u.jsx)(h,{model:g,color:"CDS"===t.type?l:"rgb(200,240,240)",strand:y,start:_,coordStart:v,chunks:o},`${JSON.stringify(t)}-mid`)),P=a,_+=s.length*y,v+=s.length*y,r&&c&&e<C.length-1){const e=S(m&&r.length>2*f?`${r.slice(0,f)}...${r.slice(-f)}`:r),{segments:n,remainder:s}=i({str:e,charactersPerRow:p,currRemainder:P,showCoordinates:x});n.length&&(I.push((0,u.jsx)(h,{model:g,strand:y,coordStart:v,start:_,chunks:n},`${JSON.stringify(t)}-intron`)),P=s,_+=e.length*y,v+=e.length*y)}}let F=null;if(o){const{segments:e}=i({str:S(o),charactersPerRow:p,currRemainder:P,showCoordinates:x});F=(0,u.jsx)(h,{start:_,model:g,strand:y,chunks:e,coordStart:v,color:d})}return(0,u.jsxs)(u.Fragment,{children:[$,I,F]})})),g=(0,o.observer)((function({cds:e,sequence:t,model:r}){const{charactersPerRow:n,showCoordinates:s}=r,{segments:o}=i({str:(0,c.o9)(e,t),charactersPerRow:n,showCoordinates:s});return(0,u.jsx)(h,{model:r,color:l,chunks:o,start:0})})),w=(0,o.observer)((function({sequence:e,upstream:t,feature:r,downstream:n,model:s}){const{charactersPerRow:o,showCoordinatesSetting:a,showCoordinates:c}=s;let l=0,m=null,g=0;const w=-1===r.strand?-1:1,f="genomic"===a,p=f?w:1;let x=f?w>0?r.start+1-(t?.length||0):r.end+(t?.length||0):0;if(t){const{segments:e,remainder:r}=i({str:t,charactersPerRow:o,showCoordinates:c});m=(0,u.jsx)(h,{model:s,color:d,start:l,coordStart:x,chunks:e}),g=r,l+=t.length*p,x+=t.length*p}const{segments:b,remainder:j}=i({str:e,charactersPerRow:o,showCoordinates:c,currRemainder:g}),C=(0,u.jsx)(h,{model:s,color:"rgb(200,280,200)",start:l,coordStart:x,chunks:b});g=j,l+=e.length*p,x+=e.length*p;let S=null;if(n){const{segments:e}=i({str:n,charactersPerRow:o,currRemainder:g,showCoordinates:c});S=(0,u.jsx)(h,{start:l,model:s,chunks:e,coordStart:x,color:d})}return(0,u.jsxs)(u.Fragment,{children:[m,C,S]})})),f=(0,o.observer)((function({cds:e,sequence:t,codonTable:r,model:n}){const{charactersPerRow:s,showCoordinates:o}=n,a=(0,c.o9)(e,t);let l="";for(let e=0;e<a.length;e+=3)l+=r[a.slice(e,e+3)]||"&";const{segments:d}=i({str:l,charactersPerRow:s,showCoordinates:o});return(0,u.jsx)(h,{model:n,color:"rgb(220,160,220)",chunks:d,start:0})})),p=(0,o.observer)((function({mode:e,feature:t,sequence:r,model:n}){let{seq:s,upstream:o="",downstream:l=""}=r;const d=t.subfeatures?.sort(((e,t)=>e.start-t.start)).map((e=>({...e,start:e.start-t.start,end:e.end-t.start})))||[];let i=(0,c.Qq)(d.filter((e=>"CDS"===e.type))),h=(0,c.Qq)(d.filter((e=>e.type?.match(/utr/i)))),p=(0,c.Qq)(d.filter((e=>"exon"===e.type)));return!h.length&&i.length&&p.length&&(h=(0,c.h8)(i,p)),h.length||!i.length||p.length||(h=(0,c.V4)(i,{start:0,end:t.end-t.start,type:"gene"})),-1===t.strand&&([s,o,l]=[(0,a.revcom)(s),(0,a.revcom)(l),(0,a.revcom)(o)],i=(0,c.YC)(i,s.length),p=(0,c.YC)(p,s.length),h=(0,c.YC)(h,s.length)),(0,u.jsx)(u.Fragment,{children:"genomic"===e?(0,u.jsx)(w,{feature:t,model:n,sequence:s}):"genomic_sequence_updownstream"===e?(0,u.jsx)(w,{model:n,feature:t,sequence:s,upstream:o,downstream:l}):"cds"===e?(0,u.jsx)(g,{model:n,cds:i,sequence:s}):"cdna"===e?(0,u.jsx)(m,{model:n,exons:p,feature:t,cds:i,utr:h,sequence:s}):"protein"===e?(0,u.jsx)(f,{model:n,cds:i,codonTable:(0,a.generateCodonTable)(a.defaultCodonTable),sequence:s}):"gene"===e?(0,u.jsx)(m,{model:n,exons:p,feature:t,cds:i,utr:h,sequence:s,includeIntrons:!0}):"gene_collapsed_intron"===e?(0,u.jsx)(m,{model:n,exons:p,feature:t,cds:i,sequence:s,utr:h,includeIntrons:!0,collapseIntron:!0}):"gene_updownstream"===e?(0,u.jsx)(m,{model:n,exons:p,feature:t,cds:i,sequence:s,utr:h,upstream:o,downstream:l,includeIntrons:!0}):"gene_updownstream_collapsed_intron"===e?(0,u.jsx)(m,{model:n,exons:p,feature:t,cds:i,sequence:s,utr:h,upstream:o,downstream:l,includeIntrons:!0,collapseIntron:!0}):(0,u.jsx)("div",{children:"Unknown type"})})})),x=(0,o.observer)((function({mode:e,model:t,feature:r}){return(0,u.jsx)("div",{style:{background:"white"},children:`>${[[r.name||r.id,e].filter((e=>!!e)).join("-"),`${r.refName}:${(0,a.toLocale)(r.start+1)}-${(0,a.toLocale)(r.end)}${n=r.strand,-1===n?"(-)":1===n?"(+)":""}`,e.endsWith("updownstream")?`+/- ${(0,a.toLocale)(t.upDownBp)} up/downstream bp`:""].filter((e=>!!e)).join(" ")}\n`});var n}));function b(e){const t=(0,n.c)(3),{children:r}=e;let s,o;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s={fontFamily:"monospace",color:"black",fontSize:11},t[0]=s):s=t[0],t[1]!==r?(o=(0,u.jsx)("pre",{style:s,children:r}),t[1]=r,t[2]=o):o=t[2],o}function j(e){const t=(0,n.c)(3),{children:r}=e;let s,o;return t[0]===Symbol.for("react.memo_cache_sentinel")?(s={fontFamily:"monospace",color:"black",fontSize:11,maxWidth:600,whiteSpace:"wrap",wordBreak:"break-all"},t[0]=s):s=t[0],t[1]!==r?(o=(0,u.jsx)("div",{style:s,children:r}),t[1]=r,t[2]=o):o=t[2],o}const C=(0,o.observer)((0,s.forwardRef)((function(e,t){const r=(0,n.c)(17),{sequence:s,model:o,feature:a}=e,{showCoordinates:c,mode:l}=o,d=c?b:j;let i,h,m,g,w;return r[0]===Symbol.for("react.memo_cache_sentinel")?(i={maxHeight:300,overflow:"auto"},r[0]=i):i=r[0],r[1]!==a||r[2]!==l||r[3]!==o?(h=(0,u.jsx)(x,{model:o,mode:l,feature:a}),r[1]=a,r[2]=l,r[3]=o,r[4]=h):h=r[4],r[5]!==a||r[6]!==l||r[7]!==o||r[8]!==s?(m=(0,u.jsx)(p,{model:o,mode:l,feature:a,sequence:s}),r[5]=a,r[6]=l,r[7]=o,r[8]=s,r[9]=m):m=r[9],r[10]!==d||r[11]!==h||r[12]!==m?(g=(0,u.jsxs)(d,{children:[h,m]}),r[10]=d,r[11]=h,r[12]=m,r[13]=g):g=r[13],r[14]!==t||r[15]!==g?(w=(0,u.jsx)("div",{"data-testid":"sequence_panel",ref:t,style:i,children:g}),r[14]=t,r[15]=g,r[16]=w):w=r[16],w})))}}]);
//# sourceMappingURL=5669.cdf5a4de.chunk.js.map