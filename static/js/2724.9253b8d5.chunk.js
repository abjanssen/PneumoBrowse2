"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[2724],{72724:(e,t,a)=>{a.r(t),a.d(t,{default:()=>se});var s=a(7552),n=a(99546),r=a(48171),o=a(98360),i=a(29629),c=a(25467),l=a(68446),d=a(36715),p=a(85059),u=a(27897),h=a(96403),m=a(22133),g=a(5401),x=a(75785),f=a(49823),k=a(91468),j=a(1343),b=a(33371),A=a(32808),y=a(69500);const v=(0,x.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function w({trackAdapter:e,trackType:t}){const{classes:a}=v(),{type:s,subadapter:n}=e;return"SNPCoverageAdapter"===s?(0,y.jsxs)(d.A,{className:a.spacing,children:["Selected ",(0,y.jsx)("code",{children:t}),". Using adapter ",(0,y.jsx)("code",{children:s})," with subadapter ",(0,y.jsx)("code",{children:n?.type}),". Please enter a track name and, if necessary, update the track type."]}):(0,y.jsxs)(d.A,{className:a.spacing,children:["Using adapter ",(0,y.jsx)("code",{children:s})," and guessing track type"," ",(0,y.jsx)("code",{children:t}),". Please enter a track name and, if necessary, update the track type."]})}var T=a(87731),N=a(55851);function S(e){const t={};for(const a of e){const e=a.adapterMetadata?.category||"Default";t[e]||(t[e]=[]),t[e].push(a)}return t}const C=(0,l.observer)((({model:e})=>{const{trackAdapter:t}=e,{pluginManager:a}=(0,n.getEnv)(e);return(0,y.jsx)(j.A,{value:"UNKNOWN"!==t?.type?t?.type:"",label:"Adapter type",variant:"outlined",select:!0,fullWidth:!0,onChange:t=>{e.setAdapterHint(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"adapterTypeSelect"}}},children:Object.entries(S(a.getAdapterElements().filter((e=>!e.adapterMetadata?.hiddenFromGUI)))).map((([e,t])=>[(0,y.jsx)(N.A,{children:e},e),t.map((e=>(0,y.jsx)(i.A,{value:e.name,children:e.displayName},e.name)))]))})})),D=(0,x.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function I({model:e}){const{classes:t}=D();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(d.A,{className:t.spacing,children:["JBrowse was not able to guess the adapter type for this data, but it may be in the list below. If not, you can"," ",(0,y.jsx)(T.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer",children:"check for new releases"})," ","of JBrowse to see if they support this data type or"," ",(0,y.jsx)(T.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer",children:"file an issue"})," ","and add a feature request for this data type."]}),(0,y.jsx)(C,{model:e})]})}var E=a(374),M=a(25762),P=a(943),W=a(17125),O=a(1773),B=a(25355),F=a(58181),J=a(13197),U=a(93117),_=a(61723);const G=(0,x.n9)()((e=>({paper:{display:"flex",flexDirection:"column",padding:e.spacing(1)},card:{marginTop:e.spacing(1)}}))),R=(0,l.observer)((function({model:e}){const{classes:t}=G(),[a,n]=(0,s.useState)(""),[r,o]=(0,s.useState)(""),[i,c]=(0,s.useState)(["Name","ID"]),[l,d]=(0,s.useState)(["CDS","exon"]),p=[{label:"Indexing attributes",values:i},{label:"Feature types to exclude",values:l}];return(0,s.useEffect)((()=>{e.setTextIndexingConf({attributes:i,exclude:l})}),[e,i,l]),(0,y.jsxs)(P.A,{className:t.paper,children:[(0,y.jsx)(W.A,{children:"Indexing configuration"}),p.map(((e,s)=>(0,y.jsx)(O.A,{raised:!0,className:t.card,children:(0,y.jsxs)(B.A,{children:[(0,y.jsx)(W.A,{children:e.label}),(0,y.jsxs)(F.A,{disablePadding:!0,children:[e.values.map(((t,a)=>(0,y.jsx)(J.Ay,{disableGutters:!0,children:(0,y.jsx)(j.A,{value:t,slotProps:{input:{endAdornment:(0,y.jsx)(U.A,{position:"end",children:(0,y.jsx)(_.A,{onClick:()=>{const t=e.values.filter(((e,t)=>t!==a));0===s?c(t):d(t)},children:(0,y.jsx)(M.A,{})})})}}})},`${t}-${a}`))),(0,y.jsx)(J.Ay,{disableGutters:!0,children:(0,y.jsx)(j.A,{value:0===s?a:r,placeholder:"add new",onChange:e=>{0===s?n(e.target.value):o(e.target.value)},slotProps:{input:{endAdornment:(0,y.jsx)(U.A,{position:"end",children:(0,y.jsx)(_.A,{onClick:()=>{0===s?(c([...i,a]),n("")):(d([...l,r]),o(""))},disabled:0===s?""===a:""===r,"data-testid":"stringArrayAdd-Feat",children:(0,y.jsx)(E.A,{})})})}}})})]})]})},e.label)))]})})),$=(0,l.observer)((function({model:e}){const{pluginManager:t}=(0,n.getEnv)(e),{trackType:a}=e,s=t.getTrackElements();return(0,y.jsx)(j.A,{value:a,variant:"outlined",label:"Track type",select:!0,fullWidth:!0,onChange:t=>{e.setTrackType(t.target.value)},slotProps:{select:{SelectDisplayProps:{"data-testid":"trackTypeSelect"}}},children:s.map((({name:e,displayName:t})=>(0,y.jsx)(i.A,{value:e,children:t},e)))})})),L=(0,x.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}})));function q(){const{classes:e}=L();return(0,y.jsxs)(d.A,{className:e.spacing,children:["This version of JBrowse cannot display data of this type. It is possible, however, that there is a newer version that can display them. You can"," ",(0,y.jsx)(T.A,{href:"https://github.com/GMOD/jbrowse-components/releases",target:"_blank",rel:"noopener noreferrer",children:"check for new releases"})," ","of JBrowse or"," ",(0,y.jsx)(T.A,{href:"https://github.com/GMOD/jbrowse-components/issues/new",target:"_blank",rel:"noopener noreferrer",children:"file an issue"})," ","and add a feature request for this data type."]})}const H=(0,x.n9)()((e=>({spacing:{marginBottom:e.spacing(3)}}))),K=(0,l.observer)((function({model:e}){const{classes:t}=H(),[a,o]=(0,s.useState)(!0),i=(0,n.getSession)(e),{trackName:c,unsupported:l,trackAdapter:p,trackType:u,warningMessage:h,adapterHint:m}=e;if((0,s.useEffect)((()=>{""===m&&p&&e.setAdapterHint(p.type)}),[m,p,p?.type,e]),l)return(0,y.jsx)(q,{});if(p?.type===k.UNKNOWN)return(0,y.jsx)(I,{model:e});if(p?.type){const l=(0,n.isSupportedIndexingAdapter)(p.type),{pluginManager:m}=(0,n.getEnv)(e),g=m.evaluateExtensionPoint("Core-addTrackComponent",(({model:e})=>(0,y.jsx)(f.AssemblySelector,{session:i,helperText:"Select assembly to add track to",selected:e.assembly,onChange:t=>{e.setAssembly(t)},TextFieldProps:{fullWidth:!0,SelectProps:{SelectDisplayProps:{"data-testid":"assemblyNameSelect"}}}})),{model:e});return(0,y.jsxs)("div",{children:[(0,y.jsx)(w,{trackAdapter:p,trackType:u}),h?(0,y.jsx)(d.A,{color:"warning",children:h}):null,(0,y.jsx)(j.A,{className:t.spacing,label:"trackName",helperText:"A name for this track",fullWidth:!0,value:c,onChange:t=>{e.setTrackName(t.target.value)},slotProps:{htmlInput:{"data-testid":"trackNameInput"}}}),(0,y.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:10},children:[(0,y.jsx)(C,{model:e}),(0,y.jsx)($,{model:e}),(0,y.jsx)(s.Suspense,{fallback:null,children:(0,y.jsx)(g,{model:e})})]}),n.isElectron&&l&&(0,y.jsx)(r.A,{children:(0,y.jsx)(b.A,{label:"Index track for text searching?",control:(0,y.jsx)(A.A,{checked:a,onChange:t=>{o(t.target.checked),e.setTextIndexTrack(t.target.checked)}})})}),n.isElectron&&a&&l?(0,y.jsx)(R,{model:e}):null]})}return(0,y.jsx)(d.A,{children:"Could not recognize this data type."})}));var z=a(36422);const Y=(0,x.n9)()((e=>({paper:{padding:e.spacing(2)},spacer:{height:e.spacing(8)}}))),Q=(0,l.observer)((function({model:e}){const{classes:t}=Y(),a=(0,z.getRoot)(e);return(0,y.jsxs)(P.A,{className:t.paper,children:[(0,y.jsx)(f.FileSelector,{name:"Main file",description:"",location:e.trackData,setLocation:e.setTrackData,setName:e.setTrackName,rootModel:a}),(0,y.jsx)("div",{className:t.spacer}),(0,y.jsx)(f.FileSelector,{name:"Index file",description:"(Optional) The URL of the index file is automatically inferred from the URL of the main file if it is not supplied.",location:e.indexTrackData,setLocation:e.setIndexTrackData,setName:e.setTrackName,rootModel:a})]})}));const V=(0,x.n9)()((e=>({root:{marginTop:e.spacing(1)},stepper:{backgroundColor:e.palette.background.default},button:{marginRight:e.spacing(1)},actionsContainer:{marginTop:e.spacing(10),marginBottom:e.spacing(2)},alertContainer:{padding:`${e.spacing(2)}px 0px ${e.spacing(2)}px 0px`}}))),X=["Enter track data","Confirm track type"],Z=(0,l.observer)((function({model:e}){const[t,a]=(0,s.useState)(0),{classes:r}=V(),{assembly:o,trackAdapter:i,trackData:c,trackName:l,trackType:x}=e;function f(t){switch(t){case 0:return(0,y.jsx)(Q,{model:e});case 1:return(0,y.jsx)(K,{model:e});default:return(0,y.jsx)(d.A,{children:"Unknown step"})}}function k(){switch(t){case 0:return!c;case 1:return!(l&&x&&i?.type&&o);default:return!0}}return(0,y.jsx)("div",{className:r.root,children:(0,y.jsx)(p.A,{className:r.stepper,activeStep:t,orientation:"vertical",children:X.map(((s,o)=>(0,y.jsxs)(u.A,{children:[(0,y.jsx)(h.A,{children:s}),(0,y.jsxs)(m.A,{children:[f(o),(0,y.jsxs)("div",{className:r.actionsContainer,children:[(0,y.jsx)(g.A,{disabled:0===t,className:r.button,onClick:()=>{a(t-1)},children:"Back"}),(0,y.jsx)(g.A,{disabled:k(),variant:"contained",color:"primary",onClick:()=>{if(t!==X.length-1)a(t+1);else try{!function({model:e}){const{textIndexTrack:t,trackAdapter:a,view:s}=e,r=(0,n.getSession)(e),o=e.getTrackConfig(Date.now());if(!(0,n.isSessionWithAddTracks)(r))throw new Error("Can't add tracks to this session");if(!o||!a)throw new Error("Failed to add track.\nThe configuration of this file is not currently supported.");{const{trackId:i}=o;r.addTrackConf(o),s?.showTrack?.(i),n.isElectron&&t&&(0,n.isSupportedIndexingAdapter)(a.type)&&function({trackId:e,model:t}){const{textIndexingConf:a,trackName:s,assembly:n}=t,{jobsManager:r}=(0,z.getRoot)(t),o=a||{attributes:["Name","ID"],exclude:["CDS","exon"]},i=`${s}-index`;r.queueJob({indexingParams:{...o,assemblies:[n],tracks:[e],indexType:"perTrack",name:i,timestamp:(new Date).toISOString()},name:i,cancelCallback:()=>r.abortJob()})}({model:e,trackId:i}),e.clearData(),(0,n.isSessionModelWithWidgets)(r)&&r.hideWidget(e)}}({model:e})}catch(t){(0,n.getSession)(e).notifyError(`${t}`,t)}},className:r.button,"data-testid":"addTrackNextButton",children:t===X.length-1?"Add":"Next"})]})]})]},s)))})})}));var ee=a(42489);const te=(0,x.n9)()({textbox:{width:"100%"},submit:{marginTop:25,marginBottom:100,display:"block"}}),ae=(0,l.observer)((function({model:e}){const{classes:t}=te(),[a,r]=(0,s.useState)(""),[o,i]=(0,s.useState)();return(0,y.jsxs)("div",{children:[o?(0,y.jsx)(f.ErrorMessage,{error:o}):null,(0,y.jsx)(j.A,{multiline:!0,rows:10,value:a,placeholder:"Paste track config or array of track configs in JSON format",variant:"outlined",className:t.textbox,onChange:e=>{r(e.target.value)}}),(0,y.jsx)(g.A,{variant:"contained",className:t.submit,onClick:()=>{try{i(void 0);const t=(0,n.getSession)(e),s=JSON.parse(a),r=Array.isArray(s)?s:[s];(0,n.isSessionWithAddTracks)(t)&&(0,n.isSessionModelWithWidgets)(t)&&((0,ee.transaction)((()=>{for(const e of r)t.addTrackConf(e);for(const t of r)e.view.showTrack(t.trackId);e.clearData()})),t.hideWidget(e))}catch(e){console.error(e),i(e)}},children:"Submit"})]})})),se=(0,l.observer)((function({model:e}){const[t,a]=(0,s.useState)("Default add track workflow"),l={"Default add track workflow":Z,"Add track JSON":ae,...Object.fromEntries((0,n.getEnv)(e).pluginManager.getAddTrackWorkflowElements().map((e=>[e.name,e.ReactComponent])))},d=l[t]?t:"Default add track workflow",p=l[d];return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(r.A,{children:[(0,y.jsx)(o.A,{value:d,onChange:e=>{a(e.target.value)},children:Object.keys(l).map((e=>(0,y.jsx)(i.A,{value:e,children:e},e)))}),(0,y.jsx)(c.A,{children:"Type of add track workflow"})]}),(0,y.jsx)(s.Suspense,{fallback:null,children:(0,y.jsx)(p,{model:e})})]})}))}}]);
//# sourceMappingURL=2724.9253b8d5.chunk.js.map