"use strict";(globalThis.webpackChunk_jbrowse_web=globalThis.webpackChunk_jbrowse_web||[]).push([[8142],{78142:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var o=n(7552),r=n(75785),a=n(68446),l=n(963),s=n(9555),i=n(36715),c=n(99546),m=n(49823),u=n(89003);const d=(0,r.n9)()({guide:{pointerEvents:"none",height:"100%",width:1,position:"absolute",zIndex:10},sm:{fontSize:10}}),p=(0,a.observer)((function({model:e,coordX:t}){const{classes:n}=d();return o.createElement(u.A,{open:!0,placement:"top",title:e.views.map((e=>e.pxToBp(t))).map(((e,t)=>o.createElement(i.A,{className:n.sm,key:[JSON.stringify(e),t].join("-")},(0,c.stringify)(e,!0)))),arrow:!0},o.createElement("div",{className:n.guide,style:{left:t,background:"red"}}))})),b=(0,r.n9)()((e=>({rubberband:{height:"100%",background:(0,l.X4)(e.palette.tertiary.main,.7),position:"absolute",zIndex:10,textAlign:"center",overflow:"hidden"},rubberbandControl:{cursor:"crosshair",width:"100%",minHeight:8},rubberbandText:{color:e.palette.tertiary.contrastText},popover:{mouseEvents:"none",cursor:"crosshair"},paper:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}}))),v=(0,a.observer)((function({model:e,ControlComponent:t=o.createElement("div",null)}){const[n,r]=(0,o.useState)(),[a,l]=(0,o.useState)(),[u,d]=(0,o.useState)(),[v,f]=(0,o.useState)(),g=(0,o.useRef)(null),h=(0,o.useRef)(null),{classes:E}=b(),w=void 0!==n&&void 0===u;function y(e){e.preventDefault(),e.stopPropagation();const t=e.clientX-e.target.getBoundingClientRect().left;r(t),l(t)}function k(e){const t=e.target;f(e.clientX-t.getBoundingClientRect().left)}function M(){f(void 0),e.views.forEach((e=>{e.setOffsets(void 0,void 0)}))}function C(){d(void 0),r(void 0),l(void 0)}(0,o.useEffect)((()=>{function t(e){if(g.current&&w){const t=e.clientX-g.current.getBoundingClientRect().left;l(t)}}function o(t){if(void 0!==n&&g.current){const{clientX:o,clientY:r}=t,a=o-g.current.getBoundingClientRect().left;d({offsetX:a,clientX:o,clientY:r}),e.views.forEach((e=>{const t=function(e,t){if(void 0===n)return;let o=n,r=e;return r<o&&([o,r]=[r,o]),{leftOffset:t.pxToBp(o),rightOffset:t.pxToBp(r)}}(a,e);if(t){const{leftOffset:n,rightOffset:o}=t;e.setOffsets(n,o)}})),f(void 0)}}return w?(window.addEventListener("mousemove",t),window.addEventListener("mouseup",o),()=>{window.removeEventListener("mousemove",t),window.removeEventListener("mouseup",o)}):()=>{}}),[n,w,e]),(0,o.useEffect)((()=>{!w&&void 0!==a&&void 0!==n&&Math.abs(a-n)<=3&&C()}),[w,a,n]);const N=Boolean(u);if(void 0===n)return o.createElement(o.Fragment,null,void 0!==v?o.createElement(p,{model:e,coordX:v}):null,o.createElement("div",{ref:g,className:E.rubberbandControl,onMouseDown:y,onMouseOut:M,onMouseMove:k},t));const x=u?u.offsetX:a||0,S=Math.min(x,n),A=Math.abs(x-n),{views:O}=e,R=O.map((e=>e.pxToBp(S))),B=O.map((e=>e.pxToBp(S+A))),T=O.map((e=>Math.ceil(A*e.bpPerPx)));return o.createElement(o.Fragment,null,h.current?o.createElement(o.Fragment,null,o.createElement(s.Ay,{className:E.popover,classes:{paper:E.paper},open:!0,anchorEl:h.current,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"bottom",horizontal:"right"},keepMounted:!0,disableRestoreFocus:!0},R.map(((e,t)=>o.createElement(i.A,{key:[JSON.stringify(e),t,"left"].join("-")},(0,c.stringify)(e,!0))))),o.createElement(s.Ay,{className:E.popover,classes:{paper:E.paper},open:!0,anchorEl:h.current,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,disableRestoreFocus:!0},B.map(((e,t)=>o.createElement(i.A,{key:[JSON.stringify(e),t,"right"].join("-")},(0,c.stringify)(e,!0)))))):null,o.createElement("div",{ref:h,className:E.rubberband,style:{left:S,width:A}},o.createElement(i.A,{variant:"h6",className:E.rubberbandText},T.map(((e,t)=>o.createElement(i.A,{key:`${e}_${t}`},`${e.toLocaleString("en-US")}bp`))))),o.createElement("div",{className:E.rubberbandControl,ref:g,onMouseDown:y,onMouseOut:M,onMouseMove:k},t),u?o.createElement(m.Menu,{anchorReference:"anchorPosition",anchorPosition:{left:u.clientX,top:u.clientY},onMenuItemClick:function(e,t){t(),C()},open:N,onClose:C,menuItems:e.rubberBandMenuItems()}):null)}));var f=n(83867),g=n(23758),h=n(17307),E=n(59121),w=n(90542),y=n(20529);const k=(0,r.n9)()((()=>({bp:{display:"flex",alignItems:"center",marginLeft:10},searchBox:{display:"flex"}}))),M=(0,a.observer)((function({view:e}){const{classes:t}=k(),{assemblyNames:n,coarseTotalBp:r}=e;return o.createElement("span",{className:t.searchBox},o.createElement(y.Gd,{model:e,showHelp:!1}),o.createElement(i.A,{variant:"body2",color:"textSecondary",className:t.bp},n.join(",")," ",(0,c.toLocale)(Math.round(r))," bp"))})),C=(0,r.n9)()({inline:{display:"inline-flex"}}),N=(0,a.observer)((function({model:e}){const{classes:t}=C(),{views:n}=e,[r,a]=(0,o.useState)(n.length<=3),[l,s]=(0,o.useState)(n.length<=3);return o.createElement(f.A,{row:!0},o.createElement(g.A,{menuItems:[{label:"Synteny track selectors",type:"subMenu",subMenu:n.slice(0,-1).map(((t,o)=>({label:`Row ${o+1}->${o+2} (${n[o].assemblyNames.join(",")}->${n[o+1].assemblyNames.join(",")})`,onClick:()=>{e.activateTrackSelector(o)}})))},{label:"Row track selectors",type:"subMenu",subMenu:n.map(((e,t)=>({label:`Row ${t+1} track selector (${e.assemblyNames.join(",")})`,onClick:()=>e.activateTrackSelector()})))}]},o.createElement(w.xU,null)),o.createElement(g.A,{menuItems:[{label:"Row view menus",type:"subMenu",subMenu:n.map(((e,t)=>({label:`View ${t+1} Menu`,subMenu:e.menuItems()})))},...e.headerMenuItems()]},o.createElement(h.A,null)),o.createElement(g.A,{menuItems:[{label:"Show search boxes",type:"checkbox",checked:r,onClick:()=>{a(!r)}},{label:"Orientation - Side-by-side",type:"radio",checked:l,onClick:()=>{s(!l)}},{label:"Orientation - Vertical",type:"radio",checked:!l,onClick:()=>{s(!l)}}]},o.createElement(E.A,null)),r?o.createElement("span",{className:l?t.inline:void 0},n.map((e=>o.createElement(M,{key:e.id,view:e})))):null)}));var x=n(68584);const S=(0,r.n9)()({container:{display:"grid"},overlay:{zIndex:100,gridArea:"1/1"},resizeHandle:{height:4,background:"#ccc"}});function A({view:e}){const{pluginManager:t}=(0,c.getEnv)(e),{ReactComponent:n}=t.getViewType(e.type);return o.createElement(n,{model:e})}const O=(0,a.observer)((function({model:e}){const{classes:t}=S(),{views:n,levels:r}=e,a=[o.createElement(A,{key:n[0].id,view:n[0]})];for(let l=1;l<n.length;l++){const s=n[l],i=r[l-1];a.push(o.createElement(o.Fragment,{key:s.id},o.createElement("div",{className:t.container},o.createElement(R,{model:e,level:l-1})),o.createElement(m.ResizeHandle,{onDrag:e=>i?.setHeight(i.height+e),className:t.resizeHandle}),o.createElement(A,{view:s})))}return o.createElement("div",{className:t.container},a)})),R=(0,a.observer)((function({model:e,level:t}){const{classes:n}=S();return o.createElement(o.Fragment,null,e.levels[t]?.tracks.map((e=>{const[t]=e.displays,{RenderingComponent:r}=t,a=(0,x.getConf)(e,"trackId");return r?o.createElement("div",{className:n.overlay,key:a,style:{height:t.height,overflow:"hidden"}},o.createElement(r,{model:t})):null})))})),B=O,T=(0,r.n9)()((e=>({rubberbandContainer:{position:"relative",overflow:"hidden"},rubberbandDiv:{width:"100%",background:e.palette.action.disabledBackground,height:15,"&:hover":{background:e.palette.action.selected}}}))),I=(0,a.observer)((function({model:e}){const{classes:t}=T();return o.createElement("div",{className:t.rubberbandContainer},o.createElement(N,{model:e}),o.createElement(v,{model:e,ControlComponent:o.createElement("div",{className:t.rubberbandDiv})}),o.createElement(B,{model:e}))}))}}]);
//# sourceMappingURL=8142.966a6f26.chunk.js.map